# Robust Neural Contextual Bandit against

Adversarial Corruptions

 Yunzhe Qi, Yikun Ban, Arindam Banerjee, Jingrui He

University of Illinois at Urbana-Champaign

Champaign, IL 61820

{yunzheq2,yikunb2,arindamb,jingrui}@illinois.edu

###### Abstract

Contextual bandit algorithms aim to identify the optimal arm with the highest reward among a set of candidates, based on the accessible contextual information. Among these algorithms, neural contextual bandit methods have shown generally superior performances against linear and kernel ones, due to the representation power of neural networks. However, similar to other neural network applications, neural bandit algorithms can be vulnerable to adversarial attacks or corruptions on the received labels (i.e., arm rewards), which can lead to unexpected performance degradation without proper treatments. As a result, it is necessary to improve the robustness of neural bandit models against potential reward corruptions. In this work, we propose a novel neural contextual bandit algorithm named R-NeuralUCB, which utilizes a novel context-aware Gradient Descent (GD) training strategy to improve the robustness against adversarial reward corruptions. Under over-parameterized neural network settings, we provide regret analysis for R-NeuralUCB to quantify reward corruption impacts, without the commonly adopted arm separateness assumption in existing neural bandit works. We also conduct experiments against baselines on real data sets under different scenarios, in order to demonstrate the effectiveness of our proposed R-NeuralUCB.

## 1 Introduction

Contextual bandits refer to one specific type of multi-armed bandit (MAB) problems, where the learner can access the arm context information during the decision-making process. Contextual bandit algorithms have been commonly applied in various real-world applications, including online content recommendation [59, 79, 8], and medical experiments [30, 73, 7]. While these algorithms have been proved effective for numerous online learning tasks, they can be susceptible to the malicious feedback from the environment, such as malicious user feedback in recommender systems [64], and corrupted labels under active learning settings [61]. This can potentially impair the model performance and interfere with the internal decision-making logic. One renowned research direction formulates this problem as _contextual bandits with adversarial corruptions_[57, 42, 16], where received _arm rewards_ can be potentially "corrupted" by the unknown adversary. In this case, bandit algorithms need to be robust against such adversarial corruptions, otherwise they can lead to sub-optimal results. Existing works on contextual bandits with corruptions are mainly based on linear [17, 29, 57] and kernelized bandits [15, 16], where the unknown reward mapping function is assumed to be linear, or lies in a specified Reproducing Kernel Hilbert Space (RKHS). However, one key challenge is that these assumptions can evidently fail under real-world application scenarios [86], when we have little prior knowledge regarding this mapping function, or it becomes increasingly complex.

In the face of this challenge, neural bandit algorithms [86, 84, 11, 12] have been proposed to relax the assumptions on reward functions. By leveraging the representation power of neural networks, neural contextual bandit algorithms are able to deal with complex reward functions irrespective of whetherthey are linear or non-linear, along with suitable exploration strategies for tackling the exploitation-exploration dilemma [5; 59]. While neural bandit algorithms have been proved effective [9; 68; 60], they can be sensitive to adversarial corruptions as well. From perspectives of trustworthiness, it is well known that neural models can be susceptible to "label attacks" [71; 62; 65], which is akin to reward corruptions in bandit settings. Failure to comply with robustness requirements can impair the feasibility under real-world application scenarios like recommender systems [82; 27; 87; 78], and therefore it is necessary for neural bandit methods to be robust against potential adversarial corruptions. Furthermore, existing neural bandit works generally require _arm separateness assumptions_ (e.g., assuming a positive-definite Neural Tangent Kernel [NTK] Gram matrix [86; 84; 26], or positive arm Euclidean distances [11; 67]), which will require no duplicate arm contexts are observed (or chosen) by the learner. This can lead to additional vulnerabilities when arm contexts are intentionally chosen by the adversary (e.g., assigning duplicate arms in the candidate pool across different rounds), making the arm separateness assumption fail in such adversarial environments.

Motivated by aforementioned challenges, in this paper, we propose a novel neural contextual bandit algorithm named Robust Neural-UCB (R-NeuralUCB), which can model the discrepancy among candidate arms and adopt arm-specific context-aware Gradient Descent (GD) to enhance model robustness against reward corruptions. Instead of applying ordinary GD to update the network parameters, R-NeuralUCB utilizes a fine-grained GD strategy by modeling the importance level of training samples, to reduce the impact of potential adversarial reward corruptions. Meanwhile, to improve the model performance from both the theoretical and empirical perspectives, R-NeuralUCB simultaneously perceives the uncertainty levels of candidate arms, and adaptively customizes network parameters for each of these candidates. To deal with the exploitation-exploration dilemma, R-NeuralUCB is equipped with an informative exploration mechanism based on Upper Confidence Bound (UCB) to achieve principled exploration. In addition, we present regret analysis without the commonly adopted _arm separateness assumption_, which reinforces R-NeuralUCB's theoretical robustness under adversarial scenarios. Our contributions can be summarized as follows:

* **Problem Settings and Proposed algorithm:** We study a novel neural bandit problem, where the received arm reward can be potentially corrupted by the unknown adversary. To deal with this problem, we propose a novel neural bandit algorithm called R-NeuralUCB, which leverages a refined context-aware Gradient Descent training strategy to improve the model robustness against potential arm reward corruptions. While we consider all the observed arms are governed by the same unknown reward mapping function as in (1) similar to existing neural bandit works, our R-NeuralUCB interestingly maintains separate model parameters specific to the different candidate arms, for a fine-grained way of improving the robustness. This casts lights on our contributions of novel algorithmic designs, compared to related existing methods without an arm-specific modeling (e.g., [42] and our base algorithm NeuralUCB-WGD in Appendix E).
* **Theoretical Analysis:** With over-parameterized neural networks, we present the regret analysis for R-NeuralUCB. Given finite horizon \(T\), effective dimension of NTK Gram matrix \(\widetilde{d}\), and corruption level \(C\), R-NeuralUCB enjoys a data-dependent regret bound of \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+C\widetilde{d})\). In addition, to ensure R-NeuralUCB is capable of handling contexts specified by the adversary (e.g., duplicate arms across different rounds), our analysis removes the _arm separateness assumption_ dependency, a widely adopted assumption for neural bandit literature, which can be of independent interest.
* **Experiments:** We conduct experiments on publicly available real-world data sets with various specifications. Under different types of reward corruptions, our R-NeuralUCB can achieve better performance, and is less vulnerable to reward corruptions than baselines.

## 2 Related Works

**Contextual Bandits with Adversarial Corruptions.** To begin with, there have been numerous studies [76; 17; 29; 57; 63; 31; 22; 54] working on tackling adversarial reward corruptions under linear contextual bandit settings [59; 24]. A related topic is bandits with mis-specifications [36; 55; 33; 53; 53; 83; 75], where the deviation of reward estimation comes from problem modeling instead of the adversary. On the other hand, kernelized bandits [15; 40; 16] extend the adversarial corruption problem to non-linear cases by assuming the reward mapping is a functional in the specified RKHS [72], while comparable ideas are also applicable for robust Bayesian Optimization [52]. Adversarial corruptions are also studied for other formulations, such as Lipschitz bandits [49; 89] and MAB without contexts [18; 80]. However, compared with neural bandit methods, these works generally require assumptions on the reward function prior, which may not be satisfied in real-world scenarios.

**Neural Contextual Bandits.** Neural contextual bandits algorithms are proposed to leverage the representation power of neural networks, and relax the assumptions on the reward mapping functions that can be linear or non-linear. Neural-UCB [86] applies a fully-connected (FC) neural network for reward estimation and utilizes corresponding network gradients for principled exploration. Comparable ideas have been leveraged by other neural bandit works [84; 50; 25; 10; 37; 46; 9; 60; 11], and adopted under various application scenarios such as active learning [74; 13; 6], and bandit-based graph learning [66; 67; 51] with graph neural networks [77; 34; 35]. Alternatively, [81] utilizes the neural network to embed original arm contexts for regression. [26] utilizes inverse reward gap for exploration, and [48] achieves exploration with the reward perturbation. However, as these methods are not designed to defend against reward corruptions and widely require arm separateness assumptions, they can fail to meet the robustness requirements in an adversarial environment.

## 3 Problem Definition

Let \(T\) be the finite horizon. In round \(t\in[T]\), the learner receives \(K\) candidate arms \(\mathcal{X}_{t}\), \(|\mathcal{X}_{t}|=K\), and each arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) with arm index \(i\in[K]\) is described by a \(d\)-dimensional vector \(\bm{x}_{i,t}\in\mathbb{R}^{d}\). The learner will then choose one arm \(\bm{x}_{t}\in\mathcal{X}_{t}\) and receive its reward \(r_{t}\). The index of \(\bm{x}_{t}\) is denoted by \(i_{t}\in[K]\), s.t. \(\bm{x}_{t}=\bm{x}_{i_{t},t}\). Here, similar to existing works (e.g., [42; 16; 15; 86; 84]), we define _corruption-free_ arm reward \(\widetilde{r}_{i,t}\) for each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), as well as _corrupted_ arm reward \(r_{t}\) for chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\), as

\[\widetilde{r}_{i,t}=h(\bm{x}_{i,t})+\epsilon_{i,t}, r_{t}=\widetilde{r}_{t}+c_{t}=h(\bm{x}_{t})+\epsilon_{t}+c_{t},\] (1)

where \(h:\mathbb{R}^{d}\mapsto\mathbb{R}\) is an unknown reward mapping function that can be either linear or non-linear. \(\epsilon_{i,t}\in\mathbb{R}\) stands for zero-mean \(\nu\)-sub-Gaussian random noise which is standard for stochastic contextual bandit works (e.g., [24; 72; 86]), and \(c_{t}\in\mathbb{R}\) is the unknown adversarial corruption imposed by the adversary. While kernelized bandit works (e.g., [16; 72]) assume \(h(\cdot)\) belongs to the RKHS induced by specified kernels, we alternatively consider \(h(\cdot)\) as an arbitrary unknown function, and utilize the neural model to learn this mapping with flexibility.

Taking expectation w.r.t. zero-mean noise \(\epsilon\), for the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\), we denote its expected perturbed reward \(\mathbb{E}[r_{t}]=h(\bm{x}_{t})+c_{t}\); meanwhile, for each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), its expected corruption-free reward \(\mathbb{E}[\widetilde{r}_{i,t}]=h(\bm{x}_{i,t})\). Here, we consider \(\mathbb{E}[r]\) and \(\mathbb{E}[\widetilde{r}]\) both fall into value range \([0,1]\), analogous to existing works (e.g., [86; 84; 11; 50]). This is intuitive as numerous real-world applications work with bounded rewards (e.g., online recommendation tasks with normalized rating [67] or binary feedback [24]); and the adversary also needs its attack to be stealthly, by ensuring perturbed rewards fall into the normal value range. With previously chosen arms \(\{\bm{x}_{\tau}\}_{\tau\in[t]}\) up to round \(t\), we denote received context-reward tuples with _perturbed rewards_ as \(\mathcal{P}_{t}:=\{\bm{x}_{\tau},\tau_{\tau}\}_{\tau\in[t]}=\{\bm{x}_{i_{\tau}, \tau},r_{i_{\tau},\tau}\}_{\tau\in[t]}\), and the corresponding context-reward tuples with _corruption-free rewards_ as \(\widetilde{\mathcal{P}}_{t}:=\{\bm{x}_{\tau},\widetilde{r}_{\tau}\}_{\tau\in[t] }=\{\bm{x}_{i_{\tau},\tau},\widetilde{r}_{i_{\tau},\tau}\}_{\tau\in[t]}\), where each corruption-free but imaginary unobserved reward is \(\widetilde{r}_{\tau}=h(\bm{x}_{\tau})+\epsilon_{\tau},\tau\in[t]\) based on (1).

**Learning Objective.** Our objective is to minimize cumulative pseudo-regret for \(T\) rounds:

\[R(T)=\sum\nolimits_{t=1}^{T}\mathbb{E}[\widetilde{r}_{t}^{*}-\widetilde{r}_{t}],\] (2)

where \(\mathbb{E}[\widetilde{r}_{t}]=h(\bm{x}_{t})\) is the expected corruption-free reward of the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\), and \(\mathbb{E}[\widetilde{r}_{t}^{*}]=\max_{\bm{x}_{i,t}\in\mathcal{X}_{t}}[h(\bm{x} _{i,t})]\) stands for that of the optimal arm \(\bm{x}_{t}^{*}\in\mathcal{X}_{t}\).

**Corruption Level.** If the adversary determines the reward corruption \(c_{i,t}\) for each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) beforehand, without observing the learner's choice \(\bm{x}_{t}\), some works (e.g., [38]) formulate the corruption level measurement as \(C^{\prime}=\sum_{t\in[T]}[\max_{i\in[K]}|c_{i,t}|]\). In this work, similar to [42; 16], we alternatively consider reward corruptions are determined w.r.t. particular chosen arms \(\{\bm{x}_{t}\}_{t\in[T]}\), and formulate the corruption level as \(C=\sum_{t\in[T]}|c_{t}|\). This leads to \(C\leq C^{\prime}\).

## 4 Proposed Algorithm: Robust Neural-UCB (R-NeuralUCB)

Recall that in (1), arm rewards under neural bandit settings are governed by the unknown reward mapping function \(h(\cdot)\), where \(h(\cdot)\) can be an arbitrary function. For our proposed R-NeuralUCB, we adopt a neural network \(f(\cdot)\) to approximate \(h(\cdot)\) for reward estimation.

**Network Structure.** We use \(f(\cdot;\bm{\theta})\) to denote an FC network with depth \(L\geq 2\) and width \(m\in\mathbb{N}^{+}\):

\[f(\bm{x};\bm{\theta}):=\sqrt{m}\bm{\theta}_{L}\sigma(\bm{\theta}_{L-1}\sigma(\bm{ \theta}_{L-2}\ldots\sigma(\bm{\theta}_{1}\bm{x})))\] (3)where \(\sigma(\cdot)\) is element-wise ReLU activation, and we have trainable weight matrices \(\bm{\theta}_{1}\in\mathbb{R}^{m\times d}\), \(\bm{\theta}_{l}\in\mathbb{R}^{m\times m}\), \(2\leq l\leq L-1\), \(\bm{\theta}_{L}\in\mathbb{R}^{1\times m}\). For the ease of notation, we denote vectorized parameters

\[\bm{\theta}:=[\text{vec}(\bm{\theta}_{1})^{\intercal},\text{vec}(\bm{\theta}_ {2})^{\intercal},\ldots,\bm{\theta}_{L}]^{\intercal}\in\mathbb{R}^{p},\]

with the dimensionality of \(p\), and randomly initialized parameters are denoted by \(\bm{\theta}_{0}\). Then, we let \(g(\bm{x};\bm{\theta})=\text{vec}(\nabla_{\bm{\theta}}f(\bm{x};\bm{\theta})) \in\mathbb{R}^{p}\) be vectorized network gradients w.r.t. input \(\bm{x}\) and parameters \(\bm{\theta}\).

We motivate our proposed R-NeuralUCB by first mentioning a base algorithm named NeuralUCB with Weighted GD (NeuralUCB-WGD), which is elaborated in Appendix E. To begin with, NeuralUCB-WGD measures the uncertainty level of training samples (i.e., previously received arm-reward pairs) through their UCB values, as the UCB essentially measures _arm uncertainty levels_ in terms of reward estimation [24; 72; 86]. Then, different from conventional neural bandit methods that treat all training samples equally [86; 84], inspired by [42], NeuralUCB-WGD utilizes a weighted GD process to train neural model \(f(\cdot)\) for estimating arm rewards, where training samples with high uncertainty levels will be downplayed. The main idea is that although we do not know which training samples are corrupted, we instead aim to reduce potentially severe impacts caused by adversarial corruptions, by paying relatively more attention on the training samples (arm-reward pairs) with low uncertainty levels, for a stable GD training process. We also present corresponding regret analysis for NeuralUCB-WGD in Appendix E.2, as well as experiments in Section 6.

However, notice that the neural model will also perceive varying uncertainty levels for different candidate arms in terms of reward estimation. In this case, simply applying the same exploitation-exploration strategy across all candidate arms can overlook this discrepancy, leading to insufficient granularity w.r.t. reward estimation. For instance, regarding candidate arms with low uncertainty levels, it can be more beneficial to adequately leverage existing training samples for estimating their rewards, instead of sharing an identical exploitation-exploration strategy with other high-uncertainty candidate arms. Meanwhile, analogous to existing works (e.g., [42; 16; 15]), NeuralUCB-WGD supposes a known corruption level \(C\) for regret analysis (Theorem E.1), which can be difficult to satisfy if we have limited knowledge regarding the unknown adversary. With the above motivations, we propose R-NeuralUCB as a refined solution to further enhance neural model robustness against potential reward corruptions. For readers' reference, we also compare our proposed R-NeuralUCB and NeuralUCB-WGD with some regret results from existing works in Table 1.

### R-NeuralUCB: Robust Neural-UCB

Our R-NeuralUCB formulates a novel context-aware GD process, by taking the uncertainty information of both candidate arms and training samples into account, for neural network training and decision making. Here, R-NeuralUCB customizes individual sets of network parameters \(\bm{\theta}_{i,t-1}\) for each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t},i\in[K]\), before the actual arm recommendation. Afterwards, these arm-specific networks are applied for arm reward estimation, along with an informative arm-specific UCB-based exploration mechanism. The pseudo-code is presented in Algorithm 1.

**Arm Weight Formulation.** Inspired by NTK-based exploration mechanisms [86; 51; 66; 11; 84], we measure arm uncertainty levels with the weighted gradient norm of arms. With a regularization parameter \(\lambda>0\), we first define a weight-free gradient covariance matrix \(\bm{\tilde{\Sigma}}_{t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}g(\bm{x}_{\tau}; \bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m\). Here, \(\bm{\theta}_{\tau-1}\) is the shorthand of \(\bm{\theta}_{i_{\tau},\tau-1}\), representing the network parameters of the previously chosen arm \(\bm{x}_{\tau}=\bm{x}_{i_{\tau},\tau},\tau\in[t-1]\). Then, for each

\begin{table}
\begin{tabular}{l|c c|c} \hline \hline
**Algorithm** & Reward Function & Corruption \(C\) & Regret Bound* \\ \hline Robust OFUL [76] & Linear & Known & \(\widetilde{\mathcal{O}}(d\sqrt{T}+\sqrt{T\sum_{t=1}^{T}c^{2}})\) \\ CW-OFUL [42] & Linear & Known & \(\widetilde{\mathcal{O}}(d\sqrt{T}+Cd)\) \\ COBE + OFUL [76] & Linear & Unknown & \(\widetilde{\mathcal{O}}(d\sqrt{T}+\sqrt{T\sum_{t=1}^{T}c^{2}})\) \\ CW-OFUL (\(\widetilde{C}=\sqrt{T}\)) [42] & Linear & Unknown & \(\widetilde{\mathcal{O}}(d\sqrt{T})\), if \(C\leq\sqrt{T}\). Otherwise \(\mathcal{O}(T)\) \\ \hline Fast-slow GP-UCB [15] & Kernelized & Known & \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+C\widetilde{d}\sqrt{T})\) \\ RGB-PE [16] & Kernelized & Known & \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+C\widetilde{d}^{\nicefrac{{2}}{{2}}})\) \\ Fast-slow GP-UCB [15] & Kernelized & Unknown & \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+C\widetilde{d}\sqrt{T})\) \\ \hline NeuralUCB-WGD (Thm. E.1) & Arbitrary & Known & \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+C\widetilde{d}^{\nicefrac{{2}}{{2}}})\) \\ R-NeuralUCB (Thm. 5.6) & Arbitrary & Unknown & \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+C\widetilde{d}^{\nicefrac{{2}}{{2}}})\) \\ \hline \hline \end{tabular}

* \(d\): context dimension; \(\widetilde{d}\): NTK matrix effective dimension or kernel information gain; \(\beta\): data-dependent gradient deviation term.

\end{table}
Table 1: Comparison of \(T\)-round regret bounds with adversarial corruption level \(C\).

candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), we formulate its weight w.r.t. previously chosen arm \(\bm{x}_{\tau},\tau\in[t-1]\) as

\[w_{i,t}^{(\tau)}=\min\left\{1,\ \frac{\alpha\cdot\min_{\bm{x}\in\mathcal{X}_{t} }\|g(\bm{x};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\tilde{\Sigma}}_{t-1}^{-1}}^{2} }{g_{\tau}\cdot\|g(\bm{x}_{i,t};\bm{\theta}_{t-1})/\sqrt{m}\|_{(\bm{\tilde{ \Sigma}}_{t-1}^{(\kappa)})^{-1}}}\right\},\] (4)

with \(\kappa^{2}\)-scaled covariance matrix being \(\bar{\bm{\Sigma}}_{t-1}^{(\kappa)}:=\lambda\mathbf{I}+\kappa^{2}\cdot\sum_{ \tau\in[t-1]}g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{ \tau-1})^{\intercal}/m\), for a constant \(\kappa\in(0,1)\). Alternatively, we also denote \(w_{i,t}^{(\tau)}=\min\left\{1,\alpha\cdot\mathsf{frac}_{\tau}(\bm{x}_{i,t}; \mathcal{X}_{t},\bm{\bar{\Sigma}}_{t-1})\right\}\), with \(\mathsf{frac}_{\tau}(\cdot)\) being a shorthand that integrally represents the fraction term in (4). A tunable parameter \(\alpha>0\) and the squared round-wise minimum weighted norm \(\min_{\bm{x}\in\mathcal{X}_{t}}\|g(\bm{x};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{ \tilde{\Sigma}}_{t-1}^{-1}}^{2}\) in the numerator are applied for scaling purposes. We also include complementary discussions for arm weight scaling in Appendix B.5. Meanwhile, we have \(g_{\tau}=\|g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\|_{(\bm{\tilde{ \Sigma}}_{t-1}^{(\kappa)})^{-1}},\tau\in[t-1]\) quantifying uncertainty levels of previously chosen arms (training samples) motivated by UCB-based exploration strategies (e.g., [86, 42]). Since previous \(\{g_{\tau}\}_{\tau\in[t-1]}\) values can be reused, we only need to compute and store \(g_{t}\) for current round \(t\). As a result, if candidate arm \(\bm{x}_{i,t}\) is of high uncertainty (i.e., large \(\|g(\bm{x}_{i,t};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\tilde{\Sigma}}_{t-1}^{-1}}\) value), its arm weights \(\{w_{i,t}^{(\tau)}\}_{\tau\in[t-1]}\) will become small.

```
1:Input: Time horizon \(T\). GD iterations \(J\). Learning rate \(\eta\). Exploration coefficient \(\nu\). Scaling parameter \(\alpha\). Norm parameter \(S\). Regularization parameter \(\lambda\).
2:Initialization: Parameters \(\bm{\theta}_{0}\). Weight-free covariance matrix \(\bar{\bm{\Sigma}}_{0}=\lambda\mathbf{I}\). Records \(\mathcal{P}_{0}=\emptyset\).
3:for each round \(t\in[T]\)do
4: Observe a collection of \(K\) candidate arms \(\mathcal{X}_{t}=\{\bm{x}_{i,t}\}_{i\in[K]}\).
5:for each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\)do
6:if\(t\) equals to \(1\)then
7:\(\bm{\theta}_{i,t-1}\leftarrow\bm{\theta}_{0}\).
8:else
9: With arm weights \(\{w_{i,t}^{(\tau)}\}_{\tau\in[t-1]}\) in (4), train parameters \(\bm{\theta}_{i,t-1}\) with GD and the arm-specific loss function in (5) based on received records \(\mathcal{P}_{t-1}\).
10:endif
11: For candidate arm \(\bm{x}_{i,t}\), calculate its benefit score \(U(\bm{x}_{i,t})\) based on (6).
12:endfor
13: Choose arm \(\bm{x}_{t}=\arg\max_{\bm{x}_{i,t}\in\mathcal{X}_{t}}\left[U(\bm{x}_{i,t})\right]\) with the highest benefit score.
14: Receive arm reward \(r_{t}\), and update the records, such that \(\mathcal{P}_{t}\leftarrow\mathcal{P}_{t-1}\cup\{(\bm{x}_{t},r_{t})\}\).
15: Update the shorthand \(\bm{\theta}_{t-1}\leftarrow\bm{\theta}_{i_{t},t-1}\), and matrix \(\bar{\bm{\Sigma}}_{t}\leftarrow\bar{\bm{\Sigma}}_{t-1}+g(\bm{x}_{t};\bm{\theta} _{t-1})g(\bm{x}_{t};\bm{\theta}_{t-1})^{\intercal}/m\).
16:endfor ```

**Algorithm 1** Robust Neural-UCB (R-NeuralUCB)

**Model Training with Context-aware GD.** According to line 9 in Algorithm 1, we perform model training _before_ the actual arm recommendation in each round \(t\in\{2,\dots,T\}\). For each candidate \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), we train its arm-specific parameters \(\bm{\theta}_{i,t-1}\) with \(J\) iterations of GD and received records \(\mathcal{P}_{t-1}=\{(\bm{x}_{\tau},r_{\tau})\}_{\tau\in[t-1]}\). Starting from initialization \(\bm{\theta}_{i,t-1}^{(0)}=\bm{\theta}_{0}\), we have \(j\)-th GD iteration (\(j\in[J]\)) being \(\bm{\theta}_{i,t-1}^{(j)}=\bm{\theta}_{i,t-1}^{(j-1)}-\eta\nabla_{\bm{\theta}} \mathcal{L}_{i,t}(\mathcal{P}_{t-1};\bm{\theta}_{i,t-1}^{(j-1)})\), where \(\eta>0\) refers to the learning rate. We formulate a loss function \(\mathcal{L}_{i,t}(\cdot;\cdot),i\in[K]\) specified to candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) as

\[\mathcal{L}_{i,t}(\mathcal{P}_{t-1};\bm{\theta})=\sum\nolimits_{(\bm{x}_{\tau},r _{\tau})\in\mathcal{P}_{t-1}}\frac{w_{i,t}^{(\tau)}}{2}\cdot\big{|}f(\bm{x}_{ \tau};\bm{\theta})-r_{\tau}\big{|}^{2}+\frac{m\lambda}{2}\cdot\|\bm{\theta}- \bm{\theta}_{0}\|_{2}^{2},\] (5)

where the \(L_{2}\) loss is scaled by arm weights \(w_{i,t}^{(\tau)},\tau\in[t-1]\) from (4). Intuitively, if arm weights \(w_{i,t}^{(\tau)}\) are large (i.e., low uncertainty level), we proceed to train a neural model that adequately fits the collected training data (i.e., previously received records) \(\mathcal{P}_{t-1}\), instead of staying around the random initialization \(\bm{\theta}_{0}\) given the \(L_{2}\) regularization. On the other hand, if arm weights \(w_{i,t}^{(\tau)}\) are small, it means that the uncertainty level in terms of reward estimation is high. In this case, we prefer being relatively conservative to prevent potentially large impacts caused by adversarial corruptions. As a result, R-NeuralUCB will focus more on the training samples in \(\mathcal{P}_{t-1}\) with low uncertainty levels, and stay relatively close to the random initialization \(\bm{\theta}_{0}\) due to the regularization term in (5).

In practice, instead of starting from \(\bm{\theta}_{0}\) in each round \(t\in\{2,\ldots,T\}\), we can alternatively initiate the GD process from the existing trained parameters to reduce computational cost, inspired by the concept of warm-start GD [13]. Here, we can start from \(\bm{\theta}_{t-2}\), the parameters of the previously chosen arm \(\bm{x}_{t-1}\), and fine-tune arm-specific parameters \(\bm{\theta}_{i,t-1}\) for each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), based on its loss function \(\mathcal{L}_{i,t}(\cdot\cdot\cdot)\) and a small batch of samples from \(\mathcal{P}_{t-1}\). Further details are elaborated in Appendix B.6, and this approach is also applied for the experiments in Section 6.

**Arm Selection.** For candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) and arm weights \(\{w^{(\tau)}_{i,t}\}_{\tau\in[t-1]}\), we formulate its arm-specific gradient covariance matrix \(\bm{\Sigma}_{i,t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w^{(\tau)}_{i,t}\cdot g (\bm{x}_{\tau};\bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{ \intercal}/m\). Here, if the variance proxy value \(\nu\) in (1) is unknown, similar to existing works (e.g., [86; 84]), we deem \(\nu\geq 0\) as a tunable parameter to control the exploration intensity. With our UCB-type exploration motivated by Appendix Lemma C.11, we formulate the benefit score for arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) as

\[U(\bm{x}_{i,t})=f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})+\gamma_{i,t-1}\cdot\sqrt{ g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})^{\intercal}\bm{\Sigma}_{i,t-1}^{-1}g(\bm{x}_ {i,t};\bm{\theta}_{i,t-1})/m},\] (6)

where the confidence coefficient \(\gamma_{i,t-1}=\zeta\cdot\left(\nu\sqrt{\log\frac{\det(\bm{\Sigma}_{i,t-1})}{ \det(\bm{\lambda}\mathbf{I})}-2\log(\delta)}+\sqrt{\lambda}S\right)\), along with a constant \(\zeta>0\) from Lemma C.11. Afterwards, we choose \(\bm{x}_{t}=\arg\max_{\bm{x}_{i,t}\in\mathcal{X}_{t}}\left[U(\bm{x}_{i,t})\right]\) [line 13, Algorithm 1], based on calculated arm benefit scores in (6). After receiving reward \(r_{t}\), the collected records will be updated by \(\mathcal{P}_{t}\leftarrow\mathcal{P}_{t-1}\cup\{(\bm{x}_{t},r_{t})\}\) (line 14, Algorithm 1). We also update the shorthand for model parameters of the chosen arm as \(\bm{\theta}_{t-1}\leftarrow\bm{\theta}_{i_{t},t-1}\), and the weight-free covariance matrix \(\bm{\bar{\Sigma}}_{t}\leftarrow\bm{\bar{\Sigma}}_{t-1}+g(\bm{x}_{t};\bm{\theta }_{t-1})g(\bm{x}_{t};\bm{\theta}_{t-1})^{\intercal}/m\) for next round \(t+1\) (line 15, Algorithm 1).

In summary, the primary goal of R-NeuralUCB is to customize individual learning objectives (i.e., loss functions) for different candidate arms by leveraging arm uncertainty information before pulling an arm. For candidate arms with high uncertainty levels, the neural model may lack confidence in estimating rewards based on current records, due to potential reward corruptions, which can lead to significant estimation errors. In this situation, by using the regularization term \(\frac{m\lambda}{2}\|\bm{\theta}-\bm{\theta}_{0}\|_{2}^{2}\), we prefer to adopt a relatively conservative approach, training a model close to random initialization to mitigate the potentially large impacts of adversarial corruptions. This approach is inspired by existing work on enhancing model robustness through regularization techniques (e.g., [69; 23]). On the other hand, for candidate arms with low uncertainty, we aim to train neural models that fully utilize the received records for reward estimation. Since the model is confident in its estimation, the received samples can provide adequate reference. With larger arm weights, the loss function can focus more on the training samples, instead of staying closely around \(\bm{\theta}_{0}\).

## 5 Theoretical Analysis

To the best of our knowledge, we provide the first theoretical results under the neural bandit settings with adversarial reward corruptions, and our proof flow is distinct from those of linear and kernelized bandit works. In particular, as our ReLU activation in (3) is not Lipschitz smooth [3; 21], it leads to additional challenges for our theoretical analysis, since a small perturbation on rewards can lead to drastic changes of network gradients. As a result, even with a small corruption level \(C\), the corrupted model parameters trained by GD can significantly deviate from the imaginary network parameters trained with corresponding corruption-free rewards. Therefore, it is non-trivial to quantify corruption impacts from theoretical perspectives, which simultaneously makes our proof flow differ significantly from that of the vanilla Neural-UCB [86]. We include additional discussions on analysis distinctions and our contributions in Appendix B.3. To begin with, we first introduce some preliminaries.

**Parameter Initialization.** Analogous to existing works [86; 21; 3; 9; 84], for an \(L\)-layer network of width \(m\) in (3), we let its intermediate-layer matrices \(\bm{\theta}_{l}=\left(\begin{smallmatrix}\bm{\Lambda}&\bm{0}\\ \bm{0}&\bm{\Lambda}\end{smallmatrix}\right)\), \(l\in[L-1]\), where each element of matrix \(\bm{\Lambda}\) is drawn from Gaussian distribution \(\mathcal{N}(0,4/m)\). Similarly, let \(\bm{\theta}_{L}=(\bm{w}^{\intercal},-\bm{w}^{\intercal})\), where each element of vector \(\bm{w}\) is drawn from \(\mathcal{N}(0,2/m)\).

**Arm Context Normalization.** To ensure arm contexts are of unit length (i.e., \(\|\bm{x}_{i,t}\|=1,\forall i\in[K],t\in[T]\)) as in existing neural bandit works [86; 84; 11; 67; 50], we can apply the following transformation inspired by existing works [3; 86; 84] without loss of generality: with unprocessed context \(\widetilde{\bm{x}}_{i,t}\), we formulate the corresponding normalized arm context \(\bm{x}_{i,t}=[\frac{\widetilde{\bm{x}}_{i,t}}{2\cdot\|\widetilde{\bm{x}}_{i,t }\|_{2}},\ \frac{1}{2},\frac{\widetilde{\bm{x}}_{i,t}}{2\cdot\|\widetilde{\bm{x}}_{i,t} \|_{2}},\ \frac{1}{2}]\). It can be verified that we have three properties: (i) \(\|\bm{x}_{i,t}\|_{2}=1\); (ii) no two normalized arm contexts will be in opposite directions; and (iii) \(f(\bm{x}_{i,t};\bm{\theta}_{0})=0\) with the randomly initialized \(\bm{\theta}_{0}\).

**Definitions of NTK Matrices.** First, we denote imaginary corruption-free models as \(f(\cdot;\tilde{\bm{\theta}}_{t-1}),t\in[T]\) which are trained on corruption-free records \(\widetilde{\mathcal{P}}_{t}=\{\bm{x}_{\tau},\widetilde{r}_{\tau}\}_{\tau\in[t]},t \in[T]\), for the sake of theoretical analysis, and the learner does not need to own the imaginary model in practice. Let \(\{\bm{x}_{t}\}_{t\in[T]}=\{\bm{x}_{i_{t},t}\}_{t\in[T]}\) be arms chosen by the corrupted model \(f(\cdot;\bm{\theta})\), and \(\{\widetilde{\bm{x}}_{t}\}_{t\in[T]}=\{\bm{x}_{\widetilde{i}_{t,t}}\}_{t\in[T]}\) be those chosen by the corruption-free model \(f(\cdot;\tilde{\bm{\theta}})\) respectively. Then, define a union set \(\tilde{\mathcal{A}}_{T}:=(\{\bm{x}_{t}\}_{t=1}^{T}\cup\{\bm{x}_{t}^{*}\}_{t=1 }^{T}\cup\{\widetilde{\bm{x}}_{t}\}_{t=1}^{T})\), based on: (i) the chosen arms \(\{\bm{x}_{t}\}_{t=1}^{T}\), (ii) the optimal arms \(\{\bm{x}_{t}^{*}\}_{t=1}^{T}\) according to (2), and (iii) arms \(\{\widetilde{\bm{x}}_{t}\}_{t=1}^{T}\) chosen by the imaginary corruption-free models. Here, \(\mathcal{A}_{T}\) naturally contains _unique arms_ from these three arm collections, with cardinality \(|\tilde{\mathcal{A}}_{T}|\leq 3T\). Meanwhile, we simply merge these three arm collections to form \(\mathcal{A}_{T}\) (with cardinality \(|\mathcal{A}_{T}|=3T\)), which allows duplicate arms. Afterwards, we have the following _two formulations_ of the NTK Gram matrix: (i) The NTK Gram matrix \(\mathbf{H}\) with _possibly duplicate_ arms based on the collection \(\mathcal{A}_{T}\); (ii) the NTK matrix for _non-duplicate_ arms \(\tilde{\mathbf{H}}\) built upon the set \(\tilde{\mathcal{A}}_{T}\).

**Definition 5.1** (NTK Gram Matrix with _Possibly Duplicate_ Arms).: Let \(\mathcal{N}\) be the Gaussian distribution. With layer index \(l\in[L]\) and subscripts \(i,j\in\{1,\ldots,|\mathcal{A}_{T}|\}\) for enumerating across arms, comparable to [47, 86], define the following recursive process

\[\mathbf{H}^{0}_{i,j} =\bm{\Psi}^{0}_{i,j}=\langle\bm{x}_{i},\bm{x}_{j}\rangle, \mathbf{N}^{l}_{i,j}=\begin{pmatrix}\bm{\Psi}^{l}_{i,i}&\bm{\Psi}^{l }_{i,j}\\ \bm{\Psi}^{l}_{j,i}&\bm{\Psi}^{l}_{j,j}\end{pmatrix},\] (7) \[\bm{\Psi}^{l}_{i,j} =2\mathbb{E}_{a,b\sim\mathcal{N}(\mathbf{0},\mathbf{N}^{l-1}_{i,j })}[\sigma(a)\sigma(b)], \mathbf{H}^{l}_{i,j}=2\mathbf{H}^{l-1}_{i,j}\mathbb{E}_{a,b\sim \mathcal{N}(\mathbf{0},\mathbf{N}^{l-1}_{i,j})}[\sigma^{\prime}(a)\sigma^{ \prime}(b)]+\bm{\Psi}^{l}_{i,j}.\]

With \(\mathcal{A}_{T}\) containing _possibly duplicate arms_, we denote the NTK Gram matrix \(\mathbf{H}=(\mathbf{H}^{L}+\bm{\Psi}^{L})/2\in\mathbb{R}^{3T\times 3T}\), and expected reward vector \(\bm{h}=[h(\bm{x})]_{\bm{x}\in\mathcal{A}_{T}}\in\mathbb{R}^{3T}\). Existing works with the _arm separateness assumption_ (e.g., [86, 84, 9, 25, 81]) generally assume \(\mathbf{H}\succ\mathbf{0}\), while we do not.

**Definition 5.2** (NTK Gram Matrix with _Non-duplicate_ Arms).: Follow the recursive process in (7). With set \(\tilde{\mathcal{A}}_{T}\) containing _non-duplicate arms_, we denote the corresponding NTK matrix \(\tilde{\mathbf{H}}=(\tilde{\mathbf{H}}^{L}+\tilde{\bm{\Psi}}^{L})/2\in\mathbb{ R}^{|\tilde{\mathcal{A}}_{T}|\times|\tilde{\mathcal{A}}_{T}|}\), and expected reward vector \(\tilde{\bm{h}}=[h(\bm{x})]_{\bm{x}\in\tilde{\mathcal{A}}_{T}}\in\mathbb{R}^{| \tilde{\mathcal{A}}_{T}|}\), with \(|\tilde{\mathcal{A}}_{T}|\leq 3T\).

**Remark 5.3** (No Arm Separateness Assumption).: Existing neural bandit works generally impose separateness assumptions regarding the arm contexts: NTK-based approaches (e.g., [86, 84, 9, 51, 50]) commonly assume \(\mathbf{H}\succ\mathbf{0}\) which requires no two arms are parallel among \(\{\bm{x}_{i,t}\}_{i\in[K],t\in[T]}\); meanwhile, some other works (e.g., [11, 67]) assume the Euclidean separateness: \(\|\bm{x}_{i,t}-\bm{x}_{i^{\prime},t^{\prime}}\|_{2}>0\) if \((i,t)\neq(i^{\prime},t^{\prime}),\forall i,i^{\prime}\in[K],t,t^{\prime}\in[T]\). To avoid the arm separateness assumption, since \(\tilde{\mathcal{A}}_{T}\) contains all the unique arms from \(\mathcal{A}_{T}\), we alternatively build the confidence ellipsoid upon the NTK matrix \(\tilde{\mathbf{H}}\), and the ellipsoid will also hold for all the arms in \(\mathcal{A}_{T}\) for regret analysis (Lemma C.1). This also leads to our tighter definition of NTK norm term \(S\) (Theorem 5.6, Remark 5.8).

**Fact 5.4**.: Let \(\tilde{\lambda}_{0}\) be the minimum eigenvalue of matrix \(\tilde{\mathbf{H}}\), and \(\lambda_{0}\) be that of NTK matrix \(\mathbf{H}\). We have (i) \(\tilde{\lambda}_{0}=\lambda_{\text{min}}(\tilde{\mathbf{H}})>0\); and, (ii) \(\tilde{\lambda}_{0}\geq\lambda_{0}\geq 0\).

For (i) in Fact 5.4, since \(\tilde{\mathcal{A}}_{T}\) contains no parallel arms, matrix \(\tilde{\mathbf{H}}\) will be full-rank, leading to \(\tilde{\lambda}_{0}>0\). For (ii), if \(\tilde{\mathcal{A}}_{T}\neq\mathcal{A}_{T}\), then \(\mathcal{A}_{T}\) contains duplicate arms and matrix \(\mathbf{H}\) will be singular, s.t. \(\tilde{\lambda}_{0}>\lambda_{0}=0\). Otherwise, if \(\tilde{\mathcal{A}}_{T}=\mathcal{A}_{T}\), it will naturally lead to \(\tilde{\mathbf{H}}=\mathbf{H}\) and \(\tilde{\lambda}_{0}=\lambda_{0}\). Next, similar to existing neural bandit works (e.g., [86, 84]), we define the NTK Gram matrix effective dimension \(\tilde{d}\), which essentially measures the vanishing speed of NTK Gram matrix eigenvalues.

**Definition 5.5** (Effective Dimension of NTK Matrix [86, 84]).: Given the NTK matrix \(\mathbf{H}\) with possibly duplicate arms (Def. 5.1), its effective dimension is defined as \(\widetilde{d}=\frac{\log\det(\mathbf{1}+\mathbf{H}/\lambda)}{\log\left(1+TK/ \lambda\right)}\).

### Regret Analysis for R-NeuralUCB

We follow the pseudo-regret \(R(T)=\sum_{t=1}^{T}\mathbb{E}[\widetilde{r}_{t}^{*}-\widetilde{r}_{t}]\) in (2), which is defined based on the expected corruption-free reward of chosen arms and optimal arms across \(T\) rounds.

**Instance-dependent Gradient Deviation Term \(\beta\).** Recall that for a candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) in round \(t\in[T]\), its arm weight w.r.t. previously chosen arm \(\bm{x}_{\tau},\tau\in[t-1]\) in (4) can be represented by \(w_{i,t}^{(\tau)}=\min\left\{1,\alpha\cdot\textsf{frac}_{\tau}(\bm{x}_{i,t}; \mathcal{X}_{t},\tilde{\bm{\Sigma}}_{t-1})\right\}\), with the scaling parameter \(\alpha>0\). Here, we define a minimum fraction value as \(\beta=\min_{t\in[T],\tau\in[t-1]}\big{[}\min\{\textsf{frac}_{\tau}(\bm{x}_{t}; \mathcal{X}_{t},\tilde{\bm{\Sigma}}_{t-1}),\ \textsf{frac}_{\tau}(\widetilde{\bm{x}}_{t}; \mathcal{X}_{t},\tilde{\bm{\Sigma}}_{t-1})\}\big{]}\), whichis formulated to quantify the gradient deviation among arms. Here, the learner is not required to know \(\beta\), and we can adjust the scaling parameter \(\alpha\) in each round \(t\in[T]\) to constrain the round-wise minimum weight value \(\min\{w_{i,t}^{(\tau)}\}_{i\in[K],\tau\in[t-1]}\) (Subsection B.5), which leads to Theorem 5.6.

**Theorem 5.6**.: _With finite horizon \(T\in\mathbb{N}^{+}\), denote \(S\geq\sqrt{2\tilde{\bm{h}}^{\top}\tilde{\bm{h}}^{-1}\tilde{\bm{h}}},\beta>0\). Suppose \(\lambda\geq S^{-2}\), \(\eta\leq\mathcal{O}((TmL+m\lambda)^{-1})\), \(J\geq\widetilde{\mathcal{O}}(TL/\lambda)\). Let \(f(\cdot)\) be an \(L\)-layer FC network with width \(m\), and adjust the scaling parameter \(\alpha\), s.t. \(\min\{w_{i,t}^{(\tau)}\}_{i\in[K],\tau\in[t-1]}=\kappa^{2},\ \forall t\in[T]\), for a tunable constant \(\kappa\in(0,1)\) from (4). With \(\delta\in(0,1)\), let network width \(m\geq\Omega(\text{poly}(T,L,\kappa^{-1},\tilde{\lambda}_{0}^{-1},\lambda^{-1},S^{-1})\log(\delta^{-1}))\). With probability at least \(1-\delta\), R-NeuralUCB achieves the regret bound of_

\[R(T)\leq\ \mathcal{O}\bigg{(}\nu\sqrt{\widetilde{d}\log(\frac{\lambda+TK}{ \lambda})}-2\log(\delta)+S\sqrt{\lambda}\bigg{)}\widetilde{\mathcal{O}}\left( \sqrt{T\widetilde{d}/\kappa^{2}}\right)+\mathcal{O}\bigg{(}C\widetilde{d} \beta^{-1}\kappa^{2}\log(\frac{\lambda+TK}{\lambda})\bigg{)}.\]

The proof of Theorem 5.6 is in Appendix C. The first term on the RHS refers to the corruption-independent regret upper bound, which comparably matches the bound \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+S\sqrt{\widetilde{dT}})\) in existing corruption-free neural bandit works [86; 84]. Here, our corruption-dependent term is free of the NTK norm \(S\), which measures the complexity of reward mapping \(h(\cdot)\) (Appendix B.4). This is different from existing works (e.g., [15]) that include a parameter norm (similar to our NTK norm \(S\)) in their corruption-dependent terms, as the estimation error of confidence ellipsoids. In addition, inspired by [84], we can derive a \(T\)-independent upper bound for the \(\beta^{-1}\) term, when the arm contexts are nearly spreading within some low-dimensional subspace of the NTK-induced RKHS (Appendix C.9), as it will lead to small effective dimension \(\widetilde{d}\) and small eigenvalues of NTK matrix \(\bm{\mathrm{H}}\)[84]. Meanwhile, compared with the regret bound of our base algorithm NeuralUCB-WGD (Theorem E.1), Theorem 5.6 removes the assumption of known corruption \(C\); and, reduces the order of effective dimension \(\widetilde{d}\) as well as the dependency of NTK norm \(S\) for corruption-dependent terms.

**Remark 5.7** (Unknown corruption level \(C\)).: For Theorem 5.6, we do not assume \(C\) is known to the learner in advance, as practitioners can have little prior knowledge regarding the unknown adversary. This makes our regret analysis more challenging, compared with the existing works (e.g., [16]) where \(C\) is assumed known for setting hyper-parameters to achieve tight regret bounds.

**Remark 5.8** (Tighter definition for NTK norm \(S\)).: For existing works (e.g., [86; 84]), the NTK Gram matrix is generally defined with all the \(TK\) observed candidate arms, i.e., \(\{\bm{x}_{i,t}\}_{i\in[K],t\in[T]}\), while our NTK matrices (Def. 5.1 and 5.2) only rely on arm collection \(\mathcal{A}_{T}\) and set \(\tilde{\mathcal{A}}_{T}\), with cardinality \(|\tilde{\mathcal{A}}_{T}|\leq|\mathcal{A}_{T}|=3T\). This results in our parameter norm \(S\) that can be tighter compared to existing works (e.g., [84; 86]), because when constructing the confidence ellipsoid around the initialization \(\bm{\Theta}_{0}\) in Lemma C.1, our ellipsoid is intuitively tighter, as it only needs to ensure Eq. C.1 holds for arms in \(\tilde{\mathcal{A}}_{T}\) (with cardinality \(|\tilde{\mathcal{A}}_{T}|\leq 3T\)), rather than for all \(TK\) candidate arms.

**Remark 5.9** (Reducing the order of \(\widetilde{d}\) and removing the dependency of \(S\) for corruption-dependent terms).: For corruption-dependent terms involving \(C\), we have \(\widetilde{\mathcal{O}}(C\beta^{-1}\widetilde{d})\). Using NTK to align the information gain definition [16] with our effective dimension \(\widetilde{d}\), our result improves latest kernelized bandit works from \(\widetilde{\mathcal{O}}(\widetilde{d}^{3/2})\) to \(\widetilde{\mathcal{O}}(\widetilde{d})\) for corruption-dependent terms, given the NTK-induced RKHS and an indefinite arm space (Corollary 7 in [16]). Meanwhile, our corruption-dependent term is free of the NTK norm \(S\), while for some existing works with UCB-type exploration (e.g., [15]), they involve comparable parameter norms in their corruption-dependent regret terms, in order to quantify corruption impacts w.r.t. the reward mapping function complexity.

## 6 Experiments

We evaluate R-NeuralUCB and the base algorithm NeuralUCB-WGD (Appendix E) with experiments on three real data sets, under different adversarial corruption scenarios. Following definition in (2), we record the cumulative regret in terms of corruption-free rewards \(R(T)=\sum_{t\in[T]}\big{[}\widetilde{r}_{t}^{*}-\widetilde{r}_{t}\big{]}\). Note that the learner will still only have access to the potentially corrupted rewards \(r_{t},t\in[T]\). Our baselines consist of linear algorithms: Lin-UCB [24], CW-OFUL [42]; and conventional neural algorithms: Neural-UCB [86], Neural-TS [84]. Complementary experiment details are in Appendix A.

**MovieLens and Amazon Data Sets.** From _"MovieLens 20M rating data set"_[41], we choose 5,000 movies and 10,000 users with most reviews to form the user-movie matrix, and the entries are user ratings. Then, we consider the arm (user-item pair) features as the concatenation of corresponding user features and item features, which are obtained by singular value decomposition (SVD) and extracting item genome-scores respectively, with \(K=10\) and \(d=41\). The corruption-free arm rewards \(\widetilde{r}_{i,t}\) are user ratings normalized into range \([0,1]\). Here, we consider the "exaggerated reward corruption". If one pulled arm \(\bm{x}_{t}\) is attacked and its corruption-free reward \(\widetilde{r}_{t}\geq 0.5\), we exaggerate its reward to \(r_{t}=1\). Otherwise, if one pulled arm \(\bm{x}_{t}\) is attacked and \(\widetilde{r}_{t}<0.5\), we set its reward \(r_{t}=0\). _Amazon Recommendation data set_[43] consists of user reviews and corresponding ratings. With each piece of review (user-item pair) as an arm, we vectorize the review as the arm features using the "Sentire" package [85; 85], with \(K=10\) and \(d=41\). Similarly, the corruption-free arm rewards \(\widetilde{r}_{i,t}\) are normalized user ratings with the value range \([0,1]\). Different from MovieLens data set, we here consider the "reverse exaggerated corruption": if the pulled arm \(\bm{x}_{t}\) is attacked and its corruption-free reward \(\widetilde{r}_{t}\geq 0.5\), we downplay its reward to \(r_{t}=0\); or if the pulled arm \(\bm{x}_{t}\) is attacked and \(\widetilde{r}_{t}<0.5\), we alternatively set the corrupted reward \(r_{t}=1\).

**MNIST Data Set.** To perform online classification with bandit feedback experiment, we adopt the MNIST data set [56] which consists of \(10\) image classes. Similar to previous works (e.g., [86; 84]), given a sample \(\bm{x}\in\mathbb{R}^{d^{\prime}}\) in each round, we transform it into \(K=10\) arms, denoted by \(\bm{x}_{1}=(\bm{x},\bm{0},\dots,\bm{0}),\bm{x}_{2}=(\bm{0},\bm{x},\dots,\bm{0 }),\dots,\bm{x}_{10}=(\bm{0},\bm{0},\dots,\bm{x})\in\mathbb{R}^{10\times d^{ \prime}}\), s.t. \(d=10\times d^{\prime}\). The arm index that the learner chooses will be its predicted class, and the reward is \(1\) if the sample \(\bm{x}\) belongs to this class; otherwise, the reward will be \(0\). Here, we consider the symmetric "label-flipping" attack [39]. For example, when a sample from digit class 2 is attacked, its corrupted label will be switched to digit class \(9-2=7\), and the corrupted arm rewards will also change accordingly.

**Experiment Results.** The experiment results are shown in Fig. 1, and we also include a parameter study in Appendix A.2. Due to the representation power of neural networks, neural algorithms generally perform better than linear ones. In particular, for the MNIST data set, since the reward mapping can be relatively more complex, neural algorithms manage to achieve more significant improvements over the linear algorithms. Here, compared with conventional neural methods, our proposed NeuralUCB-WGD and R-NeuralUCB are more robust against adversarial reward corruptions. In particular, we see that R-NeuralUCB outperforms NeuralUCB-WGD on these three data sets, which helps support our claim that it is beneficial to involve the uncertainty information in terms of both training samples and candidate arms. When we increase the corruption intensity (three figures on the right), the overall results tend to be consistent with previous findings. Notice that the performance gap among algorithms on the Amazon data set tends to be smaller, as this setting becomes significantly more difficult (i.e., with up to \(\sim 8000\) regret) when we increase the corruption probability to \(50\%\). Meanwhile, for MNIST, when we increase \(C\) to 4000, the performance gap between our proposed algorithms and the conventional neural methods tends to increase, as the task becomes increasingly more complex. We also see that R-NeuralUCB still outperforms NeuralUCB-WGD given the increased corruption intensity, showing the benefit of involving the candidate arm information and customizing arm-specific model parameters.

## 7 Conclusion and Future Direction

In this paper, we propose a novel neural bandit algorithm named R-NeuralUCB to address potential adversarial corruption issues on arm rewards. To enhance model robustness against reward corruptions, R-NeuralUCB applies a refined, context-aware Gradient Descent procedure that incorporates arm uncertainty information. To demonstrate its effectiveness, we present a regret analysis of R-NeuralUCB to quantify the impacts of adversarial corruption. Furthermore, to ensure that R-NeuralUCB can handle arm contexts deliberately chosen by an adversary (e.g., duplicate arms across different rounds), our analysis avoids the commonly adopted arm separateness assumption in neural bandit literature, which can be of independent interest. Empirical evaluations on real datasets with varied specifications show the effectiveness of our proposed solution over baseline methods. A challenging future direction is to derive the theoretical lower bound for neural bandits with corruption, and we provide complementary discussions in Appendix B.7.

Figure 1: Regret results on real data sets. (Left three figures: For MovieLens and Amazon, corrupt the chosen arm reward with \(20\%\) probability. For MNIST, consider \(C=2000\) and randomly sample 2000 rounds for attack); (Right three figures: For MovieLens and Amazon: we corrupt reward with \(50\%\) probability; For MNIST: \(C=4000\) and randomly sample 4000 corrupted rounds).

## Acknowledgments and Disclosure of Funding

This work is supported by National Science Foundation under Award No. IIS-2117902, and Agriculture and Food Research Initiative (AFRI) grant no. 2020-67021-32799/project accession no.1024178 from the USDA National Institute of Food and Agriculture. The work is also supported in part by the National Science Foundation through awards IIS 21-31335, OAC 21-30835, DBI 20-21898, as well as a C3.ai research award. The views and conclusions are those of the authors and should not be interpreted as representing the official policies of the funding agencies or the government.

## References

* [1] Yasin Abbasi-Yadkori, David Pal, and Csaba Szepesvari. Improved algorithms for linear stochastic bandits. _Advances in neural information processing systems_, 24:2312-2320, 2011.
* [2] Shipra Agrawal and Navin Goyal. Thompson sampling for contextual bandits with linear payoffs. In _ICML_, pages 127-135. PMLR, 2013.
* [3] Zeyuan Allen-Zhu, Yuanzhi Li, and Zhao Song. A convergence theory for deep learning via over-parameterization. In _International Conference on Machine Learning_, pages 242-252. PMLR, 2019.
* [4] Sanjeev Arora, Simon S Du, Wei Hu, Zhiyuan Li, Ruslan Salakhutdinov, and Ruosong Wang. On exact computation with an infinitely wide neural net. _arXiv preprint arXiv:1904.11955_, 2019.
* [5] Peter Auer, Nicolo Cesa-Bianchi, and Paul Fischer. Finite-time analysis of the multiarmed bandit problem. _Machine learning_, 47(2-3):235-256, 2002.
* [6] Yikun Ban, Ishika Agarwal, Ziwei Wu, Yada Zhu, Kommy Weldemariam, Hanghang Tong, and Jingrui He. Neural active learning beyond bandits. _arXiv preprint arXiv:2404.12522_, 2024.
* [7] Yikun Ban and Jingrui He. Generic outlier detection in multi-armed bandit. In _Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining_, pages 913-923, 2020.
* [8] Yikun Ban and Jingrui He. Local clustering in contextual multi-armed bandits. In _Proceedings of the Web Conference 2021_, pages 2335-2346, 2021.
* [9] Yikun Ban, Jingrui He, and Curtiss B Cook. Multi-facet contextual bandits: A neural network perspective. In _Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery & Data Mining_, pages 35-45, 2021.
* [10] Yikun Ban, Yunzhe Qi, Tianxin Wei, Lihui Liu, and Jingrui He. Meta clustering of neural bandits. In _Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining_, pages 95-106, 2024.
* [11] Yikun Ban, Yuchen Yan, Arindam Banerjee, and Jingrui He. Ee-net: Exploitation-exploration neural networks in contextual bandits. _arXiv preprint arXiv:2110.03177_, 2021.
* [12] Yikun Ban, Yuchen Yan, Arindam Banerjee, and Jingrui He. Neural exploitation and exploration of contextual bandits. _arXiv preprint arXiv:2305.03784_, 2023.
* [13] Yikun Ban, Yuheng Zhang, Hanghang Tong, Arindam Banerjee, and Jingrui He. Improved algorithms for neural active learning. _Advances in Neural Information Processing Systems_, 35:27497-27509, 2022.
* [14] Alberto Bietti and Julien Mairal. On the inductive bias of neural tangent kernels. _Advances in Neural Information Processing Systems_, 32, 2019.
* [15] Ilija Bogunovic, Andreas Krause, and Jonathan Scarlett. Corruption-tolerant gaussian process bandit optimization. In _International Conference on Artificial Intelligence and Statistics_, pages 1071-1081. PMLR, 2020.

* [16] Ilija Bogunovic, Zihan Li, Andreas Krause, and Jonathan Scarlett. A robust phased elimination algorithm for corruption-tolerant gaussian process bandits. _Advances in Neural Information Processing Systems_, 35:23951-23964, 2022.
* [17] Ilija Bogunovic, Arpan Losalka, Andreas Krause, and Jonathan Scarlett. Stochastic linear bandits robust to adversarial attacks. In _International Conference on Artificial Intelligence and Statistics_, pages 991-999. PMLR, 2021.
* [18] Sebastien Bubeck, Nicolo Cesa-Bianchi, et al. Regret analysis of stochastic and nonstochastic multi-armed bandit problems. _Foundations and Trends(r) in Machine Learning_, 5(1):1-122, 2012.
* [19] Xu Cai and Jonathan Scarlett. On lower bounds for standard and robust gaussian process bandit optimization. In _International Conference on Machine Learning_, pages 1216-1226. PMLR, 2021.
* [20] Yuan Cao, Zhiying Fang, Yue Wu, Ding-Xuan Zhou, and Quanquan Gu. Towards understanding the spectral bias of deep learning. _arXiv preprint arXiv:1912.01198_, 2019.
* [21] Yuan Cao and Quanquan Gu. Generalization bounds of stochastic gradient descent for wide and deep neural networks. _Advances in Neural Information Processing Systems_, 32:10836-10846, 2019.
* [22] Vasileios Charisopoulos, Hossein Esfandiari, and Vahab Mirrokni. Robust and private stochastic linear bandits. In _International Conference on Machine Learning_, pages 4096-4115. PMLR, 2023.
* [23] Christopher A Choquette-Choo, Florian Tramer, Nicholas Carlini, and Nicolas Papernot. Label-only membership inference attacks. In _International conference on machine learning_, pages 1964-1974. PMLR, 2021.
* [24] Wei Chu, Lihong Li, Lev Reyzin, and Robert Schapire. Contextual bandits with linear payoff functions. In _AISTATS_, pages 208-214, 2011.
* [25] Zhongxiang Dai, Yao Shu, Arun Verma, Flint Xiaofeng Fan, Bryan Kian Hsiang Low, and Patrick Jaillet. Federated neural bandit. _arXiv preprint arXiv:2205.14309_, 2022.
* [26] Rohan Deb, Yikun Ban, Shiliang Zuo, Jingrui He, and Arindam Banerjee. Contextual bandits with online neural regression. _arXiv preprint arXiv:2312.07145_, 2023.
* [27] Yashar Deldjoo, Tommaso Di Noia, and Felice Antonio Merra. A survey on adversarial recommender systems: from attack/defense strategies to generative adversarial networks. _ACM Computing Surveys (CSUR)_, 54(2):1-38, 2021.
* [28] Aniket Anand Deshmukh, Urun Dogan, and Clay Scott. Multi-task learning for contextual bandits. In _NeurIPS_, pages 4848-4856, 2017.
* [29] Qin Ding, Cho-Jui Hsieh, and James Sharpnack. Robust stochastic linear contextual bandits under adversarial attacks. In _International Conference on Artificial Intelligence and Statistics_, pages 7111-7123. PMLR, 2022.
* [30] Audrey Durand, Charis Achilleos, Demetris Iacovides, Katerina Strati, Georgios D Mitsis, and Joelle Pineau. Contextual bandits for adapting treatment in a mouse model of de novo carcinogenesis. In _Machine learning for healthcare conference_, pages 67-82. PMLR, 2018.
* [31] Li Fan, Ruida Zhou, Chao Tian, and Cong Shen. Federated linear bandits with finite adversarial actions. _Advances in Neural Information Processing Systems_, 36, 2024.
* [32] Chelsea Finn, Pieter Abbeel, and Sergey Levine. Model-agnostic meta-learning for fast adaptation of deep networks. In _International conference on machine learning_, pages 1126-1135. PMLR, 2017.
* [33] Dylan J Foster, Claudio Gentile, Mehryar Mohri, and Julian Zimmert. Adapting to misspecification in contextual bandits. _Advances in Neural Information Processing Systems_, 33:11478-11489, 2020.

* [34] Dongqi Fu, Liri Fang, Ross Maciejewski, Vetle I. Torvik, and Jingrui He. Meta-learned metrics over multi-evolution temporal graphs. In _KDD 2022_, 2022.
* [35] Dongqi Fu and Jingrui He. SDG: A simplified and dynamic graph neural network. In _SIGIR 2021_, 2021.
* [36] Avishek Ghosh, Sayak Ray Chowdhury, and Aditya Gopalan. Misspecified linear bandits. In _Proceedings of the AAAI Conference on Artificial Intelligence_, volume 31, 2017.
* [37] Quanquan Gu, Amin Karbasi, Khashayar Khosravi, Vahab Mirrokni, and Dongruo Zhou. Batched neural bandits. _ACM/IMS Journal of Data Science_, 1(1):1-18, 2024.
* [38] Anupam Gupta, Tomer Koren, and Kunal Talwar. Better algorithms for stochastic bandits with adversarial corruptions. In _Conference on Learning Theory_, pages 1562-1578. PMLR, 2019.
* [39] B Han, Q Yao, X Yu, G Niu, M Xu, W Hu, I Tsang, and M Sugiyama. Robust training of deep neural networks with extremely noisy labels. In _Thirty-fourth Conference on Neural Information Processing Systems (NeurIPS)_, volume 2, page 4, 2020.
* [40] Eric Han and Jonathan Scarlett. Adversarial attacks on gaussian process bandits. In _International Conference on Machine Learning_, pages 8304-8329. PMLR, 2022.
* [41] F Maxwell Harper and Joseph A Konstan. The movielens datasets: History and context. _Acm transactions on interactive intelligent systems (tiis)_, 5(4):1-19, 2015.
* [42] Jiafan He, Dongruo Zhou, Tong Zhang, and Quanquan Gu. Nearly optimal algorithms for linear contextual bandits with adversarial corruptions. _arXiv preprint arXiv:2205.06811_, 2022.
* [43] Ruining He and Julian McAuley. Ups and downs: Modeling the visual evolution of fashion trends with one-class collaborative filtering. In _proceedings of the 25th international conference on world wide web_, pages 507-517, 2016.
* [44] Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua. Neural collaborative filtering. In _WWW_, pages 173-182, 2017.
* [45] Roger A Horn and Charles R Johnson. _Matrix analysis_. Cambridge university press, 2012.
* [46] Taehyun Hwang, Kyuwook Chai, and Min-hwan Oh. Combinatorial neural bandits. In _International Conference on Machine Learning_, pages 14203-14236. PMLR, 2023.
* [47] Arthur Jacot, Franck Gabriel, and Clement Hongler. Neural tangent kernel: Convergence and generalization in neural networks. _Advances in neural information processing systems_, 31, 2018.
* [48] Yiling Jia, Weitong ZHANG, Dongruo Zhou, Quanquan Gu, and Hongning Wang. Learning neural contextual bandits through perturbed rewards. In _International Conference on Learning Representations_, 2021.
* [49] Yue Kang, Cho-Jui Hsieh, and Thomas Chun Man Lee. Robust lipschitz bandits to adversarial corruptions. _Advances in Neural Information Processing Systems_, 36, 2024.
* [50] Parnian Kassraie and Andreas Krause. Neural contextual bandits without regret. In _International Conference on Artificial Intelligence and Statistics_, pages 240-278. PMLR, 2022.
* [51] Parnian Kassraie, Andreas Krause, and Ilija Bogunovic. Graph neural network bandits. _arXiv preprint arXiv:2207.06456_, 2022.
* [52] Johannes Kirschner and Andreas Krause. Bias-robust bayesian optimization via dueling bandits. In _International Conference on Machine Learning_, pages 5595-5605. PMLR, 2021.
* [53] Sanath Kumar Krishnamurthy, Vitor Hadad, and Susan Athey. Adapting to misspecification in contextual bandits with offline regression oracles. In _International Conference on Machine Learning_, pages 5805-5814. PMLR, 2021.

* Kuroki et al. [2024] Yuko Kuroki, Alberto Rumi, Taira Tsuchiya, Fabio Vitale, and Nicolo Cesa-Bianchi. Best-of-both-worlds algorithms for linear contextual bandits. In _International Conference on Artificial Intelligence and Statistics_, pages 1216-1224. PMLR, 2024.
* Lattimore et al. [2020] Tor Lattimore, Csaba Szepesvari, and Gellert Weisz. Learning with good feature representations in bandits and in rl with a generative model. In _International conference on machine learning_, pages 5662-5670. PMLR, 2020.
* LeCun et al. [1998] Yann LeCun, Leon Bottou, Yoshua Bengio, and Patrick Haffner. Gradient-based learning applied to document recognition. _Proceedings of the IEEE_, 86(11):2278-2324, 1998.
* Lee et al. [2021] Chung-Wei Lee, Haipeng Luo, Chen-Yu Wei, Mengxiao Zhang, and Xiaojin Zhang. Achieving near instance-optimality and minimax-optimality in stochastic and adversarial linear bandits simultaneously. In _International Conference on Machine Learning_, pages 6142-6151. PMLR, 2021.
* Li et al. [2020] Lei Li, Yongfeng Zhang, and Li Chen. Generate neural template explanations for recommendation. In _Proceedings of the 29th ACM International Conference on Information & Knowledge Management_, pages 755-764, 2020.
* Li et al. [2010] Lihong Li, Wei Chu, John Langford, and Robert E Schapire. A contextual-bandit approach to personalized news article recommendation. In _WWW_, pages 661-670, 2010.
* Lin et al. [2023] Xiaoqiang Lin, Zhaoxuan Wu, Zhongxiang Dai, Wenyang Hu, Yao Shu, See-Kiong Ng, Patrick Jaillet, and Bryan Kian Hsiang Low. Use your instinct: Instruction optimization using neural bandits coupled with transformers. _arXiv preprint arXiv:2310.02905_, 2023.
* Miller et al. [2014] Brad Miller, Alex Kantchelian, Sadia Afroz, Rekha Bachwani, Edwin Dauber, Ling Huang, Michael Carl Tschantz, Anthony D Joseph, and J Doug Tygar. Adversarial active learning. In _Proceedings of the 2014 workshop on artificial intelligent and security workshop_, pages 3-14, 2014.
* Miller et al. [2020] David J Miller, Zhen Xiang, and George Kesidis. Adversarial learning targeting deep neural network classification: A comprehensive review of defenses against attacks. _Proceedings of the IEEE_, 108(3):402-433, 2020.
* Mitra et al. [2022] Aritra Mitra, Arman Adibi, George J Pappas, and Hamed Hassani. Collaborative linear bandits with adversarial agents: Near-optimal regret bounds. _Advances in neural information processing systems_, 35:22602-22616, 2022.
* Mobasher et al. [2007] Bamshad Mobasher, Robin Burke, Runa Bhaumik, and Chad Williams. Toward trustworthy recommender systems: An analysis of attack models and algorithm robustness. _ACM Transactions on Internet Technology (TOIT)_, 7(4):23-es, 2007.
* Ning et al. [2021] Rui Ning, Jiang Li, Chunsheng Xin, and Hongyi Wu. Invisible poison: A blackbox clean label backdoor attack to deep neural networks. In _IEEE INFOCOM 2021-IEEE Conference on Computer Communications_, pages 1-10. IEEE, 2021.
* Qi et al. [2022] Yunzhe Qi, Yikun Ban, and Jingrui He. Neural bandit with arm group graph. _arXiv preprint arXiv:2206.03644_, 2022.
* Qi et al. [2023] Yunzhe Qi, Yikun Ban, and Jingrui He. Graph neural bandits. In _Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining_, KDD '23, page 1920-1931, New York, NY, USA, 2023. Association for Computing Machinery.
* Qi et al. [2024] Yunzhe Qi, Yikun Ban, Tianxin Wei, Jiaru Zou, Huaxiu Yao, and Jingrui He. Meta-learning with neural bandit scheduler. _Advances in Neural Information Processing Systems_, 36, 2024.
* Rosenfeld et al. [2020] Elan Rosenfeld, Ezra Winston, Pradeep Ravikumar, and Zico Kolter. Certified robustness to label-flipping attacks via randomized smoothing. In _International Conference on Machine Learning_, pages 8230-8241. PMLR, 2020.
* Scarlett et al. [2017] Jonathan Scarlett, Ilija Bogunovic, and Volkan Cevher. Lower bounds on regret for noisy gaussian process bandit optimization. In _Conference on Learning Theory_, pages 1723-1742. PMLR, 2017.

* [71] Ruixiang Tang, Mengnan Du, Ninghao Liu, Fan Yang, and Xia Hu. An embarrassingly simple approach for trojan attack in deep neural networks. In _Proceedings of the 26th ACM SIGKDD international conference on knowledge discovery & data mining_, pages 218-228, 2020.
* [72] Michal Valko, Nathan Korda, Remi Munos, Ilias Flaounas, and Nello Cristianini. Finite-time analysis of kernelised contextual bandits. In _Uncertainty in Artificial Intelligence_, 2013.
* [73] Sofia S Villar, Jack Bowden, and James Wason. Multi-armed bandit models for the optimal design of clinical trials: benefits and challenges. _Statistical science: a review journal of the Institute of Mathematical Statistics_, 30(2):199, 2015.
* [74] Zhilei Wang, Pranjal Awasthi, Christoph Dann, Ayush Sekhari, and Claudio Gentile. Neural active learning with performance guarantees. _Advances in Neural Information Processing Systems_, 34:7510-7521, 2021.
* [75] Zhiyong Wang, Jize Xie, Xutong Liu, Shuai Li, and John Lui. Online clustering of bandits with misspecified user models. _Advances in Neural Information Processing Systems_, 36, 2024.
* [76] Chen-Yu Wei, Christoph Dann, and Julian Zimmert. A model selection approach for corruption robust reinforcement learning. In _International Conference on Algorithmic Learning Theory_, pages 1043-1096. PMLR, 2022.
* [77] Max Welling and Thomas N Kipf. Semi-supervised classification with graph convolutional networks. In _International Conference on Learning Representations_, 2017.
* Dec. 1, 2022_, pages 1227-1232. IEEE, 2022.
* [79] Qingyun Wu, Huazheng Wang, Quanquan Gu, and Hongning Wang. Contextual bandits in a collaborative environment. In _SIGIR_, pages 529-538, 2016.
* [80] Yulian Wu, Xingyu Zhou, Youming Tao, and Di Wang. On private and robust bandits. _Advances in Neural Information Processing Systems_, 36, 2024.
* [81] Pan Xu, Zheng Wen, Handong Zhao, and Quanquan Gu. Neural contextual bandits with deep representation and shallow exploration. _arXiv preprint arXiv:2012.01780_, 2020.
* [82] Fuzhi Zhang and Quanqiang Zhou. Ensemble detection model for profile injection attacks in collaborative recommender systems based on bp neural network. _IET Information Security_, 9(1):24-31, 2015.
* [83] Weitong Zhang, Jiafan He, Zhiyuan Fan, and Quanquan Gu. On the interplay between misspecification and sub-optimality gap in linear contextual bandits. In _International Conference on Machine Learning_, pages 41111-41132. PMLR, 2023.
* [84] Weitong Zhang, Dongruo Zhou, Lihong Li, and Quanquan Gu. Neural thompson sampling. In _International Conference on Learning Representations_, 2021.
* [85] Yongfeng Zhang, Haochen Zhang, Min Zhang, Yiqun Liu, and Shaoping Ma. Do users rate or review? boost phrase-level sentiment labeling with review-level sentiment classification. In _Proceedings of the 37th international ACM SIGIR conference on Research & development in information retrieval_, pages 1027-1030, 2014.
* [86] Dongruo Zhou, Lihong Li, and Quanquan Gu. Neural contextual bandits with ucb-based exploration. In _International Conference on Machine Learning_, pages 11492-11502. PMLR, 2020.
* [87] Yao Zhou, Haonan Wang, Jingrui He, and Haixun Wang. From intrinsic to counterfactual: On the explainability of contextualized recommender systems. _CoRR_, abs/2110.14844, 2021.
* [88] Yao Zhou, Jianpeng Xu, Jun Wu, Zeinab Taghavi, Evren Korpeoglu, Achan Kannan, and Jingrui He. Pure: Positive-unlabeled recommendation with generative adversarial network. In _KDD_, 2021.

* [89] Shiliang Zuo. Corruption-robust lipschitz contextual search. In _International Conference on Algorithmic Learning Theory_, pages 1234-1254. PMLR, 2024.

Experiment Settings and Additional Experiments

### Experiment settings

For all UCB-based baselines, we choose the exploration parameter through grid search over the range \(\{0.01,0.1,1\}\). We set \(L=2\) for all deep learning models, including our proposed NeuralUCB-WGD and R-NeuralUCB, and set the network width to \(m=200\). The learning rate for all neural algorithms is chosen by grid search from the range \(\{0.0001,0.001,0.01\}\). For all methods, we select the regularization parameter \(\lambda\) from the range \(\{0.0001,0.001,0.01\}\). The scaling parameter \(\alpha\) for NeuralUCB-WGD and R-NeuralUCB is chosen from \(\{0.2,0.5,1\}\). All experiments are conducted on a server with an Intel Xeon CPU and NVIDIA V100 GPUs. Additionally, we provide further details on our baseline methods, which include two linear algorithms and two conventional neural algorithms:

* Lin-UCB [24; 59] uses linear regression as the reward estimation model and employs a UCB-based strategy for exploration.
* CW-OFUL [42] applies weighted linear ridge regression in instead of the standard one from Lin-UCB, with weights assigned to selected samples in proportion to reward estimation confidence.
* Neural-UCB [86] employs a single neural network to estimate arm rewards and calculates the UCB based on network gradients for exploration.
* Neural-TS [84] utilizes a fully connected network for arm reward estimation, along with the Thompson Sampling strategy [2] for exploration.

Additional Data Processing Details for Recommendation Data Sets.Here, we provide additional details about our data processing procedure. For the first data set, _MovieLens 20M rating data set_ (https://grouplens.org/datasets/movielens/20m/), we initially select 5,000 movies and 10,000 users with the **most reviews** to form a user-movie matrix, where the entries represent user ratings. The user features \(\bm{x}_{u}\in\mathbb{R}^{d^{\prime}}\) are derived via singular value decomposition (SVD) with a dimensionality of \(d^{\prime}=20\). Using the genome scores provided for each movie, we select the 20 tags with the highest variance and used their corresponding scores as movie features \(\bm{v}_{i}\in\mathbb{R}^{d^{\prime}}\). At each time step \(t\), given a user \(u_{t}\), we encode user information into the arm contexts following the Generalized Matrix Factorization (GMF) approach [44; 88] by concatenating the features \(\bm{x}_{i,t}=[\bm{x}_{u_{t}};\bm{v}_{i}]\in\mathbb{R}^{2d^{\prime}}\), where \(c\in\mathcal{C}_{t}\) and \(i\in[K]\), with \(K=10\). Finally, we concatenate a constant 0.01 to each \(\bm{x}_{i,t}\) and normalize the entire vector to obtain \(\bm{x}_{i,t}\in\mathbb{R}^{d}\), where \(d=41\). The corruption-free arm rewards \(\widetilde{r}_{i,t}\) are user ratings normalized to the range \([0,1]\). We consider the scenario of "exaggerated reward corruption": If a pulled arm \(\bm{x}_{t}\) is attacked and its corruption-free reward \(\widetilde{r}_{t}\geq 0.5\), we exaggerate its reward to \(r_{t}=1\). Conversely, if a pulled arm \(\bm{x}_{t}\) is attacked and its corruption-free reward \(\widetilde{r}_{t}<0.5\), we downplay its reward to \(r_{t}=0\).

For the Amazon Recommendation data set (https://jmcauley.ucsd.edu/data/amazon/index_2014.html), each user-item pair is associated with a review and the corresponding user rating. We transform the review text into vector representations to derive the arm contexts, following the text processing procedure in the "Sentires" package [85; 58]. We then set \(d=41\) and apply \(L_{2}\) normalization, with an arm pool size of \(K=10\). Similarly, the corruption-free arm rewards \(\widetilde{r}_{i,t}\) are normalized user ratings in the range \([0,1]\). Unlike the MovieLens data set, we apply a "reverse exaggerated corruption" approach here: If the pulled arm \(\bm{x}_{t}\) is attacked and its corruption-free reward \(\widetilde{r}_{t}\geq 0.5\), we downplay its reward to \(r_{t}=0\). Conversely, if the pulled arm \(\bm{x}_{t}\) is attacked and its corruption-free reward \(\widetilde{r}_{t}<0.5\), we set the corrupted reward to \(r_{t}=1\).

### Additional experiments: parameter study

We also include additional experiments with different regularization parameter values \(\lambda\) and exploration parameter values \(\nu\). On the MNIST data set (corruption level \(C=2000\)), we conduct experiments for NeuralUCB-WGD and R-NeuralUCB. We present the parameter study results in Tables 2 and 3. For both of our proposed algorithms, setting \(\nu\in(0.1,0.5]\) generally yields the best performance. However, with an overly small exploration coefficient (e.g., \(\nu=0.05\)), optimal empirical performance may not be achievable. Meanwhile, setting \(\lambda\) to smaller values, such as \(0.001\) or \(0.0001\), tends to result in the best performance. Increasingly large regularization parameter valuescan cause the trained model parameters \(\theta\) to remain close to their random initialization \(\bm{\theta}_{0}\), which can overly constrain the neural network's capacity to fit the underlying reward mapping function. Thus, practitioners can adjust the \(\lambda\) value based on specific application needs, as is common in other neural bandit studies (e.g., [86]). In practice, starting with small values like \(10^{-4}\) and performing a grid search to identify the optimal \(\lambda\) is a reasonable approach for R-NeuralUCB and NeuralUCB-WGD.

## Appendix B Complementary Discussions on the Content of the Main Body

In this section, we provide additional discussion to complement the main body content.

### Boarder impacts

Since our objective is to deal with the potential adversarial attacks in machine learning applications, this work can contribute to the goal of achieving trustworthy machine learning for general practitioners. Therefore, we do not perceive significant negative societal impacts that can be generated by this work.

### Limitations

One limitation of this work is the absence of a theoretical lower bound for neural bandits with adversarial corruptions. We would like to mention that this problem is significantly challenging and non-trivial. Given that we deal with an arbitrary reward function \(h(\cdot)\), which is considerably different from linear [42] and kernelized bandits [16], deriving the lower bound itself can lead to substantial contributions, potentially leading to a separate line of research works (e.g., [70] under kernelized bandit settings). Therefore, we consider the derivation of such a lower bound for neural bandits with adversarial corruptions as an interesting and challenging future direction of this work. Additional discussions on the lower bound can be found in Subsec. B.7.

### Theoretical contributions and comparisons with vanilla Neural-UCB

Recall that we propose deriving the regret bound using NTK-based regression techniques. Unlike linear bandit approaches (e.g., [42]) and kernel bandit methods (e.g., [16]), our regression is conducted on the network gradients \(g(\cdot;\bm{\theta}):=\mathrm{vec}(\nabla_{\bm{\theta}}f(\cdot;\bm{\theta}))\), which serve as the mapping for gradient-based NTK. In this framework, even for the same arm \(\bm{x}\), the NTK-embedded arm contexts can differ due to the corrupted parameters \(g(\bm{x};\bm{\theta})\) and the corruption-free parameters \(g(\bm{x};\widetilde{\bm{\theta}})\). To address this challenge, we define two sets of regression parameters corresponding to the corrupted model and the corruption-free model respectively. Then, using the corruption-free model \(f(\cdot;\widetilde{\bm{\theta}})\), we derive the confidence ellipsoid around its parameters \(\widetilde{\bm{\theta}}\). This serves as a proxy to quantify the parameter shift of the trained corrupted model parameters \(\bm{\theta}\), enabling us to establish the regret upper bound.

For the theoretical analysis of R-NeuralUCB presented in Theorem 5.6, we considerably modify the regret analysis workflow due to the following reasons: (i) To achieve improved performance, R-NeuralUCB differs from conventional neural bandit approaches by tuning separate sets of network parameters for each candidate arm after perceiving arm context information; (ii) To achieve a tighter regret bound and eliminate the assumption of a known corruption level \(C\), unlike in Theorem E.1,

\begin{table}
\begin{tabular}{l|c c c c} \hline \hline Algorithm \(\backslash\)\(\lambda\) value & \(\lambda=0.1\) & \(\lambda=0.01\) & \(\lambda=0.001\) & \(\lambda=0.0001\) \\ \hline NeuralUCB-WGD & 3244 \(\pm 95\) & 2782 \(\pm 90\) & 2156 \(\pm 105\) & 2103 \(\pm 119\) \\ R-NeuralUCB & 2933 \(\pm 101\) & 2501 \(\pm 93\) & 1989 \(\pm 67\) & 2127 \(\pm 92\) \\ \hline \hline \end{tabular}
\end{table}
Table 2: Regret results for different exploration regularization parameter values \(\lambda\) (with std.)

\begin{table}
\begin{tabular}{l|c c c c} \hline \hline Algorithm \(\backslash\)\(\nu\) value & \(\nu=1\) & \(\nu=0.5\) & \(\nu=0.1\) & \(\nu=0.05\) \\ \hline NeuralUCB-WGD & 2510 \(\pm 102\) & 2154 \(\pm 121\) & 2103 \(\pm 119\) & 2278 \(\pm 85\) \\ R-NeuralUCB & 2793 \(\pm 104\) & 2163 \(\pm 88\) & 1989 \(\pm 67\) & 2197 \(\pm 65\) \\ \hline \hline \end{tabular}
\end{table}
Table 3: Regret results for different exploration parameter values \(\nu\) (with std.)we cannot quantify the impact of \(C\) using the confidence ellipsoid. To address this, let \(x_{t}^{*}\) and \(x_{t}\) represent the optimal arm and the chosen arm by the corrupted model, respectively. We decompose the single-round pseudo-regret \(R_{t}=\min\{h(x_{t}^{*})-h(x_{t}),1\}\) into three components: (i) The prediction error of the corruption-free model; (ii) The reward estimation discrepancy between the corruption-free model and the corrupted model on the same arm; (iii) The arm selection discrepancy of the corrupted model induced by adversarial corruptions. Next, we apply carefully designed arm weights in (4) to guide the gradient descent process and mitigate the impact of adversarial corruptions. As a result, R-NeuralUCB achieves non-trivial theoretical improvements: (i) removing the assumption of a known corruption level \(C\) in regret analysis; (ii) eliminating the dependency on the NTK norm term \(S\) for corruption-dependent terms in the regret bound; (iii) reducing the order of corruption-dependent terms in the regret bound to the effective dimension \(\widetilde{d}\), from \(\mathcal{O}(\widetilde{d}^{3/2})\) to \(\mathcal{O}(\widetilde{d})\), compared with our base algorithm NeuralUCB-WGD and existing kernelized bandit algorithms (e.g., [16]).

In addition, as mentioned in Remark 5.3, existing neural bandit approaches typically impose separateness assumptions on observed arm contexts, whereas we do not. For example, Neural-UCB [86] assumes \(\mathbf{H}\succ\mathbf{0}\), which requires that no two arms are parallel among \(\{\bm{x}_{i,t}\}_{i\in[K],t\in[T]}\). In contrast, by formulating our NTK Gram matrices (Definitions 5.1 and 5.2), we complete our proof without the separateness assumption, reinforcing the theoretical robustness of our approach against possible arm contexts selected by an adversary (e.g., duplicate arm contexts across time steps). As in Remark 5.8, existing methods, including Neural-UCB [86, 84], generally define their NTK Gram matrices over all \(TK\) observed arms, i.e., \(\{\bm{x}_{i,t}\}_{i\in[K],t\in[T]}\). However, our NTK matrices (Definitions 5.1 and 5.2) are based on \(\mathcal{A}_{T}\) and \(\tilde{\mathcal{A}}_{T}\), where \(|\tilde{\mathcal{A}}_{T}|\leq|\mathcal{A}_{T}|=3T\). This formulation can result in a tighter NTK norm \(S\) compared with existing methods.

**Upper bound for vanilla Neural-UCB.** Meanwhile, to provide insights into the regret bound of Neural-UCB, one possible approach is to follow a similar analysis to the regret bound of NeuralUCB-WGD. The key idea here is to quantify the impact of adversarial corruptions on the confidence ellipsoid around the trained parameters. Referring to the derivations in Lemma F.1, and denoting the corruption-free confidence radius in round \(t\) as \(\tilde{\gamma}_{t-1}\), we obtain the corrupted confidence ellipsoid for Neural-UCB as \(\mathcal{C}_{t-1}=\left\{\theta:\|\theta-\theta_{t-1}\|_{\Gamma_{t-1}}\leq \gamma_{t-1}/\sqrt{m}\right\}\), where \(\gamma_{t-1}=\tilde{\gamma}_{t-1}+\mathcal{O}(CL\lambda^{-1/2})\). This result is derived by setting \(w_{\tau}=1\) for \(\tau\in[t-1]\) and applying the fact that \(\sum_{\tau\in[t]}c_{\tau}\leq C\), along with Lemma G.2 and the initialization of the gradient covariance matrix \(\Gamma\). Following the proof flow of Lemma 5.3 in [86], we obtain a regret upper bound of \(\tilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+\sqrt{S\widetilde{d}T}+CL\sqrt{ \widetilde{d}T/\lambda})\), which introduces an additional \(\tilde{\mathcal{O}}(\sqrt{T})\) to the corruption-dependent term.

**Over-parameterization.** For most neural bandit works with experiments (e.g., [84, 86, 25, 9, 11]), a gap exists between experiments and theoretical analysis. On one hand, as the number of layers \(L\) and hidden dimension \(m\) increase, neural networks become progressively harder to train, more time-consuming in inference, and more resource-intensive. To make neural bandits feasible for practical applications, these works generally use a neural network of ordinary size for experiments. It has been shown that even with ordinary-sized neural networks, neural bandit algorithms achieve notable performance gains over linear and kernel-based methods [86, 84, 9, 11, 67]. On the other hand, from a theoretical standpoint, neural networks need to be over-parameterized, with \(m\geq\mathcal{O}(\text{poly}(T))\), to approximate any arbitrary reward mapping function \(h(\cdot)\). Additionally, with over-parameterization, the difference between NTK-based regression models and neural networks becomes sufficiently small for regret analysis, which is essential in neural bandit research. Therefore, we use a two-layer fully connected network for experiments while performing theoretical analysis under over-parameterized settings, as in most existing neural bandit works (e.g., [86, 84, 9, 11, 67]).

### The definition and order of NTK norm parameter \(S\)

Recall that we have the NTK norm \(S\) defined as the upper bound of the weighted norm \(S\geq\|\breve{\mathbf{h}}\|_{\breve{\mathbf{H}}^{-1}}\), where \(\mathbf{h}\) refers to the vector of expected rewards and \(\breve{\mathbf{H}}\) refers to the NTK Gram matrix (Definition 5.2). We can follow existing neural bandit works [86, 50, 51, 84, 48] by considering that the reward mapping function \(h(\cdot)\) in (1) belongs to the Reproducing Kernel Hilbert Space (RKHS) \(\mathcal{H}\) induced by NTK. In this case, we can upper bound \(S\) with the RKHS norm, such that \(\|h\|_{\mathcal{H}}\geq S\), and the RKHS norm \(\|h\|_{\mathcal{H}}\) will not grow along with the finite horizon \(T\) (Remark 4.8 in [86]).

Meanwhile, we also would like to mention that this is a common formulation, and nearly all the neural bandit works (e.g., [86; 50; 51; 84; 9; 48]) will include a comparable NTK norm term in the regret bound. This is because the regret analysis of neural bandits is generally depending on the NTK regression approach. In this case, when constructing the confidence ellipsoid within the NTK-induced RKHS, we will need to involve the RKHS norm as the cost. Analogously, for the kernelized contextual bandits works (e.g., [72; 28; 16]), they inevitably involve the RKHS norm into the regret bound. For linear bandit works (e.g., [42]), they will also need to include an assumed upper bound of the true parameter \(\bm{\theta}^{*}\) norm in the Euclidean space, such that \(\|\bm{\theta}^{*}\|_{2}\) is bounded by a constant. Meanwhile, since the NTK norm term \(S\) stays invariant across candidate arms \(x_{i,t}\in\mathcal{X}_{t}\), we can treat \(S\) as a constant in practice (e.g., setting \(S=1\)), and control the exploration intensity by tuning the exploration parameter \(\nu\).

### Details regarding the scaling of arm weights \(w\)

Recall that when defining the sample weights \(w^{(\tau)}_{i,t}\) in (4), we use the minimum gradient norm in the numerator to scale weights across the current candidate arms \(\mathcal{X}_{t}\), while introducing the scaling parameter \(\alpha>0\) to provide additional control from the practitioner's perspective. Under the stochastic contextual bandit settings, the learner receives the candidate arm pool \(\mathcal{X}_{t}\) in each round \(t\) from the environment, having little control over the minimum gradient norm, as \(\mathcal{X}_{t}\) is only revealed at round \(t\). To address this, we introduce a tunable parameter \(\alpha\) to control the minimum value of \(w^{(\tau)}_{i,t}\), aiming for a more stable learning process. Additionally, when deriving the regret bound for R-NeuralUCB (Theorem 5.6), we scale the \(\alpha\) values to ensure that the minimum weight value is \(\kappa^{2}\). Without this scaling, such as by setting \(\alpha=1\), an extra corruption-independent term \(\mathcal{O}(\sqrt{\beta^{-1}T\widetilde{d}\log(1+TK/\lambda)})\) would be added to the current regret bound, making the overall bound less tight. Therefore, the scaling parameter \(\alpha\) is essential for R-NeuralUCB.

Furthermore, the denominator of (4) consists of the product of two gradient norms: (i) the norm of the previously chosen arm \(g_{\tau}\), and (ii) the norm of the candidate arm \(\|g(\bm{x}_{i,t};\bm{\theta})/\sqrt{m}\|_{\bm{\Sigma}^{-1}}\). Here, we use the squared norm in the numerator to balance with the norm product in the denominator. This design is also critical for deriving the regret bound in Theorem 5.6. Without using the squared norm, our current derivation would yield a corruption-dependent term of \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}\beta^{-1}C)\), rather than the current \(\widetilde{\mathcal{O}}(\widetilde{d}\beta^{-1}C)\).

To be specific, for scaling the arm weight based on \(\kappa\), we first recall that in round \(t\in[T]\), we have arm weights \(w^{(\tau)}_{i,t},\tau\in[t-1],i\in[K]\). We can also denote \(w^{(\tau)}_{i,t}=\min\big{\{}1,\alpha\cdot\textsf{frac}_{\tau}(x_{i,t}; \mathcal{X}_{t},\bar{\Sigma}_{t-1})\big{\}}\). Here, instead of deeming \(\alpha\) as a fixed value across horizon \(T\), we can consider \(\alpha\) to be varying across different rounds, denoted by \(\alpha_{t},t\in[T]\). With a shorthand for minimum fraction value \(\textsf{frac}_{t}^{\textsf{min}}=\min_{i\in[K],\tau\in[t-1]}\big{[}\textsf{ frac}_{\tau}(x_{i,t};\mathcal{X}_{t},\bar{\Sigma}_{t-1})\big{]}\), we can set each \(\alpha_{t}=\kappa^{2}/\textsf{frac}_{t}^{\textsf{min}},\kappa\in(0,1)\). As a result, we can consequently have \(\min\{w^{(\tau)}_{i,t}\}_{i\in[K],\tau\in[t-1]}=\kappa^{2},\ \forall t\in[T]\).

### Warm-start training for candidate arms

Recall that in each round \(t\in\{2,\ldots,T\}\), we need to train different sets of arm-specific parameters \(\bm{\theta}_{i,t-1},i\in[K]\) according to Algorithm 1, for each of the candidate arms \(\bm{x}_{i,t}\in\mathcal{X}_{t},i\in[K]\). As we have mentioned in the main body, we can adopt the idea of warm-start GD [13] in practice. Here, instead of training each set of parameters \(\bm{\theta}_{i,t-1}\) from the randomly initialized \(\bm{\theta}_{0}\), we tune arm-specific parameters for each \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) with a small number of samples from current received records \(\mathcal{P}_{t-1}\). With the formulated arm weights \(w^{(\tau)}_{i,t}\) in (4), we first recall the arm-specific loss function associated with arm \(\bm{x}_{i,t}\) as

\[\mathcal{L}_{i,t}(\mathcal{P}_{t-1};\bm{\theta})=\sum_{(\bm{x}_{ \tau},r_{\tau})\in\mathcal{P}_{t-1}}\frac{w^{(\tau)}_{i,t}}{2}\cdot\big{|}f(\bm {x}_{\tau};\bm{\theta})-r_{\tau}\big{|}^{2}+\frac{m\lambda}{2}\cdot\|\bm{ \theta}-\bm{\theta}_{0}\|_{2}^{2}.\]

The idea is that instead of starting from \(\bm{\theta}_{0}\), we can initiate the GD process from the existing network parameters \(\bm{\theta}_{t-2}\) from the previous round \(t-1\), where \(\bm{\theta}_{t-2}=\bm{\theta}_{t_{t-1},t-2}\) represents the parameters associated with the chosen arm \(\bm{x}_{t-1}=\bm{x}_{i_{t-1},t-1}\) in round \(t-1\). The pseudo-code for this arm-specific warm-start GD process is provided in Algorithm 2.

As a result, in our experiments, to balance computational costs and model performance, we implement the following strategies: (1) Inspired by meta-learning approaches [32], we apply warm-start gradient descent (GD) by adapting previously trained network parameters \(\theta_{t-2}\) for each candidate arm, using a small number of training samples rather than starting from \(\theta_{0}\) with a large sample size; (2) Based on our formulation of the warm-start GD process, we sample a fixed number of mini-batch training samples (i.e., received arm-reward pairs) for each candidate arm to compute arm weights and perform GD. Using a fixed number of training samples helps keep round-wise inference time relatively stable, avoiding a drastic increase with \(T\). Figure 2 illustrates the parameter count and inference time across different hidden dimensions. As shown, inference time remains relatively stable due to the fixed number of adaptation samples used for warm-start GD.

### Additional discussions on the lower bound

Under linear bandit settings, there is a model-agnostic lower bound of corruption-dependent term \(\Omega(Cd)\) with probability at least \(1/2\)[17], which will also hold for neural bandit works as our \(h(\cdot)\) can be an arbitrary function. Meanwhile, the lower bounds for kernelized bandits tend to vary depending on kernel characteristics, e.g., \(\Omega(C(\log(T))^{d/2})\) for the SE kernel and \(\Omega(C^{\frac{v}{d+v}}T^{\frac{v}{d+v}})\) for the \(v\)-Matem kernel [70; 16]. In this case, the order of term \(C\) and whether the lower bound depends on non-logarithmic \(T\), will both depend on the kernel properties. Therefore, given close connections between NTK-based regression and over-parameterized networks, we hypothesize that such a lower bound for neural bandits with corruption can depend on NTK properties. However, it will require significant efforts and a well-established existing knowledge base (e.g., number of functions \(M\) needed for the functional separateness condition [70; 19] regarding specified kernels) to obtain such a lower bound for non-linear cases, especially considering few restrictions are imposed for reward mapping \(h(\cdot)\) for neural bandits. Since there are no existing works from neural bandits or NTK perspectives, it can lead to a different line of research work by proving these results. Therefore, we consider providing such a corruption-dependent regret lower bound as a challenging future direction.

Meanwhile, when \(C=0\), we obtain a corruption-free regret of \(\tilde{\mathcal{O}}(\tilde{d}\sqrt{T}+S\sqrt{\tilde{d}T})\). By setting \(C=\Omega(R_{T}/d)\), the regret bound becomes \(\tilde{\mathcal{O}}\left((\tilde{d}^{2}\sqrt{T}+S\tilde{d}^{3/2}\sqrt{T}) \cdot C\beta^{-1}d^{-1}\right)\). We note that, following the proof flow of Theorem 4.12 in [42] and the learning problem defined in Assumption

Figure 2: Number of parameters with hidden dimensions \(m\). Inference time with warm-start.

2.1 of [42], our effective dimension term \(\bar{d}^{2}\) may depend on the horizon \(T\) and can grow with \(T\)[26]. Consequently, although the regret bound contains only \(\sqrt{T}\) terms, the overall order of the regret bound could reach or exceed \(\mathcal{O}(T)\) due to the effective dimension \(\bar{d}^{2}\), as discussed in [26]. This behavior differs from that of linear bandits, where regret bounds generally depend on the horizon \(T\) and other \(T\)-independent terms, such as context dimension \(d\) and a fixed \(T\)-independent linear parameter norm \(\|\theta^{*}\|_{2}\). Therefore, our Theorem 5.6 will not contradict Theorem 4.12 in [42].

Regret Analysis for R-NeuralUCB

To begin with, recall that we aim to minimize the pseudo-regret for \(T\) rounds, denoted by

\[R(T)=\sum_{t=1}^{T}R_{t}=\sum_{t=1}^{T}\left[h(\bm{x}_{t}^{*})-h(\bm{x}_{t})\right]\]

where the second equality is due to the definition of reward mapping \(h\) in (1). We denote \(f(\cdot)\) as the bandit model we currently possess, which is trained with corrupted records \(\mathcal{P}_{t-1}\) up to round \(t\). Similarly, we can also suppose a corresponding imaginary corruption-free bandit model, which is trained with corruption-free records \(\widetilde{\mathcal{P}}_{t-1}\). Similarly, the model parameters of our possessed \(f(\cdot)\) are denoted as \(\bm{\theta}\), while the parameters of the imaginary corruption-free model will be denoted as \(\tilde{\bm{\theta}}\).

**Subsections outline and proof sketch.** The content in this section is organized into the following sub-components: In Subsection C.1, we first present theoretical properties related to our definitions of the NTK Gram matrix (Definitions 5.1 and 5.2); In Subsection C.2, we decompose the single-round objective \(R_{t},t\in[T]\) into its sub-components: (i) the first component represents the prediction error of the corruption-free model; (ii) the second component measures the potential arm selection discrepancy of the corrupted model caused by adversarial corruptions; and (iii) the third component captures the estimation discrepancy between the corruption-free model and the corrupted model. Next, in Subsection C.3, we bound the cumulative pseudo-regret \(R(T)\) (proof of Theorem 5.6). Using the auxiliary sequence introduced in Subsection C.4, we bound the components of the single-round regret in Subsections C.5 through C.8. Finally, we discuss bounding the minimum fraction term \(\beta\) in Subsection C.9, particularly when the observed arm contexts lie nearly within a low-dimensional subspace of the RKHS induced by NTK.

### Theoretical Results with NTK Gram Matrices

We will first introduce some results, in order to link the NTK matrices (Def. 5.1 and Def. 5.2) with the reward mapping function \(h(\cdot)\) and the gradient covariance matrix \(\bm{\Sigma}\) (Algorithm 1).

**Lemma C.1**.: _With probability at least \(1-\delta\), if network width \(m\) satisfies the condition in Theorem 5.6, for any \(\bm{x}\in\mathcal{A}_{T}\), there exists a set of parameters \(\bm{\theta}^{*}\) such that_

\[h(\bm{x})=\langle g(\bm{x};\bm{\theta}_{0}),\bm{\theta}^{*}-\bm{\theta}_{0}\rangle\] (C.1)

_where parameters \(\bm{\theta}^{*}\) satisfy \(\|\bm{\theta}^{*}-\bm{\theta}_{0}\|\leq S/\sqrt{m}\), along with the NTK norm \(S\geq\sqrt{2\tilde{\bm{h}}^{\mathsf{T}}\tilde{\mathbf{H}}^{-1}\tilde{\bm{h}}}\)._

**Proof.** The proof of this lemma is inspired by that of Lemma 5.1 in [86]. However, we build our proof upon the non-duplicate arms \(\tilde{\mathcal{A}}_{T}\) and the corresponding NTK Gram matrix \(\tilde{\mathbf{H}}\) (Def. 5.2), instead of imposing the full-rank assumption on the conventional NTK matrix \(\mathbf{H}\) (Def. 5.1). Here, we recall that the matrix \(\tilde{\mathbf{H}}\) is naturally positive definite (\(\tilde{\lambda}_{0}=\lambda_{\mathsf{min}}(\tilde{\mathbf{H}})>0\)), as it is the NTK Gram matrix built upon a set of distinct arms that are not parallel (Fact 5.4).

Then, consider the gradient matrix with no-duplicate arms \(\tilde{\mathbf{G}}=[g(\bm{x};\bm{\theta}_{0})]_{\bm{x}\in\tilde{\mathcal{A}}_ {T}}/\sqrt{m}\in\mathbb{R}^{p\times|\tilde{\mathcal{A}}_{T}|}\), where \(p\) represents the total number of parameters in the neural network. As a result, by applying conclusion from Lemma C.3 and due to the fact that \(|\tilde{\mathcal{A}}_{T}|\leq 3T\), with the network width \(m\geq\Omega(L^{6}\log(TL/\delta)/\epsilon)\), \(\forall\epsilon>0\) and the probability at least \(1-\delta\), we will have

\[\|\tilde{\mathbf{G}}^{\mathsf{T}}\tilde{\mathbf{G}}-\tilde{\mathbf{H}}\|_{F} \leq|\tilde{\mathcal{A}}_{T}|\cdot\epsilon.\]

By setting \(\epsilon=\frac{\tilde{\lambda}_{0}}{2|\tilde{\mathcal{A}}_{T}|}\), we will have

\[\tilde{\mathbf{G}}^{\mathsf{T}}\tilde{\mathbf{G}}\succeq\tilde{\mathbf{H}}- \|\tilde{\mathbf{G}}^{\mathsf{T}}\tilde{\mathbf{G}}-\tilde{\mathbf{H}}\|_{F} \mathbf{I}\succeq\tilde{\mathbf{H}}-\tilde{\lambda}_{0}/2\mathbf{I}\succeq \tilde{\mathbf{H}}/2\succ\mathbf{0}.\]

where the last two inequalities are due to Fact 5.4 that \(\tilde{\mathbf{H}}\succeq\tilde{\lambda}_{0}\mathbf{I}\succ\mathbf{0}\). Analogous to Lemma 5.1 in [86], we consider the singular value decomposition of \(\tilde{\mathbf{G}}\) being \(\tilde{\mathbf{G}}=\tilde{\mathbf{P}}\tilde{\mathbf{A}}\tilde{\mathbf{Q}}^ {\mathsf{T}}\), where we naturally have \(\tilde{\mathbf{A}}\succ 0\) since \(\tilde{\mathbf{H}}\) is positive definite. Then, with the expected reward vector \(\tilde{\bm{h}}\) (Def. 5.2), we have

\[\tilde{\bm{h}}=(\tilde{\mathbf{Q}}\tilde{\mathbf{A}}\tilde{\mathbf{P}}^{ \mathsf{T}})\cdot(\tilde{\mathbf{P}}\tilde{\mathbf{A}}^{-1}\tilde{\mathbf{Q}}^ {\mathsf{T}})\cdot\tilde{\bm{h}}=\sqrt{m}\cdot\tilde{\mathbf{G}}^{\mathsf{T}}( \bm{\theta}^{*}-\bm{\theta}_{0}),\]by considering there exists a set of parameters \(\bm{\theta}^{*}=\bm{\theta}_{0}+(\tilde{\mathbf{P}}\tilde{\mathbf{A}}^{-1}\tilde{ \mathbf{Q}}^{\intercal})\cdot\tilde{\bm{h}}/\sqrt{m}\).

Therefore, since \(\tilde{\bm{h}}=\sqrt{m}\cdot\tilde{\mathbf{G}}^{\intercal}(\bm{\theta}^{*}-\bm{ \theta}_{0})\), we will have \(\forall\bm{x}\in\tilde{\mathcal{A}}_{T}\),

\[h(\bm{x})=\langle g(\bm{x};\bm{\theta}_{0}),\bm{\theta}^{*}-\bm{\theta}_{0}\rangle.\]

Meanwhile, since \(\tilde{\mathbf{G}}^{\intercal}\tilde{\mathbf{G}}\succ\tilde{\mathbf{H}}/2\), by applying Lemma C.8, we will have the distance

\[m\cdot\|\bm{\theta}^{*}-\bm{\theta}_{0}\|_{2}^{2}=\bm{h}^{\intercal}\tilde{ \mathbf{Q}}\tilde{\mathbf{A}}^{-1}\tilde{\mathbf{P}}^{\intercal}\cdot\tilde{ \mathbf{P}}\tilde{\mathbf{A}}^{-1}\tilde{\mathbf{Q}}^{\intercal}\bm{h}=\bm{h} ^{\intercal}(\tilde{\mathbf{G}}^{\intercal}\tilde{\mathbf{G}})^{-1}\bm{h}\leq 2 \bm{h}^{\intercal}\tilde{\mathbf{H}}^{-1}\bm{h}.\]

Finally, since the above results holds \(\forall\bm{x}\in\tilde{\mathcal{A}}_{T}\), due to the fact that \(\tilde{\mathcal{A}}_{T}\) contains all the _unique arms_ of the collection \(\mathcal{A}_{T}\), we will directly have the above results regarding parameters \(\bm{\theta}^{*}\) feasible \(\forall\bm{x}\in\mathcal{A}_{T}\). This completes the proof.

\(\square\)

**Lemma C.2**.: _Suppose \(m\) satisfies the conditions in Theorem 5.6. Suppose the gradient matrix with randomly initialized parameters is \(\bm{\Sigma}^{(0)}=\lambda\mathbf{I}+\sum_{\bm{x}\in\mathcal{A}}g(\bm{x};\bm{ \theta}_{0})\cdot g(\bm{x};\bm{\theta}_{0})^{\intercal}/m\), upon an arbitrary subset \(\mathcal{A}\subseteq\mathcal{A}_{T}\) of arm collection \(\mathcal{A}_{T}\). With probability at least \(1-\delta\) over the initialization, the result holds:_

\[\log\left(\frac{\det\bm{\Sigma}^{(0)}}{\det\lambda\mathbf{I}}\right)\leq \widetilde{d}\log(1+TK/\lambda)+1.\]

**Proof.** First, recall that we have \(\mathcal{A}_{T}\) as the arm collection of: (i) the chosen arms \(\{\bm{x}_{t}\}_{t=1}^{T}\); (ii) the optimal arms \(\{\bm{x}_{t}^{*}\}_{t=1}^{T}\); (iii) and the imaginary ones \(\{\widetilde{\bm{x}}_{t}\}_{t=1}^{T}\) chosen by the corruption-free model. This makes its cardinality \(|\mathcal{A}_{T}|=3T\). Thus, for the left hand side, we have

\[\log\frac{\det(\bm{\Sigma}^{(0)})}{\det(\lambda\mathbf{I})}\leq\log\det( \lambda\mathbf{I}+\sum_{\bm{x}\in\mathcal{A}_{T}}g(\bm{x};\bm{\theta}_{0})g( \bm{x};\bm{\theta}_{0})^{\intercal}/m)=\det(\lambda\mathbf{I}+\mathbf{G}_{0} \mathbf{G}_{0}^{\intercal}),\]

where we define gradient matrix \(\mathbf{G}_{0}=\left[g(\bm{x};\bm{\theta}_{0})/\sqrt{m}\right]_{\bm{x}\in \mathcal{A}_{T}}\in\mathbb{R}^{p\times(3T)}\) based on arm collection \(\mathcal{A}_{T}\). Here, based on Lemma C.3, we can bound the distance between the Gradient matrix product \(\mathbf{G}_{0}^{\intercal}\mathbf{G}_{0}\) and the NTK matrix \(\mathbf{H}\) (Def. 5.1), as

\[\|\mathbf{G}_{0}^{\intercal}\mathbf{G}_{0}-\mathbf{H}\|\leq 3T\cdot\frac{1}{3T \cdot\mathcal{O}(\sqrt{T}/\lambda)}=\frac{1}{\mathcal{O}(\sqrt{T}/\lambda)},\]

by setting \(\epsilon=\frac{1}{3T\cdot\mathcal{O}(\sqrt{T}/\lambda)}\). The above results will hold, as long as we have the network width \(m\geq\Omega((TL)^{6}\log(TL/\delta)/\lambda^{4})\), matching the conditions in Theorem 5.6. As a result, we can have

\[\log\det(\mathbf{I}+\mathbf{G}_{0}^{\intercal}\mathbf{G}_{0}/\lambda)\] \[\qquad=\log\det(\mathbf{I}+\mathbf{H}/\lambda+(\mathbf{G}_{0}^{ \intercal}\mathbf{G}_{0}-\mathbf{H})/\lambda)\] \[\qquad\leq\log\det(\mathbf{I}+\mathbf{H}/\lambda)+\langle( \mathbf{I}+\mathbf{H}/\lambda)^{-1},(\mathbf{G}_{0}^{\intercal}\mathbf{G}_{0}- \mathbf{H})/\lambda\rangle\] \[\qquad\leq\log\det(\mathbf{I}+\mathbf{H}/\lambda)+\|(\mathbf{I} +\mathbf{H}/\lambda)^{-1}\|_{F}\|\mathbf{G}_{0}^{\intercal}\mathbf{G}_{0}- \mathbf{H}\|_{F}/\lambda\] \[\qquad\leq\log\det(\mathbf{I}+\mathbf{H}/\lambda)+\mathcal{O}( \sqrt{T}/\lambda)\cdot\|\mathbf{G}_{0}^{\intercal}\mathbf{G}_{0}-\mathbf{H}\|_{F}\] \[\qquad\leq\log\det(\mathbf{I}+\mathbf{H}/\lambda)+1\] \[\qquad=\widetilde{d}\log(1+TK/\lambda)+1.\]

The first inequality is because the convexity of \(\log\det(\cdot)\) function; The third inequality is due to \(\|(\mathbf{I}+\mathbf{H}\lambda)^{-1}\|_{F}\leq\|\mathbf{I}^{-1}\|_{F}\leq \sqrt{T}\); The fourth inequality is by applying the above distance upper bound \(\|\mathbf{G}_{0}^{\intercal}\mathbf{G}_{0}-\mathbf{H}\|\leq\frac{1}{\mathcal{O }(\sqrt{T}/\lambda)}\). The last inequality is because of the choice the \(m\); The last equality is because of the Definition of \(\widetilde{d}\). The proof is completed.

\(\square\)

**Lemma C.3**.: _With the randomly initialized network parameters \(\bm{\theta}_{0}\in\mathbb{R}^{p}\) and a collection of arms \(\mathcal{A}\subset\mathbb{R}^{d}\), define the gradient matrix \(\mathbf{G}_{\mathcal{A}}=[g(\bm{x};\bm{\theta}_{0})]_{\bm{x}\in\mathcal{A}}\in \mathbb{R}^{p\times|\mathcal{A}|}\). Following the recursive procedure in Def. 5.1 (7), construct the NTK Gram matrix \(\mathbf{H}_{\mathcal{A}}\) based on arms \(\mathcal{A}\). Then, with the probability at least \(1-\delta\), we will have_

\[\|\mathbf{G}_{\mathcal{A}}^{\intercal}\mathbf{G}_{\mathcal{A}}-\mathbf{H}_{ \mathcal{A}}\|_{F}\leq|\mathcal{A}|\cdot\epsilon,\]

_with the network width \(m\geq\Omega(L^{6}\log(|\mathcal{A}|L/\delta)/\epsilon^{4})\)._

**Proof.** The proof of this lemma is analogous to the proof of Lemma B.1 in [86]. Based on Theorem 3.1 from [4], we have that for any two arms \(\bm{x}\), \(\bm{x}^{\prime}\in\mathcal{A}\), as the network width \(m\geq\Omega(L^{6}\log(L/\delta)/\epsilon^{4})\), we will have \(|\langle g(\bm{x};\bm{\theta}_{0}),g(\bm{x}^{\prime};\bm{\theta}_{0})\rangle/m -\mathbf{H}_{\mathcal{A}}[\bm{x},\bm{x}^{\prime}]|\leq\epsilon\), where \(\mathbf{H}_{\mathcal{A}}[\bm{x},\bm{x}^{\prime}]\) represents the element in NTK Gram matrix \(\mathbf{H}_{\mathcal{A}}\) that corresponds to arms \(\bm{x}\) and \(\bm{x}^{\prime}\).

Next, taking the union bound over all the arms in \(\mathcal{A}\), we will have

\[\|\mathbf{G}_{\mathcal{A}}^{\intercal}\mathbf{G}_{\mathcal{A}}-\mathbf{H}_{ \mathcal{A}}\|_{F}=\sqrt{\sum_{\bm{x}\in\mathcal{A}}\sum_{\bm{x}^{\prime}\in \mathcal{A}}|\langle g(\bm{x};\bm{\theta}_{0}),g(\bm{x}^{\prime};\bm{\theta}_ {0})\rangle/m-\mathbf{H}_{\mathcal{A}}[\bm{x},\bm{x}^{\prime}]|^{2}}\leq| \mathcal{A}|\cdot\epsilon,\]

as long as the network width \(m\geq\Omega(L^{6}\log(|\mathcal{A}|L/\delta)/\epsilon^{4})\).

\(\Box\)

### Bounding single-round regret

With the above results linking the NTK to the neural model, we proceed to bound the single-round regret \(R_{t}\) for \(t\in[T]\). This single-round regret will then be aggregated to obtain the cumulative regret \(R(T)=\sum_{t\in[T]}R_{t}\).

Based on Lemma C.1, we have the expected reward of an arm \(\bm{x}\in\mathcal{X}_{t}\) being

\[\mathbb{E}[r|x]=h(x)=\langle g(x;\bm{\theta}_{0}),\ \bm{\theta}^{*}-\bm{ \theta}_{0}\rangle\]

where there exist parameters \(\bm{\theta}^{*}\) such that \(\|\bm{\theta}^{*}-\bm{\theta}_{0}\|\leq S/\sqrt{m}\). Meanwhile, apart from the trained parameters \(\bm{\theta}_{t-1}\) based on chosen arms as well as the corresponding received rewards \(\{\bm{x}_{\tau},r_{\tau}\}_{\tau\in[t-1]}\), we also denote the imaginary corruption-free parameters \(\widetilde{\bm{\theta}}_{t-1}\), which is trained with the chosen arms along with their unknown corruption-free rewards \(\{\bm{x}_{\tau},\widetilde{r}_{\tau}\}_{\tau\in[t-1]}\), for the sake of analysis.

#### c.2.1 Decomposing the single-round regret

To bound the single-round regret \(R_{t}\), we first decompose the objective into several individual terms, and then bound them individually. For reference, the parameters \(\bm{\theta}_{t-1}\), covariance matrix \(\bm{\Sigma}_{t-1}\), confidence ellipsoid \(\mathcal{C}_{t-1}\), and weights \(w_{t}\) pertain to the chosen arm \(\bm{x}_{t}\), with the arm index \(i\in[K]\) omitted for simplicity of notation.

**Arm selection scores.** First, recall that based on the arm pulling mechanism (line 13, Algorithm 1) and the benefit score (6) (Lemma C.11), the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\) is selected by

\[\bm{x}_{t} =\arg\max_{\bm{x}_{i,t}\in\mathcal{X}_{t}}\left[f(\bm{x}_{i,t}; \bm{\theta}_{i,t-1})+\gamma_{i,t-1}\cdot\sqrt{g(\bm{x}_{i,t};\bm{\theta}_{i,t -1})\intercal\bm{\Sigma}_{i,t-1}^{-1}g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/m}\right]\] \[=\arg\max_{\bm{x}_{i,t}\in\mathcal{X}_{t}}U(\bm{x}_{i,t}),\]

where we denote the corresponding score shorthand as

\[U(\bm{x}_{i,t})=f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})+\gamma_{i,t-1}\cdot\sqrt{g (\bm{x}_{i,t};\bm{\theta}_{i,t-1})\intercal\bm{\Sigma}_{i,t-1}^{-1}g(\bm{x}_{ i,t};\bm{\theta}_{i,t-1})}.\] (C.2)

Analogously, with \(\widetilde{\bm{\theta}}_{i,t-1}\) being the parameters trained on same set of chosen arms and the corresponding corruption-free rewards, we denote

\[\widetilde{U}(\bm{x}_{i,t})=f(\bm{x}_{i,t};\widetilde{\bm{\theta}}_{i,t-1})+ \widetilde{\gamma}_{i,t-1}\cdot\sqrt{g(\bm{x}_{i,t};\widetilde{\bm{\theta}}_{i,t-1})\intercal\widetilde{\bm{\Sigma}}_{i,t-1}^{-1}g(\bm{x}_{i,t};\widetilde{ \bm{\theta}}_{i,t-1})},\] (C.3)

with corresponding covariance matrix \(\widetilde{\bm{\Sigma}}_{i,t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{i,t}^{( \tau)}\cdot g(\bm{x}_{\tau};\widetilde{\bm{\theta}}_{\tau-1})g(\bm{x}_{\tau}; \widetilde{\bm{\theta}}_{\tau-1})^{\intercal}/m\), and the coefficient \(\widetilde{\gamma}_{i,t-1}\) based on \(\widetilde{\bm{\Sigma}}_{i,t-1}\) following the definition from (6). It is obvious that the arm selection depends on the trained network parameters, and thus if the corruption makes the makes the trained network parameters \(\bm{\theta}_{i,t-1}\) deviate from the corruption-free ones \(\widetilde{\bm{\theta}}_{i,t-1}\), it will lead to discrepancy in terms of arm selection decisions.

**Alternative forms of selection scores.** On the other hand, to maintain the consistency with the form of (C.1) in Lemma C.1, we can consider an alternative form of arm selection being

\[\begin{split} V(\bm{x}_{i,t})&=\big{\langle}g(\bm{x} _{i,t};\bm{\theta}_{0}),\ \bm{\theta}_{i,t-1}-\bm{\theta}_{0}\big{\rangle}+\gamma_{i,t-1}\cdot\sqrt{g( \bm{x}_{i,t};\bm{\theta}_{i,t-1})\intercal\bm{\Sigma}_{i,t-1}^{-1}g(\bm{x}_{i,t };\bm{\theta}_{i,t-1})/m}\\ &=\max_{\bm{\theta}\in\mathcal{C}_{i,t-1}}\big{\langle}g(\bm{x}_{ i,t};\bm{\theta}_{0}),\ \bm{\theta}-\bm{\theta}_{0}\big{\rangle}\end{split}\] (C.4)where we have \(\mathcal{C}_{i,t-1}:=\{\bm{\theta}:\|\bm{\theta}-\bm{\theta}_{i,t-1}\|_{\bm{ \Sigma}_{i,t-1}}\leq\gamma_{i,t-1}/\sqrt{m},\gamma_{i,t-1}>0\}\) being the confidence ellipsoid of for the actual trained parameters \(\bm{\theta}_{i,t-1}\), trained with possibly corrupted records. \(\gamma_{i,t-1}>0\) represents the radius of the confidence ellipsoid; and the last equality in (C.4) is due to \(\max_{\bm{x}:\|\bm{x}-\bm{b}\|_{\Delta\leq c}}\langle\bm{a},\bm{x}\rangle= \langle\bm{a},\bm{b}\rangle+c\cdot\sqrt{\bm{a}^{\intercal}\bm{\Lambda}^{-1} \bm{a}}\)[86]. Analogously, for the corruption-free parameters \(\widetilde{\bm{\theta}}_{i,t-1}\), we also define its confidence ellipsoid \(\widetilde{\mathcal{C}}_{i,t-1}:=\{\bm{\theta}:\|\bm{\theta}-\widetilde{\bm{ \theta}}_{i,t-1}\|_{\widetilde{\bm{\Sigma}}_{i,t-1}}\leq\widetilde{\gamma}_{i,t-1}/\sqrt{m},\widetilde{\gamma}_{i,t-1}>0\}\), with \(\widetilde{\gamma}_{i,t-1}>0\) being the radius of the confidence ellipsoid, and by Lemma C.10, we will have \(\bm{\theta}^{*}\in\widetilde{\mathcal{C}}_{i,t-1}\). As a result, we can also formulate an alternative form for arm selection as

\[\begin{split}\widetilde{V}(\bm{x}_{i,t})&=\big{\langle} g(\bm{x}_{i,t};\bm{\theta}_{0}),\;\widetilde{\bm{\theta}}_{i,t-1}-\bm{ \theta}_{0}\big{\rangle}+\widetilde{\gamma}_{i,t-1}\cdot\sqrt{g(\bm{x}_{i,t}; \widetilde{\bm{\theta}}_{i,t-1})^{\intercal}\widetilde{\bm{\Sigma}}_{i,t-1}^ {-1}g(\bm{x}_{i,t};\widetilde{\bm{\theta}}_{i,t-1})/m}\\ &=\max_{\widetilde{\bm{\theta}}\in\widetilde{\mathcal{C}}_{i,t-1 }}\big{\langle}g(\bm{x}_{i,t};\bm{\theta}_{0}),\;\widetilde{\bm{\theta}}-\bm{ \theta}_{0}\big{\rangle}.\end{split}\] (C.5)

Here, the radius of the confidence ellipsoid for the corruption-free parameters \(\widetilde{\gamma}_{i,t-1}\), is provided in Lemma C.10, ensuring that \(\bm{\theta}^{*}\in\widetilde{\mathcal{C}}_{i,t-1}\). On the other hand, deriving the radius for the trained model, \(\gamma_{i,t-1}\) in face of potential corruptions, is considerably more challenging. With our carefully designed arm weights in (4), we manage to establish the updated confidence ellipsoid in Lemma C.12, along with the corresponding UCB for reward estimation (Lemma C.11).

Note that our UCB-based exploration score (6) is also motivated by Lemma C.11. For a specific arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), our UCB-type exploration score includes only terms related to \(\bm{x}_{i,t}\), omitting constant and arm-invariant parts. This approach is intuitive, as arm-independent terms do not influence arm selection (line 13, Algorithm 1), and they will remain the same across candidate arms \(\mathcal{X}_{t}\). Moreover, with a sufficiently large network width \(m\) as in Theorem 5.6, a majority of these terms can be further reduced to \(\mathcal{O}(1)\).

**Decomposing the single-round objective.** Up to the time step \(t\in[T]\), denoting \(\bm{x}_{t},\bm{x}_{t}^{*}\in\mathcal{X}_{t}\) being the chosen arm and the optimal arm in each round respectively, we will have the corresponding regret bound for step \(t\) as:

\[\begin{split} R_{t}&=\min\bigg{\{}h(\bm{x}_{t}^{*} )-h(\bm{x}_{t}),\;1\bigg{\}}\\ &=\min\bigg{\{}h(\bm{x}_{t}^{*})-\widetilde{V}(\bm{x}_{t})+ \underbrace{\widetilde{V}(\bm{x}_{t})-h(\bm{x}_{t})}_{\widetilde{\text{UCB}}_{ t}(\bm{x}_{t})},\;1\bigg{\}}\\ &=\min\bigg{\{}\widetilde{\text{UCB}}_{t}(\bm{x}_{t})+\underbrace {h(\bm{x}_{t}^{*})-V(\bm{x}_{t})}_{I_{R_{1}}}+\underbrace{V(\bm{x}_{t})- \widetilde{V}(\bm{x}_{t})}_{I_{R_{2}}},\;1\bigg{\}}\end{split}\] (C.6)

where the first equality is because we have the expected rewards in bounded value range \([0,1]\). Here, with the three terms after decomposing the single-round regret \(R_{t}\), we can bound the first term \(\widetilde{\text{UCB}}_{t}(\bm{x}_{t})\) with Lemma C.9, while bounding the two error terms \(I_{R_{1}}\) and \(I_{R_{2}}\) with Lemma C.6 and Lemma C.4 respectively.

### Bounding cumulative regret \(R(t)\) (Proof of Theorem 5.6)

First, we would like to mention that since both the expected corrupted reward \(\mathbb{E}[r]\) and the expected corruption-free reward \(\mathbb{E}[\widetilde{r}]\) fall within the range \([0,1]\), as defined in (1), it follows that \(C\leq T\). In this case, as long as the network width requirement \(m\geq\Omega(\text{poly}(T))\) in Theorem 5.6 is adequately satisfied, this naturally implies \(m\geq\Omega(\text{poly}(C,T))\) with a sufficiently large network width \(m\). This also indicates that knowledge of \(C\) is not mandatory for setting \(m\) before the online learning process begins. The above clarification will also be used to establish the final regret bound.

Then, with the derived results in terms of single-round regret \(R_{t},t\in[T]\), we can then proceed to bound the cumulative regret over \(T\) rounds. By definition in (C.6), we have \(R(T)=\sum_{t=1}^{T}\min\bigg{\{}\widetilde{\text{UCB}}_{t}(\bm{x}_{t})+ \underbrace{h(\bm{x}_{t}^{*})-V(\bm{x}_{t})}_{I_{R_{1}}}+\underbrace{V(\bm{x}_ {t})-\widetilde{V}(\bm{x}_{t})}_{I_{R_{2}}},\;1\bigg{\}}\). Recall that the first term \(\widetilde{\text{UCB}}_{t}(\bm{x}_{t})\) can be bounded with Lemma C.9, while we bound the other two error terms \(I_{R_{1}}\) and with Lemma C.6 and Lemma C.4 respectively. Next, with the conclusions from above lemmas, we will have

\[R(T)=\sum_{t=1}^{T}\min\left\{\widetilde{\mathsf{UCB}}_{t}(\bm{x}_ {t})+\underbrace{h(\bm{x}_{t}^{*})-V(\bm{x}_{t})}_{I_{R_{1}}}+\underbrace{V(\bm {x}_{t})-\widetilde{V}(\bm{x}_{t})}_{I_{R_{2}}},\;1\right\}\] (C.7) \[\leq\sum_{t=1}^{T}\min\left\{2\widetilde{\gamma}_{t-1}\cdot\|g( \bm{x}_{t};\widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_ {t-1}^{-1}}+\gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{ \bm{\Sigma}_{t-1}^{-1}}\right.\] \[\quad+\mathcal{O}(\alpha C)\cdot\left\|g(\bm{x}_{t};\bm{\theta}_ {t-1})/\sqrt{m}\right\|_{(\widetilde{\bm{\Sigma}}_{t-1})^{-1}}^{2}+\mathcal{O }(\sqrt{\lambda}S)\cdot\left\|g(\widetilde{\bm{x}}_{t};\bm{\theta}_{i_{t},t-1} )/\sqrt{m}\right\|_{(\widetilde{\bm{\Sigma}}_{t-1}^{\prime})^{-1}}\] \[\quad+\mathcal{O}(\alpha C)\cdot\left\|g(\bm{x}_{t};\bm{\theta}_ {t-1})/\sqrt{m}\right\|_{(\widetilde{\bm{\Sigma}}_{t-1})^{-1}}^{2}+\mathcal{O }(\sqrt{\lambda}S)\cdot\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\| _{(\widetilde{\bm{\Sigma}}_{t-1})^{-1}}\] \[\quad+\mathcal{O}(m^{-2/3}\log(m)L^{7/2}t^{5/3}\lambda^{-5/3}(1+ \sqrt{t/\lambda}))\] \[\quad+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^{2 /7})+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6}L^{2/7})\] \[\quad+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{ 7/6}\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{3}t^{5/6} \lambda^{-7/12})\] \[\quad+\mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{7 /2})+\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2})\] \[\quad+\gamma_{t-1}\cdot\mathcal{O}(m^{-1/12}t^{7/12}\lambda^{-13/ 12}\log^{1/4}(m)L^{t/2})+\mathcal{O}(m^{-2/3}\log(m)L^{7/2}t^{5/3}\lambda^{-5/ 3}(1+\sqrt{t/\lambda})),\;1\right\}\]

where "weight-free" covariance matrices are \(\widetilde{\bm{\Sigma}}_{t-1}=\lambda\bm{\mathrm{I}}+\sum_{\tau\in[t-1]}g(\bm{x }_{\tau};\bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal }/m\), and \(\bm{\Sigma}_{t-1}^{\prime}=\lambda\bm{\mathrm{I}}+\sum_{\tau\in[t-1]}g( \widetilde{\bm{x}}_{\tau};\bm{\theta}_{i_{\tau},\tau-1})g(\widetilde{\bm{x}}_ {\tau};\bm{\theta}_{i_{\tau},\tau-1})^{\intercal}/m\). Afterwards, with sufficient network width \(m\) that satisfies the conditions in Theorem 5.6, the majority of the terms on the RHS of (C.7), which contain \(m\) to the negative order, can be reduced to \(\mathcal{O}(1)\). Thus, we will then have

\[R(T)\leq\;\mathcal{O}(1)+\sum_{t=1}^{T}\min\left\{2\widetilde{ \gamma}_{t-1}\cdot\|g(\bm{x}_{t};\widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{ \widetilde{\bm{\Sigma}}_{t-1}^{-1}}+\gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{ \theta}_{t-1})/\sqrt{m}\|_{\bm{\Sigma}_{t-1}^{-1}}\right.\] \[\quad+\mathcal{O}(\alpha C)\cdot\left\|g(\bm{x}_{t};\bm{\theta}_ {t-1})/\sqrt{m}\right\|_{(\widetilde{\bm{\Sigma}}_{t-1})^{-1}}^{2}+\mathcal{O }(\sqrt{\lambda}S)\left\|g(\widetilde{\bm{x}}_{t};\bm{\theta}_{t-1})/\sqrt{m} \right\|_{(\widetilde{\bm{\Sigma}}_{t-1}^{\prime})^{-1}}\] \[\quad+\mathcal{O}(\alpha C)\cdot\left\|g(\bm{x}_{t};\bm{\theta}_ {t-1})/\sqrt{m}\right\|_{(\widetilde{\bm{\Sigma}}_{t-1})^{-1}}^{2}+\mathcal{O }\big{(}\sqrt{\lambda}S\big{)}\cdot\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/ \sqrt{m}\right\|_{(\widetilde{\bm{\Sigma}}_{t-1})^{-1}},\;1\right\}\] \[\quad\leq\mathcal{O}(1)+\sum_{t=1}^{T}\min\left\{2\widetilde{ \gamma}_{t-1}\cdot\|g(\bm{x}_{t};\widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{ \widetilde{\bm{\Sigma}}_{t-1}^{-1}}+\gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{ \theta}_{t-1})/\sqrt{m}\|_{\bm{\Sigma}_{t-1}^{-1}}\;1\right\}\] \[\quad+\mathcal{O}(\alpha C)\cdot\sum_{t=1}^{T}\min\left\{\left\|g (\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{(\widetilde{\bm{\Sigma}}_{t-1 })^{-1}}^{2},1\right\}\] \[\quad+\mathcal{O}(\sqrt{\lambda}S)\sqrt{T\sum_{t=1}^{T}\min\left\{ \left\|g(\widetilde{\bm{x}}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{(\widetilde{ \bm{\Sigma}}_{t-1})^{-1}}^{2},1\right\}}\] \[\quad+\mathcal{O}\big{(}\sqrt{\lambda}S\big{)}\cdot\sqrt{T\sum_{t= 1}^{T}\min\left\{\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{( \widetilde{\bm{\Sigma}}_{t-1})^{-1}}^{2},1\right\}}\]

where the second inequality is by applying the triangular inequality. Then, denote \(w_{\mathsf{min}}=\min[\{w_{i,t}^{(\tau)},w_{i_{i},t}^{(\tau)}\}_{t\in[T],\tau\in[t -1]}]\). Analogously, we also have the round-wise minimum weight value being \(w_{t}^{\mathsf{min}}=\min\{w_{i,t}^{(\tau)}\}_{i\in[K],\tau\in[t-1]}=\kappa^{2}< 1,\;\forall t\in[T]\), which will be used to determine our scaling parameter \(\alpha\). With our notation from Theorem 5.6, this intuitively leads to \(\alpha\leq\frac{\kappa^{2}}{\beta}\). As a result, we can therefore have

\[R(T)\leq\mathcal{O}(1) +\sum_{t=1}^{T}\min\left\{2\widetilde{\gamma}_{t-1}\cdot\|g(\bm{x}_{ t};\widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{t-1}^{-1}}+ \gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\Sigma}_{t- 1}^{-1}},\;1\right\}\] \[\leq\mathcal{O}(1) +\sum_{t=1}^{T}\min\left\{2\widetilde{\gamma}_{t-1}\cdot\|g(\bm{x }_{t};\widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{t-1}^ {-1}}+\gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\Sigma }_{t-1}^{-1}},\;1\right\}\] \[+\mathcal{O}\big{(}C\beta^{-1}\kappa^{2}\big{)}\cdot\widetilde{d} \log(1+TK/\lambda)+\mathcal{O}\big{(}\sqrt{\lambda}S\big{)}\cdot\sqrt{T \widetilde{d}\log(1+TK/\lambda)}\] \[\leq\mathcal{O}(1) +\sum_{t=1}^{T}\min\left\{2\frac{\widetilde{\gamma}_{t-1}}{\sqrt{ w_{\mathsf{min}}}}\cdot\|\sqrt{w_{\mathsf{min}}}g(\bm{x}_{t};\widetilde{\bm{ \theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{t-1}^{-1}},\;1\right\}\] \[+\sum_{t=1}^{T}\min\left\{\frac{\gamma_{t-1}}{\sqrt{w_{\mathsf{ min}}}}\cdot\|\sqrt{w_{\mathsf{min}}}g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{ \bm{\Sigma}_{t-1}^{-1}},\;1\right\}\] \[+\mathcal{O}\big{(}C\beta^{-1}\kappa^{2}\big{)}\cdot\widetilde{d} \log(1+TK/\lambda)+\mathcal{O}\big{(}\sqrt{\lambda}S\big{)}\cdot\sqrt{T \widetilde{d}\log(1+TK/\lambda)}\] (C.8)

where the first inequality is because the auxiliary matrices \(\widetilde{\bm{\Sigma}}_{t-1}^{(0)}\) and \(\bm{\Sigma}_{t-1}^{\prime}\) do not involve arm weights, thus we can directly applying the Lemma G.7 and Lemma G.6. The second inequality is by applying Lemma C.2. Meanwhile, since \(\bm{\Sigma}_{t-1}^{\prime}\) is not defined w.r.t. randomly initialized \(\bm{\theta}_{0}\), we additional apply the Lemma G.6 in terms of the matrix determinant difference to derive the results, where the extra term will also be reduced to \(\mathcal{O}(1)\) with sufficiently large \(m\). Afterwards, for the rest of the summation terms in (C.8), we can have

\[R(T)\leq\mathcal{O}(\frac{\widetilde{\gamma}_{T}}{\sqrt{w_{ \mathsf{min}}}})\sqrt{T\sum_{t=1}^{T}\min\left\{\|\sqrt{w_{\mathsf{min}}}g( \bm{x}_{t};\widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_ {t-1}^{-1}}^{2},1\right\}}\] \[\qquad\qquad+\mathcal{O}\big{(}C\beta^{-1}\kappa^{2}\big{)}\cdot \widetilde{d}\log(1+TK/\lambda)+\mathcal{O}\big{(}\sqrt{\lambda}S\big{)}\cdot \sqrt{T\widetilde{d}\log(1+TK/\lambda)}+\mathcal{O}(1)\] \[\leq \frac{1}{\sqrt{w_{\mathsf{min}}}}\mathcal{O}\bigg{(}\nu\sqrt{ \log\frac{\det(\widetilde{\bm{\Sigma}}_{T})}{\det(\lambda\mathbf{I})}-2\log( \delta)}+\lambda^{1/2}S+\nu\sqrt{\log\frac{\det(\bm{\Sigma}_{T})}{\det( \lambda\mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S\bigg{)}\] \[\qquad\qquad\qquad\cdot\sqrt{T\widetilde{d}\log(1+TK/\lambda)}\] \[\qquad\qquad+\mathcal{O}\big{(}C\beta^{-1}\kappa^{2}\big{)}\cdot \widetilde{d}\log(1+TK/\lambda)+\mathcal{O}\big{(}\sqrt{\lambda}S\big{)}\cdot \sqrt{T\widetilde{d}\log(1+TK/\lambda)}+\mathcal{O}(1)\] \[\leq \frac{1}{\sqrt{w_{\mathsf{min}}}}\mathcal{O}\bigg{(}\lambda^{1/2}S +\nu\sqrt{\log\frac{\det(\widetilde{\bm{\Sigma}}_{T}^{(0)})}{\det(\lambda \mathbf{I})}+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}T^{5/3}\lambda^{-1/6})-2 \log(\delta)}\] \[\qquad+\nu\sqrt{\log\frac{\det(\bm{\Sigma}_{T}^{(0)})}{\det( \lambda\mathbf{I})}+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}T^{5/3}\lambda^{-1/ 6})-2\log(\delta)}\bigg{)}\sqrt{T\widetilde{d}\log(1+TK/\lambda)}\] \[\qquad+\mathcal{O}\big{(}C\beta^{-1}\kappa^{2}\big{)}\cdot \widetilde{d}\log(1+TK/\lambda)+\mathcal{O}\big{(}\sqrt{\lambda}S\big{)}\cdot \sqrt{T\widetilde{d}\log(1+TK/\lambda)}+\mathcal{O}(1),\] (C.9)

where the second inequality is by applying Lemma G.7 and Lemma C.2, as well as the definition of coefficients \(\gamma_{T},\widetilde{\gamma}_{T}\), along with the fact that \(\gamma_{T}\geq\gamma_{t},\widetilde{\gamma}_{T}\geq\widetilde{\gamma}_{t},t\in[T]\). The last inequality is by applying Lemma G.6. With sufficiently large network width \(m\) as in Theorem 5.6, we can have \(\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}T^{5/3}\lambda^{-1/6})\leq\mathcal{O}(1)\). Then, due to the fact that \(\widetilde{\bm{\Sigma}}_{T}^{(0)}\succeq\widetilde{\bm{\Sigma}}_{T}^{(0)}, \bm{\Sigma}_{T}^{(0)}\), applyingthe Lemma C.2, it will then lead to

\[R(T) \leq\frac{1}{\sqrt{w_{\mathsf{min}}}}\mathcal{O}\bigg{(}\nu\sqrt{ \widetilde{d}\log(1+TK/\lambda)-2\log(\delta)}+\lambda^{1/2}S\bigg{)}\sqrt{T \widetilde{d}\log(1+TK/\lambda)}\] (C.10) \[\qquad+\mathcal{O}\big{(}C\beta^{-1}\kappa^{2}\big{)}\cdot \widetilde{d}\log(1+TK/\lambda)+\mathcal{O}(1)\] \[\leq\mathcal{O}\bigg{(}\nu\sqrt{\widetilde{d}\log(1+TK/\lambda)- 2\log(\delta)}+\lambda^{1/2}S\bigg{)}\sqrt{T\widetilde{d}\log(1+TK/\lambda)/ \kappa^{2}}\] \[\qquad+\mathcal{O}\big{(}C\beta^{-1}\widetilde{d}\kappa^{2}\log(1 +TK/\lambda)\big{)}\]

where the second inequality is by setting the tunable parameter \(\alpha\) in each round accordingly, in order to ensure \(w_{\mathsf{min}}=\kappa^{2}<1\). Here, we remind that our regret analysis does not require the learner to know the minimum fraction value \(\beta\) before the online learning process, where \(\beta=\min_{t\in[T],\tau\in[t-1]}\big{[}\min\{\mathsf{frac}{\tau}(\bm{x}_{t}; \mathcal{X}_{t},\bm{\Sigma}_{t-1}),\mathsf{frac}{\tau}(\widetilde{\bm{x}}_{t };\mathcal{X}_{t},\bm{\Sigma}_{t-1})\}\big{]}\). As we have mentioned, in practice, the learner can scale the \(\alpha\) values in each round to make sure the round-wise minimum weight value \(w_{t}^{\mathsf{min}}=\min\{w_{i,t}^{(\tau)}\}_{i\in[K],\tau\in[t-1]}=\kappa^{2 }<1,\;\forall t\in[T]\) (Subsec. B.5).

### Auxiliary sequences: Regression parameters and gradient descent parameters

To bridge neural models with NTK regression, we have two different routes to decouple the effects of adversarial corruptions from the received arm rewards. First, we define the gradient-based ridge regression parameters specific to a candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) in round \(t\in[T]\), as

\[\bm{\Sigma}_{i,t-1}^{(0)} =\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}g(\bm{x}_{ \tau};\bm{\theta}_{0})\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})^{\intercal}/m,\] (C.11) \[\bm{\Sigma}_{i,t-1} =\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}g(\bm{x}_{ \tau};\bm{\theta}_{\tau-1})\cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{ \intercal}/m,\] (C.12) \[\bm{\widetilde{\Sigma}}_{i,t-1} =\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}g(\bm{x}_{ \tau};\widetilde{\bm{\theta}}_{\tau-1})\cdot g(\bm{x}_{\tau};\widetilde{\bm{ \theta}}_{\tau-1})^{\intercal}/m,\] (C.13) \[\bm{b}_{i,t-1}^{(0)} =\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}g(\bm{x}_{\tau};\bm{\theta}_{ 0})\cdot r_{\tau}/\sqrt{m}, \bm{b}_{i,t-1} =\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}g(\bm{x}_{\tau};\bm{\theta}_{ \tau-1})\cdot r_{\tau}/\sqrt{m},\] (C.14) \[\bm{\widetilde{b}}_{i,t-1}^{(0)} =\sum_{\tau\in[t-1]}w_{t}^{(\tau)}g(\bm{x}_{\tau};\bm{\theta}_{0} )\cdot\widetilde{r}_{\tau}/\sqrt{m}, \bm{\widetilde{b}}_{i,t-1} =\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}g(\bm{x}_{\tau};\bm{\theta}_{ \tau-1})\cdot\widetilde{r}_{\tau}/\sqrt{m},\] (C.15)

where \(\{\bm{x}_{\tau},r_{\tau}\},\tau\in[t]\) respectively stand for the chosen arms as well as their rewards, while \(\{\bm{x}_{\tau},\widetilde{r}_{\tau}\},\tau\in[t]\) refer to chosen arms and their imaginary corruption-free rewards. For notation simplicity, we use \(w_{t}^{(\tau)},\tau\in[t-1]\) to denote the arm weights for \(\bm{x}_{t}\).

Meanwhile, given an candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) with arm weight \(w_{i,t}^{(\tau)}\) defined in (4), we can try to bound the \(I_{2}\) term by decomposing the adversarial corruptions with a series auxiliary gradient sequences \(\{\bm{\theta}_{0},\bm{\Theta}^{(1)},\ldots,\bm{\Theta}^{(J)}\}\) as in Lemma D.1, such that for \(j\)-th iteration

\[\bm{\Theta}^{(j+1)} =\bm{\Theta}^{(j)}-\eta\cdot\bigg{[}\mathbf{J}^{(0)}\cdot\mathbf{ W}\cdot\big{(}[\mathbf{J}^{(0)}]^{\intercal}(\bm{\Theta}^{(j)}-\bm{\theta}_{0})- \bm{y}\big{)}+m\lambda(\bm{\Theta}^{(j)}-\bm{\theta}_{0})\bigg{]}\]

as well as an analogous sequence for corruption-free parameters

\[\widetilde{\bm{\Theta}}^{(j+1)} =\widetilde{\bm{\Theta}}^{(j)}-\eta\cdot\bigg{[}\mathbf{J}^{(0)} \cdot\mathbf{W}\cdot\big{(}[\mathbf{J}^{(0)}]^{\intercal}(\widetilde{\bm{ \Theta}}^{(j)}-\bm{\theta}_{0})-\widetilde{\bm{y}}\big{)}+m\lambda(\widetilde{ \bm{\Theta}}^{(j)}-\bm{\theta}_{0})\bigg{]}\]

where \(\mathbf{J}^{(0)}:=\big{(}g(\bm{x}_{1};\bm{\theta}_{0}),g(\bm{x}_{2};\bm{\theta} _{0}),\ldots,g(\bm{x}_{t-1};\bm{\theta}_{0})\big{)}\in\mathbb{R}^{p\times(t-1)}\), and \(\mathbf{W}\) refers to the diagonal matrix of arm weights \(\{w_{i,t}^{(\tau)}\}_{\tau\in[t-1]}\), along with the reward vectors \(\bm{y},\widetilde{\bm{y}}\in\mathbb{R}^{t-1}\) separately being the vector of received rewards and corruption-free rewards. In particular, with \([\mathbf{J}^{(0)}]_{\tau}\) being the \(\tau\)-th column of matrix \(\mathbf{J}^{(0)}\), the auxiliary sequence \(\bm{\Theta}^{(j)}\) can be deemed as applying Gradient Descent to solve the following optimization problem

\[\min_{\bm{\Theta}}\mathcal{L}(\bm{\Theta})=\sum_{\tau\in[t-1]}\frac{1}{2}\cdot w _{i,t}^{(\tau)}\cdot\left\|[\mathbf{J}^{(0)}]_{\tau}^{\intercal}(\bm{\Theta}- \bm{\theta}_{0})-y_{\tau}\right\|_{2}^{2}+\frac{1}{2}\cdot m\lambda\cdot\left\| \bm{\Theta}-\bm{\theta}_{0}\right\|_{2}^{2}\] (C.12)

Analogously, we can also derive the optimization problem for the sequence of corruption-free auxiliary parameters \(\widetilde{\bm{\Theta}}^{(j)}\), by applying the same definition of weight matrix \(\mathbf{W}\). Since the arm weights \(w\leq 1\) by definition, we will also have the diagonal matrix norm \(\|\mathbf{W}\|_{2}\leq 1\).

**Notation simplicity.** For reference, we remind that the parameters \(\bm{\theta}_{t-1}\), covariance matrix \(\bm{\Sigma}_{t-1}\), confidence ellipsoid \(\mathcal{C}_{t-1}\), and weights \(w_{t}\) pertain to the chosen arm \(\bm{x}_{t}\), with the arm index \(i\in[K]\) omitted for simplicity of notation. Meanwhile, the gradient covariance matrix \(\bm{\Sigma}_{i,t-1}\), confidence ellipsoid \(\mathcal{C}_{i,t-1}\), and weights \(w_{i,t}\) are associated with each candidate arm \(\bm{x}_{i,t}\) for \(i\in[K]\).

### Bounding the error term \(I_{r_{2}}\) in (C.6)

Recall that to derive the upper bound for the single-round regret \(R_{t}\), we need to respectively bound the three error terms on the RHS of (C.6). Here, we first bound term \(I_{R_{2}}\) with the following Lemma C.4.

**Lemma C.4**.: _Suppose the imaginary neural network \(f(\cdot;\widetilde{\bm{\theta}}_{t-1})\) in round \(t\in[T]\) has been trained on corruption-free rewards \(\{\bm{x}_{\tau},\widetilde{r}_{\tau}\}_{\tau\in[t-1]}\). Meanwhile, \(f(\cdot)\) is an \(L\)-layer FC network with width \(m\). Suppose we have \(m,J,\eta\) satisfying the conditions in Theorem 5.6. Then, for the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\), with the probability at least \(1-\delta\), we will have_

\[I_{R_{2}}= V(\bm{x}_{t})-\widetilde{V}(\bm{x}_{t})\] \[\leq \gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{ \bm{\Sigma}_{t-1}^{-1}}+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/ 6}L^{2/7})\] \[+\mathcal{O}(\alpha C)\cdot\left\|g(\bm{x}_{t};\bm{\theta}_{t-1}) /\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1})^{-1}}^{2}+\mathcal{O}(\sqrt{\lambda}S )\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{(\bm{\bar{\Sigma}}_ {t-1})^{-1}}\] \[+\mathcal{O}(m^{-2/3}\log(m)L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{ t/\lambda}))+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-1/6}L^{5})\] \[+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^{4})\] \[+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{7/2}).\]

_By definition, we have \(\gamma_{t-1}=\mathcal{O}\big{(}\nu\sqrt{\log\frac{\det(\bm{\Sigma}_{t-1})}{ \det(\lambda\bm{\Pi})}-2\log(\delta)}+\lambda^{1/2}S\big{)}\), as well as the gradient covariance matrix \(\bar{\bm{\Sigma}}_{t-1}=\lambda\bm{\Pi}+\sum_{\tau\in[t-1]}g(\bm{x}_{\tau}; \bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m.\) The minimum round-wise arm weight \(w_{t}^{\text{min}}=\min\{w_{i,t}^{(\tau)}\}_{i\in[K],\tau\in[t-1]}=\kappa^{2}< 1,\;\forall t\in[T]\) by scaling parameter \(\alpha\)._

**Proof.** For the error term \(I_{R_{2}}\), we have

\[I_{R_{2}} =V(\bm{x}_{t})-\widetilde{V}(\bm{x}_{t})\] \[=\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t};\bm{ \theta}_{0}),\;\bm{\theta}-\bm{\theta}_{0}\rangle-\max_{\widetilde{\bm{\theta}} \in\widetilde{\mathcal{C}}_{t-1}}\langle g(\bm{x}_{t};\bm{\theta}_{0}),\; \widetilde{\bm{\theta}}-\bm{\theta}_{0}\rangle\] \[\leq\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t}; \bm{\theta}_{0}),\;\bm{\theta}-\bm{\theta}_{0}\rangle-\langle g(\bm{x}_{t}; \bm{\theta}_{0}),\;\widetilde{\bm{\theta}}_{t-1}-\bm{\theta}_{0}\rangle\] \[\leq\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t}; \bm{\theta}_{0}),\;\bm{\theta}-\bm{\theta}_{0}\rangle-\langle g(\bm{x}_{t}; \bm{\theta}_{t-1}),\;\widetilde{\bm{\theta}}_{t-1}-\bm{\theta}_{0}\rangle+ \mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{7/2})\] \[=\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t};\bm{ \theta}_{0}),\;\bm{\theta}-\bm{\theta}_{t-1}\rangle-\langle g(\bm{x}_{t};\bm{ \theta}_{t-1}),\;\widetilde{\bm{\theta}}_{t-1}-\bm{\theta}_{t-1}\rangle+ \mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{7/2})\] \[=\underbrace{\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x }_{t};\bm{\theta}_{0}),\;\bm{\theta}-\bm{\theta}_{t-1}\rangle}_{\text{ Projection difference}}+\underbrace{\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\;\widetilde{\bm{\theta}}_{t-1}-\bm{ \theta}_{t-1}\rangle}_{I_{2}}|+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{- 2/3}L^{7/2})\] (C.13)

where the first inequality is because of the definition of confidence ellipsoids \(\widetilde{\mathcal{C}}_{t-1}\) and \(\mathcal{C}_{t-1}\). The second inequality is by applying Lemma G.3 and Lemma G.4. Here, we have the first term on the RHS is bounded by Corollary C.5, where this term is used to represent the gradient projection difference, between the confidence ellipsoid center parameters \(\bm{\theta}_{t-1}\) and the other parameters in this confidence ellipsoid \(\bm{\theta}\in\mathcal{C}_{t-1}\). Meanwhile, term \(I_{2}\) will be bounded by Corollary C.8.

**Corollary C.5**.: _Suppose the imaginary neural network \(f(\cdot;\widetilde{\bm{\theta}}_{t-1})\) in round \(t\in[T]\) has been trained on corruption-free rewards \(\{\bm{x}_{\tau},\widetilde{\tau}_{\tau}\}_{\tau\in[t-1]}\). Meanwhile, \(f(\cdot)\) is an \(L\)-layer FC network with width \(m\). Suppose we have \(m,J,\eta\) satisfying the conditions in Theorem 5.6. Then, for the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\), with the probability at least \(1-\delta\), we will have_

\[\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t};\bm{ \theta}_{0}),\;\bm{\theta}-\bm{\theta}_{t-1}\rangle\leq\gamma_{t-1}\cdot\|g( \bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\Sigma}_{t-1}^{-1}}+\mathcal{O} (m^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^{2/7}),\]

_and the corresponding summation value being_

\[\sum_{t\in[T]}\min\big{\{}\max_{\bm{\theta}\in\mathcal{C}_{t-1}} \langle g(\bm{x}_{t};\bm{\theta}_{0}),\;\bm{\theta}-\bm{\theta}_{t-1}\rangle,1 \big{\}}\] \[\qquad\leq\frac{1}{\sqrt{w_{t}^{\mathsf{min}}}}\mathcal{O}\bigg{(} \nu\sqrt{\log\frac{\det(\bm{\Sigma}_{T})}{\det(\lambda\mathbf{I})}-2\log( \delta)}+\lambda^{1/2}S\bigg{)}\cdot\sqrt{2T\cdot\log\frac{\det(\bm{\Sigma}_{T })}{\det(\lambda\mathbf{I})}}.\] \[\qquad\qquad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}T^{7/6}\lambda^{- 1/6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}T^{7/6}\lambda^{-7/6}L^{2/7}).\]

_By definition, we have the radius of \(\mathcal{C}_{t-1}\) being \(\gamma_{t-1}=\mathcal{O}\big{(}\nu\cdot\sqrt{\log\frac{\det(\bm{\Sigma}_{t-1} )}{\det(\lambda\mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S\big{)}\), and the gradient covariance matrix \(\bm{\Sigma}_{t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{t}^{(\tau)}\cdot g( \bm{x}_{\tau};\bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{ \intercal}/m\)._

Proof.: The proof of this corollary follows an analogous approach as Lemma C.9. By definition, we have the gradient inner product for the chosen arm \(\bm{x}_{t}\) in round \(t\) as

\[\max_{\bm{\theta}\in\mathcal{C}_{t-1}} \langle g(\bm{x}_{t};\bm{\theta}_{0}),\;\bm{\theta}-\bm{\theta}_{t -1}\rangle\] (C.14) \[\leq\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\|\bm{\theta}-\bm{ \theta}_{t-1}\|_{\bm{\Sigma}_{t-1}}\cdot\|g(\bm{x}_{t};\bm{\theta}_{0})\|_{\bm{ \Sigma}_{t-1}^{-1}}\] \[\leq\gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\| _{\bm{\Sigma}_{t-1}^{-1}}+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/ 6}L^{2/7})\]

where the first inequality is due to Holder's inequality. The second inequality is by applying the definition of confidence ellipsoid \(\mathcal{C}_{t-1}\), as well as Lemma G.4 and Lemma G.6. Then, similarly, we will also need to bound the summation over \(T\) rounds. Following an analogous procedure as in Lemma C.9, we will have

\[\sum_{t\in[T]}\min\{ \max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t};\bm{ \theta}_{0}),\;\bm{\theta}-\bm{\theta}_{t-1}\rangle,\;1\}\] \[\leq\frac{1}{\sqrt{w_{t}^{\mathsf{min}}}}\mathcal{O}\bigg{(}\nu \sqrt{\log\frac{\det(\bm{\Sigma}_{T})}{\det(\lambda\mathbf{I})}-2\log(\delta) }+\lambda^{1/2}S\bigg{)}\cdot\sqrt{2T\cdot\log\frac{\det(\bm{\Sigma}_{T})}{ \det(\lambda\mathbf{I})}}.\] \[\qquad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}T^{7/6}\lambda^{-1/6}L ^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}T^{7/6}\lambda^{-7/6}L^{2/7}).\]

By the definition \(\beta=\min_{t\in[T],\tau\in[t-1]}[\min\{\textsf{frac}_{\tau}(\bm{x}_{t}; \mathcal{X}_{t},\widetilde{\bm{\Sigma}}_{t-1}),\textsf{frac}_{\tau}(\widetilde {\bm{x}}_{t};\mathcal{X}_{t},\widetilde{\bm{\Sigma}}_{t-1})\}]\), we have the lower bound of arm weights being \(w_{t}^{\mathsf{min}}\geq\alpha\cdot\beta\). Note that we also scale the \(\alpha\) parameter to ensure \(w_{t}^{\mathsf{min}}=\kappa^{2}\) as indicated in the Subsec. B.5, which requires no prior knowledge for \(\beta\).

### Bounding the error term \(I_{r_{1}}\) in (C.6)

In this subsection, we bound the error term \(I_{R_{1}}\) in (C.6), with the following Lemma C.6. Meanwhile, we denote an extra weight-free gradient covariance matrix for the chosen arms \(\{\widetilde{\bm{x}}_{\tau}\}_{\tau\in[t]}\) of the corruption-free model. The corresponding arm index is denoted as \(\tilde{i}_{t},t\in[T]\), such that \(\bm{x}_{i_{t},t}=\widetilde{\bm{x}}_{t}\).

**Lemma C.6**.: _Suppose the imaginary neural network \(f(\cdot;\widetilde{\bm{\theta}}_{t-1})\) in round \(t\in[T]\) has been trained on corruption-free rewards \(\{\bm{x}_{\tau},\widetilde{\tau}_{\tau}\}_{\tau\in[t-1]}\). Meanwhile, \(f(\cdot)\) is an \(L\)-layer FC network with width \(m\).__Suppose we have \(m,J,\eta\) satisfying the conditions in Theorem 5.6. Then, for the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\), with the probability at least \(1-\delta\), we will have_

\[I_{R_{1}} =h(\bm{x}_{t}^{*})-V(\bm{x}_{t})\] \[\leq\mathcal{O}(\alpha C)\bigg{\|}g(\bm{x}_{t};\bm{\theta}_{t-1}) /\sqrt{m}\bigg{\|}_{(\widetilde{\bm{\Sigma}}_{t-1})^{-1}}^{2}+\mathcal{O}( \sqrt{\lambda}S)\cdot\bigg{\|}g(\widetilde{\bm{x}}_{t};\bm{\theta}_{\hat{i}_{t },t-1})/\sqrt{m}\bigg{\|}_{(\widetilde{\bm{\Sigma}}_{t-1}^{\prime})^{-1}}\] \[\qquad\quad+\mathcal{O}(m^{-2/3}\log(m)L^{7/2}t^{5/3}\lambda^{-5 /3}(1+\sqrt{t/\lambda}))+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{- 1/6}L^{5})\] \[\qquad\quad+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{- 7/6}L^{4})\] \[\qquad\quad+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{ 4}t^{7/6}\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{3}t^{5/6} \lambda^{-7/12})\] \[\qquad\quad+\mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log (m)}L^{7/2})+\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2})\] \[\qquad\quad+\gamma_{\tilde{i}_{t},t-1}\cdot\mathcal{O}(m^{-1/12} t^{7/12}\lambda^{-13/12}\log^{1/4}(m)L^{t/2}).\]

_By definition, we have the coefficient \(\gamma_{\tilde{i}_{t},t-1}=\mathcal{O}\big{(}\nu\sqrt{\log\frac{\det( \widetilde{\bm{\Sigma}}_{t,t-1})}{\det(\lambda\mathbf{I})}-2\log(\delta)}+ \lambda^{1/2}S\big{)},\) as well as the gradient covariance matrices \(\bm{\Sigma}_{t-1}^{\prime}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}g(\widetilde{ \bm{x}}_{\tau};\bm{\theta}_{\hat{i}_{\tau},\tau-1})g(\widetilde{\bm{x}}_{ \tau};\bm{\theta}_{\hat{i}_{\tau},\tau-1})^{\intercal}/m,\) and \(\bm{\bar{\Sigma}}_{t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}g(\bm{x}_{\tau}; \bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m.\) The minimum round-wise arm weight \(w_{t}^{\textsf{min}}=\min\{w_{t}^{(\tau)}\}_{i\in[K],\tau\in[t-1]}=\kappa^{2}< 1,\ \forall t\in[T]\) by scaling parameter \(\alpha\)._

**Proof.** By definition, we can have \(I_{R_{1}}=h(\bm{x}_{t}^{*})-U(\bm{x}_{t})+U(\bm{x}_{t})-V(\bm{x}_{t}).\) Here, in terms of the distance between \(U(\bm{x}_{i,t})\) and \(V(\bm{x}_{i,t})\) given a candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), we have

\[|U(\bm{x}_{i,t}) -V(\bm{x}_{i,t})|=|f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})-\big{\langle} g(\bm{x}_{i,t};\bm{\theta}_{0}),\ \bm{\theta}_{i,t-1}-\bm{\theta}_{0}\big{\rangle}|\] \[\leq|f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})-\big{\langle}g(\bm{x}_{ i,t};\bm{\theta}_{i,t-1}),\ \bm{\theta}_{i,t-1}-\bm{\theta}_{0}\big{\rangle}|\] \[\qquad\quad+\big{|}\langle g(\bm{x}_{i,t};\bm{\theta}_{i,t-1}),\ \bm{\theta}_{i,t-1}-\bm{\theta}_{0}\big{\rangle}-\big{\langle}g(\bm{x}_{i,t};\bm {\theta}_{0}),\ \bm{\theta}_{i,t-1}-\bm{\theta}_{0}\big{\rangle}|\] \[\leq\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3})+ \mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{7/2}).\]

where the first inequality is by triangular inequality, and the second inequality is by applying a similar approach as in (B.12) from [86] as well as Lemma G.4. Next, we proceed to bound term \(I_{R_{1}}\). Here, for a candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) and the associated corruption-free confidence ellipsoid \(\widetilde{\mathcal{C}}_{i,t-1}\), we have \(\bm{\theta}^{*}\in\widetilde{\mathcal{C}}_{i,t-1}\) based on Lemma C.10. Thus, with \(\widetilde{\bm{x}}_{t}=\arg\max_{\bm{x}_{i,t}\in\mathcal{X}_{t}}\widetilde{V} (\bm{x}_{i,t})\) being the arm chosen by the corruption-free neural model, with the highest score \(\widetilde{V}(\widetilde{\bm{x}}_{t})\), there will be

\[I_{R_{1}} =h(\bm{x}_{t}^{*})-U(\bm{x}_{t})+U(\bm{x}_{t})-V(\bm{x}_{t})\] \[=\langle g(\bm{x}_{t}^{*};\bm{\theta}_{0}),\ \bm{\theta}^{*}-\bm{\theta}_{0} \rangle-U(\bm{x}_{t})+U(\bm{x}_{t})-V(\bm{x}_{t})\] \[\leq\max_{\widetilde{\bm{\theta}}\in\widetilde{\mathcal{C}}_{i,t-1} }\langle g(\bm{x}_{t}^{*};\bm{\theta}_{0}),\ \widetilde{\bm{\theta}}-\bm{\theta}_{0} \rangle-U(\bm{x}_{t})+U(\bm{x}_{t})-V(\bm{x}_{t})\] \[\leq\max_{\widetilde{\bm{\theta}}\in\widetilde{\mathcal{C}}_{i,t-1} }\langle g(\widetilde{\bm{x}}_{t};\bm{\theta}_{0}),\ \widetilde{\bm{\theta}}-\bm{\theta}_{0} \rangle-U(\bm{x}_{t})+|U(\bm{x}_{t})-V(\bm{x}_{t})|,\]

where \(\widetilde{\mathcal{C}}_{i_{t},t-1}\) refers to the confidence ellipsoid of corruption-free parameters \(\widetilde{\bm{\theta}}_{\tilde{i}_{t},t-1}\), associated to arm \(\widetilde{\bm{x}}_{t}\in\mathcal{X}_{t}\). Afterwards, it further leads to

\[I_{R_{1}} \leq\max_{\widetilde{\bm{\theta}}\in\widetilde{\mathcal{C}}_{i,t-1} }\langle g(\widetilde{\bm{x}}_{t};\bm{\theta}_{0}),\ \widetilde{\bm{\theta}}-\bm{\theta}_{0} \rangle-U(\bm{x}_{t})\] \[\qquad\quad+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2 /3}L^{3})+\mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{7/2})\] \[\leq\max_{\widetilde{\bm{\theta}}\in\widetilde{\mathcal{C}}_{i,t-1 }}\langle g(\widetilde{\bm{x}}_{t};\bm{\theta}_{0}),\ \widetilde{\bm{\theta}}-\bm{\theta}_{0} \rangle-V(\bm{x}_{t})\] \[\qquad\quad+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L ^{3})+\mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{7/2})\] \[\leq\max_{\widetilde{\bm{\theta}}\in\widetilde{\mathcal{C}}_{i,t-1 }}\langle g(\widetilde{\bm{x}}_{t};\bm{\theta}_{0}),\ \widetilde{\bm{\theta}}-\bm{\theta}_{0} \rangle-V(\widetilde{\bm{x}}_{t})\] \[\qquad\quad+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2 /3}L^{3})+\mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{7/2})\] \[=\widetilde{V}(\widetilde{\bm{x}}_{t})-V(\widetilde{\bm{x}}_{t})+ \mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3})+\mathcal{O}(m^{-1/ 6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{7/2})\]To bound the output difference between \(V(\bm{x}_{i,t})\) and \(\widetilde{V}(\bm{x}_{i,t})\) for an arm \(\bm{x}_{i,t}\), we can decompose them into separate terms. Recall the definition of \(V(\cdot)\) in (C.4), and we can also define the analogous \(\widetilde{V}(\cdot)\) by applying the corruption-free parameters \(\widetilde{\bm{\theta}}\) and covariance matrix \(\widetilde{\bm{\Sigma}}\). Therefore, for arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), we have

\[V(\bm{x}_{i,t})-\widetilde{V}(\bm{x}_{i,t})\leq|V(\bm{x}_{i,t})-V^{(0)}(\bm{x} _{i,t})|+|V^{(0)}(\bm{x}_{i,t})-\widetilde{V}^{(0)}(\bm{x}_{i,t})|+|\widetilde{ V}^{(0)}(\bm{x}_{i,t})-\widetilde{V}(\bm{x}_{i,t})|,\] (C.15)

where for the sake of analysis, we define two variants with randomly initialized parameters \(\bm{\theta}_{0}\) being: \(V^{(0)}(\bm{x}_{i,t})=\big{<}g(\bm{x}_{i,t};\bm{\theta}_{0}),\ \bm{\theta}_{t-1}-\bm{\theta}_{0}\big{>}+\gamma_{t-1}\cdot\sqrt{g(\bm{x}_{i,t };\bm{\theta}_{0})\mathsf{\tau}(\bm{\Sigma}_{t-1}^{(0)})^{-1}g(\bm{x}_{i,t}; \bm{\theta}_{0})/m}\), and \(\widetilde{V}^{(0)}(\bm{x}_{i,t})=\big{<}g(\bm{x}_{i,t};\bm{\theta}_{0}),\ \widetilde{\bm{ \theta}}_{t-1}-\bm{\theta}_{0}\big{>}+\widetilde{\gamma}_{t-1}\cdot\sqrt{g( \bm{x}_{i,t};\bm{\theta}_{0})\mathsf{\tau}(\bm{\Sigma}_{t-1}^{(0)})^{-1}g(\bm{ x}_{i,t};\bm{\theta}_{0})/m}\). With this result, our objective then is to derive the upper bounds for the three terms on the RHS of (C.15).

**Bounding the second term \(|V^{(0)}(\bm{x}_{i,t})-\widetilde{V}^{(0)}(\bm{x}_{i,t})|\) in** (C.15). For the second term, we have

\[|V^{(0)}(\bm{x}_{i,t})-\widetilde{V}^{(0)}(\bm{x}_{i,t})|\] \[\leq|\big{<}g(\bm{x}_{i,t};\bm{\theta}_{0}),\ \bm{\theta}_{i,t-1}-\widetilde{\bm{ \theta}}_{i,t-1})|\] \[\quad+|\gamma_{i,t-1}\cdot\sqrt{g(\bm{x}_{i,t};\bm{\theta}_{0}) \mathsf{\tau}(\bm{\Sigma}_{i,t-1}^{(0)})^{-1}g(\bm{x}_{i,t};\bm{\theta}_{0})/m }-\widetilde{\gamma}_{i,t-1}\cdot\sqrt{g(\bm{x}_{i,t};\bm{\theta}_{0})\mathsf{ \tau}(\bm{\Sigma}_{i,t-1}^{(0)})^{-1}g(\bm{x}_{i,t};\bm{\theta}_{0})/m}|\] \[=|\big{<}g(\bm{x}_{i,t};\bm{\theta}_{0}),\ \bm{\theta}_{i,t-1}-\widetilde{\bm{ \theta}}_{i,t-1})|+|\gamma_{i,t-1}-\widetilde{\gamma}_{i,t-1}|\cdot\sqrt{g( \bm{x}_{i,t};\bm{\theta}_{0})\mathsf{\tau}(\bm{\Sigma}_{i,t-1}^{(0)})^{-1}g( \bm{x}_{i,t};\bm{\theta}_{0})/m}\] \[\leq|\big{<}g(\bm{x}_{i,t};\bm{\theta}_{0}),\ \bm{\theta}_{i,t-1}-\widetilde{\bm{ \theta}}_{i,t-1})|+|\gamma_{i,t-1}-\widetilde{\gamma}_{i,t-1}|\cdot\mathcal{O} (L/\sqrt{\lambda}).\]

Due to the fact that \(|\sqrt{a}-\sqrt{b}|\leq\sqrt{|a-b|}\), based on the definition of \(\gamma_{i,t-1}\) and \(\widetilde{\gamma}_{i,t-1}\), we will have

\[|\gamma_{i,t-1}-\widetilde{\gamma}_{i,t-1}|\leq\nu\cdot\sqrt{1+ \mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6}\lambda^{-7/6})}\\ \cdot\sqrt{\log(\frac{\det\bm{\Sigma}_{i,t-1}}{\det\lambda\bm{ \Gamma}})-\log(\frac{\det\bm{\Sigma}_{0}}{\det\lambda\bm{\Gamma}})+\log(\frac {\det\bm{\Sigma}_{0}}{\det\lambda\bm{\Gamma}})-\log(\frac{\det\widetilde{\bm{ \Sigma}}_{i,t-1}}{\det\lambda\bm{\Gamma}})}|\] \[\leq\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6 }\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{2}t^{5/6}\lambda^{- 7/12}),\]

based on Lemma G.6. Therefore, we will end up with

\[|V^{(0)}(\bm{x}_{i,t}) -\widetilde{V}^{(0)}(\bm{x}_{i,t})|\leq|\big{<}g(\bm{x}_{i,t};\bm{ \theta}_{0}),\ \bm{\theta}_{i,t-1}-\widetilde{\bm{\theta}}_{i,t-1}\big{>}|\] \[+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6} \lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{3}t^{5/6}\lambda^{- 7/12}).\]

**Bounding Term \(|V(\bm{x}_{i,t})-V^{(0)}(\bm{x}_{i,t})|\) and term \(|\widetilde{V}^{(0)}(\bm{x}_{i,t})-\widetilde{V}(\bm{x}_{i,t})|\) in** (C.15). On the other hand, for the first term on the RHS, \(|V(\bm{x}_{i,t})-V^{(0)}(\bm{x}_{i,t})|\), we can bound this difference term by

\[V(\bm{x}_{i,t})-V^{(0)}(\bm{x}_{i,t})\] \[=\frac{\gamma_{i,t-1}}{\sqrt{m}}\bigg{(}\sqrt{g(\bm{x}_{i,t}; \bm{\theta}_{i,t-1})\mathsf{\tau}\bm{\Sigma}_{i,t-1}^{-1}g(\bm{x}_{i,t};\bm{ \theta}_{i,t-1})}-\sqrt{g(\bm{x}_{i,t};\bm{\theta}_{0})\mathsf{\tau}(\bm{ \Sigma}_{i,t-1}^{(0)})^{-1}g(\bm{x}_{i,t};\bm{\theta}_{0})}\bigg{)}\] \[=\frac{\gamma_{i,t-1}}{\sqrt{m}}\bigg{(}\big{\|}g(\bm{x}_{i,t}; \bm{\theta}_{i,t-1})\big{\|}_{\bm{\Sigma}_{i,t-1}^{-1}}-\big{\|}g(\bm{x}_{i,t}; \bm{\theta}_{0})\big{\|}_{(\bm{\Sigma}_{i,t-1}^{(0)})^{-1}}\bigg{)}\] \[\leq\frac{\gamma_{i,t-1}}{\sqrt{m}}\bigg{(}\big{\|}g(\bm{x}_{i,t}; \bm{\theta}_{i,t-1})\big{\|}_{\bm{\Sigma}_{i,t-1}^{-1}}-\big{\|}g(\bm{x}_{i,t}; \bm{\theta}_{i,t-1})\big{\|}_{(\bm{\Sigma}_{i,t-1}^{(0)})^{-1}}+\big{\|}g( \bm{x}_{i,t};\bm{\theta}_{0})-g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})\big{\|}_{( \bm{\Sigma}_{i,t-1}^{(0)})^{-1}}\bigg{)}\] \[\leq\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7 /2})+\frac{\gamma_{i,t-1}}{\sqrt{m}}\cdot\bigg{(}\big{\|}g(\bm{x}_{i,t};\bm{ \theta}_{i,t-1})\big{\|}_{\bm{\Sigma}_{i,t-1}^{-1}}-\big{\|}g(\bm{x}_{i,t}; \bm{\theta}_{i,t-1})\big{\|}_{(\bm{\Sigma}_{i,t-1}^{(0)})^{-1}}\bigg{)}\]\[\leq\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2})\] \[\leq\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2})\] \[\leq\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2})+ \frac{\gamma_{i,t-1}}{\sqrt{m}}\cdot\left(\sqrt{g(\bm{x}_{i,t};\bm{\theta}_{i,t- 1})}\cdot(\bm{\Sigma}_{i,t-1}^{-1}\cdot(\bm{\Sigma}_{i,t-1}^{(0)}-\bm{\Sigma}_{i,t-1}^{(0)})^{-1}g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})\right)\] \[\leq\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2 })+\frac{\gamma_{i,t-1}}{\sqrt{m}}\cdot\left(\sqrt{\langle g(\bm{x}_{i,t};\bm{ \theta}_{i,t-1}),\;(\bm{\Sigma}_{i,t-1}^{-1}-(\bm{\Sigma}_{i,t-1}^{(0)})^{-1} )g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})\rangle}\right)\] \[=\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2})\] \[\leq\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2 })+\gamma_{i,t-1}\cdot\mathcal{O}(m^{-1/12}t^{7/2}\lambda^{-13/12}\log^{1/4}(m )L^{t/2})\]

where the first inequality is because of the triangular inequality. The second inequality is by applying Lemma G.4. The third inequality is again the application of triangular inequality, and the last inequality is the application of Lemma G.6. Since the similar procedure can also be applied to bound the third term \(|\widetilde{V}^{(0)}(\bm{x}_{i,t})-\widetilde{V}(\bm{x}_{i,t})|\), after summing up the results, we will have

\[|V(\bm{x}_{i,t})-V^{(0)}(\bm{x}_{i,t})|,\;|\widetilde{V}^{(0)}( \bm{x}_{i,t})-\widetilde{V}(\bm{x}_{i,t})|\] \[\leq\mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{7/2 })+\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2})\] \[\qquad\qquad\qquad+\gamma_{i,t-1}\cdot\mathcal{O}(m^{-1/12}t^{7/ 12}\lambda^{-13/12}\log^{1/4}(m)L^{t/2}).\]

**Summing up results.** Combining the results, we finally have the upper bound for \(I_{R_{1}}\) being

\[I_{R_{1}}\leq|\big{\langle}g(\widetilde{\bm{x}}_{t};\bm{\theta}_ {i,t-1}),\;\bm{\theta}_{i_{t},t-1}-\widetilde{\bm{\theta}}_{i_{t},t-1}\big{\rangle}|\] \[\qquad+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{ 7/6}\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{3}t^{5/6}\lambda^ {-7/12})\] \[\qquad+\mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{ 7/2})+\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2})\] \[\qquad+\gamma_{i_{t},t-1}\cdot\mathcal{O}(m^{-1/12}t^{7/12} \lambda^{-13/12}\log^{1/4}(m)L^{t/2})\] \[\leq|\big{\langle}g(\widetilde{\bm{x}}_{t};\bm{\theta}_{i_{t},t-1} ),\;\bm{\theta}_{i_{t},t-1}-\widetilde{\bm{\theta}}_{i_{t},t-1}\big{\rangle}|\] \[\qquad+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^ {7/6}\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{3}t^{5/6} \lambda^{-7/12})\] \[\qquad+\mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{ 7/2})\] \[\qquad+\mathcal{O}(m^{-1/6}t^{2/3}\lambda^{-2/3}\sqrt{\log(m)}L^{ 7/2})+\mathcal{O}(m^{-1/6}t^{1/6}\lambda^{-7/6}\sqrt{\log(m)}L^{7/2})\] \[\qquad+\gamma_{i_{t},t-1}\cdot\mathcal{O}(m^{-1/12}t^{7/12} \lambda^{-13/12}\log^{1/4}(m)L^{t/2}),\]

and therefore we can formulate our objective to bound as

\[I_{R_{1}}\leq|\underbrace{\big{\langle}g(\widetilde{\bm{x}}_{t};\bm{\theta}_{ i_{t},t-1}),\;\bm{\theta}_{i_{t},t-1}-\widetilde{\bm{\theta}}_{i_{t},t-1}\big{\rangle}}_{I_{1}}|\] (C.16)

where we recall that \(\nu\) is the pre-defined exploration parameter that echoes the sub-Gaussian noise variance proxy. Finally, using the upper bound for term \(I_{1}\) from Lemma C.7 will finish the proof.

### Bounding the terms \(I_{1}\), \(I_{2}\)

Here, we see that there are still two terms in \(R_{t},t\in[T]\) that need to be bounded, which are

\[I_{1}=\big{\langle}g(\widetilde{\bm{x}}_{t};\bm{\theta}_{i_{t},t-1}),\;\bm{ \theta}_{i_{t},t-1}-\widetilde{\bm{\theta}}_{i_{t},t-1}\big{\rangle},\qquad I_{2 }=\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\;\widetilde{\bm{\theta}}_{t-1}-\bm{ \theta}_{t-1}\rangle,\]where we recall \(\bm{x}_{t}\in\mathcal{X}_{t}\) is the actual chosen arm that is selected by the corrupted model \(\bm{\theta}_{t-1}\), while we have \(\widetilde{\bm{x}}_{t}\in\mathcal{X}_{t}\) being the imaginary arm chosen by the corruption-free model \(\widetilde{\bm{\theta}}_{t-1}\). In this subsection, the error term \(I_{1}\) will be bounded by Lemma C.7, while term \(I_{2}\) will be bounded by Corollary C.8.

**Recap of auxiliary parameter definitions.** With definitions in Subsection C.4, we can have two different alternatives to decouple the adversarial corruptions from arm rewards: (i) the gradient-based regression parameters; and, (ii) the auxiliary sequence of gradient descent. For reference, recall that we denote the a series of gradient-based regression parameters, specified to candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), as

\[\bm{\Sigma}_{i,t-1}^{(0)} =\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm {x}_{\tau};\bm{\theta}_{0})\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})^{\intercal}/m,\] \[\bm{\Sigma}_{i,t-1} =\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm {x}_{\tau};\bm{\theta}_{\tau-1})\cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{ \intercal}/m,\] \[\bm{b}_{i,t-1}^{(0)} =\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{0})\cdot r_{\tau}/\sqrt{m}, \bm{b}_{i,t-1} =\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{\tau-1})\cdot r_{\tau}/\sqrt{m},\] \[\widetilde{\bm{b}}_{i,t-1}^{(0)} =\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{0})\cdot\widetilde{r}_{\tau}/\sqrt{m}, \widetilde{\bm{b}}_{i,t-1} =\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{\tau-1})\cdot\widetilde{r}_{\tau}/\sqrt{m},\]

where \(\{\bm{x}_{\tau},r_{\tau}\},\tau\in[t]\) respectively stands for the chosen arms as well as their received rewards, while \(\{\bm{x}_{\tau},\widetilde{r}_{\tau}\},\tau\in[t]\) refer to the imaginary corruption-free rewards.

We also recall that with the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\) in round \(t\) with arm weights \(w_{t}^{(\tau)},\tau\in[t-1]\), defined in (4), we will have a series of auxiliary gradient sequences \(\{\bm{\theta}_{0},\bm{\Theta}^{(1)},\ldots,\bm{\Theta}^{(J)}\}\) as in Lemma D.1, such that for \(j\)-th, \(j\in[J]\), iteration

\[\bm{\Theta}^{(j+1)}=\bm{\Theta}^{(j)}-\eta\cdot\left[\mathbf{J}^{(0)}\cdot \mathbf{W}\big{(}[\mathbf{J}^{(0)}]^{\intercal}(\bm{\Theta}^{(j)}-\bm{\theta}_ {0})-\bm{y}\big{)}+m\lambda(\bm{\Theta}^{(j)}-\bm{\theta}_{0})\right]\]

where the diagonal weight matrix is made up with the arm weights, as \(\mathbf{W}=\text{diag}\big{(}[w_{t}^{(\tau)}]_{\tau\in[t-1]}\big{)}\in\mathbb{ R}^{(t-1)\times(t-1)}\). Similarly, we will also have the sequence definition for corruption-free parameters \(\widetilde{\bm{\Theta}}^{(j+1)}=\widetilde{\bm{\Theta}}^{(j)}-\eta\cdot\left[ \mathbf{J}^{(0)}\cdot\mathbf{W}\big{(}[\mathbf{J}^{(0)}]^{\intercal}(\widetilde {\bm{\Theta}}^{(j)}-\bm{\theta}_{0})-\widetilde{\bm{y}}\big{)}+m\lambda( \widetilde{\bm{\Theta}}^{(j)}-\bm{\theta}_{0})\right]\), along with the Jacobian matrix \(\mathbf{J}^{(0)}:=\big{(}g(\bm{x}_{1};\bm{\theta}_{0}),g(\bm{x}_{2};\bm{ \theta}_{0}),\ldots,g(\bm{x}_{t-1};\bm{\theta}_{0})\big{)}\in\mathbb{R}^{p \times(t-1)}\). Here, we have \(\bm{y},\widetilde{\bm{y}}\in\mathbb{R}^{t-1}\) separately being the vector of received rewards and that of the imaginary corruption-free rewards. In particular, with \([\mathbf{J}^{(0)}]_{\tau}\) being the \(\tau\)-th column of matrix \(\mathbf{J}^{(0)}\), the auxiliary sequence \(\bm{\Theta}^{(j)}\) can be deemed as applying Gradient Descent to solve the following optimization problem

\[\min_{\bm{\Theta}}\mathcal{L}(\bm{\Theta})=\sum_{\tau\in[t-1]}\frac{1}{2}\cdot w _{i,t}^{(\tau)}\bigg{\|}[\mathbf{J}^{(0)}]_{\tau}^{\intercal}(\bm{\Theta}- \bm{\theta}_{0})-y_{\tau}\bigg{\|}_{2}^{2}+\frac{1}{2}\cdot m\lambda\bigg{\|} \bm{\Theta}-\bm{\theta}_{0}\bigg{\|}_{2}^{2}\]

Consequently, we can follow an analogous approach as in Lemma D.1 with the above optimization problem, to bound the difference between gradient-based parameters and the auxiliary sequence.

#### c.7.1 Bounding the error term \(I_{1}\)

We bound the error term using Lemma C.7. Following the notation in the main body, let \(\bm{\theta}_{t-1}\) denote the trained parameters associated with the chosen arm \(\bm{x}_{t}\), and let \(\bm{\theta}_{i_{t},t-1}\) represent the trained parameters of the arm \(\widetilde{\bm{x}}_{t}=\bm{x}_{i_{t},t},t\in[T]\), which corresponds to the chosen arm of the hypothetical corruption-free model \(f(\cdot;\widetilde{\bm{\theta}})\). Additionally, we define a weight-free gradient covariance matrix for the arm collection \(\{\widetilde{\bm{x}}_{\tau}\}_{\tau\in[t]}\) containing arms selected by the corruption-free model, which will be denoted by \(\bm{\Sigma}_{t-1}^{\prime}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}g(\widetilde{ \bm{x}}_{\tau};\bm{\theta}_{i_{\tau},\tau-1})g(\widetilde{\bm{x}}_{\tau};\bm{ \theta}_{i_{\tau},\tau-1})^{\intercal}/m\).

**Lemma C.7**.: _Suppose the imaginary corruption-free neural network \(f(\cdot;\widetilde{\bm{\theta}}_{i,t-1})\) for arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) has been trained on corruption-free rewards \(\{\bm{x}_{\tau},\widetilde{r}_{\tau}\}_{\tau\in[t-1]}\), while the other trained network \(f(\cdot;\bm{\theta}_{i,t-1})\) is trained on the received records \(\{\bm{x}_{\tau},r_{\tau}\}_{\tau\in[t-1]}\). Suppose \(f(\cdot)\) is an \(L\)-layer FC

[MISSING_PAGE_FAIL:35]

which further leads to

\[\begin{split} I_{1.1}\leq\left|\left\langle g(\widetilde{\bm{x}}_{t}; \bm{\theta}_{\tilde{i}_{t}}),\;\bm{\Theta}^{(J)}-\bm{\theta}_{0}-(\bm{\Sigma} _{\tilde{i}_{t}}^{(0)})^{-1}\bm{b}_{\tilde{i}_{t}}^{(0)}/\sqrt{m}\right\rangle \right|\\ \qquad\qquad\qquad\qquad\qquad\left.+\left|\left\langle g(\widetilde{ \bm{x}}_{t};\bm{\theta}_{\tilde{i}_{t}}),\;\widetilde{\bm{\Theta}}^{(J)}-\bm {\theta}_{0}-(\bm{\Sigma}_{\tilde{i}_{t}}^{(0)})^{-1}\widetilde{\bm{b}}_{ \tilde{i}_{t}}^{(0)}/\sqrt{m}\right\rangle\right|\\ \qquad\qquad\qquad\qquad\qquad\qquad\left.+\underbrace{\left| \left\langle g(\widetilde{\bm{x}}_{t};\bm{\theta}_{\tilde{i}_{t}}),\;(\bm{ \Sigma}_{\tilde{i}_{t}}^{(0)})^{-1}(\sum_{\tau\in[t-1]}w_{\tilde{i}_{t},t}^{( \tau)}\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c_{\tau})/m\right\rangle \right|}_{I_{1.2}}\end{split}\] (C.17)

where the inequality is due to the definition of gradient-based regression parameters and triangular inequality. It is obvious that for the third term on the RHS, the only thing we have control on is \(\bm{\theta}_{\tilde{i}_{t}}\). When trying to bound the first two terms on the RHS for the arm \(\widetilde{\bm{x}}_{t}\), we can first apply Holder's inequality with \(\bm{\Sigma}_{t-1}^{\prime}=\lambda\bm{\mathrm{I}}+\sum_{\tau\in[t-1]}g( \widetilde{\bm{x}}_{\tau};\bm{\theta}_{\tilde{i}_{\tau},\tau-1})g( \widetilde{\bm{x}}_{\tau};\bm{\theta}_{\tilde{i}_{\tau},\tau-1})^{\intercal} /m\). Note that for the purpose of analysis and different from previous ones defined in (C.11), the new matrix \((\bm{\Sigma}_{t-1}^{\prime})\) contains gradients of the sequence of arms \(\{\widetilde{\bm{x}}_{\tau}\}_{\tau\in[t-1]}\) chosen by the corruption-free model \(f(\cdot;\widetilde{\bm{\theta}}_{\tau-1}),\tau\in[t-1]\), with the parameters \(\widetilde{\bm{\theta}}_{\tau-1},\tau\in[t-1]\).

In this case, we use the Holder's inequality to the first term on the RHS of (C.17) as

\[\begin{split}&\left\langle g(\widetilde{\bm{x}}_{t};\bm{\theta}_{ \tilde{i}_{t}}),\;\bm{\Theta}^{(J)}-\bm{\theta}_{0}-(\bm{\Sigma}_{\tilde{i}_ {t}}^{(0)})^{-1}\bm{b}_{\tilde{i}_{t}}^{(0)}/\sqrt{m}\right\rangle\\ &\qquad\qquad\leq\left\|g(\widetilde{\bm{x}}_{t};\bm{\theta}_{ \tilde{i}_{t}})/\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1}^{\prime})^{-1}}\cdot\sqrt {m}\cdot\left\|\bm{\Theta}^{(J)}-\bm{\theta}_{0}-(\bm{\Sigma}_{\tilde{i}_{t}}^ {(0)})^{-1}\bm{b}_{\tilde{i}_{t}}^{(0)}/\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1}^ {\prime})}\\ &\qquad\qquad\qquad\leq\left\|g(\widetilde{\bm{x}}_{t};\bm{\theta }_{\tilde{i}_{t}})/\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1}^{\prime})^{-1}}\cdot \sqrt{m}\cdot\left\|\bm{\Theta}^{(J)}-\bm{\theta}_{0}-(\bm{\Sigma}_{\tilde{i} _{t}}^{(0)})^{-1}\bm{b}_{\tilde{i}_{t}}^{(0)}/\sqrt{m}\right\|_{2}\cdot\left\| (\bm{\Sigma}_{t-1}^{\prime})\right\|_{2}\\ &\qquad\qquad\qquad\leq\left\|g(\widetilde{\bm{x}}_{t};\bm{\theta }_{\tilde{i}_{t}})/\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1}^{\prime})^{-1}}\cdot \mathcal{O}(\lambda+tL)\cdot\left\|\sqrt{m}(\bm{\Theta}^{(J)}-\bm{\theta}_{0})- (\bm{\Sigma}_{\tilde{i}_{t}}^{(0)})^{-1}\bm{b}_{\tilde{i}_{t}}^{(0)}\right\|_ {2}\\ &\qquad\qquad\qquad\qquad\cdot\mathcal{O}\bigg{(}(1-\eta m\lambda )^{J/2}\sqrt{t/\lambda}+m^{-1/6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+ \sqrt{t/\lambda})\bigg{)}\\ &\qquad\qquad\leq\left\|g(\widetilde{\bm{x}}_{t};\bm{\theta}_{ \tilde{i}_{t}})/\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1}^{\prime})^{-1}}\cdot \mathcal{O}(\sqrt{\lambda}S)\end{split}\]

where the first two inequalities are by the Holder's inequality and Cauchy-Schwartz inequality. The third inequality is by Lemma G.6. The fourth inequality is by applying Lemma D.1, with the optimization problem being (C.12) bounding the difference between gradient-based parameters and the auxiliary sequence. Finally, with \(w_{t}\leq 1\) and the conditions in Theorem 5.6, applying the conclusion from Remark 4.7 in [86] will give the last inequality. Following a similar approach can also lead to the identical upper bound for the second term on the RHS of (C.17).

**Bounding Term \(I_{1.2}\) Based on Arm Weights.** Next, we proceed to bound term \(I_{1.2}\). Recall that we need to derive the upper bound for the following term

\[\begin{split} I_{1.2}&=\left|\left\langle g(\widetilde{ \bm{x}}_{t};\bm{\theta}_{\tilde{i}_{t}}),\;(\bm{\Sigma}_{\tilde{i}_{t}}^{(0)})^ {-1}(\sum_{\tau\in[t-1]}w_{\tilde{i}_{t},t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{0})\cdot c_{\tau})/m\right\rangle\right|\\ &\leq\bigg{|}\sum_{\tau\in[t-1]}\left\langle g(\widetilde{\bm{x}}_ {t};\bm{\theta}_{\tilde{i}_{t}}),\;(\bm{\Sigma}_{\tilde{i}_{t}}^{(0)})^{-1} \cdot w_{\tilde{i}_{t},t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c _{\tau}/m\right\rangle\bigg{|}\\ &\leq\bigg{|}\sum_{\tau\in[t-1]}\left\langle g(\widetilde{\bm{x}}_ {t};\bm{\theta}_{\tilde{i}_{t}}),\;w_{\tilde{i}_{t},t}^{(\tau)}\cdot(\bm{ \Sigma}_{\tilde{i}_{t}}^{(0)})^{-1}g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})c_{ \tau}/m\right\rangle\bigg{|}\\ &\qquad\qquad+\Big{|}\sum_{\tau\in[t-1]}\left\langle g(\widetilde{ \bm{x}}_{t};\bm{\theta}_{\tilde{i}_{t}}),\;w_{\tilde{i}_{t},t}^{(\tau)}\cdot(\bm{ \Sigma}_{\tilde{i}_{t}}^{(0)})^{-1}(g(\bm{x}_{\tau};\bm{\theta}_{0})-g(\bm{x}_ {\tau};\bm{\theta}_{\tau-1}))c_{\tau}/m\right\rangle\right|\\ &\leq\bigg{|}\sum_{\tau\in[t-1]}\left\langle g(\widetilde{\bm{x}}_ {t};\bm{\theta}_{\tilde{i}_{t}}),\;w_{\tilde{i}_{t},t}^{(\tau)}\cdot(\bm{ \Sigma}_{\tilde{i}_{t}}^{(0)})^{-1}g(\bm{x}_{\tau};\bm{\theta}_{\tau-1}) \cdot c_{\tau}/m\right\rangle\bigg{|}+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6} \lambda^{-7/6}L^{4})\end{split}\]\[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\]

where the second and fourth inequality is due to triangular inequality. The third inequality is by Lemma G.4, and the last inequality is due to Lemma G.6.

In particular, we aim to train separate neural models \(f(\cdot;\boldsymbol{\theta}_{i,t})\) for each candidate arm \(\boldsymbol{x}_{i,t}\in\mathcal{X}_{t}\), such that the term \(I_{1.2}\) can be minimized. Recall that we denote \(\boldsymbol{\bar{\Sigma}}_{t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}g( \boldsymbol{x}_{\tau};\boldsymbol{\theta}_{\tau-1})g(\boldsymbol{x}_{\tau}; \boldsymbol{\theta}_{\tau-1})^{\intercal}/m\) as the "vanilla" gradient covariance matrix without the arm weights, in terms of the potentially corrupted network parameters \(\boldsymbol{\theta}_{\tau-1}\).

In this case, with \(w_{i_{t},t}^{(\tau)}\) referring to the weight of arm \(\boldsymbol{\widetilde{x}}_{t}\), the above formulation of term \(I_{1.3}\) can be further transformed into

\[I_{1.3} \leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\] \[\leq\]

where the first inequality follows from applying Holder's inequality, and the second and third inequalities are obtained by using Lemma G.8, along with the fact that \(\boldsymbol{\Sigma}_{i_{t}}\geq\boldsymbol{\bar{\Sigma}}_{t-1}^{(\kappa)}\geq \boldsymbol{\bar{\Sigma}}_{\tau-1}^{(\kappa)}\) by definition. The last two inequalities are derived from the definition of the arm weight \(w_{i_{t},t}^{(\tau)}\) and the corruption level \(C=\sum_{t\in[T]}|c_{t}|\). Recall that for each arm \(\boldsymbol{x}_{i,t}\in\mathcal{X}_{t}\), we define its weight as \(w_{i,t}^{(\tau)}=\min\left\{1,\frac{\alpha\cdot\min\limits_{\boldsymbol{x}_{i }\in\mathcal{X}_{t}}\|g(\boldsymbol{x};\boldsymbol{\theta}_{t-1})/\sqrt{m}\| _{\boldsymbol{\Sigma}_{\boldsymbol{x}_{i-1}}^{(\kappa)}}^{2}}{g_{\tau}\cdot\|g( \boldsymbol{x}_{\tau,i};\boldsymbol{\theta}_{t-1})/\sqrt{m}\|_{\boldsymbol{ \Sigma}_{\boldsymbol{x}_{i-1}}^{(\kappa)}}^{2}}\right\},\) where \(\alpha>0\) is the tunable parameter. As a result, we will have the upper bound for \(I_{1.2}\), being

\[I_{1.2}\leq\mathcal{O}(\alpha C) \cdot\bigg{\|}g(\boldsymbol{x}_{t};\boldsymbol{\theta}_{t-1})/ \sqrt{m}\bigg{\|}_{(\boldsymbol{\bar{\Sigma}}_{t-1})^{-1}}^{2}+\mathcal{O}( Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-1/6}L^{5})\] \[+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^{4})\]

In this case, since the weights are lower bounded by \(\kappa^{2}\), the only way to ensure this is by adjusting the tunable parameter \(\alpha>0\) accordingly. We remind that this does not require the learner to have a global view of the minimum fraction value \(\beta\). In practice, the learner can adjust the \(\alpha\) values in each round to ensure that the round-wise minimum weight value \(w_{t}^{\text{min}}=\min\{w_{i,t}^{(\tau)}\}_{i\in[K]}=\kappa^{2}<1\), for all \(t\in[T]\) and \(\tau\in[t-1]\), by tuning the parameter \(\alpha\). By summing up all the results, we obtain the single-round bound for term \(I_{1}\), which leads to

\[I_{1}\leq\mathcal{O}(\alpha C)\cdot\left\|g(\bm{x}_{t};\bm{\theta} _{t-1})/\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1})^{-1}}^{2}+\mathcal{O}(\sqrt{ \lambda}S)\cdot\left\|g(\widetilde{\bm{x}}_{t};\bm{\theta}_{i_{t},t-1})/\sqrt{ m}\right\|_{(\bm{\Sigma}_{t-1}^{\prime})^{-1}}\] \[\qquad\quad+\mathcal{O}(m^{-2/3}\log(m)L^{7/2}t^{5/3}\lambda^{-5/ 3}(1+\sqrt{t/\lambda}))+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-1/ 6}L^{5})\] \[\qquad\qquad+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{- 7/6}L^{4}).\] (C.18)

#### c.7.2 Bounding the error term \(I_{2}\)

Similarly, for the term \(I_{2}\) related to the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\), we can follow the below procedure to obtain a comparable bound as for term \(I_{1}\).

**Corollary C.8**.: _Suppose the imaginary corruption-free neural network \(f(\cdot;\widetilde{\bm{\theta}}_{i,t-1})\) for arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) has been trained on corruption-free rewards \(\{\bm{x}_{\tau},\widetilde{\tau}_{\tau}\}_{\tau\in[t-1]}\). \(f(\cdot)\) is an \(L\)-layer FC network with width \(m\) that satisfy the conditions in Theorem 5.6. Then, for the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\), with the probability at least \(1-\delta\), we will have_

\[I_{2}\leq\mathcal{O}(\alpha C)\cdot\left\|g(\bm{x}_{t};\bm{ \theta}_{t-1})/\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1})^{-1}}^{2}+\mathcal{O}( \sqrt{\lambda}S)\cdot\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_ {(\bm{\Sigma}_{t-1})^{-1}}\] \[\qquad\quad+\mathcal{O}(m^{-2/3}\log(m)L^{7/2}t^{5/3}\lambda^{-5/ 3}(1+\sqrt{t/\lambda}))+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-1/ 6}L^{5})\] \[\qquad\qquad+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{- 7/6}L^{4}).\]

_where \(\bm{\theta}_{t-1}\) are the trained parameters associated to chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\) in round \(t\), and \(\bm{\theta}_{i_{t},t-1}\) are the trained parameters of arm \(\widetilde{\bm{x}}_{t}\), along with the corresponding weight-free gradient covariance matrix \(\bm{\bar{\Sigma}}_{t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}g(\bm{x}_{\tau}; \bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m\)._

**Proof.** The proof of this corollary follows an analogous procedure as in Lemma C.7.

**Simplifying the notation.** For notation simplicity, we apply \(\widetilde{\bm{\Theta}}^{(J)}\) and \(\bm{\Theta}^{(J)}\) to represent the gradient descent-based parameters associated with the arm \(\bm{x}_{t}\). For terms specific to the arm \(\bm{x}_{t}=\bm{x}_{i_{t},t}\), we simplify notation by using \(\bm{\theta}_{t-1}\), \(\Sigma_{t-1}\), and \(\bm{b}_{t-1}\) to denote \(\bm{\theta}_{i_{t},t-1}\), \(\Sigma_{i_{t},t-1}\), and \(\bm{b}_{i_{t},t-1}\), respectively. Then, with the simplified notation, it leads to

\[I_{2} =\left|\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\;\bm{\theta}_{t-1 }-\widetilde{\bm{\theta}}_{t-1}\rangle\right|\] \[\leq\left|\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\;\bm{\theta}_{t -1}-\bm{\Theta}^{(J)}\rangle\right|+\left|\langle g(\bm{x}_{t};\bm{\theta}_{t-1 }),\;\widetilde{\bm{\Theta}}^{(J)}-\widetilde{\bm{\theta}}_{t-1}\rangle \right|+\underbrace{\left|\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\;\widetilde {\bm{\Theta}}^{(J)}-\bm{\Theta}^{(J)}\rangle\right|}_{I_{2.1}}\] \[\leq\mathcal{O}(m^{-2/3}\log(m)L^{7/2}t^{5/3}\lambda^{-5/3}(1+ \sqrt{t/\lambda}))+\underbrace{\left|\langle g(\bm{x}_{t};\bm{\theta}_{t-1}), \;\bm{\Theta}^{(J)}-\widetilde{\bm{\Theta}}^{(J)}\rangle\right|}_{I_{2.1}}\]

where the first inequality is due to triangular inequality, and the last inequality is by applying Lemma C.4 in [86], with the optimization problem being (C.12) bounding the difference between gradient-based parameters and the auxiliary sequence.

Next, recall that with randomly initialized network parameters \(\bm{\theta}_{0}\), we can formulate the least square parameters as \((\bm{\Sigma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0)}/\sqrt{m}\), while the least square parameters trained by corruption-freerewards are \((\bm{\Sigma}_{t-1}^{(0)})^{-1}\widetilde{\bm{b}}_{t-1}^{(0)}/\sqrt{m}\). In this case, the term \(I_{2.1}\) can be alternatively transformed to

\[I_{2.1} =\left|\left\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\;\bm{\Theta}^ {(J)}-\widetilde{\bm{\Theta}}^{(J)}\right\rangle\right|\] (C.19) \[\leq\left|\left\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\;\bm{ \Theta}^{(J)}-\bm{\theta}_{0}-(\bm{\Sigma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0) }/\sqrt{m}\right\rangle\right|\] \[\qquad\qquad+\left|\left\langle g(\bm{x}_{t};\bm{\theta}_{t-1}), \;\widetilde{\bm{\Theta}}^{(J)}-\bm{\theta}_{0}-(\bm{\Sigma}_{t-1}^{(0)})^{-1 }\widetilde{\bm{b}}_{t-1}^{(0)}/\sqrt{m}\right\rangle\right|\] \[\qquad\qquad+\underbrace{\left|\left\langle g(\bm{x}_{t};\bm{ \theta}_{t-1}),\;(\bm{\Sigma}_{t-1}^{(0)})^{-1}(\sum_{\tau\in[t-1]}w_{t}^{( \tau)}g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c_{\tau})/m\right\rangle\right|}_ {I_{2.2}}\]

where the inequality is due to the definition of gradient-based regression parameters.

When trying to bound the first two terms on the RHS, we first apply Holder's inequality with \(\bm{\tilde{\Sigma}}_{t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}g(\widetilde{ \bm{x}}_{\tau};\bm{\theta}_{\tau-1})g(\widetilde{\bm{x}}_{\tau};\bm{\theta}_{ \tau-1})^{\intercal}/m\), and it further leads to

\[\left\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\;\bm{\Theta}^{(J)}- \bm{\theta}_{0}-(\bm{\Sigma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0)}/\sqrt{m}\right\rangle\] \[\qquad\leq\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\| _{(\bm{\Sigma}_{t-1})^{-1}}\cdot\sqrt{m}\cdot\left\|\bm{\Theta}^{(J)}-\bm{ \theta}_{0}-(\bm{\Sigma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0)}/\sqrt{m}\right\| _{(\bm{\Sigma}_{t-1})}\] \[\qquad\leq\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\| _{(\bm{\Sigma}_{t-1})^{-1}}\cdot\mathcal{O}(\lambda+tL)\cdot\left\|\sqrt{m}( \bm{\Theta}^{(J)}-\bm{\theta}_{0})-(\bm{\Sigma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^ {(0)}\right\|_{2}\] \[\qquad\qquad\qquad\cdot\mathcal{O}\bigg{(}(1-\eta m\lambda)^{J/2} \sqrt{t/\lambda}+m^{-1/6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t /\lambda})\bigg{)}\] \[\qquad\leq\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\| _{(\bm{\Sigma}_{t-1})^{-1}}\cdot\mathcal{O}(\sqrt{\lambda}S)\]

where the first two inequalities is by Holder's inequality and Cauchy-Schwartz inequality. The third inequality is by Lemma G.6. The fourth inequality is by applying Lemma D.1, with the optimization problem being (C.12), in terms of the difference between gradient-based parameters and the auxiliary sequence. Finally, with \(w_{t}\leq 1\) and the conditions in Theorem 5.6, applying the conclusion from Remark 4.7 in [86] will give the last inequality. Following a similar approach can also lead to the upper bound for the second term on the RHS of (C.19).

**Bounding Term \(I_{2.2}\) Based on Arm Weights.** Next, we need to bound term \(I_{2.2}\). Recall that we want to have an upper bound for the following term

\[I_{2.2} =\left|\left\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\;(\bm{\Sigma} _{t-1}^{(0)})^{-1}(\sum_{\tau\in[t-1]}g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c _{\tau})/m\right\rangle\right|\] \[\leq\bigg{|}\sum_{\tau\in[t-1]}\left\langle g(\bm{x}_{t};\bm{ \theta}_{t-1}),\;(\bm{\Sigma}_{t-1}^{(0)})^{-1}g(\bm{x}_{\tau};\bm{\theta}_{ \tau-1})\cdot c_{\tau}/m\right\rangle\bigg{|}+\mathcal{O}(Cm^{-1/6}\sqrt{\log (m)}t^{1/6}\lambda^{-7/6}L^{4})\] \[\leq\bigg{|}\sum_{\tau\in[t-1]}\left\langle g(\bm{x}_{t};\bm{ \theta}_{t-1}),\;(\bm{\Sigma}_{t-1})^{-1}g(\bm{x}_{\tau};\bm{\theta}_{\tau-1}) \cdot c_{\tau}/m\right\rangle\bigg{|}+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/ 6}\lambda^{-7/6}L^{4})\] \[\qquad\qquad+\bigg{|}\sum_{\tau\in[t-1]}\left\langle g(\bm{x}_{t };\bm{\theta}_{t-1}),\;((\bm{\Sigma}_{t-1}^{(0)})^{-1}-(\bm{\Sigma}_{t-1})^{-1 })g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\cdot c_{\tau}/m\right\rangle\bigg{|}\] \[\leq\underbrace{\bigg{|}\sum_{\tau\in[t-1]}\left\langle g(\bm{x}_{ t};\bm{\theta}_{t-1}),\;(\bm{\Sigma}_{t-1})^{-1}g(\bm{x}_{\tau};\bm{\theta}_{ \tau-1})\cdot c_{\tau}/m\right\rangle\bigg{|}}_{I_{2.3}}+\mathcal{O}(Cm^{-1/6 }\sqrt{\log(m)}t^{7/6}\lambda^{-1/6}L^{5})\] \[\qquad\qquad\qquad+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6} \lambda^{-7/6}L^{4})\]where the first inequality follows from applying the triangle inequality and Lemma G.4. The second inequality is also due to the triangle inequality, and the last inequality follows from Lemma G.6. In particular, we aim to train separate neural models \(f(\cdot;\bm{\theta}_{i,t})\) for each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) to minimize the term \(I_{2.2}\). Similarly, recall that \(\bar{\bm{\Sigma}}_{t-1}=\lambda\mathds{I}+\sum_{\tau\in[t-1]}g(\bm{x}_{\tau}; \bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m\) is the gradient covariance matrix without arm weights, and \(w_{t}^{(\tau)}\) is the weight of arm \(\bm{x}_{t}\), defined as \(w_{t}^{(\tau)}=\min\{1,\ \frac{\alpha\cdot\min_{\bm{\theta}\in\mathcal{X}_{t}} \|g(\bm{x};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\Sigma}_{t-1}^{(\kappa)}}^{2}}{g _{\tau}\cdot\|g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\|_{\bm{\Sigma}_{ t-1}^{(\kappa)}}}\}\), where \(\alpha>0\) is the tunable parameter. Similar to the derivation of term \(I_{1.3}\), it can further lead to

\[I_{2.3} \leq\bigg{|}\sum_{\tau\in[t-1]}\frac{w_{t}^{(\tau)}\cdot c_{\tau} }{m}\cdot\left\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ (\bm{\Sigma}_{t-1})^{-1}\cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\right\rangle \bigg{|}\] \[\leq\bigg{|}\sum_{\tau\in[t-1]}w_{t}^{(\tau)}\cdot c_{\tau}\cdot \left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1})^ {-1}}\cdot\left\|(\bm{\Sigma}_{t-1})^{-1}\cdot g(\bm{x}_{\tau};\bm{\theta}_{ \tau-1})/\sqrt{m}\right\|_{\bm{\Sigma}_{t-1}}\bigg{|}\] \[\leq\bigg{|}\sum_{\tau\in[t-1]}w_{t}^{(\tau)}\cdot c_{\tau}\cdot \left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{(\bm{\Sigma}_{t-1})^ {-1}}\cdot\left\|g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\right\|_{( \bm{\Sigma}_{t-1})^{-1}}\bigg{|}\] \[\leq\alpha C\cdot\min_{\bm{x}\in\mathcal{X}_{t}}\hskip-1.422638pt \bigg{\|}g(\bm{x};\bm{\theta}_{t-1})/\sqrt{m}\bigg{\|}_{(\bar{\bm{\Sigma}}_{t- 1})^{-1}}^{2}\] \[\leq\alpha C\cdot\bigg{\|}g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m }\bigg{\|}_{(\bar{\bm{\Sigma}}_{t-1})^{-1}}^{2}\]

where the first inequality is by applying the Holder's inequality, and the second and third inequalities are by applying Lemma G.8 with the fact that \(\bm{\Sigma}_{t-1}\succeq\bar{\bm{\Sigma}}_{t-1}^{(\kappa)}\succeq\bar{\bm{ \Sigma}}_{\tau-1}^{(\kappa)}\) by definition. The last two inequalities are due to the definition of arm weight \(w_{t}^{(\tau)}\), as well as the definition of corruption level \(C=\sum_{t\in[T]}|c_{t}|\). As a result, by combining the upper bounds for the terms \(I_{2.4}\) and \(I_{2.5}\), we obtain the following upper bound for \(I_{2.2}\):

\[I_{2.2}\leq\mathcal{O}(\alpha C) \cdot\bigg{\|}g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\bigg{\|}_{( \bm{\Sigma}_{t-1})^{-1}}^{2}+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^ {-1/6}L^{5})\] \[+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^{4}).\]

In this case, since we need to ensure that the minimum weight is \(\kappa^{2}\), we scale the tunable parameter \(\alpha>0\) accordingly. Recall that this does not require the learner to have the prior knowledge of the minimum fraction value \(\beta\), and the learner can adjust the \(\alpha\) values in each round to ensure that the round-wise minimum weight \(w_{t}^{\text{min}}=\min\{w_{i,t}^{(\tau)}\}_{i\in[K]}<1\), for all \(t\in[T]\) and \(\tau\in[t-1]\). By summing up all the results, we have

\[I_{2}\leq\mathcal{O}(\alpha C)\cdot\bigg{\|}g(\bm{x}_{t};\bm{ \theta}_{t-1})/\sqrt{m}\bigg{\|}_{(\bar{\bm{\Sigma}}_{t-1})^{-1}}^{2}+\mathcal{ O}(\sqrt{\lambda}S)\cdot\bigg{\|}g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m} \bigg{\|}_{(\bar{\bm{\Sigma}}_{t-1})^{-1}}\] \[+\mathcal{O}(m^{-2/3}\log(m)L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{ t/\lambda}))+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-1/6}L^{5})\] \[\qquad+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^ {4}).\]

### Deriving the UCB and confidence ellipsoid for corruption-free parameters and corrupted parameters

In this subsection, we provide upper bounds for \(\widehat{\mathsf{UCB}}_{t}(\bm{x}_{t})\) in terms of the corruption-free parameters \(\widetilde{\bm{\theta}}_{t-1}\). Recall that without the arm index \(i\in[K]\), the parameters \(\bm{\theta}\), covariance matrix \(\bm{\Sigma}_{t-1}\)confidence ellipsoid \(\mathcal{C}_{t-1}\), and weights \(w_{t}\) pertain to the chosen arm \(\bm{x}_{t}\). For the hypothetical corruption-free parameters \(\widetilde{\bm{\theta}}\), trained with corruption-free rewards, Lemma C.9 provides the corresponding UCB result, and Lemma C.10 introduces the associated confidence ellipsoid. For the trained parameters \(\bm{\theta}_{i,t-1}\), based on the received records \(\mathcal{P}_{t-1}\) with potentially corrupted rewards, Lemma C.11 presents the corresponding UCB for each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), while Lemma C.12 provides the corresponding confidence ellipsoid. Note that Lemmas C.11 and C.12 are used solely to motivate the design of our UCB-type exploration strategy and are not applied to derive the cumulative regret analysis result.

**Lemma C.9**.: _Suppose the imaginary neural network \(f(\cdot;\widetilde{\bm{\theta}}_{t-1})\) in round \(t\in[T]\) has been trained on corruption-free rewards \(\{\bm{x}_{\tau},\widetilde{r}_{\tau}\}_{\tau\in[t-1]}\), and \(f(\cdot)\) is an L-layer FC network with width \(m\). Suppose we have \(m,J,\eta\) satisfying the conditions in Theorem 5.6. Then, for the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\), with the probability at least \(1-\delta\), we will have_

\[\widetilde{\bm{UC}}\widetilde{\bm{B}}_{t}(\bm{x}_{t})=\widetilde{V }(\bm{x}_{t})-h(\bm{x}_{t}) \leq 2\widetilde{\gamma}_{t-1}\cdot\|g(\bm{x}_{t};\widetilde{\bm{ \theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{t-1}^{-1}}+\mathcal{O}( Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6}L^{2/7})\] \[\quad+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^{2 /7}),\]

_and the corresponding summation value across \(T\) rounds will be_

\[\sum_{t\in[T]}\min\big{\{}\widetilde{\bm{UC}}\widetilde{\bm{B}}_{ t}(\bm{x}_{t}),1\big{\}}=\sum_{t\in[T]}\min\big{\{}\widetilde{V}(\bm{x}_{t})-h( \bm{x}_{t}),1\big{\}}\] \[\leq\frac{1}{\sqrt{w_{t}^{\mathsf{min}}}}\mathcal{O}\bigg{(}\nu \sqrt{\log\frac{\det(\widetilde{\bm{\Sigma}}_{T})}{\det(\lambda\mathbf{I})}-2 \log(\delta)}+\lambda^{1/2}S\bigg{)}\cdot\sqrt{2T\cdot\log\frac{\det(\widetilde {\bm{\Sigma}}_{T})}{\det(\lambda\mathbf{I})}}\] \[\quad\quad\quad\quad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}T^{7/6} \lambda^{-1/6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}T^{7/6}\lambda^{-7/6} L^{2/7})\]

_By definitions in Lemma C.10, we have the corresponding radius term for confidence ellipsoid \(\widetilde{\mathcal{C}}_{t-1}\) as \(\widetilde{\gamma}_{t-1}=\mathcal{O}\bigg{(}\nu\cdot\sqrt{\log\frac{\det( \widetilde{\bm{\Sigma}}_{t-1})}{\det(\lambda\mathbf{I})}-2\log(\delta)}+ \lambda^{1/2}S\bigg{)}\), and the gradient covariance matrix as \(\widetilde{\bm{\Sigma}}_{t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{t}^{(\tau )}\cdot g(\bm{x}_{\tau};\widetilde{\bm{\theta}}_{\tau-1})g(\bm{x}_{\tau}; \widetilde{\bm{\theta}}_{\tau-1})^{\intercal}/m\)._

Proof.: With the confidence ellipsoid around the corruption-free parameters \(\widetilde{\mathcal{C}}_{t-1}:=\{\bm{\theta}:\|\bm{\theta}-\widetilde{\bm{ \theta}}_{t-1}\|_{\widetilde{\bm{\Sigma}}_{t-1}}\leq\widetilde{\gamma}_{t-1}/ \sqrt{m},\widetilde{\gamma}_{t-1}>0\}\), we have \(\bm{\theta}^{*}\in\widetilde{\mathcal{C}}_{t-1}\) according to Lemma C.10. In this case, with the coefficient \(\widetilde{\gamma}_{t-1}=\mathcal{O}\big{(}\nu\cdot\sqrt{\log\frac{\det( \widetilde{\bm{\Sigma}}_{t-1})}{\det(\lambda\mathbf{I})}-2\log(\delta)}+ \lambda^{1/2}S\big{)}\) and the gradient covariance matrix \(\widetilde{\bm{\Sigma}}_{t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{t}^{(\tau )}\cdot g(\bm{x}_{\tau};\widetilde{\bm{\theta}}_{\tau-1})g(\bm{x}_{\tau}; \widetilde{\bm{\theta}}_{\tau-1})^{\intercal}/m\), we have

\[\widetilde{\bm{\mathrm{UC}}}\widetilde{\bm{B}}_{t} (\bm{x}_{t})=\widetilde{V}(\bm{x}_{t})-h(\bm{x}_{t})\] (C.20) \[=\max_{\bm{\theta}\in\widetilde{\mathcal{C}}_{t-1}}\big{\langle}g( \bm{x}_{t};\widetilde{\bm{\theta}}_{0}),\ \bm{\theta}-\bm{\theta}_{0}\big{\rangle}-\big{\langle}g(\bm{x}_{t};\bm{\theta}_{ 0}),\ \bm{\theta}^{*}-\bm{\theta}_{0}\big{\rangle}\] \[\leq\max_{\bm{\theta}\in\widetilde{\mathcal{C}}_{t-1}}\big{\langle}g (\bm{x}_{t};\widetilde{\bm{\theta}}_{0}),\ \bm{\theta}-\widetilde{\bm{\theta}}_{t-1}\big{\rangle}-\big{\langle}g(\bm{x}_{t}; \widetilde{\bm{\theta}}_{t-1}),\ \bm{\theta}^{*}-\widetilde{\bm{\theta}}_{t-1}\big{\rangle}\] \[\quad\quad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6 }L^{2/7})\] \[\leq\max_{\bm{\theta}\in\widetilde{\mathcal{C}}_{t-1}}\|\bm{ \theta}-\widetilde{\bm{\theta}}_{t-1}\|_{\widetilde{\bm{\Sigma}}_{t-1}}\|g(\bm{x}_ {t};\widetilde{\bm{\theta}}_{0})\|_{\widetilde{\bm{\Sigma}}_{t-1}^{-1}}+\|g(\bm{x }_{t};\widetilde{\bm{\theta}}_{t-1})\|_{\widetilde{\bm{\Sigma}}_{t-1}^{-1}}\| \bm{\theta}^{*}-\widetilde{\bm{\theta}}_{t-1}\|_{\widetilde{\bm{\Sigma}}_{t-1}}\] \[\quad\quad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6 }L^{2/7})\] \[\leq 2\widetilde{\gamma}_{t-1}\cdot\|g(\bm{x}_{t};\widetilde{\bm{ \theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{t-1}^{-1}}+\mathcal{O}(Sm^{- 1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6}L^{2/7})\] \[\quad\quad+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^ {2/7})\]

where the first inequality is by Lemma G.4, second inequality is by Holder's inequality, and the last inequality is by applying the definition of confidence ellipsoid \(\widetilde{\mathcal{C}}_{t-1}\), Lemma G.4, and Lemma G.6. Next, recall that the above \(\widetilde{\bm{\mathrm{UC}}}\widetilde{\bm{B}}_{t}\) is one term composing the single-round regret \(R_{t}\), and for the cumulative regret, it will be summed up across \(T\) rounds. In this case, for the first term on the RHSabove, we have

\[\sum_{t\in[T]}2\cdot\min\left\{\widetilde{\gamma}_{t-1}\cdot\|g( \bm{x}_{t};\widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{t- 1}^{-1}},\;1\right\}=\sum_{t\in[T]}2\cdot\min\left\{\frac{\widetilde{\gamma}_{t -1}}{\sqrt{w_{t}}}\cdot\|\sqrt{w_{t}}g(\bm{x}_{t};\widetilde{\bm{\theta}}_{t-1} )/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{t-1}^{-1}},\;1\right\}\] \[\qquad\qquad\qquad\leq 2(1+\frac{\widetilde{\gamma}_{T}}{\sqrt{w_{t}^{ \mathsf{min}}}})\cdot\sum_{t\in[T]}\min\left\{\|\sqrt{w_{t}}g(\bm{x}_{t}; \widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{t-1}^{-1} },\;1\right\}\] \[\qquad\qquad\qquad\qquad\leq 2(1+\frac{\widetilde{\gamma}_{T}}{ \sqrt{w_{t}^{\mathsf{min}}}})\cdot\sqrt{T\cdot\sum_{t\in[T]}\min\left\{\| \sqrt{w_{t}}g(\bm{x}_{t};\widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{\widetilde {\bm{\Sigma}}_{t-1}^{-1}}^{2},\;1\right\}}\]

where we have \(w_{t}^{\mathsf{min}}<1\). Then, applying Lemma G.7 and by the definition of \(\gamma_{T}\) as well as supposing that \(\frac{\widetilde{\gamma}_{T}}{\sqrt{w_{t}^{\mathsf{min}}}}\geq 1\), we will have

\[\sum_{t\in[T]}2\min\left\{\widetilde{\gamma}_{t-1}\cdot\|g(\bm{x }_{t};\widetilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{t-1 }^{-1}},\;1\right\}\] \[\qquad\qquad\qquad\qquad\leq\frac{1}{\sqrt{w_{t}^{\mathsf{min}}} }\mathcal{O}\bigg{(}\nu\sqrt{\log\frac{\det(\widetilde{\bm{\Sigma}}_{T})}{ \det(\lambda\mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S\bigg{)}\cdot\sqrt{2T \cdot\log\frac{\det(\widetilde{\bm{\Sigma}}_{T})}{\det(\lambda\mathbf{I})}}.\]

Next, for the corrupted parameters \(\bm{\theta}_{i,t-1}\), we consider the confidence ellipsoid \(\mathcal{C}_{i,t-1}:=\{\bm{\theta}:\|\bm{\theta}-\bm{\theta}_{i,t-1}\|_{\bm{ \Sigma}_{i,t-1}}\leq\gamma_{i,t-1}/\sqrt{m}\}\) constructed around the corrupted parameters \(\bm{\theta}_{i,t-1}\), with the coefficient \(\gamma_{i,t-1}=\mathcal{O}\big{(}\nu\cdot\sqrt{\log\frac{\det(\widetilde{\bm{ \Sigma}}_{i,t-1})}{\det(\lambda\mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S\big{)}\) and the gradient covariance matrix \(\bm{\Sigma}_{i,t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g (\bm{x}_{\tau};\bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{ \intercal}/m\).

**Lemma C.10**.: _In round \(t\), with the notation and conditions in Theorem 5.6, suppose the corruption-free parameters \(\widetilde{\bm{\theta}}_{i,t-1}\) associated with a candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) are trained by \(\mathcal{L}(\bm{\theta})=\frac{1}{2}\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot|f (\bm{x}_{\tau};\bm{\theta})-\widetilde{r}_{\tau}|^{2}+\frac{m\lambda}{2} \cdot\|\bm{\theta}-\bm{\theta}_{0}\|_{2}^{2}\). Then, we have the corresponding confidence ellipsoid_

\[\widetilde{\mathcal{C}}_{i,t-1}:=\{\bm{\theta}:\|\bm{\theta}-\widetilde{\bm{ \theta}}_{i,t-1}\|_{\widetilde{\bm{\Sigma}}_{i,t-1}}\leq\widetilde{\gamma}_{i, t-1}/\sqrt{m}\},\]

_such that \(\bm{\theta}^{*}\in\widetilde{\mathcal{C}}_{i,t-1}\), where \(\widetilde{\gamma}_{i,t-1}=\mathcal{O}\big{(}\nu\cdot\sqrt{\log\frac{\det( \widetilde{\bm{\Sigma}}_{i,t-1})}{\det(\lambda\mathbf{I})}-2\log(\delta)}+ \lambda^{1/2}S\big{)}\), and the gradient covariance matrix \(\widetilde{\bm{\Sigma}}_{i,t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{i,t}^{( \tau)}\cdot g(\bm{x}_{\tau};\widetilde{\bm{\theta}}_{\tau-1})g(\bm{x}_{\tau}; \widetilde{\bm{\theta}}_{\tau-1})^{\intercal}/m\)._

Proof.: The proof of this lemma follows an analogous approach as in Lemma 5.2 in [86]. Recall that based on Lemma C.1, we have the expected reward of an arm \(\bm{x}\in\mathcal{X}_{t}\) being \(\mathbb{E}[r|\bm{x}]=h(\bm{x})=\langle g(\bm{x};\bm{\theta}_{0}),\;\bm{ \theta}^{*}-\bm{\theta}_{0}\rangle\) where there exist parameters \(\bm{\theta}^{*}\) such that \(\|\bm{\theta}^{*}-\bm{\theta}_{0}\|\leq S/\sqrt{m},S>0\). Intuitively, for each previously chosen arm \(\bm{x}_{\tau},\tau\in[t-1]\), we can consider an alternative form being

\[\mathbb{E}\left[\sqrt{w_{i,t}^{(\tau)}}\cdot r\bigg{|}\,\bm{x}_{\tau}\right]= \sqrt{w_{i,t}^{(\tau)}}\cdot h(\bm{x}_{\tau})=\bigg{\langle}\sqrt{w_{i,t}^{( \tau)}}\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})/\sqrt{m},\;\sqrt{m}(\bm{\theta}^ {*}-\bm{\theta}_{0})\bigg{\rangle}\]

where \(w>0\) refers to the weight associated with arm \(\bm{x}\) in our settings of R-NeuralUCB. Afterwards, with the weighted sequence of chosen arm gradients as well as their expected corruption-free rewards, we can have

\[\|\sqrt{m}(\bm{\theta}^{*}-\bm{\theta}_{0})-(\widetilde{\bm{\Sigma}}_{i,t-1}^{(0) })^{-1}\widetilde{\bm{b}}_{i,t-1}^{(0)}\|_{\widetilde{\bm{\Sigma}}_{i,t-1}^{(0) }}\leq\nu\cdot\sqrt{\log\frac{\det(\widetilde{\bm{\Sigma}}_{i,t-1}^{(0)})}{ \det(\lambda\mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S,\]

by applying the conclusion of Theorem 2 from [1]. In this case, by triangular inequality, we also have

\[\|\bm{\theta}^{*}-\bm{\theta}_{0}\|_{\widetilde{\bm{\Sigma}}_{i,t-1}}\] \[\qquad\leq\|\bm{\theta}^{*}-\bm{\theta}_{0}-(\widetilde{\bm{ \Sigma}}_{i,t-1}^{(0)})^{-1}\widetilde{\bm{b}}_{i,t-1}^{(0)}/\sqrt{m}\|_{ \widetilde{\bm{\Sigma}}_{i,t-1}}+\|\widetilde{\bm{\theta}}_{i,t-1}-\bm{\theta} _{0}-(\widetilde{\bm{\Sigma}}_{i,t-1}^{(0)})^{-1}\widetilde{\bm{b}}_{i,t-1}^{(0) }/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{i,t-1}}.\]Then, for the first term on the right hand side, we have

\[\|\bm{\theta}^{*}-\bm{\theta}_{0}-(\widetilde{\bm{\Sigma}}^{(0)}_{i, t-1})^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{i,t-1}}^ {2}\] \[=(\bm{\theta}^{*}-\bm{\theta}_{0}-(\widetilde{\bm{\Sigma}}^{(0)}_{ i,t-1})^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m})^{\intercal}\widetilde{\bm{ \Sigma}}_{i,t-1}(\bm{\theta}^{*}-\bm{\theta}_{0}-(\widetilde{\bm{\Sigma}}^{(0)} _{i,t-1})^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m})\] \[=(\bm{\theta}^{*}-\bm{\theta}_{0}-(\widetilde{\bm{\Sigma}}^{(0)}_ {i,t-1})^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m})^{\intercal}\widetilde{ \bm{\Sigma}}^{(0)}_{i,t-1}(\bm{\theta}^{*}-\bm{\theta}_{0}-(\widetilde{\bm{ \Sigma}}^{(0)}_{i,t-1})^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m})\] \[\quad+(\bm{\theta}^{*}-\bm{\theta}_{0}-(\widetilde{\bm{\Sigma}}^{ (0)}_{i,t-1})^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m})^{\intercal} \cdot(\widetilde{\bm{\Sigma}}_{i,t-1}-\widetilde{\bm{\Sigma}}^{(0)}_{i,t-1}) \cdot(\bm{\theta}^{*}-\bm{\theta}_{0}-(\widetilde{\bm{\Sigma}}^{(0)}_{i,t-1}) ^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m})\] \[\leq(\bm{\theta}^{*}-\bm{\theta}_{0}-(\widetilde{\bm{\Sigma}}^{ (0)}_{i,t-1})^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m})^{\intercal} \widetilde{\bm{\Sigma}}^{(0)}_{i,t-1}(\bm{\theta}^{*}-\bm{\theta}_{0}-( \widetilde{\bm{\Sigma}}^{(0)}_{i,t-1})^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/ \sqrt{m})\] \[\quad+\frac{\|\widetilde{\bm{\Sigma}}_{i,t-1}-\widetilde{\bm{ \Sigma}}^{(0)}_{i,t-1}\|_{2}}{\lambda}\cdot(\bm{\theta}^{*}-\bm{\theta}_{0}-( \widetilde{\bm{\Sigma}}^{(0)}_{i,t-1})^{-1}\widetilde{\bm{b}}^{(0)}_{i,t-1}/ \sqrt{m})^{\intercal}\widetilde{\bm{\Sigma}}^{(0)}_{i,t-1}(\bm{\theta}^{*}-\bm {\theta}_{0}-(\widetilde{\bm{\Sigma}}^{(0)}_{i,t-1})^{-1}\widetilde{\bm{b}}^{( 0)}_{i,t-1}/\sqrt{m})\] \[\leq(1+\frac{\|\widetilde{\bm{\Sigma}}_{i,t-1}-\widetilde{\bm{ \Sigma}}^{(0)}_{i,t-1}\|_{2}}{\lambda})\cdot\bigg{(}\nu\cdot\sqrt{\log\frac{ \det(\widetilde{\bm{\Sigma}}^{(0)}_{i,t-1})}{\det(\lambda\mathbf{I})}}-2\log (\delta)+\lambda^{1/2}S\bigg{)}/m\] \[\leq m^{-1/2}\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4} t^{7/6}\lambda^{-7/6})}\] \[\qquad\cdot\bigg{(}\nu\cdot\sqrt{\log\frac{\det(\widetilde{\bm{ \Sigma}}_{i,t-1})}{\det(\lambda\mathbf{I})}}+\mathcal{O}(m^{-1/6}\sqrt{\log(m)} L^{4}t^{5/3}\lambda^{-1/6})-2\log(\delta)+\lambda^{1/2}S\bigg{)}\]

where the first inequality is because \(\bm{x}^{\intercal}\mathbf{A}\bm{x}\leq\bm{x}^{\intercal}\mathbf{B}\bm{x}\cdot \|\bm{\Lambda}\|_{2}/\lambda_{\mathsf{min}}(\mathbf{B})\) for some \(0\prec\mathbf{B}\) and the fact that the minimum eigenvalue \(\lambda_{\mathsf{min}}(\widetilde{\bm{\Sigma}}^{(0)}_{i,t-1})\geq\lambda\), and the last inequality is by Lemma G.6 as well as due to the fact \(w_{i,t}^{(\tau)}\leq 1\). Afterwards, for the second term, we have

\[\|\widetilde{\bm{\theta}}_{i,t-1}- \bm{\theta}_{0}-(\widetilde{\bm{\Sigma}}^{(0)}_{i,t-1})^{-1} \widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m}\|_{\widetilde{\bm{\Sigma}}_{i,t-1}} \leq\sqrt{\|\widetilde{\bm{\Sigma}}_{i,t-1}\|_{2}}\cdot\|\widetilde{\bm{\theta} }_{i,t-1}-\bm{\theta}_{0}-(\widetilde{\bm{\Sigma}}^{(0)}_{i,t-1})^{-1} \widetilde{\bm{b}}^{(0)}_{i,t-1}/\sqrt{m}\|_{2}\] \[\leq\mathcal{O}(\sqrt{\lambda+tL})\cdot\mathcal{O}\bigg{(}(1-\eta m \lambda)^{J/2}\sqrt{t/m\lambda}+m^{-2/3}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{- 5/3}(1+\sqrt{t/\lambda})\bigg{)}.\]

The first inequality follows from applying Lemma G.6. For the second inequality, we apply a similar approach as in Lemma D.1, with the optimization problem given by (C.12). Since we scale the \(\alpha\) parameter to ensure \(1>w_{i,t}^{(\tau)}\geq\kappa^{2}\), we can follow the proof of Lemma B.2 in [86] to bound the difference between GD-based optimization and gradient-based regression. With the minimum weight value lower bounded by \(\kappa^{2}\) and under the conditions in Theorem 5.6, applying Remark 4.7 in [86] completes the proof.

**Lemma C.11**.: _For candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), suppose its associated neural network \(f(\cdot;\bm{\theta}_{i,t-1})\) has been trained on received records \(\{\bm{x}_{\tau},r_{\tau}\}_{\tau\in[t-1]}\), with \(J\) iterations of GD and learning rate \(\eta\). Let \(f(\cdot;\bm{\theta}_{i,t-1})\) be an L-layer FC network with width \(m\). Suppose conditions in Theorem 5.6 are satisfied. Then, given the candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), with a constant \(\zeta>0\) and probability at least \(1-\delta\), we will have_

\[\big{|}f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})-h(\bm{x}_{i,t})\big{|}\] \[\leq\|g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{\bm{ \Sigma}^{-1}_{i,t-1}}\cdot\bigg{[}\zeta\cdot\bigg{(}\nu\sqrt{\log\frac{\det(\bm{ \Sigma}_{i,t-1})}{\det(\lambda\mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S \bigg{)}\] \[\qquad\qquad+(1-\eta m\lambda)^{J/2}\sqrt{t/\lambda}+\mathcal{O}(m ^{-1/6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\] \[\qquad\qquad+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/ 6}L^{7/2})+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\] \[\qquad\qquad+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L ^{4}t^{7/6}\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{2}t^{5/6} \lambda^{-1/12})\bigg{]}\] \[\qquad\qquad+\mathcal{O}(\alpha C)\cdot\min_{\bm{x}\in\mathcal{X}_{t }}\|g(\bm{x};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{\bm{\Sigma}^{-1}_{i-1}}^{2}\] \[\qquad\qquad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/ 6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3}),\] (C.21)_with notation and definitions in Theorem 5.6. We also have the covariance matrix \(\bm{\Sigma}_{i,t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t]}w_{i,t}^{(\tau)}\cdot g(\bm{x }_{\tau};\bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}\), with gradient vector \(g(\bm{x}_{i,t};\bm{\theta})=\text{vec}(\nabla_{\bm{\theta}}f(\bm{x}_{i,t};\bm{ \theta}))\)._

**Proof.** Applying the Lemma C.1, we can transform the objective by substituting the reward mapping function \(h(\cdot)\), as

\[\big{|}f(\bm{x}_{i,t}; \bm{\theta}_{i,t-1})-h(\bm{x}_{i,t})\big{|}=\big{|}f(\bm{x}_{i,t}; \bm{\theta}_{i,t-1})-\big{\langle}g(\bm{x}_{i,t};\bm{\theta}_{0}),\bm{\theta} ^{*}-\bm{\theta}_{0}\big{\rangle}\big{|}\] \[\leq\big{|}f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})-\big{\langle}g(\bm {x}_{i,t};\bm{\theta}_{i,t-1}),\bm{\theta}^{*}-\bm{\theta}_{0}\big{\rangle} \big{|}+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6}L^{2/7})\] \[\leq\big{|}f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})-\big{\langle}g(\bm {x}_{i,t};\bm{\theta}_{i,t-1}),\bm{\theta}_{i,t-1}-\bm{\theta}_{0}\big{\rangle} \big{|}\] \[\qquad\qquad+\big{|}\big{\langle}g(\bm{x}_{i,t};\bm{\theta}_{i,t- 1}),\bm{\theta}_{i,t-1}-\bm{\theta}_{0}\big{\rangle}-\big{\langle}g(\bm{x}_{i,t};\bm{\theta}_{i,t-1}),\bm{\theta}^{*}-\bm{\theta}_{0}\big{\rangle}\big{|}\] \[\qquad\qquad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{- 1/6}L^{2/7})\]

where the first equality is due to Lemma C.1, while the first inequality is due to Lemma G.4 and Lemma C.1, and the last inequality is because of the triangular inequality. Then, we proceed to separately bound the first and second term on the RHS. For the first term, we will have

\[\big{|}f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})-\big{\langle}g(\bm{x }_{i,t};\bm{\theta}_{i,t-1}),\bm{\theta}_{i,t-1}-\bm{\theta}_{0}\big{\rangle} \big{|}\] \[=\big{|}f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})-f(\bm{x}_{i,t};\bm{ \theta}_{0})-\big{\langle}g(\bm{x}_{i,t};\bm{\theta}_{i,t-1}),\bm{\theta}_{i,t -1}-\bm{\theta}_{0}\big{\rangle}\big{|}\] \[\leq\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3})\]

where the first equality is due to the fact that \(f(\bm{x}_{i,t};\bm{\theta}_{0})=0\) based on our parameter initialization approach, and the inequality is by applying Lemma G.5 and Lemma G.3. Then, for the second term, we will have

\[\big{|}\big{\langle}g(\bm{x}_{i,t};\bm{\theta}_{i,t-1}), \bm{\theta}_{i,t-1}-\bm{\theta}_{0}\big{\rangle}-\big{\langle}g(\bm {x}_{i,t};\bm{\theta}_{i,t-1}),\bm{\theta}^{*}-\bm{\theta}_{0}\big{\rangle} \big{|}\] \[=\big{|}\big{\langle}g(\bm{x}_{i,t};\bm{\theta}_{i,t-1}),\bm{ \theta}^{*}-\bm{\theta}_{i,t-1}\big{\rangle}\big{|}\] \[\leq\|g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{\bm{\Sigma}_ {i,t-1}^{-1}}\cdot\sqrt{m}\cdot\|\bm{\theta}^{*}-\bm{\theta}_{i,t-1}\|_{\bm{ \Sigma}_{i,t-1}}\] \[\leq\gamma_{i,t-1}\cdot\|g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/\sqrt {m}\|_{\bm{\Sigma}_{i,t-1}^{-1}}\]

where the first inequality is by applying the Holder's inequality, and the last inequality is by applying Lemma 5.2 in [86], Lemma C.1 in terms of the confidence set \(\mathcal{C}_{i,t-1}\) and the fact that \(\bm{\theta}^{*}\in\mathcal{C}_{i,t-1}\). Then, with the confidence ellipsoid introduced and discussed in Lemma C.12, summing up the results above, we will then have

\[\bigg{|}f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})-h(\bm{x}_{i,t})\bigg{|}\] \[\leq\|g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{\bm{\Sigma} _{i,t-1}^{-1}}\] \[\qquad\cdot\bigg{[}\mathcal{O}\bigg{(}\nu\sqrt{\log\frac{\det( \bm{\Sigma}_{i,t-1})}{\det(\lambda\mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S \bigg{)}+\mathcal{O}(\alpha C)\cdot\frac{\min\limits_{\bm{x}\in\mathcal{X}_{i }}\|g(\bm{x};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{\bm{\Sigma}_{t-1}^{-1}}^{2}}{ \|g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{(\bm{\Sigma}_{t-1}^{(\bm{ \theta}_{i-1})})^{-1}}}\] \[\qquad\qquad+(1-\eta m\lambda)^{J/2}\sqrt{t/\lambda}+\mathcal{O} (m^{-1/6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\] \[\qquad\qquad+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{1/6}\lambda^{- 7/6}L^{7/2})+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\] \[\qquad\qquad+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L ^{4}t^{7/6}\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{2}t^{5/6 }\lambda^{-1/12})\bigg{]}\] \[\qquad\qquad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{- 1/6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3})\]\[=\|g(\bm{x}_{i,t;}\bm{\theta}_{i,t-1})/\sqrt{m}\|_{\bm{\Sigma}^{-1}_{i,t-1}}\] \[\quad\quad\cdot\Big{[}\mathcal{O} \Big{(}\nu\sqrt{\log\frac{\det(\bm{\Sigma}_{i,t-1})}{\det(\lambda \mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S\Big{)}\] \[\quad\quad+(1-\eta m\lambda)^{J/2}\sqrt{t/\lambda}+\mathcal{O}(m^ {-1/6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\] \[\quad\quad+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/ 6}L^{7/2})+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\] \[\quad\quad+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4 }t^{7/6}\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{2}t^{5/6} \lambda^{-1/12})\Big{]}\] \[+\|g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{\bm{\Sigma}^{ -1}_{i,t-1}}\cdot\mathcal{O}(\alpha C)\cdot\frac{\min_{\bm{x}\in\mathcal{X}_{t }}\|g(\bm{x};\bm{\theta}_{i,t-1})/\sqrt{m}\|^{2}_{\bm{\Sigma}^{-1}_{t-1}}}{\|g (\bm{x}_{i,t};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{(\bm{\Sigma}^{(\kappa)}_{t-1}) ^{-1}}}\] \[\quad\quad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/ 6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3}).\]

where we naturally have Hermitian matrices \(\bm{\Sigma}_{i,t-1}\succeq\bar{\bm{\Sigma}}^{(\kappa)}_{i-1}\) by definition, which leads to \((\bm{\Sigma}_{i,t-1})^{-1}\preceq(\bar{\bm{\Sigma}}^{(\kappa)}_{t-1})^{-1}\) by applying the conclusion from Lemma G.8. Afterwards, due to the fact that the minimum round-wise arm weight \(w^{\text{min}}_{t}=\min\{w^{(\tau)}_{i,t}\}_{i\in[K],\tau\in[t-1]}=\kappa^{2} <1,\;\forall t\in[T]\) by scaling parameter \(\alpha\), we can further have

\[\Big{|}f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})-h(\bm{x}_{i,t})\Big{|}\] \[\leq\|g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{\bm{\Sigma} ^{-1}_{i,t-1}}\] \[\quad\quad\cdot\bigg{[}\mathcal{O} \Big{(}\nu\sqrt{\log\frac{\det(\bm{\Sigma}_{i,t-1})}{\det(\lambda \mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S\Big{)}\] \[\quad\quad+(1-\eta m\lambda)^{J/2}\sqrt{t/\lambda}+\mathcal{O}(m^ {-1/6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\] \[\quad\quad+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{1/6}\lambda^{-7/ 6}L^{7/2})+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\] \[\quad\quad+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{ 4}t^{7/6}\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{2}t^{5/6} \lambda^{-1/12})\Big{]}\] \[\quad+\mathcal{O}(\alpha C)\cdot\min_{\bm{x}\in\mathcal{X}_{t}}\| g(\bm{x};\bm{\theta}_{i,t-1})/\sqrt{m}\|^{2}_{\bm{\Sigma}^{-1}_{t-1}}\] \[\quad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6}L^{ 2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3}),\]

which completes the proof for this lemma.

**Lemma C.12**.: _In round \(t\in[T]\), with the notation and conditions from Theorem 5.6, suppose the corrupted parameters \(\bm{\theta}_{i,t-1}\) associated with a candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) are trained by \(\mathcal{L}(\bm{\theta})=\frac{1}{2}\sum_{\tau\in[t-1]}w^{(\tau)}_{i,t}\cdot|f( \bm{x}_{\tau};\bm{\theta})-r_{\tau}|^{2}+\frac{m\lambda}{2}\cdot\|\bm{\theta} -\bm{\theta}_{0}\|^{2}_{2}\). Then, we have the confidence ellipsoid_

\[\mathcal{C}_{i,t-1}=\left\{\bm{\theta}:\|\bm{\theta}-\bm{\theta}_{i,t-1}\|_{ \bm{\Sigma}_{i,t-1}}\leq\gamma_{i,t-1}/\sqrt{m}\right\}\]

_where we have the unknown parameter \(\bm{\theta}^{*}\in\mathcal{C}_{i,t-1}\), and we denote_

\[\gamma_{i,t-1}=\mathcal{O}\bigg{(} \nu\sqrt{\log\frac{\det(\bm{\Sigma}_{i,t-1})}{\det(\lambda \mathbf{I})}-2\log(\delta)}+\lambda^{1/2}S\bigg{)}+\mathcal{O}(\alpha C)\cdot \frac{\min_{\bm{x}\in\mathcal{X}_{t}}\|g(\bm{x};\bm{\theta}_{i,t-1})/\sqrt{m}\|^ {2}_{\bar{\bm{\Sigma}}^{-1}_{t-1}}}{\|g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/\sqrt{ m}\|_{(\bar{\bm{\Sigma}}^{(\kappa)}_{t-1})^{-1}}}\] \[\quad+(1-\eta m\lambda)^{J/2}\sqrt{t/\lambda}+\mathcal{O}(m^{-1/ 6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\] \[\quad+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^{ 7/2})+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\] \[\quad+\nu\cdot\sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/ 6}\lambda^{-7/6})}\cdot\mathcal{O}(m^{-1/12}\log^{1/4}(m)L^{2}t^{5/6}\lambda^{- 1/12}).\]

**Proof.** Recall that for the imaginary corruption-free parameters \(\widetilde{\bm{\theta}}_{i,t-1}\), trained on corruption-free records \(\widetilde{\mathcal{P}}_{t-1}\), we can construct the confidence interval \(\widetilde{\mathcal{C}}_{i,t-1}:=\{\bm{\theta}:\|\bm{\theta}-\widetilde{\bm{ \theta}}_{i,t-1}\|_{\widetilde{\bm{\Sigma}}_{i,t-1}}\leq\widetilde{\gamma}_{i, t-1}/\sqrt{m},\widetilde{\gamma}_{i,t-1}>0\}\), ensuring that the unknown \(\bm{\theta}^{*}\) in Lemma C.1 satisfies \(\bm{\theta}^{*}\in\widetilde{\mathcal{C}}_{i,t-1}\). The corresponding confidence ellipsoid is presented in Lemma C.10.

With the ellipsoid centered at \(\bm{\theta}_{i,t-1}\) and the gradient covariance matrix defined as \(\bm{\Sigma}_{i,t-1}=\lambda\bm{\mathrm{I}}+\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)} \cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\cdot g(\bm{x}_{\tau};\bm{\theta}_{ \tau-1})^{\intercal}/m\), we proceed to derive the corresponding radius. Recall that \(w_{i,t}^{(\tau)}\) denotes the sample weight associated with the chosen arm \(\bm{x}_{\tau}\). For reference, we first recall the preliminary bounds: \(\|\bm{\Sigma}_{i,t-1}-\widetilde{\bm{\Sigma}}_{i,t-1}\|_{F}\leq\mathcal{O}(m ^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6}\lambda^{-1/6})\) by Lemma G.6 and \(\|\bm{\theta}_{i,t-1}-\widetilde{\bm{\theta}}_{i,t-1}\|_{2}\leq\mathcal{O}( \sqrt{t/(m\lambda)})\) as shown in Lemma G.3. Next, as we already have \(\|\bm{\theta}-\widetilde{\bm{\theta}}_{i,t-1}\|_{\widetilde{\bm{\Sigma}}_{i,t- 1}}\leq\widetilde{\gamma}_{i,t-1}/\sqrt{m}\), we then proceed to transform the objective to

\[\|\bm{\theta}^{*}- \bm{\theta}_{i,t-1}\|_{\widetilde{\bm{\Sigma}}_{i,t-1}}\leq\|\bm {\theta}^{*}-\widetilde{\bm{\theta}}_{i,t-1}\|_{\bm{\Sigma}_{i,t-1}}+\| \widetilde{\bm{\theta}}_{i,t-1}-\bm{\theta}_{i,t-1}\|_{\bm{\Sigma}_{i,t-1}}\] \[\leq\|\bm{\theta}^{*}-\widetilde{\bm{\theta}}_{i,t-1}\|_{\bm{ \Sigma}_{i,t-1}}+\|\widetilde{\bm{\theta}}_{i,t-1}-\bm{\theta}_{i,t-1}\|_{\bm{ \Sigma}_{i,t-1}}\] \[\leq\|\bm{\theta}^{*}-\widetilde{\bm{\theta}}_{i,t-1}\|_{\widetilde {\bm{\Sigma}}_{i,t-1}}+\|\bm{\theta}^{*}-\widetilde{\bm{\theta}}_{i,t-1}\|_{ \bm{\Sigma}_{i,t-1}-\widetilde{\bm{\Sigma}}_{i,t-1}}+\|\widetilde{\bm{\theta}} _{i,t-1}-\bm{\theta}_{i,t-1}\|_{\bm{\Sigma}_{i,t-1}}\] \[\leq\widetilde{\gamma}_{i,t-1}/\sqrt{m}+\|\widetilde{\bm{\theta}} _{i,t-1}-\bm{\theta}_{i,t-1}\|_{\bm{\Sigma}_{i,t-1}}+\mathcal{O}(\sqrt{t/(m \lambda)})\cdot\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6}\lambda^{-1/6})\] \[\leq\widetilde{\gamma}_{i,t-1}/\sqrt{m}+\|\widetilde{\bm{\theta}} _{i,t-1}-\bm{\theta}_{i,t-1}\|_{\bm{\Sigma}_{i,t-1}}+\mathcal{O}(m^{-2/3}\sqrt {\log(m)}L^{4}t^{13/6}\lambda^{-2/3}).\]

For the first term on the RHS, we can follow the proof flow in Lemma C.6, by applying Lemma G.4 to substitute \(\widetilde{\bm{\Sigma}}_{i,t-1}\) with corresponding \(\bm{\Sigma}_{i,t-1}\), which will consequently lead to \(|\gamma_{i,t-1}/\sqrt{m}-\widetilde{\gamma}_{i,t-1}/\sqrt{m}|\leq\nu\cdot \sqrt{1+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6}\lambda^{-7/6})}\cdot \mathcal{O}(m^{-7/12}\log^{1/4}(m)L^{2}t^{5/6}\lambda^{-1/12})\). Meanwhile, for the second term on the RHS, we first define the gradient-based regression parameters as

\[\bm{\Sigma}_{i,t-1}^{(0)} =\lambda\bm{\mathrm{I}}+\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g (\bm{x}_{\tau};\bm{\theta}_{0})\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})^{ \intercal}/m,\] \[\bm{b}_{i,t-1}^{(0)} =\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{0})\cdot r_{\tau}/\sqrt{m},\] \[\widetilde{\bm{b}}_{i,t-1}^{(0)} =\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{0})\cdot\widetilde{r}_{\tau}/\sqrt{m},\]

Then, we can proceed to have

\[\|\widetilde{\bm{\theta}}_{i,t-1} -\bm{\theta}_{i,t-1}\|_{\bm{\Sigma}_{i,t-1}}\] \[\leq\|\widetilde{\bm{\theta}}_{i,t-1}-\bm{\theta}_{0}-(\bm{\Sigma }_{i,t-1}^{(0)})^{-1}\bm{b}_{i,t-1}^{(0)}/\sqrt{m}+(\bm{\Sigma}_{i,t-1}^{(0)}) ^{-1}\bm{b}_{i,t-1}^{(0)}/\sqrt{m}+\bm{\theta}_{0}-\bm{\theta}_{i,t-1}\|_{\bm{ \Sigma}_{i,t-1}}\] \[\leq\|\bm{\theta}_{i,t-1}-\bm{\theta}_{0}-(\bm{\Sigma}_{i,t-1}^{(0 )})^{-1}\bm{b}_{i,t-1}^{(0)}/\sqrt{m}\|_{\bm{\Sigma}_{i,t-1}}+\|\widetilde{\bm{ \theta}}_{i,t-1}-\bm{\theta}_{0}-(\bm{\Sigma}_{i,t-1}^{(0)})^{-1}\bm{b}_{i,t-1} ^{(0)}/\sqrt{m}\|_{\bm{\Sigma}_{i,t-1}}\] \[\leq\|\bm{\theta}_{i,t-1}-\bm{\theta}_{0}-(\bm{\Sigma}_{i,t-1}^{(0 )})^{-1}\bm{b}_{i,t-1}^{(0)}/\sqrt{m}\|_{\bm{\Sigma}_{i,t-1}}+\|\widetilde{\bm{ \theta}}_{i,t-1}-\bm{\theta}_{0}-(\bm{\Sigma}_{i,t-1}^{(0)})^{-1}\widetilde{ \bm{b}}_{i,t-1}^{(0)}/\sqrt{m}\|_{\bm{\Sigma}_{i,t-1}}\] \[\qquad\qquad+m^{-1}\|(\bm{\Sigma}_{i,t-1}^{(0)})^{-1}\cdot(\sum_{ \tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c_{ \tau})\|_{\bm{\Sigma}_{i,t-1}}.\] (C.22)

**Bounding the first two term in Inequality C.22.** Here, for the first term on the RHS, we can individually apply Lemma D.1, by considering the auxiliary sequence in \(j\)-th iteration (\(j\in[J]\)) with \(\bm{\Theta}^{(0)}=\bm{\theta}_{0}\), as

\[\bm{\Theta}^{(j+1)}=\bm{\Theta}^{(j)}-\eta\cdot\left[\bm{\mathrm{J}}^{(0)} \cdot\bm{\mathrm{W}}\cdot\left([\bm{\mathrm{J}}^{(0)}]^{\intercal}(\bm{ \Theta}^{(j)}-\bm{\theta}_{0})-\bm{y}\right)+m\lambda(\bm{\Theta}^{(j)}-\bm{ \theta}_{0})\right]\]

where the Jacobian matrix \(\bm{\mathrm{J}}^{(0)}:=\left(g(\bm{x}_{1};\bm{\theta}_{0}),g(\bm{x}_{2};\bm{ \theta}_{0}),\ldots,g(\bm{x}_{i,t-1};\bm{\theta}_{0})\right)\in\mathbb{R}^{p \times(t-1)}\), vector \(\bm{y}\in\mathbb{R}^{t-1}\) contains the received arm rewards \(r_{\tau},\tau\in[t-1]\), and matrix \(\bm{\mathrm{W}}\in\mathbb{R}^{(t-1)\times(t-1)}

diagonal matrix that contains sample weights \(w_{i,t}^{(\tau)}\), \(\tau\in[t-1]\). In particular, we have its norm \(\|\mathbf{W}\|_{2}\leq 1\) by definition. Here, with \([\mathbf{J}^{(0)}]_{\tau}\) being the \(\tau\)-th column of matrix \(\mathbf{J}^{(0)}\), the above sequence is expected to solve the following problem

\[\min_{\boldsymbol{\Theta}}\mathcal{L}(\boldsymbol{\Theta})=\sum_{\tau\in[t-1]} \frac{w_{i,t}^{(\tau)}}{2}\cdot\bigg{\|}[\mathbf{J}^{(0)}]_{\tau}^{\intercal} (\boldsymbol{\Theta}-\boldsymbol{\theta}_{0})-r_{\tau}\bigg{\|}_{2}^{2}+\frac{ 1}{2}\cdot m\lambda\cdot\bigg{\|}\boldsymbol{\Theta}-\boldsymbol{\theta}_{0} \bigg{\|}_{2}^{2}.\]

As a result, following an analogous approach as in Lemma C.4 in [86], we can have \(\|\boldsymbol{\Theta}^{(j)}-\boldsymbol{\theta}_{0}-(\boldsymbol{\Sigma}_{i,t -1}^{(0)})^{-1}\boldsymbol{b}_{i,t-1}^{(0)}/\sqrt{m}\|_{\boldsymbol{\Sigma}_{ i,t-1}}\leq(1-\eta m\lambda)^{j/2}\sqrt{t/(m\lambda)}.\) Furthermore, by applying the conclusion of Lemma D.1, we can have

\[\|\boldsymbol{\theta}_{i,t-1}-\boldsymbol{\theta}_{0}- (\boldsymbol{\Sigma}_{i,t-1}^{(0)})^{-1}\boldsymbol{b}_{i,t-1}^{(0 )}/\sqrt{m}\|_{2}\] \[\leq(1-\eta m\lambda)^{J/2}\sqrt{t/(m\lambda)}+\mathcal{O}(m^{-2 /3}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda})).\]

Similarly, for the second term in Inequality C.22, we also can apply a comparable approach by solving the problem:

\[\min_{\boldsymbol{\Theta}}\mathcal{L}(\boldsymbol{\Theta})=\sum_{\tau\in[t-1] }\frac{w_{i,t}^{(\tau)}}{2}\bigg{\|}[\mathbf{J}^{(0)}]_{\tau}^{\intercal}( \boldsymbol{\Theta}-\boldsymbol{\theta}_{0})-\widetilde{r}_{\tau}\bigg{\|}_{ 2}^{2}+\frac{1}{2}m\lambda\cdot\bigg{\|}\boldsymbol{\Theta}-\boldsymbol{\theta }_{0}\bigg{\|}_{2}^{2},\]

and constructing the corresponding auxiliary sequence. This will lead to a similar bound for the second term on the RHS of inequality C.22, such that \(\|\widetilde{\boldsymbol{\theta}}_{i,t-1}-\boldsymbol{\theta}_{0}-( \boldsymbol{\Sigma}_{i,t-1}^{(0)})^{-1}\widetilde{\boldsymbol{\mathcal{B}}}_{ i,t-1}^{(0)}/\sqrt{m}\|_{2}\leq(1-\eta m\lambda)^{J/2}\sqrt{t/(m\lambda)}+\mathcal{O}(m^{-2 /3}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda})).\)

**Bounding the third term in Inequality C.22.** Then, for the third term on the RHS, we first have

\[m^{-1}\cdot\|(\boldsymbol{\Sigma}_{i,t-1}^{(0)})^{-1}\cdot(\sum _{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\boldsymbol{x}_{\tau};\boldsymbol{ \theta}_{0})\cdot c_{\tau})\|_{\boldsymbol{\Sigma}_{i,t-1}}\] \[\leq m^{-1}\|(\boldsymbol{\Sigma}_{i,t-1})^{-1}(\sum_{\tau\in[t-1 ]}w_{i,t}^{(\tau)}\cdot g(\boldsymbol{x}_{\tau};\boldsymbol{\theta}_{0}) \cdot c_{\tau})\|_{\boldsymbol{\Sigma}_{i,t-1}}\] \[\qquad+m^{-1}\|\big{(}(\boldsymbol{\Sigma}_{i,t-1})^{-1}-( \boldsymbol{\Sigma}_{i,t-1}^{(0)})^{-1}\big{)}\cdot(\sum_{\tau\in[t-1]}w_{i,t }^{(\tau)}\cdot g(\boldsymbol{x}_{\tau};\boldsymbol{\theta}_{0})\cdot c_{\tau })\|_{\boldsymbol{\Sigma}_{i,t-1}}\] \[\leq m^{-1}\|(\boldsymbol{\Sigma}_{i,t-1})^{-1}(\sum_{\tau\in[t-1 ]}w_{i,t}^{(\tau)}\cdot g(\boldsymbol{x}_{\tau};\boldsymbol{\theta}_{0})\cdot c _{\tau})\|_{\boldsymbol{\Sigma}_{i,t-1}}\] \[\qquad+m^{-1}\|(\boldsymbol{\Sigma}_{i,t-1})^{-1}\big{(}\sum_{ \tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\boldsymbol{x}_{\tau};\boldsymbol{ \theta}_{0})\cdot c_{\tau})\|_{\boldsymbol{\Sigma}_{i,t-1}}-(\sum_{\tau\in[t- 1]}w_{i,t}^{(\tau)}\cdot g(\boldsymbol{x}_{\tau};\boldsymbol{\theta}_{0})\cdot c _{\tau})\|_{\boldsymbol{\Sigma}_{i,t-1}}\] \[\leq m^{-1}\|(\boldsymbol{\Sigma}_{i,t-1})^{-1}(\sum_{\tau\in[t- 1]}w_{i,t}^{(\tau)}\cdot g(\boldsymbol{x}_{\tau};\boldsymbol{\theta}_{0})\cdot c _{\tau})\|_{\boldsymbol{\Sigma}_{i,t-1}}+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^ {7/6}\lambda^{-13/6}L^{9/2})\] \[\leq m^{-1}\|(\boldsymbol{\Sigma}_{i,t-1})^{-1}(\sum_{\tau\in[t- 1]}w_{i,t}^{(\tau)}\cdot g(\boldsymbol{x}_{\tau};\boldsymbol{\theta}_{\tau-1} )\cdot c_{\tau})\|_{\boldsymbol{\Sigma}_{i,t-1}}+\mathcal{O}(Cm^{-2/3}\sqrt{ \log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\] \[\qquad+m^{-1}\|(\boldsymbol{\Sigma}_{i,t-1})^{-1}(\sum_{\tau\in[t- 1]}w_{i,t}^{(\tau)}\cdot(g(\boldsymbol{x}_{\tau};\boldsymbol{\theta}_{\tau-1} )-g(\boldsymbol{x}_{\tau};\boldsymbol{\theta}_{0}))\cdot c_{\tau})\|_{ \boldsymbol{\Sigma}_{i,t-1}}\] \[\leq m^{-1}\|(\boldsymbol{\Sigma}_{i,t-1})^{-1}(\sum_{\tau\in[t- 1]}w_{i,t}^{(\tau)}\cdot g(\boldsymbol{x}_{\tau};\boldsymbol{\theta}_{\tau-1} )\cdot c_{\tau})\|_{\boldsymbol{\Sigma}_{i,t-1}}+\mathcal{O}(Cm^{-7/6}\sqrt{ \log(m)}t^{1/6}\lambda^{-7/6}L^{7/2})\] \[\qquad+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L ^{9/2}),\]

where the third inequality is due to Lemma G.6, and the last inequality is due to Lemma G.4. Then, recall that the weight \(w_{i,t}^{(\tau)}\) from (4) for each previously chosen arm \(\boldsymbol{x}_{\tau}\). In this case, we can further have

\[m^{-1/2}\|(\bm{\Sigma}_{i,t-1})^{-1} (\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{\tau-1})\cdot c_{\tau})/\sqrt{m}\|_{\bm{\Sigma}_{i,t-1}}\] \[=m^{-1/2}\|\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau };\bm{\theta}_{\tau-1})\cdot c_{\tau}/\sqrt{m}\|_{(\bm{\Sigma}_{i,t-1})^{-1}}\] \[\leq m^{-1/2}\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}c_{\tau}\cdot\|g( \bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\|_{(\bm{\Sigma}_{i,t-1})^{-1}}\]

where the first inequality is by applying the triangular inequality. By definition, we naturally have \(\bm{\Sigma}_{i,t-1}\succeq\bar{\bm{\Sigma}}_{\tau-1}^{(\kappa)},\forall\tau \in[t-1]\). Next, we utilize Lemmas G.8 and the fact that \(w_{t}^{\mathsf{min}}=\min\{w_{i,t}^{(\tau)}\}_{i\in[K],\tau\in[t-1]}=\kappa^{ 2}<1,\;\forall t\in[T]\) by scaling the parameter \(\alpha\), which will lead to

\[m^{-1/2}\|(\bm{\Sigma}_{i,t-1})^{-1} (\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{\tau-1})\cdot c_{\tau})/\sqrt{m}\|_{\bm{\Sigma}_{i,t-1}}\] \[\leq\mathcal{O}(m^{-1/2})\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}c_{ \tau}\cdot\|g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\|_{(\bm{\bar{\bm{ \Sigma}}}_{i,t-1})^{-1}}\] \[\leq\mathcal{O}(m^{-1/2})\sum_{\tau\in[t-1]}w_{i,t}^{(\tau)}c_{ \tau}\cdot\|g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\|_{(\bm{\bar{\bm{ \Sigma}}}_{\tau-1}^{(\kappa)})^{-1}}\] \[\leq\mathcal{O}(m^{-1/2})\sum_{\tau\in[t-1]}c_{\tau}\cdot\frac{ \alpha\cdot\min\limits_{\bm{x}\in\mathcal{X}_{t}}\|g(\bm{x};\bm{\theta}_{i,t- 1})/\sqrt{m}\|_{\bm{\bar{\bm{\Sigma}}}_{t-1}^{-1}}^{2}}{\|g(\bm{x}_{i,t};\bm{ \theta}_{i,t-1})/\sqrt{m}\|_{(\bm{\bar{\bm{\Sigma}}}_{t-1}^{(\kappa)})^{-1}}}\] \[\leq\mathcal{O}(m^{-1/2})\cdot C\cdot\frac{\alpha\cdot\min \limits_{\bm{x}\in\mathcal{X}_{t}}\|g(\bm{x};\bm{\theta}_{i,t-1})/\sqrt{m}\|_{ \bm{\bar{\bm{\Sigma}}}_{t-1}^{-1}}^{2}}{\|g(\bm{x}_{i,t};\bm{\theta}_{i,t-1})/ \sqrt{m}\|_{(\bm{\bar{\bm{\Sigma}}}_{t-1}^{(\kappa)})^{-1}}},\]

where the third and the last inequalities are due to the definition of \(w_{i,t}^{(\tau)}\) and the definition of corruption level \(C\). Finally, summing up all the results will give the lemma.

### Discussion on the Minimum Fraction Value \(\beta\)

In this subsection, we provide an exemplary upper bound of \(\mathcal{O}(1/\beta)\). Inspired by [84], the following analysis is based on a scenario where the arm contexts nearly lie within a low-dimensional subspace of the RKHS, induced by the NTK defined in Definition 5.2. To begin, we recall that, as defined in (4), each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) is associated with the corresponding arm weight:

\[w_{i,t}^{(\tau)}=\min\left\{1,\frac{\alpha\cdot\min_{\bm{x}\in\mathcal{X}_{t} }\|g(\bm{x};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\bar{\Sigma}}_{t-1}^{-1}}^{2}} {g_{\tau}\cdot\|g(\bm{x}_{i,t};\bm{\theta}_{t-1})/\sqrt{m}\|_{(\bm{\bar{\bm{ \Sigma}}}_{t-1}^{(\kappa)})^{-1}}}\right\}=\min\big{\{}1,\alpha\cdot\mathsf{ frac}_{\tau}(\bm{x}_{i,t};\mathcal{X}_{t},\bar{\bm{\Sigma}}_{t-1})\big{\}},\]

where \(\alpha>0\) is a tunable scaling parameter to control the arm weight value range, and \(\mathsf{frac}(\cdot)\) is a shorthand for the fraction term. We denote the data-dependent minimum fraction value as \(\beta=\min_{t\in[T],\tau\in[t-1]}\left[\min\big{\{}\mathsf{frac}(\bm{x}_{t}; \mathcal{X}_{t},\bar{\bm{\Sigma}}_{t-1}),\mathsf{frac}(\bm{\Xi}_{t};\mathcal{ X}_{t},\bar{\bm{\Sigma}}_{t-1})\big{\}}\right]\). In this case, the lower bound for \(\mathsf{frac}(\bm{x}_{t};\mathcal{X}_{t},\bar{\bm{\Sigma}}_{t-1})\), represented by \(\beta\), can be expressed as

\[\frac{\min_{\bm{x}\in\mathcal{X}_{t}}\|g(\bm{x};\bm{\theta}_{t-1} )/\sqrt{m}\|_{\bm{\bar{\Sigma}}_{t-1}^{-1}}^{2}}{\|g(\bm{x}_{\tau};\bm{\theta}_ {\tau-1})/\sqrt{m}\|_{(\bm{\bar{\Sigma}}_{\tau-1}^{(\kappa)})^{-1}}\cdot\|g( \bm{x}_{i,t};\bm{\theta}_{t-1})/\sqrt{m}\|_{(\bm{\bar{\Sigma}}_{t-1}^{(\kappa)} )^{-1}}} \geq\frac{\min_{\bm{x}\in\mathcal{X}_{t}}\|g(\bm{x};\bm{\theta}_{t-1} )/\sqrt{m}\|_{\bm{\bar{\Sigma}}_{t-1}^{-1}}^{2}}{\mathcal{O}(L\cdot\lambda^{-1})}\] \[\geq\frac{\min_{\bm{x}\in\mathcal{X}_{t}}\|g(\bm{x};\bm{\theta}_{t -1})/\sqrt{m}\|_{2}^{2}\cdot\lambda_{\mathsf{min}}(\bar{\bm{\Sigma}}_{t-1}^{-1})}{ \mathcal{O}(L\cdot\lambda^{-1})}\]

where the first inequality is because of Lemma G.2 and Lemma G.6. The second inequality is by applying Rayleigh-Ritz theorem.

Then, we let \(\tilde{\mathcal{P}}_{t-1}\subseteq\mathcal{P}_{t-1}\) being the collection of received records that only consists of unique chosen arms from \(\mathcal{P}_{t-1}\). With \(\tilde{\bm{\theta}}_{t-1}\) be the parameters trained on \(\tilde{\mathcal{P}}_{t-1}\), applying Lemma G.4 and Lemma G.3, we have \(\|g(\bm{x}^{\prime};\bm{\theta}_{t-1})/\sqrt{m}-g(\bm{x}^{\prime};\tilde{\bm{ \theta}}_{t-1})/\sqrt{m}\|_{2}\leq\mathcal{O}(m^{-1/6}\lambda^{-1/6}t^{1/6}L ^{7/2}\log(m))\), where \(\bm{x}^{\prime}=\arg\min_{\bm{x}\in\mathcal{X}_{t}}\|g(\bm{x};\bm{\theta}_{t-1} )/\sqrt{m}\|_{2}\). Given the over-parameterization settings in Theorem 5.6 with sufficiently large \(m\), we can have \(\|g(\bm{x}^{\prime};\bm{\theta}_{t-1})/\sqrt{m}-g(\bm{x}^{\prime};\tilde{\bm{ \theta}}_{t-1})/\sqrt{m}\|_{2}\ll\mathcal{O}(1)\). As a result, it leads to

\[\frac{\min_{\bm{x}\in\mathcal{X}_{t}}\|g(\bm{x};\bm{\theta}_{t-1} )/\sqrt{m}\|_{\tilde{\bm{\Sigma}}_{t-1}^{-1}}^{2}}{\|g(\bm{x}_{\tau};\bm{ \theta}_{\tau-1})/\sqrt{m}\|_{(\tilde{\bm{\Sigma}}_{\tau-1}^{(\kappa)})^{-1}} \cdot\|g(\bm{x}_{i,t};\bm{\theta}_{t-1})/\sqrt{m}\|_{(\tilde{\bm{\Sigma}}_{t-1 }^{(\kappa)})^{-1}}}\geq\frac{\min_{\bm{x}\in\mathcal{X}_{i}}\|g(\bm{x};\bm{ \theta}_{t-1})/\sqrt{m}\|_{2}^{2}\cdot\lambda_{\textsf{min}}(\bar{\bm{\Sigma}} _{t-1}^{-1})}{\mathcal{O}(L\cdot\lambda^{-1})}\] \[\qquad\qquad\geq\frac{\big{(}\|g(\bm{x}^{\prime};\bm{\theta}_{t-1 })/\sqrt{m}\|_{2}^{2}+\|g(\bm{x}^{\prime};\bm{\theta}_{t-1})/\sqrt{m}\|_{2}^{2 }-\|g(\bm{x}^{\prime};\tilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{2}^{2}\big{)} \cdot\lambda_{\textsf{min}}(\bar{\bm{\Sigma}}_{t-1}^{-1})}{\mathcal{O}(L\cdot \lambda^{-1})}\] \[\qquad\qquad\geq\frac{\mathcal{O}(1)\cdot\lambda_{\textsf{min}}( \bar{\bm{\Sigma}}_{t-1}^{-1})}{\mathcal{O}(L\cdot\lambda^{-1})}\]

where the second inequality is derived based on \(\|g(\bm{x}^{\prime};\bm{\theta}_{t-1})/\sqrt{m}\|_{2}^{2}-\|g(\bm{x}^{\prime}; \tilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{2}^{2}\geq-1\cdot(\|g(\bm{x}^{\prime}; \bm{\theta}_{t-1})/\sqrt{m}-g(\bm{x}^{\prime};\tilde{\bm{\theta}}_{t-1})/\sqrt {m}\|_{2}\cdot\|g(\bm{x}^{\prime};\bm{\theta}_{t-1})/\sqrt{m}+g(\bm{x}^{\prime} ;\tilde{\bm{\theta}}_{t-1})/\sqrt{m}\|_{2})\), and we bound the two multipliers separately with choice of \(m\). The last inequality is by applying Theorem 3 of [3] with the fact that \(f(\cdot;\bm{\theta}_{t-1})=\mathcal{O}(1)\) (Lemma B.2 in [21]).

Afterwards, regarding the lower bound of \(\lambda_{\textsf{min}}(\bar{\bm{\Sigma}}_{t-1}^{-1})\), since \(\lambda_{\textsf{min}}(\bar{\bm{\Sigma}}_{t-1}^{-1})=\frac{1}{\lambda_{\textsf{ max}}(\bar{\bm{\Sigma}}_{t-1})}\), we need to find the upper bound for \(\|\bar{\bm{\Sigma}}_{t-1}\|_{2}\). Denoting \(\mathbf{G}_{t-1}^{(0)}=[g(\bm{x}_{1};\bm{\Theta}_{0}),g(\bm{x}_{2};\bm{\Theta} _{0}),\ldots,g(\bm{x}_{t-1};\bm{\Theta}_{0})]^{\intercal}\in\mathbb{R}^{(t-1) \times p}\) as the gradient matrix, as well as \(\mathbf{H}_{t-1}\in\mathbb{R}^{(t-1)\times(t-1)}\) as the NTK matrix constructed from the chosen arms \(\{\bm{x}_{\tau}\}_{\tau\in[t-1]}\), with sufficient network width \(m\) (Theorem 5.6), we first have

\[\|\mathbf{G}_{t-1}^{(0)}(\mathbf{G}_{t-1}^{(0)})^{\intercal}/m-\mathbf{H}_{t-1 }\|_{2}\leq\mathcal{O}(1)\]

and this inequality is because of Lemma B.1 in [86] by setting \(\epsilon=t-1\). In this case, we will have

\[\|\bar{\bm{\Sigma}}_{t-1}\|_{2}-\lambda_{\textsf{max}}(\mathbf{H}_{t-1}) \leq\|\bar{\bm{\Sigma}}_{t-1}\|_{2}-\|(\mathbf{G}_{t-1}^{(0)})^{ \intercal}\mathbf{G}_{t-1}^{(0)}/m\|_{2}+\|\mathbf{G}_{t-1}^{(0)}(\mathbf{G}_{t- 1}^{(0)})^{\intercal}/m\|_{2}-\lambda_{\textsf{max}}(\mathbf{H}_{t-1})\] \[\leq\|\bar{\bm{\Sigma}}_{t-1}-(\mathbf{G}_{t-1}^{(0)})^{\intercal} \mathbf{G}_{t-1}^{(0)}/m\|_{2}+\|\mathbf{G}_{t-1}^{(0)}(\mathbf{G}_{t-1}^{(0)})^ {\intercal}/m-\mathbf{H}_{t-1}\|_{2}\] \[\leq\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6}\lambda^{-1/6})+ \mathcal{O}(\lambda)+\mathcal{O}(1)\]

where the last inequality is by applying Lemma G.6. This leads to the result that \(\|\bar{\bm{\Sigma}}_{t-1}\|_{2}\leq\lambda_{\textsf{max}}(\mathbf{H}_{t-1})+ \mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6}\lambda^{-1/6})+\mathcal{O}( \lambda)+\mathcal{O}(1)\).

Then, inspired by Section D in [84], based on the formulation from [14] and [20], we can consider that each entry of \(\mathbf{H}_{t-1}\) is generated by

\[[\mathbf{H}_{t-1}]_{i,i^{\prime}}=\sum_{k=0}^{\infty}\mu_{k}\sum_{j=1}^{N(d,k)}Y_{ k,j}(\bm{x}_{i})Y_{k,j}(\bm{x}_{i^{\prime}}),\]

where \(Y_{k,j}\) are linearly independent spherical harmonics, w.r.t. degree \(k\) and \(d\) variables. \(N(d,k)=\frac{2k+d-2}{k}\cdot C_{k+d-3}^{d-2},\mu_{k}=\Theta(\max\{k^{-d},(d-1)^{ 1-k}\})\). With the above feature mapping, if we have a subspace of the RKHS, such that the feature mapping in the RKHS is close enough to its projection onto this subspace, we can have \(\lambda_{\textsf{max}}(\mathbf{H}_{t-1})=\|\mathbf{H}_{t-1}\|_{2}\leq\mathcal{O}(1)\). As a result, summing up the results and with sufficiently large \(m\), we can have \(\frac{1}{\beta}\leq\mathcal{O}(L\lambda^{-1})\).

## Appendix D Bounding the Difference of Trained Parameters and Regression Parameters

In section, with weighted Gradient Descent, we provide the upper bound in terms of the distance between GD trained parameters \(\bm{\theta}_{t-1}\) and the regression parameters \((\bm{\Sigma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0)}\). The results will be applied to the proof flow of both NeuralUCB-WGD and R-NeuralUCB. First, with the definitionsin Subsec. C.2, we have the gradient-based regression parameters specified to arm \(\bm{x}_{t}\in\mathcal{X}_{t}\) as

\[\bm{\Sigma}_{t-1}^{(0)} =\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{t}^{(\tau)}g(\bm{x}_{\tau}; \bm{\theta}_{0})g(\bm{x}_{\tau};\bm{\theta}_{0})^{\intercal}/m,\] \[\bm{\Sigma}_{t-1} =\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{t}^{(\tau)}g(\bm{x}_{\tau };\bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m,\] \[\bm{b}_{t-1}^{(0)} =\sum_{\tau\in[t-1]}w_{t}^{(\tau)}g(\bm{x}_{\tau};\bm{\theta}_{0} )\cdot r_{\tau}/\sqrt{m}, \bm{b}_{t-1}=\sum_{\tau\in[t-1]}w_{t}^{(\tau)}g(\bm{x}_{\tau};\bm{ \theta}_{\tau-1})\cdot r_{\tau}/\sqrt{m}\]

where \(\{\bm{x}_{\tau},r_{\tau}\},\tau\in[t]\) respectively stands for the chosen arms as well as their rewards. For notation simplicity, we also use \(w_{t}^{(\tau)},\tau\in[t-1]\) to denote the arm weights for the chosen arm \(\bm{x}_{t}\) respectively.

Analogously, given an candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) with arm weight \(w_{i,t}^{(\tau)}\) defined in (4), we have a series auxiliary gradient sequences \(\{\bm{\Theta}^{(0)},\bm{\Theta}^{(1)},\ldots,\bm{\Theta}^{(J)}\}\) as in G.3, such that for \(j\)-th iteration

\[\bm{\Theta}^{(j+1)}=\bm{\Theta}^{(j)}-\eta\cdot\left[\mathbf{J}^{(0)}\cdot \mathbf{W}\cdot\left([\mathbf{J}^{(0)}]^{\intercal}(\bm{\Theta}^{(j)}-\bm{ \theta}_{0})-\bm{y}\right)+m\lambda(\bm{\Theta}^{(j)}-\bm{\theta}_{0})\right]\]

where \(\mathbf{J}^{(0)}:=\left(g(\bm{x}_{1};\bm{\theta}_{0}),g(\bm{x}_{2};\bm{\theta} _{0}),\ldots,g(\bm{x}_{t-1};\bm{\theta}_{0})\right)\in\mathbb{R}^{p\times(t-1)}\), and \(\mathbf{W}\) refers to the diagonal matrix of arm weights \(\{w_{i,t}^{(\tau)}\}_{\tau\in[t-1]}\), along with the reward vectors \(\bm{y}\in\mathbb{R}^{t-1}\) separately being the vector of received rewards and corruption-free rewards. In particular, the auxiliary sequence \(\bm{\Theta}^{(j)}\) can be deemed as applying Gradient Descent to solve the following optimization problem

\[\min_{\bm{\Theta}}\mathcal{L}(\bm{\Theta})=\sum_{\tau\in[t-1]}\frac{1}{2}\cdot w _{i,t}^{(\tau)}\cdot\left\|[\mathbf{J}^{(0)}]_{\tau}^{\intercal}(\bm{\Theta}- \bm{\theta}_{0})-y_{\tau}\right\|_{2}^{2}+\frac{1}{2}\cdot m\lambda\cdot\left\| \bm{\Theta}-\bm{\theta}_{0}\right\|_{2}^{2}\]

where \([\mathbf{J}^{(0)}]_{\tau}\) refers to the \(\tau\)-th column of the matrix \(\mathbf{J}^{(0)}\). Analogously, we can also derive the optimization problem for the sequence of corruption-free auxiliary parameters \(\widetilde{\bm{\Theta}}^{(j)}\), by applying the same definition of weight matrix \(\mathbf{W}\). By the definition of arm weights, we will also have \(\|\mathbf{W}\|_{2}\leq 1\).

**Lemma D.1** (Lemma B.2 of [86]).: _With the notation and conditions in Theorem 5.6, consider \(m\geq\Omega(\text{poly}(T,L,\tilde{\lambda}_{0}^{-1},\lambda^{-1})\) and \(\eta\leq\mathcal{O}(\frac{1}{m\lambda+tmL})\). For round \(t\in[T]\), we have_

\[\|\bm{\theta}_{t-1}-\bm{\theta}_{0}-(\bm{\Sigma}_{t-1}^{(0)})^{-1 }\bm{b}_{t-1}^{(0)}\|_{2}\] \[\leq(1-\eta m\lambda)^{J/2}\sqrt{t/(m\lambda)}+\mathcal{O}(m^{-2/ 3}t^{5/3}\sqrt{\log(m)}L^{7/2}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\]

_with the \(J\) iterations of Gradient Descent process._

**Proof.** The proof of this lemma follows an analogous approach as in Lemma B.2 of [86]. Here, similar to the previous sequence \(\{\bm{\Theta}^{(0)},\bm{\Theta}^{(1)},\ldots,\bm{\Theta}^{(J)}\}\), we denote another set of auxiliary sequences to simulate the \(J\) iterations of GD, by

\[\bm{\theta}^{(j+1)}=\bm{\theta}^{(j)}-\eta\cdot\left[\mathbf{J}^{(j)}\cdot \mathbf{W}\cdot\left(\bm{f}^{(j)}-\bm{y}\right)+m\lambda(\bm{\theta}^{(j)}- \bm{\theta}_{0})\right]\]

where we denote the corresponding gradient matrix at the \(j\)-th iteration as \(\mathbf{J}^{(j)}=\left(g(\bm{x}_{1};\bm{\theta}^{(j)}),g(\bm{x}_{2};\bm{\theta} ^{(j)}),\ldots,g(\bm{x}_{t-1};\bm{\theta}^{(j)})\right)\in\mathbb{R}^{p\times (t-1)}\), as well as the vector of network outputs \(\bm{f}^{(j)}=\left(f(\bm{x}_{1};\bm{\theta}^{(j)}),f(\bm{x}_{2};\bm{\theta} ^{(j)}),\ldots,f(\bm{x}_{t-1};\bm{\theta}^{(j)})\right)\in\mathbb{R}^{t-1}\). In this case, we can have the difference between parameter sequences as

\[\|\bm{\theta}^{(j+1)}-\bm{\Theta}^{(j+1)}\|\] \[=\|(1-\eta m\lambda)\cdot(\bm{\theta}^{(j)}-\bm{\Theta}^{(j)})- \eta\mathbf{W}(\mathbf{J}^{(j)}-\mathbf{J}^{(0)})(\bm{f}^{(j)}-\bm{y})-\eta \mathbf{W}(\bm{f}^{(j)}-[\mathbf{J}^{(0)}]^{\intercal}(\bm{\Theta}^{(j)}-\bm {\theta}_{0}))\|\] \[\leq\|(1-\eta m\lambda)\cdot(\bm{\theta}^{(j)}-\bm{\Theta}^{(j)}) \|+\eta\|\mathbf{W}(\mathbf{J}^{(j)}-\mathbf{J}^{(0)})(\bm{f}^{(j)}-\bm{y})\|+ \eta\|\mathbf{J}^{(0)}\mathbf{W}(\bm{f}^{(j)}-[\mathbf{J}^{(0)}]^{\intercal}( \bm{\Theta}^{(j)}-\bm{\theta}_{0}))\|\] \[\leq\underbrace{\|(1-\eta m\lambda)\cdot(\bm{\theta}^{(j)}-\bm{ \Theta}^{(j)})\|}_{I_{4}}+\underbrace{\eta\cdot\|(\mathbf{J}^{(j)}-\mathbf{J}^{( 0)})(\bm{f}^{(j)}-\bm{y})\|}_{I_{5}}+\underbrace{\eta\cdot\|\mathbf{J}^{(0)} \|\|\bm{f}^{(j)}-[\mathbf{J}^{(0)}]^{\intercal}(\bm{\Theta}^{(j)}-\bm{ \theta}_{0})\|}_{I_{6}}\]where the first inequality is by applying the triangular inequality. The second inequality is by using Cauchy-Schwartz inequality, and the third inequality is due to the fact that \(\|\mathbf{W}\|_{2}\leq 1\). Here, the first term \(I_{4}\) can be bounded recursively. For the second term \(I_{5}\) on the RHS, we have

\[I_{5}=\eta\|(\mathbf{J}^{(j)}-\mathbf{J}^{(0)})(\boldsymbol{f}^{(j)}- \boldsymbol{y})\|\leq\eta\|(\mathbf{J}^{(j)}-\mathbf{J}^{(0)})\|\|(\boldsymbol {f}^{(j)}-\boldsymbol{y})\|\leq\mathcal{O}(\eta t^{7/6}m^{1/3}\sqrt{\log(m)}L ^{7/2}\lambda^{-1/6})\]

by extending Lemma G.4 to the matrix \(\mathbf{J}\). Since we have the arm weights \(w_{i,t}^{(\tau)}\leq\mathcal{O}(1)\) due to the maximum cap as well as the choice of parameter \(\alpha\), we can also directly apply the conclusion of Lemma C.3 in [86] for the second inequality. Meanwhile, for the third term \(I_{6}\), we will have

\[I_{6} =\eta\cdot\|\mathbf{J}^{(0)}\|\|\boldsymbol{f}^{(j)}-[\mathbf{J} ^{(0)}]^{\intercal}(\boldsymbol{\Theta}^{(j)}-\boldsymbol{\theta}_{0})\|\] \[\leq\eta\cdot\|\mathbf{J}^{(0)}\|\cdot\max_{\tau\in[t-1]}\sqrt{t} \cdot|f(\boldsymbol{x}_{\tau};\boldsymbol{\theta}^{j})-f(\boldsymbol{x}_{ \tau};\boldsymbol{\theta}_{0})-\langle g(\boldsymbol{x}_{\tau};\boldsymbol{ \theta}_{0}),\boldsymbol{\theta}^{j}-\boldsymbol{\theta}_{0}\rangle|\] \[\leq\mathcal{O}(\eta t^{5/3}m^{1/3}\sqrt{\log(m)}L^{7/2}\lambda^ {-2/3})\]

by extending Lemma G.2 to the gradient matrix setting, as well as applying the Lemma G.5 on the absolute value. Afterwards, we can integrate these three terms, which will lead to

\[\|\boldsymbol{\theta}^{(j+1)}-\boldsymbol{\Theta}^{(j+1)}\|\leq\| (1-\eta m\lambda)\cdot(\boldsymbol{\theta}^{(j)}-\boldsymbol{\Theta}^{(j)})\|\] \[\qquad\qquad\qquad+\mathcal{O}(\eta t^{7/6}m^{1/3}\sqrt{\log(m) }L^{7/2}\lambda^{-1/6})+\mathcal{O}(\eta t^{5/3}m^{1/3}\sqrt{\log(m)}L^{7/2} \lambda^{-2/3})\] \[\leq(1-\eta m\lambda)\|\boldsymbol{\theta}^{(j)}-\boldsymbol{ \Theta}^{(j)}\|+\mathcal{O}(\eta t^{7/6}m^{1/3}\sqrt{\log(m)}L^{7/2}\lambda^{- 1/6})+\mathcal{O}(\eta t^{5/3}m^{1/3}\sqrt{\log(m)}L^{7/2}\lambda^{-2/3})\] \[\leq\mathcal{O}(m^{-2/3}t^{5/3}\sqrt{\log(m)}L^{7/2}\lambda^{-5/3 }(1+\sqrt{t/\lambda}))\]

where for term \(I_{4}\), the last inequality is obtained by recursively applying the process to \(\|\boldsymbol{\theta}^{(0)}-\boldsymbol{\Theta}^{(0)}\|=0\) and substituting the chosen upper bound for the learning rate \(\eta\). Then, with a sufficiently large network width \(m\) as indicated in the lemma, we have

\[\|\boldsymbol{\theta}_{t-1} -\boldsymbol{\theta}_{0}-(\boldsymbol{\Sigma}_{t-1}^{(0)})^{-1} \boldsymbol{b}_{t-1}^{(0)}\|_{2}\leq\|\boldsymbol{\theta}^{(j+1)}- \boldsymbol{\Theta}^{(j+1)}\|+\|\boldsymbol{\Theta}^{(j+1)}-\boldsymbol{ \theta}_{0}-(\boldsymbol{\Sigma}_{t-1}^{(0)})^{-1}\boldsymbol{b}_{t-1}^{(0)} \|_{2}\] \[\leq\|\boldsymbol{\Theta}^{(j+1)}-\boldsymbol{\theta}_{0}-( \boldsymbol{\Sigma}_{t-1}^{(0)})^{-1}\boldsymbol{b}_{t-1}^{(0)}\|_{2}+\mathcal{ O}(m^{-2/3}t^{5/3}\sqrt{\log(m)}L^{7/2}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\] \[\leq(1-\eta m\lambda)^{j/2}\sqrt{t/(m\lambda)}+\mathcal{O}(m^{-2 /3}t^{5/3}\sqrt{\log(m)}L^{7/2}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\]

where the first inequality is by applying triangular inequality, and the second inequality is by applying the previous conclusion. The last inequality is by applying Lemma C.4 in [86] with the fact that \(\|\boldsymbol{\theta}^{(j+1)}-\boldsymbol{\Theta}^{(j+1)}\|\leq\sqrt{t/(m \lambda)}\). Since we have the arm weights \(w_{i,t}^{(\tau)}\leq 1\) due to its maximum bound, we apply the conclusion of Lemma C.4 in [86] for the last inequality.

A Base Algorithm: NeuralUCB-WGD

Recall that for each candidate arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\), its corruption-free expected reward is generated by an unknown reward mapping function \(h(\cdot)\). Following existing neural bandit approaches, we use a neural network \(f(\cdot)\) to approximate \(h(\cdot)\) for estimating arm rewards. Consistent with the main text and R-NeuralUCB, we consider the network \(f(\cdot;\bm{\theta})\) to be a fully connected (FC) network with depth \(L\geq 2\) and width \(m\in\mathbb{N}^{+}\):

\[f(\bm{x};\bm{\theta}):=\sqrt{m}\bm{\theta}_{L}\sigma(\bm{\theta}_{L-1}\sigma( \bm{\theta}_{L-2}\ldots\sigma(\bm{\theta}_{1}\bm{x}))),\]

where \(\sigma(\cdot)\) denotes the ReLU activation function, and the trainable weight matrices are \(\bm{\theta}_{1}\in\mathbb{R}^{m\times d}\), \(\bm{\theta}_{l}\in\mathbb{R}^{m\times m}\) for \(2\leq l\leq L-1\), and \(\bm{\theta}_{L}\in\mathbb{R}^{1\times m}\). For simplicity, we also denote the vectorized parameters as

\[\bm{\theta}:=[\text{vec}(\bm{\theta}_{1})^{\intercal},\text{vec}(\bm{\theta} _{2})^{\intercal},\ldots,\text{vec}(\bm{\theta}_{L})]^{\intercal}\in\mathbb{ R}^{p},\]

with dimensionality \(p\) and randomly initialized parameters \(\bm{\theta}_{0}\). Similar to R-NeuralUCB, we also define \(g(\bm{x};\bm{\theta})=\text{vec}(\nabla\bm{\theta}f(\bm{x};\bm{\theta}))\in \mathbb{R}^{p}\) as the vectorized network gradients, for input \(\bm{x}\) and parameters \(\bm{\theta}\).

### NeuralUCB-WGD: Neural-UCB with Weighted GD

Then, we introduce the workflow of our base algorithm NeuralUCB-WGD (Algorithm 3), which stands for Neural-UCB with Weighted GD. Here, NeuralUCB-WGD can be considered as a simplified version of R-NeuralUCB, where all the candidate arms \(\mathcal{X}_{t}\) in round \(t\) will share the same neural network for decision making. The idea is that although we do not know which training samples are corrupted, we can reduce the effects caused by the potential corruption instead, by paying relatively more attention on the samples with low uncertainty for a stable training process.

```
1:Input: Time horizon \(T\). GD steps \(J\). Learning rate \(\eta\). Exploration coefficient \(\nu\geq 0\). Scaling coefficient \(\alpha>0\). Norm parameter \(S\), regularization parameter \(\lambda\).
2:Initialization: Initialized parameters \(\bm{\theta}_{0}\). Covariance matrix \(\bm{\Gamma}_{0}=\lambda\bm{\Gamma}\). Received records \(\mathcal{P}_{0}=\emptyset\).
3:for each round \(t\in[T]\)do
4: Observe candidate arms \(\mathcal{X}_{t}=\{\bm{x}_{i,t}\}_{i\in[K]}\).
5:for each arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\)do
6: Calculate its benefit score \(U(\bm{x}_{i,t})\), based on reward estimation \(f(\bm{x}_{i,t};\bm{\theta}_{i,t-1})\) and the UCB-type exploration score for arm \(\bm{x}_{i,t}\), (E.1).
7:endfor
8: Recommend arm based on benefit scores \(\bm{x}_{t}=\arg\max_{\bm{x}_{i,t}\in\mathcal{X}_{t}}\big{[}U(\bm{x}_{i,t}) \big{]}\).
9: Receive arm reward \(r_{t}\), and update the records, such that \(\mathcal{P}_{t}=\mathcal{P}_{t-1}\cup\big{\{}(\bm{x}_{t},r_{t})\big{\}}\). Then, save the corresponding weight for chosen arm \(\bm{x}_{t}\), as \(w_{t}=\min\{1,\alpha/\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\Gamma}_ {t-1}^{-1}}\}\).
10: Update the gradient covariance matrix \(\bm{\Gamma}_{t}=\bm{\Gamma}_{t-1}+w_{t}\cdot g(\bm{x}_{t};\bm{\theta}_{t-1}) \cdot g(\bm{x}_{t};\bm{\theta}_{t-1})^{\intercal}/m\).
11: Starting from random initialization \(\bm{\theta}_{0}\), update the network parameters to \(\bm{\theta}_{t}\), based on \(J\) iterations of Gradient Descent and training data \(\mathcal{P}_{t}\).
12:endfor ```

**Algorithm 3** Neural-UCB with Weighted GD (NeuralUCB-WGD)

Arm Selection.In each round \(t\in[T]\), after observing the candidate arms \(\mathcal{X}_{t}\) for selection, we calculate the reward estimation and the UCB score for arm selection (lines 5-7, Algorithm 3). Similar to R-NeuralUCB, in terms of the arm selection (line 8, Algorithm 3), we determine the chosen arm \(\bm{x}_{t}\in\mathcal{X}_{t}\) with the highest benefit score, by \(\bm{x}_{t}=\arg\max_{\bm{x}_{i,t}\in\mathcal{X}_{t}}\big{[}U(\bm{x}_{i,t}) \big{]}\). Here, with the NTK norm parameter \(S>0\) and the probability at least \(1-\delta\) given probability parameter \(\delta\in(0,1)\), we formulate the benefit score \(U(\bm{x}_{i,t})\), along with a UCB-type exploration strategy (motivated by Lemma F.1), as

\[U(\bm{x}_{i,t})=f(\bm{x}_{i,t};\bm{\theta}_{t-1})+\mathcal{O}\big{(}\nu\sqrt{ \log\frac{\det(\bm{\Gamma}_{t-1})}{\det(\lambda\bm{\mathrm{I}})}-2\log(\delta) }+\lambda^{1/2}S\big{)}\cdot\|g(\bm{x}_{i,t};\bm{\theta}_{t-1})/\sqrt{m}\|_{ \bm{\Gamma}_{t-1}^{-1}}\] (E.1)

where \(\bm{\theta}_{t-1}\) refer to network parameters in round \(t\) before GD, which have been trained with received records \(\mathcal{P}_{t-1}\), and \(\lambda>0\) is regularization parameter. Different from conventional neural bandit works, our gradient covariance matrix is defined as \(\bm{\Gamma}_{t-1}=\lambda\bm{\Gamma}+\sum_{\tau\in[t-1]}w_{\tau}\cdot g(\bm{x}_{ \tau};\bm{\theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m\). Here, to quantify the arm uncertainty level, inspired by [42], we define the sample weight as \(w_{\tau}=\min\{1,\alpha/\|g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\|_{ \bm{\Gamma}_{\tau-1}^{-1}}\}\) based on the gradient vector \(g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})=\text{vec}\big{(}\nabla_{\bm{\theta}}f( \bm{x}_{\tau};\bm{\theta}_{\tau-1})\big{)}\in\mathbb{R}^{p}\), and it is scaled by a tunable parameter \(\alpha>0\). Notice that the arm weight \(w_{\tau}\) is inversely proportional to our UCB-type exploration score in (E.1). Since the UCB-based exploration score can be considered to quantify reward estimation uncertainty levels [24; 72; 86], we thus assign small weights to training samples with high uncertainty. Recall that in (1), we apply \(\nu\) to characterize the random noise \(\epsilon\). Similar to R-NeuralUCB, when this value is unknown, we alternatively deem \(\nu\geq 0\) as a tunable exploration parameter to control the exploration intensity analogous to existing works (e.g., [86]).

After receiving the reward \(r_{t}\) for the chosen arm \(\bm{x}_{t}\), we update the records to \(\mathcal{P}_{t}\). The arm context \(\bm{x}_{t}\) and its received reward \(r_{t}\) are added to the collection \(\mathcal{P}_{t}\), along with their weight \(w_{t}=\min\{1,\alpha/\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\Gamma} _{t-1}^{-1}}\}\) (line 9, Algorithm 3).

Model Training.Afterwards, we perform \(J\) iterations of GD to update the network parameters (line 11, Algorithm 3). With \(\mathcal{P}_{t}=\big{\{}\bm{x}_{\tau},r_{\tau}\big{\}}_{\tau\in[t]}\) up to round \(t\), we train the model parameters \(\bm{\theta}_{t}\), through \(\bm{\theta}_{t}^{(j)}=\bm{\theta}_{t}^{(j-1)}-\eta\nabla_{\bm{\theta}}\mathcal{ L}(\mathcal{P}_{t};\bm{\theta}_{t}^{(j-1)})\). Here, \(\bm{\theta}_{t}^{(j)},j\in[J]\) are the parameters after the \(j\)-th GD iteration, starting from randomly initialized ones \(\bm{\theta}_{t}^{(0)}=\bm{\theta}_{0}\), and \(\eta>0\) refers to the learning rate. Different from existing neural bandit works (e.g., [86; 84]) which consider all received records to be equally important with the ordinary \(L_{2}\) loss function, we alternatively define the weighted loss function as

\[\mathcal{L}(\mathcal{P};\bm{\theta})=\sum_{(\bm{x}_{\tau},r_{\tau})\in \mathcal{P}}\frac{w_{\tau}}{2}\big{|}f(\bm{x}_{\tau};\bm{\theta})-r_{\tau} \big{|}^{2}+\frac{m\lambda}{2}\|\bm{\theta}-\bm{\theta}_{0}\|_{2}^{2}\]

where \(\lambda>0\) is the regularization parameter as in (E.1), and we have previously defined sample weights \(w_{\tau},\tau\in[t]\) associated with each chosen arm-reward pair \((\bm{x}_{\tau},r_{\tau})\in\mathcal{P}_{t}\). In summary, the intuition is that, when defining the loss function for the received records \(\mathcal{P}_{t}=\{\bm{x}_{\tau},r_{\tau}\}_{\tau\in[t]}\) up to round \(t\), we aim to give extra emphasis to samples with low estimation uncertainty. Intuitively, if samples with high uncertainty are indeed corrupted by the adversary, they are more likely to significantly disrupt the internal decision-making process, thereby impacting the stability of reward estimation. To mitigate this risk, even though we cannot identify which training samples are corrupted, we conservatively assign smaller weights to high-uncertainty samples, supporting a stable and robust GD training process.

### Regret Analysis for NeuralUCB-WGD

For the theoretical analysis, different from that of R-NeuralUCB (Subsection 5.1), we focus on the case where the corruption level \(C\) is known, a common setting in existing works [16; 42; 76; 17]. This assumption allows us to appropriately select the parameter \(\alpha\) in Algorithm 3 to achieve a tighter regret bound. Additionally, we briefly discuss potential outcomes if \(C\) is unknown. Recall that our objective (2) is to minimize the overall pseudo-regret in terms of the corruption-free expected reward over a finite horizon of \(T\) rounds: \(R(T)=\sum_{t=1}^{T}\mathbb{E}[\widetilde{r}_{t}^{*}-\widetilde{r}_{t}]\), where \(\mathbb{E}[\widetilde{r}_{t}]=h(\bm{x}_{t})\) denotes the expected corruption-free reward from the chosen arm \(\bm{x}_{t}\), and \(\mathbb{E}[\widetilde{r}_{t}^{*}]=\max_{\bm{x}_{t,t}\in\mathcal{X}_{t}}[h(\bm{ x}_{i,t})]\) represents the expected reward of the optimal arm.

To address challenges in regret analysis, we define two sets of regression parameters corresponding to the corrupted model and the corruption-free model. Using the corruption-free model \(f(\cdot;\widetilde{\bm{\theta}})\), we derive the confidence ellipsoid around its parameters \(\widetilde{\bm{\theta}}\), which serves as a proxy for updating the confidence ellipsoid around the trained corrupted model parameters \(\bm{\theta}\). With the updated confidence ellipsoid and concentration results, we then finalize the regret upper bound. Here, without carefully designing the arm weights \(w_{\tau},\tau\in[t]\) (Algorithm 3) and structuring the regret analysis workflow, deriving the regret upper bound under adversarial corruption settings would be impractical. The following Theorem E.1 provides a bound on the cumulative pseudo-regret for NeuralUCB-WGD.

**Theorem E.1**.: _Given the finite horizon \(T\in\mathbb{N}^{+}\), denote \(S\geq\sqrt{2\bm{\hat{h}}^{\intercal}\widetilde{\bm{\Gamma}}-\bm{\hat{h}}}\). Suppose probability parameter \(\delta\in(0,1)\), network width \(m\geq\Omega(\text{poly}(T,L,C,\tilde{\lambda}_{0}^{-1},\lambda^{-1},S^{-1}) \cdot\log(1/\delta))\), \(\eta\leq\mathcal{O}((TmL+m\lambda)^{-1})\), \(J\geq\widetilde{\mathcal{O}}(TL/\lambda)\), and \(\lambda\geq S^{-2}\). Let \(f(\cdot)\) be the \(L\)-layer FC network with _width \(m\), and set \(\alpha=1/C\) without the prior knowledge of \(\widetilde{d}\). Then, with probability at least \(1-\delta\) over random initialization, NeuralUCB-WGD achieves the regret upper bound:_

\[R(T)\leq\ \widetilde{\mathcal{O}}\bigg{(}\sqrt{\widetilde{d}T} \bigg{)}\cdot\widetilde{\mathcal{O}}\bigg{(}\nu\sqrt{\widetilde{d}-2\log( \delta)}+\lambda^{1/2}S\bigg{)}+\mathcal{O}\bigg{(}C\widetilde{d}\log(1+TK/ \lambda)\bigg{)}+\mathcal{O}\big{(}C\widetilde{d}\cdot\lambda^{1/2}S\big{)}\] \[\qquad\quad+\mathcal{O}\bigg{(}C\widetilde{d}\cdot\big{(}\nu \sqrt{\widetilde{d}\log(1+TK/\lambda)-2\log(\delta)}\big{)}\bigg{)}\]

The proof of Theorem E.1 is provided in Appendix F. The first term on the RHS represents the corruption-independent regret upper bound, which matches the bound \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T})\) in corruption-free neural bandit studies [86, 84]. For terms that depend on the corruption level \(C\), we obtain \(\widetilde{\mathcal{O}}(C\widetilde{d}\lambda^{1/2}S+C\widetilde{d}^{\widetilde {3}/2})\) by omitting logarithmic terms. When aligning the definition of information gain [16] with the effective dimension \(\widetilde{d}\), our results are consistent with the latest kernelized bandit research in terms of the horizon \(T\) and effective dimension \(\widetilde{d}\), given the NTK-induced RKHS and an indefinite arm space (Corollary 7 in [16]). Additionally, we can bound the NTK norm term \(S\) by a constant if \(h(\cdot)\) belongs to the RKHS norm induced by NTK (Subsection B.4). The regularization parameter \(\lambda\) can also be tuned to account for the NTK norm \(S\). Different from the vanilla NeuralUCB [86], we quantify the impact of corruption by deriving a new confidence ellipsoid around the corrupted parameters \(\bm{\theta}_{t-1}\), ensuring that the corruption-related terms remain independent of the non-logarithmic \(T\) term.

Inspired by [42], when \(C\) is unknown to the learner, an estimated corruption level \(\bar{C}>0\) can be utilized based on prior knowledge of the adversary. In this case, we can set the scaling parameter \(\alpha=1/\bar{C}\). If the actual \(C\leq\bar{C}\), then the corresponding regret upper bound in Theorem 5.6 still holds. Conversely, if \(C>\bar{C}\), the regret bound will no longer hold, leading to a trivial upper bound of \(R(T)\leq\mathcal{O}(T)\), similar to existing works (e.g., [42]). Here, practically, one approach is to set \(\bar{C}=\sqrt{T}\). For \(C\leq\sqrt{T}\), the overall regret is then bounded by \(\widetilde{\mathcal{O}}(\widetilde{d}^{\widetilde{3}/2}\sqrt{T})\), which matches [16] and improves upon \(\widetilde{\mathcal{O}}(\widetilde{d}T)\) from [15]. When \(C>\sqrt{T}\), our trivial regret bound of \(\mathcal{O}(T)\) also aligns with the state-of-the-art kernelized method [15] with unknown \(\bar{C}\), which has a bound of \(\widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+C\widetilde{d}\sqrt{T})\implies \widetilde{\mathcal{O}}(\widetilde{d}\sqrt{T}+\widetilde{d}T)\). Thus, the regret bound for NeuralUCB-WGD comparably matches the latest theoretical results from the kernelized bandit research [16, 15] under the indefinite arm space setting. While the problem definition of neural contextual bandits (1) is more general and reduce restrictions from the reward mapping function aspect, it is also significantly distinct from the problem definitions of linear or kernelized bandits, which makes lots of techniques from existing works on tackling adversarial corruptions (e.g., [42, 16]) infeasible.

## Appendix F Proof of Regret Bound for NeuralUCB-WGD (Proof of Theorem E.1)

By definition in (1), recall that we aim to minimize the pseudo-regret for \(T\) rounds, denoted by

\[R(T) =\sum_{t=1}^{T}\left[h(\bm{x}_{t}^{*})-h(\bm{x}_{t})\right]=\sum _{t=1}^{T}R_{t}\] \[=\sum_{t=1}^{T}\left[\langle g(\bm{x}_{t}^{*};\bm{\theta}_{0}),\ \bm{ \theta}^{*}-\bm{\theta}_{0}\rangle-\langle g(\bm{x}_{t};\bm{\theta}_{0}),\ \bm{\theta}^{*}-\bm{\theta}_{0}\rangle\right]\]

where \(\bm{x}_{t}\) is the chosen arm and \(\bm{x}_{t}^{*}=\operatorname*{arg\,max}_{\bm{x}_{t,t}\in\mathcal{X}_{t}}[h(\bm {x}_{i,t})]\) being the optimal arm in round \(t\). The third equality is due to Lemma C.1. Then, we denote \(f(\cdot)\) as the bandit model we currently possess, which is trained with corrupted records \(\mathcal{P}_{t-1}\) up to round \(t\), and also suppose an imaginary corruption-free bandit model accordingly, which is trained with corruption-free records \(\widetilde{\mathcal{P}}_{t-1}\). The corresponding model parameters of \(f(\cdot)\) will be denoted as \(\bm{\theta}\), while the parameters of the imaginary corruption-free model will be denoted as \(\widetilde{\bm{\theta}}\).

**Proof sketch.** To begin with, we first analyze the single-round pseudo-regret \(R_{t}\) for \(t\in[T]\), where the cumulative regret is given by \(R(T)=\sum_{t\in[T]}R_{t}\). Here, we demonstrate that the single-round regret with corruption can be upper bounded by using the updated confidence ellipsoid (Lemma F.1) around the corrupted network parameters \(\theta_{t}\). Since we cannot directly apply the self-regularized martingale concentration results from existing studies [1, 86], we instead derive updated concentration results that account for adversarial corruptions, as shown in Lemma F.2. These results are then combined to establish the cumulative regret over \(T\) rounds. Additionally, we provide the optimal value for the scaling parameter \(\alpha\) based on the known corruption level \(C\), demonstrating why setting \(\alpha=1/C\) yields the desired regret bound.

### Bounding the Single-round Regret

Following analogous approach as the proof of Lemma 5.3 in [86], we can transform the regret for a single round \(t\in[T]\) to

\[R_{t} =\langle g(\bm{x}_{t}^{*};\bm{\theta}_{0}),\ \bm{\theta}^{*}-\bm{ \theta}_{0}\rangle-\langle g(\bm{x}_{t};\bm{\theta}_{0}),\ \bm{\theta}^{*}-\bm{\theta}_{0}\rangle\] \[\leq\langle g(\bm{x}_{t}^{*};\bm{\theta}_{t-1}),\ \bm{\theta}^{*}-\bm{ \theta}_{0}\rangle-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{\theta}^{*}-\bm{\theta}_{0}\rangle+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^ {1/6}\lambda^{-1/6}L^{2/7})\] \[\leq\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t}^{ *};\bm{\theta}_{t-1}),\ \bm{\theta}-\bm{\theta}_{0}\rangle-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{\theta}^{*}-\bm{\theta}_{0}\rangle+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{ 1/6}\lambda^{-1/6}L^{2/7}).\]

where the first inequality is by the gradient difference in Lemma G.4, and the bound of \(\|\bm{\theta}^{*}-\bm{\theta}_{0}\|\) in Lemma C.1. Here, based on Lemma F.1, we have the unknown parameter \(\bm{\theta}^{*}\in\mathcal{C}_{t-1}\) with the confidence ellipsoid \(\mathcal{C}_{t-1}=\{\bm{\theta}:\|\bm{\theta}-\bm{\theta}_{t-1}\|_{\mathcal{C }_{t-1}^{-1}}\leq\gamma_{t-1}/\sqrt{m}\}\) induced by our currently possessed parameters \(\bm{\theta}_{t-1}\) as well as the chosen arms \(\{\bm{x}_{\tau}\}_{\tau\in[t-1]}\). Here, with \(\widetilde{\gamma}_{t-1}\) being the corresponding corruption-free radius term, we have

\[\gamma_{t-1}=\widetilde{\gamma}_{t-1} +\alpha\cdot C+(1-\eta m\lambda)^{J/2}\sqrt{t/\lambda}+\mathcal{O }(m^{-1/6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\] \[+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^{7/2}) +\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2}).\]

Then, based on the arm pulling mechanism, we denote the estimated arm benefit score as \(U(\bm{x}_{i,t})=f(\bm{x}_{i,t};\bm{\theta}_{t-1})+\gamma_{t-1}\cdot\sqrt{g( \bm{x}_{i,t};\bm{\theta}_{t-1})\bm{\tau}\bm{\Gamma}_{t-1}^{-1}g(\bm{x}_{i,t}; \bm{\theta}_{t-1})},\) and we also define its alternative based on the confidence ellipsoid as

\[V(\bm{x}_{i,t}) =\left\langle g(\bm{x}_{i,t};\bm{\theta}_{t-1}),\ \bm{\theta}_{t-1}-\bm{\theta}_{0}\right\rangle+\gamma_{t-1}\cdot\sqrt{g(\bm{x}_ {i,t};\bm{\theta}_{t-1})^{\intercal}\bm{\Gamma}_{t-1}^{-1}g(\bm{x}_{i,t};\bm{ \theta}_{t-1})/m}\] \[=\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\left\langle g(\bm{x}_{i,t };\bm{\theta}_{t-1}),\ \bm{\theta}-\bm{\theta}_{0}\right\rangle\]

based on the confidence interval \(\mathcal{C}_{t-1}\) induced by the corrupted parameters \(\bm{\theta}_{t-1}\). Regarding their distance, we can further derive \(|U(\bm{x}_{i,t})-V(\bm{x}_{i,t})|\leq\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3 }\lambda^{-2/3}L^{3})\) by applying Lemma G.5, as well as the fact that \(f(\bm{x};\bm{\theta}_{0})=0\) based on random initialization. It then leads to

\[R_{t} \leq\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t}^{ *};\bm{\theta}_{t-1}),\ \bm{\theta}-\bm{\theta}_{0}\rangle-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{\theta}^{*}-\bm{\theta}_{0}\rangle+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6 }\lambda^{-1/6}L^{2/7})\] \[=V(\bm{x}_{t}^{*})-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{ \theta}^{*}-\bm{\theta}_{0}\rangle+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6} \lambda^{-1/6}L^{2/7})\] \[\leq U(\bm{x}_{t}^{*})-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{ \theta}^{*}-\bm{\theta}_{0}\rangle\] \[\leq U(\bm{x}_{t})-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{ \theta}^{*}-\bm{\theta}_{0}\rangle\] \[\leq U(\bm{x}_{t})-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{ \theta}^{*}-\bm{\theta}_{0}\rangle\] \[\leq V(\bm{x}_{t})-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{ \theta}^{*}-\bm{\theta}_{0}\rangle\] \[\leq\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t}; \bm{\theta}_{t-1}),\ \bm{\theta}-\bm{\theta}_{0}\rangle-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{ \theta}^{*}-\bm{\theta}_{0}\rangle\] \[\qquad\qquad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1 /6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3})\] \[\leq V(\bm{x}_{t})-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{ \theta}^{*}-\bm{\theta}_{0}\rangle\] \[\qquad\qquad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1 /6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3})\] \[\leq\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t}; \bm{\theta}_{t-1}),\ \bm{\theta}-\bm{\theta}_{0}\rangle-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{ \theta}^{*}-\bm{\theta}_{0}\rangle\] \[\qquad\qquad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1 /6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3})\]

where the third inequality is due to the arm pulling mechanism. The second and the fourth inequality is due to the distance between \(V(\cdot)\) and \(U(\cdot)\). Since we have \(\bm{\theta}^{*}\in\mathcal{C}_{t-1}\), by Holder's inequality, it will further lead to

\[R_{t} \leq\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\langle g(\bm{x}_{t};\bm{ \theta}_{t-1}),\ \bm{\theta}-\bm{\theta}_{0}\rangle-\langle g(\bm{x}_{t};\bm{\theta}_{t-1}),\ \bm{\theta}^{*}-\bm{\theta}_{0}\rangle+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{ 1/6}\lambda^{-1/6}L^{2/7})\] \[\qquad\qquad+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2 /3}L^{3})\] \[\leq\max_{\bm{\theta}\in\mathcal{C}_{t-1}}\|g(\bm{x}_{t};\bm{ \theta}_{t-1})\|_{\bm{\Gamma}^{-1}_{t-1}}\cdot\|\bm{\theta}-\bm{\theta}_{0}\| _{\bm{\Gamma}_{t-1}}+\|g(\bm{x}_{t};\bm{\theta}_{t-1})\|_{\bm{\Gamma}^{-1}_{t -1}}\cdot\|\bm{\theta}^{*}-\bm{\theta}_{0}\|_{\bm{\Gamma}_{t-1}}\] \[\qquad\qquad+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{- 1/6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3}L^{3})\] \[\leq 2\gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m} \|_{\bm{\Gamma}^{-1}_{t-1}}+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6} \lambda^{-1/6}L^{2/7})+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2/3} L^{3})\]

where the last inequality is due to the definition of confidence ellipsoid \(\mathcal{C}_{t-1}\). This gives the upper bound for our single-round regret.

### Bounding the cumulative regret

On the other hand, based on the conclusion from Subsec. F.1, the cumulative regret upper bound can be transformed to

\[R(T)=\sum_{t=1}^{T}\left[h(\bm{x}_{t}^{*})-h(\bm{x}_{t})\right] =\sum_{t=1}^{T}R_{t}\] \[\quad\leq\sum_{t=1}^{T}\left[2\cdot\min\left\{\gamma_{t-1}\cdot \|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\Gamma}^{-1}_{t-1}},\ 1\right\}+\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6}L^{2/7})\right.\] \[\qquad\qquad+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}t^{2/3}\lambda^{-2 /3}L^{3})\right]\] \[\quad\leq\sum_{t=1}^{T}\left[2\cdot\min\left\{\gamma_{t-1}\cdot \|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\Gamma}^{-1}_{t-1}},\ 1\right\}\right]+ \mathcal{O}(1)\]

where the last inequality is because of sufficiently large network width \(m\) that satisfies conditions in Theorem E.1. Then, for the first term on the RHS, we can further have

\[\sum_{t=1}^{T}2\cdot\min\left\{\gamma_{t-1}\cdot\|g(\bm{x}_{t}; \bm{\theta}_{t-1})/\sqrt{m}\|_{\bm{\Gamma}^{-1}_{t-1}},\ 1\right\}\] \[\leq 2\gamma_{T}\cdot\sqrt{\widetilde{d}T\log(1+TK/\lambda)}+(1+ \frac{\gamma_{T}}{\alpha})\cdot\widetilde{d}\log(1+TK/\lambda)\] \[=\widetilde{d}\log(1+TK/\lambda)+2\gamma_{T}\cdot\left(\sqrt{ \widetilde{d}T\log(1+TK/\lambda)}+\frac{1}{\alpha}\cdot\widetilde{d}\log(1+TK /\lambda)\right)\] \[\leq\widetilde{d}\log(1+TK/\lambda)+\left(\sqrt{\widetilde{d}T \log(1+TK/\lambda)}+\frac{1}{\alpha}\cdot\widetilde{d}\log(1+TK/\lambda)\right)\] \[\qquad\cdot\left(2\widetilde{\gamma}_{t-1}+2\alpha\cdot C+2(1- \eta m\lambda)^{J/2}\sqrt{t/\lambda}+\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{7/2 }t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\right.\] \[\qquad\qquad+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{1/6}\lambda^ {-7/6}L^{7/2})+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2 })\right)\] \[\leq\widetilde{d}\log(1+TK/\lambda)+\left(\sqrt{\widetilde{d}T \log(1+TK/\lambda)}+\frac{1}{\alpha}\cdot\widetilde{d}\log(1+TK/\lambda)\right)\] \[\qquad\cdot\left((\nu\sqrt{\widetilde{d}\log(1+TK/\lambda)-2\log (\delta)}+\lambda^{1/2}S)+2\alpha\cdot C\right.\] \[\qquad\qquad+2(1-\eta m\lambda)^{J/2}\sqrt{t/\lambda}+\mathcal{O} (m^{-1/6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\] \[\qquad\qquad+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{1/6}\lambda^{- 7/6}L^{7/2})+\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2 })\right)\] \[\leq\left(\sqrt{\widetilde{d}T\log(1+TK/\lambda)}+\frac{ \widetilde{d}}{\alpha}\log(1+TK/\lambda)\right)\cdot\mathcal{O}\bigg{(}\nu \sqrt{\widetilde{d}\log(1+TK/\lambda)-2\log(\delta)}+\lambda^{1/2}S+2\alpha C \bigg{)}+\mathcal{O}(1)\]where the first inequality is due to Lemma F.2, and the second inequality is due to Lemma F.1. The third inequality can be derived following an analogous approach as Lemma 5.2 in [86], and the last inequality is due to the sufficiently large network width \(m\) as mentioned in Theorem E.1, as well as the sufficient number of GD iterations \(J=\widetilde{\mathcal{O}}(TL/\lambda)\).

**Discussion on the value of \(\alpha\).** Here, notice that we have the tunable parameter \(\alpha>0\) nested in the regret bound. Taking some more steps, we can have

\[\sum_{t=1}^{T}2\min\left\{\gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{ \theta}_{t-1})/\sqrt{m}\|_{\bm{\Gamma}_{t-1}^{-1}},\;1\right\}\] \[\qquad\qquad\qquad\qquad\cdot\mathcal{O}\bigg{(}\nu\sqrt{\widetilde {d}\log(1+TK/\lambda)-2\log(\delta)}+\lambda^{1/2}S+2\alpha\cdot C\bigg{)}\] \[\qquad\qquad\qquad\leq\widetilde{\mathcal{O}}\bigg{(}\sqrt{ \widetilde{d}T}+\frac{1}{\alpha}\cdot\widetilde{d}\bigg{)}\cdot\bigg{(}\nu \sqrt{\widetilde{d}-2\log(\delta)}+\lambda^{1/2}S+2\alpha\cdot C\bigg{)}\] \[\qquad\qquad\qquad\leq\widetilde{\mathcal{O}}\bigg{(}\sqrt{ \widetilde{d}T}+\frac{1}{\alpha}\cdot\widetilde{d}\bigg{)}\cdot\bigg{(}\nu \sqrt{\widetilde{d}-2\log(\delta)}+\lambda^{1/2}S\bigg{)}+\widetilde{\mathcal{O }}\bigg{(}\alpha C\sqrt{\widetilde{d}T}+C\widetilde{d}\bigg{)}\]

Since we have no prior knowledge of effective dimension \(\widetilde{d}\), we can set \(\alpha=\frac{1}{\mathcal{C}}\). It will then lead to

\[\sum_{t=1}^{T} 2\min\left\{\gamma_{t-1}\cdot\|g(\bm{x}_{t};\bm{\theta}_{t-1})/ \sqrt{m}\|_{\bm{\Gamma}_{t-1}^{-1}},\;1\right\}\] \[\leq\widetilde{\mathcal{O}}\bigg{(}\sqrt{\widetilde{d}T}+\frac{1} {\alpha}\cdot\widetilde{d}\bigg{)}\cdot\bigg{(}\nu\sqrt{\widetilde{d}-2\log( \delta)}+\lambda^{1/2}S\bigg{)}+\widetilde{\mathcal{O}}\bigg{(}\alpha C\sqrt{ \widetilde{d}T}+C\widetilde{d}\bigg{)}\] \[\leq\widetilde{\mathcal{O}}\bigg{(}\sqrt{\widetilde{d}T}\bigg{)} \cdot\bigg{(}\nu\sqrt{\widetilde{d}-2\log(\delta)}+\lambda^{1/2}S\bigg{)}+ \widetilde{\mathcal{O}}\bigg{(}C\widetilde{d}+C\widetilde{d}\cdot\big{(}\nu \sqrt{\widetilde{d}-2\log(\delta)}+\lambda^{1/2}S\big{)}\bigg{)}.\]

Finally, summing up all the results above will give the conclusion.

### Confidence ellipsoid for corrupted parameters

**Lemma F.1**.: _With the notation and conditions in Theorem E.1, train the network parameters \(\bm{\theta}_{t-1}\) based on received records \(\mathcal{P}_{t-1}\). The confidence ellipsoid around the corrupted network parameters \(\bm{\theta}_{t-1}\) can be defined as_

\[\mathcal{C}_{t-1}=\left\{\bm{\theta}:\|\bm{\theta}-\bm{\theta}_{t-1}\|_{\bm{ \Gamma}_{t-1}}\leq\gamma_{t-1}/\sqrt{m}\right\}\]

_where we have the unknown parameter \(\bm{\theta}^{*}\in\mathcal{C}_{t-1}\), and we denote_

\[\gamma_{t-1}=\widetilde{\gamma}_{t-1} +\alpha\cdot C+(1-\eta m\lambda)^{J/2}\sqrt{t/\lambda}+\mathcal{ O}(m^{-1/6}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda}))\] \[+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{1/6}\lambda^{-7/6}L^{7/2}) +\mathcal{O}(Cm^{-1/6}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\]

**Proof.** The proof follows an analogous approach as in Lemma C.12. For the imaginary corruption-free parameters \(\widetilde{\bm{\theta}}_{t-1}\), which are trained on corruption-free records \(\widetilde{\mathcal{P}}_{t-1}\), we can construct the confidence interval \(\widetilde{\mathcal{C}}_{t-1}:=\left\{\bm{\theta}:\|\bm{\theta}-\widetilde{ \bm{\theta}}_{t-1}\|_{\widetilde{\bm{\Gamma}}_{t-1}}\leq\widetilde{\gamma}_{t- 1}/\sqrt{m},\widetilde{\gamma}_{t-1}>0\right\}\), such that the unknown \(\bm{\theta}^{*}\) in Lemma C.1 satisfies \(\bm{\theta}^{*}\in\widetilde{\mathcal{C}}_{t-1}\). However, since we do not possess \(\widetilde{\bm{\theta}}_{t-1}\), we need to alternatively derive the confidence ellipsoid \(\mathcal{C}_{t-1}\) around the possessed corrupted parameters \(\bm{\theta}_{t-1}\), such that \(\bm{\theta}^{*}\in\mathcal{C}_{t-1}\).

With the ellipsoid center \(\bm{\theta}_{t-1}\) as well as the weighted gradient covariance matrix \(\bm{\Gamma}_{t-1}=\lambda\bm{\Gamma}+\sum_{\tau\in[t-1]}w_{\tau}\cdot g(\bm{x}_ {\tau};\bm{\theta}_{\tau-1})\cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{ \intercal}/m\), we need to derive the corresponding radius. Recall that \(w_{\tau}\) is the sample weight associated with chosen arm \(\bm{x}_{\tau}\). Here, we first recall some preliminaries that \(\|\Gamma_{t-1}-\widetilde{\Gamma}_{t-1}\|_{F}\leq\mathcal{O}(m^{-1/6}\sqrt{ \log(m)}L^{4}t^{7/6}\lambda^{-1/6})\) due to Lemma G.6, as well as \(\|\bm{\theta}_{t-1}-\widetilde{\bm{\theta}}_{t-1}\|_{2}\leq\mathcal{O}(\sqrt{ t/(m\lambda)})\) due to Lemma G.3.

Next, as we already have \(\|\bm{\theta}-\widetilde{\bm{\theta}}_{t-1}\|_{\widetilde{\mathbf{F}}_{t-1}}\leq \widetilde{\gamma}_{t-1}/\sqrt{m}\), we proceed to transform the objective to

\[\|\bm{\theta}^{*}- \bm{\theta}_{t-1}\|_{\mathbf{r}_{t-1}}\leq\|\bm{\theta}^{*}- \widetilde{\bm{\theta}}_{t-1}\|_{\mathbf{r}_{t-1}}+\|\widetilde{\bm{\theta}}_{t -1}-\bm{\theta}_{t-1}\|_{\mathbf{r}_{t-1}}\] \[\leq\|\bm{\theta}^{*}-\widetilde{\bm{\theta}}_{t-1}\|_{\mathbf{r} _{t-1}}+\|\widetilde{\bm{\theta}}_{t-1}-\bm{\theta}_{t-1}\|_{\mathbf{r}_{t-1}}\] \[\leq\|\bm{\theta}^{*}-\widetilde{\bm{\theta}}_{t-1}\|_{\mathbf{r} _{t-1}-\widetilde{\mathbf{F}}_{t-1}+\widetilde{\mathbf{F}}_{t-1}}+\| \widetilde{\bm{\theta}}_{t-1}-\bm{\theta}_{t-1}\|_{\mathbf{r}_{t-1}}\] \[\leq\|\bm{\theta}^{*}-\widetilde{\bm{\theta}}_{t-1}\|_{\widetilde {\mathbf{F}}_{t-1}}+\|\bm{\theta}^{*}-\widetilde{\bm{\theta}}_{t-1}\|_{ \mathbf{r}_{t-1}-\widetilde{\mathbf{F}}_{t-1}}+\|\widetilde{\bm{\theta}}_{t- 1}-\bm{\theta}_{t-1}\|_{\mathbf{r}_{t-1}}\] \[\leq\widetilde{\gamma}_{t-1}/\sqrt{m}+\|\widetilde{\bm{\theta}}_{t -1}-\bm{\theta}_{t-1}\|_{\mathbf{r}_{t-1}}+\mathcal{O}(\sqrt{t/(m\lambda)}) \cdot\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6}\lambda^{-1/6})\] \[\leq\widetilde{\gamma}_{t-1}/\sqrt{m}+\|\widetilde{\bm{\theta}}_{t -1}-\bm{\theta}_{t-1}\|_{\mathbf{r}_{t-1}}+\mathcal{O}(m^{-2/3}\sqrt{\log(m)} L^{4}t^{13/6}\lambda^{-2/3}).\]

For the second term on the RHS, we first define the gradient-based regression parameters as

\[\bm{\Gamma}_{t-1}^{(0)} =\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{\tau}\cdot g(\bm{x}_{ \tau};\bm{\theta}_{0})\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})^{\intercal}/m,\] \[\bm{b}_{t-1}^{(0)} =\sum_{\tau\in[t-1]}w_{\tau}\cdot g(\bm{x}_{\tau};\bm{\theta}_{0} )\cdot r_{\tau}/\sqrt{m},\] \[\widetilde{\bm{b}}_{t-1}^{(0)} =\sum_{\tau\in[t-1]}w_{\tau}\cdot g(\bm{x}_{\tau};\bm{\theta}_{0 })\cdot\widetilde{r}_{\tau}/\sqrt{m},\]

Then, with the triangular inequality, we can proceed to have

\[\|\widetilde{\bm{\theta}}_{t-1}- \bm{\theta}_{t-1}\|_{\mathbf{r}_{t-1}}\leq\|\widetilde{\bm{\theta }}_{t-1}-\bm{\theta}_{0}-(\bm{\Gamma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0)}/ \sqrt{m}+(\bm{\Gamma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0)}/\sqrt{m}+\bm{\theta} _{0}-\bm{\theta}_{t-1}\|_{\mathbf{r}_{t-1}}\] \[\leq\|\bm{\theta}_{t-1}-\bm{\theta}_{0}-(\bm{\Gamma}_{t-1}^{(0)})^ {-1}\bm{b}_{t-1}^{(0)}/\sqrt{m}\|_{\mathbf{r}_{t-1}}+\|\widetilde{\bm{\theta} }_{t-1}-\bm{\theta}_{0}-(\bm{\Gamma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0)}/ \sqrt{m}\|_{\mathbf{r}_{t-1}}\] \[\leq\|\bm{\theta}_{t-1}-\bm{\theta}_{0}-(\bm{\Gamma}_{t-1}^{(0)}) ^{-1}\bm{b}_{t-1}^{(0)}/\sqrt{m}\|_{\mathbf{r}_{t-1}}+\|\widetilde{\bm{\theta} }_{t-1}-\bm{\theta}_{0}-(\bm{\Gamma}_{t-1}^{(0)})^{-1}\widetilde{\bm{b}}_{t- 1}^{(0)}/\sqrt{m}\|_{\mathbf{r}_{t-1}}\] \[\qquad\qquad+m^{-1}\|(\bm{\Gamma}_{t-1}^{(0)})^{-1}\cdot(\sum_{ \tau\in[t-1]}w_{\tau}\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c_{\tau})\|_{ \mathbf{r}_{t-1}}.\]

**Bounding the first two term on the RHS of Inequality F.1.** Here, for the first term on the RHS, we can individually apply Lemma D.1, by considering the auxiliary sequence in \(j\)-th iteration (\(j\in[J]\)) with \(\bm{\Theta}^{(0)}=\bm{\theta}_{0}\), as

\[\bm{\Theta}^{(j+1)}=\bm{\Theta}^{(j)}-\eta\cdot\bigg{[}\mathbf{J}^{(0)}\cdot \mathbf{W}\cdot\big{(}[\mathbf{J}^{(0)}]^{\intercal}(\bm{\Theta}^{(j)}-\bm{ \theta}_{0})-\bm{y}\big{)}+m\lambda(\bm{\Theta}^{(j)}-\bm{\theta}_{0})\bigg{]}\]

where the Jacobian matrix \(\mathbf{J}^{(0)}:=\big{(}g(\bm{x}_{1};\bm{\theta}_{0}),g(\bm{x}_{2};\bm{ \theta}_{0}),\ldots,g(\bm{x}_{t-1};\bm{\theta}_{0})\big{)}\in\mathbb{R}^{p\times (t-1)}\), and vector \(\bm{y}\in\mathbb{R}^{t-1}\) contains the received arm rewards \(r_{\tau},\tau\in[t-1]\), while matrix \(\mathbf{W}\in\mathbb{R}^{(t-1)\times(t-1)}\) is the diagonal matrix that contains sample weights \(w_{\tau},\tau\in[t-1]\). We have its norm \(\|\mathbf{W}\|_{2}\leq 1\) by definition. Here, the above sequence is expected to solve the following problem with gradient descent

\[\min_{\bm{\Theta}}\mathcal{L}(\bm{\Theta})=\sum_{\tau\in[t-1]}\frac{w_{\tau}}{2} \cdot\bigg{\|}[\mathbf{J}^{(0)}]_{\tau}^{\intercal}(\bm{\Theta}-\bm{\theta}_{0} )-r_{\tau}\bigg{\|}_{2}^{2}+\frac{1}{2}\cdot m\lambda\cdot\bigg{\|}\bm{\Theta}- \bm{\theta}_{0}\bigg{\|}_{2}^{2}.\]

As a result, following an analogous approach as in Lemma C.4 in [86], we can have \(\|\bm{\Theta}^{(j)}-\bm{\theta}_{0}-(\bm{\Gamma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0)} /\sqrt{m}\|_{\mathbf{r}_{t-1}}\leq(1-\eta m\lambda)^{j/2}\sqrt{t/(m\lambda)}\). Furthermore, by applying the conclusion of Lemma D.1, we can have

\[\|\bm{\theta}_{t-1}- \bm{\theta}_{0}- (\bm{\Gamma}_{t-1}^{(0)})^{-1}\bm{b}_{t-1}^{(0)}/\sqrt{m}\|_{2} \leq(1-\eta m\lambda)^{J/2}\sqrt{t/(m\lambda)}+ \mathcal{O}(m^{-2/3}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/ \lambda})).\]

Similarly, for the second term in Inequality F.1, we also can apply a comparable approach by solving the problem:

\[\min_{\bm{\Theta}}\mathcal{L}(\bm{\Theta})=\sum_{\tau\in[t-1]}\frac{w_{\tau}}{2} \bigg{\|}[\mathbf{J}^{(0)}]_{\tau}^{\intercal}(\bm{\Theta}-\bm{\theta}_{0})- \widetilde{\tau}_{\tau}\bigg{\|}_{2}^{2}+\frac{1}{2}m\lambda\cdot\bigg{\|}\bm{ \Theta}-\bm{\theta}_{0}\bigg{\|}_{2}^{2},\]and constructing the corresponding auxiliary sequence. Following an analogous approach, it will lead to a similar bound for the second term, such that \(\|\widetilde{\bm{\theta}}_{t-1}-\bm{\theta}_{0}-(\bm{\Gamma}_{t-1}^{(0)})^{-1} \widetilde{\bm{b}}_{t-1}^{(0)}/\sqrt{m}\|_{2}\leq(1-\eta m\lambda)^{J/2}\sqrt{t /(m\lambda)}+\mathcal{O}(m^{-2/3}\sqrt{\log(m)}L^{7/2}t^{5/3}\lambda^{-5/3}(1+ \sqrt{t/\lambda}))\).

**Bounding the third term on the RHS of Inequality F.1.** Afterwards, for the third term on the RHS, we first have

\[m^{-1}\cdot\|(\bm{\Gamma}_{t-1}^{(0)})^{-1}\cdot(\sum_{\tau\in[t- 1]}w_{\tau}\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c_{\tau})\|_{\bm{\Gamma} _{t-1}}\] \[\leq m^{-1}\|(\bm{\Gamma}_{t-1})^{-1}(\sum_{\tau\in[t-1]}w_{\tau} \cdot g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c_{\tau})\|_{\bm{\Gamma}_{t-1}}\] \[\qquad\qquad+m^{-1}\|((\bm{\Gamma}_{t-1})^{-1}-(\bm{\Gamma}_{t-1 }^{(0)})^{-1})\cdot(\sum_{\tau\in[t-1]}w_{\tau}\cdot g(\bm{x}_{\tau};\bm{ \theta}_{0})\cdot c_{\tau})\|_{\bm{\Gamma}_{t-1}}\] \[\leq m^{-1}\|(\bm{\Gamma}_{t-1})^{-1}(\sum_{\tau\in[t-1]}w_{\tau} \cdot g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c_{\tau})\|_{\bm{\Gamma}_{t-1}}\] \[\qquad\qquad+m^{-1}\|(\bm{\Gamma}_{t-1})^{-1}\big{(}\bm{\Gamma}_ {t-1}-\bm{\Gamma}_{t-1}^{(0)})(\bm{\Gamma}_{t-1}^{(0)})^{-1}\cdot(\sum_{\tau \in[t-1]}w_{\tau}\cdot g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c_{\tau})\|_{\bm{ \Gamma}_{t-1}}\] \[\leq m^{-1}\|(\bm{\Gamma}_{t-1})^{-1}(\sum_{\tau\in[t-1]}w_{\tau} \cdot g(\bm{x}_{\tau};\bm{\theta}_{0})\cdot c_{\tau})\|_{\bm{\Gamma}_{t-1}}+ \mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\] \[\leq m^{-1}\|(\bm{\Gamma}_{t-1})^{-1}(\sum_{\tau\in[t-1]}w_{\tau} \cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\cdot c_{\tau})\|_{\bm{\Gamma}_{t- 1}}+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\] \[\qquad\qquad+m^{-1}\|(\bm{\Gamma}_{t-1})^{-1}(\sum_{\tau\in[t-1]} w_{\tau}\cdot(g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})-g(\bm{x}_{\tau};\bm{ \theta}_{0}))\cdot c_{\tau})\|_{\bm{\Gamma}_{t-1}}\] \[\leq m^{-1}\|(\bm{\Gamma}_{t-1})^{-1}(\sum_{\tau\in[t-1]}w_{\tau} \cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\cdot c_{\tau})\|_{\bm{\Gamma}_{t- 1}}\] \[\qquad\qquad+\mathcal{O}(Cm^{-7/6}\sqrt{\log(m)}t^{1/6}\lambda^{-7 /6}L^{7/2})+\mathcal{O}(Cm^{-2/3}\sqrt{\log(m)}t^{7/6}\lambda^{-13/6}L^{9/2})\]

where the third inequality is due to Lemma G.6, and the last inequality is due to Lemma G.4. Then, recall that the weight \(w_{\tau}=\{1,\alpha/\|g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\|_{\bm{ \Gamma}_{\tau-1}^{-1}}\}\) for each chosen arm \(\bm{x}_{\tau}\). In this case, we can further have

\[m^{-1/2}\|(\bm{\Gamma}_{t-1})^{-1}(\sum_{\tau\in[t-1]}w_{\tau} \cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\cdot c_{\tau})/\sqrt{m}\|_{\bm{ \Gamma}_{t-1}}\] \[\qquad=m^{-1/2}\|\sum_{\tau\in[t-1]}w_{\tau}\cdot g(\bm{x}_{\tau };\bm{\theta}_{\tau-1})\cdot c_{\tau}/\sqrt{m}\|_{(\bm{\Gamma}_{t-1})^{-1}}\] \[\qquad\leq m^{-1/2}\sum_{\tau\in[t-1]}w_{\tau}|c_{\tau}|\cdot\|g( \bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\|_{(\bm{\Gamma}_{t-1})^{-1}}\] \[\qquad\leq m^{-1/2}\sum_{\tau\in[t-1]}w_{\tau}|c_{\tau}|\cdot\|g( \bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\|_{(\bm{\Gamma}_{\tau-1})^{-1}}\] \[\qquad\leq\alpha\cdot C/\sqrt{m}.\]

where the first inequality is by applying the Cauchy-Schwartz inequality, while the second inequality is due to \(\bm{\Gamma}_{\tau-1}\preceq\bm{\Gamma}_{t-1}\) and Lemma G.8. The last inequality is by the definition of corruption level \(C\). Finally, summing up all the results will give the desired lemma.

### Self-regularized Martingale Sequence with Weighted Matrix

Recall that we have the weighted gradient covariance matrix \(\bm{\Gamma}_{t-1}=\lambda\mathbf{I}+\sum_{\tau\in[t-1]}w_{\tau}\cdot g(\bm{x}_{ \tau};\bm{\theta}_{\tau-1})\cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\cdot g( \bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m\), where \(g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\) is the vectorized gradient vector, and \(w_{\tau}\leq 1\) refers to the sampled associated with chosen arm \(\bm{x}_{\tau}\).

By existing works [1, 86], we can have the self-normalized martingale such that

\[\sum_{\tau\in[t]}\min\left\{\left\|g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m} \right\|_{\bm{\Gamma}_{\tau-1}^{-1}}^{2},\;1\right\}\leq 2\log\frac{\det(\bm{ \Gamma}_{t})}{\det(\lambda\bm{\Gamma})}.\]

if weights in \(\bm{\Gamma}_{t}\) are all set to \(1\). However, since in our settings the gradient covariance matrix \(\bm{\Gamma}_{t}\) involves sample weights, we will need to further discuss the upper bound for this sequence summation.

**Lemma F.2**.: _With the definition of \(\gamma_{t-1}\) from Lemma F.1 as well as the notation and conditions in Theorem E.1, we have the following inequality_

\[\sum_{t\in[T]}\min\left\{\gamma_{t-1}\cdot\left\|g(\bm{x}_{t};\bm{\theta}_{t-1 })/\sqrt{m}\right\|_{\bm{\Gamma}_{t-1}^{-1}},\;1\right\}\leq\gamma_{T}\sqrt{ \widetilde{dT}\log(1+TK/\lambda)}+(1+\frac{\gamma_{T}}{\alpha})\cdot\widetilde {d}\log(1+TK/\lambda),\]

_where \(\bm{\Gamma}_{t-1}=\lambda\bm{\Gamma}+\sum_{\tau\in[t-1]}w_{\tau}\cdot g(\bm{x} _{\tau};\bm{\theta}_{\tau-1})\cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{ \intercal}/m\)._

**Proof.** The proof of this lemma follows an analogous approach as Theorem 4.2 in [42]. Recall that sample weights \(w_{\tau}\leq 1,\tau\in[T]\). In this case, we separately consider two scenarios when (i) \(w_{\tau}=1\), then \(\tau\in\mathcal{T}_{w=1}^{(T)}\); and (ii) the scenario when \(w_{\tau}<1\), then \(\tau\in\mathcal{T}_{w<1}^{(T)}\). In this case, the original objective will become the following inequality

\[\sum_{t\in[T]}\min\left\{\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/ \sqrt{m}\right\|_{\bm{\Gamma}_{t-1}^{-1}},\;1\right\}\] \[\quad=\sum_{t\in\mathcal{T}_{w=1}^{(T)}}\min\left\{\left\|g(\bm{x }_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{\bm{\Gamma}_{t-1}^{-1}},\;1\right\} +\sum_{t\in\mathcal{T}_{w<1}^{(T)}}\min\left\{\left\|g(\bm{x}_{t};\bm{\theta} _{t-1})/\sqrt{m}\right\|_{\bm{\Gamma}_{t-1}^{-1}},\;1\right\}\]

First, for the scenario where \(w_{\tau}=1,\tau\in\mathcal{T}_{w=1}^{(T)}\), we have

\[\sum_{t\in\mathcal{T}_{w=1}^{(T)}}\min\left\{\left\|g(\bm{x}_{t}; \bm{\theta}_{t-1})/\sqrt{m}\right\|_{\bm{\Gamma}_{t-1}^{-1}},\;1\right\} \leq\sqrt{\sum_{t\in\mathcal{T}_{w=1}^{(T)}}\min\left\{\left\|g( \bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{\bm{\Gamma}_{t-1}^{-1}}^{2},\; 1\right\}}\] \[\leq\sqrt{\sum_{t\in\mathcal{T}_{w=1}^{(T)}}\min\left\{\left\|g( \bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{(\bm{\Gamma}_{t-1}^{w=1})^{-1 }}^{2},\;1\right\}}.\]

Here, we define an extra auxiliary matrix \(\bm{\Gamma}_{t-1}^{w=1}=\lambda\bm{\Gamma}+\sum_{\tau\in\mathcal{T}_{w=1}^{(t -1)}}w_{\tau}\cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\cdot g(\bm{x}_{\tau}; \bm{\theta}_{\tau-1})\cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m\). Compared with the original gradient covariance matrix \(\bm{\Gamma}_{t-1}\), since we have \(\bm{\Gamma}_{t-1}^{w=1}\preceq\bm{\Gamma}_{t-1}\) and they are both Hermitian matrices, we can derive the last inequality based on Lemma G.8. Then, by applying Lemma G.7 and Lemma C.2, it will lead to

\[\sum_{t\in\mathcal{T}_{w=1}^{(T)}}\min\left\{\left\|g(\bm{x}_{t}; \bm{\theta}_{t-1})/\sqrt{m}\right\|_{\bm{\Gamma}_{t-1}^{-1}},\;1\right\} \leq\sqrt{\left|\mathcal{T}_{w=1}^{(T)}\right|\cdot\sum_{t\in \mathcal{T}_{w=1}^{(T)}}\min\left\{\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/ \sqrt{m}\right\|_{(\bm{\Gamma}_{t-1}^{w=1})^{-1}}^{2},\;1\right\}}\] \[\leq\sqrt{\left|\mathcal{T}_{w=1}^{(T)}\right|\cdot\widetilde{d} \log(1+TK/\lambda)}\] \[\leq\sqrt{\widetilde{dT}\log(1+TK/\lambda)}.\]

Then, since we have \(\gamma_{t-1}\leq\gamma_{T}\), plugging in the \(\gamma_{T}\) will complete the proof.

Afterwards, for the second scenario when \(w_{\tau}<1,\tau\in\mathcal{T}_{w<1}^{(T)}\), we will have

\[\sum_{t\in\mathcal{T}_{w<1}^{(T)}}\min\left\{\gamma_{t-1}\cdot \left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{\bm{\Gamma}_{t-1}^{-1 }},\;1\right\}=\sum_{t\in\mathcal{T}_{w<1}^{(T)}}\left\{\gamma_{t-1}\cdot \frac{w_{t}}{\alpha}\cdot\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m} \right\|_{\bm{\Gamma}_{t-1}^{-1}}^{2},\;1\right\}\] \[\leq(1+\frac{\gamma_{T}}{\alpha})\cdot\sum_{t\in\mathcal{T}_{w<1}^ {(T)}}\left\{w_{t}\cdot\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{ \bm{\Gamma}_{t-1}^{-1}}^{2},\;1\right\}\] \[\leq(1+\frac{\gamma_{T}}{\alpha})\cdot\sum_{t\in\mathcal{T}_{w<1}^ {(T)}}\left\{w_{t}\cdot\left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{( \bm{\Gamma}_{t-1}^{w<1})^{-1}}^{2},\;1\right\}\]where the inequality is because we have \(\gamma_{t-1}\leq\gamma_{T},\forall t\in[T]\).

Following the previous approach, we define the auxiliary matrix \(\bm{\Gamma}_{t-1}^{w<1}=\lambda\bm{\mathrm{I}}+\sum_{\tau\in\mathcal{T}_{\omega =1}^{(t-1)}}w_{\tau}\cdot g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\cdot g(\bm{x}_{ \tau};\bm{\theta}_{\tau-1})^{\intercal}/m\). Here, since we also have \(\bm{\Gamma}_{t-1}^{w<1}\preceq\bm{\mathrm{I}}_{t-1}\) and they are both Hermitian matrices, we can derive the last inequality based on Lemma G.8. In addition, we consider an alternative form of the original gradient vector as \(g^{\prime}(\bm{x}_{\tau};\bm{\theta}_{\tau-1})=\sqrt{w_{\tau}}\cdot g(\bm{x}_{ \tau};\bm{\theta}_{\tau-1}),\tau\in\mathcal{T}_{w=1}^{(t-1)}\). In this case, the auxiliary gradient covariance matrix can be alternatively represented as \(\bm{\Gamma}_{t-1}^{w<1}=\lambda\bm{\mathrm{I}}+\sum_{\tau\in\mathcal{T}_{w=1 }^{(t-1)}}g^{\prime}(\bm{x}_{\tau};\bm{\theta}_{\tau-1})\cdot g^{\prime}(\bm{x }_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m\), and the RHS will become

\[\sum_{t\in\mathcal{T}_{w<1}^{(T)}}\min\left\{\gamma_{t-1}\cdot \left\|g(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_{\bm{\Gamma}_{t-1}^{-1 }},\;1\right\} \leq(1+\frac{\gamma_{T}}{\alpha})\cdot\sum_{t\in\mathcal{T}_{w<1}^ {(T)}}\left\{\left\|g^{\prime}(\bm{x}_{t};\bm{\theta}_{t-1})/\sqrt{m}\right\|_ {(\bm{\Gamma}_{t-1}^{w<1})^{-1}}^{2},\;1\right\}\] \[\leq(1+\frac{\gamma_{T}}{\alpha})\cdot\widetilde{d}\log(1+TK/ \lambda).\]

where the last inequality is by applying Lemma G.7 and Lemma C.2. Summing up the results will finish the proof.

## Appendix G Lemmas for Over-parameterized FC Neural Networks

Given the input arm context vector \(\bm{x}\in\mathbb{R}^{d}\), we denote the \(L\)-layer FC neural network with width \(m\) as

\[f(\bm{x};\bm{\theta})=\bm{\theta}_{L}(\prod_{l=1}^{L-1}\bm{\mathrm{D}}_{l}\bm {\theta}_{l})\cdot\bm{x},\] (G.1)

where with \(\sigma\) being the ReLU activation, we define the intermediate hidden representations \(\bm{h}_{l},l\in\{0,\dots,L-1\}\) as

\[\bm{h}_{0}=\bm{x},\quad\bm{h}_{l}=\sigma(\bm{\theta}_{l}\bm{h}_{l-1}),l\in[L-1].\]

and we also have the binary diagonal matrix functioning as the ReLU activation being

\[\bm{\mathrm{D}}_{l}=\text{diag}(\mathbb{I}\{(\bm{\theta}_{l}\bm{h}_{l-1})_{1} \},\dots,\mathbb{I}\{(\bm{\theta}_{l}\bm{h}_{l-1})_{m}\}),l\in[L-1].\]

where \(\mathbb{I}(\cdot)\) is the indicator function. Afterwards, the corresponding gradients will become

\[\nabla_{\bm{\theta}_{l}}f(\bm{x};\bm{\theta})=\begin{cases}[\bm{h}_{l-1}\bm{ \theta}_{L}(\prod_{\tau=l+1}^{L-1}\bm{\mathrm{D}}_{\tau}\bm{\theta}_{\tau})]^{ \intercal},l\in[L-1]\\ \bm{h}_{L-1}^{\intercal},l=L.\end{cases}\] (G.2)

**Lemma G.1**.: _There exists a positive constant \(C>0\) such that with probability at least \(1-\delta\), if \(m\geq CT^{4}L^{6}\log(T^{2}L/\delta)/\lambda^{4}\) for each arbitrary \(\bm{x}_{\tau}\in\bigcup_{\tau\in[l]}\mathcal{X}_{\tau}\), there exists a set of parameters \(\bm{\theta}^{*}\) such that with the neural network parameters \(\bm{\theta}_{t-1}\) trained on \(\{\bm{x}_{\tau}\}_{\tau=1}^{t-1}\), we have_

\[|\langle g(\bm{x};\bm{\theta}_{0}),\bm{\theta}^{*}-\bm{\theta}_{0}\rangle- \langle g(\bm{x};\bm{\theta}_{t-1}),\bm{\theta}^{*}-\bm{\theta}_{0}\rangle| \leq\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6}L^{2/7})\]

_where parameters \(\bm{\theta}^{*}\) satisfy \(\|\bm{\theta}^{*}-\bm{\theta}_{0}\|\leq S/\sqrt{m},S>0\) as shown in Lemma C.1._

Proof.: This lemma is based on Lemma C.1. Here, our objective can be reformed into

\[|\langle g(\bm{x};\bm{\theta}_{0}), \bm{\theta}^{*}-\bm{\theta}_{0}\rangle-\langle g(\bm{x};\bm{ \theta}_{t-1}),\bm{\theta}^{*}-\bm{\theta}_{0}\rangle|=\|\bm{\theta}^{*}-\bm{ \theta}_{0}\|_{2}\cdot\big{(}g(\bm{x};\bm{\theta}_{0})-g(\bm{x};\bm{\theta}_{t -1})\big{)}\] \[\leq S/\sqrt{m}\cdot\big{(}g(\bm{x};\bm{\theta}_{0})-g(\bm{x}; \bm{\theta}_{t-1})\big{)}\] \[\leq\mathcal{O}(Sm^{-1/6}\sqrt{\log(m)}t^{1/6}\lambda^{-1/6}L^{2 /7}),\]

where the first inequality is due to Lemma C.1, and the second inequality is due to Lemmas G.2, G.3, and Lemma G.4. 

**Lemma G.2** (Lemma B.3 in [21] ).: _There exist constants \(\{C_{1},C_{2}\}\) such that for any \(\delta>0\), if we have_

\[\omega\leq C_{1}L^{-6}(\log m)^{-3/2},\]

_then with probability at least \(1-\delta\), for any \(\|\bm{\theta}-\bm{\theta}_{0}\|\leq\omega\) and for \(\bm{x}\in\{\mathcal{X}_{t}\}_{t=1}^{T}\) we have \(\|g(\bm{x};\bm{\theta})\|_{2}\leq C_{2}\sqrt{mL}\)._

**Proof.** In terms of the gradient upper bound, directly applying Lemma B.3 in [21] will give the desired result that \(\|g(\bm{x};\bm{\theta})\|_{2}\leq\mathcal{O}(\sqrt{mL})\). \(\Box\)

**Lemma G.3** (Lemma B.2 in [86] ).: _For the \(L\)-layer full-connected network \(f\) trained with \(J\) iterations of GD, there exist constants \(\{C_{i}\}_{i=1}^{5}\geq 0\) such that for \(\delta>0\), if for all \(t\in[T]\), \(\eta,m\) satisfy_

\[2\sqrt{t/(m\lambda)}\geq C_{1}m^{-3/2}L^{-3/2}[\log(TL^{2}/\delta )]^{3/2},\] \[2\sqrt{t/(m\lambda)}\leq C_{2}\min\{L^{-6}[\log m]^{-3/2},(m( \lambda)^{2}L^{-6}t^{-1}(\log m)^{-1})^{3/8}\},\] \[\eta\leq C_{3}(m\lambda+tmL)^{-1},\] \[m^{1/6}\geq C_{4}\sqrt{\log mL^{7/2}t^{7/6}\lambda^{-7/6}(1+ \sqrt{t/\lambda})},\]

_then, with probability at least \(1-\delta\), we have_

\[\|\bm{\theta}_{t}-\bm{\theta}_{0}\|\leq 2\sqrt{t/(m\lambda)}\] \[\|\bm{\theta}_{t}-\bm{\theta}_{0}-\bm{\bar{\Sigma}}_{t}^{-1}\bar{ \bm{b}}_{t}/\sqrt{m}\|\leq(1-\eta m\lambda)^{J/2}\sqrt{t/(m\lambda)}+C_{5}m^{- 2/3}\sqrt{\log mL^{7/2}t^{5/3}\lambda^{-5/3}(1+\sqrt{t/\lambda})}.\]

_where the unweighted regression parameters are \(\bm{\bar{\Sigma}}_{t}=\lambda\mathbf{I}+\sum_{\tau\in[t]}g(\bm{x}_{\tau};\bm{ \theta}_{\tau-1})g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})^{\intercal}/m\) and \(\bar{\bm{b}}_{t}=\sum_{\tau\in[t]}g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})r_{\tau }/\sqrt{m}\)._

**Lemma G.4** (Theorem 5 in [3]).: _With probability at least \(1-\delta\), there exist constants \(C_{1},C_{2}\) such that if \(\omega\leq C_{1}L^{-9/2}\log^{-3}m\), for \(\|\bm{\theta}_{t}-\bm{\theta}_{0}\|_{2}\leq\omega\), we have_

\[\|g(\bm{x};\bm{\theta}_{t})-g(\bm{x};\bm{\theta}_{0})\|_{2}\leq C_{2}\sqrt{ \log m}\omega^{1/3}L^{3}\|g(\bm{x};\bm{\theta}_{0})\|_{2}.\]

**Lemma G.5** (Lemma 4.1 in [21]).: _There exist constants \(\{\bar{C}_{i=1}^{3}\}\geq 0\) such that for any \(\delta\geq 0\), if \(\tau\) satisfies that_

\[\tau\leq\bar{C}_{2}L^{-6}[\log m]^{-3/2},\]

_then with probability at least \(1-\delta\), for all \(\bm{\theta}^{1},\bm{\theta}^{2}\) satisfying \(\|\bm{\theta}^{1}-\bm{\theta}_{0}\|\leq\tau,\|\bm{\theta}^{2}-\bm{\theta}_{0 }\|\leq\tau\) and for any \(\bm{x}\in\{\bm{x}_{t}\}_{t=1}^{T}\), we have_

\[|f(\bm{x};\bm{\theta}^{1})-f(\bm{x};\bm{\theta}^{2})-\langle(g(\bm{x};\bm{ \theta}^{2}),\bm{\theta}^{1}-\bm{\theta}^{2})\rangle|\leq\bar{C}_{3}\tau^{4/3 }L^{3}\sqrt{m\log m}.\]

**Lemma G.6**.: _Suppose \(m\) satisfies the conditions in Theorem 5.6. Suppose the gradient matrix can be represented by \(\bm{\Sigma}=\lambda\mathbf{I}+\sum_{t\in[T]}g(\bm{x}_{i,t};\bm{\theta}_{t-1}) \cdot g(\bm{x}_{i,t};\bm{\theta}_{t-1})^{\intercal}/m\), with an arbitrary arm \(\bm{x}_{i,t}\in\mathcal{X}_{t}\) from each time step \(t\). With probability at least \(1-\delta\) over the initialization, the following results hold:_

\[\|\bm{\Sigma}\|_{2} \leq\lambda+\mathcal{O}(TL),\] \[\|\bm{\Sigma}-\bm{\Sigma}^{(0)}\|_{F} \leq\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{7/6}\lambda^{-1/6})\] \[\|\log\frac{\det(\bm{\Sigma})}{\det(\lambda\mathbf{I})}-\log \frac{\det(\bm{\Sigma}^{(0)})}{\det(\lambda\mathbf{I})}\|_{F} \leq\mathcal{O}(m^{-1/6}\sqrt{\log(m)}L^{4}t^{5/6}\lambda^{-1/6}),\]

_where the gradient matrix defined based on randomly initialized parameters \(\bm{\theta}_{0}\) is \(\bm{\Sigma}^{(0)}=\lambda\mathbf{I}+\sum_{t\in[T]}g(\bm{x}_{i,t};\bm{\theta}_{ 0})\cdot g(\bm{x}_{i,t};\bm{\theta}_{0})^{\intercal}/m\)._

**Proof.** Based on the Lemma G.2, for any \(t\in[T]\), \(\|g(\bm{x}_{i,t};\bm{\Theta}_{0})\|_{2}\leq\mathcal{O}(\sqrt{mL})\). Then, for the first inequality:

\[\|\bm{\Sigma}^{(0)}\|_{2} =\|\lambda\mathbf{I}+\sum_{t=1}^{T}g(\bm{x}_{i,t};\bm{\Theta}_{0} )g(\bm{x}_{i,t};\bm{\Theta}_{0})^{\intercal}/m\|_{2}\] \[\leq\|\lambda\mathbf{I}\|_{2}+\|\sum_{t=1}^{T}g(\bm{x}_{i,t};\bm{ \Theta}_{0})g(\bm{x}_{i,t};\bm{\Theta}_{0})^{\intercal}/m\|_{2}\] \[\leq\lambda+\sum_{t=1}^{T}\|g(\bm{x}_{i,t};\bm{\Theta}_{0})/\sqrt {m}\|_{2}^{2}\leq\lambda+\mathcal{O}(TL).\]

Then, the second and third inequalities in this lemma are the direct application of Lemma B.3 of [86].

**Lemma G.7** (Lemma 11 in [1], Lemma B.7 in [86]).: _Suppose a sequence of arms \(\{\bm{x}_{\tau}^{\prime}\}_{\tau\in[t]}\), with an arbitrary arm \(\bm{x}_{\tau}^{\prime}\in\mathcal{X}_{\tau}\) from each time step \(\tau\in[t]\). The gradient matrix is denoted by \(\bm{\Sigma}_{t}=\lambda\mathbf{I}+\sum_{\tau\in[t]}g(\bm{x}_{\tau}^{\prime}; \bm{\theta}_{\tau-1})\cdot g(\bm{x}_{\tau}^{\prime};\bm{\theta}_{\tau-1})^{ \intercal}/m\), where \(\bm{\theta}_{\tau-1}\) refer to network parameters in round \(\tau\in[t]\). We can have_

\[\sum_{\tau\in[t]}\min\left\{\|g(\bm{x}_{\tau};\bm{\theta}_{\tau-1})/\sqrt{m}\| _{\bm{\Sigma}_{\tau-1}^{-1}}^{2},\ 1\right\}\leq 2\log\frac{\det(\bm{\Sigma}_{t})}{ \det(\lambda\mathbf{I})}.\]

### Auxiliary Lemma

**Lemma G.8** ((Corollary 7.7.4. (a) from [45]).: _Let \(\mathbf{A},\mathbf{B}\) be Hermitian matrices of the same shape, and suppose they are positive semi-definite. Then, we have \(\mathbf{A}\succeq\mathbf{B}\) iff \(\mathbf{A}^{-1}\preceq\mathbf{B}^{-1}\)._

### NeurIPS Paper Checklist

1. **Claims** Question: Do the main claims made in the abstract and introduction accurately reflect the paper's contributions and scope? Answer: [Yes] Justification: We have included discussion for our contributions in the Abstract and Introduction. Guidelines: * The answer NA means that the abstract and introduction do not include the claims made in the paper. * The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers. * The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings. * It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper.
2. **Limitations** Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] Justification: Please see appendix for the discussion of the limitation. Guidelines: * The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper. * The authors are encouraged to create a separate "Limitations" section in their paper. * The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be. * The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated. * The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon. * The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size. * If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness. * While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren't acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations.
3. **Theory Assumptions and Proofs** Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? Answer: [Yes]Justification: Please see theoretical analysis section and appendix for details. Guidelines: * The answer NA means that the paper does not include theoretical results. * All the theorems, formulas, and proofs in the paper should be numbered and cross-referenced. * All assumptions should be clearly stated or referenced in the statement of any theorems. * The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition. * Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material. * Theorems and Lemmas that the proof relies upon should be properly referenced.
4. **Experimental Result Reproducibility** Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? Answer: [Yes] Justification: Please see appendix and our submitted source code. Guidelines: * The answer NA means that the paper does not include experiments. * If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not. * If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable. * Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed. * While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example 1. If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. 2. If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. 3. If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). 4. We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results.
5. **Open access to data and code** Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material?Answer: [Yes] Justification: We include the source code along with our submission. Guidelines:

* The answer NA means that paper does not include experiments requiring code.
* Please see the NeurIPS code and data submission guidelines (https://nips.cc/public/guides/CodeSubmissionPolicy) for more details.
* While we encourage the release of code and data, we understand that this might not be possible, so "No" is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).
* The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https://nips.cc/public/guides/CodeSubmissionPolicy) for more details.
* The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.
* The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.
* At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).
* Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted.
6. **Experimental Setting/Details** Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? Answer: [Yes] Justification: We have shown our way of selecting the parameters and included the parameter study. Guidelines: * The answer NA means that the paper does not include experiments. * The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. * The full details can be provided either with the code, in appendix, or as supplemental material.
7. **Experiment Statistical Significance** Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? Answer: [Yes] Justification: Standard deviation is given for experiment results. Guidelines: * The answer NA means that the paper does not include experiments. * The authors should answer "Yes" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper. * The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions). * The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.) * The assumptions made should be given (e.g., Normally distributed errors).

* It should be clear whether the error bar is the standard deviation or the standard error of the mean.
* It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a 96% CI, if the hypothesis of Normality of errors is not verified.
* For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).
* If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text.
8. **Experiments Compute Resources** Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? Answer: [Yes] Justification: Please see appendix where we mention our system specifications. Guidelines: * The answer NA means that the paper does not include experiments. * The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage. * The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute. * The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn't make it into the paper).
9. **Code Of Ethics** Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? Answer: [Yes] Justification: We confirm this perform conform with the NeurIPS Code of Ethics. Guidelines: * The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics. * If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics. * The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction).
10. **Broader Impacts** Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? Answer: [Yes] Justification: We have included a subsection in appendix discussing this. Guidelines: * The answer NA means that there is no societal impact of the work performed. * If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact. * Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.

* The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.
* The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.
* If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML).
11. **Safeguards** Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? Answer: [NA] Justification: This paper is mainly about defensing adversarial attacks under neural bandit settings with no new datasets. Guidelines: * The answer NA means that the paper poses no such risks. * Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters. * Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images. * We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort.
12. **Licensees for existing assets** Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? Answer: [NA] Justification: We include the URLs for the datasets used instead. Guidelines: * The answer NA means that the paper does not use existing assets. * The authors should cite the original paper that produced the code package or dataset. * The authors should state which version of the asset is used and, if possible, include a URL. * The name of the license (e.g., CC-BY 4.0) should be included for each asset. * For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided. * If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset. * For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.

* If this information is not available online, the authors are encouraged to reach out to the asset's creators.
* **New Assets*
* Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? Answer: [NA] Justification: No new datasets are introduced. Guidelines:
* The answer NA means that the paper does not release new assets.
* Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.
* The paper should discuss whether and how consent was obtained from people whose asset is used.
* At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file.
* **Crowdsourcing and Research with Human Subjects*
* Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? Answer: [NA] Justification: No human subjects are involved. Guidelines:
* The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.
* Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.
* According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector.
* **Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects*
* Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? Answer: [NA] Justification: No human subjects are involved. Guidelines:
* The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.
* Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.
* We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.
* For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review.