# Unbiased Watermark for Large Language Models

Anonymous Author(s)

Affiliation

Address

email

###### Abstract

The recent advancements in large language models (LLMs) have sparked a growing apprehension regarding the potential misuse. One approach to mitigating this risk is to incorporate watermarking techniques into LLMs, allowing for the tracking and attribution of model outputs. This study examines a crucial aspect of watermarking: how significantly watermarks impact the quality of model-generated outputs. Previous studies have suggested a trade-off between watermark strength and output quality. However, our research demonstrates that it is possible to integrate watermarks without affecting the output probability distribution with appropriate implementation. We refer to this type of watermark as an **unbiased watermark**. This has significant implications for the use of LLMs, as it becomes impossible for users to discern whether a service provider has incorporated watermarks or not. Furthermore, the presence of watermarks does not compromise the performance of the model in downstream tasks, ensuring that the overall utility of the language model is preserved. Our findings contribute to the ongoing discussion around responsible AI development, suggesting that unbiased watermarks can serve as an effective means of tracking and attributing model outputs without sacrificing output quality.

## 1 Introduction

In recent years, large language models (LLMs) [19; 39; 40] have become an indispensable tool for a wide range of tasks, including text generation [27; 10], translation [7; 5], summarization [36], etc. With the escalating misuse of LLMs, such as plagiarism, tracking the usage of text generated by machines has become increasingly important. One viable method to monitor the usage of LLMs is watermarking [20; 32; 59], which embeds imperceptible information within the generated text, thereby allowing for efficient detection and tracking of the model's potential abuse.

Watermarking techniques can serve multiple purposes, such as embedding ownership information within the generated text to protect the intellectual property rights of the model. It can also help mitigate potential harm caused by LLMs by monitoring where the model is being used and whether it is being misused or abused.

A good watermarking method should not adversely affect the normal usage of the language model or degrade the quality of the generated text. However, a prevailing belief holds that there is an inevitable trade-off between the strength of the watermark and the quality of the output text. For instance, recent work by Kirchenbauer et al. [32] introduced a method that augmented the logits of a randomly selected set of "green" tokens. By tuning the "magnitude of logits adjustment", they demonstrated a trade-off between watermark strength and text quality.

Our primary contribution is to challenge this conventional wisdom. We show that with the right implementation, watermarking can be accomplished without affecting the output quality. We refer to this particular type of watermark as an **unbiased watermark**. We approach the problem of output quality degradation from the perspective of watermark detection. We posit that if the watermarkcauses a decline in output quality, there should be a method to guess the presence of the watermark based on the quality. Conversely, if the watermark cannot be detected, it implies that the output quality remains unaffected. Specifically, we provide a proof that with a suitable implementation, watermarking does not affect the output probability distribution. This has significant implications, as users who do not have the private key are unable to discern whether a service provider has applied watermarking to the model. Furthermore, the addition of watermarking does not affect the performance of the generated text in any downstream tasks. **Our main contributions can be summarized as follows:**

* We introduce _unbiased watermark_, an innovative family of watermark methods that guarantee the non-degradation of text quality. In addition, we offer a comprehensive framework that facilitates the design and detection of unbiased watermarks.
* We propose two innovative and practical watermarking techniques known as \(\delta\)-reweight and \(\gamma\)-reweight. Through extensive experimentation, we demonstrate that these techniques preserve output quality in machine translation and text summarization tasks.
* We develop an advanced maximin variant of the original log-likelihood ratio test for watermark detection. This novel detection method comes with theoretical guarantees, specifically an upper bound on type I error, thus enhancing the reliability of watermark detection in language models.

## 2 Preliminary

In this section, we delve into the problem of watermarking in the context of LLMs. We begin by setting up the problem and defining essential concepts.

**Problem Modeling:** We first introduce several notations to formalize the problem. Let \(\Sigma\) denote the vocabulary set, which is the set of all possible tokens an LLM can generate in a single step. We then define the set \(\Sigma^{*}\) as the collection of all possible strings of any length, including those of length zero.

An LLM generates a sequence of tokens conditioned on a given context. In a single step, the probability of generating the next token \(x_{n+1}\in\Sigma\) given the current context, \(x_{1},x_{2},...,x_{n}\), can be denoted as \(P_{M}(x_{n+1}\mid x_{1},x_{2},...,x_{n})\). The LLM operates in an autoregressive fashion, which means the joint probability of generating multiple tokens \(x_{n+1},\ldots,x_{n+m}\) can be written as:

\[P_{M}(x_{n+1},\ldots,x_{n+m}\mid x_{1},x_{2},...,x_{n})=\prod_{i=1}^{m}P_{M}(x _{n+i}\mid x_{1},x_{2},...,x_{n},x_{n+1},\ldots,x_{n+i-1}).\]

For simplicity, we use the following notation: \(P_{M}(\bm{x}_{n+1:n+m}\mid\bm{x}_{1:n})\), where \(\bm{x}_{n+1:n+m}=(x_{n+1},\ldots,x_{n+m})\in\Sigma^{*}\).

In the context of watermarking, we introduce a service provider that holds a private key \(k\) from the key space \(K\). The key \(k\in K\) is chosen at random from the prior distribution \(P_{K}(k)\). The watermarked output of the LLM follows distribution \(P_{M,w}(x_{n+1}\mid x_{1},x_{2},...,x_{n};k)\), which is conditioned on both the key \(k\) and the context \(\bm{x}_{1:n}\). Similarly, we use the notation \(P_{M,w}(\bm{x}_{n+1:n+m}\mid\bm{x}_{1:n};k)\) for the probability of generating a sequence of tokens in a watermarked model.

**Objective.** Our goal is to devise a watermarking scheme that: a) is efficiently detectable by the service provider; b) can't be detected by users and does not negatively impact the quality of the output.

The reason we focus on the detection of watermarks by users is that it is closely related to the output quality. If the watermark causes a degradation in the output quality, there should exist a method to infer the presence of the watermark by examining the quality. Conversely, if the watermark is undetectable, it implies that it does not impact the output quality.

From a statistical testing perspective, a watermark is considered strictly undetectable if the probability distributions of the watermarked and non-watermarked outputs are identical. To capture this notion, we define several desirable properties of watermarking schemes.

**Definition 1** (\(n\)-shot-undetectable).: _For a fixed input sequence \(\bm{a}\in\Sigma^{*}\), we say that watermarked LLM and key prior pair \((P_{M,w},P_{K})\) is \(n\)-shot-undetectable compared to original LLM \(P_{M}\) if_

\[\prod_{i=1}^{n}P_{M}(\bm{x}^{i}\mid\bm{a})=\sum_{k\in K}P_{K}(k)\prod_{i=1}^{ n}P_{M,w}(\bm{x}^{i}\mid\bm{a};k),\quad\text{for any $n$ number of strings $\bm{x}^{i}\in\Sigma^{*}$.}\]

**Definition 2** (downstream-invariant).: _We say the watermarked LLM and key prior pair \((P_{M,w},P_{K})\) are invariant compared to original LLM \(P_{M}\) on downstream tasks iff_

\[\mathbb{E}_{\bm{x}\sim P_{M,w}(:[\bm{a};\bm{k}),k)\sim P_{K}}[f(\bm{x})]=\mathbb{ E}_{\bm{x}\sim P_{M}(:[\bm{a}]}[f(\bm{x})],\]

_for any strings \(\bm{x},\bm{a}\in\Sigma^{*}\), and for any metric \(f:\Sigma^{*}\to\mathbb{R}\)._

Note that the one-shot-undetectable property implies the downstream invariant property. Interestingly, this implication does not require the \(n\)-shot-undetectable property for \(n>1\), which means a watermarking scheme that is one-shot-undetectable can still maintain the output quality for downstream tasks even if the user might discern the existence of the watermark through multiple generation requests.

In summary, we have outlined the preliminary concepts and objectives for developing a watermarking scheme for LLMs. We highlight the desired properties of \(n\)-shot-undetectability and downstream invariance, as they provide a rigorous theoretical guarantee of quality preservation and integrity in the deployment of watermark schema. In Section 4, we will present a watermark framework that is provably \(n\)-shot-undetectable for any given integer \(n\geq 1\).

## 3 Warm up: undetectability in a simplified toy environment

In this subsection, we aim to prove the feasibility of undetectability in a highly simplified toy environment. This preliminary analysis serves as a foundation for understanding the more complex scenarios that follow.

**Settings.** Consider a service provider that offers a random number generation service. The service outputs a uniformly distributed random number in the set \(\{0,1\}\). The clean generation process can be represented as \(P_{M}(x)=1/2,\ \forall x\in\{0,1\}\). We assume that the key \(k\) belongs to the set \(\{0,1\}\) and is selected with equal probability. With the watermark added, the probability of the new output can be expressed as: \(P_{M,w}(x\mid k)=\delta_{k}(x)\).

Recall that the one-shot-undetectable property can be represented as \(P_{M}(x)=\sum_{k\in K}P_{M,w}(x\mid k)P_{K}(k)\). Suppose that a user can only make a single request to the service. If the user is unaware of the key, the user will be unable to distinguish whether the received result is watermarked or not. Therefore, in this simplified scenario, the undetectability of the watermark is achieved.

However, there is a considerable gap between this toy example and the practical implementation of watermarking in LLMs. Firstly, the symbol set \(\Sigma\) in LLMs is far more complex than the binary set \(\{0,1\}\), and the probability distribution is not uniform. Besides, the generation process in LLMs is autoregressive, which means that more than one symbol are generated iteratively. Furthermore, the toy example does not satisfy the \(n\)-shot-undetectable property for \(n>1\).

Despite these differences, this simple example provides essential insights that help in understanding the following sections where we address these challenges. The underlying principles of undetectability remain constant, while their application becomes more intricate in a more complex environment.

## 4 Watermarking with unbiased reweighting

In this section, we build upon the intuition from the previous section and extend the approach to LLMs' generation. The section is structured as follows: Section 4.1 introduces a fundamental mathematical tool for addressing the reweighting problem in general discrete probability distributions. Section 4.2 applies the reweighting technique to LLMs. Section 4.3 presents the final framework.

### Distribution reweighting

In its most general form, we consider a random watermark code \(E\) and a reweight function \(R_{E}:\Delta_{\Sigma}\to\Delta_{\Sigma}\), which depends on the random watermark code \(E\). The set of all possible probability distributions on the symbol set \(\Sigma\) is denoted as \(\Delta_{\Sigma}\), which forms a simplex.

**Definition 3**.: _A **reweighting function** is a tuple \((\mathcal{E},P_{E},R)\) where \(\mathcal{E}\) is called the watermark code space, \(P_{E}\) is a probability distribution on space \(\mathcal{E}\), and \(R\) is a function \(R:\mathcal{E}\times\Delta_{\Sigma}\to\Delta_{\Sigma}\). For a specific watermark code \(E\in\mathcal{E}\), we denote the partially evaluated reweighting function as \(R_{E}:\Delta_{\Sigma}\to\Delta_{\Sigma}\)._

**Definition 4**.: _Given a random watermark code \(E\) and a reweighting function \(R_{E}:\Delta_{\Sigma}\to\Delta_{\Sigma}\), we say that \(R\) is an **unbiased reweighting function** if and only if for all \(P\in\Delta_{\Sigma}\), \(\mathbb{E}_{E}[R_{E}(P)]=P\)._

#### 4.1.1 Existing reweighting methods

Kirchenbauer et al. [32] essentially comprise two reweighting methods in their work, but neither of them satisfies the unbiased property.

Both methods have \(\mathcal{E}\) as the set of mappings \(f:\Sigma\to\{\text{red},\text{green}\}\), such that \(f\) maps half of the tokens in \(\Sigma\) to'red' and the other half to 'green', and \(P_{E}\) as a uniform distribution. Therefore, the random watermark code \(E\) assigns each symbol to either _red_ or _green_. The "Hard Red List" method sets the probability of all red symbols to zero and renormalizes the probabilities of the remaining vocabulary. The second method is "Soft Red List" blocking, where they randomly select the same "Red List" as the first method and decrease the corresponding probability for red symbols by adding a constant \(\delta\) to the logits of the green symbols, then apply softmax to obtain the final probabilities.

#### 4.1.2 Unbiased reweighting methods

In this section, we present two reweighting methods that satisfy the unbiased property.

\(\delta\)**-reweight:** Let the watermark code space \(\mathcal{E}\) be the interval \([0,1]\), and let \(P_{E}\) be the uniform probability on \(\mathcal{E}\). Leveraging _Inverse Transform Sampling1_[14], we can sample from distribution \(P\in\Delta_{\Sigma}\) using a uniformly distributed random number in \([0,1]\). Therefore, we have a mapping \(\textit{sampling}_{P}:\mathcal{E}\to\Sigma\). The \(\delta\)-reweight just returns a delta distribution \(R_{E}(P)=\delta_{\textit{sampling}_{P}(E)}\).

Footnote 1: Detailed definition and rigorous proof can be found in Appendix D

It is important to note that while the reweighted distribution for each individual random event \(E\) is a delta distribution, the mean output token probabilities remain the original distribution \(P\) when considering the randomness of \(E\).

\(\gamma\)**-reweight:** Let the watermark code space \(\mathcal{E}\) be the set of all bijective function between vocabularies set \(\Sigma\) and a set of indices \([|\Sigma|]=\{1,\dots,|\Sigma|\}\), where \(|\Sigma|\) is the size of vocabularies set \(\Sigma\). Essentially, any watermark code \(E\) is an indexing function for vocabularies set \(\Sigma\), and is also equivalent to a total order on \(\Sigma\). Let \(P_{E}\) be the uniform probability on \(\mathcal{E}\), it is easy to sample a watermark code \(E\) by randomly shuffling the symbol list.

Assume the original distribution is \(P_{T}(t)\in\Delta_{\Sigma},\forall t\in\Sigma\). Given the watermark code \(E:\Sigma\to[|\Sigma|]\), we construct auxiliary functions \(F_{I}(i)=\sum_{t\in\Sigma}\mathbf{1}(E(t)\leq i)P_{T}(t)\), \(F_{S}(s)=\max(2s-1,0)\), \(F_{I^{\prime}}(i)=F_{S}(F_{I}(i))\). The \(\gamma\)-reweight yields new distribution \(P_{T^{\prime}}(t)=F_{I^{\prime}}(E(t))-F_{I^{\prime}}(E(t)-1)\).

We provide illustrations of the \(\delta\)-reweight and \(\gamma\)-reweight methods in Figures 2 and 2. Each block represents a token, and the width represents the probability of that token, so the total length is 1 The left panel shows the \(\delta\)-reweight method, where each individual random watermark code \(E\in[0,1]\) uniformly sampled from interval \([0,1]\) corresponds to a specific token according to the horizontal axis, and the reweighted distribution is just a \(\delta\) distribution on that token, such that the selected token has 1 probability, and all other vocabulary tokens have a probability of \(0\). The right panel demonstrates the \(\gamma\)-reweight method. First, the symbol set is shuffled. Then, the left half of the regions are rejected, and the remaining regions are amplified with a factor of 2.

Both methods are unbiased1 when considering the randomness of the watermark code \(E\). For \(\delta\)-reweight, we can see that by noticing that the probability of returning a \(\delta\) distribution on a token isjust the original probability on that token, therefore the weighted average of all delta distributions is still the original probability. In the case of \(\gamma\)-reweight, although certain regions are rejected and the other regions are amplified, every token has the same probability to be in the rejected or amplified region, thus ensuring the unbiased property.

### Reweighting for autoregressive model

The reweighting methods presented in the previous section can be applied to single token-generation directly. Given a prefix \(\bm{x}_{1:n}\), the probability distribution for generating a new token without a watermark is denoted as \(P_{M}(\cdot|\bm{x}_{1:n})\in\Delta_{\Sigma}\). For a random watermark code \(E\), we sample from a new distribution \(P_{M,w}(\cdot|\bm{x}_{1:n})=R_{E}(P_{M}(\cdot|\bm{x}_{1:n}))\in\Delta_{\Sigma}\). If the reweighting function is unbiased, we have \(\mathbb{E}_{E}[R_{E}(P_{M}(\cdot|\bm{x}_{1:n}))]=P_{M}(\cdot|\bm{x}_{1:n})\). This ensures that, for an individual unaware of the watermark code, it is impossible to determine whether a new token is sampled directly from \(P_{M}(\cdot|\bm{x}_{1:n})\) or from \(P_{M,w}(\cdot|\bm{x}_{1:n};E)\) for a random watermark \(E\). However, if the watermark code is known, one can perform statistical hypothesis testing to determine the likelihood of a token being sampled from either distribution.

The main challenge now is constructing the watermark code \(E\). Since the LLM generation task is autoregressive, multiple reweighting steps are required, with each step needing a watermark code \(E_{i}\) for reweighting the distribution of token \(x_{i}\).

#### 4.2.1 Independence of watermark codes

It is crucial that \(E_{i}\) values are independent to ensure the unbiased nature of the entire sequence, rather than just the single-token generation process.

**Theorem 5**.: _Given an unbiased reweighting function \((\mathcal{E},P_{E},R)\), if \(E_{i}\) values are i.i.d. with the distribution \(P_{E}\), we have: \(\mathbb{E}_{E_{1},...,E_{n}}[P_{M,w}(\bm{x}_{1:n}|\bm{a}_{1:m})]=P_{M}(\bm{x}_ {1:n}|\bm{a}_{1:m})\)._

If the \(E_{i}\) values are not independent, we cannot guarantee that the generation probability of the entire sequence remains unbiased. As an extreme example, consider a case where all \(E_{i}\) values are identical. Referring to the random bit example in the previous section, assume that the correct distribution is a sequence where each token is a random 0 or 1 with equal probability. Identical \(E_{i}\) values would result in identical token outputs, ultimately producing sequences consisting solely of 0's or 1's, which is clearly biased.

#### 4.2.2 Context code

To construct a large number of independent watermark codes \(E_{i}\) during watermarking and to know the used \(E_{i}\) values during watermark detection, we follow an approach similar to Kirchenbauer et al. [32] by combining the information from the prefix and a secret key to construct \(E_{i}\).

For a single token generation process, given a prefix \(x_{1},x_{2},...,x_{n}\), we consider an abstract context code space \(C\) and an abstract context code generation function \(cc:\Sigma^{*}\to C\). Based on the prefix, we construct the context code \(c_{n+1}=cc(x_{1},x_{2},...,x_{n})\). Specific examples include using the entire prefix \(c_{n+1}=(x_{1},x_{2},...,x_{n})\), and using the \(m\) most recent prefixes \(c_{n+1}=(x_{n-m+1},...,x_{n})\). Our comprehensive framework accommodates diverse context code generation approaches, particularly those that integrate error-correcting mechanisms to augment watermark resilience in the face of text manipulation attacks. Nevertheless, we refrain from delving into these strategies within the confines of this paper and consider it a subject for subsequent investigation.

The final watermark code is defined as \(E_{i}=\hat{E}(c_{i},k)\), using a watermark code generation function \(\hat{E}:C\times K\rightarrow\mathcal{E}\).

**Definition 6**.: _Given an unbiased reweighting function \((\mathcal{E},P_{E},R)\) and a context code space \(C\), an **unbiased watermark code generation function** is a tuple \((\mathcal{E},P_{E},R,C,K,P_{K},\hat{E})\) that satisfies:_

1. _Unbiasedness:_ \(\mathbb{E}_{k\sim P_{K}}[R_{\hat{E}(c,k)}(P)]=P,\forall P\in\Delta_{\Sigma}, \forall c\in C\)_._
2. _Independence: For any_ \(n\) _distinct_ \(c_{1},\dots,c_{n}\in C\)_, the values_ \(R_{\hat{E}(c_{i},k)}(P)\) _are mutually independent._

**Theorem 7**.: _For any unbiased reweighting function and context code space, an unbiased watermark code generation function always exists._

In practice, pseudorandom numbers can be used to implement the unbiased watermark code generation function in the above theorem. Specifically, the hash value \(\mathrm{hash}(c,k)\) can be used as a random seed to sample \(E\) from \(P_{E}\) as an implementation of \(E=\hat{E}(c,k)\). In this paper, we employ SHA-256 for hash function and a 1024-bit random bitstring as the key \(k\).

An unbiased watermark code generation function ensures that watermark codes \(E_{i}\) are independent with each other if only their context codes are different. During the generation of a sequence, context codes may be repeated, although this is a rare event in practice. If \(c_{i}\) and \(c_{j}\) are equal, then \(E_{i}\) and \(E_{j}\) are also equal, violating the independence of \(E_{i}\). A simple workaround is to skip reweighting for a token when encountering a previously used context code. In other words, we set \(P_{M,w}(\cdot|\bm{a}_{1:m},\bm{x}_{1:i-1})=P_{M}(\cdot|\bm{a}_{1:m},\bm{x}_{1:i -1})\) if the context code has appeared before.

### Framework

```
1:Input: key for watermark \(k\in K\), prompt \(\bm{a}_{1:m}\in\Sigma^{*}\), generate length \(n\in\mathbb{N}\), initial code history \(cch\in 2^{C}\), context code function \(cc:\Sigma^{*}\to C\), watermark code generation function \(\hat{E}:C\times K\rightarrow\mathcal{E}\), and reweighting function \(R:\mathcal{E}\times\Delta_{\Sigma}\rightarrow\Delta_{\Sigma}\).
2:for\(t=1,\ldots,n\)do
3:\(P_{i}\gets P_{M}(\cdot\mid\bm{a}_{1:m},\bm{x}_{1:i-1})\)\(\triangleright\) original distribution
4:\(\bm{c}_{i}\gets cc(\cdot\mid\bm{a}_{1:m},\bm{x}_{1:i-1})\)\(\triangleright\) context code
5:if\(\bm{c}_{i}\in cch\)then
6:\(Q_{i}\gets P_{i}\)\(\triangleright\) skip the reweighting
7:else
8:\(cch\gets cch\cup\{c_{i}\}\)\(\triangleright\) record history
9:\(E_{i}\leftarrow\hat{E}(c_{i},k)\)\(\triangleright\) watermark code
10:\(Q_{i}\gets R_{E_{i}}(P_{i})\)\(\triangleright\) reweighted distribution
11: Sample the next token \(x_{i}\) using distribution \(Q_{i}\)
12:return\(\bm{x}_{1:n}\) ```

**Algorithm 1** Watermarking framework

Integrating the tools discussed earlier, we present a general framework for watermarking here. The algorithm for this framework is outlined in Algorithm 1.

We note that our abstract framework requires the specification of two key components in order to be practically implemented: the unbiased reweight function \(R_{E}\) and the context code function \(cc\).

## 5 Statistical hypothesis testing for watermark detection

In the previous section, we discussed the process of adding a watermark to a text based on a secret key \(k\) and a given prompt \(\bm{a}_{1:m}\). The watermark-embedded text can be sampled from the distribution \(P_{M,w}(\bm{x}_{1:n}|\bm{a}_{1:m};k)\). In this section, we focus on the watermark detection task, which is the inverse problem of watermark embedding.

Given a text \(\bm{x}_{1:n}\), the goal of watermark detection is to infer whether it is more likely to be generated from the unmarked distribution \(P_{M}(\bm{x}_{1:n}|\bm{a}_{1:m})\) or the marked distribution \(P_{M,w}(\bm{x}_{1:n}|\bm{a}_{1:m};k)\). This problem can be formulated as a statistical hypothesis test between two competing hypotheses: \(H_{0}\), which posits that \(\bm{x}_{1:n}\) follows the unmarked distribution, and \(H_{1}\), which posits that \(\bm{x}_{1:n}\) follows the marked distribution.

### Score-based testing

We focus on a particular kind of score-based testing, which assigns a score to each token in the text. The score can be interpreted as the confidence that the token was generated by the watermark model rather than the original model. Scores \(s_{i}\) can be computed based on \(\bm{x}_{1:i}\), in accordance with the autoregressive manner of the generation process.

The total score \(S\) is given by \(S=\sum_{i=1}^{n}s_{i}\). A threshold \(\hat{S}\) is set such that if \(S<\hat{S}\), the null hypothesis \(H_{0}\) is accepted, indicating insufficient evidence to conclude that the text contains a watermark. Otherwise, the null hypothesis is rejected. There are two types of error probabilities associated with this decision process: Type I error, which is the probability of incorrectly rejectingthe null hypothesis under \(H_{0}\), denoted as \(P_{H_{0}}(S\geq\hat{S})\), and Type II error, which is the probability of incorrectly accepting the null hypothesis under \(H_{1}\), denoted as \(P_{H_{1}}(S<\hat{S})\).

To derive theoretical results, we require the scores to have a specific property: under the null hypothesis \(H_{0}\), the exponential momentum of \(s_{i}\) is bounded, conditioned on the preceding context \(\bm{x}_{1,i-1}\). This requirement leads to an upper bound on \(\alpha\), the Type I error probability.

To derive theoretical results, we require that the scores have a particular property: the exponential moment of \(s_{i}\) under \(H_{0}\) should be bounded, conditioned on the previous text \(\bm{x}_{1,i-1}\). This requirement leads to an upper bound on the Type I error rate.

**Theorem 8**.: _Given a probability space \((\Omega,\mathcal{A},P)\) and a \(\Sigma\)-valued stochastic process \(x_{i}:1\leq i\leq n\), as well as an \(\mathbb{R}\)-valued stochastic process \(s_{i}:1\leq i\leq n\), let \(\mathcal{F}_{i}^{x}:=\sigma(x_{j}\mid 1\leq j\leq i)\) and \(\mathcal{F}_{i}^{s}:=\sigma(s_{j}\mid 1\leq j\leq i)\) be the corresponding filtrations, where \(\sigma(\cdot)\) denotes the \(\sigma\)-algebra generated by random variables. If \(\mathcal{F}_{i}^{s}\subseteq\mathcal{F}_{i}^{x}\) and \(\mathbb{E}[\exp(s_{i})|\mathcal{F}_{i-1}^{x}]\leq 1\), then \(P(\sum_{i=1}^{n}s_{i}\geq t)\leq e^{-t}\)._

Therefore, to ensure that the Type I error probability has an upper bound \(\alpha\), we can set the threshold \(\hat{S}\) as \(\hat{S}=-\log(\alpha)\). In the following, we discuss two special scores.

### Log likelihood ratio (LLR) score

According to the Neyman-Pearson lemma, the likelihood ratio test is the most powerful test among all tests with the same Type I error rate. Specifically, the log-likelihood ratio (LLR) score is defined as \(s_{i}=\log\frac{P_{M,w}(x_{i}|\bm{a}_{1:m},\bm{x}_{1:i-1};k)}{P_{M}(x_{i}|\bm {a}_{1:m},\bm{x}_{1:i-1})}\), and the total score becomes \(S=\log\frac{P_{M,w}(\bm{x}_{1:m}|\bm{a}_{1:m};k)}{P_{M}(\bm{x}_{1:m}|\bm{a}_{1 :m})}\).

We now provide an optimization derivation of the above \(s_{i}\) to gain intuition and set the foundation for the maximum variant of the LLR score in the next section. Let \(P_{i}=P_{M}(\cdot|\bm{a}_{1:m},\bm{x}_{1:i-1})\), \(Q_{i}=P_{M,w}(\cdot|\bm{a}_{1:m},\bm{x}_{1:i-1};k)\), and let \(s_{i}=S_{i}(x_{i})\in\mathbb{R}\) denote the score corresponding to different \(x_{i}\). Note that \(P_{i}\), \(Q_{i}\), and \(S_{i}\) are all functions with signature \(\Sigma\to\mathbb{R}\), therefore equivalent to vectors of dimension \(|\Sigma|\). We can define the inner product as \(\langle P_{i},S_{i}\rangle=\sum_{x\in\Sigma}P_{i}(x)S_{i}(x)\).

The requirement \(\mathbb{E}[\exp(s_{i})|\mathcal{F}_{i-1}^{x}]\leq 1\) can be reformulated as \(\langle P_{i},\exp(S_{i})\rangle\leq 1\), where the exponential function is applied element-wise. Instead of minimizing the Type II error directly, we aim to maximize the average score under \(H_{1}\), i.e., \(\langle Q_{i},S_{i}\rangle\).

The optimization problem becomes \(\max_{S_{i}}\,\langle Q_{i},S_{i}\rangle,\ s.t.\,\langle P_{i},\exp(S_{i}) \rangle\leq 1\). The optimal solution is given by \(S_{i}(x)=\log\frac{Q_{i}(x)}{P_{i}(x)}\), which recovers the optimal log likelihood ratio score.

### Maximin variant of LLR score

One major limitation of the LLR score described in the previous section is that when \(Q_{i}(x)=0\), \(S_{i}(x)=-\infty\). This means that as long as a single token does not come from the watermark model \(P_{M,w}\), the score becomes negative infinity, making it impossible to reject the null hypothesis \(H_{0}\).

A more general reason for this issue is that the watermark model \(P_{M,w}\) used in the detection process may not exactly match the true distribution of the watermarked text. In practice, potential sources of discrepancy include editing (e.g., a text sampled from \(P_{M,w}\) may undergo some degree of editing before being watermark detection) and imperfect estimation of the generation process (e.g., due to lack of knowledge of the exact prompt and temperature used during generation).

To address this problem, we consider a perturbed generation distribution. Instead of the original hypothesis \(H_{1}\), where \(\bm{x}_{1:n}\) follows the watermark distribution \(P_{M,w}\), we now assume that \(\bm{x}_{1:n}\) follows a distribution \(P_{M,w}^{\prime}\), which is similar to but not identical to \(P_{M,w}\). Specifically, during the generation of each token, the total variation (TV) distance between \(Q_{i}^{\prime}\) and \(Q_{i}\) is bounded by \(d\).

The corresponding new optimization problem is

\[\max_{S_{i}}\ \min_{Q_{i}^{\prime}\in\Delta_{\Sigma},TV(Q_{i}^{\prime},Q_{i}) \leq d}\ \ \ \langle Q_{i}^{\prime},S_{i}\rangle,\ \ \ s.t.\,\langle P_{i},\exp(S_{i})\rangle\leq 1.\]

Intuitively, the optimal solution for \(Q_{i}^{\prime}\) in the inner optimization decreases \(Q_{i}^{\prime}(x)\) when \(S_{i}(x)\) is large and increases \(Q_{i}^{\prime}(x)\) when \(S_{i}(x)\) is small.

The computation of the maximin solution can be done efficiently in \(\widetilde{O}(|\Sigma|)\) time and the specific algorithm is shown in Appendix C.

It is important to note that the maximin variant of the LLR score is more robust than the standard LLR score, as it yields higher scores when the text has undergone some degree of editing. However, it is not specifically designed to defend against any attacks.

A hyperparameter \(d\in[0,1]\) that represent the perturbation strength is introduced in the score. Intuitively, if the text to be detected has undergone more editing and deviates further from the distribution \(P_{M,w}\), \(d\) should be larger. In practice, we recommend using grid search to select the best value of \(d\). Assuming there are \(A\) candidate values for \(d\), corresponding to \(A\) different scores \(s_{i}^{(a)}\) (\(1\leq a\leq A\)), we can modify Theorem 8 as follows.

**Theorem 9**.: _Under the same conditions as Theorem 8, but with multiple scores \(s_{i}^{(a)}\), we have_

\[P\left(\max_{1\leq a\leq A}\left(\sum_{i=1}^{n}s_{i}^{(a)}\right)\geq t\right) \leq Ae^{-t}.\]

Thus, when using grid search, the final threshold should be adjusted as \(\hat{S}=-\log(\alpha)+\log(A)\). This ensures that the upper bound of the type I error is still \(\alpha\).

## 6 Experiments

We evaluate the performance of our Unbiased Watermarks on two important applications of seq2seq models: text summarization (TS) and machine translation (MT). For the TS task, we use the BART-large model [37] and the CNN-DM [25] corpus as our training dataset. The MT task involves translating English to Romanian, for which we employ the Multilingual BART (MBart) [37] model on the WMT'14 En-Ro corpus. For further details on the experiment setup, please refer to Appendix E.

Our primary focus is to compare the performance of our proposed unbiased watermarking methods including the \(\delta\)-reweight and \(\gamma\)-reweight, with the soft-red-list method presented by Kirchenbauer et al. [32]. The strength of the watermark in the soft-red-list approach is controlled by a parameter \(\delta\).

The quality of output post-watermarking is presented in Table 1. We observed that the output quality remains unaffected by our unbiased watermark methods, both for the \(\delta\)-reweight and \(\gamma\)-reweight,

\begin{table}
\begin{tabular}{c|c|c|c|c|c} \hline  & \multicolumn{4}{c|}{Text summarization} & \multicolumn{2}{c}{Machine translation} \\  & BERTScore \(\uparrow\) & ROUGE-1 \(\uparrow\) & Perplexity \(\downarrow\) & BERTScore \(\uparrow\) & BLEU \(\uparrow\) \\ \hline No Watermark & \(32.70\pm 0.08\) & \(38.56\pm 0.09\) & \(5.024\pm 0.018\) & \(55.9\pm 0.3\) & \(21.8\pm 0.3\) \\ \(\delta\)-reweight & \(32.71\pm 0.08\) & \(38.57\pm 0.09\) & \(5.022\pm 0.018\) & \(56.3\pm 0.3\) & \(21.7\pm 0.3\) \\ \(\gamma\)-reweight & \(32.69\pm 0.08\) & \(38.60\pm 0.09\) & \(5.019\pm 0.018\) & \(56.2\pm 0.3\) & \(21.8\pm 0.3\) \\ Soft(\(\delta\)=0.0) & \(32.70\pm 0.08\) & \(38.56\pm 0.09\) & \(5.024\pm 0.018\) & \(55.9\pm 0.3\) & \(21.8\pm 0.3\) \\ Soft(\(\delta\)=1.0) & \(32.35\pm 0.08\) & \(38.20\pm 0.09\) & \(5.313\pm 0.018\) & \(55.1\pm 0.3\) & \(21.0\pm 0.3\) \\ Soft(\(\delta\)=2.0) & \(31.21\pm 0.08\) & \(37.17\pm 0.08\) & \(6.253\pm 0.022\) & \(53.8\pm 0.3\) & \(19.5\pm 0.3\) \\ \hline \end{tabular}
\end{table}
Table 1: Performance of different watermarking methods on TS and MT. We use F1 scores of BERTScore and scale BERTScore and ROUGE-1 with a factor of 100.

Figure 3: Distribution of perplexity of output for TS and BLEU score for MT.

irrespective of the task and metric. Conversely, the soft-red-list method, when \(\delta=0\), does not introduce any watermark and hence does not affect output quality. However, for \(\delta>0\), it significantly deteriorate the quality of output.

Figure 3 provides a more intuitive depiction of the score distributions. It is evident that our unbiased watermark methods not only ensure that the mean performance remains unaffected but also that the performance distribution is stable. Conversely, the soft-red-list method shows a notable performance decrease.

In terms of watermark detection, we compute score associated with each token. The mean and variance of score per token for TS and MT are presented in Table 2. As a heuristic, if the sum of the scores for all tokens in a sentence reaches \(10\), a p-value of less than \(0.0005\) is ensured. If the sum score hits \(20\), the p-value must be less than \(3\mathrm{e}{-8}\).

Additionally, we provide an example of watermarking applied to a completion task in Table 3. It visually demonstrates the score distribution across tokens: positive scores are represented in green, and negative ones in red. The intensity of the color corresponds to the magnitude of the score, with darker shades representing larger absolute values.

## 7 Related work

The idea of watermarking text has been widely explored by many researchers [11; 31; 44; 45; 4; 28; 49; 43], even before the advent of large language models. Several techniques involve editing existing text to add a watermark, such as changing synonyms [54; 57; 9; 59; 66] or visually indistinguishable words [46], altering sentence structures [56; 55; 38], and employing neural networks [22; 23; 67].

Recent advancements in generative models have opened new possibilities for directly generating watermarked results. Two relevant works in this domain are by Kirchenbauer et al. [32] and Aaronson [1]. Due to space constraints, we moved the in-depth analysis and other related work to Section B.

## 8 Conclusion

Overall, this paper provides a novel framework of watermarking for language models, demonstrating that it is possible to use watermark to protect intellectual property and monitor potential misuse without compromising the quality of the generated text. This research serves as a valuable foundation for future work in the field of watermarking for large language models.

\begin{table}
\begin{tabular}{l c c} \hline \hline  & Text summarization & Machine translation \\ \hline \(\delta\)-RW & \(0.8784\pm 1.4354\) & \(0.4192\pm 1.1361\) \\ \(\gamma\)-RW & \(0.2207\pm 0.3678\) & \(0.1056\pm 0.2916\) \\ \hline \hline \end{tabular}
\end{table}
Table 2: Mean and variance of score per token for different reweighting methods and different tasks.

\begin{table}
\begin{tabular}{l l l} \hline \hline Prompt & What is a watermark? What’s the purpose of it? & score p-value2  \\ \hline NW & Why don’t you want it on there? I’m confused..nl think he meant to say logo, since he wrote ”watermark”, so the firstword must be à typo.unYes! Exactly typo, Sorry, English is not my native language.. Thanks for the explanation! \\ \hline \(\delta\)-RW & ufliss supposed to be watermarking the pictures that you don’t, with your phone, think So, so you can share your pictures and not take credit for them! \\ \hline \(\gamma\)-RW & ufliss watermark is à small image or logo (often in square pixels) that is placed over the larger, original image! It serves primarily to distinguish copyright or ownership of large images(such as banners and logos) and, on rare occasion, to identify small images(such as l thumbtail images(for blog posts and pictures)) & \(75.9\)\(1.2\mathrm{e}{-32}\) \\ \hline \hline \end{tabular}
\end{table}
Table 3: Text sampled from OPT-6.7B, with and without watermarks. For ’No watermark” (NW), the score is computed based on \(\delta\)-reweight. When watermarks are included, the corresponding reweighting function is used for computing score. The optimal perturbation strengths \(d\) obtained by grid search are \(0.9,0.0,0.0\) for three outputs respectively.

## References

* Aaronson [2022] Scott Aaronson. My ai safety lecture for ut effective altruism. November 2022. URL https://scottaaronson.blog/?p=6823.
* Abdelnabi and Fritz [2021] Sahar Abdelnabi and Mario Fritz. Adversarial watermarking transformer: Towards tracing text provenance with data hiding. In _2021 IEEE Symposium on Security and Privacy (SP)_, pages 121-140. IEEE, 2021.
* Adi et al. [2018] Yossi Adi, Carsten Baum, Moustapha Cisse, Benny Pinkas, and Joseph Keshet. Turning your weakness into a strength: Watermarking deep neural networks by backdooring. In _27th USENIX Security Symposium_, pages 1615-1631, 2018.
* Atallah et al. [2001] Mikhail J Atallah, Victor Raskin, Michael Crogan, Christian Hempelmann, Florian Kerschbaum, Dina Mohamed, and Sanket Naik. Natural language watermarking: Design, analysis, and a proof-of-concept implementation. In _Information Hiding: 4th International Workshop, IH 2001 Pittsburgh, PA, USA, April 25-27, 2001 Proceedings 4_, pages 185-200. Springer, 2001.
* Barrault et al. [2019] Loic Barrault, Ondrej Bojar, Marta R. Costa-jussa, Christian Federmann, Mark Fishel, Yvette Graham, Barry Haddow, Matthias Huck, Philipp Koehn, Shervin Malmasi, Christof Monz, Mathias Muller, Santanu Pal, Matt Post, and Marcos Zampieri. Findings of the 2019 conference on machine translation (WMT19). In _Proceedings of the Fourth Conference on Machine Translation (Volume 2: Shared Task Papers, Day 1)_, pages 1-61, Florence, Italy, August 2019. Association for Computational Linguistics. doi: 10.18653/v1/W19-5301.
* Boenisch [2021] Franziska Boenisch. A systematic review on model watermarking for neural networks. _Frontiers in big Data_, 4:729663, 2021.
* Bojar et al. [2017] Ondrej Bojar, Rajen Chatterjee, Christian Federmann, Yvette Graham, Barry Haddow, Shujian Huang, Matthias Huck, Philipp Koehn, Qun Liu, Varvara Logacheva, Christof Monz, Matteo Negri, Matt Post, Raphael Rubino, Lucia Specia, and Marco Turchi. Findings of the 2017 conference on machine translation (WMT17). In _Proceedings of the Second Conference on Machine Translation_, pages 169-214, Copenhagen, Denmark, September 2017. Association for Computational Linguistics. doi: 10.18653/v1/W17-4717.
* Boucher et al. [2022] Nicholas Boucher, Ilia Shumailov, Ross Anderson, and Nicolas Papernot. Bad characters: Imperceptible nlp attacks. In _2022 IEEE Symposium on Security and Privacy (SP)_, pages 1987-2004. IEEE, 2022.
* Chiang et al. [2004] Yuei-Lin Chiang, Lu-Ping Chang, Wen-Tai Hsieh, and Wen-Chih Chen. Natural language watermarking using semantic substitution for chinese text. In _Digital Watermarking: Second International Workshop, IWDW 2003, Seoul, Korea, October 20-22, 2003. Revised Papers 2_, pages 129-140. Springer, 2004.
* Chung et al. [2022] Hyung Won Chung, Le Hou, Shayne Longpre, Barret Zoph, Yi Tay, William Fedus, Eric Li, Xuezhi Wang, Mostafa Dehghani, Siddhartha Brahma, et al. Scaling instruction-finetuned language models. _arXiv preprint arXiv:2210.11416_, 2022.
* Cox et al. [2007] Ingemar Cox, Matthew Miller, Jeffrey Bloom, Jessica Fridrich, and Ton Kalker. _Digital watermarking and steganography_. Morgan kaufmann, 2007.
* Crothers et al. [2022] Evan Crothers, Nathalie Japkowicz, and Herna Viktor. Machine generated text: A comprehensive survey of threat models and detection methods. _arXiv preprint arXiv:2210.07321_, 2022.
* Dai and Cai [2019] Falcon Z Dai and Zheng Cai. Towards near-imperceptible steganographic text. _arXiv preprint arXiv:1907.06679_, 2019.
* Devroye [1986] Luc Devroye. _Non-Uniform Random Variate Generation_. Springer New York, 1986.
* Fang et al. [2017] Tina Fang, Martin Jaggi, and Katerina Argyraki. Generating steganographic text with lstms. _arXiv preprint arXiv:1705.10742_, 2017.
* Gabrilovich and Gontmakher [2002] Evgeniy Gabrilovich and Alex Gontmakher. The homograph attack. _Communications of the ACM_, 45(2):128, 2002.
* Gambini et al. [2022] Margherita Gambini, Tiziano Fagni, Fabrizio Falchi, and Maurizio Tesconi. On pushing deepfake tweet detection capabilities to the limits. In _14th ACM Web Science Conference 2022_, pages 154-163, 2022.
* Goodside [2023] Riley Goodside. There are adversarial attacks for that proposal as well -- in particular, generating with emojis after words and then removing them before submitting defeats it,. January 2023. URL https://twitter.com/goodside/status/1610682909647671306.
* Palm-2-llm [2023] Google. Palm-2-llm. _https://blog.google/technology/ai/google-palm-2-ai-large-language-model/_, 2023.
* Gontmakher et al. [2019]* [20] Chenxi Gu, Chengsong Huang, Xiaoqing Zheng, Kai-Wei Chang, and Cho-Jui Hsieh. Watermarking pre-trained language models with backdooring. _arXiv preprint arXiv:2210.07543_, 2022.
* [21] Tianyu Gu, Brendan Dolan-Gavitt, and Siddharth Garg. Badnets: Identifying vulnerabilities in the machine learning model supply chain. _arXiv preprint arXiv:1708.06733_, 2017.
* [22] Xuanli He, Qiongkai Xu, Lingjuan Lyu, Fangzhao Wu, and Chenguang Wang. Protecting intellectual property of language generation apis with lexical watermark. In _Proceedings of the AAAI Conference on Artificial Intelligence_, volume 36, pages 10758-10766, 2022.
* [23] Xuanli He, Qiongkai Xu, Yi Zeng, Lingjuan Lyu, Fangzhao Wu, Jiwei Li, and Ruoxi Jia. Cater: Intellectual property protection on text generation apis via conditional watermarks. _arXiv preprint arXiv:2209.08773_, 2022.
* [24] James N Helfrich and Rick Neff. Dual canonicalization: An answer to the homograph attack. In _2012 eCrime Researchers Summit_, pages 1-10. IEEE, 2012.
* [25] Karl Moritz Hermann, Tomas Kocisky, Edward Grefenstette, Lasse Espeholt, Will Kay, Mustafa Suleyman, and Phil Blunsom. Teaching machines to read and comprehend. In Corinna Cortes, Neil D. Lawrence, Daniel D. Lee, Masashi Sugiyama, and Roman Garnett, editors, _Advances in Neural Information Processing Systems 28: Annual Conference on Neural Information Processing Systems 2015, December 7-12, 2015, Montreal, Quebec, Canada_, pages 1693-1701, 2015.
* [26] Daphne Ippolito, Daniel Duckworth, Chris Callison-Burch, and Douglas Eck. Automatic detection of generated text is easiest when humans are fooled. _arXiv preprint arXiv:1911.00650_, 2019.
* [27] Srinivasan Iyer, Xi Victoria Lin, Ramakanth Pasunuru, Todor Mihaylov, Daniel Simig, Ping Yu, Kurt Shuster, Tianlu Wang, Qing Liu, Punit Singh Koura, et al. Opt-iml: Scaling language model instruction meta learning through the lens of generalization. _arXiv preprint arXiv:2212.12017_, 2022.
* [28] Zunera Jalil and Anwar M Mirza. A review of digital watermarking techniques for text documents. In _2009 International Conference on Information and Multimedia Technology_, pages 230-234. IEEE, 2009.
* [29] Ganesh Jawahar, Muhammad Abdul-Mageed, and Laks VS Lakshmanan. Automatic detection of machine generated text: A critical survey. _arXiv preprint arXiv:2011.01314_, 2020.
* [30] Hengrui Jia, Christopher A Choquette-Choo, Varun Chandrasekaran, and Nicolas Papernot. Entangled watermarks as a defense against model extraction. In _USENIX Security Symposium_, pages 1937-1954, 2021.
* [31] Nurul Shamimi Kamaruddin, Amirrudin Kamsin, Lip Yee Por, and Hameedur Rahman. A review of text watermarking: theory, methods, and applications. _IEEE Access_, 6:8011-8028, 2018.
* [32] John Kirchenbauer, Jonas Geiping, Yuxin Wen, Jonathan Katz, Ian Miers, and Tom Goldstein. A watermark for large language models. _arXiv preprint arXiv:2301.10226_, 2023.
* [33] Kalpesh Krishna, Yixiao Song, Marzena Karpinska, John Wieting, and Mohit Iyyer. Paraphrasing evades detectors of ai-generated text, but retrieval is an effective defense. _arXiv preprint arXiv:2303.13408_, 2023.
* [34] Zheng Li, Chengyu Hu, Yang Zhang, and Shanqing Guo. How to prove your model belongs to you: A blind-watermark based framework to protect intellectual property of dnn. In _Proceedings of the 35th Annual Computer Security Applications Conference_, pages 126-137, 2019.
* [35] Chin-Yew Lin. Rouge: A package for automatic evaluation of summaries. In _Text summarization branches out_, pages 74-81, 2004.
* [36] Yang Liu and Mirella Lapata. Text summarization with pretrained encoders. In _Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)_, pages 3730-3740, Hong Kong, China, November 2019. Association for Computational Linguistics. doi: 10.18653/v1/D19-1387.
* [37] Yinhan Liu, Jiatao Gu, Naman Goyal, Xian Li, Sergey Edunov, Marjan Ghazvininejad, Mike Lewis, and Luke Zettlemoyer. Multilingual denoising pre-training for neural machine translation. _Transactions of the Association for Computational Linguistics_, 8:726-742, 2020.
* [38] Hasan Mesut Meral, Bulent Sankur, A Sumru Ozsoy, Tunga Gungor, and Emre Sevinc. Natural language watermarking via morphosyntactic alterations. _Computer Speech & Language_, 23(1):107-125, 2009.
* [39] OpenAI. Chatgpt. _https://openai.com/blog/chatgpt_, 2023a.

* [40] OpenAI. Gpt-4 technical report. _arXiv_, 2023b.
* [41] Luca Pajola and Mauro Conti. Fall of giants: How popular text-based mlaas fall against a simple evasion attack. In _2021 IEEE European Symposium on Security and Privacy (EuroS&P)_, pages 198-211. IEEE, 2021.
* [42] Kishore Papineni, Salim Roukos, Todd Ward, and Wei-Jing Zhu. Bleu: a method for automatic evaluation of machine translation. In _Proceedings of the 40th annual meeting of the Association for Computational Linguistics_, pages 311-318, 2002.
* [43] Fabien AP Petitcolas, Ross J Anderson, and Markus G Kuhn. Information hiding-a survey. _Proceedings of the IEEE_, 87(7):1062-1078, 1999.
* [44] Christine I Podlichuk and Edward J Delp. Digital watermarking: algorithms and applications. _IEEE signal processing Magazine_, 18(4):33-46, 2001.
* [45] Vidyasagar M Potdar, Song Han, and Elizabeth Chang. A survey of digital image watermarking techniques. In _INDIN'05. 2005 3rd IEEE International Conference on Industrial Informatics, 2005._, pages 709-716. IEEE, 2005.
* [46] Stefano Giovanni Rizzo, Flavio Bertini, and Danilo Montesi. Fine-grain watermarking for intellectual property protection. _EURASIP Journal on Information Security_, 2019:1-20, 2019.
* [47] Vinu Sankar Sadasivan, Aounon Kumar, Sriram Balasubramanian, Wenxiao Wang, and Soheil Feizi. Can ai-generated text be reliably detected? _arXiv preprint arXiv:2303.11156_, 2023.
* [48] M Hassan Shirali-Shahreza and Mohammad Shirali-Shahreza. A new synonym text steganography. In _2008 international conference on intelligent information hiding and multimedia signal processing_, pages 1524-1526. IEEE, 2008.
* [49] Katzenbeisser Stefan, A Petitcolas Fabien, et al. Information hiding techniques for steganography and digital watermarking, 2000.
* [50] Yuchen Sun, Tianpeng Liu, Panhe Hu, Qing Liao, Shouling Ji, Nenghai Yu, Deke Guo, and Li Liu. Deep intellectual property: A survey. _arXiv preprint arXiv:2304.14613_, 2023.
* [51] Reuben Tan, Bryan A Plummer, and Kate Saenko. Detecting cross-modal inconsistency to defend against neural fake news. _arXiv preprint arXiv:2009.07698_, 2020.
* [52] Ruixiang Tang, Yu-Neng Chuang, and Xia Hu. The science of detecting llm-generated texts. _arXiv preprint arXiv:2303.07205_, 2023.
* [53] Yi Tay, Dara Bahri, Che Zheng, Clifford Brunk, Donald Metzler, and Andrew Tomkins. Reverse engineering configurations of neural text generation models. _arXiv preprint arXiv:2004.06201_, 2020.
* [54] Mercan Topkara, Cuneyt M Taskiran, and Edward J Delp III. Natural language watermarking. In _Security, Steganography, and Watermarking of Multimedia Contents VII_, volume 5681, pages 441-452. SPIE, 2005.
* [55] Mercan Topkara, Giuseppe Riccardi, Dilek Hakkani-Tur, and Mikhail J Atallah. Natural language watermarking: Challenges in building a practical system. In _Security, Steganography, and Watermarking of Multimedia Contents VIII_, volume 6072, pages 106-117. SPIE, 2006.
* [56] Mercan Topkara, Umut Topkara, and Mikhail J Atallah. Words are not enough: sentence level natural language watermarking. In _Proceedings of the 4th ACM international workshop on Contents protection and security_, pages 37-46, 2006.
* [57] Umut Topkara, Mercan Topkara, and Mikhail J Atallah. The hiding virtues of ambiguity: quantifiably resilient watermarking of natural language text through synonym substitutions. In _Proceedings of the 8th workshop on Multimedia and security_, pages 164-174, 2006.
* [58] Honai Ueoka, Yugo Murawaki, and Sadao Kurohashi. Frustratingly easy edit-based linguistic steganography with a masked language model. _arXiv preprint arXiv:2104.09833_, 2021.
* [59] Ashish Venugopal, Jakob Uszkoreit, David Talbot, Franz Josef Och, and Juri Ganitkevitch. Watermarking the outputs of structured prediction with an application in statistical machine translation. In _Proceedings of the 2011 Conference on Empirical Methods in Natural Language Processing_, pages 1363-1372, 2011.
* [60] Hong Wang, Xuan Luo, Weizhi Wang, and Xifeng Yan. Bot or human? detecting chatgrp imposters with a single question. _arXiv preprint arXiv:2305.06424_, 2023.

* [61] Alex Wilson and Andrew D Ker. Avoiding detection on twitter: embedding strategies for linguistic steganography. Society of Photo-optical Instrumentation Engineers, 2016.
* [62] Alex Wilson, Phil Blunsom, and Andrew D Ker. Linguistic steganography on twitter: hierarchical language modeling with manual interaction. In _Media Watermarking, Security, and Forensics 2014_, volume 9028, pages 9-25. SPIE, 2014.
* [63] Alex Wilson, Phil Blunsom, and Andrew Ker. Detection of steganographic techniques on twitter. In _Proceedings of the 2015 Conference on Empirical Methods in Natural Language Processing_, pages 2564-2569, 2015.
* [64] Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Remi Louf, Morgan Funtowicz, et al. Huggingface's transformers: State-of-the-art natural language processing. _arXiv preprint arXiv:1910.03771_, 2019.
* [65] Max Wolff and Stuart Wolff. Attacking neural text detectors. _arXiv preprint arXiv:2002.11768_, 2020.
* [66] Xi Yang, Jie Zhang, Kejiang Chen, Weiming Zhang, Zehua Ma, Feng Wang, and Nenghai Yu. Tracing text provenance via context-aware lexical substitution. In _Proceedings of the AAAI Conference on Artificial Intelligence_, volume 36, pages 11613-11621, 2022.
* [67] KiYoon Yoo, Wonhyuk Ahn, Jiho Jang, and Nojun Kwak. Robust natural language watermarking through invariant features. _arXiv preprint arXiv:2305.01904_, 2023.
* [68] Rowan Zellers, Ari Holtzman, Hannah Rashkin, Yonatan Bisk, Ali Farhadi, Franziska Roesner, and Yejin Choi. Defending against neural fake news. _Advances in neural information processing systems_, 32, 2019.
* [69] Jialong Zhang, Zhongshu Gu, Jiyong Jang, Hui Wu, Marc Ph Stoecklin, Heqing Huang, and Ian Molloy. Protecting intellectual property of deep neural networks with watermarking. In _Proceedings of the 2018 on Asia Conference on Computer and Communications Security_, pages 159-172, 2018.
* [70] Xuandong Zhao, Yu-Xiang Wang, and Lei Li. Protecting language generation models via invisible watermarking. _arXiv preprint arXiv:2302.03162_, 2023.
* [71] Zachary M Ziegler, Yuntian Deng, and Alexander M Rush. Neural linguistic steganography. _arXiv preprint arXiv:1909.01496_, 2019.