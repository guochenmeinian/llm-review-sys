# Chimera: Effectively Modeling Multivariate Time Series with 2-Dimensional State Space Models

 Ali Behrouz

Cornell University

ab2947@cornell.edu

&Michele Santacatterina

New York University

santam13@nyu.edu

&Ramin Zabih

Cornell University

rdz@cs.cornell.edu

###### Abstract

Modeling multivariate time series is a well-established problem with a wide range of applications from healthcare to financial markets. It, however, is challenging as it requires methods to (1) have high expressive power of representing complicated dependencies along the time axis to capture both long-term progression and seasonal patterns, (2) capture the inter-variate dependencies when it is informative, (3) dynamically model the dependencies of variate and time dimensions, and (4) have efficient training and inference for very long sequences. Traditional State Space Models (SSMs) are classical approaches for univariate time series modeling due to their simplicity and expressive power to represent _linear_ dependencies. They, however, have fundamentally limited expressive power to capture non-linear dependencies, are slow in practice, and fail to model the inter-variate information flow. Despite recent attempts to improve the expressive power of SSMs by using deep structured SSMs, the existing methods are either limited to univariate time series, fail to model complex patterns (e.g., seasonal patterns), fail to dynamically model the dependencies of variate and time dimensions, and/or are input-independent. We present Chimera, an expressive variation of the 2-dimensional SSMs with careful design of parameters to maintain high expressive power while keeping the training complexity linear. Using two SSM heads with different discretization processes and input-dependent parameters, Chimera is provably able to learn long-term progression, seasonal patterns, and desirable dynamic autoregressive processes. To improve the efficiency of complex 2D recurrence, we present a fast training using a new 2-dimensional parallel selective scan. Our experimental evaluation shows the superior performance of Chimera on extensive and diverse benchmarks, including ECG and speech time series classification, long-term and short-term time series forecasting, and time series anomaly detection.

## 1 Introduction

Modeling time series is a well-established problem with a wide range of applications from healthcare [1, 2, 3] to financial markets [4, 5] and energy management [6]. The complex nature of time series data, its diverse domains of applicability, and its broad range of tasks (e.g., classification [2, 7], imputation [8, 9], anomaly detection [2, 10], and forecasting [6]), however, raise fundamental challenges to design effective and generalizable models: (1) The higher-order, seasonal, and long-term patterns in time series require an effective model to be able to expressively capture complex and autoregressive dependencies; (2) In the presence of multiple variates of time series, an effective model need to capture the complex dynamics of the dependencies between time and variate axes. More specifically, most existing multivariate models seem to suffer from overfitting especially when the target time series is not correlated with other covariates [11]. Accordingly, an effective model needs to adaptively learn to select (resp. filter) informative (resp. irrelevant) variates; (3) The diverse set of domains and tasks requires effective models to be free of manual pre-processing and domainknowledge and instead adaptively learn them; and (4) Due to the processing of very long sequences, effective methods need efficient training and inference.

Classical methods (e.g., State Space Models [12; 13], ARIMA [14], SARIMA [15], Exponential Smoothing (ETS) [16]) require manual data preprocessing and model selection, and often are not able to capture complex _non-linear_ dynamics. The raise of deep learning methods and more specifically Transformers [17] has led to significant research efforts to address the limitation of classical methods and develop effective deep models [18; 19; 20; 21; 22; 23; 24; 25; 26; 27]. Unfortunately, most existing deep models struggle to achieve all the above four criteria. The main body of research in this direction has focused on designing attention modules that use the special traits of time series [21; 20]. However, the inherent permutation equivariance of attentions contradicts the causal nature of time series and often results in suboptimal performance compared to simple linear methods [11]. Moreover, they often either overlook difference of seasonal and long-term trend or use non-learnable methods to handle them [20].

A considerable subset of deep models overlook the importance of modeling the dependencies of variates [11; 28; 29]. These dependencies, however, are not always useful; specifically when the target time series is not correlated with other covariates [30]. Despite several studies exploring the importance of learning cross variate dependencies [26; 27; 30], there has been no universal standard and the conclusion has been different depending on the domain and benchmarks. Accordingly, we argue that an effective model need to _adaptively_ learn to capture the dependencies of variates in a data-dependent manner. In this direction, recently, Liu et al. [27] argue that attention mechanisms are more effective when they are used across variates, showing the importance of modeling complex non-linear dependencies across the variate axis in a data-dependent manner. However, the quadratic complexity of Transformers challenges the model on multivariate time series with a large number of variates (e.g., brain activity signals [2] or traffic forecasting [6]), limiting the efficient training and inference (see Table 3, and Table 5).

The objective of this study is to develop a provably expressive model for multivariate time series that not only can model the dynamics of the dependencies along both time and variates, but it also takes advantage of fast training and inference. To this end, we present a Chimera, a three-headed two-dimensional State Space Model (SSM) that is based on linear layers along (i) time, (ii) variates, (iii) time\(\rightarrow\)variate, and (iv) variate\(\rightarrow\)time. Chimera has a careful parameterization based on the pair of companion and diagonal matrices (see Figure 1), which is provably expressive to recover both classical methods [16; 14; 15], linear attentions, and recent SSM-based models [31; 32]. It further uses an adaptive module based on a 2D SSM with an especially designed discretization process to

Figure 1: **The Overview of Contributions and Architecture of Chimera. We present a 2-dimensional SSM with careful and expressive parameterization. It uses different learnable discretization processes to learn seasonal and long-term progression patterns, and leverages a parallelizable and fast training process by re-formulating the 2D input dependent recurrence as a 2D prefix sum problem.**

capture seasonal patterns. While our theoretical results and design of Chimera guarantee the first three criteria of an effective model, due to its 2D recurrence, the naive implementation of Chimera results in slow training. To address this issue, we reformulate its 2D recurrence as the prefix sum problem with a 2-dimensional associative operators. This new formulation can be done in parallel and has hardware-friendly implementation, resulting in much faster training and inference.

In our experimental evaluation, we explore the performance of Chimera in a wide range of tasks: ECG and audio speech time series classification, long- and short-term time series forecasting, and anomaly detection tasks. We find that Chimera achieve superior or on par performance with state-of-the-art methods, while having faster training and less memory consumption. We perform a case study on the human brain activity signals [2] to show (1) the effectiveness of Chimera and (2) evaluate the importance of modeling the dynamics of the variates dependencies.

## 2 Preliminaries

**Notations.** In this paper we mainly focus on classification and forecasting tasks. Note that anomaly detection can be seen as a binary classification task, where \(0\) means "normal" and \(1\) means "anomaly". We let \(\mathbf{X}=\{\mathbf{x}_{1},\ldots,\mathbf{x}_{N}\}\in\mathbb{R}^{N\times T}\) be the input sequences, where \(N\) is the number of variates and \(T\) is the time steps. We use \(\mathbf{x}_{v,t}\) to refer to the value of the series \(v\) at time \(t\). In classification (anomaly detection) tasks, we aim to classify input sequences and for forecasting tasks, given an input sequence \(\mathbf{x}_{i}\), we aim to predict \(\tilde{\mathbf{x}}_{i}\in\mathbb{R}^{1\times H}\), i.e., the next \(H\) time steps for variate \(\mathbf{x}_{i}\), where \(H\) is called horizon. In 2D SSMs formulation, for a 2-dimensional vector \(x\in\mathbb{C}^{1}\), we use \(x^{(1)}\) and \(x^{(2)}\) to refer to its real and imaginary components, respectively.

**Multi-Dimensional State Space Models.** We build our approach on the continuous State Space Model (SSM) but later we make each component of Chimera discrete by a designed discretization process. For additional discussion on 1D SSMs see Appendix A. Given parameters \(\mathbf{A}_{\tau_{1}}\in\mathbb{R}^{N^{(\tau_{1})}\times N^{(\tau_{1})}}\), \(\mathbf{B}_{\tau_{2}}\in\mathbb{C}^{N^{(\tau_{2})}\times 1}\), and \(\mathbf{C}\in\mathbb{C}^{N_{1}\times N_{2}}\) for \(\tau_{1}\in\{1,...,4\}\) and \(\tau_{2}\in\{1,2\}\), the general form of the time-invariant 2D SSM is the map \(\mathbf{x}\in\mathbb{C}^{1}\mapsto\mathbf{y}\in\mathbb{C}^{1}\) defined by the linear Partial Differential Equation (PDE) with initial condition \(h(0,0)=0\):

\[\frac{\partial}{\partial t^{(1)}}h\left(t^{(1)},t^{(2)}\right) =\left(\mathbf{A}_{1}h^{(1)}\left(t^{(1)},t^{(2)}\right),\mathbf{A }_{2}h^{(2)}\left(t^{(1)},t^{(2)}\right)\right)+\mathbf{B}_{1}\mathbf{x}\left( t^{(1)},t^{(2)}\right),\] (1) \[\frac{\partial}{\partial t^{(2)}}h\left(t^{(1)},t^{(2)}\right) =\left(\mathbf{A}_{3}h^{(1)}\left(t^{(1)},t^{(2)}\right),\mathbf{A }_{4}h^{(2)}\left(t^{(1)},t^{(2)}\right)\right)+\mathbf{B}_{2}\mathbf{x}\left( t^{(1)},t^{(2)}\right),\] (2) \[\mathbf{y}\left(t^{(1)},t^{(2)}\right)=\langle\mathbf{C},\mathbf{ x}\left(t^{(1)},t^{(2)}\right)\rangle.\] (3)

Contrary to the multi-dimensional SSMs discussed by Gu and Dao [33], Gu et al. [34], in which multi-dimension refers to the dimension of the input but with one time variable, the above formulation uses two variables, meaning that the mapping is from a 2D grid to a 2D grid.

**(Seasonal) Autoregressive Process.** Autoregressive process is a basic yet essential premise for time series modeling, which models the causal nature of time series. Given \(p\in\mathbb{N}\), \(\mathbf{x}_{k}\in\mathbb{R}^{d}\), the simple linear autoregressive relationships between \(\mathbf{x}_{k}\) and its past samples \(\mathbf{x}_{k-1},\mathbf{x}_{k-2},\ldots,\mathbf{x}_{k-p}\) can be modeled as \(\mathbf{x}_{k}=\phi_{1}\mathbf{x}_{k-1}+\phi_{2}\mathbf{x}_{k-2}+\ldots,\phi_ {p}\mathbf{x}_{k-p}\), where \(\phi_{1},\ldots,\phi_{p}\) are coefficients. This is called AR\((p)\). Similarly, in the presence of seasonal patterns, the seasonal autoregressive process, SAR\((p,q,s)\), is:

\[\mathbf{x}_{k}=\phi_{1}\mathbf{x}_{k-1}+\phi_{2}\mathbf{x}_{k-2}+\ldots,\phi_ {p}\mathbf{x}_{k-p}+\eta_{1}\mathbf{x}_{k-s}+\eta_{2}\mathbf{x}_{k-2s}+\cdots+ \eta_{q}\mathbf{x}_{k-qs},\] (4)

where \(s\) is the frequency of seasonality, and \(\phi_{1},\ldots,\phi_{p}\) and \(\eta_{1},\ldots,\eta_{q}\) are coefficients. Note that one can simply extend the above formulation to multivariate time series by letting coefficients to be vectors and replace the product with element-wise product.

## 3 Chimera: A Three-headed 2-Dimensional State Space Model

In this section, we first present a mathematical model for multivariate time series data and then based on this model, we present a neural architecture that can satisfy all the criteria discussed in SS1.

### Motivations & Chimera Model

SSMs have been long-standing methods for modeling time series [12; 13], mainly due to their simplicity and expressive power to represent complicated and autoregressive dependencies. Their states, however, are the function of a single-variable (e.g., time). Multivariate time series, on the other hand, require capturing dependencies along both time and variate dimensions, requiring the current state of the model to be the function of both time and variate. Classical 2D SSMs [35; 36; 37; 38], however, struggle to achieve good performance compared to recent advanced deep learning methods as they are : (1) only able to capture linear dependencies, (2) discrete by design, having a pre-determined resolution, and so cannot simply model seasonal patterns, (3) slow in practice for large datasets, (4) their update parameters are static and cannot capture the dynamics of dependencies. Deep learning-based methods [6; 30; 27], on the other hand, potentially are able to address a subset of the above limitations, while having their own drawbacks (discussed in SS1). In this section, we start with _continuous_ SSMs due to their connection to both classical methods [12; 13] and recent breakthrough in deep learning [34; 33]. We then discuss our contributions on how to take the advantages of the best of both worlds, addressing all the abovementioned limitations.

**Discrete 2D SSM.** We use 2-dimensional SSMs, introduced in Equation 1-3, to model multivariate time series, where the first axis corresponds to the time dimension and the second axis is the variates. Accordingly, each state is a function of both time and variates. The first stage is to transform the continuous form of 2D SSMs to discrete form. Given the step size \(\Delta_{1}\) and \(\Delta_{2}\), which represent the resolution of the input along the axes, discrete form of the input is defined as \(\mathbf{x}_{k,\ell}=\mathbf{x}(k\Delta_{1},\ell\Delta_{2})\). Using Zero-Order Hold (ZOH) method, we can discretize the input as (see Appendix C for details):

\[\begin{pmatrix}h^{(1)}_{k,\ell+1}\\ h^{(2)}_{k+1,\ell}\end{pmatrix}=\begin{pmatrix}\bar{\mathbf{A}}_{1}&\bar{ \mathbf{A}}_{2}\\ \bar{\mathbf{A}}_{3}&\bar{\mathbf{A}}_{4}\end{pmatrix}\begin{pmatrix}h^{(1)}_{ k,\ell}\\ h^{(2)}_{k,\ell}\end{pmatrix}+\begin{pmatrix}\bar{\mathbf{B}}_{1}\\ \bar{\mathbf{B}}_{2}\end{pmatrix}\otimes\begin{pmatrix}\bar{\mathbf{x}}_{k, \ell+1}\\ \bar{\mathbf{x}}_{k+1,\ell}\end{pmatrix},\] (5)

where \(\bar{\mathbf{A}}_{i}=\exp\left(\Delta_{\lfloor\frac{i+1}{2}\rfloor}\mathbf{A} _{i}\right)\) for \(i=1,2,3,4\), \(\bar{\mathbf{B}}_{1}=\begin{pmatrix}\mathbf{A}_{1}^{-1}\left(\bar{\mathbf{A}}_ {1}-\mathbf{I}\right)\mathbf{B}_{1}^{(1)}\\ \mathbf{A}_{2}^{-1}\left(\bar{\mathbf{A}}_{2}-\mathbf{I}\right)\mathbf{B}_{1} ^{(2)}\end{pmatrix}\), and \(\bar{\mathbf{B}}_{2}=\begin{pmatrix}\mathbf{A}_{3}^{-1}\left(\bar{\mathbf{A}}_ {3}-\mathbf{I}\right)\mathbf{B}_{2}^{(1)}\\ \mathbf{A}_{4}^{-1}\left(\bar{\mathbf{A}}_{4}-\mathbf{I}\right)\mathbf{B}_{2} ^{(2)}\end{pmatrix}\). Note that this formulation can also be viewed as the modification of the discrete Roesser's SSM model [35] when we add a lag of \(1\) in the inputs \(\begin{pmatrix}\bar{\mathbf{x}}_{i,j}\\ \bar{\mathbf{x}}_{i,j}\end{pmatrix}\). This modification, however, misses the discretization step, which is an important step in our model. We later use the discretization step to (1) empower the model to select (resp. filter) relevant (resp. irrelevant) information, (2) adaptively adjust the resolution of the method, capturing seasonal patterns.

From now on, we use \(t\) (resp. \(v\)) to refer to the index along the time (resp. variate) dimension. Therefore, for the sake of simplicity, we reformulate Equation 5 as follows:

\[h^{(1)}_{v,t+1}=\bar{\mathbf{A}}_{1}h^{(1)}_{v,t}+\bar{\mathbf{A} }_{2}h^{(2)}_{v,t}+\bar{\mathbf{B}}_{1}\mathbf{x}_{v,t+1},\] (6) \[h^{(2)}_{v+1,t}=\bar{\mathbf{A}}_{3}h^{(1)}_{v,t}+\bar{\mathbf{ A}}_{4}h^{(2)}_{v,t}+\bar{\mathbf{B}}_{2}\mathbf{x}_{v+1,t},\] (7) \[\mathbf{y}_{v,t}=\mathbf{C}_{1}h^{(1)}_{v,t}+\mathbf{C}_{2}h^{(2 )}_{v,t},\] (8)

where \(\bar{\mathbf{A}}_{1},\bar{\mathbf{A}}_{2},\bar{\mathbf{A}}_{3},\bar{\mathbf{A }}_{4}\in\mathbb{R}^{N\times N}\), \(\bar{\mathbf{B}}_{1},\bar{\mathbf{B}}_{2}\in\mathbb{R}^{N\times 1}\), and \(\mathbf{C}_{1},\mathbf{C}_{2}\in\mathbb{R}^{1\times N}\) are parameters of the model, \(h^{(1)}_{v,t},h^{(2)}_{v,t}\in\mathbb{R}^{N\times d}\) are hidden states, and \(\mathbf{x}_{v,t}\in\mathbb{R}^{1\times d}\) is the input. In this formulation, intuitively, \(h^{(1)}_{v,t}\) is the hidden state that carries cross-time information (each state depends on its previous time stamp but within the same variate), where \(\bar{\mathbf{A}}_{1}\) and \(\bar{\mathbf{A}}_{2}\) control the emphasis on past cross-time and cross-variate information, respectively. Similarly, \(h^{(2)}_{v,t}\) is the hidden state that carries cross-variate information (each state depends on other variates but with the same time stamp). Later in this section, we discuss to modify the model to bi-directional setting along the variate dimension, to enhance information flow along this non-causal dimension.

**Interpretation of Discretization.** Time series data are often sampled from an underlying continuous process [39; 40]. In these cases, variable \(\Delta_{1}\) in the discretization of the time axis can be interpreted as resolution or the sampling rate from the underlying continuous data. However, discretization alongthe variate axis, which is discrete by its nature, or when working directly with discrete data [41] is an unintuitive process, and raise questions about its significance. The discretization step in 1D SSMs has deep connections to gating mechanisms of RNNs [42, 33], automatically ensures that the model is normalized [43], and results in desirable properties such as resolution invariance [32].

**Proposition 3.1**.: _The 2D discrete SSM introduced in Equation 6-8 with parameters \((\{\mathbf{\hat{A}}_{i}\},\{\mathbf{\hat{B}}_{i}\},\{\mathbf{\hat{C}}_{i}\},k \Delta_{1},\ell\Delta_{2})\) evolves at a rate \(k\) (resp. \(\ell\)) times as fast as the 2D discrete SSM with parameters \((\{\mathbf{\hat{A}}_{i}\},\{\mathbf{\hat{B}}_{i}\},\{\mathbf{\hat{C}}_{i}\}, \Delta_{1},\ell\Delta_{2})\) (resp. \((\{\mathbf{\hat{A}}_{i}\},\{\mathbf{\hat{B}}_{i}\},\{\mathbf{\hat{C}}_{i}\},k \Delta_{1},\Delta_{2})\))._

Accordingly, parameters \(\Delta_{1}\) can be viewed as the controller of the length of dependencies that the model captures. That is, based on the above result, we see the discretization along the time axis as the setting of the resolution or sampling rate: while small \(\Delta_{1}\) can capture long-term progression, larger \(\Delta_{1}\) captures seasonal patterns. For now, we see the discretization along the variate axis as a mechanism similar to gating in RNNs [44, 33], where \(\Delta_{2}\) controls the length of the model context. Larger values of \(\Delta_{2}\) means less context window, ignoring other variates, while smaller values of \(\Delta_{2}\) means more emphasis on the dependencies of variates. Later, inspired by Gu and Dao [33], we discuss making \(\Delta_{2}\) as the function of the input, resulting in a selection mechanism that filters irrelevant variates.

**Structure of Transition Matrices.** For Chimera to be expressive and able to recover autoregressive process, hidden states \(h^{(1)}_{v,t}\) should carry information about _past_ time stamps. While making all the parameters in \(\mathbf{A}_{i}\) learnable allows the model to learn any arbitrary structure for \(\mathbf{A}_{i}\), previous studies show that this is not possible unless the structure of transition matrices are restricted [45, 46]. To this end, inspired by Zhang et al. [28] that argue that companion matrices are effective to capture the dependencies along the time dimension, we restrict \(\mathbf{A}_{1}\) and \(\mathbf{A}_{2}\) matrices to have companion structure (see Appendix D for the details). Not only this formulation is shown to be effective for capturing dependencies along the time dimension [28] (also see Theorem 3.4), but it also can help us to compute the power of \(\mathbf{A}_{1}\) and \(\mathbf{A}_{2}\) faster in the convolutional form, as discussed by Zhang et al. [28]. Also, for \(\mathbf{A}_{3}\) and \(\mathbf{A}_{4}\), we observe that even a simpler structure of diagonal matrices is effective to fuse information along the variate dimension. Not only these simple structured matrices make the training of the model faster, but they also are proven to be effective [45].

**Bi-Directionality.** The causal nature of the 2D SSM result in limited information flow along the variate dimension as variate are not ordered. To overcome this challenge, inspired by the bi-directional 1D SSMs [47, 48, 1], we use two different modules for forward and backward pass along the variate dimension. The details of formulation is in Appendix E.

**Convolution Form.** As discussed by Baron et al. [49], similar to 1D SSMs [34], the _data-independent_ formulation of 2D-SSMs can be viewed as a convolution with a kernel \(\mathbf{K}\). This formulation not only results in faster training by providing the ability of parallel processing, but it also connect Chimera

Figure 2: **Different forms of Chimera. (Top-Left) Chimera has a recurrence form (bi-directional along the variates), which also can be computed as a global convolution in training. (Top-Right) In forecasting, we present the multivariate closed-loop to improve the performance for long horizons. (Bottom) Using data-dependent parameters, Chimera training can be done as a parallel 2D scan.**

with very recent studies of modern convolution-based architecture for time series [9]. Applying the recurrent rules in Equation 6-8, we can write the output as:

\[\mathbf{y}_{v,t}=\sum_{1\leq\tilde{v}\leq v}\sum_{1\leq\tilde{t}\leq t}\left( \mathbf{C}_{1}\mathbf{K}_{\tilde{v},\tilde{t}}^{(1)}+\mathbf{C}_{2}\mathbf{K}_{ \tilde{v},\tilde{t}}^{(2)}\right)\mathbf{x}_{\tilde{v},\tilde{t}},\] (9)

where kernels \(\mathbf{K}_{\tilde{v},\tilde{t}}^{(r)}=\sum_{(z_{1},\ldots,z_{5})\in\mathbf{P} ^{(r)}}q_{i}\ \bar{\mathbf{A}}_{1}^{P_{1}}\bar{\mathbf{A}}_{2}^{P_{2}}\bar{\mathbf{A}}_{3}^ {P_{3}}\bar{\mathbf{A}}_{4}^{P_{4}}\bar{\mathbf{B}}_{p_{5}}\), and \(\mathbf{P}^{(\tau)}\) is the partitioning of the paths from the starting point to \((\hat{v},\hat{t})\) for \(\tau\in\{1,2\}\). As discussed by Baron et al. [49], if the power of \(\bar{\mathbf{A}}_{i}\)s are given and cached, calculating the partitioning of all paths can be done very efficiently (near-linearly) as it the generalization of pascal triangle. To calculate the power of \(\bar{\mathbf{A}}_{i}\), note that we use diagonal matrices as the structure of \(\bar{\mathbf{A}}_{3}\), and \(\bar{\mathbf{A}}_{4}\), and so computing their powers is very fast. On the other hand, for \(\bar{\mathbf{A}}_{1}\) and \(\bar{\mathbf{A}}_{2}\) with companion structures, we can use sparse matrix multiplication, which results in linear complexity in terms of the sequence length.

**Data-Dependent Parameters.** As discussed earlier, parameters \(\bar{\mathbf{A}}_{1}\) and \(\bar{\mathbf{A}}_{2}\) controls the emphasis on past cross-time and cross-variate information. Similarly, parameters \(\Delta_{1}\) and \(\bar{\mathbf{B}}_{1}\) controls the emphasis on the current input and historical data. Since these parameters are data-independent, one can interpret them as a global feature of the system. In complex systems (e.g., human neural activity), however, the emphasis depends on the current input, requiring these parameters to be the function of the input (see SS4.1). The input-dependency of parameters allows the model to select relevant and filter irrelevant information for each input data, providing a similar mechanism as transformers [33]. Additionally, as we argue earlier, depending on the data, the model needs to adaptively learn if mixing information along the variates is useful. Making parameters input-dependent further overcomes this challenge and lets our model to mix relevant and filter irrelevant variates for the modeling of a variate of interest. One of our main technical contributions is to let \(\bar{\mathbf{B}}_{i}\), \(\bar{\mathbf{C}}_{i}\), and \(\Delta_{i}\) for \(i\in\{1,2\}\) be the function of the input \(\mathbf{x}_{v,t}\). This input-dependent 2D SSM, unfortunately, does not have the convolution form, limiting the scalability and efficiency of the training. We overcome this challenge by computing the model recurrently with a new 2D scan.

**2D Selective Scan.** Inspired by the scanning in 1D SSMs [50; 33], we present an algorithm to decrease the sequential steps that are required to calculate hidden states. Given \(p,q\), each of which with 6 elements, we first define operation \(\dividedividedivide\) as: (\(\odot\) is matrix-matrix and \(\otimes\) is matrix-vector multiplication)

\[p\dividedivide=\begin{pmatrix}p_{1}&p_{2}&p_{3}\\ p_{4}&p_{5}&p_{6}\end{pmatrix}\dividedividedivide\begin{pmatrix}q_{1}&q_{2}& q_{3}\\ q_{4}&q_{5}&q_{6}\end{pmatrix}=\begin{pmatrix}q_{1}\odot p_{1}&q_{2}\odot p_{2}&q_{1} \otimes p_{3}+q_{2}\otimes p_{6}+q_{3}\\ q_{4}\odot p_{4}&q_{5}\odot p_{5}&q_{4}\otimes p_{3}+q_{5}\otimes p_{6}+q_{6} \end{pmatrix}\]

The proofs of the next two theorems are in Appendix G.

**Theorem 3.2**.: _Operator \(\dividedividedivide\) is associative: Given \(p,q,\) and \(r\), we have: \((p\dividedividedivide\)\(q)\dividedivide\)\(r=p\dividedividedivide(q\dividedivide r)\)._

**Theorem 3.3**.: _2D SSM recurrence can be done in parallel using parallel prefix sum algorithms with associative operator \(\dividedivide\), when fixing the variate._

### New Variant of 2D SSM: 2D Mamba

Figure 2 (Top-Left) shows the recurrence form of our 2D SSM. Each small square is a state of the system, i.e., the state of a variate at a certain time stamp. 2D SSM considers two hidden states for each state (represented by two colors: light red and blue), encoding the information along the time (red) and variate (blue), respectively. Furthermore, each arrow represents a transition matrix \(\mathbf{A}_{i}\) that decides to how information need to be fused. In this section, we discuss a spacial instance of our 2D SSM by limiting its parameters.

**2D Mamba.** We let \(\mathbf{A}_{2}=\mathbf{A}_{3}=\mathbf{0}\) in our 2D SSM. The resulting model is equivalent to:

\[h_{v,t+1}^{(1)}=\bar{\mathbf{A}}_{1}h_{v,t}^{(1)}+\bar{\mathbf{B}}_{1} \mathbf{x}_{v,t+1},\] (10)

\[h_{v+1,t}^{(2)}=\bar{\mathbf{A}}_{4}h_{v,t}^{(2)}+\bar{\mathbf{B}}_{2} \mathbf{x}_{v+1,t},\] (11)

\[\mathbf{y}_{v,t}=\mathbf{C}_{1}h_{v,t}^{(1)}+\mathbf{C}_{2}h_{v,t}^{(2)},\] (12)

where \(\bar{\mathbf{A}}_{1}=\exp\left(\Delta_{1}\mathbf{A}_{1}\right)\), \(\bar{\mathbf{A}}_{2}=\exp\left(\Delta_{2}\mathbf{A}_{2}\right)\), \(\bar{\mathbf{B}}_{1}=\begin{bmatrix}\mathbf{A}_{1}^{-1}\left(\bar{\mathbf{A}}_{ 1}-\mathbf{I}\right)\mathbf{B}_{1}^{(1)}\\ \mathbf{0}\end{bmatrix}\), and \(\bar{\mathbf{B}}_{2}=\begin{bmatrix}\mathbf{0}\\ \mathbf{A}_{4}^{-1}\left(\bar{\mathbf{A}}_{4}-\mathbf{I}\right)\mathbf{B}_{2}^{( 2)}\end{bmatrix}\). This formulation with data-dependent parameters, is equivalent to using two S6 blocks [33] each of which along a dimension. Notably, these two S6 blocks are not separate as the output \(\mathbf{y}_{v,t}\) is based on both hidden states \(h_{v,t}^{(1)}\) and \(h_{v,t}^{(2)}\), capturing 2D inductive bias.

### Chimera Neural Architecture

In this section, we use a stack of our 2D SSMs, with non-linearity in between, to enhance the expressive power and capabilities of the abovementioned 2D SSM. To this end, similar to deep SSM models [28], we allow all parameters to be learnable and in each layer we use multiple 2D SSMs, each of which with its own responsibility. Also, in the data-dependent variant of Chimera, we let parameters \(\mathbf{B}_{i},\mathbf{C}_{i},\) and \(\Delta_{i}\) for \(i\in\{1,2\}\) be the function of the input \(\mathbf{x}\):

\[\mathbf{B}_{i}=\texttt{Linear}_{\mathbf{B}_{i}}(x),\qquad\mathbf{C}_{i}= \texttt{Linear}_{\mathbf{C}_{i}}(x),\qquad\Delta_{i}=\texttt{Softplus}\left( \texttt{Linear}_{\Delta_{i}}(x)\right).\] (13)

Chimera follows the commonly used decomposition of time series, and decomposes them into trend components and seasonal patterns. it, however, uses special traits of 2D SSM to capture these terms.

Seasonal Patterns.To capture the multi-resolution seasonal patterns, we take advantage of the discretization process. Proposition 3.1 states that if \(\mathbf{x}(v,t)\mapsto\mathbf{y}(v,t)\) with parameters \((\{\bar{\mathbf{A}}_{i}\},\{\bar{\mathbf{B}}_{i}\},\{\bar{\mathbf{C}}_{i}\}, \Delta_{1},\Delta_{2})\) then \(\mathbf{x}(v,kt)\mapsto\mathbf{y}(v,kt)\) with \((\{\bar{\mathbf{A}}_{i}\},\{\bar{\mathbf{B}}_{i}\},\{\bar{\mathbf{C}}_{i}\}, k\Delta_{1},\Delta_{2})\). Accordingly, we use \(\texttt{2D-SSM}(.)\) module with a separate learnable \(\Delta_{s}\) that is responsible to learn the best resolution to capture seasonal patterns. Another interpretation for this module is based on \(\texttt{SAR}(p,q,s)\) (Equation 4). In this case, \(\Delta_{s}\) aims to learn a proper parameter \(s\) to capture seasonal patterns. Since we expect the resolution before and after this module matches, we add additional re-discretization module (a simple linear layer), after this module.

Trend Components.The second module of Chimera, \(\texttt{2D-SSM}_{t}\left(.\right)\) simply uses a sequence of multiple 2D SSMs to learn trend components. Proper combination of the outputs of this and the previous modules can capture both seasonal and trend components.

Both Modules Together.We followed previous studies [51] and consider residual connection modeling for learning trend and seasonal patterns. Given input data \(\tilde{\mathbf{X}}_{0}=\mathbf{X}\), and \(\ell=0,\ldots,\mathcal{L}\), we have:

\[\tilde{\mathbf{X}}_{\ell+1} =\texttt{2D-SSM}_{t}\left(\tilde{\mathbf{X}}_{\ell}\right),\] (14) \[\tilde{\mathbf{X}}_{\ell+1} =\texttt{Re-Discretization}\left(\texttt{2D-SSM}_{s}\left( \tilde{\mathbf{X}}_{\ell}-\tilde{\mathbf{X}}_{\ell+1}\right)\right).\] (15)

Figure 1 illustrate the architecture of Chimera. Due to the ability of our 2D SSM to recover smoothing techniques (see Theorem 3.4), this combination of modules for trend and seasonal patterns can be viewed as a generalization of traditional methods that use moving average with residual connection to model seasonality [51].

Gating with Linear Mapping.Inspired by the success of gated recurrent and SSM-based models [52; 33], we use a head of a fully connected layer with Swish [53], resulting in SwiGLU variant [54]. While we validate the significance of this head, this

Closed-Loop 2D SSM Decoder.To enhance the generalizability and the ability of our model for longer-horizon, we extend the closed-loop decoder module [28], which is similar to autoregression, to multivariate time series. We use distinct processes for the inputs and outputs, using additional matrices \(\mathbf{D}_{1}\) and \(\mathbf{D}_{2}\) in each decoder 2D SSM, we model future input time-steps explicitly:

\[\mathbf{y}_{v,t} =\mathbf{C}_{1}h_{v,t}^{(1)}+\mathbf{C}_{2}h_{v,t}^{(2)},\] (16) \[\mathbf{u}_{v,t} =\mathbf{D}_{1}h_{v,t}^{(1)}+\mathbf{D}_{2}h_{v,t}^{(2)},\] (17)

where \(\mathbf{u}_{v,t}\) is the next input and \(\mathbf{y}_{v,t}\) is the output. Note that the other parts (recurrence) are the same as Equation 6. Figure 2 illustrate the architecture of closed-loop 2D SSM.

### Theoretical Justification

In this section, we provide some theoretical evidences for the performance of Chimera. These results are mostly revisiting the theorems by Zhang et al. [28] and Baron et al. [49], and extending them 

[MISSING_PAGE_FAIL:8]

[MISSING_PAGE_FAIL:9]

[MISSING_PAGE_FAIL:10]

## Acknowledgments and Disclosure of Funding

This material is based upon work supported by the National Science Foundation under Award No. 2306556. Any opinions, findings and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the National Science Foundation.

## References

* Behrouz and Hashemi [2024] Ali Behrouz and Farnoosh Hashemi. Brain-mamba: Encoding brain activity via selective state space models. In _Conference on Health, Inference, and Learning_, pages 233-250. PMLR, 2024.
* Behrouz et al. [2024] Ali Behrouz, Parsa Delavari, and Farnoosh Hashemi. Unsupervised representation learning of brain activity via bridging voxel activity and functional connectivity. In _International conference on machine learning (ICML)_, 2024.
* Ivanov et al. [1999] Plamen Ch Ivanov, Luis A Nunes Amaral, Ary L Goldberger, Shlomo Havlin, Michael G Rosenblum, Zbigniew R Struzik, and H Eugene Stanley. Multifractality in human heartbeat dynamics. _Nature_, 399(6735):461-465, 1999.
* Gajamannage et al. [2023] Kelum Gajamannage, Yonggi Park, and Dilhani I Jayathilake. Real-time forecasting of time series in financial markets using sequentially trained dual-lstms. _Expert Systems with Applications_, 223:119879, 2023.
* Pincus and Kalman [2004] Steve Pincus and Rudolf E Kalman. Irregularity, volatility, risk, and financial market time series. _Proceedings of the National Academy of Sciences_, 101(38):13709-13714, 2004.
* Zhou et al. [2021] Haoyi Zhou, Shanghang Zhang, Jieqi Peng, Shuai Zhang, Jianxin Li, Hui Xiong, and Wancai Zhang. Informer: Beyond efficient transformer for long sequence time-series forecasting. In _Proceedings of the AAAI conference on artificial intelligence_, volume 35, pages 11106-11115, 2021.
* Wagner et al. [2020] Patrick Wagner, Nils Strodthoff, Ralf-Dieter Bousseljot, Dieter Kreiseler, Fatima I Lunze, Wojciech Samek, and Tobias Schaeffter. Ptb-xl, a large publicly available electrocardiography dataset. _Scientific data_, 7(1):1-15, 2020.
* Wu et al. [2023] Haixu Wu, Tengge Hu, Yong Liu, Hang Zhou, Jianmin Wang, and Mingsheng Long. Timesnet: Temporal 2d-variation modeling for general time series analysis. In _The Eleventh International Conference on Learning Representations_, 2023. URL https://openreview.net/forum?id=ju_Uqw3840q.
* Luo and Wang [2024] Donghao Luo and Xue Wang. ModernTCN: A modern pure convolution structure for general time series analysis. In _The Twelfth International Conference on Learning Representations_, 2024. URL https://openreview.net/forum?id=vpJMJerXHU.
* Su et al. [2019] Ya Su, Youjian Zhao, Chenhao Niu, Rong Liu, Wei Sun, and Dan Pei. Robust anomaly detection for multivariate time series through stochastic recurrent neural network. In _Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery & data mining_, pages 2828-2837, 2019.
* Zeng et al. [2023] Ailing Zeng, Muxi Chen, Lei Zhang, and Qiang Xu. Are transformers effective for time series forecasting? In _AAAI_, 2023.
* Harvey [1990] Andrew C Harvey. Forecasting, structural time series models and the kalman filter. _Cambridge university press_, 1990.
* Aoki [2013] Masanao Aoki. _State space modeling of time series_. Springer Science & Business Media, 2013.
* Bartholomew [1971] David J Bartholomew. Time series analysis forecasting and control., 1971.
* Bender and Simonovic [1994] Michael Bender and Slobodan Simonovic. Time-series modeling for long-range stream-flow forecasting. _Journal of Water Resources Planning and Management_, 120(6):857-870, 1994.
* Winters [1960] Peter R Winters. Forecasting sales by exponentially weighted moving averages. _Management science_, 6(3):324-342, 1960.

* Vaswani et al. [2017] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Lukasz Kaiser, and Illia Polosukhin. Attention is all you need. _Advances in neural information processing systems_, 30, 2017.
* Lim and Zohren [2021] Bryan Lim and Stefan Zohren. Time-series forecasting with deep learning: a survey. _Philosophical Transactions of the Royal Society A_, 379(2194):20200209, 2021.
* Chen et al. [2023] Zonglei Chen, Minbo Ma, Tianrui Li, Hongjun Wang, and Chongshou Li. Long sequence time-series forecasting with deep learning: A survey. _Information Fusion_, 97:101819, 2023.
* Woo et al. [2022] Gerald Woo, Chenghao Liu, Doyen Sahoo, Akshat Kumar, and Steven C. H. Hoi. Etsformer: Exponential smoothing transformers for time-series forecasting. _arXiv preprint arXiv:2202.01381_, 2022.
* Wu et al. [2021] Haixu Wu, Jiehui Xu, Jianmin Wang, and Mingsheng Long. Autoformer: Decomposition transformers with auto-correlation for long-term series forecasting. _Advances in neural information processing systems_, 34:22419-22430, 2021.
* Wu et al. [2022] Haixu Wu, Jialong Wu, Jiehui Xu, Jianmin Wang, and Mingsheng Long. Flowformer: Linearizing transformers with conservation flows. In _ICML_, 2022.
* Liu et al. [2021] Shizhan Liu, Hang Yu, Cong Liao, Jianguo Li, Weiyao Lin, Alex X Liu, and Schahram Dustdar. Pyraformer: Low-complexity pyramidal attention for long-range time series modeling and forecasting. In _International conference on learning representations_, 2021.
* Zhou et al. [2022] Tian Zhou, Ziqing Ma, Qingsong Wen, Xue Wang, Liang Sun, and Rong Jin. Fedformer: Frequency enhanced decomposed transformer for long-term series forecasting. In _International conference on machine learning_, pages 27268-27286. PMLR, 2022.
* Kitaev et al. [2020] Nikita Kitaev, Lukasz Kaiser, and Anselm Levskaya. Reformer: The efficient transformer. In _ICLR_, 2020.
* Zhang and Yan [2023] Yunhao Zhang and Junchi Yan. Crossformer: Transformer utilizing cross-dimension dependency for multivariate time series forecasting. In _The eleventh international conference on learning representations_, 2023.
* Liu et al. [2024] Yong Liu, Tengge Hu, Haoran Zhang, Haixu Wu, Shiyu Wang, Lintao Ma, and Mingsheng Long.transformer: Inverted transformers are effective for time series forecasting. In _The Twelfth International Conference on Learning Representations_, 2024. URL https://openreview.net/forum?id=JePfAI8fah.
* Zhang et al. [2023] Michael Zhang, Khaled Kamal Saab, Michael Poli, Tri Dao, Karan Goel, and Christopher Re. Effectively modeling time series with simple discrete state spaces. In _The Eleventh International Conference on Learning Representations_, 2023. URL https://openreview.net/forum?id=2EpjkjzdCAa.
* Nie et al. [2023] Yuqi Nie, Nam H Nguyen, Phanwadee Sinthong, and Jayant Kalagnanam. A time series is worth 64 words: Long-term forecasting with transformers. In _The Eleventh International Conference on Learning Representations_, 2023. URL https://openreview.net/forum?id=Jbdc0vT0col.
* Chen et al. [2023] Si-An Chen, Chun-Liang Li, Nate Yoder, Sercan O Arik, and Tomas Pfister. Tsmixer: An all-mlp architecture for time series forecasting. _arXiv preprint arXiv:2303.06053_, 2023.
* Behrouz et al. [2024] Ali Behrouz, Michele Santacatterina, and Ramin Zabih. Mambamixer: Efficient selective state space models with dual token and channel selection. _arXiv preprint arXiv:2403.19888_, 2024.
* Nguyen et al. [2022] Eric Nguyen, Karan Goel, Albert Gu, Gordon Downs, Preey Shah, Tri Dao, Stephen Baccus, and Christopher Re. S4nd: Modeling images and videos as multidimensional signals with state spaces. _Advances in neural information processing systems_, 35:2846-2861, 2022.
* Gu and Dao [2023] Albert Gu and Tri Dao. Mamba: Linear-time sequence modeling with selective state spaces. _arXiv preprint arXiv:2312.00752_, 2023.

* Gu et al. [2022] Albert Gu, Karan Goel, and Christopher Re. Efficiently modeling long sequences with structured state spaces. In _International Conference on Learning Representations_, 2022. URL https://openreview.net/forum?id=uYLFo2lv1AC.
* Kung et al. [1977] Sun-Yuan Kung, Bernard C Levy, Martin Morf, and Thomas Kailath. New results in 2-d systems theory, part ii: 2-d state-space models--realization and the notions of controllability, observability, and minimality. _Proceedings of the IEEE_, 65(6):945-961, 1977.
* Fornasini and Marchesini [1978] Ettore Fornasini and Giovanni Marchesini. Doubly-indexed dynamical systems: State-space models and structural properties. _Mathematical systems theory_, 12(1):59-72, 1978.
* Eising [1978] Rikus Eising. Realization and stabilization of 2-d systems. _IEEE Transactions on Automatic Control_, 23(5):793-799, 1978.
* Hinamoto [1980] Ts Hinamoto. Realizations of a state-space model from two-dimensional input-output map. _IEEE Transactions on Circuits and Systems_, 27(1):36-44, 1980.
* Warden [2018] Pete Warden. Speech commands: A dataset for limited-vocabulary speech recognition. _arXiv preprint arXiv:1804.03209_, 2018.
* Hebart et al. [2023] Martin N Hebart, Oliver Contier, Lina Teichmann, Adam H Rockter, Charles Y Zheng, Alexis Kidder, Anna Corriveau, Maryam Vaziri-Pashkam, and Chris I Baker. Things-data, a multimodal collection of large-scale datasets for investigating object representations in human brain and behavior. _Elife_, 12:e82580, 2023.
* Johnson et al. [2023] Alistair EW Johnson, Lucas Bulgarelli, Lu Shen, Alvin Gayles, Ayad Shammout, Steven Horng, Tom J Pollard, Sicheng Hao, Benjamin Moody, Brian Gow, et al. Mimic-iv, a freely accessible electronic health record dataset. _Scientific data_, 10(1):1, 2023.
* Tallec and Ollivier [2018] Corentin Tallec and Yann Ollivier. Can recurrent neural networks warp time? In _International Conference on Learning Representations_, 2018. URL https://openreview.net/forum?id=SJcKhk-Ab.
* Gu et al. [2023] Albert Gu, Isys Johnson, Aman Timalsina, Atri Rudra, and Christopher Re. How to train your HIPPO: State space models with generalized orthogonal basis projections. In _International Conference on Learning Representations_, 2023. URL https://openreview.net/forum?id=k1K170Q3KB.
* Gu et al. [2020] Albert Gu, Caglar Gulcehre, Thomas Paine, Matt Hoffman, and Razvan Pascanu. Improving the gating mechanism of recurrent neural networks. In _International Conference on Machine Learning_, pages 3800-3809. PMLR, 2020.
* Gu et al. [2022] Albert Gu, Karan Goel, Ankit Gupta, and Christopher Re. On the parameterization and initialization of diagonal state space models. In Alice H. Oh, Alekh Agarwal, Danielle Belgrave, and Kyunghyun Cho, editors, _Advances in Neural Information Processing Systems_, 2022. URL https://openreview.net/forum?id=yJE7iQSAep.
* Gu et al. [2021] Albert Gu, Isys Johnson, Karan Goel, Khaled Saab, Tri Dao, Atri Rudra, and Christopher Re. Combining recurrent, convolutional, and continuous-time models with linear state space layers. _Advances in neural information processing systems_, 34:572-585, 2021.
* Wang et al. [2023] Junxiong Wang, Jing Nathan Yan, Albert Gu, and Alexander Rush. Pretraining without attention. In Houda Bouamor, Juan Pino, and Kalika Bali, editors, _Findings of the Association for Computational Linguistics: EMNLP 2023_, pages 58-69, Singapore, December 2023. Association for Computational Linguistics. doi: 10.18653/v1/2023.findings-emnlp.5. URL https://aclanthology.org/2023.findings-emnlp.5.
* Behrouz and Hashemi [2024] Ali Behrouz and Farnoosh Hashemi. Graph mamba: Towards learning on graphs with state space models. In _Proceedings of the 30th ACM SIGKDD Conference on Knowledge Discovery and Data Mining_, pages 119-130, 2024.
* Baron et al. [2024] Ethan Baron, Itamar Zimerman, and Lior Wolf. A 2-dimensional state space layer for spatial inductive bias. In _The Twelfth International Conference on Learning Representations_, 2024. URL https://openreview.net/forum?id=BGRqypmGvm.

* Smith et al. [2023] Jimmy T.H. Smith, Andrew Warrington, and Scott Linderman. Simplified state space layers for sequence modeling. In _The Eleventh International Conference on Learning Representations_, 2023. URL https://openreview.net/forum?id=Ai8Hu3X4yks.
* Toner and Darlow [2024] William Toner and Luke Darlow. An analysis of linear time series forecasting models. _International conference on machine learning (ICML)_, 2024.
* Qin et al. [2023] Zhen Qin, Songlin Yang, and Yiran Zhong. Hierarchically gated recurrent neural network for sequence modeling. _Advances in Neural Information Processing Systems_, 36, 2023.
* Ramachandran et al. [2017] Prajit Ramachandran, Barret Zoph, and Quoc V Le. Searching for activation functions. _arXiv preprint arXiv:1710.05941_, 2017.
* Touvron et al. [2023] Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothe Lacroix, Baptiste Roziere, Naman Goyal, Eric Hambro, Faisal Azhar, et al. Llama: Open and efficient foundation language models. _arXiv preprint arXiv:2302.13971_, 2023.
* Das et al. [2023] Abhimanyu Das, Weihao Kong, Andrew Leach, Shaan K Mathur, Rajat Sen, and Rose Yu. Long-term forecasting with tiDE: Time-series dense encoder. _Transactions on Machine Learning Research_, 2023. ISSN 2835-8856. URL https://openreview.net/forum?id=pCbC3aQb5W.
* Liu et al. [2022] Minhao Liu, Ailing Zeng, Muxi Chen, Zhijian Xu, Qiuxia Lai, Lingna Ma, and Qiang Xu. Scinet: Time series modeling and forecasting with sample convolution and interaction. _Advances in Neural Information Processing Systems_, 35:5816-5828, 2022.
* Patro and Agneeswaran [2024] Badri N. Patro and Vijay S. Agneeswaran. Simba: Simplified mamba-based architecture for vision and multivariate time series, 2024.
* Li et al. [2023] Zhe Li, Shiyi Qi, Yiduo Li, and Zenglin Xu. Revisiting long-term time series forecasting: An investigation on linear mapping. _arXiv preprint arXiv:2305.10721_, 2023.
* Zeng et al. [2023] Ailing Zeng, Muxi Chen, Lei Zhang, and Qiang Xu. Are transformers effective for time series forecasting? In _Proceedings of the AAAI conference on artificial intelligence_, volume 37, pages 11121-11128, 2023.
* Bagnall et al. [2018] Anthony Bagnall, Hoang Anh Dau, Jason Lines, Michael Flynn, James Large, Aaron Bostrom, Paul Southam, and Eamonn Keogh. The uea multivariate time series classification archive, 2018. _arXiv preprint arXiv:1811.00075_, 2018.
* Mathur and Tippenhauer [2016] Aditya P Mathur and Nils Ole Tippenhauer. Swat: A water treatment testbed for research and training on is security. In _2016 international workshop on cyber-physical systems for smart water networks (CySWater)_, pages 31-36. IEEE, 2016.
* Abdulaal et al. [2021] Ahmed Abdulaal, Zhuanghua Liu, and Tomer Lancewicki. Practical approach to asynchronous multivariate time series anomaly detection and localization. In _Proceedings of the 27th ACM SIGKDD conference on knowledge discovery & data mining_, pages 2485-2494, 2021.
* Hundman et al. [2018] Kyle Hundman, Valentino Constantinou, Christopher Laporte, Ian Colwell, and Tom Soderstrom. Detecting spacecraft anomalies using lstms and nonparametric dynamic thresholding. In _Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery & data mining_, pages 387-395, 2018.
* Godahewa et al. [2021] Rakshitha Godahewa, Christoph Bergmeir, Geoffrey I Webb, Rob J Hyndman, and Pablo Montero-Manso. Monash time series forecasting archive. _arXiv preprint arXiv:2105.06643_, 2021.
* Challu et al. [2022] Cristian Challu, Kin G Olivares, Boris N Oreshkin, Federico Garza, Max Mergenthaler, and Artur Dubrawski. N-hits: Neural hierarchical interpolation for time series forecasting. _arXiv preprint arXiv:2201.12886_, 2022.
* Oreshkin et al. [2019] Boris N Oreshkin, Dmitri Carpov, Nicolas Chapados, and Yoshua Bengio. N-BEATS: Neural basis expansion analysis for interpretable time series forecasting. _ICLR_, 2019.

* Zhang et al. [2022] T. Zhang, Yizhuo Zhang, Wei Cao, J. Bian, Xiaohan Yi, Shun Zheng, and Jian Li. Less is more: Fast multivariate time series forecasting with light sampling-oriented mlp structures. _arXiv preprint arXiv:2207.01186_, 2022.
* Liu et al. [2022] Yong Liu, Haixu Wu, Jianmin Wang, and Mingsheng Long. Non-stationary transformers: Rethinking the stationarity in time series forecasting. In _NeurIPS_, 2022.
* Hochreiter and Schmidhuber [1997] S. Hochreiter and J. Schmidhuber. Long short-term memory. _Neural Comput._, 1997.
* Gu et al. [2020] Albert Gu, Tri Dao, Stefano Ermon, Atri Rudra, and Christopher Re. Hippo: Recurrent memory with optimal polynomial projections. _Advances in neural information processing systems_, 33:1474-1487, 2020.
* Martin and Cundy [2018] Eric Martin and Chris Cundy. Parallelizing linear recurrent neural nets over sequence length. In _International Conference on Learning Representations_, 2018. URL https://openreview.net/forum?id=HyUNuUL-.
* Box and Jenkins [1968] George EP Box and Gwilym M Jenkins. Some recent advances in forecasting and control. _Journal of the Royal Statistical Society. Series C (Applied Statistics)_, 17(2):91-109, 1968.
* Chung et al. [2014] Junyoung Chung, Caglar Gulcehre, KyungHyun Cho, and Yoshua Bengio. Empirical evaluation of gated recurrent neural networks on sequence modeling. _arXiv preprint arXiv:1412.3555_, 2014.
* Salinas et al. [2020] David Salinas, Valentin Flunkert, Jan Gasthaus, and Tim Januschowski. Deepar: Probabilistic forecasting with autoregressive recurrent networks. _International journal of forecasting_, 36(3):1181-1191, 2020.
* Yang et al. [2024] Songlin Yang, Bailin Wang, Yikang Shen, Rameswar Panda, and Yoon Kim. Gated linear attention transformers with hardware-efficient training. In _International conference on machine learning (ICML)_, 2024.
* Katharopoulos et al. [2020] Angelos Katharopoulos, Apoorv Vyas, Nikolaos Pappas, and Francois Fleuret. Transformers are rnns: Fast autoregressive transformers with linear attention. In _International conference on machine learning_, pages 5156-5165. PMLR, 2020.
* Schlag et al. [2021] Imanol Schlag, Kazuki Irie, and Jurgen Schmidhuber. Linear transformers are secretly fast weight programmers. In _International Conference on Machine Learning_, pages 9355-9366. PMLR, 2021.
* Ma et al. [2024] Jun Ma, Feifei Li, and Bo Wang. U-mamba: Enhancing long-range dependency for biomedical image segmentation. _arXiv preprint arXiv:2401.04722_, 2024.
* Liu et al. [2024] Yue Liu, Yunjie Tian, Yuzhong Zhao, Hongtian Yu, Lingxi Xie, Yaowei Wang, Qixiang Ye, and Yunfan Liu. Vmamba: Visual state space model. _arXiv preprint arXiv:2401.10166_, 2024.
* Schiff et al. [2024] Yair Schiff, Chia-Hsiang Kao, Aaron Gokaslan, Tri Dao, Albert Gu, and Volodymyr Kuleshov. Caduceus: Bi-directional equivariant long-range dna sequence modeling. _arXiv preprint arXiv:2403.03234_, 2024.
* Jia et al. [2023] Yuxin Jia, Youfang Lin, Xinyan Hao, Yan Lin, Shengnan Guo, and Huaiyu Wan. WITRAN: Water-wave information transmission and recurrent acceleration network for long-range time series forecasting. In _Thirty-seventh Conference on Neural Information Processing Systems_, 2023. URL https://openreview.net/forum?id=y08bkEtNBK.
* Ilbert et al. [2024] Romain Ilbert, Ambroise Odonnat, Vasilii Feofanov, Aladin Virmaux, Giuseppe Paolo, Themis Palpanas, and Ievgen Redko. Unlocking the potential of transformers in time series forecasting with sharpness-aware minimization and channel-wise attention. _arXiv preprint arXiv:2402.10198_, 2024.
* Zhou et al. [2022] Tian Zhou, Ziqing Ma, Qingsong Wen, Liang Sun, Tao Yao, Wotao Yin, Rong Jin, et al. Film: Frequency improved legendre memory model for long-term time series forecasting. _Advances in Neural Information Processing Systems_, 35:12677-12690, 2022.

* [84] Yong Liu, Chenyu Li, Jianmin Wang, and Mingsheng Long. Koopa: Learning non-stationary time series dynamics with koopman predictors. _Advances in Neural Information Processing Systems_, 36, 2023.
* [85] Rui Wang, Yihe Dong, Sercan O Arik, and Rose Yu. Koopman neural operator forecaster for time-series with temporal distributional shifts. In _The Eleventh International Conference on Learning Representations_, 2023.
* [86] Yong Liu, Haixu Wu, Jianmin Wang, and Mingsheng Long. Non-stationary transformers: Exploring the stationarity in time series forecasting. _Advances in Neural Information Processing Systems_, 35:9881-9893, 2022.
* [87] Chi-Tsong Chen. _Linear system theory and design_. Saunders college publishing, 1984.
* [88] Guokun Lai, Wei-Cheng Chang, Yiming Yang, and Hanxiao Liu. Modeling long-and short-term temporal patterns with deep neural networks. In _SIGIR_, 2018.
* [89] Shiyang Li, Xiaoyong Jin, Yao Xuan, Siyou Zhou, Wenhu Chen, Yu-Xiang Wang, and Xifeng Yan. Enhancing the locality and breaking the memory bottleneck of transformer on time series forecasting. In _NeurIPS_, 2019.
* [90] Jean-Yves Franceschi, Aymeric Dieuleveut, and Martin Jaggi. Unsupervised scalable representation learning for multivariate time series. In _NeurIPS_, 2019.
* [91] Jiehui Xu, Haixu Wu, Jianmin Wang, and Mingsheng Long. Anomaly transformer: Time series anomaly detection with association discrepancy. In _ICLR_, 2021.

Background

### 1D Space State Models

1D Space State Models (SSMs) are linear time-invariant systems that map input sequence \(x(t)\in\mathbb{R}^{L}\mapsto y(t)\in\mathbb{R}^{L}\)[13]. SSMs use a latent state \(h(t)\in\mathbb{R}^{N\times L}\), transition parameter \(\mathbf{A}\in\mathbb{R}^{N\times N}\), and projection parameters \(\mathbf{B}\in\mathbb{R}^{N\times 1},\mathbf{C}\in\mathbb{R}^{1\times N}\) to model the input and output as:

\[h^{\prime}(t)=\mathbf{A}\;h(t)+\mathbf{B}\;x(t),\qquad\qquad y(t)=\mathbf{C}\;h (t).\] (18)

Most existing SSMs [33, 34, 31], first discretize the signals \(\mathbf{A},\mathbf{B}\), and \(\mathbf{C}\). That is, using a parameter \(\mathbf{\Delta}\) and zero-order hold, the discretized formulation is defined as:

\[h_{t}=\bar{\mathbf{A}}\;h_{t-1}+\bar{\mathbf{B}}\;x_{t},\qquad\qquad y_{t}= \mathbf{C}\;h_{t},\] (19)

where \(\bar{\mathbf{A}}=\exp\left(\mathbf{\Delta}\mathbf{A}\right)\) and \(\bar{\mathbf{B}}=\left(\mathbf{\Delta}\mathbf{A}\right)^{-1}\left(\exp\left( \mathbf{\Delta}\mathbf{A}-I\right)\right)\;\mathbf{\Delta}\mathbf{B}\). [70] show that discrete SSMs can be interpreted as both convolutions and recurrent networks: i.e.,

\[\bar{\mathbf{K}}=\left(\mathbf{C}\bar{\mathbf{B}},\mathbf{C} \bar{\mathbf{A}}\bar{\mathbf{B}},\ldots,\mathbf{C}\bar{\mathbf{A}}^{L-1}\bar{ \mathbf{B}}\right),\] \[y=x*\bar{\mathbf{K}},\] (20)

which makes their training and inference very efficient as a convolution and recurrent model, respectively.

### Data Dependency

Above discrete SSMs are based on data-independent parameters. That is, parameters \(\mathbf{\Delta}\), \(\bar{\mathbf{A}}\), \(\bar{\mathbf{B}}\), and \(\mathbf{C}\) are time invariant and are the same for any input. Gu and Dao [33] argue that this time invariance has the cost of limiting SSMs effectiveness in compressing context into a smaller state [33]. To overcome this challenge, they present a selective SSMs (S6) block that effectively selects relevant context by enabling dependence of the parameters \(\bar{\mathbf{B}}\), \(\bar{\mathbf{C}}\), and \(\mathbf{\Delta}\) on the input \(x_{t}\), i.e.:

\[\bar{\mathbf{B}}_{t} =\texttt{Linear}_{\bar{\mathbf{B}}}(x_{t})\] (21) \[\bar{\mathbf{C}}_{t} =\texttt{Linear}_{\mathbf{C}}(x_{t})\] (22) \[\mathbf{\Delta}_{t} =\texttt{Softplus}\left(\texttt{Linear}_{\mathbf{\Delta}}(x_{t}) \right),\] (23)

where \(\texttt{Linear}(.)\) is a linear projection and \(\texttt{Softplus}(.)=\log(1+\exp(.))\). This data dependency comes at the cost of efficiency as the model cannot be trained as a convolution. To overcome this challenge, Gu and Dao [33] show that the linear recurrence in Equation 1 can be formulated as an associative scan [71], which accepts efficient parallel algorithms.

## Appendix B Additional Related Work

**Classical Approach.** Modeling time series data is a long-standing problem and has attracted much attention during the past 60 years. There have been several mathematical models to capture the time series traits like exponential smoothing[16], autoregressive integrated moving average (ARIMA) [14], SARIMA [15], Box-Jenkins method [72], and more recently state-space models [12, 13]. Despite their more interpretability, these methods usually fail to capture non-linear dependencies and also often require manually analyzing time series features (e.g., trend or seasonality), resulting in lack of generalizability.

**Recurrent and Deep State Space Models.** Another group of relevant studies to ours is deep sequence models. A common class of architectures for sequence modeling are recurrent neural networks such as like GRUs [73], DeepAR [74], LSTMs [69]. The main drawback of RNNs is their potential for vanishing/exploding gradients and also their slow training. Recently, linear attention methods with fast training attracted attention [75, 76, 77]. Katharopoulos et al. [76] show that these methods have recurrent formulation and can be fast in inference.

Recently, deep state space models have attracted much attention as the alternative of Transformers [17], due to their fast training and inference [70]. These methods are the combination of traditional SSMswith deep neural networks by directly parameterizing the layers of a neural network with multiple linear SSMs, and overcome common recurrent training drawbacks by leveraging the convolutional view of SSMs [70, 45, 46, 34, 50]. Recently, Gu and Dao [33] present a new formulation of deep SSMs by allowing the parameters to be the function of inputs. This architecture shows promissing potential in various domains like NLP [33], vision [78, 79, 31], graphs [48], DNA modeling [33, 80].

All the above methods are design for 1D data, meaning that the states depends on one variable. There are, however, a few studies that uses 2D SSMs in deep learning settings. S4ND [32] uses continuous signals to model images. These methods not only consider two separate SSM for the axes, but it also directly treat the system as a continuous system without discretization step. Furthermore, S4ND has data-independent parameters. Another similar approach is 2DSSM [49], that models images as discrete signals. That is, the initial SSM model is discrete and again there is a lack of discretization step, which is important for time series as we discussed earlier. Also, their method again is based on data-independent parameters. Both S4ND and 2DSSM can be computed as a convolution. We, however, present a new scanning technique for fast training of 2D SSMs, even with input-dependent parameters.

WITRAN [81] is a 2D RNN approach for _univariate_ time series, which is different from our approaches from different aspects: (1) Goal: The main goal of WITRAN is to use 2D RNN to model univariate time series data. That is, the first dimension corresponds to short-term, and the second dimension corresponds to long-term patterns. On the other hand, our 2D SSM aims to model multivariate time series where the first dimension corresponds to time, and the second dimension corresponds to variates. (2) Backbone: WITRAN is based on GSC (LSTM-like cell), which uses non-linear transition. Our 2D SSM is based on state space models, is simpler, and uses linear transitions. (3) Data-dependency: WITRAN is based on data-independent parameters, meaning that it uses the same transition process for all time steps. 2D SSM, however, is based on data-dependent parameters, which allows it to filter irrelevant/noisy time steps. (4) Recurrence, Hidden States, and Training: Although both models have recurrent form, WITRAN's recurrence is over extracted short-term and long-term patterns. Our 2D SSM's recurrence, however, is over time and variate dimensions. WITRAN uses only one hidden state for each state of the system, while 2D SSM uses 2 different hidden states for each state of the system, allowing more flexibility to capture cross-variate and cross-time information.

Other methods.Transformer-based models have attracted much attention over recent years for multivariate time series forecasting, when modeling the complex relationships of co-variates or along the time dimension is required [24, 25, 26, 11, 6, 23, 21, 82, 29]. Several studies have focused on designing more efficient and effective attentions with using special traits of time series [20]. Some other studies have focused on extracting long-term information for better forecasting [29, 83]. In addition to transformers, linear models also have shown promising results [8, 30]. For example, Chen et al. [30] present TSMixer, an all-MLP architecture for time series forecasting, with promising performance. Due to the expressive power of our 2D SSM, these linear methods sometimes can be viewed as a special case of 2D SSMs. Recently, convolution-based models for time series have shown promising results [9]. These methods by using global kernels enhance the global receptive field. Our data-independent formulation of Chimera is connected to this line of work as it can be written as a global convolution.

Recently, Koopman-based deep models [84, 85] are designed to capture non-linear dependencies in the data. Existing methods, however, does not consider dynamics in different variates and might miss complex dependencies of variates. Moreover, despite their promising results in the time series forecasting, these approaches can be hard to be parallelizable and so might have longer training for large models.

## Appendix C Details of the Discretization

Given PDE with initial condition \(h(0,0)=0\):\[\frac{\partial}{\partial t^{(1)}}h^{(1)}\left(t^{(1)},t^{(2)}\right) =\left({\bf A}_{1}h^{(1)}\left(t^{(1)},t^{(2)}\right),{\bf A}_{2}h^ {(2)}\left(t^{(1)},t^{(2)}\right)\right)+{\bf B}_{1}{\bf x}\left(t^{(1)},t^{(2 )}\right),\] (24) \[\frac{\partial}{\partial t^{(1)}}h^{(2)}\left(t^{(1)},t^{(2)}\right) =\left({\bf A}_{1}h^{(1)}\left(t^{(1)},t^{(2)}\right),{\bf A}_{2}h^ {(2)}\left(t^{(1)},t^{(2)}\right)\right)+{\bf B}_{1}{\bf x}\left(t^{(1)},t^{(2 )}\right),\] (25) \[\frac{\partial}{\partial t^{(2)}}h^{(1)}\left(t^{(1)},t^{(2)}\right) =\left({\bf A}_{3}h^{(1)}\left(t^{(1)},t^{(2)}\right),{\bf A}_{4}h^ {(2)}\left(t^{(1)},t^{(2)}\right)\right)+{\bf B}_{2}{\bf x}\left(t^{(1)},t^{(2 )}\right),\] (26) \[\frac{\partial}{\partial t^{(2)}}h^{(2)}\left(t^{(1)},t^{(2)}\right) =\left({\bf A}_{3}h^{(1)}\left(t^{(1)},t^{(2)}\right),{\bf A}_{4}h^ {(2)}\left(t^{(1)},t^{(2)}\right)\right)+{\bf B}_{2}{\bf x}\left(t^{(1)},t^{(2 )}\right),\] (27)

over the sampling intervals \([k\Delta t^{(1)},(k+1)\Delta t^{(1)}]\) and \([\ell\Delta t^{(2)},(\ell+1)\Delta t^{(2)}]\) we have:

\[\int_{k\Delta t^{(1)}}^{(k+1)\Delta t^{(1)}}\frac{\partial}{ \partial t^{(1)}}h^{(1)}\left(t^{(1)},t^{(2)}\right)\,dt^{(1)}\] (28) \[= \int_{k\Delta t^{(1)}}^{(k+1)\Delta t^{(1)}}\left({\bf A}_{1}h^ {(1)}\left(t^{(1)},t^{(2)}\right)+{\bf B}_{1}^{(1)}{\bf x}^{(1)}\left(t^{(1)},t^{(2)}\right)\right)\,dt^{(1)}\]

and so:

\[\int_{k\Delta t^{(1)}}^{(k+1)\Delta t^{(1)}}\frac{\partial}{ \partial t^{(1)}}h^{(2)}\left(t^{(1)},t^{(2)}\right)\,dt^{(1)}\] (29) \[= \int_{k\Delta t^{(1)}}^{(k+1)\Delta t^{(1)}}\left({\bf A}_{2}h^ {(2)}\left(t^{(1)},t^{(2)}\right)+{\bf B}_{1}^{(2)}{\bf x}^{(2)}\left(t^{(1)},t^{(2)}\right)\right)\,dt^{(1)}\]

Similarly, for the second equation we have:

\[\int_{\ell\Delta t^{(2)}}^{(\ell+1)\Delta t^{(2)}}\frac{\partial} {\partial t^{(2)}}h^{(1)}\left(t^{(1)},t^{(2)}\right)\,dt^{(2)}\] (30) \[= \int_{\ell\Delta t^{(2)}}^{(\ell+1)\Delta t^{(2)}}\left({\bf A}_ {3}h^{(1)}\left(t^{(1)},t^{(2)}\right)+{\bf B}_{2}^{(1)}{\bf x}^{(1)}\left(t ^{(1)},t^{(2)}\right)\right)\,dt^{(2)}\]

and so:

\[\int_{\ell\Delta t^{(2)}}^{(\ell+1)\Delta t^{(2)}}\frac{\partial} {\partial t^{(2)}}h^{(2)}\left(t^{(1)},t^{(2)}\right)\,dt^{(2)}\] (31) \[= \int_{\ell\Delta t^{(2)}}^{(\ell+1)\Delta t^{(2)}}\left({\bf A}_ {4}h^{(2)}\left(t^{(1)},t^{(2)}\right)+{\bf B}_{2}^{(2)}{\bf x}^{(2)}\left(t^{ (1)},t^{(2)}\right)\right)\,dt^{(2)}\]

Next, the integrals can be simplified as:

\[h^{(1)}\left((k+1)\Delta t^{(1)},t^{(2)}\right)\] (32) \[= e^{{\bf A}_{1}\Delta t^{(1)}}h^{(1)}\left(k\Delta t^{(1)},t^{(2) }\right)+\int_{k\Delta t^{(1)}}^{(k+1)\Delta t^{(1)}}e^{{\bf A}_{1}(t^{(1)}-k \Delta t^{(1)})}{\bf B}_{1}^{(1)}{\bf x}^{(1)}\left(t^{(1)},t^{(2)}\right)\,dt ^{(1)},\]

and

\[h^{(2)}\left((k+1)\Delta t^{(1)},t^{(2)}\right)\] (33) \[= e^{{\bf A}_{2}\Delta t^{(1)}}h^{(2)}\left(k\Delta t^{(1)},t^{(2) }\right)+\int_{k\Delta t^{(1)}}^{(k+1)\Delta t^{(1)}}e^{{\bf A}_{2}(t^{(1)}-k \Delta t^{(1)})}{\bf B}_{1}^{(2)}{\bf x}^{(2)}\left(t^{(1)},t^{(2)}\right)\,dt ^{(1)},\]

and similarly for the third and fourth equations we have:

\[h^{(1)}\left(t^{(1)},(\ell+1)\Delta t^{(2)}\right)\] (34) \[= e^{{\bf A}_{3}\Delta t^{(2)}}h^{(1)}\left(t^{(1)},\ell\Delta t^{( 2)}\right)+\int_{\ell\Delta t^{(2)}}^{(\ell+1)\Delta t^{(2)}}e^{{\bf A}_{3}(t^ {(2)}-\ell\Delta t^{(2)})}{\bf B}_{2}^{(1)}{\bf x}^{(1)}\left(t^{(2)},t^{(1)} \right)\,dt^{(2)}\]\[h^{(2)}\left(t^{(1)},(\ell+1)\Delta t^{(2)}\right)\] \[=e^{\mathbf{A}_{4}\Delta t^{(2)}}h^{(2)}\left(t^{(1)},\ell\Delta t ^{(2)}\right)+\int_{\ell\Delta t^{(2)}}^{(\ell+1)\Delta t^{(2)}}e^{\mathbf{A}_ {4}(t^{(2)}-\ell\Delta t^{(2)})}\mathbf{B}_{2}^{(2)}\mathbf{x}^{(2)}\left(t^{( 2)},t^{(1)}\right)\,dt^{(2)}\] (35)

Using ZOH assumption, we have:

\[\int_{0}^{\Delta t^{(1)}}e^{\mathbf{A}_{1}s}\,ds =\mathbf{A}^{(1)^{-1}}\left(e^{\mathbf{A}_{1}\Delta t^{(1)}}- \mathbf{I}\right)\] \[\int_{0}^{\Delta t^{(1)}}e^{\mathbf{A}_{2}s}\,ds =\mathbf{A}^{(2)^{-1}}\left(e^{\mathbf{A}_{2}\Delta t^{(1)}}- \mathbf{I}\right)\] (36) \[\int_{0}^{\Delta t^{(2)}}e^{\mathbf{A}_{3}s}\,ds =\mathbf{A}^{(3)^{-1}}\left(e^{\mathbf{A}_{3}\Delta t^{(2)}}- \mathbf{I}\right)\] (37) \[\int_{0}^{\Delta t^{(2)}}e^{\mathbf{A}_{4}s}\,ds =\mathbf{A}^{(4)^{-1}}\left(e^{\mathbf{A}_{4}\Delta t^{(2)}}- \mathbf{I}\right)\] (38)

Accordingly, the discretized form is as follows:

\[h_{k+1,\ell}^{(1)} =e^{\mathbf{A}_{1}\Delta t^{(1)}}h_{k,\ell}^{(1)}+\mathbf{A}^{( 1)^{-1}}\left(e^{\mathbf{A}_{1}\Delta t^{(1)}}-\mathbf{I}\right)\mathbf{B}_{ 1}^{(1)}\mathbf{x}_{k+1,\ell}^{(1)}\] (39) \[h_{k+1,\ell}^{(2)} =e^{\mathbf{A}_{2}\Delta t^{(1)}}h_{k,\ell}^{(2)}+\mathbf{A}^{(2 )^{-1}}\left(e^{\mathbf{A}_{2}\Delta t^{(1)}}-\mathbf{I}\right)\mathbf{B}_{ 1}^{(2)}\mathbf{x}_{k+1,\ell}^{(2)}\] (40) \[h_{k,\ell+1}^{(1)} =e^{\mathbf{A}_{3}\Delta t^{(2)}}h_{k,\ell}^{(1)}+\mathbf{A}^{(3 )^{-1}}\left(e^{\mathbf{A}_{3}\Delta t^{(2)}}-\mathbf{I}\right)\mathbf{B}_{ 2}^{(1)}\mathbf{x}_{k,\ell+1}^{(1)}\] (41) \[h_{k,\ell+1}^{(2)} =e^{\mathbf{A}_{4}\Delta t^{(2)}}h_{k,\ell}^{(2)}+\mathbf{A}^{(4 )^{-1}}\left(e^{\mathbf{A}_{4}\Delta t^{(2)}}-\mathbf{I}\right)\mathbf{B}_{ 2}^{(2)}\mathbf{x}_{k,\ell+1}^{(2)},\] (42)

which means that:

\[\bar{\mathbf{A}}_{1} =\exp\left(\mathbf{A}_{1}\Delta_{1}\right),\] (43) \[\bar{\mathbf{A}}_{2} =\exp\left(\mathbf{A}_{2}\Delta_{1}\right),\] (44) \[\bar{\mathbf{A}}_{3} =\exp\left(\mathbf{A}_{3}\Delta_{2}\right),\] (45) \[\bar{\mathbf{A}}_{4} =\exp\left(\mathbf{A}_{4}\Delta_{2}\right),\] (46)

and

\[\bar{\mathbf{B}}_{1} =\begin{bmatrix}\mathbf{A}^{(1)^{-1}}\left(e^{\mathbf{A}_{1} \Delta_{1}}-\mathbf{I}\right)\mathbf{B}_{1}^{(1)}\\ \mathbf{A}^{(2)^{-1}}\left(e^{\mathbf{A}_{2}\Delta_{1}}-\mathbf{I}\right) \mathbf{B}_{1}^{(2)}\end{bmatrix},\] (48) \[\bar{\mathbf{B}}_{2} =\begin{bmatrix}\mathbf{A}^{(3)^{-1}}\left(e^{\mathbf{A}_{3} \Delta_{2}}-\mathbf{I}\right)\mathbf{B}_{1}^{(1)}\\ \mathbf{A}^{(4)^{-1}}\left(e^{\mathbf{A}_{4}\Delta_{2}}-\mathbf{I}\right) \mathbf{B}_{2}^{(2)}\end{bmatrix}.\] (49)

## Appendix D Details of the Structure of Transition Matrices

**Definition D.1** (Companion Matrix).: _A matrix \(A\in\mathbb{R}^{N\times N}\) has companion form if it can be written as:_

\[A=\begin{pmatrix}0&0&\dots&0&a_{1}\\ 1&0&\dots&0&a_{2}\\ 0&1&\dots&0&a_{3}\\ \vdots&\vdots&\ddots&\vdots&\vdots\\ 0&0&\dots&0&a_{N_{1}}\\ 0&0&\dots&1&a_{N}\end{pmatrix}.\] (50)_These matrices can be decomposed into a shift and a low-rank matrix. That is:_

\[A=\begin{pmatrix}0&0&\dots&0&a_{1}\\ 1&0&\dots&0&a_{2}\\ 0&1&\dots&0&a_{3}\\ \vdots&\vdots&\ddots&\vdots&\vdots\\ 0&0&\dots&0&a_{N_{1}}\\ 0&0&\dots&1&a_{N}\end{pmatrix}=\underbrace{\begin{pmatrix}0&0&\dots&0&0\\ 1&0&\dots&0&0\\ 0&1&\dots&0&0\\ \vdots&\vdots&\ddots&\vdots&\vdots\\ 0&0&\dots&0&0\\ 0&0&\dots&1&0\end{pmatrix}}_{\text{Shift Matrix}}+\underbrace{\begin{pmatrix}0 &0&\dots&0&a_{1}\\ 0&0&\dots&0&a_{2}\\ 0&0&\dots&0&a_{3}\\ \vdots&\vdots&\ddots&\vdots&\vdots\\ 0&0&\dots&0&0\\ 0&0&\dots&0&a_{N}\end{pmatrix}}_{\text{Low-rank Matrix}}.\] (51)

This formulation can help us to compute the power of \(A\) faster in the convolutional form, as discussed by Zhang et al. [28].

## Appendix E Bidirectionality Across Variates

The causal nature of the 2D SSM result in limited information flow along the variate dimension as variate are not ordered. To overcome this challenge, inspired by the bi-directional 1D SSMs [47, 48, 1], we use two different modules for forward and backward pass along the variate dimension:

\[h_{v,t+1}^{(1)^{f}}=\bar{\mathbf{A}}_{1}^{f}h_{v,t}^{(1)}+\bar{ \mathbf{A}}_{2}^{f}h_{v,t}^{(2)^{f}}+\bar{\mathbf{B}}_{1}^{f}\mathbf{x}_{v,t+ 1},\] \[h_{v,t+1}^{(1)^{b}}=\bar{\mathbf{A}}_{1}^{b}h_{v,t}^{(1)}+\bar{ \mathbf{A}}_{2}^{b}h_{v,t}^{(2)}+\bar{\mathbf{B}}_{1}^{b}\mathbf{x}_{v,t+1},\] (52) \[h_{v+1,t}^{(2)^{f}}=\bar{\mathbf{A}}_{3}^{f}h_{v,t}^{(1)}+\bar{ \mathbf{A}}_{4}^{f}h_{v,t}^{(2)^{f}}+\bar{\mathbf{B}}_{2}^{f}\mathbf{x}_{v+1,t},\] \[h_{v-1,t}^{(2)^{b}}=\bar{\mathbf{A}}_{3}^{b}h_{v,t}^{(1)^{b}}+ \bar{\mathbf{A}}_{4}^{b}h_{v,t}^{(2)^{b}}+\bar{\mathbf{B}}_{2}^{b}\mathbf{x}_ {v-1,t},\] (53) \[\mathbf{y}_{v,t}^{f}=\mathbf{C}_{1}^{f}{h_{v,t}^{(1)^{f}}}+ \mathbf{C}_{2}^{f}{h_{v,t}^{(2)^{f}}},\] (54) \[\mathbf{y}_{v,t}^{b}=\mathbf{C}_{1}^{b}h_{v,t}^{(1)^{b}}+ \mathbf{C}_{2}^{b}h_{v,t}^{(2)^{b}},\] (55) \[\mathbf{y}_{v,t}=\mathbf{y}_{v,t}^{f}+\mathbf{y}_{v,t}^{b},\] (56)

where \(\bar{\mathbf{A}}_{1}^{\tau},\bar{\mathbf{A}}_{2}^{\tau},\bar{\mathbf{A}}_{3}^ {\tau},\bar{\mathbf{A}}_{4}^{\tau}\in\mathbb{R}^{N\times N}\), \(\bar{\mathbf{B}}_{1}^{\tau},\bar{\mathbf{B}}_{2}^{\tau}\in\mathbb{R}^{N \times 1}\), and \(\mathbf{C}_{1}^{\tau},\mathbf{C}_{2}^{\tau}\in\mathbb{R}^{1\times N}\) are parameters of the model, \(h_{v,t}^{(1)^{\tau}},h_{v,t}^{(2)^{f}}\in\mathbb{R}^{N\times d}\) are hidden states, \(\mathbf{x}_{v,t}\in\mathbb{R}^{1\times d}\) is the input, and \(\tau\in\{f,b\}\). Figure 2 illustrates the bi-directional recurrence process in Chimera. For the sake of simplicity, we continue with unidirectional pass, but adapting them for bi-directional setting is simple as we use two separate blocks, each of which for a direction.

## Appendix F Time Complexity of 2D-SSM

Let \(T\) be the length of the time series and \(V\) be the number of variates. Since for each variate we have \(\mathcal{O}(T)\) recurrence and we have \(V\) variates, the total number of recurrence is \(\mathcal{O}(TV)\). In each step, we have the matrix multiplication of transition matrices \(A_{i}\) with the hidden states and also \(B_{i}\)s with the input. Accordingly, if we use \(d\) as the state dimension, the complexity is \(\mathcal{O}(d^{2}TV)\). Given the fact that \(d\) is usually a small number, the overall complexity is linear with respect to each of \(V\) and \(T\).

## Appendix G Theoretical Results

### Proof of Theorem 3.2

In this part, we want to prove that \(\divideup\) is associative. This operator is defined as:

\[p\divideup q=\begin{pmatrix}p_{1}&p_{2}&p_{3}\\ p_{4}&p_{5}&p_{6}\end{pmatrix}\divideup\begin{pmatrix}q_{1}&q_{2}&q_{3}\\ q_{4}&q_{5}&q_{6}\end{pmatrix}=\begin{pmatrix}q_{1}\odot p_{1}&q_{2}\odot p _{2}&q_{1}\otimes p_{3}+q_{2}\otimes p_{6}+q_{3}\\ q_{4}\odot p_{4}&q_{5}\odot p_{5}&q_{4}\otimes p_{3}+q_{5}\otimes p_{6}+q_{6} \end{pmatrix}\]

Accordingly, we have:

\[(p\divideup q)\divideup r=\begin{pmatrix}q_{1}\odot p_{1}&q_{2}\odot p_{2}& q_{1}\otimes p_{3}+q_{2}\otimes p_{6}+q_{3}\\ q_{4}\odot p_{4}&q_{5}\odot p_{5}&q_{4}\otimes p_{3}+q_{5}\otimes p_{6}+q_{6} \end{pmatrix}\divideup r_{1}&r_{2}&r_{3}\end{pmatrix},\] (57)re-using the definition of \(\divide\), we have:

\[(p\divide\sigma)\divide r =\begin{pmatrix}q_{1}\odot p_{1}&q_{2}\odot p_{2}&q_{1}\otimes p_{3}+ q_{2}\otimes p_{6}+q_{3}\\ q_{4}\odot p_{4}&q_{5}\odot p_{5}&q_{4}\otimes p_{3}+q_{5}\otimes p_{6}+q_{6} \end{pmatrix}\divide\begin{pmatrix}r_{1}&r_{2}&r_{3}\\ r_{4}&r_{5}&r_{6}\end{pmatrix}\] (58) \[=\begin{pmatrix}r_{1}\odot(q_{1}\odot p_{1})&r_{2}\odot(q_{2} \odot p_{2})&r_{1}\otimes(q_{1}\otimes p_{3}+q_{2}\otimes p_{6}+q_{3})+r_{2} \odot(q_{4}\otimes p_{3}+q_{5}\otimes p_{6}+q_{6})+r_{3}\\ r_{4}\odot(q_{4}\odot p_{4})&r_{5}\odot(q_{5}\odot p_{5})&r_{4}\otimes(q_{1} \otimes p_{3}+q_{2}\otimes p_{6}+q_{3})+r_{4}\otimes(q_{4}\otimes p_{3}+q_{5} \otimes p_{6}+q_{6})+r_{6}\end{pmatrix}\] (59)

\begin{table}
\begin{tabular}{c l c c c c} \hline \hline Tasks & Dataset & Dim & Series Length & Dataset Size & Information (Frequency) \\ \hline \multirow{6}{*}{Forecasting (Long-term)} & ETTm1, ETTm2 & 7 & \{96,192, 336, 720\} & (34465, 11521, 11521) & Electricity (15 mins) \\ \cline{2-6}  & ETTh1, ETTh2 & 7 & \{96,192, 336, 720\} & (8545, 2881, 2881) & Electricity (15 mins) \\ \cline{2-6}  & Electricity & 321 & \{96,192, 336, 720\} & (18317, 2633, 5261) & Electricity (Hourly) \\ \cline{2-6}  & Traffic & 862 & \{96,192, 336, 720\} & (12185, 1757, 3509) & Transportation (Hourly) \\ \cline{2-6}  & Weather & 21 & \{96,192, 336, 720\} & (36792, 5271, 10540) & Weather (10 mins) \\ \cline{2-6}  & Exchange & 8 & \{96,192, 336, 720\} & (5120, 665, 1422) & Exchange rate (Daily) \\ \hline \multirow{6}{*}{Forecasting (short-term)} & M4-Yearly & 1 & 6 & (23000, 0, 23000) & Demographic \\ \cline{2-6}  & M4-Quarterly & 1 & 8 & (24000, 0, 24000) & Finance \\ \cline{2-6}  & M4-Monthly & 1 & 18 & (48000, 0, 48000) & Industry \\ \cline{2-6}  & M4-Weakly & 1 & 13 & (359, 0, 359) & Macro \\ \cline{2-6}  & M4-Daily & 1 & 14 & (4227, 0, 4227) & Micro \\ \cline{2-6}  & M4-Hourly & 1 & 48 & (414, 0, 414) & Other \\ \hline \multirow{6}{*}{Classification (UEA)} & EthanolConcentration & 3 & 1751 & (261, 0, 263) & Alcohol Industry \\ \cline{2-6}  & FaceDetection & 144 & 62 & (5890, 0, 3524) & Face (250Hz) \\ \cline{2-6}  & Handwriting & 3 & 152 & (150, 0, 850) & Handwriting \\ \cline{2-6}  & Heartbeat & 61 & 405 & (204, 0, 205) & Heart Beat \\ \cline{2-6}  & JapaneseVowels & 12 & 29 & (270, 0, 370) & Voice \\ \cline{2-6}  & PEMS-SF & 963 & 144 & (267, 0, 173) & Transportation (Daily) \\ \cline{2-6}  & SelfRegulationSCP1 & 6 & 896 & (268, 0, 293) & Health (256Hz) \\ \cline{2-6}  & SelfRegulationSCP2 & 7 & 1152 & (200, 0, 180) & Health (256Hz) \\ \cline{2-6}  & SpokenArabicDigits & 13 & 93 & (6599, 0, 2199) & Voice (11025Hz) \\ \cline{2-6}  & UWaveGestureLibrary & 3 & 315 & (120, 0, 320) & Gesture \\ \hline \multirow{6}{*}{Anomaly Detection} & SMD & 38 & 100 & (566724, 141681, 708420) & Server Machine \\ \cline{2-6}  & MSL & 55 & 100 & (44653, 11664, 73729) & Spacecraft \\ \cline{2-6}  & SMAP & 25 & 100 & (108146, 27037, 427617) & Spacecraft \\ \cline{2-6}  & SWaT & 51 & 100 & (396000, 99000, 449919) & Infrastructure \\ \cline{2-6}  & PSM & 25 & 100 & (105984, 26497, 87841) & Server Machine \\ \hline \hline \end{tabular}
\end{table}
Table 7: Dataset descriptions. The dataset size is organized in (Train, Validation, Test).

[MISSING_PAGE_FAIL:23]

for all inputs \(\mathbf{x}_{v,t}\) and \(i,j,k,\ell\in\{0,1\}\). Now, starting from \(\begin{pmatrix}\mathbf{S}_{0,0}^{(1)}\\ \mathbf{S}_{0,0}^{(2)}\end{pmatrix}=\begin{pmatrix}I&I&0\\ I&I&0\end{pmatrix}\), we have:

\[\begin{pmatrix}\mathbf{S}_{0,1}\\ \mathbf{S}_{1,0}\end{pmatrix} =\begin{pmatrix}I&I&0\\ I&I&0\end{pmatrix}\divide\begin{pmatrix}\mathbf{A}_{1}&\mathbf{A}_{2}&\mathbf{ B}_{1}\mathbf{x}_{0,1}\\ \mathbf{A}_{3}&\mathbf{A}_{4}&\mathbf{B}_{2}\mathbf{x}_{1,0}\end{pmatrix}\] (65) \[=\begin{pmatrix}\mathbf{A}_{1}&\mathbf{A}_{2}&\mathbf{B}_{1} \mathbf{x}_{0,1}\\ \mathbf{A}_{3}&\mathbf{A}_{4}&\mathbf{B}_{2}\mathbf{x}_{1,0}\end{pmatrix}.\] (66)

Re-using operator \(\divide\), we have:

\[\begin{pmatrix}\mathbf{S}_{1,1}\\ \mathbf{S}_{1,1}\end{pmatrix} =\begin{pmatrix}\mathbf{S}_{0,1}\\ \mathbf{S}_{1,0}\end{pmatrix}\divide\underbrace{\begin{pmatrix}\mathbf{A}_{1}& \mathbf{A}_{2}&\mathbf{B}_{1}\mathbf{x}_{1,1}\\ \mathbf{A}_{3}&\mathbf{A}_{4}&\mathbf{B}_{2}\mathbf{x}_{1,1}\end{pmatrix}}_{ \text{Pre-computed}}\] (67) \[=\begin{pmatrix}\mathbf{A}_{1}^{2}&\mathbf{A}_{2}^{2}&\mathbf{A}_ {1}\mathbf{B}_{1}\mathbf{x}_{0,1}+\mathbf{A}_{2}\mathbf{B}_{2}\mathbf{x}_{1,0 }+\mathbf{B}_{1}\mathbf{x}_{1,1}\\ \mathbf{A}_{3}&\mathbf{A}_{4}^{2}&\mathbf{A}_{3}\mathbf{B}_{1}\mathbf{x}_{0,1 }+\mathbf{A}_{4}\mathbf{B}_{2}\mathbf{x}_{1,0}+\mathbf{B}_{2}\mathbf{x}_{1,1} \end{pmatrix}\] (68)

Fixing the variate by putting 0 as the initial points of the operator, and then looking at the third element of each row, these elements are calculating the hidden states of the recurrent (it can be shown by a straightforward induction). Accordingly, using this operation, we can recursively calculate the outputs of 2D SSM.

However, using Theorem 3.2, we know that this is an associative operation, so instead of calculating in the recurrent form, we can use parallel pre-fix sum make this computation parallel, decreasing the sequential operations required to calculate the hidden states. Note that since our above operation can model the problem as an parallel prefix, all the algorithms for this problem can be used to enhance the efficiency.

### Proof of Theorem 3.4

To prove this theorem, we need to (1) show that Chimera can recover SpaceTime. Given this, since SpaceTime is capable of recovering ARIMA [14], exponential smoothing [16], and controllable linear time-invariant systems [87], we can conclude that Chimera can also recover these methods. Then, (2) we need to prove that Chimera can recover SARIMA. This is the model that SpaceTime is not capable of recovering due to the additional seasonal terms.

Note that using \(\mathbf{A}_{2}=\mathbf{A}_{3}=\mathbf{A}_{4}=0\), results in a 1D SSM, with companion matrix as the structure of \(\mathbf{A}_{1}\), which is SpaceTime. Accordingly, SpaceTime is a special case of Chimera when the recurrence only happen along the time direction.

\begin{table}
\begin{tabular}{c c|c c c c c c c c c c c c c c c c} \hline \hline \multirow{2}{*}{Models} & \multirow{2}{*}{\begin{tabular}{c} **Chimera** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **ModernTech** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **PactTST** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **TimeNet** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **N-HITS** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **S-layers** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **ETS** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **LightTS** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **DLinear** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **FemPact** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **S-layers** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{\begin{tabular}{c} **Res** \\ **(ours)** \\ \end{tabular} } & \multirow{2}{*}{
\begin{tabular}{c} **LST** \\ **(ours)** \\ \end{tabular} } \\ \hline \multirow{4}{*}{**D**} & SMAPE & **13.107** & 13.226 & 13.258 & 13.387 & 13.418 & 13.436 & 13.409 & 14.247 & 16.965 & 13.728 & 13.717 & 13.974 & 15.530 & 14.727 & 16.69 & 176.040 \\  & MASE & **2.902** & 2.957 & 2.985 & 2.996 & 3.045 & 3.043 & 4.487 & 3.109 & 4.283 & 3.048 & 3.078 & 3.134 & 3.711 & 3.418 & 3.800 & 31.033 \\  & OWA & **0.767** & 0.727 & 0.781 & 0.786 & 0.793 & 0.794 & 1.115 & 0.827 & 1.058 & 0.803 & 0.807 & 0.822 & 0.942 & 0.881 & 0.973 & 9.290 \\ \hline \multirow{4}{*}{**D**} & SMAPE & **9.892** & 9.971 & 10.179 & 10.100 & 10.100 & 10.202 & 10.124 & 13.376 & 11.364 & 12.145 & 10.792 & 10.958 & 11.338 & 15.499 & 11.360 & 13.313 & 172.808 \\  & MASE & 1.105 & 1.167 & **0.803** & 1.182 & 1.194 & 1.169 & 1.906 & 1.328 & 1.520 & 1.283 & 1.325 & 1.365 & 2.350 & 1.401 & 1.775 & 19.753 \\  & OWA & 0.853 & 0.878 & **0.803** & 0.890 & 0.890 & 0.896 & 1.302 & 1.000 & 1.106 & 0.958 & 0.981 & 1.012 & 1.588 & 1.027 & 1.252 & 15.049 \\ \hline \multirow{4}{*}{**D**} & SMAPE & **12.549** & 12.596 & 12.641 & 12.670 & 12.791 & 12.677 & 12.677 & 12.677 & 11.588 & 14.014 & 13.514 & 12.460 & 13.971 & 13.958 & 17.624 & 12.462 & 10.228 & 143.237 \\  & MASE & **0.914** & 0.917 & 0.930 & 0.933 & 0.969 & 0.937 & 1.368 & 1.053 & 1.037 & 1.02 & 1.097 & 1.093 & 1.131 & 1.141 & 14.651 \\  & OWA & **0.864** & 0.866 & 0.876 & 0.878 & 0.899 & 0.880 & 1.149 & 0.981 & 0.986 & 1.012 & 0.998 & 1.002 & 1.511 & 1.024 & 19.27 & 12.747 \\ \hline \multirow{4}{*}{**D**} & SMAPE & **4.685** & 4.715 & 4.946 & 4.891 & 5.061 & 4.925 & 7.267 & 15.880 & 6.709 & 4.954 & 6.302 & 5.485 & 24.786 & 24.460 & 32.491 & 186.282 \\  & MASE & 1.007 & 3.107 & **2.985** & 3.002 & 3.216 & 3.391 & 5.240 & 11.434 & 4.953 & 3.264 & 4.064 & 3.865 & 18.581 & 20.960 & 33.355 & 119.294 \\  & OWA & **0.983** & 0.986 & 1.044 & 1.035 & 1.040 & 1.053 & 1.5Note that as discussed in Proposition 3.1, multiplying the discretization parameter \(\Delta\) results in multiplying the steps. Accordingly, using \(s\) as the \(\Delta\) in our seasonal module and also letting \(\mathbf{A}_{2}=\mathbf{A}_{3}=\mathbf{A}_{4}=0\) for the seasonal module, we can model the seasonal terms in the formulation of SAR\((p,q,s)\), meaning that Chimera can also recover SARIMA which is ARIMA with seasonal terms. Note that the reason that Chimera is capable of such modeling is that it uses two heads separately for trend and seasonal terms. Therefore, using different discretization parameters, each can model their own corresponding terms in SAR\((p,q,s)\).

### Proof of Theorem 3.5

Similar to the above, using \(\mathbf{A}_{2}=\mathbf{A}_{3}=0\), our formulation is equivalent to S4D, while we use diagonal matrices as the structure of \(\mathbf{A}_{1}\). Similarly, as discussed by Behrouz et al. [31], MambaMixer is equivalent to S4ND but on patched data. Using our Theorem 5, we can recover linear layers, resulting in recovering TSMixer by setting \(\mathbf{A}_{2}=\mathbf{A}_{3}=0\).

### Proof of Theorem 3.6

We in fact will show that restricting Chimera results in recovering 2DSSM [49]. As discussed earlier, this method do not use discretization and initially starts from a discrete system. Also, it uses input-independent parameters. Therefore, we use \(\texttt{Linear}_{\Delta_{1}}(.)=\texttt{Linear}_{\Delta_{2}}(.)\) as broadcast function, and restrict Chimera to have input-independent parameters, then Chimera can recover 2DSSM [49].

## Appendix H Experimental Settings

We provide the description of datasets in Table 7.

### Baselines

In our experiments, we use the following baselines:

* Table 8: TSM2 [31], Simba [57], TCN [9], iTransformer [27], RLinear [58], PatchTST [29], Crossformer [26], TiDE [55], TimesNet [8], DLinear [59], SCINet [56], FEDformer [24], Stationary [86], Autoformer [21].
* Table 9: ModernTCN [9], PatchTST [29], TimesNet [8], N-HiTS [65], N-BEATS\({}^{*}\)[66], ETSformer [20], LightTS [67], DLinear [11], FEDformer [24], Stationary [68], Autoformer [21], Pyraformer [23], Informer [6], Reformer [25], LSTM [69].
* Table 10: LSTM [69], LSTNet [88], LSSL [34], Trans.former [17], Reformer [25], Informer [6], Pyraformer [23], Autoformer [21], Station. [68], FEDformer [24], ETSformer [20], Flowformer [22], DLinear [11], LightTS. [67], TimesNet [8], PatchTST [29], MTCN [9].

For the results of the baselines, we re-use the results reported by Wu et al. [8], or from the original cited papers.

## Appendix I Additional Experimental Results

### Long Term Forecasting Full Results

The complete results of long term forecasting are reported in Table 8.

### Short-Term Forecasting

The complete results of short term forecasting are reported in Table 9.

### Classification

The complete results of time series classification are reported in Table 10.

[MISSING_PAGE_EMPTY:26]

## Appendix L Limitations

The main goal of this study is to enhance the time series modeling with a wide range of impact on society, from improving the healthcare system using developing deep learning models for analysing medical health records to forecasting stock. We, however, emphasis that our work is a proof-of-concept, meaning that it has error modes.

\begin{table}
\begin{tabular}{l c c c c c} \hline \hline \multirow{2}{*}{Method} & BVFC & \multicolumn{2}{c}{Exchange} & \multicolumn{2}{c}{Traffic} \\ \cline{2-6}  & Acc. \% & MSE & MAE & MSE & MAE \\ \hline Chimera & 58.99 & 0.077 & 0.198 & 0.366 & 0.248 \\ Uni-directional & 57.29 & 0.091 & 0.203 & 0.369 & 0.255 \\ w/o Gating & 56.18 & 0.094 & 0.210 & 0.373 & 0.259 \\ Input-independent & 55.31 & 0.113 & 0.228 & 0.402 & 0.271 \\ w/o seasonal & 58.12 & 0.083 & 0.202 & 0.372 & 0.258 \\ All Diagonal & 57.98 & 0.095 & 0.209 & 0.370 & 0.257 \\ All Companion & 54.01 & 0.108 & 0.226 & 0.375 & 0.261 \\ \hline \hline \end{tabular}
\end{table}
Table 12: Ablation Study on additional datasets.

1. **Claims** Question: Do the main claims made in the abstract and introduction accurately reflect the paper's contributions and scope? Answer: [Yes] Justification: [NA] Guidelines: * The answer NA means that the abstract and introduction do not include the claims made in the paper. * The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers. * The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings. * It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper.
2. **Limitations** Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] Justification: See Appendix L. Guidelines: * The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper. * The authors are encouraged to create a separate "Limitations" section in their paper. * The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be. * The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated. * The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon. * The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size. * If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness. * While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren't acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations.
3. **Theory Assumptions and Proofs** Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? Answer: [Yes] Justification: See Appendix G. Guidelines:* The answer NA means that the paper does not include theoretical results.
* All the theorems, formulas, and proofs in the paper should be numbered and cross-referenced.
* All assumptions should be clearly stated or referenced in the statement of any theorems.
* The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.
* Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.
* Theorems and Lemmas that the proof relies upon should be properly referenced.
4. **Experimental Result Reproducibility** Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? Answer: [Yes] Justification: See Appendix H. Guidelines: * The answer NA means that the paper does not include experiments. * If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not. * If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable. * Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed. * While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example 1. If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. 2. If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. 3. If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). 4. We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results.
5. **Open access to data and code** Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? Answer: [Yes] Justification: It is available in this link.

Guidelines:

* The answer NA means that paper does not include experiments requiring code.
* Please see the NeurIPS code and data submission guidelines (https://nips.cc/public/guides/CodeSubmissionPolicy) for more details.
* While we encourage the release of code and data, we understand that this might not be possible, so "No" is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).
* The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https://nips.cc/public/guides/CodeSubmissionPolicy) for more details.
* The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.
* The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.
* At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).
* Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted.
6. **Experimental Setting/Details** Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? Answer: [Yes] Justification: See above question. Guidelines: * The answer NA means that the paper does not include experiments. * The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. * The full details can be provided either with the code, in appendix, or as supplemental material.
7. **Experiment Statistical Significance** Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? Answer: [NA] Justification: [NA] Guidelines: * The answer NA means that the paper does not include experiments. * The authors should answer "Yes" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper. * The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions). * The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.) * The assumptions made should be given (e.g., Normally distributed errors). * It should be clear whether the error bar is the standard deviation or the standard error of the mean. * It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a 96% CI, if the hypothesis of Normality of errors is not verified.

* For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).
* If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text.
8. **Experiments Compute Resources** Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? Answer: [Yes] Justification: See question 5. Guidelines: * The answer NA means that the paper does not include experiments. * The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage. * The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute. * The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn't make it into the paper).
9. **Code Of Ethics** Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? Answer: [Yes] Justification: We have reviewed NeurIPS Code of Ethics. Guidelines: * The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics. * If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics. * The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction).
10. **Broader Impacts** Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? Answer: [Yes] Justification: See Appendix L. Guidelines: * The answer NA means that there is no societal impact of the work performed. * If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact. * Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations. * The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.

* The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.
* If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML).
11. **Safeguards** Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? Answer:[NA] Justification: [NA] Guidelines: * The answer NA means that the paper poses no such risks. * Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters. * Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images. * We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort.
12. **Licensees for existing assets** Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? Answer: [Yes] Justification: [NA] Guidelines: * The answer NA means that the paper does not use existing assets. * The authors should cite the original paper that produced the code package or dataset. * The authors should state which version of the asset is used and, if possible, include a URL. * The name of the license (e.g., CC-BY 4.0) should be included for each asset. * For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided. * If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset. * For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided. * If this information is not available online, the authors are encouraged to reach out to the asset's creators.
13. **New Assets** Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? Answer: [NA] Justification: [NA]Guidelines:

* The answer NA means that the paper does not release new assets.
* Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.
* The paper should discuss whether and how consent was obtained from people whose asset is used.
* At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file.

14. **Crowdsourcing and Research with Human Subjects** Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? Answer: [NA] Justification: [NA] Guidelines:

* The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.
* Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.
* According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector.

15. **Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects** Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? Answer: [NA] Justification: [NA] Guidelines:

* The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.
* Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.
* We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.
* For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review.