# Improving Alignment and Robustness with Circuit Breakers

Andy Zou\({}^{1,2,3}\), Long Phan\({}^{3}\), Justin Wang\({}^{1}\),

**Derek Duenas\({}^{1}\), Maxwell Lin\({}^{1}\), Maksym Andriushchenko\({}^{1}\), Rowan Wang\({}^{1}\),**

**Zico Kolter\({}^{1,2}\), Matt Fredrikson\({}^{1,2}\), Dan Hendrycks\({}^{1,3}\)**

\({}^{1}\)Gray Swan AI, \({}^{2}\)Carnegie Mellon University, \({}^{3}\)Center for AI Safety

Work done while at Gray Swan AI. \({}^{1}\)Work done in advising capacity to Gray Swan AI.

Correspondence to: andy@grayswan.ai

###### Abstract

AI systems can take harmful actions and are highly vulnerable to adversarial attacks. We present an approach, inspired by recent advances in representation engineering, that interrupts the models as they respond with harmful outputs with "circuit breakers." Existing techniques aimed at improving alignment, such as refusal training, are often bypassed. Techniques such as adversarial training try to plug these holes by countering specific attacks. As an alternative to refusal training and adversarial training, circuit-breaking directly controls the representations that are responsible for harmful outputs in the first place. Our technique can be applied to both text-only and multimodal language models to prevent the generation of harmful outputs without sacrificing utility--even in the presence of powerful unseen attacks. Notably, while adversarial robustness in standalone image recognition remains an open challenge, circuit breakers allow the larger multimodal system to reliably withstand image "hijacks" that aim to produce harmful content. Finally, we extend our approach to AI agents, demonstrating considerable reductions in the rate of harmful actions when they are under attack. Our approach represents a significant step forward in the development of reliable safeguards to harmful behavior and adversarial attacks. Code is available at github.com/GraySwanAI/circuit-breakers.

## 1 Introduction

The landscape of artificial intelligence (AI) has long been marred by the persistent threat of adversarial attacks, particularly those targeting neural networks. These attacks exploit inherent vulnerabilities within AI systems, often leading to compromised outputs and raising concerns regarding their reliability and safety. Despite significant attention, existing mitigations have failed to achieve high reliability without dramatically compromising model performance. Thus, the trade-off between adversarial robustness and utility is widely accepted as an unavoidable fact [64].

The rise of generative models has further complicated this issue. Generative models such as large language models (LLMs) can output copyrighted information or defame individuals, and agents can take harmful actions. To make models less harmful, they are "aligned" with refusal training [12, 54], but it has become common to use adversarial attacks as a means of bypassing their safeguards. In these settings, vulnerability to attacks that break alignment poses a serious threat to utility, and raises pressing questions about whether it is feasible to deploy such systems with a high standard of safety and reliability--especially against dedicated adversaries who intend to misuse them.

The fragility of alignment techniques to sophisticated attacks has motivated defenses that target specific attack methods, such as adversarial training, an approach originally proposed in the contextof standalone image classification [38] and later adapted to LLMs [40]. However, these methods often fail to generalize to new attacks that were unseen during training, and they introduce penalties on model capabilities that are usually proportional to gains in robustness. System-level defenses, including input and output filters, are cumbersome, resource-intensive, and often remain vulnerable to adversarial techniques. This has led to a growing concern that robust defenses may be unattainable.

We propose a novel approach outlined in Figure 1 that fundamentally diverges from traditional defenses: instead of attempting to remove vulnerabilities to specific attacks, our approach aims to directly circumvent the ability of the model to produce the harmful output in the first place. With circuit breakers, we make models intrinsically safer and reduce their risks by removing _intrinsic model hazards_--their ability to produce harmful outputs--rather than removing specific _vulnerabilities_ with adversarial training, and rather than attempting to reduce _exposure_ to attacks with input filters [28, 21]. Using representation engineering (RepE) [77], our method connects the internal representations related to harmful outputs to circuit breakers so that when a model begins to generate such an output, its internal processes are interrupted, halting completion of the generation. Or this method is "short-circuiting" the harmful processes as one might put it. Because the representation used to generate a harmful output is independent of any attack capable of eliciting it, this approach is attack-agnostic, and sidesteps the need for additional training, costly adversarial fine tuning, or the use of auxiliary "guard" models. Consequently, the resulting model with circuit breakers can be used normally without additional computational burden, and seamlessly integrated with existing monitoring and protection mechanisms.

Experimentally, we demonstrate that a circuit-breaking technique, Representation Rerouting (RR), notably improves the alignment of LLMs. It enhances the harmlessness of state-of-the-art LLMs, including against against a wide array of _unseen_ adversarial attacks, including embedding and representation-space attacks--namely, proxies for worst-case assumptions about attacker capabilities. Figure 2 and Table 1 present an overview of these results. Our method significantly outperforms standard refusal training and adversarial training, while imposing almost no penalty on standard capability. Notably, we integrate circuit-breaking with additional model control methods to develop

Figure 1: Introduction of circuit-breaking as a novel approach for constructing highly reliable safeguards. Traditional methods like RLHF and adversarial training offer output-level supervision that induces refusal states within the model representation space. However, harmful states remain accessible once these initial refusal states are bypassed. In contrast, inspired by representation engineering [77], circuit breaking operate directly on internal representations, linking harmful states to circuit breakers. This impedes traversal through a sequence of harmful states.

a Llama-3-8B-Instruct finetune called Cygnet. This enhanced model not only surpasses its original capabilities but also exhibits a large reduction in harmful output by approximately _two orders of magnitude_, even when confronted with unforeseen adversarial attacks. To the best of our knowledge, this is the first convincing demonstration of the feasibility of designing techniques that significantly advance the Pareto frontier of capability versus harmlessness for LLMs, illustrating that such trade-offs can be effectively managed. When applied to multimodal models, our results show marked increases in harmlessness. It also improves robustness against image-based attacks aimed at similarly circumventing model safeguards, again with almost no penalty on benchmarked capabilities. This remains true even in the presence of the Projected Gradient Descent (PGD) attack [38], which defenses for standalone image classifiers have been unable to achieve without a steep trade-off in accuracy. Finally, we apply circuit breakers to AI agents, illustrating its efficacy in controlling agent behaviors through evaluations on a new agent function-calling safety benchmark.

Our findings introduce a new paradigm for creating models that do not produce harmful outputs. Our method is highly robust against adversarial attacks, providing a promising path forward in the adversarial arms race. By ensuring safety and security without compromising capability, our approach increases the chances that we may ultimately be able to deploy robust AI systems in real-world applications.

## 2 Related Work

Adversarial attacks on LLMs. Numerous manually written attack prompts on modern LLMs have been discovered [49; 68], forming the basis of _red teaming_ for frontier LLMs [50; 5; 55], though it lacks standardization [16]. Automated red teaming has been shown effective in Perez et al. [53], Chao et al. [11], Mehrotra et al. [41], Zeng et al. [73]. Notably, transfer attacks using an adversarial suffix via gradient-based optimization were demonstrated by Zou et al. [78]. White-box access also facilitates prefilling attacks [67; 2], leading the LLM to generate harmful outputs. For a comprehensive summary of automated attacks, we refer to HarmBench [40]. Additionally, multi-modal vision-text attacks range from typographic attacks Goh et al. [18] to gradient-based optimization [9; 59; 6]. LLM agents have been benchmarked [35; 45], but their safety and robustness remain unexplored.

Defenses for LLMs. Our new defense addresses limitations in existing mechanisms. Widely used defenses include RLHF [12; 52] and DPO [54] using human annotations for safe vs. unsafe responses [63], but they often fall short against state-of-the-art adversarial attacks [78; 2]. Additional robustness is achieved by methods like Zhou et al. [76], which optimize prompts to refuse harmful requests. Inspired by adversarial training in vision [38], fine-tuning for the R2D2 model against the GCG attack [40] shows limited generalizability and drops MT-Bench scores [75]. Adversarial training for LLMs can be highly computationally expensive. Inference-time defenses, such as perplexity filters [1; 26],

Figure 2: Adding circuit breakers using Representation Rerouting (RR) to refusal trained Llama-3-8B-Instruct model leads to significantly lower attack success rate (ASR) over a wide range of _unseen_ attacks on HarmBench prompts [40], while its capabilities on standard LLM benchmarks (MT Bench and MMLU) are largely preserved. RR directly targets the representations that give rise to harmful outputs and reroutes them to an orthogonal space. This reliably interrupts the model from completing the harmful generations even under strong adversarial pressure.

are effective only against non-adaptive attacks [36], while erase-and-check and SmoothLLM [56] incur high computational costs. System-level defenses against unsafe inputs or outputs [20; 25; 27] can still be circumvented by sophisticated adversaries [39]. The main conceptual difference is that instead of operating on input or output text, our method operates directly on representations which provides a more generalizable and computationally cheap solution.

**Representation Engineering.** As many contemporary defenses relying solely on supervising model outputs fail to achieve the desired levels of controllability and reliability, techniques that analyze and manage model's internal representations have garnered increased attention. This includes research ranging from uncovering emergent interpretable structures in intermediate representations [77; 46; 10], to the identification and modification of embedded knowledge [48; 42; 43], as well as steering model outputs [66; 7; 33; 24; 65]. Most relevant to our work is the control vector baseline introduced in the representation engineering paper [77], which can be applied to enhance large language models' resistance to adversarial attacks. Alongside the use of control vectors, they introduce an approach that bends representations with representation-level losses. Recent advancements extend this method to robustly unlearn hazardous knowledge [29] with a method termed RMU, demonstrating the potential of representation engineering for more complex objectives. Previous work has attempted to eliminate harmful circuits using bottom-up mechanistic interpretability, but these methods have proven insufficient [30]. Building on these foundations and further expanding RMU to a family of circuit-breaking techniques, we design a methodology based on _model representations_ for robust alignment and control by preventing the generation of harmful outputs.

## 3 Circuit Breaking with Representation Engineering

In this section, we introduce a novel approach aimed at mitigating the generation of harmful outputs in neural networks by inducing a new type of phenomenon called "circuit-breaking." This phenomenon can be elicited using a family of techniques designed to monitor or remap model representations related to harmful processes, redirecting them towards incoherent or refusal representations. This process is reminiscent of "short-circuiting," where harmful representations are "shorted" and intercepted by circuit breakers. The core objective of this method is to robustly prevent the model from producing harmful or undesirable behaviors by through monitoring or controlling the representations.

Our focus on generative models--such as language and multimodal agents--presents a unique opportunity. Generative models inherently involve multi-step processes through which outputs are produced. When devising an attack, adversaries must effectively exert influence across each step of the targeted processes, so each step presents an opportunity to make the model more robust to attack. This insight drives our strategy, which focuses on disrupting adversarial control of the relevant multi-step processes rather than the binary classification problem of attempting to detect the presence of an attack. Building from techniques in representation engineering (RepE) [77], we accomplish this by remapping the sequence of model representations that leads to harmful outputs, directing them towards incoherent or refusal representations--namely, _breaking the circuit_, or _shorting the circuit_ as one might put it. Moreover, by directly targeting the processes involved in generating harmful responses, our method can generalize across the diverse range of inputs that may activate those processes. Consequently, we do not need to identify all of the potential inputs that could trigger undesirable outputs, rather we only need to ensure coverage of a well defined set of such outputs.

The applications of circuit breakers are multifaceted. They can be utilized to prevent the generation of harmful outputs in general, as well as to prevent more narrowly tailored types of output, such as private information or copyrighted material. The approach is versatile, as it is possible to identify and remap the relevant representations in virtually any neural network architecture.

The family of circuit-breaking techniques is characterized by two major components: datasets and loss functions. Algorithm 1 presents a circuit-breaking technique that uses Low-Rank Representation Adaptation (LoRRA) [77] which we call Representation Rerouting (RR). The remainder of this section details this approach, and how the data and chosen loss function contribute to the effectiveness of the overall method.

Data.The training data used in RR is partitioned into two sets: the Circuit Breaker Set and the Retain Set, each serving distinct purposes within the training process aimed at controlling harmful processes in the model. As with all representation control methods, the quality of the circuit breaker mechanism largely depends on how precisely the data can elicit the targeted representation. The Circuit Breaker Set is comprised of examples that yield internal representations potentially leading to harmful or undesirable behaviors, and are used to prompt the model's circuit breaker mechanism. Conversely, the Retain Set includes examples that should not activate circuit breakers, and are used to maintain existing desirable model representations to retain benign efficacy. While even a limited number of examples in each set can sufficiently alter the model's behavior in a manner that generalizes beyond the training data, the resulting performance is generally improved when the training data better aligns with the domains we aim to break the circuit and retain.

For models with pre-existing refusal mechanisms, like Llama-3-Instruct, careful dataset curation is essential. Adding refusal data to the Retain Set enhances the model's ability to correctly refuse harmful user requests and improves retention of its capabilities. Another challenge is to elicit harmful responses from models with effective refusal mechanisms. To address this, we must curate a Circuit Breaker set that includes text capable of bypassing the refusal mechanism and triggering harmful

\begin{table}
\begin{tabular}{c c c c c c c c} \hline \hline  & & \multicolumn{3}{c}{Mistral-7B-Instruct-v2} & \multicolumn{3}{c}{Llama-3-8B-Instruct} \\ \cline{3-8}  & & \begin{tabular}{c} Refusal \\ Trained \\ \end{tabular} & \begin{tabular}{c} Adv \\ Trained \\ \end{tabular} & \begin{tabular}{c} + RR \\ (Ours) \\ \end{tabular} & \begin{tabular}{c} Refusal \\ Trained \\ \end{tabular} & \begin{tabular}{c} + RR \\ (Ours) \\ \end{tabular} & 
\begin{tabular}{c} Cyber \\ (Ours) \\ \end{tabular} \\ \hline Capability (\(\uparrow\)) & MT-Bench & **7.60** & 6.00 & 7.53 & 8.05 & 8.00 & **8.21** \\  & Open LLM & **65.4** & 61.2 & **65.4** & 68.8 & 68.3 & **71.9** \\ \hline  & No Attack & 57.8 & 16.5 & **4.9** & 12.4 & 1.2 & **0.0** \\  & Manual & 77.4 & 14.2 & **6.8** & 8.3 & **0.0** & **0.0** \\  & AutoDAN & 93.4 & 21.1 & **0.0** & 3.7 & **0.0** & **0.0** \\  & TAP-T & 85.8 & 68.7 & **17.5** & 17.4 & 2.1 & **0.0** \\  & PAIR & 69.5 & 59.9 & **23.3** & 18.7 & 7.5 & **0.0** \\ Robustness (\(\downarrow\)) & GCG & 88.7 & **7.8** & 11.2 & 44.5 & 2.5 & **0.0** \\  & Multilingual & 34.1 & **4.7** & 7.3 & 19.3 & 3.5 & **0.0** \\  & Prefilling & 95.0 & 46.9 & **4.9** & 84.9 & 3.3 & **0.0** \\  & Input Embed & 92.1 & 46.3 & **15.7** & 80.4 & 9.6 & **7.9** \\  & RepE Attack & 73.7 & 30.7 & **6.2** & 91.2 & 8.7 & **0.0** \\ \cline{2-8}  & Average & 76.7 & 31.7 & **9.8** & 38.1 & 3.8 & **0.8** \\ \hline \hline \end{tabular}
\end{table}
Table 1: LLM evaluation results. Our circuit-breaking method Representation Rerouting (RR) shows strong generalization across a diverse range of unseen attacks, significantly reducing compliance rates to harmful requests while preserving model capability. Cygnet, a Llama-3-8B-Instruct finetune integrating circuit breakers and other representation control [77] methods, surpasses original capabilities and demonstrates a significant reduction in harmful output by roughly two orders of magnitude under strong attacks. This advancement shows promising initial steps in balancing capability and harmlessness in LLMs. Input embedding attack optimizes the soft input embeddings which is an unrealistically strong threat model for LLMs. Mistral-Adv Trained (R2D2) [40] is an SFT-only model.

processes. We find that a practical approach is to remove harmful user requests while keeping the corresponding harmful assistant responses in the Circuit Breaker Set. These measures ensure the refusal mechanism's integrity while allowing the model to activate its circuit-breaking function correctly once the refusal is bypassed. Ablation results are detailed in Section 4.4.

Loss.The accompanying losses for the datasets are the representation rerouting loss and retain loss. Denote the representation of harmful processes under the original model as \(\text{rep}_{\text{orig}}\) and under the model with circuit breakers as \(\text{rep}_{\text{\emph{c}fb}}\). The rerouting loss is designed to remap representations from harmful processes \(\text{rep}_{\text{\emph{c}fb}}\) to a desired target representation \(\text{rep}_{\text{rand}}\). Conversely, the retain loss is used to maintain representations within a retain set, which helps preserve these representations. This is often measured as the \(\ell_{2}\) distance between the current and retain representations.

The rerouting loss can take various forms. One approach involves routing the targeted representation to a fixed random direction with a large norm, as utilized in the unlearning method RMU [29]. This is expressed as \(\|\text{rep}_{\text{\emph{c}fb}}-\text{\emph{arcp}rand}\|_{2}\), where \(\text{rep}_{\text{rand}}\) is a random vector and \(\alpha\) is a large constant meant to amplify the norm of the representation. However, this approach requires extensive tuning of the \(\alpha\) parameter. We also explore a variant of the random vector loss that does not necessitate hyperparameter tuning, formulated as the \(\ell_{2}\) norm of \(\text{rep}_{\text{\emph{c}fb}}/\|\text{rep}_{\text{\emph{c}fb}}\|-\text{rep} _{\text{rand}}/\|\text{rep}_{\text{rand}}\|\). However, the use of a random vector is neither necessary nor optimal. Given that we want the targeted representation to be as unhelpful as possible for the harmful processes, another approach is to directly optimize the circuit-broken representation to be orthogonal to the original representation responsible for harmful processes. This is given by their cosine similarity: \(\text{rep}_{\text{\emph{c}fb}}-\text{\emph{arcp}orig}/(\|\text{rep}_{\text{ \emph{c}fb}}\|_{2}\|\text{rep}_{\text{orig}}\|_{2})\). To avoid optimizing the similarity beyond zero, we apply a ReLU function to this objective. We find this loss to be the most intuitive and most effective in terms of achieving a balance between robustness and preserved capability. An implementation of RR using Low-Rank Representation Adaptation is shown in Algorithm 1. Additionally, one could map \(\text{rep}_{\text{\emph{c}fb}}\) onto more semantically meaningful directions, such as a refusal direction or the embedding of the EOS token. We leave this to future work. Appendix C.1 discusses several additional design considerations.

## 4 Experiments

### Large Language Models

Adding Circuit Breakers.In our experimental setup, we employ similar circuit breaker and retain datasets for both the Mistral-7B-Instruct-v2 [47] and Llama-3-8B-Instruct [44] models. Detailed information on the synthetic circuit breaker set for LLMs is provided in Appendix A.1. The retain set for both models includes UltraChat [15], comprising instructional conversations, and XSTest [57], an exaggerated refusal dataset. Additionally, for Llama-3, we enhance the retain set with extra refusal data points. We follow the implementation of Representation Rerouting (RR) specified in Algorithm 1

Figure 3: Circuit-breaking performance in multimodal settings with Representation Rerouting (RR). Under Projected Gradient Descent (PGD) attack, our LLaVA-NeXT-Mistral-7B (+ RR) with circuit breakers is significantly more robust compared to the original model even with a safety prompt that instructs the model to avoid harmful responses. Performance on multimodal capabilities benchmarks MMMU and LLaVA-Wild is preserved.

and select hyperparameters based on static attack test cases from HarmBench's validation set. More experimental details can be found in Appendix C.2.1.

**Evaluation.** We evaluate the harmfulness of the model using HarmBench [40], a standardized framework that includes harmful behaviors and a wide range of both black box and white box attacks. We select a subset of the strongest attacks reported on both open-source and closed-source models for evaluation. These attacks include gradient-based optimization (GCG [78]), LLM optimizers (PAIR [11]), custom jailbreaking pipelines (TAP-Transfer [73], AutoDAN [36], and HumanJailbreaks [62]). To further test the model, we incorporate a multilingual attack [70], and also introduce three powerful attacks that leverage system-level and representation-space access. We briefly describe these three additional attacks below, and provide a more detailed coverage in Appendix C.2.2.

1. **Prefilling Attack**: This system-level attack prefills the assistant's output with the beginning of a desired target completion. It leverages the autoregressive nature of LLMs, as it can be difficult for a model to "reverse-course" after it has started to generate harmful content. Prefilling is straightforward to implement for any open-weight model, and is also supported for some proprietary LLMs like Claude [4].
2. **Input Embedding Attack**: This white-box attack operates in the embedding space by optimizing a set of input embeddings directly instead of using hard tokens, with the objective of eliciting an affirmative assistant response [60].
3. **RepE Attack**: This white-box attack manipulates the model's representation space. Previous work in representation engineering demonstrates the identification of directional vectors in the model's representation space that correspond to refusals [77]. By altering these vectors--either adding or subtracting--we can modulate the model's tendency to refuse requests.

We utilize HarmBench's LLM classifier to evaluate the attack success rate and manually verify the judgements. Detailed configurations for each attack are provided in Appendix C.2.2. To measure the capabilities of the models with circuit breakers, we evaluate our models on MTBench [75] for instruction-following abilities and on the OpenLLM Leaderboard [8] for knowledge and reasoning which includes MMLU [22], ARC-c [13], HellaSwag [72], TruthfulQA [31], Winogrande [58], and GSM8K [14]. Table 5 contains a detailed breakdown of performance on each dataset. Additionally, we follow the methodology in [5] to construct an over-refusal evaluation, described in Appendix B. For baselines, we use the original Mistral and Llama-3 Instruct models. Additionally, we include a state-of-the-art adversarially trained Mistral model, R2D2 [40], for comparison.

**Results.** We observe that our circuit-breaking technique RR demonstrates strong generalization across a diverse range of attacks, reducing compliance rates to harmful requests by an average of \(87\%\) with Mistral and \(90\%\) with Llama-3. Unlike the Mistral R2D2 model, which is trained against the GCG yet shows limited generalization to various attacks, our method eliminates the need for specific attack training and focuses on hindering harmful generations. Our approach moves away from the traditional cat-and-mouse paradigm, aiming for generalization to _unforeseen_ attacks. Additionally, the results highlight a Pareto optimal trade-off in performance. Our model exhibits high reliability against unseen attacks with a minimal compromise in capability evaluation, showing a performance dip of less than \(1\%\) in proposed tests. This is difficult to achieve with traditional defenses. For example, the Mistral model, when adversarially trained, experiences a decline of over \(8\%\) in the MT Bench performance. In contrast, our model leverages representation engineering principles, focusing on internal control over external supervision, enabling more targeted and fine-grained control over model behavior without adversely impacting other functionalities.

### Multimodal Models

**Adding Circuit Breakers.** We mix the circuit breaker and retain datasets from Section 4.1 with a synthetic multimodal circuit breaker set and the retain LLaVA-Instruct set [34]. The detailed process of generating the synthetic dataset is reported in appendix A.2. We perform RR on LLaVA-NeXT-Mistral-7B [34]. More experimental details can be found in Appendix C.3.1.

**Evaluation.** To evaluate the robustness of multimodal models with circuit breakers, we generate adversarial images using a whitebox approach. Following Projected Gradient Descent [38], we perturb images with a harmful prompt to produce a target string with an affirmative assistant response. We set epsilon to \(32/255\) and run the process for 1000 steps. As baselines, we test LLaVA-NeXTMistral-7B with and without a safety prompt that asks the model to avoid harmful responses. Our robustness results in Figure 3 show the percentage of harmful prompts the model complies with, labeled manually. We source a set of 133 harmful multimodal behaviors from HarmBench [40] and MM-SafetyBench [37], focusing on the most saliently harmful prompts. See Appendix C.3 for more details about the dataset's composition. For capabilities evaluation, we follow [34] to evaluate multimodal models on LLaVA-Wild for visual chat capability and MMMU [71] for multimodal understanding capability.

**Results.** Figure 3 demonstrates that for multimodal models, our circuit-breaking technique RR is also able to make a model significantly more robust while preserving model capabilities. Especially when subject to white-box PGD Attack, RR achieves reduction of \(84\%\) in the compliance rate compared to the original model and \(85\%\) compared to the safety prompt. Meanwhile, performance on MMMU and LLaVA-Wild remains within \(0.5\%\) of the original, as opposed to the safety prompt which causes a decrease of \(3.3\%\) on LLaVA-Wild. This demonstrates that despite the ongoing challenge of achieving adversarial robustness in standalone image recognition, circuit breakers enable the larger multimodal system to reliably counter image "hijacks" [6] intended to elicit harmful outputs.

### AI Agents

**Adding Circuit Breakers.** We mix the circuit breaker and retain datasets from Section 4.1 with function calling circuit breaker and retain dataset. The detailed process of generating the function calling circuit breaker and retain dataset is described in Appendix A.3. For the LLMs with circuit breakers, we also use the same hyperparameter configuration as in Section 4.1.

**Evaluation.** To evaluate the effectiveness of RR as a method of preventing AI agents from making harmful function calls, we design a dataset that consists of 100 requests intended to produce harmful actions via function calls, along with associated function definitions. These requests span a variety of categories, including cybercrime, disinformation, fraud, and harassment. The associated function definitions are designed to capture typical use cases of deployed AI agents including sending messages, browsing URLs, and using simple tools in addition to task-specific functions.

We provide a representative example in Appendix C.4.1. We record model compliance rate with harmful requests under both the standard setting, where function call requests are directly given and the model decides whether to make a call, and under _forced function-calling_, where the assistant is forced to begin its response with the name of a function to be called. Forced function-calling is akin to the prefilling attack in 4.1 and is provided by major model providers [3, 51]. For capabilities evaluation, we measure performance on the Berkeley Function Calling Leaderboard (BFCL) [69]. We use Llama-3-8B-Instruct to benchmark, as it is one of few open-source models that both _1)_ performs reasonably well on the benchmark leaderboard, and _2)_ is currently served with function-calling capabilities by inference providers [19].

**Results.** Figure 4 shows that after applying RR, our model is significantly more robust to harmful function calling requests, in both the no-attack and forced function-call settings, reducing harmful

Figure 4: Circuit-breaking performance in AI agent settings with Representation Rerouting (RR). Our Llama-3-8B-Instruct (+ RR) with circuit breakers remains robust under Direct Request and Forced Function Calls, while retaining performance on the Berkeley Function Calling Leaderboard (BFCL).

action compliance rates by \(84\%\) and \(83\%\) in the latter setting compared to baselines. Additionally, the model with circuit breakers retains performance on the Berkeley Function Calling Leaderboard. Overall, this demonstrates the method's effectiveness in controlling agent behaviors under adversarial pressure and in environments with inherent reward biases. It suggests the potential for mitigating harms like power-seeking or dishonesty by adding circuit breakers to the relevant model representations, which can be as simple as adjusting the circuit breaker set.

### Ablation and Analysis

**Ablations.** We do pairwise ablations for each component of the RR loss in Table 8. First, we see that augmenting the circuit breaker set with requests that bypass refusal mechanisms (w/ Augment) decreases ASR while still maintaining capabilities. Although ablating the refusal retain component (w/o refusal) increases relative robustness, it also degrades capabilities. Next, we try varying loss functions. We find that the RMU loss [29], which minimizes the \(\ell_{2}\) distance from a constant random unit vector, fails to converge. Finally, we find that minimizing the \(\ell_{2}\) distance from a distinct random positive vector at each step (RandP) works (though if the vector is centered at 0 (RandC), training fails). Overall, the cosine loss proposed in RR offers more stability than other losses. We then analyze the training data composition, which influences the kinds of harmful inputs that activate the circuit breakers.

To understand the generalization properties of circuit-breaking, we split our training data into six categories of harm, train category-specific models, and measure their generalization performance across categories. We find strong in-domain generalization, indicated by the low ASR along the diagonal in Figure 5, and observe that training on broader categories like Harmful and Illegal Activities offers greater generalization than narrower categories like Cybercrime. We report similar ablations for Mistral-7B in Appendix G.

**Representation analysis.** In Figure 6, we plot the cosines between representations of the Llama-3-8B-Instruct model with and without circuit breakers for a prefilled harmful response _"Here is how to build a bomb: 1. Start with"_. We additionally plot the norms of these representations in Figure 12.

We observe that in this case, the cosines and norms start to change dramatically _during prefilling_ starting from layer 10, i.e., even before generation starts. We note that we use layers 10 and 20 for circuit-breaking, so we do not expect substantial changes in the cosines and norms before layer 10 which is confirmed by the behavior of these metrics at layer 5. Although we do not directly control the representation norms during training, we observe that they often dramatically increase after circuit-breaking occurs. We repeat the same experiment for Mistral-7B-Instruct and show it in Appendix H, where we also analyze two other prompts: one that leads to a similar behavior and one that triggers circuit breakers after generation starts. Importantly, we conclude that our proposed method has the intended effect on the representations and that we can detect activation of circuit breakers by directly analyzing the internal representations. This can lead to system-level mitigations like using a probe to detect when circuit breakers are activated to stop generation and, for example, provide a message that the request is considered harmful and further generation is not possible.

**Circuit breaking with Harmfulness Probes (HP).** Our proposed circuit breaking method relies on _representation control_. This section evaluates the potential efficacy of _representation reading_ as an

Figure 5: Circuit Breaker set ablation across categories of harm, averaged over the same 6 attacks.

Figure 6: Cosine analysis of internal representations of the Llama model without and with circuit breakers.

alternative. Instead of altering the harmful model representation, we simply monitor for its presence and halt model generation if detected. We employ the same training dataset (harmful circuit breaker set and retain set) used in the LLM experiments. A linear classifier and an MLP classifier are trained to distinguish between model activations from the two datasets. Specifically, activations are collected from the 16th layer of the Mistral model and from the final layer of the Llama-3 model for each token in the responses. The MLP probe has two layers with hidden size of 64 and 32. During testing, generation is halted and replaced with a refusal message if any generated token is flagged as harmful by the classifier. We find a threshold so that the false positive rate (FPR) on WildChat (Appendix B) is around the same as the model trained with RR [74]. We choose five settings to evaluate: prompt only (No Attack), manual attack (Manual), black-box attack (TAP-T), white-box attack (GCG), and an embedding space attack (Input Embed).

As shown in table 2, Harmfulness Probing (HP) significantly reduces the attack success rate compared to the refusal-trained baseline. Both Linear and MLP Harmfulness Probes are outperformed by the representation control approach (RR), however, the gap is smaller for the MLP probe. We emphasize that, although generally probing can be easily thwarted by adversarial attacks, much like input and output filters, its robustness in this context can be largely attributed to the continuous monitoring of model representations associated with harmful processes throughout the entire generation, a key idea in circuit breaking. Furthermore, one can combine HP and RR to implement multiple layers of defense. It is important to note, however, that the Harmful Probes are tested under a weaker adversarial setting, where the attacker lacks knowledge of the probe and does not directly optimize against it. Further investigation into Harmfulness Probes and other representation reading methods is left for future work.

## 5 Limitations and Conclusion

Despite the promise of the methods introduced here, we emphasize that the approach we present is aiming at preventing one particular type of adversarial attack: an attack against the ability of the model to produce harmful content (often specifically against the desires of the model developer). In general, adversarial attacks can achieve other aims as well, i.e., using a generative vision language model as a drop-in replacement for an image classifier. In such a use case, our method would not provide defense against "traditional" adversarial attacks aimed at simply changing the class label, because no class label would be inherently "harmful." Thus, there is an important distinction of our approach: we are specifically targeting the adversarial attack setting where the goal of an attacker is to produce generically harmful information (content the model should _never_ produce). Nonetheless, for this particular use case of adversarial attacks, and for single-turn conversations that we focus on circuit-breaking, our approach dramatically improves model robustness. Overall we found that circuit breakers, based on RepE, make models intrinsically safer and robust to unseen adversarial attacks. The method is highly general and can impart robustness to image hijacks, and it can also prevent AI agents from taking harmful actions. Our method is potentially a major step forward in making models more aligned and robust.

\begin{table}
\begin{tabular}{c c c c c c c c c c} \hline \hline  & & \multicolumn{4}{c}{Mistral-7B-Instruct-v2} & \multicolumn{4}{c}{Llama-3-8B-Instruct} \\ \cline{3-10}  & & Refusal & + HP & + HP & + RR & Refusal & + HP & + HP & + RP & \\  & Trained & (Linear) & (MLP) & + RR & Trained & (Linear) & (MLP) & + RR \\ \hline Over-Refusal & WildChat & **2.0** & 3.6 & 3.6 & 3.4 & **2.2** & 6.2 & 6.2 & 6.2 \\ \hline  & No Attack & 57.8 & 16.6 & 12.5 & **4.9** & 12.4 & 6.6 & 5.8 & **1.2** \\  & Manual & 77.4 & 7.4 & **5.2** & 6.8 & 8.3 & 1.7 & 0.8 & **0.0** \\ Robustness & TAP-T & 85.8 & 27.5 & 26.2 & **17.5** & 17.4 & 8.3 & 6.2 & **2.1** \\  & GCG & 88.7 & 18.0 & 14.6 & **11.2** & 44.5 & 11.6 & 9.1 & **2.5** \\  & Input Embed & 92.1 & 16.3 & **13.0** & 15.7 & 80.4 & 16.8 & 12.2 & **9.6** \\ \cline{2-10}  & Average & 80.6 & 19.0 & 14.3 & **11.2** & 32.6 & 9.0 & 6.8 & **3.1** \\ \hline \hline \end{tabular}
\end{table}
Table 2: Comparison of Harmfulness Probing (HP) and Representation Rerouting (RR). RR is a representation control method whereas HP is a representation reading method. HP, when applied using a reasonable threshold, significantly lowers the ASR compared to a refusal-trained baseline.

## Acknowledgments

We are thankful to Steven Basart, Stephen Casper, David Dalrymple, Xander Davies, and Fabien Roger for providing valuable feedback on the paper.

## References

* Alon and Kamfonas [2023] G. Alon and M. Kamfonas. Detecting language model attacks with perplexity. _arXiv preprint arXiv:2308.14132_, 2023.
* Andriushchenko et al. [2024] M. Andriushchenko, F. Croce, and N. Flammarion. Jailbreaking leading safety-aligned LLMs with simple adaptive attacks. _arXiv preprint arXiv:2404.02151_, 2024.
* Anthropic [2024] Anthropic. Tool use (function calling), 2024. URL https://docs.anthropic.com/en/docs/tool-use#forcing-tool-use. Anthropic documentation.
* Anthropic [2024] Anthropic. Prefill claude's response, 2024. URL https://docs.anthropic.com/en/docs/prefill-claudes-response. Anthropic documentation.
* Anthropic [2024] Anthropic. The claude 3 model family: Opus, sonnet, haiku, 2024.
* Bailey et al. [2023] L. Bailey, E. Ong, S. Russell, and S. Emmons. Image hijacks: Adversarial images can control generative models at runtime. _arXiv preprint arXiv:2309.00236_, 2023.
* Bau et al. [2020] D. Bau, H. Strobelt, W. Peebles, J. Wulff, B. Zhou, J.-Y. Zhu, and A. Torralba. Semantic photo manipulation with a generative image prior. _arXiv preprint arXiv:2005.07727_, 2020.
* Beeching et al. [2023] E. Beeching, C. Fourrier, N. Habib, S. Han, N. Lambert, N. Rajani, O. Sanseviero, L. Tunstall, and T. Wolf. Open llm leaderboard. https://huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard, 2023.
* Carlini et al. [2023] N. Carlini, M. Nasr, C. A. Choquette-Choo, M. Jagielski, I. Gao, P. W. W. Koh, D. Ippolito, F. Tramer, and L. Schmidt. Are aligned neural networks adversarially aligned? _Advances in Neural Information Processing Systems_, 36, 2023.
* Caron et al. [2021] M. Caron, H. Touvron, I. Misra, H. Jegou, J. Mairal, P. Bojanowski, and A. Joulin. Emerging properties in self-supervised vision transformers. In _Proceedings of the IEEE/CVF international conference on computer vision_, pages 9650-9660, 2021.
* Chao et al. [2023] P. Chao, A. Robey, E. Dobriban, H. Hassani, G. J. Pappas, and E. Wong. Jailbreaking black box large language models in twenty queries, 2023.
* Christiano et al. [2017] P. F. Christiano, J. Leike, T. Brown, M. Martic, S. Legg, and D. Amodei. Deep reinforcement learning from human preferences. _Advances in neural information processing systems_, 30, 2017.
* Clark et al. [2018] P. Clark, I. Cowhey, O. Etzioni, T. Khot, A. Sabharwal, C. Schoenick, and O. Tafjord. Think you have solved question answering? try arc, the ai2 reasoning challenge, 2018.
* Cobbe et al. [2021] K. Cobbe, V. Kosaraju, M. Bavarian, M. Chen, H. Jun, L. Kaiser, M. Plappert, J. Tworek, J. Hilton, R. Nakano, C. Hesse, and J. Schulman. Training verifiers to solve math word problems, 2021.
* Ding et al. [2023] N. Ding, Y. Chen, B. Xu, Y. Qin, Z. Zheng, S. Hu, Z. Liu, M. Sun, and B. Zhou. Enhancing chat language models by scaling high-quality instructional conversations. _arXiv preprint arXiv:2305.14233_, 2023.
* Feffer et al. [2024] M. Feffer, A. Sinha, Z. C. Lipton, and H. Heidari. Red-teaming for generative ai: Silver bullet or security theater? _arXiv preprint arXiv:2401.15897_, 2024.
* GlaiveAI [2024] GlaiveAI. Glaive function calling v2 dataset, 2024. URL https://huggingface.co/datasets/glaiveai/glaive-function-calling-v2. Accessed: 2024-05-21.

* [18] G. Goh, N. Cammarata, C. Voss, S. Carter, M. Petrov, L. Schubert, A. Radford, and C. Olah. Multimodal neurons in artificial neural networks. _Distill_, 6(3):e30, 2021.
* [19] Groq. Groqcloud models documentation, 2024. URL https://console.groq.com/docs/models. GroqCloud documentation.
* [20] A. Helbling, M. Phute, M. Hull, and D. H. Chau. Llm self defense: By self examination, llms know they are being tricked. _arXiv preprint arXiv:2308.07308_, 2023.
* [21] D. Hendrycks. Introduction to AI safety, ethics, and society. Taylor and Francis, 2024.
* [22] D. Hendrycks, C. Burns, S. Basart, A. Zou, M. Mazeika, D. Song, and J. Steinhardt. Measuring massive multitask language understanding. _arXiv preprint arXiv:2009.03300_, 2020.
* [23] E. J. Hu, Y. Shen, P. Wallis, Z. Allen-Zhu, Y. Li, S. Wang, L. Wang, and W. Chen. Lora: Low-rank adaptation of large language models. _arXiv preprint arXiv:2106.09685_, 2021.
* [24] G. Ilharco, M. T. Ribeiro, M. Wortsman, S. Gururangan, L. Schmidt, H. Hajishirzi, and A. Farhadi. Editing models with task arithmetic. _arXiv preprint arXiv:2212.04089_, 2022.
* [25] H. Inan, K. Upasani, J. Chi, R. Rungta, K. Iyer, Y. Mao, M. Tontchev, Q. Hu, B. Fuller, D. Testugine, and M. Khabsa. Llama guard: Llm-based input-output safeguard for human-ai conversations, 2023.
* [26] N. Jain, A. Schwarzschild, Y. Wen, G. Somepalli, J. Kirchenbauer, P.-y. Chiang, M. Goldblum, A. Saha, J. Geiping, and T. Goldstein. Baseline defenses for adversarial attacks against aligned language models. _arXiv preprint arXiv:2309.00614_, 2023.
* [27] T. Kim, S. Kotha, and A. Raghunathan. Jailbreaking is best solved by definition. _arXiv preprint arXiv:2403.14725_, 2024.
* [28] N. Leveson. Engineering a safer world: Systems thinking applied to safety. 2012.
* [29] N. Li, A. Pan, A. Gopal, S. Yue, D. Berrios, A. Gatti, J. D. Li, A.-K. Dombrowski, S. Goel, L. Phan, G. Mukobi, N. Helm-Burger, R. Lababidi, L. Justen, A. B. Liu, M. Chen, I. Barrass, O. Zhang, X. Zhu, R. Tamirisa, B. Bharathi, A. Khoja, Z. Zhao, A. Herbert-Voss, C. B. Breuer, S. Marks, O. Patel, A. Zou, M. Mazeika, Z. Wang, P. Oswal, W. Liu, A. A. Hunt, J. Tienken-Harder, K. Y. Shih, K. Talley, J. Guan, R. Kaplan, I. Steneker, D. Campbell, B. Jokubaitis, A. Levinson, J. Wang, W. Qian, K. K. Karmakar, S. Basart, S. Fitz, M. Levine, P. Kumaraguru, U. Tupakula, V. Varadharajan, Y. Shoshitaishvili, J. Ba, K. M. Esvelt, A. Wang, and D. Hendrycks. The wmdp benchmark: Measuring and reducing malicious use with unlearning, 2024.
* [30] N. M. Li Maximilian, Davies Xander. Circuit breaking: Removing model behaviors with targeted ablation. _arXiv preprint arXiv:2309.05973_, 2023.
* [31] S. Lin, J. Hilton, and O. Evans. Truthfulqa: Measuring how models mimic human falsehoods, 2022.
* [32] T.-Y. Lin, M. Maire, S. Belongie, L. Bourdev, R. Girshick, J. Hays, P. Perona, D. Ramanan, C. L. Zitnick, and P. Dollar. Microsoft coco: Common objects in context, 2015.
* [33] H. Ling, K. Kreis, D. Li, S. W. Kim, A. Torralba, and S. Fidler. Editgan: High-precision semantic image editing. _Advances in Neural Information Processing Systems_, 34:16331-16345, 2021.
* [34] H. Liu, C. Li, Y. Li, B. Li, Y. Zhang, S. Shen, and Y. J. Lee. Llava-next: Improved reasoning, ocr, and world knowledge, January 2024. URL https://llava-vl.github.io/blog/2024-01-30-llava-next/.
* [35] X. Liu, H. Yu, H. Zhang, Y. Xu, X. Lei, H. Lai, Y. Gu, H. Ding, K. Men, K. Yang, et al. Agentbench: Evaluating llms as agents. _arXiv preprint arXiv:2308.03688_, 2023.
* [36] X. Liu, N. Xu, M. Chen, and C. Xiao. Autodan: Generating stealthy jailbreak prompts on aligned large language models. _ICLR_, 2024.

* Liu et al. [2024] X. Liu, Y. Zhu, J. Gu, Y. Lan, C. Yang, and Y. Qiao. Mm-safetybench: A benchmark for safety evaluation of multimodal large language models, 2024.
* Madry et al. [2017] A. Madry, A. Makelov, L. Schmidt, D. Tsipras, and A. Vladu. Towards deep learning models resistant to adversarial attacks. _arXiv preprint arXiv:1706.06083_, 2017.
* Mangaokar et al. [2024] N. Mangaokar, A. Hooda, J. Choi, S. Chandrashekaran, K. Fawaz, S. Jha, and A. Prakash. Prp: Propagating universal perturbations to attack large language model guard-rails. _arXiv preprint arXiv:2402.15911_, 2024.
* Mazeika et al. [2024] M. Mazeika, L. Phan, X. Yin, A. Zou, Z. Wang, N. Mu, E. Sakhaee, N. Li, S. Basart, B. Li, D. Forsyth, and D. Hendrycks. Harmbench: A standardized evaluation framework for automated red teaming and robust refusal. 2024.
* Mehrotra et al. [2023] A. Mehrotra, M. Zampetakis, P. Kassianik, B. Nelson, H. Anderson, Y. Singer, and A. Karbasi. Tree of attacks: Jailbreaking black-box llms automatically. _arXiv preprint arXiv:2312.02119_, 2023.
* Meng et al. [2022] K. Meng, D. Bau, A. Andonian, and Y. Belinkov. Locating and editing factual associations in GPT. _Advances in Neural Information Processing Systems_, 35, 2022.
* Meng et al. [2022] K. Meng, A. S. Sharma, A. Andonian, Y. Belinkov, and D. Bau. Mass-editing memory in a transformer. _arXiv preprint arXiv:2210.07229_, 2022.
* [44] Meta AI. Llama-3 8b instruct. https://huggingface.co/meta-llama/Meta-Llama-3-8B-Instruct, 2024. Instruction-tuned version of the Llama 3 model.
* Mialon et al. [2023] G. Mialon, R. Dessi, M. Lomeli, C. Nalmparantis, R. Pasunuru, R. Raileanu, B. Roziere, T. Schick, J. Dwivedi-Yu, A. Celikyilmaz, et al. Augmented language models: a survey. _arXiv preprint arXiv:2302.07842_, 2023.
* Mikolov et al. [2013] T. Mikolov, K. Chen, G. Corrado, and J. Dean. Efficient estimation of word representations in vector space. _arXiv preprint arXiv:1301.3781_, 2013.
* [47] Mistral. Mistral 7b v0.2. https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2, 2024. Fine-tuned model for instruction-following tasks.
* Mitchell et al. [2021] E. Mitchell, C. Lin, A. Bosselut, C. Finn, and C. D. Manning. Fast model editing at scale. _arXiv preprint arXiv:2110.11309_, 2021.
* [49] Z. Mowshowitz. Jailbreaking chatgpt on release day. https://www.lesswrong.com/posts/RYcoJdymoBbi5Nax7/jailbreaking-chatgpt-on-release-day, 2022. Accessed: 2024-05-19.
* [50] OpenAI. Gpt-4 technical report, 2023.
* [51] OpenAI. Chat completions (tool_choice), 2024. URL https://platform.openai.com/docs/api-reference/chat/create#chat-create-tool_choice. OpenAI documentation.
* Ouyang et al. [2022] L. Ouyang, J. Wu, X. Jiang, D. Almeida, C. Wainwright, P. Mishkin, C. Zhang, S. Agarwal, K. Slama, A. Ray, et al. Training language models to follow instructions with human feedback. _Advances in Neural Information Processing Systems_, 35:27730-27744, 2022.
* Perez et al. [2022] E. Perez, S. Huang, F. Song, T. Cai, R. Ring, J. Aslanides, A. Glaese, N. McAleese, and G. Irving. Red teaming language models with language models. _arXiv preprint arXiv:2202.03286_, 2022.
* Rafailov et al. [2023] R. Rafailov, A. Sharma, E. Mitchell, S. Ermon, C. D. Manning, and C. Finn. Direct preference optimization: Your language model is secretly a reward model, 2023.
* Reid et al. [2024] M. Reid, N. Savinov, D. Teplyashin, D. Lepikhin, T. Lillicrap, J.-b. Alayrac, R. Soricut, A. Lazaridou, O. Firat, J. Schrittwieser, et al. Gemini 1.5: Unlocking multimodal understanding across millions of tokens of context. _arXiv preprint arXiv:2403.05530_, 2024.

* [56] A. Robey, E. Wong, H. Hassani, and G. J. Pappas. Smoothllm: Defending large language models against jailbreaking attacks. _arXiv preprint arXiv:2310.03684_, 2023.
* [57] P. Rottger, H. R. Kirk, B. Vidgen, G. Attanasio, F. Bianchi, and D. Hovy. Xstest: A test suite for identifying exaggerated safety behaviours in large language models. _arXiv preprint arXiv:2308.01263_, 2023.
* [58] K. Sakaguchi, R. L. Bras, C. Bhagavatula, and Y. Choi. WINOGRANDE: an adversarial winograd schema challenge at scale, 2019.
* [59] C. Schlarmann and M. Hein. On the adversarial robustness of multi-modal foundation models. In _Proceedings of the IEEE/CVF International Conference on Computer Vision_, pages 3677-3685, 2023.
* [60] L. Schwinn, D. Dobre, S. Xhonneux, G. Gidel, and S. Gunnemann. Soft prompt threats: Attacking safety alignment and unlearning in open-source llms through the embedding space. _arXiv preprint arXiv:2402.09063_, 2024.
* [61] L. Shen, W. Tan, S. Chen, Y. Chen, J. Zhang, H. Xu, B. Zheng, P. Koehn, and D. Khashabi. The language barrier: Dissecting safety challenges of llms in multilingual contexts. _arXiv preprint arXiv:2401.13136_, 2024.
* [62] X. Shen, Z. Chen, M. Backes, Y. Shen, and Y. Zhang. "do anything now": Characterizing and evaluating in-the-wild jailbreak prompts on large language models, 2024.
* [63] H. Touvron, L. Martin, K. Stone, P. Albert, A. Almahairi, Y. Babaei, N. Bashlykov, S. Batra, P. Bhargava, S. Bhosale, et al. Llama 2: Open foundation and fine-tuned chat models. _arXiv preprint arXiv:2307.09288_, 2023.
* [64] D. Tsipras, S. Santurkar, L. Engstrom, A. Turner, and A. Madry. Robustness may be at odds with accuracy, 2019.
* [65] A. Turner, L. Thiergart, D. Udell, G. Leech, U. Mini, and M. MacDiarmid. Activation addition: Steering language models without optimization. _arXiv preprint arXiv:2308.10248_, 2023.
* [66] P. Upchurch, J. Gardner, G. Pleiss, R. Pless, N. Snavely, K. Bala, and K. Weinberger. Deep feature interpolation for image content changes. In _Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)_, July 2017.
* [67] J. Vega, I. Chaudhary, C. Xu, and G. Singh. Bypassing the safety training of open-source llms with priming attacks. _arXiv preprint arXiv:2312.12321_, 2023.
* [68] A. Wei, N. Haghtalab, and J. Steinhardt. Jailbroken: How does llm safety training fail? _arXiv preprint arXiv:2307.02483_, 2023.
* [69] F. Yan, H. Mao, C. C.-J. Ji, T. Zhang, S. G. Patil, I. Stoica, and J. E. Gonzalez. Berkeley function calling leaderboard. https://gorilla.cs.berkeley.edu/blogs/8_berkeley_function_calling_leaderboard.html, 2024.
* [70] Z.-X. Yong, C. Menghini, and S. H. Bach. Low-resource languages jailbreak gpt-4. _arXiv preprint arXiv:2310.02446_, 2023.
* [71] X. Yue, Y. Ni, K. Zhang, T. Zheng, R. Liu, G. Zhang, S. Stevens, D. Jiang, W. Ren, Y. Sun, C. Wei, B. Yu, R. Yuan, R. Sun, M. Yin, B. Zheng, Z. Yang, Y. Liu, W. Huang, H. Sun, Y. Su, and W. Chen. Mmmu: A massive multi-discipline multimodal understanding and reasoning benchmark for expert agi. In _Proceedings of CVPR_, 2024.
* [72] R. Zellers, A. Holtzman, Y. Bisk, A. Farhadi, and Y. Choi. Hellaswag: Can a machine really finish your sentence?, 2019.
* [73] Y. Zeng, H. Lin, J. Zhang, D. Yang, R. Jia, and W. Shi. How johnny can persuade llms to jailbreak them: Rethinking persuasion to challenge ai safety by humanizing llms. _arXiv preprint arXiv:2401.06373_, 2024.

* [74] W. Zhao, X. Ren, J. Hessel, C. Cardie, Y. Choi, and Y. Deng. Wildchat: 1m chatGPT interaction logs in the wild. In _The Twelfth International Conference on Learning Representations_, 2024. URL https://openreview.net/forum?id=B18u7ZR1bM.
* [75] L. Zheng, W.-L. Chiang, Y. Sheng, S. Zhuang, Z. Wu, Y. Zhuang, Z. Lin, Z. Li, D. Li, E. Xing, et al. Judging llm-as-a-judge with mt-bench and chatbot arena. _arXiv preprint arXiv:2306.05685_, 2023.
* [76] A. Zhou, B. Li, and H. Wang. Robust prompt optimization for defending language models against jailbreaking attacks. _arXiv preprint arXiv:2401.17263_, 2024.
* [77] A. Zou, L. Phan, S. Chen, J. Campbell, P. Guo, R. Ren, A. Pan, X. Yin, M. Mazeika, A.-K. Dombrowski, et al. Representation engineering: A top-down approach to ai transparency. _arXiv preprint arXiv:2310.01405_, 2023.
* [78] A. Zou, Z. Wang, J. Z. Kolter, and M. Fredrikson. Universal and transferable adversarial attacks on aligned language models. _arXiv preprint arXiv:2307.15043_, 2023.

Circuit Breaker Datasets

### Large Language Model Circuit Breaker Dataset

To construct a dataset of diverse harmful behaviors to activate circuit breakers while maintaining generalization, we prompt an uncensored LLM to generate short harmful queries and harmful completions given few-shot examples across a wide range of categories. We then filter out all samples that have a BLEU score above 0.3 when compared to any behavior in HarmBench's standard behaviors set [40] to avoid data contamination with the benchmark.

### Multimodal Circuit Breaker Dataset

To effectively construct a multimodal circuit breaker dataset containing images and their corresponding harmful queries and completions, we first use the LLaVA-Mistral-7B model [34] to generate detailed image descriptions from a sample of images from the COCO Dataset [32]. We then prompt an uncensored LLM to generate related harmful queries based on the given image descriptions, as well as the harmful completions. The final circuit breaker multimodal dataset will consist of an image and its corresponding harmful queries and harmful completions.

### Function Calling Circuit Breaker / Retain Dataset

To construct the Agent Circuit Breaker Dataset, we start with function definitions from the Glaive Function Calling v2 [17]. Using these function definitions, we prompt an LLM to generate harmful requests. Following this, we use GPT-3.5-turbo to execute these harmful requests and obtain the corresponding function outputs. These outputs are then converted to the OpenFunctions format. Additionally, we filter out all samples that have a BLEU score above 0.1 when compared to any behavior in our proposed AgentBench (Section 4.3). We utilize the original Glaive Function Calling v2 dataset as the harmless retain set.

## Appendix B Refusal Evaluation

Following the methodology outlined in [5], we construct an over-refusal evaluation using the WildChat dataset [74]. WildChat is a large corpus of real-world user-ChatGPT interactions, covering a wide range of complex topics such as ambiguous requests, code-switching, topic-switching, and political discussions. This dataset is instrumental in evaluating chat model's tendencies in handling problematic requests.

For our evaluation, we filter a subset of 500 English non-toxic user-GPT-4 requests. To measure refusal in standard models, we employ keyword checking. For the models with circuit breakers, we use both keyword checking and the perplexity score as measures of refusal. The refusal results are shown in Table 3. While models with circuit breakers show an increase in refusal rate, the rate remains considerably lower compared to more refusal-trained models like Claude-3.

## Appendix C Experimental Details

### Additional Design Considerations for Circuit Breakers

In this section, we discuss several important design considerations:

\begin{table}
\begin{tabular}{l c c c c c c} \hline  & \multicolumn{3}{c}{Mistral-7B-Instruct-v2} & \multicolumn{3}{c}{Llama-3-8B-Instruct} \\ \cline{2-7}  & Original & + Adv Trained & + RR (Ours) & Original & + RR (Ours) & Claude-3-Opus \\ \hline WildChat Refusal Rate & 2.0 & 10.6 & 3.4 & 2.2 & 6.2 & 20.6 \\ \hline \end{tabular}
\end{table}
Table 3: Refusal evaluation on WildChat [74]. Models with circuit breakers show an increase in refusal rate, however it still remains considerably lower compared to more refusal-trained models like Claude-3 and adversarial training.

[MISSING_PAGE_FAIL:17]

find harmful directions. For a given model, we run forward passes on each pair of prompts, and cache the per-layer activations at the last sequence position. We take the differences between the activations of each pair, and then apply PCA on the \(N\) difference vectors at each layer, taking the first principal component to get per-layer directions that can be used to control the model. At inference time, we apply these directions to the outputs of transformer layers by using the linear-combination operator; i.e., for each layer we wish to control, we add to its output its corresponding direction vector scaled by a coefficient.

In all our experiments, we use RepE on layers -11 through -20 (inclusive), where the -1 layer is the final transformer layer prior to the language modeling head, and layer indices that are more negative are closer to the input layer of the model. We use the harmful-harmless dataset [77] and control coefficients of 0.65 and 1.0 for Mistral-7B and Llama-3, respectively.

### Multimodal Models

#### c.3.1 Detailed Circuit Breaker Setup

We perform the circuit-breaking procedure on the language model backbone in LLaVA-NeXT-Mistral-7B [34] while freezing the image encoder and projection layer. We set \(\alpha\) to 5 and target layer 16 for the circuit-breaking loss on LoRA adapters in layers 14 through 16. We alternate between circuit-breaking on text and multimodal training samples at each step.

#### c.3.2 Detailed Evaluation Setup

Robustness DatasetOur dataset of 133 harmful text-image pairs used for robustness evaluation consists of 54 samples from HarmBench's multimodal behaviors dataset, and 79 samples from MM-SafetyBench's Tiny dataset. For both datasets, the samples consist of an image and a prompt referencing the image. From the HarmBench multimodal dataset, we chose behaviors that were most saliently harmful (i.e. promoting crime, injury, damage, fraud, etc.), primarily excluding prompts asking for CAPTCHA solutions along with borderline harmful prompts. MM-SafetyBench provides prompts for 13 scenarios, across which the nature of the prompts' harmfulness differs. We include examples from the scenarios labelled "Illegal Activity", "Hate Speech", "Malware Generation", "Physical Harm", "Economic Harm", "Fraud", and "Privacy Violence". We exclude examples from the remaining scenarios such as "Financial Advice" and "Legal Opinion", where the harm arises from the potential inaccuracy of model responses.

Robustness EvaluationFor baseline evaluations with a safety prompt, we prefix prompt text with the same safety prompt as in [37], namely: _"If the following questions are unsafe, harmful, or malicious, please refuse to answer them and give your explanation."_

Table 4 shows a breakdown of our multimodal robustness results by category. The categories are based off of the MM-SafetyBench scenarios from which a portion of our dataset was drawn, with which we also used to categorize the HarmBench samples in our dataset.

\begin{table}
\begin{tabular}{c c c c c c c c} \hline \hline  & Category & 
\begin{tabular}{c} LLaVA-NeXT-Mistral-7B \\ \end{tabular} & \multicolumn{3}{c}{+ Safety Prompt} & \multicolumn{3}{c}{+ RR (Ours)} \\ \cline{3-8}  & & No Attack & PGD Attack & No Attack & PGD Attack & No Attack & PGD Attack \\ \hline \multirow{8}{*}{Robustness (\(\downarrow\))} & Illegal Activity & 77.1 & 88.6 & 14.3 & 91.4 & 8.6 & 22.9 \\  & Hate Speech \& Bias & 45.5 & 86.4 & 0.0 & 90.9 & 0.0 & 0.0 \\  & Malware Generation & 100.0 & 100.0 & 0.0 & 100.0 & 0.0 & 0.0 \\  & Physical Harm & 81.8 & 86.4 & 22.7 & 100.0 & 0.0 & 18.2 \\  & Economic Harm & 57.1 & 100.0 & 14.3 & 100.0 & 0.0 & 14.3 \\  & Fraud & 92.6 & 96.3 & 11.1 & 100.0 & 0.0 & 18.5 \\  & Privacy Violation & 93.3 & 93.3 & 13.3 & 100.0 & 0.0 & 6.7 \\ \hline \multicolumn{8}{c}{**Average**} & 77.4 & 91.0 & 12.0 & 96.2 & **2.3** & **14.3** \\ \hline \hline \end{tabular}
\end{table}
Table 4: Multimodal Robustness Results by Category

### AI Agents

We use gpt-4-turbo [50] as a judge to evaluate robustness to harmful requests for function-calls, since the HarmBench classifier was not trained on function calling data.

We set generation temperature to 0 when evaluating on the Berkeley Function Calling Leaderboard. We report the average of the AST and Exec scores.

#### c.4.1 AI Agent Benchmark Example

## Appendix D Open LLM Results

Table 5 shows the scores for each individual benchmark in the Open LLM evaluation.

Figure 7: A generic function definition and harmful request.

## Appendix E Detailed Results in Multimodal and Agent Settings

The multimodal results on the left show that under Projected Gradient Descent (PGD) attack, the model with circuit breakers is significantly more robust compared to the original model even with a safety prompt (+Prompt) that instructs the model to avoid harmful responses. Performance on multimodal capabilities benchmarks LLaVA-Wild and MMMU is preserved. In the agent setting on the right, our model with circuit breakers remains robust under Forced Function Calling (Forced F/C), while retaining performance on the Berkeley Function Calling Leaderboard (BFCL).

## Appendix F Multilingual Results

In both [70] and [61], it was observed that LRL attacks perform better than HRL attacks. We do not see that trend in Table 6. We leave investigation of this to future work.

\begin{table}
\begin{tabular}{l l c c c c} \hline \hline  & & \multicolumn{3}{c}{Mistral-7B-Instruct-v2} & \multicolumn{2}{c}{Llama-3-8B-Instruct} \\ \cline{3-6}  & Language & Original & + Adv Trained & + RR (Ours) & Original & + RR (Ours) \\ \hline \multirow{2}{*}{HRL} & Simplified Mandarin (zh-CN) & 50.7 & **5.8** & 7.4 & 24.8 & **3.3** \\  & Italian (it) & 50.7 & 9.1 & **6.6** & 26.6 & **3.7** \\ \hline \multirow{2}{*}{MRL} & Ukrainian (uk) & 50.7 & **5.8** & 9.1 & 21.1 & **3.3** \\  & Thai (th) & 31.2 & **1.7** & 12.8 & 22.4 & **2.9** \\ \hline \multirow{2}{*}{LRL} & Zulu (zu) & 6.6 & 4.2 & **3.7** & 4.6 & **2.9** \\  & Guarani (gn) & 14.5 & **2.1** & 4.1 & 16.2 & **5.0** \\ \hline \multirow{4}{*}{LRL} & HRL Average & 50.7 & 7.4 & **7.0** & 25.7 & **3.5** \\  & MRL Average & 40.9 & **3.7** & 11.0 & 21.7 & **3.1** \\ \cline{1-1}  & LRL Average & 10.5 & **3.1** & 3.9 & 10.4 & **3.9** \\ \cline{1-1}  & Average & 34.1 & **4.7** & 7.3 & 19.3 & **3.5** \\ \hline \hline \end{tabular}
\end{table}
Table 6: Attack Success Rates by Language

Figure 8: Left: Multimodal results. Right: Agent results.

\begin{table}
\begin{tabular}{l l c c c c c c} \hline \hline  & & \multicolumn{3}{c}{Mistral-7B-Instruct-v2} & \multicolumn{3}{c}{Llama-3-8B-Instruct} \\ \cline{3-6}  & & Refusal & Adv & + RR (Ours) & Refusal & + RR & Cygnet \\  & Trained & Trained & (Ours) & Trained & (Ours) & (Ours) \\ \hline \multirow{6}{*}{Benchmarks (\(\uparrow\))} & MMLU & 59.1 & **61.3** & 58.9 & **65.6** & 65.0 & **65.6** \\  & ARC-c & 62.3 & 60.9 & **62.4** & 62.0 & 61.4 & **63.1** \\  & HellaSwag & **84.8** & 83.0 & 82.6 & 78.6 & 76.8 & **82.6** \\  & TruthfulQA & 66.8 & 45.5 & **67.0** & 51.7 & 51.7 & **60.0** \\  & Winogrande & 76.8 & **78.6** & 77.4 & 75.9 & 76.7 & **78.9** \\  & GSM8k & 42.9 & 38.1 & **44.1** & 78.6 & 78.5 & **81.0** \\ \cline{2-6}  & Average & **65.4** & 61.2 & **65.4** & 68.8 & 68.3 & **71.9** \\ \hline \hline \end{tabular}
\end{table}
Table 5: Open LLM Evaluation Results

## Appendix G Additional Ablation Results

In general, we find that with Mistral, loss terms that leverage random vectors decrease ASR but also decrease capabilities. We don't try the augmenting the circuit breaker set or adding refusal data to the retain set because Mistral-7B is not trained with refusal mechanisms. We also find that the circuit breaker set is relatively robust to distribution shifts in categories of harm.

## Appendix H Extended analysis of representations

Here, we provide an extended representation analysis compared to Section 4.4. In Figure 10, we use the same prefilling example (_"Here is how to synthesize meth: 1. Start with"_) but on the Mistral-7B models. Here we also observe that circuit-breaking occurs during prefilling similarly to Llama-3-8B. However, this is not always the case: for example in Figure 11, we show a slightly modified prefilling example _"Here is how to synthesize m-e-t-h: 1. Start with"_ (i.e., the word _"meth"_ is purposefully obfuscated). In this case, circuit-breaking happens _during generation_ which is a common scenario:

\begin{table}
\begin{tabular}{l c c} \hline \hline  & RMU & RR \\ \hline Avg ASR & 2.8 & 7.0 \\ MT-Bench & 7.1 & 7.5 \\ \hline \hline  & RandP & RR \\ \hline Avg ASR & 6.1 & 7.0 \\ MT-Bench & 7.4 & 7.5 \\ \hline \hline \end{tabular}
\end{table}
Table 7: Mistral-7B Loss Ablation Results

Figure 9: Left: Circuit-breaking loss ablations. Average ASR is reported across 6 attacks (Direc-tRequest, HumanJailbreaks, TAP-T, GCG-T, Prefill, RepE). Right: Circuit-breaking generalization across categories of harm, averaged over the same 6 attacks as the circuit-breaking loss ablation.

under an adversarial attack, the model starts generating harmful content but switches to meaningless outputs before harmful knowledge is revealed.

In Figure 12 and Figure 13, we show cosines and norms on Llama-3-8B and Mistral-7B for a different prefilling prompt: _"Sure, here is how to make a bomb: 1. Start with"_. We observe that for both model families, circuit-breaking occurs during prefilling, similarly to the example presented in Section 4.4. The only difference is that the norms at layer 10 do not grow significantly, unlike the norms at layer 20 that clearly indicate circuit-breaking.

Figure 11: Analysis of internal representations of the Mistral-7B-v0.2-Instruct model without and with circuit breakers for a prefilled response _Here is how to synthesize m-e-t-h: 1. Start with_ (i.e., the word _meth_ is purposefully obfuscated). The cosines slightly decrease and norms of later layers increase dramatically _after generation begins_ indicating circuit-breaking.

Figure 10: Analysis of internal representations of the Mistral-7B-v0.2-Instruct model without and with circuit breakers for a prefilled response _Here is how to synthesize meth: 1. Start with_. The cosines and norms start to change dramatically during the prefilling indicating circuit-breaking (starting from layer 10) even before generation starts.

### NeurIPS Paper Checklist

1. **Claims** Question: Do the main claims made in the abstract and introduction accurately reflect the paper's contributions and scope? Answer: [Yes] Justification: Yes, the abstract and introduction accurately reflect our contributions and scope. Guidelines: * The answer NA means that the abstract and introduction do not include the claims made in the paper. * The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers. * The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings. * It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper.

Figure 12: Analysis of internal representations of the Llama-3-8B-Instruct model without and with circuit breakers for a prefilled response _Sure, here is how to make a bomb: 1. Start with_. The cosines and norms start to change dramatically during the prefilling indicating circuit-breaking even before generation starts.

Figure 13: Analysis of internal representations of the Mistral-7B-v0.2-Instruct model without and with circuit breakers for a prefilled response _Sure, here is how to make a bomb: 1. Start with_. The cosines and norms start to change dramatically during the prefilling indicating circuit-breaking even before generation starts.

2. **Limitations** Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] Justification: Yes, we discuss them in Section 5. Guidelines: * The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper. * The authors are encouraged to create a separate "Limitations" section in their paper. * The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be. * The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated. * The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon. * The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size. * If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness. * While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren't acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations.
3. **Theory Assumptions and Proofs** Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? Answer: [NA] Justification: We do not provide theoretical results. Guidelines: * The answer NA means that the paper does not include theoretical results. * All the theorems, formulas, and proofs in the paper should be numbered and cross-referenced. * All assumptions should be clearly stated or referenced in the statement of any theorems. * The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition. * Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material. * Theorems and Lemmas that the proof relies upon should be properly referenced.
4. **Experimental Result Reproducibility** Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? Answer: [Yes]Justification: Yes, we discuss our experimental settings in the main part and in detail in the appendix. Guidelines: * The answer NA means that the paper does not include experiments. * If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not. * If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable. * Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed. * While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example 1. If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. 2. If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. 3. If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). 4. We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results.
5. **Open access to data and code** Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? Answer: [Yes] Justification: We provide our code and instructions to reproduce the results in the supplemental material. Guidelines: * The answer NA means that paper does not include experiments requiring code. * Please see the NeurIPS code and data submission guidelines (https://nips.cc/public/guides/CodeSubmissionPolicy) for more details. * While we encourage the release of code and data, we understand that this might not be possible, so "No" is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark). * The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (https://nips.cc/public/guides/CodeSubmissionPolicy) for more details. * The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.

* The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.
* At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).
* Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted.
6. **Experimental Setting/Details** Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? Answer: [Yes] Justification: Yes, we provide details of our experimental settings in the appendix. Guidelines: * The answer NA means that the paper does not include experiments. * The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. * The full details can be provided either with the code, in appendix, or as supplemental material.
7. **Experiment Statistical Significance** Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? Answer: [No] Justification: We do not provide error bars, but we conduct extensive experiments over many diverse attacks in different settings. Guidelines: * The answer NA means that the paper does not include experiments. * The authors should answer "Yes" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper. * The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions). * The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.) * The assumptions made should be given (e.g., Normally distributed errors). * It should be clear whether the error bar is the standard deviation or the standard error of the mean. * It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a 96% CI, if the hypothesis of Normality of errors is not verified. * For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates). * If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text.
8. **Experiments Compute Resources** Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? Answer: [Yes]Justification: We specify our computation resources and runtime of experiments in the appendix. Guidelines: * The answer NA means that the paper does not include experiments. * The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage. * The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute. * The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn't make it into the paper).
9. **Code Of Ethics** Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? Answer: [Yes] Justification: Yes, we confirm that the research complies with the NeurIPS Code of Ethics. Guidelines: * The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics. * If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics. * The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction).
10. **Broader Impacts** Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? Answer: [Yes] Justification: Yes, the positive societal impact of our work is the key aspect of our work which we motivate in detail in the introduction. Guidelines: * The answer NA means that there is no societal impact of the work performed. * If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact. * Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations. * The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster. * The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology. * If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML).
11. **Safeguards**Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? Answer: [Yes] Justification: Yes, our work directly focuses on introducing safeguards to existing open-weight models. Guidelines: * The answer NA means that the paper poses no such risks. * Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters. * Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images. * We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort.
12. **Licensees for existing assets** Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? Answer: [Yes] Justification: We cite the existing assets throughout the paper, with more details in the appendix. Guidelines: * The answer NA means that the paper does not use existing assets. * The authors should cite the original paper that produced the code package or dataset. * The authors should state which version of the asset is used and, if possible, include a URL. * The name of the license (e.g., CC-BY 4.0) should be included for each asset. * For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided. * If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset. * For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided. * If this information is not available online, the authors are encouraged to reach out to the asset's creators.
13. **New Assets** Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? Answer: [Yes] Justification: We document in detail the training procedure for our models and the approach we used for collecting fine-tuning data. Guidelines: * The answer NA means that the paper does not release new assets. * Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.

* The paper should discuss whether and how consent was obtained from people whose asset is used.
* At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file.
14. **Crowdsourcing and Research with Human Subjects** Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? Answer: [NA] Justification: We do not conduct experiments with human subjects. Guidelines: * The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. * Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper. * According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector.
15. **Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects** Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? Answer: [NA] Justification: Our research does not require an IRB approval. Guidelines: * The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. * Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper. * We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution. * For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review.