# Anonymous Learning via Look-Alike Clustering: A Precise Analysis of Model Generalization

 Adel Javanmard

University of Southern California, Google Research

ajavanma@usc.edu

&Vahab Mirrokni

Google Research

mirrokni@google.com

###### Abstract

While personalized recommendations systems have become increasingly popular, ensuring user data protection remains a top concern in the development of these learning systems. A common approach to enhancing privacy involves training models using anonymous data rather than individual data. In this paper, we explore a natural technique called _look-alike clustering_, which involves replacing sensitive features of individuals with the cluster's average values. We provide a precise analysis of how training models using anonymous cluster centers affects their generalization capabilities. We focus on an asymptotic regime where the size of the training set grows in proportion to the features dimension. Our analysis is based on the Convex Gaussian Minimax Theorem (CGMT) and allows us to theoretically understand the role of different model components on the generalization error. In addition, we demonstrate that in certain high-dimensional regimes, training over anonymous cluster centers acts as a regularization and improves generalization error of the trained models. Finally, we corroborate our asymptotic theory with finite-sample numerical experiments where we observe a perfect match when the sample size is only of order of a few hundreds.

## 1 Introduction

Look-alike modeling in machine learning encompasses a range of techniques that focus on identifying users who possess similar characteristics, behaviors, or preferences to a specific target individual. This approach primarily relies on the principle that individuals with shared attributes are likely to exhibit comparable interests and behaviors. By analyzing the behavior of these look-alike users, look-alike modeling enables accurate predictions for the target user. This technique has been widely used in various domains, including targeted marketing and personalized recommendations, where it plays a crucial role in enhancing user experiences and driving tailored outcomes [26; 19; 18; 21].

In this paper, we use look-alike clustering for a different purpose, namely to anonymize sensitive information of users. Consider a supervised regression setup where the training set contains \(n\) pairs \((\bm{x}_{i},\bm{y}_{i})\), for \(i\in[n]\), with \(y_{i}\in\mathbb{R}\) denoting the response and \(\bm{x}_{i}\in\mathbb{R}^{d}\) representing a high-dimensional vector of features. We consider two groups of features: sensitive features, which contain some personal information about users and should be protected from the leaner, and the non-sensitive features. We assume that that the learner has access to a clustering structure on users, which is non-private information (e.g. based on non-sensitive features or other non-sensitive data set on users).

We propose a look-alike clustering approach, where we anonymize the individuals' sensitive features by replacing them with the cluster's average values. Only the anonymized dataset will be shared with the learner who then uses it to train a model. We refer to Figure 1 for an illustration of this approach. Note that the learner never gets access to the individuals' sensitive features and so this approach is safe from re-identification attacks where the learner is given access to the pool of individuals' sensitive information (up to permutation) and may use the non-sensitive features to re-identify theusers. Also note that since a common representation (average sensitive features) is used for all the users in a cluster, this approach offers \(m\)-anonymity provided that each cluster is of size at least \(m\) (minimum size clustering).

Minimum size clustering has received an increased attention mainly as a tool for anonymization and when privacy considerations are in place [7; 2; 3]. A particular application is for providing anonymity for user targeting in online advertising with the goal of replacing the use of third-party cookies with a more privacy-respecting entity [10]. There are a variety of approximation algorithms for clustering with minimum size constraint [23; 9; 1; 24], as well as parallel and dynamic implementation [10].

In this paper, we focus on linear regression and derive a precise characterization of model generalization1 using the look-alike clustering approach, in the so-called _proportional regime_ where the size of training set grows in proportion to the number of parameters (which for the linear regression is equal to the number of features). The proportional regime has attracted a significant attention as overparametrized models have become greatly prevalent. It allows to understand the effect under/overparametrization in feature-rich models, providing insights to several intriguing phenomena, including double-descent behavior in the generalization error [22; 8; 14].

Footnote 1: the ability of the model to generalize to new, unseen data from the same distribution as the training data

Our precise asymptotic theory allows us to demystify the effect of different factors on the model generalization under look-alike clustering, such as the role of cluster size, number of clusters, signal-to-noise ratio of the model as well as the strength of sensitive and non-sensitive features. A key tool in our analysis is a powerful extension of Gordon's Gaussian process inequality [13] known as the Convex Gaussian Minimax Theorem (CGMT), which was developed in [30] and has been used for studying different learning problems; see e.g, [29; 8; 15; 14; 16].

Initially, it might be presumed that look-alike clustering would hinder model generalization by suppressing sensitive features of individuals, suggesting a possible tradeoff between anonymity (privacy) and model performance. However, our analysis uncovers scenarios in which look-alike clustering actually enhances model generalization! We will develop further insights on these results by arguing that the proposed look-alike clustering can serve as a form of regularization, mitigating model overfitting and consequently improving the model generalization.

Before summarizing our key contributions in this paper, we conclude this section by discussing some of the recent work on the tradeoff between privacy and model generalization at large. An approach to study such potential tradeoff is via the lens of memorization. Modern deep neural networks, with remarkable generalization property, operate in the overparametrized regime where there are more tunable parameters than the number of training samples. Such overparametrized models tend to interpolate the training data and are known to fit well even random labels [34; 33]. Similar phenomenon has been observed in other models, such as random forest [4], Adaboost [25; 32], and kernel methods [5; 17]. Beyond label memorization, [6] studies setting where learning algorithms with near-optimal generalization must encode most of the information about the entire high-dimensional (and high-entropy) covariates of the training examples. Clearly, memorization of training data imposes significant privacy risks when this data contains sensitive personal information, and therefore these results hint to a potential trade-off between privacy protection and model generalization [27; 12; 20]. Lastly, [11] studies settings where data is sampled from a mixture of subpopulations, and shows that label memorization is _necessary_ for achieving near-optimal generalization error, whenever the

Figure 1: Schematic illustration of look-alike clustering on features data. Within each cluster, the sensitive features of users are replaced by a common look-alike representation (center of the cluster). In this example, \(\mu_{1}\), \(\mu_{2}\), \(\mu_{3}\) represent the average of the sensitive features vectors for users in cluster 1, 2, 3.

distribution of subpopulation frequencies is long-tailed. Intuitively, this corresponds to datasets with many small distinct subpopulations. In order to predict more accurately on a subpopulation from which only a very few examples are observed, the algorithm needs to memorize their labels.

### Summary of contributions

We consider a linear regression setting for response variable \(y\) given feature \(\bm{x}\), and posit a Gaussian Mixture Model on the features to model the clustering structure on the samples. We focus on the high-dimensional asymptotic regime where the number of training samples \(n\), the dimension of sensitive features (\(p\)), and the dimension of non-sensitive features (\(d-p\)) grow in proportion (\(p/n\rightarrow\psi_{p}\) and \(d/n\rightarrow\psi_{d}\), for some constants \(0<\psi_{p}\leq\psi_{d}\)). Asymptotic analysis in this particular regime, characterized by a fixed sample size to feature size ratio, has recently garnered significant attention due to its relevance to the regime where modern neural networks operate. This analysis allows for the study of various intriguing phenomena related to both statistical properties (such as double-descent) and the tractability of optimizing the learning process in such networks [22, 8, 14], where the population analysis \(n/d\rightarrow\infty\) fails to capture. Let \(\mathcal{T}^{n}=\{(\bm{x}_{i},y_{i}),i\in[n]\}\) denote the (unanonymized) training set and \(\mathcal{T}^{n}_{L}\) be the set obtained after replacing the sensitive features with the look-alike representations of clusters. We denote by \(\widehat{\bm{\theta}}\) and \(\widehat{\bm{\theta}}_{L}\) the min-norm estimators fit to \(\mathcal{T}^{n}\) and \(\mathcal{T}^{n}_{L}\), respectively. Under this asymptotic setting:

* We provide a precise characterization of the generalization error of \(\widehat{\bm{\theta}}\) and \(\widehat{\bm{\theta}}_{L}\). Despite the randomness in data generating model, we show that in the high-dimensional asymptotic, the generalization errors of these estimators converge in probability to deterministic limits for which we provide explicit expressions.
* Our characterizations reveal several interesting facts about the generalization of the estimators: 1. For the min-norm estimator \(\widehat{\bm{\theta}}\) we observe significantly different behavior in the underparametrized regime (\(\psi_{d}\leq 1\)) than in the overparametrized regime (\(\psi_{d}>1\)). Note that in the underparametrized regime, the min-norm estimator coincides with the standard least squares estimator. For the look-alike estimator \(\widehat{\bm{\theta}}_{L}\) our analysis identifies the underparametrized regime as \(\psi_{d}-\psi_{p}\leq 1\) and the overparametrized regime as \(\psi_{d}-\psi_{p}>1\). 2. In the underparametrized regime, our analysis shows that, somewhat surprisingly, the generalization error (for both estimators) does not depend on the number or size of the clusters, nor the scaling of the cluster centers. 3. In the overparametrized regime, our analysis provides a precise understanding of the role of different factors, including the number of clusters, energy of cluster centers, and the alignment of the model with the constellation of cluster centers, on the generalization error.
* Using our characterizations, we discuss settings where the look-alike estimator \(\widehat{\bm{\theta}}_{L}\) has better generalization than its non-private counterpart \(\widehat{\bm{\theta}}\). A relevant quantity that shows up in our analysis is the ratio of the norm of the model component on the sensitive features over the noise in the response, which we refer to as signal-to-noise ratio (SNR). Using our theory, we show that if SNR is below a certain threshold, then look-alike estimator \(\widehat{\bm{\theta}}_{L}\) has lower generalization error than \(\widehat{\bm{\theta}}\). This demonstrates scenarios where anonymizing sensitive features via look-alike clustering does 'not' hinder model generalization. We give an interpretation for this result, after Theorem 5.1, by arguing that at low-SNR, look-alike clustering acts as a regularization and mitigates overfitting, which consequently improves model generalization.
* In our analysis in the previous parts, we assume that the learner has access to the exact underlying clustering structure on the users, to disentangle the clustering estimation error from look-alike modeling. However, in practice the learner needs to estimate the clustering structure from data. In Section 3.2, we combine our analysis with a perturbation analysis to extend our results to the case of imperfect clustering estimation.

Due to space constraint, we refer to the supplementary material for an overview of our proof techniques as well as proof of theorems and technical lemmas.

Model

We consider a linear regression setting, where we are given \(n\) i.i.d pairs \((\bm{x}_{i},y_{i})\), where the response \(y_{i}\) is given by

\[y_{i}=\langle\bm{x}_{i},\bm{\theta}_{0}\rangle+\varepsilon_{i}, \quad\varepsilon_{i}\sim\mathsf{N}(0,\sigma^{2}).\] (2.1)

We assume that there is a clustering structure on features \(\bm{x}_{i}\), \(i\in[n]\), independent from the responses. We model this structure via Gaussian-Mixture model.

**Gaussian-Mixture Model (GMM) on features.** Each example \(\bm{x}\) belong to cluster \(\ell\in[k]\), with probability \(\pi_{\ell}\). We let \(\bm{\pi}=[\pi,\pi_{2},\ldots,\pi_{k}]\in\mathbb{R}^{k}\) with \(\bm{\pi}\geq 0\) and \(\mathbf{1}^{\mathsf{T}}\bm{\pi}=1\). The cluster conditional distribution of an example \(\bm{x}\) in cluster \(\ell\) follows an isotropic Gaussian with mean \(\bm{\mu}_{\ell}\in\mathbb{R}^{d}\), namely

\[\bm{x}=\bm{\mu}_{\ell}+\bm{z},\quad\bm{z}\sim\mathsf{N}(\bm{0}, \tau^{2}\bm{I}).\] (2.2)

By scaling the model (2.1), without loss of generality we assume \(\tau=1\). Writing in the matrix form, we let

\[\bm{X}=\big{[}\bm{x}_{1}|\bm{x}_{2}|\ldots|\bm{x}_{n}\big{]}\in \mathbb{R}^{d\times n},\quad\bm{y}=(y_{1},\ldots,y_{n})\in\mathbb{R}^{n}, \quad\bm{M}=\big{[}\bm{\mu}_{1}|\bm{\mu}_{2}|\ldots|\bm{\mu}_{k}\big{]}\in \mathbb{R}^{d\times k}\,.\] (2.3)

It is also convenient to encode the cluster membership as one-hot encoded vectors \(\bm{\lambda}_{i}\in\mathbb{R}^{k}\), where \(\bm{\lambda}_{i}\) is one at entry \(\ell\) (with \(\ell\) being the cluster of example \(\bm{x}_{i}\)) and zero everywhere else. The GMM can then be written as

\[\bm{X}=\bm{M}\bm{\Lambda}+\bm{Z}\,,\] (2.4)

with \(\bm{Z}\in\mathbb{R}^{d\times n}\) is a Gaussian matrix with i.i.d \(\mathsf{N}(0,1)\) entries, and \(\bm{\Lambda}\in\mathbb{R}^{k\times n}\) is the matrix obtained by stacking vectors \(\bm{\lambda}_{i}\) as its column.

**Sensitive and non-sensitive features.** We assume that some of the features are sensitive for which we have some reservation to share with the learner and some non-sensitive features. Without loss of generality, we write it as \(\bm{x}=(\bm{x}_{\mathrm{s}},\bm{x}_{\mathrm{ns}})\), where \(\bm{x}_{\mathrm{s}}\in\mathbb{R}^{p}\) representing the sensitive features and \(\bm{x}_{\mathrm{ns}}\in\mathbb{R}^{d-p}\) representing the non-sensitive features. We also decompose the model \(\bm{\theta}_{0}\) (2.1) as \(\bm{\theta}_{0}=(\bm{\theta}_{0,\mathrm{s}},\bm{\theta}_{0,\mathrm{ns}})\) with \(\bm{\theta}_{0,\mathrm{s}}\in\mathbb{R}^{p}\) and \(\bm{\theta}_{0,\mathrm{ns}}\in\mathbb{R}^{d-p}\). Likewise, the cluster mean vector \(\bm{\mu}\) is decomposed as \(\bm{\mu}=(\bm{\mu}_{\mathrm{s}},\bm{\mu}_{\mathrm{ns}})\). The idea of look-alike clustering is to replace the sensitive features of an example \(\bm{x}_{\mathrm{s}}\) with the center of its cluster \(\bm{\mu}_{\mathrm{s}}\). This way, if each cluster is of size at least \(m\), then look-alike clustering offers \(m\)-anonymity.

Our goal in this paper is to precisely characterize the effect of look-alike clustering on model generalization. We focus on the high-dimensional asymptotic regime, where the number of training data \(n\), and features sizes \(d,p\) grow in proportion.

We formalize the high-dimensional asymptotic setting in the assumption below:

**Assumption 1**: _We assume that the number of clusters \(k\) is fixed and focus on the asymptotic regime where \(n,d,p\to\infty\) at a fixed ratio \(d/n\to\psi_{d}\) and \(p/n\to\psi_{p}\)._

To study the generalization of a model \(\bm{\theta}\) (performance on unseen data) via the _out-of-sample prediction risk_ defined as \(\mathrm{Risk}(\bm{\theta}):=\mathbb{E}\big{[}(y-\bm{x}^{\mathsf{T}}\bm{\theta} )^{2}\big{]}\), where \((y,\bm{x})\) is generated according to (2.1). Our next lemma characterizes the risk when the feature \(\bm{x}\) is drawn from GMM.

**Lemma 2.1**: _Under the linear response model (2.1) and a GMM for features \(\bm{x}\), the out-of-sample prediction risk of a model \(\bm{\theta}\) is given by_

\[\mathrm{Risk}(\bm{\theta})=\sigma^{2}+\left\|\bm{\theta}_{0}-\bm{ \theta}\right\|_{\ell_{2}}^{2}+\left(\bm{\theta}_{0}-\bm{\theta}\right)^{ \mathsf{T}}\bm{M}\text{diag}(\bm{\pi})\bm{M}^{\mathsf{T}}(\bm{\theta}_{0}- \bm{\theta})\,.\]

The proof of Lemma 2.1 is deferred to the supplementary.

## 3 Main results

Consider the minimum \(\ell_{2}\) norm (min-norm) least squares regression estimator of \(\bm{y}\) on \(\bm{X}\) defined by

\[\widehat{\bm{\theta}}=(\bm{X}\bm{X}^{\mathsf{T}})^{\dagger}\bm{X}\bm{y}\,,\] (3.1)where \((\bm{X}\bm{X}^{\mathsf{T}})^{\dagger}\) denotes the Moore-Penrose pseudoinverse of \(\bm{X}\bm{X}^{\mathsf{T}}\). This estimator can also be formulated as

\[\widehat{\bm{\theta}}\mathrel{\mathop{:}}=\arg\min\left\{\left\|\bm{\theta} \right\|_{\ell_{2}}:\,\bm{\theta}\text{ minimizes }\left\|\bm{y}-\bm{X}^{\mathsf{T}}\bm{\theta} \right\|_{\ell_{2}}\right\}\,.\]

We also define the "look-alike estimator" denoted by \(\widehat{\bm{\theta}}_{L}\), where the sensitive features are first anonymized via look-like modeling, and then the min-norm estimator is computed based on the resulting features. Specifically the sensitive feature \(\bm{x}_{\text{s}}\) of each sample is replaced by the center of its cluster. In our notation, writing \(\bm{X}^{\mathsf{T}}=[\bm{X}_{\text{s}}^{\mathsf{T}},\bm{X}_{\text{ns}}^{ \mathsf{T}}]\), we define \(\bm{X}_{L}^{\mathsf{T}}=[(\bm{M}_{\text{s}}\bm{A})^{\mathsf{T}},\bm{X}_{\text{ ns}}^{\mathsf{T}}]\) the features matrix obtained after look-alike modeling on the sensitive features. The look-alike estimator is then given by

\[\widehat{\bm{\theta}}_{L}=(\bm{X}_{L}\bm{X}_{L}^{\mathsf{T}})^{\dagger}\bm{X}_ {L}\bm{y}\,,\] (3.2)

Our main result is to provide a precise characterization of the risk of look-alike estimator \(\widehat{\bm{\theta}}_{L}\) as well as \(\widehat{\bm{\theta}}\) (non-look-alike) in the asymptotic regime, as described in Assumption 1. We then discuss regimes where look-alike clustering offers better generalization.

As our analysis shows there are two majorly different setting in the behavior of the look-alike estimator: \((i)\)\(\psi_{d}-\psi_{p}\leq 1\), i.e., the sample size \(n\) is asymptotically larger than \(d-p\), the number of non-sensitive features (referred to as _underparametrized_ asymptotics); \((ii)\)\(\psi_{d}-\psi_{p}\geq 1\), which is referred to as _overparametrized_ asymptotics.

Our first theorem is on the risk of look-alike estimator in the underparametrized setting. To present our result, we consider the following singular value decomposition for \(\bm{M}_{\text{s}}\), the matrix of cluster centers restricted to sensitive features:

\[\bm{M}_{\text{s}}=\bm{U}_{\text{s}}\bm{\Sigma}_{\text{s}}\bm{V}_{\text{s}}^{ \mathsf{T}},\quad\bm{U}_{\text{s}}\in\mathbb{R}^{p\times r},\bm{\Sigma}_{\text {s}}\in\mathbb{R}^{r\times r},\bm{V}_{\text{s}}\in\mathbb{R}^{k\times r}\,, \quad\text{with }r=\operatorname{rank}(\bm{M}_{\text{s}})\leq k.\]

**Theorem 3.1**: _(**Look-alike estimator, underparametrized regime**) Consider the linear response model (2.1), where the features are coming from the GMM (2.4). Also assume that \(\left\|\bm{\theta}_{0,\text{s}}\right\|=r_{\text{s}}\) and \(\left\|\bm{U}_{\text{s}}^{\mathsf{T}}\bm{\theta}_{0,\text{s}}\right\|=\sqrt{ \rho}r_{\text{s}}\), for all \(n,p\). Under Assumption 1 with \(\psi_{d}-\psi_{p}\leq 1\), the out-of-sample prediction risk of look-alike estimator \(\widehat{\bm{\theta}}_{L}\), defined by (3.2), converges in probability,_

\[\operatorname{Risk}(\widehat{\bm{\theta}}_{L})\xrightarrow{\mathcal{P}}\frac{ \sigma^{2}+r_{\text{s}}^{2}}{1-(\psi_{d}-\psi_{p})}-\rho r_{\text{s}}^{2}\,.\]

There are several intriguing observations about this result. In the underparametrized regime:

1. The risk depends on \(\bm{\theta}_{0,\text{s}}\) (model component on the sensitive features), only through the norms \(\left\|\bm{\theta}_{0,\text{s}}\right\|=r_{\text{s}}\) and \(\left\|\bm{U}_{\text{s}}^{\mathsf{T}}\bm{\theta}_{0,\text{s}}\right\|=\sqrt{ \rho}r_{\text{s}}\). Note that \(\left\|\bm{U}_{\text{s}}^{\mathsf{T}}\bm{\theta}_{0,\text{s}}\right\|\) measures the alignment of the model with the left singular vectors of the cluster centers.
2. The cluster structure on the non-sensitive features plays no role in the risk, nor does \(\bm{\theta}_{0,\text{ns}}\) the model component corresponding to the non-sensitive features.
3. The cluster prior probabilities \(\bm{\pi}\) does not impact the risk.

We next proceed to the overparametrized setting. For technical convenience, we make some simplifying assumption, however, we believe a similar derivation can be obtained for the general case, albeit with a more involved analysis.

**Assumption 2**: _Suppose that there is no cluster structure on the non-sensitive features (\(\bm{M}_{\text{ns}}=\bm{0}\)). Also, assume orthogonal, equal energy centers for the clusters on the sensitive features (\(\bm{M}_{\text{s}}=\mu\bm{U}_{\text{s}}\) with \(\bm{U}_{\text{s}}^{\mathsf{T}}\bm{U}_{\text{s}}=\bm{I}_{\text{s}}\))._

Our next theorem characterizes the risk of look-alike estimator in the underparametrized regime.

**Theorem 3.2**: _(**Look-alike estimator, overparametrized regime**) Consider the linear response model (2.1), where the features are coming from the GMM (2.4). Also assume that \(\left\|\bm{\theta}_{0,\text{s}}\right\|=r_{\text{s}}\), \(\left\|\bm{\theta}_{0,\text{ns}}\right\|=r_{\text{ns}}\) and \(\left\|\bm{U}_{\text{s}}^{\mathsf{T}}\bm{\theta}_{0,\text{s}}\right\|=\sqrt{ \rho}r_{\text{s}}\) for all \(n,p,d\). Under Assumption 1 with \(\psi_{d}-\psi_{p}\geq 1\), and Assumption 2, the out-of-sample prediction risk of look-alike estimator \(\widehat{\bm{\theta}}_{L}\), defined by (3.2), converges in probability,_

\[\operatorname{Risk}(\widehat{\bm{\theta}}_{L})\xrightarrow{\mathcal{P}}\sigma^{ 2}+(1-\rho)r_{\text{s}}^{2}+\gamma_{0}^{2}+\bm{\alpha}^{\mathsf{T}}(\bm{I}+ \mu^{2}\text{diag}(\bm{\pi}))\bm{\alpha}\,,\] (3.3)_where \(\bm{\pi}=(\pi_{1},\ldots,\pi_{k})\) encodes the cluster priors and \(\gamma_{0}\) and \(\bm{\alpha}\in\mathbb{R}^{k}\) are given by the following relations:_

\[\bm{\alpha} = \left(\bm{I}+\frac{\mu^{2}\text{diag}(\bm{\pi})}{\psi_{d}-\psi_{p} -1}\right)^{-1}\bm{U}_{\text{s}}^{\mathsf{T}}\bm{\theta}_{0,\text{s}}\,,\] \[\gamma_{0}^{2} = \frac{1}{\psi_{d}-\psi_{p}-1}\left(\sigma^{2}+r_{\text{s}}^{2}+ \mu^{2}\bm{\alpha}^{\mathsf{T}}\text{diag}(\bm{\pi})\bm{\alpha}\right)+\left(1- \frac{1}{\psi_{d}-\psi_{p}}\right)r_{\text{ns}}^{2}\,.\]

As discussed in the introduction, one of the focal interest in this work is to understand cases where look-alike modeling improves generalization. In Section 5 we discuss this by comparing the look-alike estimator \(\widehat{\bm{\theta}}_{L}\) with the min-norm estimator \(\widehat{\bm{\theta}}\), given by (3.1) which utilizes the full information on the sensitive features. In order to do that, we next derive a precise characterization of the risk of \(\widehat{\bm{\theta}}\) in the asymptotic setting.

**Theorem 3.3**: _(_**min-norm estimator with no look-alike clustering**_) Consider the linear response model (2.1), where the features are coming from the GMM (2.4). Under Assumption 1, the followings hold for the min-norm estimator \(\widehat{\bm{\theta}}\) given by (3.1):_

1. _(underparametrized setting) If_ \(\psi_{d}\leq 1\)_, we have_ \[\operatorname{Risk}(\widehat{\bm{\theta}})\overset{\mathcal{P}}{\to}\frac{ \sigma^{2}}{1-\psi_{d}}\,.\]
2. _(overparametrized setting) If_ \(\psi_{d}\geq 1\)_, under Assumption_ 2_, the prediction risk of_ \(\widehat{\bm{\theta}}\) _converges in probability_ \[\operatorname{Risk}(\widehat{\bm{\theta}})\overset{\mathcal{P}}{\to}\sigma^ {2}+\tilde{\gamma}_{0}^{2}+\tilde{\bm{\alpha}}^{\mathsf{T}}(\bm{I}+\mu^{2} \text{diag}(\bm{\pi}))\tilde{\bm{\alpha}}\,,\] (3.4) _where_ \(\tilde{\gamma}_{0}\) _and_ \(\tilde{\bm{\alpha}}\) _are given by the following relations:_ \[\tilde{\bm{\alpha}} = \left(\bm{I}+\frac{\bm{I}+\mu^{2}\text{diag}(\bm{\pi})}{\psi_{d} -1}\right)^{-1}\bm{U}_{\text{s}}^{\mathsf{T}}\bm{\theta}_{0,\text{s}}\,,\] \[\tilde{\gamma}_{0}^{2} = \frac{1}{\psi_{d}-1}\left(\sigma^{2}+\tilde{\bm{\alpha}}^{ \mathsf{T}}(\bm{I}+\mu^{2}\text{diag}(\bm{\pi}))\tilde{\bm{\alpha}}\right)+ \left(1-\frac{1}{\psi_{d}}\right)\left((1-\rho)r_{\text{s}}^{2}+r_{\text{ns} }^{2}\right).\]

**Example 3.1**: _(Balanced clusters) In the case of equal cluster prior (\(\pi_{1}=\ldots=\pi_{k}=1/k\)), the risk characterization (3.3) depends on \(\bm{\alpha}\) only through \(\left|\bm{\alpha}\right|_{\ell_{2}}\) (and likewise, the risk (3.4) depends on \(\tilde{\bm{\alpha}}\) only through its norm). This significantly simplifies these characterizations._

### Extension to imperfect clustering estimation

In our previous results, we assumed that the underlying cluster memberships of users are known to the learner, so we could concentrate our analysis on the impact of training using anonymous cluster centers. However, in practice, clusters should be estimated from the features and thus includes an estimation error. In our next result, we combine our previous result with a perturbation analysis to bound the risk of the look-alike estimator based on estimated clusters.

Recall matrix \(\bm{M}\in\mathbb{R}^{d\times k}\) from (2.3), whose columns are the cluster centers. Also, recall the matrix \(\bm{\Lambda}\in\mathbb{R}^{k\times n}\) whose columns are the one-hot encoding of the cluster memberships. We let \(\widehat{\bm{M}}\) and \(\widetilde{\bm{\Lambda}}\) indicate the estimated matrices, with the cluster estimation error rate \(\delta_{n}:=\frac{1}{\sqrt{n}}\|\bm{M}_{s}\bm{\Lambda}-\widetilde{\bm{M}}_{s} \widetilde{\bm{\Lambda}}\|_{2}\), where \(\|\cdot\|_{2}\) indicates spectral norm. Note that only the cluster estimation error with respect to the sensitive features matters because in the look-alike modeling only those features are anonymized (replaced by the cluster centers).

**Proposition 3.4**: _Let \(\widetilde{\bm{X}}^{\mathsf{T}}:=[(\widetilde{\bm{M}}_{s}\widetilde{\bm{ \Lambda}})^{\mathsf{T}},\bm{X}_{\text{ns}}^{\mathsf{T}}]\) be the feature matrix after replacing the sensitive features with the estimated cluster centers of users. We also let \(\widetilde{\bm{\theta}}_{L}=(\widetilde{\bm{X}}_{L}\widetilde{\bm{X}}_{L}^{ \mathsf{T}})^{\dagger}\widetilde{\bm{X}}_{L}\bm{y}\) be the look-alike estimator based on \(\widetilde{\bm{X}}_{L}\). Note that \(\widetilde{\bm{\theta}}_{L}\) is the counterpart of \(\widetilde{\bm{\theta}}_{L}\) given by (3.2). Define the cluster estimation error rate \(\delta_{n}:=\frac{1}{\sqrt{n}}\|\widetilde{\bm{M}}_{s}\bm{\Lambda}-\widetilde{ \bm{M}}_{s}\widetilde{\bm{\Lambda}}\|_{2}\), and suppose that either of the following conditions hold:_* _(i)_ \(\psi_{d}-\psi_{p}<0.5\) _and_ \(\delta<\sqrt{1-\left(\psi_{d}-\psi_{p}\right)}-\sqrt{\psi_{d}-\psi_{p}}\)_._
* _(ii)_ \(\psi_{d}-\psi_{p}>2\) _and_ \(\delta<\sqrt{\psi_{d}-\psi_{p}-1}-1\)_._

_Then,_

\[\mathrm{Risk}(\widetilde{\bm{\theta}}_{L})\leq\mathrm{Risk}(\widehat{\bm{ \theta}}_{L})+C\delta\,,\]

_for some constant \(C\) depending on the problem parameters._

## 4 Numerical experiments

In this section, we validate our theory with numerical experiments. We consider GMM with \(k\) clusters, where the centers of clusters are given by \(\mu\bm{u}_{\ell}\), for \(\ell\in\left[k\right]\), where \(\bm{u}_{\ell}\in\mathbb{R}^{d}\) are of unit \(\ell_{2}\)-norm. Also the vectors \(\bm{u}_{\ell}\) are non-zero only on the first \(p\) entries, and their restriction to these entries form a random orthogonal constellation. Therefore, defining \(\bm{U}=\left[\bm{u}_{1},\ldots,\bm{u}_{k}\right]\), we have \(\bm{U}=\left[\begin{array}{c}\bm{U}_{\mathrm{s}}\\ \bm{0}\end{array}\right]\), with \(\bm{U}_{\mathrm{s}}^{\mathsf{T}}\bm{U}_{\mathrm{s}}=\bm{I}_{k}\). In this setting there is no cluster structure on the non-sensitive features and the cluster centers on the sensitive features are orthogonal and of same norm.

Recall the decomposition of the model \(\bm{\theta}_{0}=(\bm{\theta}_{0,\mathrm{s}},\bm{\theta}_{0,\mathrm{ns}})\), with \(\bm{\theta}_{0}\) the true underlying model (2.1) and \(\bm{\theta}_{0,\mathrm{s}}\), \(\bm{\theta}_{0,\mathrm{ns}}\) the components corresponding to sensitive and non-sensitive features. We generate \(\bm{\theta}_{0,\mathrm{ns}}\in\mathbb{R}^{d-p}\) to have i.i.d standard normal entries and then normalize it to have \(\left|\bm{\theta}_{0,\mathrm{ns}}\right|_{\ell_{2}}=r_{\mathrm{ns}}\). For \(\bm{\theta}_{0,\mathrm{s}}\), we generate \(\bm{Z}_{1},\bm{Z}_{2}\sim\mathsf{N}(\bm{\theta}_{p},\bm{I}_{p})\), independently and let

\[\bm{\theta}_{0,\mathrm{s}}=r_{\mathrm{s}}\sqrt{\rho}\ \frac{\mathsf{P}_{\bm{U}_{ \mathrm{s}}}\bm{z}_{1}}{\left|\mathsf{P}_{\bm{U}_{\mathrm{s}}}\bm{z}_{1} \right|_{\ell_{2}}}+r_{\mathrm{s}}\sqrt{1-\rho}\ \frac{(\bm{I}-\mathsf{P}_{\bm{U}_{ \mathrm{s}}})\bm{z}_{2}}{\left|(\bm{I}-\mathsf{P}_{\bm{U}_{\mathrm{s}}})\bm{z}_ {2}\right|_{\ell_{2}}}\,,\]

where \(\mathsf{P}_{\bm{U}_{\mathrm{s}}}:=\bm{U}_{\mathrm{s}}\bm{U}_{\mathrm{s}}^{ \mathsf{T}}\) is the projection onto column space of \(\bm{U}_{\mathrm{s}}\). Therefore, \(\left|\bm{\theta}_{0,\mathrm{s}}\right|_{\ell_{2}}=r_{\mathrm{s}}\) and \(\left\|\bm{U}_{\mathrm{s}}^{\mathsf{T}}\bm{\theta}_{0,\mathrm{s}}\right\|_{ \ell_{2}}=\sqrt{\rho}r_{\mathrm{s}}\). Note that \(\rho\) quantifies the alignment of the model with the cluster centers, confined to the sensitive features.)

We will vary the values of \(r_{\mathrm{s}}\) and \(r_{\mathrm{ns}}\) in our experiments. We also consider the case of balanced clusters, so the cluster prior probabilities are all equal, \(\pi_{\ell}=1/k\), for \(\ell\in\left[k\right]\). We set the number of

Figure 2: Validation of theoretical characterizations of the risks. Curves correspond to (asymptotic) analytical predictions, and dots to numerical simulations (averaged over 20 realizations). In all the plots, \(d=500\), \(p=200\), \(\mu=5\), \(k=3\), \(\rho=0.3\). Left panel corresponds to the risk of \(\widehat{\bm{\theta}}_{L}\) and right panel corresponds to the risk of \(\widehat{\bm{\theta}}\).

cluster \(k=3\), dimension of sensitive features \(p=200\) and the dimension of entire features vector \(d=500\). We also set \(\mu=5\) and \(\rho=0.3\). In our experiments, we vary the sample size \(n\) and plot the risk of \(\widehat{\bm{\theta}}_{L}\) and \(\widehat{\bm{\theta}}\) versus \(\psi_{d}-\psi_{p}=(d-p)/n\). We consider different settings, where we vary \(r_{\text{s}}\), \(r_{\text{ns}}\) and \(\sigma\) (noise variance in model (2.1)). In Figure 2, we report the results. Curves correspond to our asymptotic theory and dots to the numerical simulations. (Each dot is obtained by averaging over 20 realizations of that configuration.) As we observe, in all scenarios our theoretical predictions are a perfect match to the empirical performance.

## 5 When does look-alike clustering improve generalization?

In Section 3, we provided a precise characterization of the risk of look-alike estimator \(\widehat{\bm{\theta}}_{L}\) and its counterpart, the min-norm estimator \(\widehat{\bm{\theta}}\) which utilizes the full information on the sensitive features. By virtue of these characterizations, we would like to understand regimes where the look-alike clustering helps with the model generalization, and the role of different problem parameters in achieving this improvement. Notably, since the look-alike estimator offers \(m\)-anonymity on the sensitive features (with \(m\) the minimum size of clusters), our discussion here points out instances where data anonymization and model generalization are not in-conflict.

We define the gain of look-alike estimator as \(\Delta:=\mathrm{Risk}(\widehat{\bm{\theta}})/\mathrm{Risk}(\widehat{\bm{ \theta}}_{L})\) to indicate the gain obtained in generalization via look-alike clustering. For ease in presentation, we focus on the case of balanced clusters (equal priors \(\pi_{1}=\ldots=\pi_{k}=1/k\)), and consider three cases:

\(\bullet\)**Case 1 (\(\psi_{d}\leq 1\)):** In this case, both \(\widehat{\bm{\theta}}_{L}\) and \(\widehat{\bm{\theta}}\) are in the underparametrized regime and Theorems 3.1 and 3.3 (a) provide simple closed-form characterization of the risks of \(\widehat{\bm{\theta}}_{L}\) and \(\widehat{\bm{\theta}}\), by which we obtain

\[\Delta\stackrel{{\mathcal{P}}}{{\to}}\frac{(1-\psi_{d})^{-1}}{(1 +r_{\text{s}}^{2}/\sigma^{2})(1-\psi_{d}+\psi_{p})^{-1}-\rho r_{\text{s}}^{2}/ \sigma^{2}}\,.\]

Define the signal-to-noise ratio \(\mathrm{SNR}=r_{\text{s}}/\sigma\). Since \(\rho\leq 1\), it is easy to see that \(\Delta\) is decreasing in the SNR. In particular, as SNR\(\to 0\), we have \(\Delta\to(1-\psi_{d}+\psi_{p})/(1-\psi_{d})>1\), which means the look-alike estimator \(\widehat{\bm{\theta}}_{L}\) achieves lower risk compared to \(\widehat{\bm{\theta}}\). In Figure 2(a) we plot \(\log(\Delta)\) versus SNR, for several values of \(\psi_{p}\). Here we set \(\psi_{d}=0.9\) and \(\rho=0.3\). As we observe in low SNR, the look-alike estimator has lower risk. Specifically, for each curve there is a threshold for the SNR, below which \(\log(\Delta)>0\). Furthermore, this threshold increases with \(\psi_{p}\), covering a larger range of SNR where \(\widehat{\bm{\theta}}_{L}\) has better generalization.

In Figure 2(b) we report similar curves, where this time \(\psi_{p}=0.5\) and we consider several values of \(\rho\). As we observe, at fixed SNR the gain \(\Delta\) is increasing in \(\rho\). This is expected since \(\rho\) measures the alignment of the underlying model \(\bm{\theta}_{0}\) with the (left eigenvectors of) cluster centers and so higher \(\rho\) is to advantage of the look-alike estimator which uses the cluster centers instead of individuals' sensitive features.

\(\bullet\) **Case 2 (\(\psi_{d}\geq 1,\psi_{d}-\psi_{p}\leq 1\)):** In this case, the look-alike estimator \(\widetilde{\bm{\theta}}_{L}\) is in the underparametrized regime, while the min-norm \(\widetilde{\bm{\theta}}\) is in the overparametrized regime. The following theorem uses the characterizations in Theorem 3.1 and and 3.3 (b), and shows that in the low SNR\(=r_{\rm s}/\sigma\), the look-alike estimator \(\widetilde{\bm{\theta}}_{L}\) has a positive gain. It further shows the monotonicity of the gain with respect to different problem parameters.

**Theorem 5.1**: _Suppose that \(\psi_{d}\geq 1\) and \(\psi_{d}-\psi_{p}\leq 1\), and consider the case of equal cluster priors. The gain \(\Delta\) is increasing in \(r_{\rm ns}\) and \(\rho\), and is decreasing in \(\mu^{2}/k\). Furthermore, under the following condition_

\[{\rm SNR}^{2}:=\left(\frac{r_{\rm s}}{\sigma}\right)^{2}\leq\frac{1+\left( \psi_{d}-1\right)^{-1}-\left(1-\psi_{d}+\psi_{p}\right)^{-1}}{\left(1-\psi_{d }+\psi_{p}\right)^{-1}+\psi_{d}^{-1}-1}\,,\] (5.1)

_we have \(\Delta\geq 1\), for all values of other parameters (\(\mu,k,\rho,r_{\rm ns}\))._

**An interpretation based on regularization:** We next provide an argument to build further insight on the result of Theorem 5.1. Recall the data model (2.1), where substituting from (2.2) and decomposing over sensitive and non-sensitive features we arrive at

\[y =\langle\bm{x}_{\rm s},\bm{\theta}_{\rm s}\rangle+\langle\bm{x}_{ \rm ns},\bm{\theta}_{\rm ns}\rangle+\varepsilon\] \[=\langle\bm{\mu}_{\rm s},\bm{\theta}_{\rm s}\rangle+\langle\bm{z} _{\rm s},\bm{\theta}_{\rm s}\rangle+\langle\bm{x}_{\rm ns},\bm{\theta}_{\rm ns }\rangle+\varepsilon\,.\]

Note that \(\langle\bm{z}_{\rm s},\bm{\theta}_{\rm s}\rangle\sim\mathsf{N}(0,\lfloor\bm{ \theta}_{\rm s}\rVert^{2})\). At low SNR, this term is of order of the noise term \(\varepsilon\sim\mathsf{N}(0,\sigma^{2})\). Recall that the look-alike clustering approach replaces the sensitive feature \(\bm{x}_{\rm s}\) by the cluster center \(\bm{\mu}_{\rm s}\), and therefore drops the term \(\langle\bm{z}_{\rm s},\bm{\theta}_{\rm s}\rangle\) from the model during the training process. In other words, look-alike clustering acts as a form of regularization which prevents overfitting to the noisy component \(\langle\bm{z}_{\rm s},\bm{\theta}_{\rm s}\rangle\), and this will help with the model generalization, together with anonymizing the sensitive features.

In Figure 3(a) we plot \(\log(\Delta)\) versus \(\mu\) for several values of \(r_{\rm ns}\). Here, \(\psi_{d}=2\), \(\psi_{p}=1.7\), \(\sigma=1\), \(r_{\rm s}=0.5\) and so condition (5.1) holds. As we observe \(\log(\Delta)\) is positive, decreasing in \(\mu\) and also at any fixed \(\mu\), it is increasing in \(r_{\rm ns}\), all of which are consistent with the Theorem 5.1. In Figure 3(b), we plot similar curves where this time \(r_{\rm ns}=0.2\) and we try several values of \(\rho\). As we see the look-alike estimator has larger gain \(\Delta\) at larger values of \(\rho\).

\(\bullet\) **Case 3 (\(\psi_{d}-\psi_{p}\geq 1\)):** In this case, both \(\widetilde{\bm{\theta}}_{L}\) and \(\widetilde{\bm{\theta}}\) are in the overparametrized regime. Let us first focus on \(r_{\rm ns}\), the energy of the model on the non-sensitive features. Invoking the equations (3.3) and (3.4) and hiding the terms that do not depend on \(r_{\rm ns}\) in constants \(C_{1}\), \(C_{2}\) we arrive at

\[\Delta\stackrel{{(\mathcal{P})}}{{\to}}\frac{C_{1}+(1-\frac{1}{ \psi_{d}})r_{\rm ns}^{2}}{C_{2}+(1-\frac{1}{\psi_{d}-\psi_{p}})r_{\rm ns}^{2}}\,.\]

Therefore, \(\lim_{r_{\rm ns}\to\infty}\Delta=(1-\psi_{d}^{-1})/(1-(\psi_{d}-\psi_{p})^{-1} )>1\), indicating a gain for the look-alike estimator over \(\widetilde{\bm{\theta}}\). In Figure 4(a), we plot \(\log(\Delta)\) versus \(r_{\rm ns}\) for several values of \(\psi_{p}\). As we observe, when \(r_{\rm ns}\) is large enough we always have a gain, which is increasing in \(\psi_{p}\).

We next consider the effect of SNR = \(r_{\mathrm{s}}/\sigma\). In Figure 4(b) we \(\log(\Delta)\) versus SNR, for several values of \(\psi_{p}\). Similar to the underparametrized regime, we observe that in low SNR, the look-alike estimator has better generalization \((\log(\Delta)>0)\).

## 6 Beyond linear models

In previous section, we used our theory for linear models to show that at low SNR, look-alike modeling improves model generalization. We also provided an insight for this phenomenon by arguing that look-alike modeling acts as a form of regularization and avoids over-fitting at low SNR regime. In this section we show empirically that this phenomenon also extends to non-linear models.

Consider the following data generative model:

\[y\sim\mathrm{Binomial}(N,p_{\bm{x}}),\quad p_{\bm{x}}=\frac{1}{1+\exp(-(\bm{x },\bm{\theta}_{0})+\varepsilon)}\,,\]

where \(\varepsilon\sim\mathsf{N}(0,\sigma^{2})\). We construct the model \(\bm{\theta}_{0}=(\bm{\theta}_{0,\mathrm{s}},\bm{\theta}_{0,\mathrm{ns}})\) similar to the setup in Section 4. We set \(n=200\), \(d=180\), \(k=3\), \(\mu=5\), \(\sigma=1\), \(\rho=0.3\), \(r_{\mathrm{ns}}=2\) and \(N=1000\) (number of trials in Binomial distribution). We vary SNR by changing \(r_{\mathrm{s}}\) in the set \(\{0.1,0.3,\ldots,1.9\}\). The estimators \(\widehat{\bm{\theta}}\) and \(\widehat{\bm{\theta}}_{L}\) are obtained by fitting a GLM with logit link function and binomial distribution. We compute the risks of \(\widehat{\bm{\theta}}\) and \(\widehat{\bm{\theta}}_{L}\) by averaging over a test set of size \(50K\). In Figure 6, we plot the gain \(\log(\Delta)\) versus \(r_{\mathrm{s}}\) where each data point is by averaging over \(50\) different realizations of data. As we observe at low SNR, \(\log(\Delta)>0\) indicating that the look-alike estimator \(\widehat{\bm{\theta}}_{L}\) obtains a lower risk than the min-norm estimator.

Figure 6: Behavior of gain \(\Delta\) versus SNR for the nonlinear model described in Section 6. At small SNR, we observe a positive gain (lower risk of look-alike estimator \(\widehat{\bm{\theta}}_{L}\) compared to \(\widehat{\bm{\theta}}\)).

## Acknowledgement

This work is supported in part by the NSF CAREER Award DMS-1844481 and the NSF Award DMS-2311024.

## References

* [1] F. Abu-Khzam, C. Bazgan, K. Casel, and H. Fernau. Building clusters with lower-bounded sizes. In _27th International Symposium on Algorithms and Computation (ISAAC 2016)_. Schloss Dagstuhl-Leibniz-Zentrum fuer Informatik, 2016.
* [2] G. Aggarwal, T. Feder, K. Kenthapadi, R. Motwani, R. Panigrahy, D. Thomas, and A. Zhu. Approximation algorithms for k-anonymity. _Journal of Privacy Technology_, 2005112001:400, 2005.
* [3] G. Aggarwal, R. Panigrahy, T. Feder, D. Thomas, K. Kenthapadi, S. Khuller, and A. Zhu. Achieving anonymity via clustering. _ACM Transactions on Algorithms (TALG)_, 6(3):1-19, 2010.
* [4] P. Bartlett, Y. Freund, W. S. Lee, and R. E. Schapire. Boosting the margin: A new explanation for the effectiveness of voting methods. _The annals of statistics_, 26(5):1651-1686, 1998.
* [5] M. Belkin, S. Ma, and S. Mandal. To understand deep learning we need to understand kernel learning. In _International Conference on Machine Learning_, pages 541-549. PMLR, 2018.
* [6] G. Brown, M. Bun, V. Feldman, A. Smith, and K. Talwar. When is memorization of irrelevant training data necessary for high-accuracy learning? In _Proceedings of the 53rd Annual ACM SIGACT Symposium on Theory of Computing_, pages 123-132, 2021.
* [7] J.-W. Byun, A. Kamra, E. Bertino, and N. Li. Efficient k-anonymization using clustering techniques. In _Advances in Databases: Concepts, Systems and Applications: 12th International Conference on Database Systems for Advanced Applications, DASFAA 2007, Bangok, Thailand, April 9-12, 2007. Proceedings 12_, pages 188-200. Springer, 2007.
* [8] Z. Deng, A. Kammoun, and C. Thrampoulidis. A model of double descent for high-dimensional binary linear classification. _Information and Inference: A Journal of the IMA_, 11(2):435-495, 2022.
* [9] H. Ding, L. Hu, L. Huang, and J. Li. Capacitated center problems with two-sided bounds and outliers. In _Algorithms and Data Structures: 15th International Symposium, WADS 2017, St. John's, NL, Canada, July 31-August 2, 2017, Proceedings 15_, pages 325-336. Springer, 2017.
* [10] A. Epasto, M. Mahdian, V. Mirrokni, and P. Zhong. Massively parallel and dynamic algorithms for minimum size clustering. In _Proceedings of the 2022 Annual ACM-SIAM Symposium on Discrete Algorithms (SODA)_, pages 1613-1660. SIAM, 2022.
* [11] V. Feldman. Does learning require memorization? a short tale about a long tail. In _Proceedings of the 52nd Annual ACM SIGACT Symposium on Theory of Computing_, pages 954-959, 2020.
* [12] V. Feldman and C. Zhang. What neural networks memorize and why: Discovering the long tail via influence estimation. _Advances in Neural Information Processing Systems_, 33:2881-2891, 2020.
* [13] Y. Gordon. On milman's inequality and random subspaces which escape through a mesh in \(r^{n}\). In _Geometric aspects of functional analysis_, pages 84-106. Springer, 1988.
* [14] H. Hassani and A. Javanmard. The curse of overparametrization in adversarial training: Precise analysis of robust generalization for random features regression. _arXiv preprint arXiv:2201.05149_, 2022.
* [15] A. Javanmard and M. Soltanolkotabi. Precise statistical analysis of classification accuracies for adversarial training. _The Annals of Statistics_, 50(4):2127-2156, 2022.

* [16] A. Javanmard, M. Soltanolkotabi, and H. Hassani. Precise tradeoffs in adversarial training for linear regression. In _Conference on Learning Theory_, pages 2034-2078. PMLR, 2020.
* [17] T. Liang and A. Rakhlin. Just interpolate: Kernel "ridgeless" regression can generalize. _The Annals of Statistics_, 48(3):1329-1347, 2020.
* [18] Q. Ma, E. Wagh, J. Wen, Z. Xia, R. Ormandi, and D. Chen. Score look-alike audiences. In _2016 IEEE 16th International Conference on Data Mining Workshops (ICDMW)_, pages 647-654. IEEE, 2016.
* [19] Q. Ma, M. Wen, Z. Xia, and D. Chen. A sub-linear, massive-scale look-alike audience extension system a massive-scale look-alike audience extension. In _Workshop on Big Data, Streams and Heterogeneous Source Mining: Algorithms, Systems, Programming Models and Applications_, pages 51-67. PMLR, 2016.
* [20] M. Malekzadeh, A. Borovykh, and D. Gunduz. Honest-but-curious nets: Sensitive attributes of private inputs can be secretly coded into the classifiers' outputs. In _Proceedings of the 2021 ACM SIGSAC Conference on Computer and Communications Security_, pages 825-844, 2021.
* [21] A. Mangalampalli, A. Ratnaparkhi, A. O. Hatch, A. Bagherjeiran, R. Parekh, and V. Pudi. A feature-pair-based associative classification approach to look-alike modeling for conversion-oriented user-targeting in tail campaigns. In _Proceedings of the 20th international conference companion on World wide web_, pages 85-86, 2011.
* [22] S. Mei and A. Montanari. The generalization error of random features regression: Precise asymptotics and the double descent curve. _Communications on Pure and Applied Mathematics_, 75(4):667-766, 2022.
* [23] H. Park and K. Shim. Approximate algorithms for k-anonymity. In _Proceedings of the 2007 ACM SIGMOD international conference on Management of data_, pages 67-78, 2007.
* [24] A. Sarker, W.-K. Sung, and M. S. Rahman. A linear time algorithm for the r-gathering problem on the line. _Theoretical Computer Science_, 866:96-106, 2021.
* [25] R. E. Schapire. Explaining adaboost. In _Empirical inference_, pages 37-52. Springer, 2013.
* [26] J. Shen, S. C. Geyik, and A. Dasdan. Effective audience extension in online advertising. In _Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining_, pages 2099-2108, 2015.
* [27] C. Song and V. Shmatikov. Overlearning reveals sensitive attributes. _arXiv preprint arXiv:1905.11742_, 2019.
* [28] G. W. Stewart. On the perturbation of pseudo-inverses, projections and linear least squares problems. _SIAM review_, 19(4):634-662, 1977.
* [29] C. Thrampoulidis, E. Abbasi, and B. Hassibi. Precise error analysis of regularized \(m\)-estimators in high dimensions. _IEEE Transactions on Information Theory_, 64(8):5592-5628, 2018.
* [30] C. Thrampoulidis, S. Oymak, and B. Hassibi. Regularized linear regression: A precise analysis of the estimation error. In _Conference on Learning Theory_, pages 1683-1709, 2015.
* [31] S. Tu. On the smallest singular value of non-centered gaussian designs, 2020.
* [32] A. J. Wyner, M. Olson, J. Bleich, and D. Mease. Explaining the success of adaboost and random forests as interpolating classifiers. _The Journal of Machine Learning Research_, 18(1):1558-1590, 2017.
* [33] C. Zhang, S. Bengio, M. Hardt, M. C. Mozer, and Y. Singer. Identity crisis: Memorization and generalization under extreme overparameterization. In _International Conference on Learning Representations_, 2020.
* [34] C. Zhang, S. Bengio, M. Hardt, B. Recht, and O. Vinyals. Understanding deep learning (still) requires rethinking generalization. _Communications of the ACM_, 64(3):107-115, 2021.

**Supplementary Material**

In this supplementary, we first provide an overview of our proof techniques in Appendix A and then in Appendix B provide the proofs of theorems and technical lemmas stated in the main paper.

## Appendix A Overview of proof techniques

Our analysis of the generalization error is based on an extension of Gordon's Gaussian process inequality [13], called Convex-Gaussian Minimax Theorem (CGMT) [30]. Here, we outline the general steps of this framework and refer to the supplementary for complete details and derivations.

Consider the following two Gaussian processes:

\[\bm{X}_{\bm{u},\bm{v}} :=\bm{u}^{\mathsf{T}}\bm{G}\bm{v}+\psi(\bm{u},\bm{v})\,,\] \[\bm{Y}_{\bm{u},\bm{v}} :=\left\|\bm{u}\right\|_{\ell_{2}}\bm{g}^{\mathsf{T}}\bm{v}+\left\| \bm{v}\right\|_{\ell_{2}}\bm{h}^{\mathsf{T}}\bm{u}+\psi(\bm{u},\bm{v})\,,\]

where \(\bm{G}\in\mathbb{R}^{n\times d}\), \(\bm{g}\in\mathbb{R}^{n}\) and \(\bm{h}\in\mathbb{R}^{d}\), all have i.i.d standard normal entries. Further, \(\psi:\mathbb{R}^{d}\times\mathbb{R}^{n}\rightarrow\mathbb{R}\) is a continuous function, which is convex in the first argument and concave in the second argument.

Given the above two processes, consider the following min-max optimization problems, which are respectively referred to as the _Primary Optimization (PO)_ and the _Auxiliary Optimization (AO)_ problems:

\[\Phi_{\mathrm{PO}}(\bm{G}) := \min_{\bm{u}\in\bm{S}_{\bm{u}}}\max_{\bm{v}\in\bm{S}_{\bm{v}}}\bm {X}_{\bm{u},\bm{v}}\,,\] (A.1) \[\Phi_{\mathrm{AO}}(\bm{g},\bm{h}) := \min_{\bm{u}\in\bm{S}_{\bm{u}}}\max_{\bm{v}\in\bm{S}_{\bm{v}}}\bm {Y}_{\bm{u},\bm{v}}\,.\] (A.2)

The main result of CGMT is to connect the above two random optimization problems. As shown in [30](Theorem 3), if \(\bm{S}_{\bm{u}}\) and \(\bm{S}_{\bm{v}}\) are compact and convex then, for any \(\lambda\in\mathbb{R}\) and \(t>0\),

\[\mathbb{P}\left(\left|\Phi_{\mathrm{PO}}(\bm{G})-\lambda\right|>t\right)\leq 2 \mathbb{P}\left(\left|\Phi_{\mathrm{AO}}(\bm{g},\bm{h})-\lambda\right|>t\right)\,.\]

An immediate corollary of this result (by choosing \(\lambda=\mathbb{E}\left[\Phi_{\mathrm{AO}}(\bm{g},\bm{h})\right]\)) is that if the optimal cost of AO problem concentrates in probability, then the optimal cost of the corresponding PO problem also concentrates, in probability, around the same value. In addition, as shown in part (iii) of [30](Theorem 3), concentration of the optimal solution of the AO problem implies concentration of the optimal solution of the PO around the same value. Therefore, the two optimization are intimately connected and by analyzing the AO problem, which is substantially simpler, one can derive corresponding properties of the PO problem.

The CGMT framework has been used to infer statistical properties of estimators in certain high-dimensional asymptotic regime. The intermediate steps in the CGMT framework can be summarized as follows: First form an PO problem in the form of (A.1) and construct the corresponding AO problem. Second, derive the point-wise limit of the AO objective in terms of a convex-concave optimization problem, over only few scalar variables. This step is called'scalarization'. Next, it is possible to establish uniform convergence of the scalarized AO to the (deterministic) min-max optimization problem using convexity conditions. Finally, by analyzing the latter deterministic problem, one can derive the desired asymptotic characterizations.

Of course implementing the above steps involved problem-specific intricate calculations. Our proofs of Theorems 3.1, 3.2, 3.3 in the supplementary follow this general strategy.

Proof of theorems and technical lemmas

### Proof of Lemma 2.1

By substituting for \(y\) from (2.1) in the definition of risk we obtain

\[\mathrm{Risk}(\bm{\theta}) =\mathbb{E}[(y-\bm{x}^{\mathsf{T}}\bm{\theta})^{2}]\] \[=\mathbb{E}[(\bm{x}^{\mathsf{T}}(\bm{\theta}_{0}-\bm{\theta}))^{2} ]+\mathbb{E}[\bm{\varepsilon}^{2}]\] \[\overset{(a)}{=}\sum_{\ell\in[k]}\pi_{\ell}\,\mathbb{E}[((\bm{ \mu}_{\ell}+\bm{z})^{\mathsf{T}}(\bm{\theta}_{0}-\bm{\theta}))^{2}]+\mathbb{E} [\bm{\varepsilon}^{2}]\] \[=\sum_{\ell\in[k]}\pi_{\ell}\,\mathbb{E}[(\bm{\mu}_{\ell}^{ \mathsf{T}}(\bm{\theta}_{0}-\bm{\theta}))^{2}]+\sum_{\ell\in[k]}\pi_{\ell}\, \lVert\bm{\theta}-\bm{\theta}_{0}\rVert_{\ell_{2}}^{2}+\sigma^{2}\] \[\overset{(b)}{=}(\bm{\theta}-\bm{\theta}_{0})^{\mathsf{T}}\bm{M }\mathrm{diag}(\bm{\pi})\bm{M}^{\mathsf{T}}(\bm{\theta}_{0}-\bm{\theta})+ \lVert\bm{\theta}_{0}-\bm{\theta}\rVert_{\ell_{2}}+\sigma^{2}\,,\]

where \((a)\) follows from the Gaussian-Mixture model (2.2) and \((b)\) holds since \(\sum_{\ell\in[k]}\pi_{\ell}=1\).

### Proof of Theorem 3.1 and Theorem 3.2

Recall that the look-alike estimator is defined as the min-norm estimator over the feature matrix \(X_{L}\), where the look-alike representations are used instead of individual sensitive features; see (3.2).

To analyze risk of \(\widehat{\bm{\theta}}_{L}\), we consider the ridge regression estimator given by

\[\widehat{\bm{\theta}}_{\lambda}=\arg\min_{\bm{\theta}}\frac{1}{2n}\left\lVert \bm{y}-\bm{X}_{L}^{\mathsf{T}}\bm{\theta}\right\rVert_{\ell_{2}}^{2}+\lambda \left\lVert\bm{\theta}\right\rVert_{\ell_{2}}^{2}\,.\]

The minimum-norm estimator is given by \(\widehat{\bm{\theta}}_{L}=\lim_{\lambda\to 0^{+}}\widehat{\bm{\theta}}_{\lambda}\).

We follow the CGMT framework explained in Section A. Recall that

\[\bm{X}_{L}=\begin{bmatrix}\bm{M}_{\mathrm{s}}\bm{\Lambda}\\ \bm{M}_{\mathrm{ns}}\bm{\Lambda}+\bm{Z}_{\mathrm{ns}}\end{bmatrix}\,,\]

and therefore by substituting for \(\bm{y}\), \(\bm{X}\), and \(\bm{X}_{L}\), we get

\[\frac{1}{2n}\left\lVert\bm{y}-\bm{X}_{L}^{\mathsf{T}}\bm{\theta }\right\rVert_{\ell_{2}}^{2} =\frac{1}{2n}\left\lVert\bm{\varepsilon}+\bm{X}^{\mathsf{T}}\bm{ \theta}_{0}-\bm{X}_{L}^{\mathsf{T}}\bm{\theta}\right\rVert_{\ell_{2}}^{2}\] \[=\frac{1}{2n}\left\lVert\bm{\varepsilon}+\bm{\Lambda}^{\mathsf{ T}}\bm{M}_{\mathrm{s}}^{\mathsf{T}}(\bm{\theta}_{0,\mathrm{s}}-\bm{\theta}_{ \mathrm{s}})+\bm{Z}_{\mathrm{s}}^{\mathsf{T}}\bm{\theta}_{0,\mathrm{s}}+(\bm{ \Lambda}^{\mathsf{T}}\bm{M}_{\mathrm{ns}}^{\mathsf{T}}+\bm{Z}_{\mathrm{ns}}^{ \mathsf{T}})(\bm{\theta}_{0,\mathrm{ns}}-\bm{\theta}_{\mathrm{ns}})\right\rVert _{\ell_{2}}^{2}\,.\]

We define the primary optimization loss as follows:

\[\mathcal{L}_{PO}(\bm{\theta}_{\mathrm{s}},\bm{\theta}_{\mathrm{ns}}) :=\frac{1}{2n}\left\lVert\bm{\varepsilon}+\bm{\Lambda}^{\mathsf{ T}}\bm{M}_{\mathrm{s}}^{\mathsf{T}}(\bm{\theta}_{0,\mathrm{s}}-\bm{\theta}_{ \mathrm{s}})+\bm{Z}_{\mathrm{s}}^{\mathsf{T}}\bm{\theta}_{0,\mathrm{s}}+(\bm{ \Lambda}^{\mathsf{T}}\bm{M}_{\mathrm{ns}}^{\mathsf{T}}+\bm{Z}_{\mathrm{ns}}^{ \mathsf{T}})(\bm{\theta}_{0,\mathrm{ns}}-\bm{\theta}_{\mathrm{ns}})\right\rVert _{\ell_{2}}^{2}+\lambda\left\lVert\bm{\theta}_{\mathrm{s}}\right\rVert_{\ell_{2 }}^{2}\]

We continue by deriving the auxiliary optimization (AO) problem. By duality, we have

\[\mathcal{L}_{PO}(\bm{\theta}_{\mathrm{s}},\bm{\theta}_{\mathrm{ns}}) =\max_{\bm{v}}\frac{1}{n}\left(\bm{v}^{\mathsf{T}}\bm{\varepsilon }+\bm{v}^{\mathsf{T}}\bm{\Lambda}^{\mathsf{T}}\bm{M}_{\mathrm{s}}^{\mathsf{T}}( \bm{\theta}_{0,\mathrm{s}}-\bm{\theta}_{\mathrm{s}})+\bm{v}^{\mathsf{T}}\bm{Z}_ {\mathrm{s}}^{\mathsf{T}}\bm{\theta}_{0,\mathrm{s}}+\bm{v}^{\mathsf{T}}(\bm{ \Lambda}^{\mathsf{T}}\bm{M}_{\mathrm{ns}}^{\mathsf{T}}+\bm{Z}_{\mathrm{ns}}^{ \mathsf{T}})(\bm{\theta}_{0,\mathrm{ns}}-\bm{\theta}_{\mathrm{ns}})-\frac{ \left\lVert\bm{v}\right\rVert_{\ell_{2}}^{2}}{2}\right)\] \[\quad+\lambda\left\lVert\bm{\theta}_{\mathrm{s}}\right\rVert_{ \ell_{2}}^{2}+\lambda\left\lVert\bm{\theta}_{\mathrm{ns}}\right\rVert_{\ell_{2 }}^{2}\]

Note that the above is jointly convex in \((\bm{\theta}_{\mathrm{s}},\bm{\theta}_{\mathrm{ns}})\) and concave in \(\bm{v}\), and the Gaussian matrix \(\bm{Z}\) is independent of everything else. Therefore, the AO problem reads:

\[\mathcal{L}_{AO}(\bm{\theta}_{\mathrm{s}},\bm{\theta}_{\mathrm{ns}}) =\max_{\bm{v}}\frac{1}{n} \Big{(}\bm{v}^{\mathsf{T}}\bm{\varepsilon}+\bm{v}^{\mathsf{T}}\bm{ \Lambda}^{\mathsf{T}}\bm{M}_{\mathrm{s}}^{\mathsf{T}}(\bm{\theta}_{0,\mathrm{s}}- \bm{\theta}_{\mathrm{s}})\] \[\quad+\left\lvert\bm{\theta}_{0,\mathrm{ns}}-\bm{\theta}_{ \mathrm{ns}}\right\rvert_{\ell_{2}}\bm{g}_{\mathrm{ns}}^{\mathsf{T}}\bm{v}+ \left\lVert\bm{v}\right\rVert_{\ell_{2}}\bm{h}_{\mathrm{s}}^{\mathsf{T}}(\bm{ \theta}_{0,\mathrm{ns}}-\bm{\theta}_{\mathrm{ns}})\] \[\quad+\bm{v}^{\mathsf{T}}\bm{\Lambda}^{\mathsf{T}}\bm{M}_{\mathrm{ns}}^ {\mathsf{T}}(\bm{\theta}_{0,\mathrm{ns}}-\bm{\theta}_{\mathrm{ns}})-\frac{ \left\lVert\bm{v}\right\rVert_{\ell_{2}}^{2}}{2}\Big{)}+\lambda\left\lVert \bm{\theta}_{\mathrm{ns}}\right\rVert_{\ell_{2}}^{2}+\lambda\left\lVert\bm{ \theta}_{\mathrm{ns}}\right\rVert_{\ell_{2}}^{2}\,,\]where \(\bm{g}_{\rm s},\bm{g}_{\rm ns}\in\mathbb{R}^{n}\) and \(\bm{h}_{\rm s}\in\mathbb{R}^{p}\), \(\bm{h}_{\rm ns}\in\mathbb{R}^{d-p}\) are independent Gaussian random vectors with i.i.d \(\mathsf{N}(0,1)\) entries.

We next fix norm of \(\left\|\bm{v}\right\|_{\ell_{2}}=\beta\), and maximize over its direction to obtain

\[\mathcal{L}_{AO}(\bm{\theta}_{\rm s},\bm{\theta}_{\rm ns}) =\max_{\beta\geq 0}\frac{1}{n}\Big{(}\beta\left\|\bm{\varepsilon}+ \bm{\Lambda}^{\mathsf{T}}\bm{M}_{\rm s}^{\mathsf{T}}(\bm{\theta}_{0,\rm s}- \bm{\theta}_{\rm s})+\left\|\bm{\theta}_{0,\rm ns}\right\|_{\ell_{2}}\bm{g}_{ \rm s}+\left\|\bm{\theta}_{0,\rm ns}-\bm{\theta}_{\rm ns}\right\|_{\ell_{2}} \bm{g}_{\rm ns}+\bm{\Lambda}^{\mathsf{T}}\bm{M}_{\rm ns}^{\mathsf{T}}(\bm{ \theta}_{0,\rm ns}-\bm{\theta}_{\rm ns})\right\|_{\ell_{2}}\] \[\qquad\qquad+\beta\bm{h}_{\rm s}^{\mathsf{T}}\bm{\theta}_{0,\rm s }+\beta\bm{h}_{\rm ns}^{\mathsf{T}}(\bm{\theta}_{0,\rm ns}-\bm{\theta}_{\rm ns })-\frac{\beta^{2}}{2}\Big{)}+\lambda\left\|\bm{\theta}_{\rm s}\right\|_{\ell_ {2}}^{2}+\lambda\left\|\bm{\theta}_{\rm ns}\right\|_{\ell_{2}}^{2}\] \[=\max_{\beta\geq 0}\frac{1}{n}\Big{(}\beta\left\|\bm{\varepsilon}+ \bm{\Lambda}^{\mathsf{T}}\bm{M}_{\rm s}^{\mathsf{T}}(\bm{\theta}_{0,\rm s}- \bm{\theta}_{\rm s})+\bm{\Lambda}^{\mathsf{T}}\bm{M}_{\rm ns}^{\mathsf{T}}(\bm{ \theta}_{0,\rm ns}-\bm{\theta}_{\rm ns})+\sqrt{\left\|\bm{\theta}_{0,\rm s} \right\|_{\ell_{2}}^{2}+\left\|\bm{\theta}_{0,\rm ns}-\bm{\theta}_{\rm ns} \right\|_{\ell_{2}}^{2}}\bm{g}\Big{\|}_{\ell_{2}}\] \[\qquad\qquad+\beta\bm{h}_{\rm s}^{\mathsf{T}}\bm{\theta}_{0,\rm s }+\beta\bm{h}_{\rm ns}^{\mathsf{T}}(\bm{\theta}_{0,\rm ns}-\bm{\theta}_{\rm ns })-\frac{\beta^{2}}{2}\Big{)}+\lambda\left\|\bm{\theta}_{\rm s}\right\|_{\ell _{2}}^{2}+\lambda\left\|\bm{\theta}_{\rm ns}\right\|_{\ell_{2}}^{2}\,,\]

where we used that \(\bm{g}_{\rm s},\bm{g}_{\rm ns}\in\mathbb{R}^{n}\) have independent Gaussian entries. Here, \(\bm{g}\in\mathbb{R}^{n}\) has i.i.d entries from \(\mathsf{N}(0,1)\). Next, note that the above optimization over \(\beta\) has a closed form. Using the identity \(\max_{\beta\geq 0}(\beta x-\beta^{2}/2)=x_{+}^{2}/2\), with \(x_{+}=\max(x,0)\), we get

\[\mathcal{L}_{AO}(\bm{\theta}_{\rm s},\bm{\theta}_{\rm ns})=\frac{1 }{2n}\Big{(}\left\|\bm{\varepsilon}+\bm{\Lambda}^{\mathsf{T}}\bm{M}_{\rm s}^{ \mathsf{T}}(\bm{\theta}_{0,\rm s}-\bm{\theta}_{\rm s})+\bm{\Lambda}^{\mathsf{T} }\bm{M}_{\rm ns}^{\mathsf{T}}(\bm{\theta}_{0,\rm ns}-\bm{\theta}_{\rm ns})+ \sqrt{\left\|\bm{\theta}_{0,\rm s}\right\|_{\ell_{2}}^{2}+\left\|\bm{\theta}_{0, \rm ns}-\bm{\theta}_{\rm ns}\right\|_{\ell_{2}}^{2}}\bm{g}\Big{\|}_{\ell_{2}}\] \[\qquad\qquad+\bm{h}_{\rm s}^{\mathsf{T}}\bm{\theta}_{0,\rm s}+ \bm{h}_{\rm ns}^{\mathsf{T}}(\bm{\theta}_{0,\rm ns}-\bm{\theta}_{\rm ns})\Big{)} _{+}^{2}+\lambda\left\|\bm{\theta}_{\rm s}\right\|_{\ell_{2}}^{2}+\lambda\left\| \bm{\theta}_{\rm ns}\right\|_{\ell_{2}}^{2}\,.\] (B.1)

**Scalarization of the auxiliary optimization (AO) problem.** We next proceed to scalarize the AO problem. Consider the singular value decomposition

\[\bm{M}_{\rm s}=\bm{U}_{\rm s}\bm{\Sigma}_{\rm s}\bm{V}_{\rm s}^{\mathsf{T}}\,,\]

with \(\bm{U}_{\rm s}\in\mathbb{R}^{p\times r}\), \(\bm{\Sigma}_{\rm s}\in\mathbb{R}^{r\times r}\), \(\bm{V}_{\rm s}\in\mathbb{R}^{k\times r}\), where \(r=\mathrm{rank}(\bm{M}_{\rm s})\leq k\). Decompose \(\bm{q}_{\rm s}:=\bm{\theta}_{0,\rm s}-\bm{\theta}_{\rm s}\) in its projections onto the space spanned by the columns \(\bm{u}_{1,\rm s},\ldots,\bm{u}_{r,\rm s}\) of \(\bm{U}_{\rm s}\), and the orthogonal component:

\[\bm{q}_{\rm s}=\sum_{i=1}^{r}\alpha_{i}\bm{u}_{i,\rm s}+\alpha_{0}\bm{q}_{\rm s} ^{\perp}\,,\]

where \(\left\|\bm{q}_{\rm s}^{\perp}\right\|_{\ell_{2}}=1\), \(\alpha_{0}\geq 0\), and \(\bm{U}_{\rm s}^{\mathsf{T}}\bm{q}_{\rm s}^{\perp}=\bm{0}\). Using the shorthand \(\bm{\alpha}=(\alpha_{1},\ldots,\alpha_{r})\), we write

\[\bm{\Lambda}^{\mathsf{T}}\bm{M}_{\rm s}^{\mathsf{T}}(\bm{\theta}_{0,\rm s}-\bm{ \theta}_{\rm s})=\bm{\Lambda}^{\mathsf{T}}\bm{V}_{\rm s}\bm{\Sigma}_{\rm s}\bm{U}_{ \rm s}^{\mathsf{T}}\bm{q}_{\rm s}=\bm{\Lambda}^{\mathsf{T}}\bm{V}_{\rm s}\bm{ \Sigma}_{\rm s}\bm{\alpha}\,.\]

In addition,

\[\left\|\bm{\theta}_{\rm s}\right\|_{\ell_{2}}^{2} =\left\|\bm{\theta}_{0,\rm s}-(\bm{\theta}_{0,\rm s}-\bm{\theta}_{ \rm s})\right\|_{\ell_{2}}^{2}\] \[=\left\|\bm{\theta}_{0,\rm s}\right\|_{\ell_{2}}^{2}+\left\|\bm{q} _{\rm s}\right\|_{\ell_{2}}^{2}-2(\bm{\theta}_{0,\rm s},\bm{q}_{\rm s})\] \[=\left\|\bm{\theta}_{0,\rm s}\right\|_{\ell_{2}}^{2}+\left\|\bm{q} _{\rm s}\right\|_{\ell_{2}}^{2}-2(\bm{\theta}_{0,\rm s},\bm{U}_{\rm s}\bm{ \alpha})-2\alpha_{0}(\bm{\theta}_{0,\rm s},\bm{q}_{\rm s}^{\perp})\] \[=\left\|\bm{\theta}_{0,\rm s}\right\|_{\ell_{2}}^{2}+\left\|\bm{q} _{\rm s}\right\|_{\ell_{2}}^{2}-2(\bm{U}_{\rm s}^{\mathsf{T}}\bm{\theta}_{0, \rm s},\bm{\alpha})-2\alpha_{0}(\bm{\theta}_{0,\rm s},\bm{q}_{\rm s}^{\perp})\] \[=\left\|\bm{\theta}_{0,\rm s}\right\|_{\ell_{2}}^{2}+(\alpha_{0}^ {2}+\left\|\bm{\alpha}\right\|_{\ell_{2}}^{2})-2(\bm{U}_{\rm s}^{\mathsf{T}} \bm{\theta}_{0,\rm s},\bm{\alpha})-2\alpha_{0}(\bm{\theta}_{0,\rm s},\bm{q}_{ \rm s}^{\perp})\,.\] (B.2)

Similarly, we define \(\bm{q}_{\rm ns}=\bm{\theta}_{0,\rm ns}-\bm{\theta}_{\rm ns}\) and consider the singular value decomposition

\[\bm{M}_{\rm ns}=\bm{U}_{\rm ns}\bm{\Sigma}_{\rm ns}\bm{V}_{\rm ns}^{\mathsf{T}}\,,\]

with \(\bm{U}_{\rm ns}\in\mathbb{R}^{(d-p)\times t}\), \(\bm{\Sigma}_{\rm ns}\in\mathbb{R}^{t\times t}\), \(\bm{V}_{\rm ns}\in\mathbb{R}^{k\times t}\), where \(t=\mathrm{rank}(\bm{M}_{\rm ns})\leq k\). Decomposing \(\bm{q}_{\rm ns}\) in its projections on the orthogonal columns \(\bm{u}_{1,\rm ns},\ldots

[MISSING_PAGE_FAIL:16]

Next, by using concentration of Lipschitz functions of Gaussian vectors, we obtain

\[\frac{1}{\sqrt{n}}\left\|\boldsymbol{\varepsilon}+\boldsymbol{\Lambda}^ {\mathsf{T}}\boldsymbol{V}_{\mathrm{s}}\boldsymbol{\Sigma}_{\mathrm{s}} \boldsymbol{\alpha}+\boldsymbol{\Lambda}^{\mathsf{T}}\boldsymbol{V}_{\mathrm{ ns}}\boldsymbol{\Sigma}_{\mathrm{ns}}\boldsymbol{\gamma}+\sqrt{\left\|\boldsymbol{ \theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}^{2}+\gamma_{0}^{2}+\left\| \boldsymbol{\gamma}\right\|_{\ell_{2}}^{2}\,\boldsymbol{g}\right\|_{\ell_{2}}}\] \[\overset{p}{\to}\sqrt{(\boldsymbol{V}_{\mathrm{s}}\boldsymbol{ \Sigma}_{\mathrm{s}}\boldsymbol{\alpha}+\boldsymbol{V}_{\mathrm{ns}}\boldsymbol {\Sigma}_{\mathrm{ns}}\boldsymbol{\gamma})^{\mathsf{T}}\text{diag}(\boldsymbol{ \pi})\big{(}\boldsymbol{V}_{\mathrm{s}}\boldsymbol{\Sigma}_{\mathrm{s}} \boldsymbol{\alpha}+\boldsymbol{V}_{\mathrm{ns}}\boldsymbol{\Sigma}_{\mathrm{ ns}}\boldsymbol{\gamma}\big{)}+\sigma^{2}+\left(\left\|\boldsymbol{\theta}_{0, \mathrm{s}}\right\|_{\ell_{2}}^{2}+\gamma_{0}^{2}+\left\|\boldsymbol{\gamma} \right\|_{\ell_{2}}^{2}\right)}\]

Also, since \(\left\|\boldsymbol{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}\) is bounded and \(\left\|\boldsymbol{u}_{\mathrm{s},\mathrm{s}}\right\|_{\ell_{2}}=1\), we get

\[\frac{\boldsymbol{h}_{\mathrm{s}}^{\mathsf{T}}\boldsymbol{\theta}_{0,\mathrm{s }}}{\sqrt{n}},\frac{\boldsymbol{h}_{\mathrm{ns}}^{\mathsf{T}}\boldsymbol{u}_{ \mathrm{i,ns}}}{\sqrt{n}}\overset{(p)}{\to}0\,.\]

In addition, \(\left\|\boldsymbol{h}_{\mathrm{ns}}^{\perp}\right\|_{\ell_{2}}\) concentrates around \(\sqrt{d-p-t}\) and \((d-p-t)/n\to\psi_{d}-\psi_{p}\), because \(t\leq k\) remains bounded as \(n\) diverges, and so

\[\frac{\left\|\boldsymbol{h}_{\mathrm{ns}}^{\perp}\right\|_{\ell_{2}}}{\sqrt{n}} \overset{(p)}{\to}\sqrt{\psi_{d}-\psi_{p}}\,.\]

Using the above limits, the objective in (B.4) converges in-probability to

\[\mathcal{D}(\alpha_{0},\gamma_{0},\xi,\boldsymbol{\alpha}, \boldsymbol{\gamma}):=\] \[+\lambda\left\|\boldsymbol{\theta}_{0}\right\|_{\ell_{2}}^{2}+ \lambda(\alpha_{0}^{2}+\gamma_{0}^{2}+\left\|\boldsymbol{\alpha}\right\|_{ \ell_{2}}^{2}+\left\|\boldsymbol{\gamma}\right\|_{\ell_{2}}^{2})\] \[-2\lambda\left(\left\langle\boldsymbol{U}_{\mathrm{s}}^{\mathsf{ T}}\boldsymbol{\theta}_{0,\mathrm{s}},\boldsymbol{\alpha}\right\rangle+ \alpha_{0}\left\|(\boldsymbol{U}_{\mathrm{s}}^{\perp})^{\mathsf{T}}\boldsymbol{ \theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}+\left\langle\boldsymbol{U}_{\mathrm{ ns}}^{\mathsf{T}}\boldsymbol{\theta}_{0,\mathrm{ns}},\boldsymbol{\gamma} \right\rangle+\gamma_{0}\sqrt{1-\xi^{2}}\left\|(\boldsymbol{U}_{\mathrm{ns}}^{ \perp})^{\mathsf{T}}\boldsymbol{\theta}_{0,\mathrm{ns}}\right\|_{\ell_{2}}\right)\] (B.5)

We are now ready to prove the theorems.

#### b.2.1 Proof of Theorem 3.1

Using Lemma 2.1, we have

\[\mathrm{Risk}(\widehat{\boldsymbol{\theta}}_{L}) =\sigma^{2}+\left\|\boldsymbol{\theta}_{0}-\boldsymbol{\theta} \right\|_{\ell_{2}}^{2}+(\boldsymbol{\theta}_{0}-\boldsymbol{\theta})^{ \mathsf{T}}\boldsymbol{M}\text{diag}(\boldsymbol{\pi})\boldsymbol{M}^{ \mathsf{T}}(\boldsymbol{\theta}_{0}-\boldsymbol{\theta})\] \[=\sigma^{2}+\left\|\boldsymbol{q}_{\mathrm{s}}\right\|_{\ell_{2}} ^{2}+\left\|\boldsymbol{q}_{\mathrm{ns}}\right\|_{\ell_{2}}^{2}+\boldsymbol{q }_{\mathrm{s}}^{\mathsf{T}}\boldsymbol{M}_{\mathrm{s}}\text{diag}(\boldsymbol{ \pi})\boldsymbol{M}_{\mathrm{s}}^{\mathsf{T}}\boldsymbol{q}_{\mathrm{s}}+ \boldsymbol{q}_{\mathrm{ns}}^{\mathsf{T}}\boldsymbol{M}_{\mathrm{ns}}\text{ diag}(\boldsymbol{\pi})\boldsymbol{M}_{\mathrm{ns}}^{\mathsf{T}}\boldsymbol{q}_{\mathrm{ns}}\] \[=\sigma^{2}+(\alpha_{0}^{2}+\gamma_{0}^{2}+\left\|\boldsymbol{ \alpha}\right\|_{\ell_{2}}^{2}+\left\|\boldsymbol{\gamma}\right\|_{\ell_{2}}^{2})\] \[\quad+\boldsymbol{\alpha}^{\mathsf{T}}\boldsymbol{\Sigma}_{\mathrm{ s}}\boldsymbol{V}_{\mathrm{s}}^{\mathsf{T}}\text{diag}(\boldsymbol{\pi})\boldsymbol{V}_{ \mathrm{s}}\boldsymbol{\Sigma}_{\mathrm{s}}\boldsymbol{\alpha}+\boldsymbol{ \gamma}^{\mathsf{T}}\boldsymbol{\Sigma}_{\mathrm{ns}}\boldsymbol{V}_{\mathrm{ ns}}^{\mathsf{T}}\text{diag}(\boldsymbol{\pi})\boldsymbol{V}_{\mathrm{ns}} \boldsymbol{\Sigma}_{\mathrm{ns}}\boldsymbol{\gamma}\,.\] (B.6)

Since \(\psi_{d}-\psi_{p}\leq 1\), we are in the over- determined (a.k.a underparametrized) regime. As \(\lambda\to 0^{+}\), the terms involving \(\lambda\) become negligible compared to the first term in (B.5) except those that include \(\alpha_{0}\), as \(\alpha_{0}\) is not present in the first term. Since \((x)_{\epsilon}^{2}\) is increasing, and

\[\big{(}\boldsymbol{V}_{\mathrm{s}}\boldsymbol{\Sigma}_{\mathrm{s}}\boldsymbol{ \alpha}+\boldsymbol{V}_{\mathrm{ns}}\boldsymbol{\Sigma}_{\mathrm{ns}} \boldsymbol{\gamma}\big{)}^{\mathsf{T}}\text{diag}(\boldsymbol{\pi})\big{(} \boldsymbol{V}_{\mathrm{s}}\boldsymbol{\Sigma}_{\mathrm{s}}\boldsymbol{\alpha}+ \boldsymbol{V}_{\mathrm{ns}}\boldsymbol{\Sigma}_{\mathrm{ns}}\boldsymbol{\gamma} \big{)}+\left\|\boldsymbol{\gamma}\right\|_{\ell_{2}}^{2}\geq 0,\]

the minimum over \(\boldsymbol{\alpha}\) and \(\boldsymbol{\gamma}\) is achieved for \(\boldsymbol{\alpha}=\boldsymbol{0}\in\mathbb{R}^{r}\) and \(\boldsymbol{\gamma}=\boldsymbol{0}\in\mathbb{R}^{t}\). The optimization (B.5) then reduces to

\[\min_{\alpha_{0},\gamma_{0}\geq 0,0\leq\xi\leq 1}\frac{1}{2}\left(\sqrt{\sigma^{2}+( \left\|\boldsymbol{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}^{2}+\gamma_{0}^{2} )}-\gamma_{0}\xi\sqrt{\psi_{d}-\psi_{p}}\right)_{+}^{2}+\lambda\alpha_{0}^{2}-2 \lambda\alpha_{0}\left\|(\boldsymbol{U}_{\mathrm{s}}^{\perp})^{\mathsf{T}} \boldsymbol{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}\,.\] (B.7)

The optimal \(\xi\) is given by \(\xi=1\). Also, setting derivative with respect to \(\alpha_{0}\) to zero we obtain the optimal \(\alpha_{0}=\left\|(\boldsymbol{U}_{\mathrm{s}}^{\perp})^{\mathsf{T}}\boldsymbol{ \theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}\). Next, by setting derivative with respect to \(\gamma_{0}\) we arrive at

\[\gamma_{0}^{2}=(\sigma^{2}+\left\|\boldsymbol{\theta}_{0,\mathrm{s}}\right\|_{ \ell_{2}}^{2})\frac{\psi_{d}-\psi_{p}}{1-(\psi_{d}-\psi_{p})}\,.\]

Using the optimal variables in (B.6) we obtain the risk of minimum-norm estimator as

\[\mathrm{Risk}(\widehat{\boldsymbol{\theta}}_{L}) =\sigma^{2}+\left\|(\boldsymbol{U}_{\mathrm{s}}^{\perp})^{\mathsf{ T}}\boldsymbol{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}^{2}+(\sigma^{2}+\left\| \boldsymbol{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}^{2})\frac{\psi_{d}-\psi_ {p}}{1-(\psi_{d}-\psi_{p})}\] \[=(\sigma^{2}+\left\|\boldsymbol{\theta}_{0,\mathrm{s}}\right\|_{ \ell_{2}}^{2})\frac{1}{1-(\psi_{d}-\psi_{p})}-\left\|\boldsymbol{U}_{ \mathrm{s}}^{\mathsf{T}}\boldsymbol{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}^{2}\,.\]

Recall that by assumption, \(r_{\mathrm{s}}=\left\|\boldsymbol{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}\) and \(\left\|\boldsymbol{U}_{\mathrm{s}}^{\mathsf{T}}\boldsymbol{\theta}_{0,\mathrm{s}} \right\|_{\ell_{2}}=\sqrt{\rho}r_{\mathrm{s

#### b.2.2 Proof of Theorem 3.2

We continue from (B.5). In the case of \(\psi_{d}-\psi_{p}\leq 1\), it is easy to see that the derivative of the first term of (B.5), in the active region is decreasing in \(\gamma_{0}\). With the consideration \(\lambda\to 0^{+}\), minimizing over \(\gamma_{0}\) will push us into the non-active region. Therefore the optimization problem (B.5) reduces to

\[\text{minimize}\quad\left\|\bm{\theta}_{0}\right\|_{\ell_{2}}^{2}+ \alpha_{0}^{2}+\gamma_{0}^{2}+\left\|\bm{\alpha}\right\|_{\ell_{2}}^{2}+\left\| \bm{\gamma}\right\|_{\ell_{2}}^{2}\] \[\quad-2\left(\left\langle\bm{U}_{\mathrm{s}}^{\mathsf{T}}\bm{ \theta}_{0,\mathrm{s}},\bm{\alpha}\right\rangle+\alpha_{0}\left\|(\bm{U}_{ \mathrm{s}}^{\mathsf{T}}\bm{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}+\left\langle \bm{U}_{\mathrm{ns}}^{\mathsf{T}}\bm{\theta}_{0,\mathrm{ns}},\bm{\gamma}\right \rangle+\gamma_{0}\sqrt{1-\xi^{2}}\left\|(\bm{U}_{\mathrm{ns}}^{\perp})^{ \mathsf{T}}\bm{\theta}_{0,\mathrm{ns}}\right\|_{\ell_{2}}\right)\] \[\text{subject to}\] (B.8)

By Assumption 2, \(\bm{\Sigma}_{\mathrm{s}}=\mu\bm{I}_{k}\), \(\bm{V}_{\mathrm{s}}=\bm{I}_{k\times k}\), and \(\bm{\Sigma}_{\mathrm{ns}}=\bm{0}\), \(\bm{U}_{\mathrm{ns}}=\bm{0}\) (no cluster structure on non-sensitive features and an orthogonal, equal energy cluster centers on the sensitive features). Therefore, by fixing \(\gamma:=\left\|\bm{\gamma}\right\|_{\ell_{2}}\), the optimization problem (B.8) becomes:

\[\text{minimize}\quad\alpha_{0}^{2}+\gamma_{0}^{2}+\left\|\bm{ \alpha}\right\|_{\ell_{2}}^{2}+\gamma^{2}-2\left(\left\langle\bm{U}_{\mathrm{ s}}^{\mathsf{T}}\bm{\theta}_{0,\mathrm{s}},\bm{\alpha}\right\rangle+\alpha_{0} \left\|(\bm{U}_{\mathrm{s}}^{\perp})^{\mathsf{T}}\bm{\theta}_{0,\mathrm{s}} \right\|_{\ell_{2}}+\gamma_{0}\sqrt{1-\xi^{2}}\left\|\bm{\theta}_{0,\mathrm{ns }}\right\|_{\ell_{2}}\right)\] \[\text{subject to}\] \[\quad\mu^{2}\bm{\alpha}^{\mathsf{T}}\text{diag}(\bm{\pi})\bm{ \alpha}+\sigma^{2}+\left\|\bm{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}^{2}+ \gamma_{0}^{2}+\gamma^{2}\leq\gamma_{0}^{2}\xi^{2}(\psi_{d}-\psi_{p})\,.\] (B.9)

Since \(\alpha_{0}\) does not appear in the constraint, it is easy to see that its optimal value is given by \(\alpha_{0}=\left\|(\bm{U}_{\mathrm{s}}^{\perp})^{\mathsf{T}}\bm{\theta}_{0, \mathrm{s}}\right\|_{\ell_{2}}\). Also, note that by decreasing \(\gamma\) the objective value decreases and also by the constraint on the other variables become more relaxed. Consequently, the optimal value of \(\gamma\) is \(\gamma=0\). Removing \(\alpha_{0}\) from the objective function, we are left with

\[\text{minimize}\quad\gamma_{0}^{2}+\left\|\bm{\alpha}\right\|_{ \ell_{2}}^{2}-2\left(\left\langle\bm{U}_{\mathrm{s}}^{\mathsf{T}}\bm{\theta}_ {0,\mathrm{s}},\bm{\alpha}\right\rangle+\gamma_{0}\sqrt{1-\xi^{2}}\left\|\bm{ \theta}_{0,\mathrm{ns}}\right\|_{\ell_{2}}\right)\] \[\text{subject to}\quad\mu^{2}\bm{\alpha}^{\mathsf{T}}\text{diag}( \bm{\pi})\bm{\alpha}+\sigma^{2}+\left\|\bm{\theta}_{0,\mathrm{s}}\right\|_{ \ell_{2}}^{2}+\gamma_{0}^{2}\leq\gamma_{0}^{2}\xi^{2}(\psi_{d}-\psi_{p})\,.\] (B.10)

Optimal choice of \(\xi\) results in the constraint to become equality. Solving for \(\xi\), the optimization reduces to

\[\text{minimize}\quad\gamma_{0}^{2}+\left\|\bm{\alpha}\right\|_{ \ell_{2}}^{2}-2\left(\left\langle\bm{U}_{\mathrm{s}}^{\mathsf{T}}\bm{\theta}_{0,\mathrm{s}},\bm{\alpha}\right\rangle+\sqrt{\gamma_{0}^{2}-\frac{\mu^{2}\bm{ \alpha}^{\mathsf{T}}\text{diag}(\bm{\pi})\bm{\alpha}+\sigma^{2}+\left|\bm{ \theta}_{0,\mathrm{s}}\right|_{\ell_{2}}^{2}+\gamma_{0}^{2}}{\psi_{d}-\psi_{p} }\left\|\bm{\theta}_{0,\mathrm{ns}}\right\|_{\ell_{2}}\right)\]

Setting derivative with respect to \(\gamma_{0}\) to zero, we obtain

\[\sqrt{\gamma_{0}^{2}-\frac{\mu^{2}\bm{\alpha}^{\mathsf{T}}\text{diag}(\bm{\pi} )\bm{\alpha}+\sigma^{2}+\left\|\bm{\theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}^{ 2}+\gamma_{0}^{2}}{\psi_{d}-\psi_{p}}}=\left(1-\frac{1}{\psi_{d}-\psi_{p}} \right)\left\|\bm{\theta}_{0,\mathrm{ns}}\right\|_{\ell_{2}}\,.\] (B.11)

Setting derivative with respect to \(\bm{\alpha}\) to zero and using the previous stationary equation, we get

\[\bm{\alpha}=\left(\bm{I}+\frac{\mu^{2}\text{diag}(\bm{\pi})}{\psi_{d}-\psi_{p} -1}\right)^{-1}\bm{U}_{\mathrm{s}}^{\mathsf{T}}\bm{\theta}_{0,\mathrm{s}}\,.\] (B.12)

We next square both sides of (B.12) and rearrange the terms to get

\[\gamma_{0}^{2} =\frac{1}{\psi_{d}-\psi_{p}-1}\left(\sigma^{2}+\left\|\bm{\theta}_{ 0,\mathrm{s}}\right\|_{\ell_{2}}^{2}+\mu^{2}\bm{\alpha}^{\mathsf{T}}\text{diag}( \bm{\pi})\bm{\alpha}\right)+\left(1-\frac{1}{\psi_{d}-\psi_{p}}\right)\left\| \bm{\theta}_{0,\mathrm{ns}}\right\|_{\ell_{2}}^{2}\] \[=\frac{1}{\psi_{d}-\psi_{p}-1}\left(\sigma^{2}+r_{\mathrm{s}}^{2}+ \mu^{2}\bm{\alpha}^{\mathsf{T}}\text{diag}(\bm{\pi})\bm{\alpha}\right)+\left(1- \frac{1}{\psi_{d}-\psi_{p}}\right)r_{\mathrm{ns}}^{2}\,,\]

which are the same expressions for \(\bm{\alpha}\) and \(\gamma_{0}\) given in the theorem statement.

The final step is to write the risk of estimator in terms of \(\bm{\alpha}\), \(\gamma_{0}\). Invoke equation (B.6), and recall that in the current case, \(\bm{\Sigma}_{\mathrm{ns}}=\bm{0}\), \(\bm{\Sigma}_{\mathrm{s}}=\mu\bm{I}\). Also, as we showed in our derivation, \(\gamma=\left\|\bm{\gamma}\right\|_{\ell_{2}}=0\), \(\alpha_{0}=\left\|(\bm{U}_{\mathrm{s}}^{\perp})^{\mathsf{T}}\bm{\theta}_{0, \mathrm{s}}\right\|_{\ell_{2}}\), by which we arrive at

\[\mathrm{Risk}(\widehat{\bm{\theta}}_{L}) =\mu^{2}\bm{\alpha}^{\mathsf{T}}\text{diag}(\bm{\pi})\bm{\alpha} +\sigma^{2}+\left(\left\|(\bm{U}_{\mathrm{s}}^{\perp})^{\mathsf{T}}\bm{ \theta}_{0,\mathrm{s}}\right\|_{\ell_{2}}^{2}+\gamma_{0}^{2}+\left|\bm{\alpha} \right|_{\ell_{2}}^{2}\right)\] \[=\sigma^{2}+(1-\rho)r_{\mathrm{s}}^{2}+\gamma_{0}^{2}+\bm{ \alpha}^{\mathsf{T}}\left(\bm{I}+\mu^{2}\text{diag}(\bm{\pi})\right)\bm{\alpha}\,.\] (B.13)

This concludes the proof.

### Proof of Theorem 3.3

We follow the proof strategy used for Theorem 3.1-3.2. Here, we would like to characterize the risk of min-norm estimator \(\bm{\widehat{\theta}}\). The features matrix has a clustering structure, but the learner is not using that (no look-alike clustering) and is just compute the min-norm estimator for fitting the responses to individual features. Therefore, one can think of this setting as a special case of our previous analysis when there is no sensitive features (so \(\psi_{p}=0\)).

* By setting \(\psi_{p}=0\) and \(r_{\mathrm{s}}=0\) in the result of Theorem 3.1, we get that when \(\psi_{d}\leq 1\), \[\mathrm{Risk}(\bm{\widehat{\theta}})=\frac{\sigma^{2}}{1-\psi_{d}}\,.\]
* In this case, we specialize the proof of Theorem 3.2 to the case that \(\psi_{p}=0\). Continuing from (B.8), and removing the terms corresponding to sensitive features, we arrive at \[\begin{split}&\text{minimize}\quad\gamma_{0}^{2}+\left\|\bm{ \gamma}\right\|_{\ell_{2}}^{2}-2\left(\left\langle\bm{U}^{\mathsf{T}}_{\mathrm{ ns}}\bm{\theta}_{0,\mathrm{ns}},\bm{\gamma}\right\rangle+\gamma_{0}\sqrt{1- \xi^{2}}\left\|(\bm{U}^{\perp}_{\mathrm{ns}})^{\mathsf{T}}\bm{\theta}_{0, \mathrm{ns}}\right\|_{\ell_{2}}\right)\\ &\text{subject to}\\ &\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad \quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\

[MISSING_PAGE_EMPTY:20]

Combining the above bound with (B.20), we get

\[\|\widetilde{\bm{\theta}}_{L}-\widetilde{\bm{\theta}}_{L}\|\leq\frac{1+\sqrt{5}}{ 2c^{\prime 2}}\frac{C}{\left(\sqrt{1-(\psi_{d}-\psi_{p})}-\sqrt{\psi_{d}-\psi_{p}} \right)^{2}}\delta\,.\] (B.23)

We next note that by triangle inequality, the above bound implies that

\[\|\widetilde{\bm{\theta}}_{L}-\bm{\theta}_{0}\|-\|\widehat{\bm{\theta}}_{L}- \bm{\theta}_{0}\|\leq\|\widehat{\bm{\theta}}_{L}-\widetilde{\bm{\theta}}_{L} \|=O(\delta)\,.\]

Therefore, by invoking Lemma 2.1, we obtain the desired result on \(\operatorname{Risk}(\widetilde{\bm{\theta}}_{L})\).

Next suppose that Condition \((ii)\) holds, namely \(\delta<\sqrt{\psi_{d}-\psi_{p}-1}-1\) with \(\psi_{d}-\psi_{p}>2\). Using the result of [31, Theorem 2.1] for \(\bm{X}^{\mathsf{T}}\), we have with probability at least \(1-n^{-1}\),

\[\sigma_{\min}(\bm{X}_{L})\geq\sqrt{n}\left(\sqrt{\psi_{d}-\psi_{p}-1}-1-\sqrt {\frac{2\log n}{n}}\right)\,.\]

By following a similar argument we prove the claim under Condition \((ii)\).

### Proof of Theorem 5.1

We use Theorem 3.3 (b) to characterize \(\operatorname{Risk}(\widetilde{\bm{\theta}})\) in the regime of \(\psi_{d}\geq 1\). Specializing to the case of balanced cluster priors, the risk depends on \(\tilde{\bm{\alpha}}\) only through its norm \(\tilde{\alpha}:=\left\|\tilde{\bm{\alpha}}\right\|_{\ell_{2}}\), and is given by

\[\operatorname{Risk}(\widetilde{\bm{\theta}}) \stackrel{{\mathcal{P}}}{{\to}} \sigma^{2}+\tilde{\gamma}_{0}^{2}+\left(\frac{\mu^{2}}{k}+1\right) \tilde{\alpha}^{2}\] \[=\frac{\psi_{d}}{\psi_{d}-1}\left(\sigma^{2}+\left(\frac{\mu^{2}}

We next show that \(\Delta\geq 1\) if condition (5.1) holds. Since \(\Delta\) is decreasing in \(\mu^{2}/k\) and increasing in \(\rho\), it suffices to show the claim assuming \(\mu^{2}/k\to\infty\) and \(\rho=0\). In this case we have \(\left(\frac{\mu^{2}}{k}+1\right)\tilde{\alpha}^{2}\to 0\) and so

\[\Delta \to\frac{\frac{\sigma^{2}\psi_{d}}{\psi_{d}-1}+\left(1-\frac{1}{ \psi_{d}}\right)\left(r_{\rm s}^{2}+r_{\rm ns}^{2}\right)}{\frac{\sigma^{2}+ r_{\rm s}^{2}}{1-\psi_{d}+\psi_{p}}}\] \[\geq\frac{\frac{\sigma^{2}\psi_{d}}{\psi_{d}-1}+\left(1-\frac{1}{ \psi_{d}}\right)r_{\rm s}^{2}}{\frac{\sigma^{2}+r_{\rm s}^{2}}{1-\psi_{d}+ \psi_{p}}}\] \[=\frac{\frac{\psi_{d}}{\psi_{d}-1}+\left(1-\frac{1}{\psi_{d}} \right)\mathrm{SNR}^{2}}{\frac{1+\Im\mathrm{NR}^{2}}{1-\psi_{d}+\psi_{p}^{2}} }\geq 1,\]

where the last step follows from condition (5.1).