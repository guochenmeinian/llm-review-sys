# Harnessing Multiple Correlated Networks

for Exact Community Recovery

 Miklos Z. Racz

Northwestern University

Evanston, IL 60208

miklos.racz@northwestern.edu

&Jifan Zhang

Northwestern University

Evanston, IL 60208

jifanzhang2026@u.northwestern.edu

###### Abstract

We study the problem of learning latent community structure from multiple correlated networks, focusing on edge-correlated stochastic block models with two balanced communities. Recent work of Gaudio, Racz, and Sridhar (COLT 2022) determined the precise information-theoretic threshold for exact community recovery using two correlated graphs; in particular, this showcased the subtle interplay between community recovery and graph matching. Here we study the natural setting of more than two graphs. The main challenge lies in understanding how to aggregate information across several graphs when none of the pairwise latent vertex correspondences can be exactly recovered. Our main result derives the precise information-theoretic threshold for exact community recovery using any constant number of correlated graphs, answering a question of Gaudio, Racz, and Sridhar (COLT 2022). In particular, for every \(K\geq 3\) we uncover and characterize a region of the parameter space where exact community recovery is possible using \(K\) correlated graphs, even though (1) this is information-theoretically impossible using any \(K-1\) of them and (2) none of the latent matchings can be exactly recovered.

## 1 Introduction

Finding communities in networks--that is, groups of nodes that are similar--is one of the fundamental problems in machine learning. This task is crucially important for understanding the underlying structure and function of networks across diverse applications, including sociology and biology [23]. The increasing availability of network data sets offers the intriguing possibility of improving community recovery algorithms by synthesizing information across correlated networks. However, in many settings the graphs are not aligned--which may happen for a variety of reasons, including anonymization, missing or erroneous data, or simply the alignment being unknown--which presents a challenge. Thus graph matching--the task of recovering the latent vertex alignment between graphs--plays a central role in efforts to integrate data across networks. Our work follows an exciting recent line of work at the intersection of community recovery and graph matching.

Recently, Racz and Sridhar [41] initiated the study of community recovery in correlated stochastic block models (SBMs), focusing on the simplest setting of two correlated graphs with two balanced communities. They determined the information-theoretic limits for exact graph matching, which has applications for community recovery. In particular, they uncovered a region of the parameter space where exact community recovery is possible using two correlated graphs even though it is information-theoretically impossible to do so using just a single graph. Subsequently, Gaudio, Racz, and Sridhar [22] determined the information-theoretic limits for exact community recovery from two correlated SBMs. This required going beyond exact graph matching and understanding the subtle interplay between community recovery and graph matching.

Gaudio, Racz, and Sridhar [22] posed the question of understanding what happens in the case of more than two graphs, which arises naturally in all the motivating examples. For instance, people participate in numerous overlapping yet complementary social networks, and only by combining these can we fully understand and make inferences about society. Similarly, synthesizing information across protein-protein interaction networks from several related species can aid in inferring protein functions [44]. The main challenge lies in understanding how to optimally pass information across three or more graphs.

Our main contribution fully answers this open question by Gaudio, Racz, and Sridhar [22]. Specifically, we precisely characterize the information-theoretic threshold for exact community recovery given \(K\) correlated SBMs, for any constant \(K\). This result highlights an intricate phase diagram and quantifies the value of each additional correlated graph for the task of community recovery. In particular, for every \(K\geq 3\) we uncover and characterize a region of the parameter space where exact community recovery is possible using \(K\) correlated graphs, even though (1) this is impossible using any \(K-1\) of them and (2) none of the latent matchings can be exactly recovered. See Section 3 and Theorems 1 and 2 for details.

Along the way, we also precisely characterize the information-theoretic threshold for exact graph matching given \(K\) correlated SBMs, for any constant \(K\). In particular, we uncover and characterize a region of the parameter space where the latent matching between two correlated SBMs cannot be exactly recovered given just the two graphs, but it can be exactly recovered given \(K>3\) correlated SBMs. See Section 3 and Theorems 3 and 4 for details.

To prove our results, we study the so-called \(k\)-core matching between all pairs of graphs. Recent works have shown the \(k\)-core matching to be a flexible and successful tool in a variety of settings for two correlated graphs [13; 22; 43]. Our main technical contribution is to extend this analysis to more than two graphs. The main difficulty lies in understanding the size of _intersections_ of "bad sets" for \(k\)-core matchings for different pairs of graphs. We refer to Section 4 for details.

## 2 Models and questions

**The stochastic block model (SBM).** The SBM is the most common probabilistic generative model for networks with latent community structure. First introduced by Holland, Laskey, and Leinhardt [25], it has garnered considerable attention and research. In particular, it can be employed as a natural testbed for evaluating and assessing clustering algorithms on average-case networks [1]. The SBM notably displays sharp information-theoretic phase transitions for various inference tasks, offering a detailed understanding of when community information can be extracted from network data. The phase transition thresholds were conjectured by Decelle et al. [15] and were proved rigorously in several papers [33; 34; 35; 36; 2; 3]. We refer to the survey [1] for a detailed overview of the SBM.

In this paper, we focus on the simplest setting, a SBM with two symmetric communities. Let \(n\) be a positive integer and let \(p,q\in[0,1]\) be parameters representing probabilities. We construct a graph \(G\sim\mathrm{SBM}(n,p,q)\) as follows. The graph \(G\) has \(n\) vertices, labeled by \([n]:=\{1,2,3,\ldots,n\}\). Each vertex \(i\) is assigned a community label \(\sigma^{*}(i)\) from the set \(\{+1,-1\}\); these are drawn i.i.d. uniformly at random across \(i\in[n]\). Let \(\boldsymbol{\sigma}^{*}:=\{\sigma^{*}(i)\}_{i=1}^{n}\) denote the community label vector. The vertices are thus categorized into two communities: \(V^{+}:=\{i\in[n]:\sigma^{*}(i)=+1\}\) and \(V^{-}:=\{i\in[n]:\sigma^{*}(i)=-1\}\). Given the community labels \(\boldsymbol{\sigma}^{*}\), the edges of \(G\) are drawn independently between pairs of distinct vertices. If \(\sigma^{*}(i)=\sigma^{*}(j)\), then the edge \((i,j)\) is in \(G\) with probability \(p\); otherwise, it is in \(G\) with probability \(q\).

**Community recovery.** In the community recovery task, an algorithm takes as input the graph \(G\) (without knowing \(\boldsymbol{\sigma}^{*}\)) and outputs an estimated community labeling \(\widehat{\boldsymbol{\sigma}}\). Define the _overlap_ between the estimated labeling and the ground truth as follows:

\[\mathsf{ov}(\boldsymbol{\sigma}^{*},\widehat{\boldsymbol{\sigma}}):=\frac{1}{ n}\left|\sum_{i=1}^{n}\sigma^{*}(i)\widehat{\sigma}(i)\right|.\]

The overlap measures how well the true community labels and the estimated labels of the algorithm match. Note that \(\mathsf{ov}(\boldsymbol{\sigma}^{*},\widehat{\boldsymbol{\sigma}})\in[0,1]\), where the larger the value is, the better performance the algorithm has. In particular, the algorithm succeeds in exactly recovering the partition into two communities (i.e., \(\boldsymbol{\sigma}^{*}=\widehat{\boldsymbol{\sigma}}\) or \(\boldsymbol{\sigma}^{*}=-\widehat{\boldsymbol{\sigma}}\)) if and only if \(\mathsf{ov}(\boldsymbol{\sigma}^{*},\widehat{\boldsymbol{\sigma}})=1\). Our focus in this paper is achieving this goal, known as exact community recovery.

It is well-known that exact community recovery is most challenging and interesting in the logarithmic average degree regime [1]. Accordingly, we focus on this regime: in most of the paper we assume that \(p=a\frac{\log n}{n}\) and \(q=b\frac{\log n}{n}\) for some constants \(a,b>0\). In this regime there is a sharp information-theoretic threshold for exact community recovery [2, 35, 3]. Let \(\mathrm{D}_{+}(a,b):=(\sqrt{a}-\sqrt{b})^{2}/2\) denote the so-called _Chermoff-Hellinger divergence_. Then the information-theoretic threshold is given by

\[\mathrm{D}_{+}(a,b)=1. \tag{2.1}\]

In other words, if \(\mathrm{D}_{+}(a,b)>1\), then exact recovery is possible (and, in fact, efficiently). That is, there is a (polynomial-time) algorithm which outputs an estimator \(\widehat{\mathbf{\sigma}}\) with the guarantee that \(\lim_{n\to\infty}\mathbb{P}(\mathsf{ov}(\mathbf{\sigma}^{\star},\widehat{\mathbf{ \sigma}})=1)=1\). On the other hand, if \(\mathrm{D}_{+}(a,b)<1\) then exact recovery is impossible: for any estimator \(\widehat{\mathbf{\sigma}}\), we have that \(\lim_{n\to\infty}\mathbb{P}(\mathsf{ov}(\mathbf{\sigma}^{\star},\widehat{\mathbf{ \sigma}})=1)=0\).

**Correlated SBMs.** The objective of our work is to understand how the sharp threshold for exact community recovery varies when the input data involves multiple correlated graphs. To do so, we first define a natural model of multiple correlated SBMs [29, 39, 28] (and see further discussion in Section 6 about alternative models).

We construct \((G_{1},\ldots,G_{K})\sim\mathrm{CSBM}(n,p,q,s)\) as follows, where the additional parameter \(s\in[0,1]\) reflects the degree of correlation between the graphs (and the number of graphs \(K\) is dropped from the notation for ease of readability). First, generate a parent graph \(G_{0}\sim\mathrm{SBM}(n,p,q)\) with community labels \(\mathbf{\sigma}^{\star}\). Subsequently, given \(G_{0}\), construct \(G^{\prime}_{1},G^{\prime}_{2},\ldots,G^{\prime}_{K}\) by independent subsampling. Specifically, each edge of \(G_{0}\) is included in \(G^{\prime}_{i}\) with probability \(s\), independently of everything else, and non-edges of \(G_{0}\) remain non-edges in \(G^{\prime}_{i}\). The graphs \(G^{\prime}_{i}\) inherit both the vertex labels and the community labels from the parent graph \(G_{0}\). Finally, let \(\pi^{*}_{12},\ldots,\pi^{*}_{1K}\) be i.i.d. uniformly random permutations of \([n]\) and let \(\mathbf{\pi}^{\star}:=(\pi^{*}_{12},\ldots,\pi^{*}_{1K})\). Define \(G_{1}:=G^{\prime}_{1}\) and, for all \(i\in\{2,\ldots,K\}\), define \(G_{i}:=\pi^{*}_{1i}(G^{\prime}_{i})\). In other words, for every \(i>1\) and \(j\in[n]\), vertex \(j\) in \(G^{\prime}_{i}\) is relabeled to \(\pi^{*}_{1i}(j)\) in \(G_{i}\). This last relabeling step mirrors the real-world observation that vertex labels are often unaligned across graphs. This construction is shown in Figure 1.

An important property of the model is that marginally each graph \(G_{i}\) is an SBM. Since the subsampling probability is \(s\), we have that \(G_{i}\sim\mathrm{SBM}(n,ps,qs)\). Thus, it follows from (2.1) that, in the logarithmic average degree regime where \(p=a\frac{\log n}{n}\) and \(q=b\frac{\log n}{n}\), the communities can be exactly recovered from \(G_{1}\) alone precisely when \(s\mathrm{D}_{+}(a,b)=D_{+}(sa,sb)>1\).

The key question in our work is how to improve the threshold by incorporating more information as \(K\), the number of correlated SBMs, increases. This question was initiated by Racz and Sridhar [41] and then solved by Gaudio, Racz, and Sridhar [22] when \(K=2\).

An essential observation is that, to go beyond the threshold, one needs to combine information from the \(K\) graphs \(G_{1},\ldots,G_{K}\) through graph matching. Then one can exactly recover the community labels using the combined information, even in regimes where it is information-theoretically impossible to exactly recover \(\mathbf{\sigma}^{\star}\) given up to \(K-1\) graphs.

To be more specific, if \(\mathbf{\pi}^{\star}\) were known, then one can reconstruct \(G^{\prime}_{j}\) from \(G_{j}\) and then combine the graphs \(G^{\prime}_{1},\ldots,G^{\prime}_{K}\) to obtain the union graph \(H^{*}\), defined as follows: the edge \((i,j)\) is included in

Figure 1: Schematic showing the construction of multiple correlated SBMs (see text for details).

\(H^{*}\) if and only if \((i,j)\) is included in at least one of \(G_{1}^{\prime},\ldots,G_{K}^{\prime}\). Note that \(H^{*}\) is also an SBM; specifically, \(H^{*}\sim\mathrm{SBM}\left(n,\left(1-(1-s)^{K}\right)p,\left(1-(1-s)^{K}\right) q\right)\), so (2.1) directly implies that the communities can be exactly recovered from the union graph \(H^{*}\) if \(\left(1-(1-s)^{K}\right)\mathrm{D}_{+}(a,b)>1\).

**Graph matching.** In real applications, the permutations \(\boldsymbol{\pi^{*}}=(\pi_{12}^{*},\ldots,\pi_{1K}^{*})\) are often not known. The arguments above highlight the importance of an intermediate task, known as graph matching: how can one recover the latent permutations \(\boldsymbol{\pi^{*}}\) given the graphs \((G_{1},G_{2},\ldots,G_{K})\)? While here we regard graph matching as an important intermediate step, it is of great significance in its own right, with applications in social network privacy [40], machine learning [10], and more. For two correlated SBMs, this problem was resolved by Racz and Sridhar [41], who proved that the information-theoretic threshold for (pairwise) exact graph matching is \(s^{2}(a+b)/2=1\). Note that this is also the connectivity threshold for the intersection graph of \(G_{1}\) and \(G_{2}^{\prime}\) (see [41]). Denote

\[\mathrm{T}_{\mathrm{c}}(a,b):=\frac{a+b}{2}. \tag{2.2}\]

With this notation, the (pairwise) exact graph matching threshold is given by \(s^{2}\mathrm{T}_{\mathrm{c}}(a,b)=1\). This directly implies (by a union bound) that if \(s^{2}\mathrm{T}_{\mathrm{c}}(a,b)>1\), then \(\boldsymbol{\pi^{*}}\) can be exactly recovered given \((G_{1},G_{2},\ldots,G_{K})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n} {n},s)\), for any constant \(K\). By the discussion above, this also gives a sufficient condition for exact community recovery given \((G_{1},G_{2},\ldots,G_{K})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n }{n},s)\):

\[s^{2}\mathrm{T}_{\mathrm{c}}(a,b)>1\qquad\text{ and }\qquad\left(1-(1-s)^{K} \right)\mathrm{D}_{+}(a,b)>1. \tag{2.3}\]

We will generalize the exact graph matching result of Racz and Sridhar [41] and show (see Theorem 3 below) that \(\boldsymbol{\pi^{*}}\) can be exactly recovered given \((G_{1},G_{2},\ldots,G_{K})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n }{n},s)\) if

\[s\left(1-(1-s)^{K-1}\right)\mathrm{T}_{\mathrm{c}}(a,b)>1, \tag{2.4}\]

which (for \(K>2\)) is weaker than the condition \(s^{2}\mathrm{T}_{\mathrm{c}}(a,b)>1\) implied by [41]. (Moreover, in Theorem 4 we show that the condition in (2.4) is tight for exact recovery of \(\boldsymbol{\pi^{*}}\).) Thus, by the discussion above, this gives a sufficient condition for exact community recovery given \((G_{1},G_{2},\ldots,G_{K})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n }{n},s)\):

\[s\left(1-(1-s)^{K-1}\right)\mathrm{T}_{\mathrm{c}}(a,b)>1\qquad\text{ and } \qquad\left(1-(1-s)^{K}\right)\mathrm{D}_{+}(a,b)>1. \tag{2.5}\]

**The interplay between community recovery and graph matching.** The condition (2.5) is, however, not tight. To attain the sharp threshold for exact community recovery given \(K\) graphs, we need to answer the following question: does there exist a parameter regime where exact community recovery is possible for \(K\) graphs, even though (1) exact graph matching is impossible, and (2) exact community recovery is impossible using only \(K-1\) graphs?

For \(K=2\) graphs, Gaudio, Racz, and Sridhar [22] proved that the sharp threshold for exact community recovery given \(K\) correlated SBMs is given by

\[s^{2}\mathrm{T}_{\mathrm{c}}(a,b)+s(1-s)\mathrm{D}_{+}(a,b)>1\qquad\text{ and } \qquad\left(1-(1-s)^{2}\right)\mathrm{D}_{+}(a,b)>1. \tag{2.6}\]

The condition \(\left(1-(1-s)^{2}\right)\mathrm{D}_{+}(a,b)>1\) is necessary due to the work [41]. The first condition in (2.6) demonstrates the interplay between community recovery and graph matching. To be more specific, the first term \(s^{2}\mathrm{T}_{\mathrm{c}}(a,b)\) is the threshold for exact graph matching given \((G_{1},G_{2})\), while the second term \(s(1-s)\mathrm{D}_{+}(a,b)\) comes from community recovery.

Our main contribution generalizes this result, determining the exact community recovery threshold for \(K\geq 3\) graphs. If \(\left(1-(1-s)^{K}\right)\mathrm{D}_{+}(a,b)>1\), then the sharp threshold is given by

\[s\left(1-(1-s)^{K-1}\right)\mathrm{T}_{\mathrm{c}}(a,b)+s(1-s)^{K-1}\mathrm{D} _{+}(a,b)>1. \tag{2.7}\]

The condition (2.7) also clearly exhibits the interplay between community recovery and graph matching. The first term comes from graph matching, while the second term comes from community recovery, as in the case of \(K=2\). We refer to Section 3 and Theorems 1 and 2 for details.

Despite the apparent similarity in results, when \(K\geq 3\) the situation differs significantly from that of two graphs. The primary challenge lies in the existence of multiple methods for matching \(K\geq 3\) graphs. When \(K=2\), there is only a single matching that needs to be recovered from \(G_{1}\) and \(G_{2}\). In contrast, with three or more graphs, the graphs can be matched pairwise, or to some anchor graph, or potentially in many other ways. Integrating information across different matchings requires substantial additional effort. We present the formal results in the next section.

Results

Our main contributions are to determine the precise information-theoretic thresholds for exact community recovery and for exact graph matching given \(K\) correlated SBMs.

### Threshold for exact community recovery

We first describe the precise information-theoretic threshold for exact community recovery, starting with the positive direction.

**Theorem 1** (Exact community recovery from \(K\) correlated SBMs).: _Fix constants \(a,b>0\) and \(s\in[0,1]\), and let \((G_{1},G_{2},\ldots,G_{K})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n}{ n},s)\). Suppose that the following two conditions both hold:_

\[\left(1-(1-s)^{K}\right)\mathrm{D}_{+}(a,b)>1 \tag{3.1}\]

_and_

\[s\left(1-(1-s)^{K-1}\right)\mathrm{T}_{\mathrm{c}}(a,b)+s(1-s)^{K-1}\mathrm{D }_{+}(a,b)>1. \tag{3.2}\]

_Then exact community recovery is possible. That is, there is an estimator \(\widehat{\boldsymbol{\sigma}}=\widehat{\boldsymbol{\sigma}}(G_{1},G_{2}, \ldots,G_{K})\) such that \(\lim\limits_{n\to\infty}\mathbb{P}\left(\mathsf{ov}\left(\widehat{\boldsymbol{ \sigma}},\boldsymbol{\sigma}^{\star}\right)=1\right)=1\)._

Combined with Theorem 2 below (which shows that Theorem 1 is tight), this result precisely answers an open problem of Gaudio, Racz, and Sridhar [22]. The condition (3.1) is required for exact community recovery for \(K\) graphs by [41]. We now focus on the condition (3.2). In the prior work [22], it is proved that the threshold for exact community recovery for two graphs is given by (2.6). The primary contribution of Theorem 1 is to go beyond this threshold as the number of graphs \(K\) increases. In particular, this showcases that there exists a regime where (1) it is impossible to exactly recover \(\boldsymbol{\sigma}^{\star}\) from \((G_{1},G_{2},\ldots,G_{K-1})\) alone and (2) any exact graph matching is impossible, yet one can perform exact recovery of \(\boldsymbol{\sigma}^{\star}\) given \((G_{1},G_{2},\ldots,G_{K})\). This requires developing novel algorithms that integrate information from \((G_{1},G_{2},\ldots,G_{K})\) delicately and incorporate multiple graph matchings carefully.

Here we first provide a detailed discussion of the algorithms for three graphs \((G_{1},G_{2},G_{3})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n}{n},s)\), which is the simplest case with intriguing new phenomena and challenges as mentioned. This avoids complicated notations (which arise for general \(K\)) for easier understanding. The new techniques used for combining multiple matchings and integrating information with three graphs are subsequently generalized to \(K>3\) correlated SBMs. The high level idea of the algorithm for exact community recovery when \(K=3\) consists of five steps (in the following discussion we assume \(a>b\); when \(a<b\), change majority to minority everywhere):

1. Obtain an almost exact community labeling of \(G_{1}\).
2. Obtain three pairwise partial almost exact graph matchings \(\widehat{\mu}_{12}\), \(\widehat{\mu}_{13}\), and \(\widehat{\mu}_{23}\) between graph pairs \((G_{1},G_{2})\), \((G_{1},G_{3})\), and \((G_{2},G_{3})\), respectively.
3. For vertices in \(G_{1}\) that are part of at least two matchings, refine the almost exact community labeling in Step 1 via majority vote in the (union) graph consisting of edges that appear at least once in \((G_{1},G_{2},G_{3})\).
4. For vertices in \(G_{1}\) that are part of only \(\widehat{\mu}_{12}\) (resp. \(\widehat{\mu}_{13}\)), label them via majority vote of their neighbors' labels in the graph consisting of edges that appear only in \(G_{1}\) and not in \(G_{2}\) (resp. only in \(G_{1}\) and not in \(G_{3}\)).
5. For vertices in \(G_{1}\) that are not part of any of the three matchings or only part of \(\widehat{\mu}_{23}\), label them via majority vote of their neighbors' labels in \(G_{1}\).

Each step in the algorithm involves abundant technical details. See Section 4 for a detailed overview of the algorithms and proofs. Note that the threshold (3.2) captures the interplay between community recovery and graph matching, which we now discuss in more detail.

The first term in (3.2), which is \(s\left(1-(1-s)^{2}\right)\mathrm{T}_{\mathrm{c}}(a,b)\) for \(K=3\), comes from graph matching. In [22] it is shown that for one matching, say \(\widehat{\mu}_{12}\), the best possible almost exact graph matching makes \(n^{1-s^{2}\mathrm{T}_{\mathrm{c}}(a,b)+o(1)}\) errors. Here, we show that it is possible to obtain almost exact matchings \(\widehat{\mu}_{12}\) and \(\widehat{\mu}_{13}\) (namely, these will be \(k\)-core matchings; see Section 4 for details) such that the size of the _intersection_ of the two error sets is \(n^{1-s(1-(1-s)^{2})\mathrm{T}_{\mathrm{c}}(a,b)+\mathrm{o}(1)}\), which is a smaller power of \(n\). This quantifies how synthesizing information across graph matchings can reduce errors and this exponent is precisely what shows up in the first term in (3.2). This observation is important and relevant for Steps 4 and 5 in the algorithm.

On the other hand, the second term in (3.2), which is \(s(1-s)^{2}\mathrm{D}_{+}(a,b)\) for \(K=3\), comes from community recovery. In fact, this term arises from the majority votes in Step 5, where we use only edges in \(G_{1}\). Note that the nodes that are unmatched by \(\widehat{\mu}_{12}\) and \(\widehat{\mu}_{13}\) are, roughly speaking, the isolated nodes in the intersection graphs of \(G_{1}\) and \(G_{2}\), and \(G_{1}\) and \(G_{3}\), respectively. Thus, while we use all edges in \(G_{1}\) in this step, the relevant edges are not present in \(G_{2}\) nor in \(G_{3}\), giving the "effective" factor of \(s(1-s)^{2}\). By (2.1), the exact community recovery threshold for \(\mathrm{SBM}(n,s(1-s)^{2}a\frac{\log n}{n},s(1-s)^{2}b\frac{\log n}{n})\) is \(s(1-s)^{2}\mathrm{D}_{+}(a,b)=1\), giving the second term in (3.2). The following impossibility result shows the tightness of Theorem 1.

**Theorem 2** (Impossibility of exact community recovery).: _Fix constants \(a,b>0\) and \(s\in[0,1]\), and let \((G_{1},G_{2},\ldots,G_{K})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n} {n},s)\). Suppose that either_

\[\left(1-(1-s)^{K}\right)\mathrm{D}_{+}(a,b)<1 \tag{3.3}\]

_or_

\[s\left(1-(1-s)^{K-1}\right)\mathrm{T}_{\mathrm{c}}(a,b)+s(1-s)^{K-1}\mathrm{D} _{+}(a,b)<1. \tag{3.4}\]

_Then exact community recovery is impossible. That is, for any estimator \(\widetilde{\boldsymbol{\sigma}}=\widetilde{\boldsymbol{\sigma}}(G_{1},G_{2}, \ldots,G_{K})\), we have that \(\lim\limits_{n\to\infty}\mathbb{P}\left(\mathsf{ov}\left(\widetilde{ \boldsymbol{\sigma}},\boldsymbol{\sigma^{*}}\right)=1\right)=0\)._

Impossibility of exact community recovery given \(K\) graphs under the condition (3.3) is proved in [41]. Hence, Theorem 2 focuses on proving impossibility for exact community recovery given \(K\) graphs under the condition (3.4). In particular, condition (3.4) reveals a parameter regime where exact community recovery from \((G_{1},G_{2},\ldots,G_{K})\) is impossible, yet, if \(\boldsymbol{\pi}^{*}\) were known, then exact community recovery would be possible based on the (correctly matched) union graph.

Theorems 1 and 2 combined give the tight threshold for exact community recovery for general \(K\) correlated SBMs, see (2.7). Fig. 2 exhibits phase diagrams illustrating the results for three graphs.

### Threshold for exact graph matching

The techniques that we develop in order to prove Theorems 1 and 2 also allow us to solve the question of exact graph matching, that is, exactly recovering \(\boldsymbol{\pi}^{*}=(\pi_{12}^{*},\ldots,\pi_{K}^{*})\) from \((G_{1},G_{2},\ldots,G_{K})\). In the context of correlated SBMs and community recovery, exact graph matching can be thought of as an intermediate step towards exact community recovery. However, more generally, graph matching is a fundamental inference problem in its own right; see Section 5 for discussion of related work. We start with the positive direction in the following theorem.

**Theorem 3** (Exact graph matching from \(K\) correlated SBMs).: _Fix constants \(a,b>0\) and \(s\in[0,1]\), and let \((G_{1},G_{2},\ldots,G_{K})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n} {n},s)\). Suppose that_

\[s\left(1-(1-s)^{K-1}\right)\mathrm{T}_{\mathrm{c}}(a,b)>1. \tag{3.5}\]

_Then exact graph matching is possible. That is, there exists an estimator \(\widehat{\boldsymbol{\pi}}=\widehat{\boldsymbol{\pi}}(G_{1},G_{2},\ldots,G_{K })=(\widehat{\pi}_{12},\ldots,\widehat{\pi}_{1K})\) such that \(\lim_{n\to\infty}\mathbb{P}\left(\widehat{\boldsymbol{\pi}}(G_{1},G_{2}, \ldots,G_{K})=\boldsymbol{\pi}^{*}\right)=1\)._

Since the condition in (3.5) is weaker than \(s^{2}\mathrm{T}_{\mathrm{c}}(a,b)>1\) (which is the threshold for exact graph matching for \(K=2\), as shown in [41]), Theorem 3 implies that there exists a parameter regime where \(\widehat{\pi}_{12}\) cannot be exactly recovered from \((G_{1},G_{2})\), but \(\widehat{\boldsymbol{\pi}}\) can be exactly recovered from \((G_{1},G_{2},\ldots,G_{K})\). In other words, it is necessary to combine information across all graphs in order to recover \(\widehat{\boldsymbol{\pi}}\) (and even just to recover \(\widehat{\pi}_{12}\)).

The estimator \(\widehat{\boldsymbol{\pi}}\) in Theorem 3 is based on pairwise \(k\)-core matchings (see Sec. 4 for further details). Roughly speaking, for each pairwise \(k\)-core matching the number of unmatched vertices is \(n^{1-s^{2}\mathrm{T}_{\mathrm{c}}(a,b)+o(1)}\); however, we shall show that the number of vertices which cannot be matched through some combination of pairwise \(k\)-core matchings is \(n^{1-s\left(1-(1-s)^{K-1}\right)\mathrm{T}_{\mathrm{c}}(a,b)+o(1)}\), which is of smaller order. So, when \(s\left(1-(1-s)^{K-1}\right)\mathrm{T}_{\mathrm{c}}(a,b)>1\), then exact graph matching is possible. The following impossibility result shows the tightness of Theorem 3.

**Theorem 4** (Impossibility of exact graph matching from \(K\) correlated SBMs).: _Fix constants \(a,b>0\) and \(s\in[0,1]\), and let \((G_{1},G_{2},\ldots,G_{K})\sim\mathrm{CSBM}(n,\frac{a\log n}{n},\frac{b\log n}{n},s)\). Suppose that_

\[s\left(1-(1-s)^{K-1}\right)\mathrm{T}_{\mathrm{c}}(a,b)<1. \tag{3.6}\]

_Then exact graph matching is impossible. That is, for any estimator \(\widetilde{\boldsymbol{\pi}}=\widetilde{\boldsymbol{\pi}}(G_{1},G_{2},\ldots,G_ {K})=(\widetilde{\pi}_{12},\ldots\widetilde{\pi}_{1K})\) we have that \(\lim_{n\to\infty}\mathbb{P}\left(\widetilde{\boldsymbol{\pi}}(G_{1},G_{2}, \ldots,G_{K})=\boldsymbol{\pi}^{*}\right)=0\)._

Theorems 3 and 4 combined give the tight threshold for exact graph matching for general \(K\) correlated SBMs, see (2.4). We note that, in independent and concurrent work [5], Ameen and Hajek derived the threshold for exact graph matching from \(K\) correlated Erdos-Renyi random graphs; in other words, they proved Theorems 3 and 4 in the special case of \(a=b\).

Comparing Theorems 3 and 4 with Theorems 1 and 2, note that there exists a parameter regime where exact community recovery is possible even though exact graph matching is impossible.

## 4 Overview of algorithms and proofs

In this section we elaborate on the technical details of the community recovery algorithm, for which high-level ideas were presented in Section 3. We focus our discussion on the setting of \(K=3\) graphs, which already captures the main technical challenges; we highlight these and explain how

Figure 2: Phase diagram for exact community recovery for three graphs with fixed \(s\), and \(a\in[0,40]\), \(b\in[0,40]\) on the axes. _Green region_: exact community recovery is possible from \(G_{1}\) alone; _Cyan region_: exact community recovery is impossible from \(G_{1}\) alone, but exact graph matching of \(G_{1}\) and \(G_{2}\) is possible, and subsequently exact community recovery is possible from \((G_{1},G_{2})\); _Dark Blue region_: exact community recovery is impossible from \(G_{1}\) alone, exact graph matching is also impossible from \((G_{1},G_{2})\), yet exact community recovery is possible from \((G_{1},G_{2})\); _Pink region_: exact community recovery is impossible from \((G_{1},G_{2})\) (even though it would be possible if \(\pi_{12}^{*}\) were known), yet exact community recovery is possible from \((G_{1},G_{2},G_{3})\); _Violet region_: exact community recovery is impossible from \((G_{1},G_{2},G_{3})\) (even though it would be possible from \((G_{1},G_{2})\) if \(\pi_{12}^{*}\) were known); _Light Green region_: exact community recovery is impossible from \((G_{1},G_{2})\), but exact graph matching of graph pairs is possible, and subsequently exact community recovery is possible from \((G_{1},G_{2},G_{3})\); _Grey region_: exact community recovery is impossible from \((G_{1},G_{2})\), exact graph matching is possible from \((G_{1},G_{2},G_{3})\), and subsequently exact community recovery is possible from \((G_{1},G_{2},G_{3})\); _Yellow region_: exact community recovery is impossible from \((G_{1},G_{2})\), exact graph matching is impossible from \((G_{1},G_{2},G_{3})\), yet exact community recovery is possible from \((G_{1},G_{2},G_{3})\); _Orange region_: exact community recovery is impossible from \((G_{1},G_{2},G_{3})\) (even though it would be possible from \((G_{1},G_{2},G_{3})\) if \(\boldsymbol{\pi}^{*}\) were known); _Red region_: exact community recovery is impossible from \((G_{1},G_{2},G_{3})\) (even if \(\boldsymbol{\pi}^{*}\) is known). The principal finding of this paper is the characterization of the Pink, Violet, Orange, Yellow, Grey, and Light Green regions.

we overcome them. We subsequently explain the generalization from \(3\) graphs to \(K\) graphs. The overview of the impossibility proof is discussed as well.

\(k\)**-core matching.** We now define a \(k\)-core matching [13, 22, 43], which is used for almost exact graph matching in Step 2. Given a pair of graphs \((G,H)\) with vertex set \([n]\), for any permutation \(\pi\), we have the corresponding intersection graph \(G\wedge_{\pi}H\), where \((i,j)\) is an edge in the intersection graph if and only if \((i,j)\) is an edge in \(G\) and \((\pi(i),\pi(j))\) is an edge in \(H\). The \(k\)-core estimator explores all possible permutations \(\pi\) of \([n]\) to seek a permutation \(\widehat{\pi}\) that maximizes the size of the \(k\)-core of the intersection graph \(G\wedge_{\pi}H\); recall that the \(k\)-core of a graph is the maximal induced subgraph for which all vertices have degree at least \(k\). The output of the \(k\)-core estimator is then a partial matching \(\widehat{\mu}\), which is the restriction of \(\widehat{\pi}\) to the vertex set of the \(k\)-core in \(G\wedge_{\widehat{\pi}}H\).

One significant advantage of using \(k\)-core matchings is a certain optimality property in terms of performance. Specifically, if \((G_{1},G_{2})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n}{n},s)\), then the \(k\)-core estimator between \(G_{1}\) and \(G_{2}\) fails to match at most \(n^{1-s^{2}T_{e}(a,b)+o(1)}\) vertices, which is the same order as the number of singletons of \(G_{1}\wedge_{\pi_{12}^{*}}G_{2}\) and any graph matching algorithm would fail to match these singletons [11, 41, 22]. Another significant benefit of utilizing \(k\)-core matchings is the correctness of the \(k\)-core estimator for correlated SBMs, as discussed in [22]. The \(k\)-core estimator might not be able to match all vertices under the parameter regime that we are interested in; however, every vertex that it does match is matched correctly with high probability.

**Community recovery subroutines.** The high-level summary of the algorithm is as follows. Since exact community recovery might be impossible in \(G_{1}\) alone, we first obtain an initial estimate which gives almost exact community recovery in \(G_{1}\), as described in Step 1. In Step 2, we use pairwise partial \(k\)-core matchings with \(k=13\) to obtain \(\widehat{\boldsymbol{\mu}}:=\{\widehat{\mu}_{12},\widehat{\mu}_{13},\widehat{ \mu}_{23}\}\) (see Fig. 2(b)), which we will use to combine information across \((G_{1},G_{2},G_{3})\) to recover communities. Note that each partial matching \(\widehat{\mu}_{ij}\) only matches a subset of the vertices, denoted as \(M_{ij}\); we denote the set of vertices not matched by \(\widehat{\mu}_{ij}\) by \(F_{ij}:=[n]\setminus M_{ij}\). Subsequently, we split the vertices into two categories: "good" vertices and "bad" vertices, where "good" vertices are part of at least two matchings and "bad" vertices are part of at most one matching (see Fig. 2(a)). We conduct several majority votes among "good" and "bad" vertices to do the clean-up after the graph matching phase, where each subroutine is meticulously executed to disentangle the intricate dependencies among \((G_{1},G_{2},G_{3})\) and \(\widehat{\boldsymbol{\mu}}\).

**Exact community recovery for the "good" vertices.** The major distinction between being "good" and being "bad" is that "good" vertices can combine information from all three graphs via their union graph (which is denser), whereas "bad" vertices cannot. Suppose that vertex \(i\) is part of \(\widehat{\mu}_{12}\) and \(\widehat{\mu}_{13}\) (i.e., \(i\in M_{12}\cap M_{13}\)). We can then identify the union graph \(G_{1}\vee_{\widehat{\mu}_{12}}G_{2}\vee_{\widehat{\mu}_{13}}G_{3}\), which consists of edges \((i,j)\) such that \((i,j)\) is an edge in \(G_{1}\) or \((\widehat{\mu}_{12}(i),\widehat{\mu}_{12}(j))\) is an edge in \(G_{2}\) or \((\widehat{\mu}_{13}(i),\widehat{\mu}_{13}(j))\) is an edge in \(G_{3}\), and \(i\) is part of this union graph. Similarly, if \(i\in M_{12}\cap M_{23}\), then \(i\) is part of the union graph \(G_{1}\vee_{\widehat{\mu}_{12}}G_{2}\vee_{\widehat{\mu}_{23}\circallows us to quantify the size of \(F_{12}\cap F_{13}\) and meanwhile directly ensure that "good" vertices within the \(k\)-core are only weakly connected with "bad" vertices.

Another hurdle needed to overcome, as stated in [22], concerns the almost exact community recovery in Step 1 which is subsequently used for majority votes. Therefore, it is of great importance to guarantee that the incorrectly-classified vertices are not well-connected and do not have a great impact on majority votes. Consequently, we utilize an algorithm originally developed by Mossel, Neeman, and Sly [35] which allows us to manage the geometry of the misclassified vertices and demonstrate that the vertices classified incorrectly are indeed only weakly connected.

**Exact community recovery for the "bad" vertices.** The remaining step is to label the "bad" vertices. The "bad" vertices can be further classified into three categories (see Fig. 3a): vertices in \(F_{12}\cap F_{13}\), which are only matched by \(\widehat{\mu}_{23}\) or are not matched by any of the three matchings; vertices in \(F_{13}\cap F_{23}\setminus F_{12}\), which are only matched by \(\widehat{\mu}_{12}\); and vertices in \(F_{12}\cap F_{23}\setminus F_{13}\), which are only matched by \(\widehat{\mu}_{13}\).

Consider the vertices in \(F_{12}\cap F_{13}\) (the other cases are similar). First of all, as discussed above, we show that \(|F_{12}\cap F_{13}|=n^{1-s(1-(1-s)^{2})\mathrm{T}_{e}(a,b)+o(1)}\) with high probability. Consider the graph \(G_{1}\setminus_{\widehat{\pi}_{12}}G_{2}\setminus_{\widehat{\pi}_{13}}G_{3}\), which consists of the edges \((i,j)\) in \(G_{1}\) such that \((\widehat{\pi}_{12}(i),\widehat{\pi}_{12}(j))\) and \((\widehat{\pi}_{13}(i),\widehat{\pi}_{13}(j))\) are not edges in \(G_{2}\) and \(G_{3}\), respectively. Due to the approximate independence of \(F_{12}\cap F_{13}\) and \(G_{1}\setminus_{\widehat{\pi}_{12}}G_{2}\setminus_{\widehat{\pi}_{13}}G_{3}\), for a vertex \(i\in F_{12}\cap F_{13}\) we can calculate the probability of the failure of the majority vote in the graph \(G_{1}\setminus_{\widehat{\pi}_{12}}G_{2}\setminus_{\widehat{\pi}_{13}}G_{3}\) in a relatively straightforward manner, giving \(n^{-s(1-s)^{2}\mathrm{D}_{+}(a,b)+o(1)}\). The factor \(s(1-s)^{2}\) arises from the fact that the edges in this graph are subsampled in \(G_{1}\) and are not subsampled in \(G_{2}\) and \(G_{3}\). Now since a vertex in \(F_{12}\cap F_{13}\) can have at most \(12\) edges outside of \(F_{12}\) in \(G_{1}\wedge_{\widehat{\mu}_{12}}G_{2}\), and also at most \(12\) edges outside of \(F_{13}\) in \(G_{1}\wedge_{\widehat{\mu}_{13}}G_{3}\), the majority vote for \(i\in F_{12}\cap F_{13}\) essentially does not change whether it is performed in \(G_{1}\) or in \(G_{1}\setminus_{\widehat{\pi}_{12}}G_{2}\setminus_{\widehat{\pi}_{13}}G_{3}\). Putting all this together, the probability that the majority vote fails is at most:

\[\mathbb{P}(\text{exists a vertex $i\in F_{12}\cap F_{13}$ such that the majority vote fails})\] \[=|F_{12}\cap F_{13}|\times\mathbb{P}(\text{majority vote fails for a vertex})=n^{1-s(1-(1-s)^{2})\mathrm{T}_{e}(a,b)-s(1-s)^{2}\mathrm{D}_{+}(a,b)+o(1)}.\]

Thus, if (3.2) with \(K=3\) holds, then majority vote will correctly classify all vertices in \(F_{12}\cap F_{13}\).

**Generalization to \(K\) graphs.** For \(K\) graphs, we have \(\binom{K}{2}\) pairwise matchings to consider (see Fig. 3b). We again categorize the vertices as "good" and "bad". The "good" vertices can integrate information across all \(K\) graphs through the pairwise partial \(k\)-core matchings \(\{\widehat{\mu}_{ij}:i,j\in[K],i\neq j\}\), while "bad" vertices cannot. To illustrate this concept more vividly, for any vertex \(v\), consider a new "metagraph" \(\mathcal{MG}_{v}\) on \(K\) nodes, defined as follows: there is an edge between \(i\) and \(j\) in \(\mathcal{MG}_{v}\) if and only if \(v\) can be matched through \(\widehat{\mu}_{ij}\) (see Fig. 4). If the metagraph \(\mathcal{MG}_{v}\) is connected, then there exists a path that can connect all of its \(K\) nodes. Equivalently, there exists a set of matchings that allows us to combine information across all \(K\) graphs. Subsequently, we quantify the number of "bad" vertices to be \(n^{1-s(1-(1-s)^{K-1})\mathrm{T}_{e}(a,b)+o(1)}\). The remaining analysis for \(K\) graphs can be derived by generalizing the analysis for three graphs.

**Impossibility proof.** As discussed in Section 3, we focus on the proof of (3.4) for impossibility. We compute the maximum a posterior (MAP) estimator for the communities in \(G_{1}\). We show that, even with significant additional information provided, including all the correct community labels in \(G_{2}\), the true matchings \(\pi^{*}_{ij}\) for \(i,j\in\{2,3,\ldots,K\}\), and most of the true matching \(\pi^{*}_{12}\) except for singletons in the graph \(G_{1}\wedge_{\pi^{*}_{12}}(G_{2}\vee\ldots\lor G_{K})\), the MAP estimator fails to exactly recovery communities with probability bounded away from 0 if (3.4) holds. The proof is adapted from the MAP analysis in [22]. The difference is that here we are considering \(K\) graphs \(G_{1},G_{2},\ldots,G_{K}\) with different additional information provided for the MAP estimator. Given that the MAP estimator is ineffective under this regime, all other estimators also fail.

**Exact graph matching threshold.** The proof of the exact graph matching threshold is implicitly present in the proof of the exact community recovery threshold. Essentially, since we show that the number of "bad" vertices is \(n^{1-s(1-(1-s)^{K-1})\mathrm{T}_{e}(a,b)+o(1)}\), the condition (3.5) implies that there are no "bad" vertices with high probability. Since all vertices are "good", and "good" vertices can integrate information across all \(K\) graphs, the latent matchings can be recovered exactly. For the impossibility result we analyze the MAP estimator and show that, even with significant additional information, including the true matchings \(\{\pi^{*}_{ij}:i,j\in\{2,3,\ldots,K\}\}\), it fails if (3.6) holds.

Related work

Our work generalizes--and solves an open question raised by--the work of Gaudio, Racz, and Sridhar [22]. Just as [22], our work lies at the interface of the literatures on community recovery and graph matching1--two fundamental learning problems--which we briefly summarize here.

Footnote 1: We note that graph matching has both positive and negative societal impacts. In particular, it is well known that graph matching algorithms can be used to de-anonymize social networks, showing that anonymity is different, in general, from privacy [38]. At the same time, studying fundamental limits can aid in determining precise conditions when anonymity can indeed guarantee privacy, and when additional safeguards are necessary.

**Community recovery in SBMs.** A huge research literature exists on learning latent community structures in networks, and this topic is especially well understood for the SBM [25; 15; 34; 35; 33; 36; 2; 3; 7]. Specifically, we highlight the work of [2; 35], which identify the precise threshold for exact community recovery for SBMs with two balanced communities. Our algorithm builds upon their analysis, taking particular care about dealing with the dependencies arising from the multiple inexact partial matchings between \(K\) correlated graphs.

**Graph matching: correlated Erdos-Renyi random graphs.** The past decade has seen a plethora of research on average-case graph matching, focusing on correlated Erdos-Renyi random graphs [40]. The information-theoretic thresholds for recovering the latent vertex correspondence \(\pi^{*}\) have been established for exact recovery [11; 46; 12], almost exact recovery [13], and weak recovery [20; 21; 24; 46; 16]. In parallel, a line of work has focused on algorithmic advances [37; 6; 18; 19; 30; 31; 32], culminating in recent breakthroughs that developed efficient graph matching algorithms in the constant noise setting [31; 32]. We particularly highlight the work of Cullina, Kiyavash, Mittal, and Poor [13], who introduced \(k\)-core matchings and showed their utility for partial matching of correlated Erdos-Renyi random graphs. Subsequent work has shown the power of \(k\)-core matchings as a flexible and successful tool for graph matching [22; 43; 4]. Our work both significantly builds upon these works, as well as further develops this machinery, which may be of independent interest. We also note the independent and concurrent work of Ameen and Hajek which determined the exact graph matching threshold for \(K\) correlated Erdos-Renyi random graphs [5].

**Graph matching: beyond correlated Erdos-Renyi random graphs.** Motivated by real-world networks, a growing line of recent work studies graph matching beyond Erdos-Renyi graphs [8; 26; 9; 42; 49; 41; 22; 45; 43; 17; 48; 47], including for correlated SBMs [29; 39; 28; 41; 22; 48; 47]. The works that are most relevant to ours are [41; 22], which have been discussed extensively above.

## 6 Discussion and Future Work

Our main contribution highlights the power of integrative data analysis for community recovery, yet many open questions still remain.

**Efficient algorithms.** Theorem 1 characterizes when exact community recovery is information-theoretically possible from \(K\) correlated SBMs. Is this possible _efficiently_ (i.e., in time polynomial in \(n\))? The bottleneck in the algorithm that we use to prove Theorem 1, which makes it inefficient, is the \(k\)-core matching step; the other steps are efficient. Recent breakthrough results have developed efficient graph matching algorithms for correlated Erdos-Renyi random graphs [31; 32], which promisingly suggest that an efficient algorithm for exact community recovery may indeed exist in this regime. We refer to [22] for further discussion on this point.

**General block models.** We focused here on the simplest case of SBMs with two balanced communities. It would be interesting to extend these results to general block models with multiple communities. This is understood well in the single graph setting [1] and recent work has also characterized the threshold for exact graph matching for two correlated SBMs with \(k\) symmetric communities [47].

**Alternative constructions of correlated graphs.** An exciting research direction is to study different constructions of correlated graph models. For general \(K\), there are many ways that \(K\) graphs can be correlated. In particular, the following is a natural alternative construction of multiple correlated SBMs. First, generate \(G_{0}\sim\mathrm{SBM}(n,p,q)\). Then, independently generate \(H_{i}\sim\mathrm{SBM}(n,p^{\prime},q^{\prime})\) for \(i\in[K]\). Construct \(G^{\prime}_{i}:=G_{0}\lor H_{i}\), and finally generate \(G_{i}\) through an independent random permutation of the vertex indices in \(G^{\prime}_{i}\). This construction is equivalent to the one we studied in this paper for \(K=2\) and it is different when \(K\geq 3\), and investigating it is interesting and valuable.

## Acknowledgements

We thank Taha Ameen, Julia Gaudio, Elchanan Mossel, and Anirudh Sridhar for helpful discussions. We also thank anonymous reviewers for constructive feedback.

## References

* [1] E. Abbe. Community Detection and Stochastic Block Models: Recent Developments. _Journal of Machine Learning Research_, 18(177):1-86, 2018.
* [2] E. Abbe, A. S. Bandeira, and G. Hall. Exact Recovery in the Stochastic Block Model. _IEEE Transactions on Information Theory_, 62(1):471-487, 2016.
* [3] E. Abbe and C. Sandon. Community detection in general stochastic block models: Fundamental limits and efficient algorithms for recovery. In _2015 IEEE 56th Annual Symposium on Foundations of Computer Science (FOCS)_, pages 670-688. IEEE, 2015.
* [4] T. Ameen and B. Hajek. Robust Graph Matching when Nodes are Corrupt. Preprint available at [https://arxiv.org/abs/2310.18543](https://arxiv.org/abs/2310.18543), 2023.
* [5] T. Ameen and B. Hajek. Exact Random Graph Matching with Multiple Graphs. Preprint available at [https://arxiv.org/abs/2405.12293](https://arxiv.org/abs/2405.12293), 2024.
* [6] B. Barak, C.-N. Chou, Z. Lei, T. Schramm, and Y. Sheng. (Nearly) Efficient Algorithms for the Graph Matching Problem on Correlated Random Graphs. In _Advances in Neural Information Processing Systems (NeurIPS)_, volume 32, pages 9190-9198, 2019.
* [7] C. Bordenave, M. Lelarge, and L. Massoulie. Non-backtracking Spectrum of Random Graphs: Community Detection and Non-regular Ramanujan Graphs. In _Proceedings of the 2015 IEEE 56th Annual Symposium on Foundations of Computer Science (FOCS)_, pages 1347-1357. IEEE, 2015.
* [8] K. Bringmann, T. Friedrich, and A. Krohmer. De-anonymization of Heterogeneous Random Graphs in Quasilinear Time. In _Proceedings of the 22nd Annual European Symposium on Algorithms (ESA)_, pages 197-208, 2014.
* [9] C.-F. Chiasserini, M. Garetto, and E. Leonardi. Social Network De-Anonymization Under Scale-Free User Relations. _IEEE/ACM Transactions on Networking_, 24(6):3756-3769, 2016.
* [10] T. Cour, P. Srinivasan, and J. Shi. Balanced Graph Matching. In _Advances in Neural Information Processing Systems (NeurIPS)_, volume 19, 2006.
* [11] D. Cullina and N. Kiyavash. Improved Achievability and Converse Bounds for Erdos-Renyi Graph Matching. In _ACM SIGMETRICS_, volume 44, pages 63-72, 2016.
* [12] D. Cullina and N. Kiyavash. Exact alignment recovery for correlated Erdos-Renyi graphs. Preprint available at [https://arxiv.org/abs/1711.06783](https://arxiv.org/abs/1711.06783), 2018.
* [13] D. Cullina, N. Kiyavash, P. Mittal, and H. V. Poor. Partial Recovery of Erdos-Renyi Graph Alignment via \(k\)-Core Alignment. In _ACM SIGMETRICS Performance Evaluation Review_, volume 48, pages 99-100. ACM, 2020.
* [14] D. Cullina, K. Singhal, N. Kiyavash, and P. Mittal. On the Simultaneous Preservation of Privacy and Community Structure in Anonymized Networks. Preprint available at [https://arxiv.org/abs/1603.08028](https://arxiv.org/abs/1603.08028), 2016.
* [15] A. Decelle, F. Krzakala, C. Moore, and L. Zdeborova. Asymptotic analysis of the stochastic block model for modular networks and its algorithmic applications. _Physical Review E_, 84(6):066106, 2011.
* [16] J. Ding and H. Du. Matching recovery threshold for correlated random graphs. _The Annals of Statistics_, 51(4):1718-1743, 2023.

* [17] J. Ding, Y. Fei, and Y. Wang. Efficiently matching random inhomogeneous graphs via degree profiles. Preprint available at [https://arxiv.org/abs/2310.10441](https://arxiv.org/abs/2310.10441), 2023.
* [18] J. Ding, Z. Ma, Y. Wu, and J. Xu. Efficient random graph matching via degree profiles. _Probability Theory and Related Fields_, 179(1):29-115, 2021.
* [19] Z. Fan, C. Mao, Y. Wu, and J. Xu. Spectral Graph Matching and Regularized Quadratic Relaxations: Algorithm and Theory. In _Proceedings of the 37th International Conference on Machine Learning (ICML)_, volume 119 of _Proceedings of Machine Learning Research (PMLR)_, pages 2985-2995, 2020.
* [20] L. Ganassali and L. Massoulie. From tree matching to sparse graph alignment. In _Proceedings of the 33rd Conference on Learning Theory (COLT)_, volume 125 of _Proceedings of Machine Learning Research (PMLR)_, pages 1633-1665, 2020.
* [21] L. Ganassali, L. Massoulie, and M. Lelarge. Impossibility of Partial Recovery in the Graph Alignment Problem. In _Proceedings of the 34th Conference on Learning Theory (COLT)_, volume 134 of _Proceedings of Machine Learning Research (PMLR)_, pages 2080-2102, 2021.
* [22] J. Gaudio, M. Z. Racz, and A. Sridhar. Exact Community Recovery in Correlated Stochastic Block Models. In _Proceedings of the 35th Conference on Learning Theory (COLT)_, volume 178 of _Proceedings of Machine Learning Research (PMLR)_, pages 2183-2241, 2022.
* [23] M. Girvan and M. E. J. Newman. Community structure in social and biological networks. _Proceedings of the National Academy of Sciences_, 99(12):7821-7826, 2002.
* [24] G. Hall and L. Massoulie. Partial recovery in the graph alignment problem. _Operations Research_, 71(1):259-272, 2023.
* [25] P. W. Holland, K. B. Laskey, and S. Leinhardt. Stochastic blockmodels: First steps. _Social Networks_, 5(2):109-137, 1983.
* [26] N. Korula and S. Lattanzi. An efficient reconciliation algorithm for social networks. _Proceedings of the VLDB Endowment_, 7(5):377-388, 2014.
* [27] T. Luczak. Size and connectivity of the \(k\)-core of a random graph. _Discrete Mathematics_, 91(1):61-68, 1991.
* [28] V. Lyzinski. Information Recovery in Shuffled Graphs via Graph Matching. _IEEE Transactions on Information Theory_, 64(5):3254-3273, 2018.
* [29] V. Lyzinski, D. L. Sussman, D. E. Fishkind, H. Pao, L. Chen, J. T. Vogelstein, Y. Park, and C. E. Priebe. Spectral clustering for divide-and-conquer graph matching. _Parallel Computing_, 47:70-87, 2015.
* [30] C. Mao, M. Rudelson, and K. Tikhomirov. Random Graph Matching with Improved Noise Robustness. In _Proceedings of the 34th Conference on Learning Theory (COLT)_, volume 134 of _Proceedings of Machine Learning Research (PMLR)_, pages 3296-3329, 2021.
* [31] C. Mao, M. Rudelson, and K. Tikhomirov. Exact matching of random graphs with constant correlation. _Probability Theory and Related Fields_, 186:327-389, 2023.
* [32] C. Mao, Y. Wu, J. Xu, and S. H. Yu. Random Graph Matching at Otter's Threshold via Counting Chandeliers. In _Proceedings of the 55th Annual ACM Symposium on Theory of Computing (STOC)_, pages 1345-1356, 2023.
* [33] L. Massoulie. Community detection thresholds and the weak Ramanujan property. In _Proceedings of the 46th Annual ACM Symposium on Theory of Computing (STOC)_, pages 694-703. ACM, 2014.
* [34] E. Mossel, J. Neeman, and A. Sly. Reconstruction and estimation in the planted partition model. _Probability Theory and Related Fields_, 162:431-461, 2015.
* 24, 2016.
* [36] E. Mossel, J. Neeman, and A. Sly. A proof of the block model threshold conjecture. _Combinatorica_, 38(3):665-708, 2018.
* [37] E. Mossel and J. Xu. Seeded graph matching via large neighborhood statistics. _Random Structures & Algorithms_, 57(3):570-611, 2020.
* [38] A. Narayanan and V. Shmatikov. De-anonymizing Social Networks. In _Proceedings of the 30th IEEE Symposium on Security and Privacy_, pages 173-187. IEEE Computer Society, 2009.
* [39] E. Onaran, S. Garg, and E. Erkip. Optimal de-anonymization in random graphs with community structure. In _2016 50th Asilomar Conference on Signals, Systems and Computers_, pages 709-713. IEEE, 2016.
* [40] P. Pedarsani and M. Grossglauser. On the privacy of anonymized networks. In _Proceedings of the 17th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (KDD)_, pages 1235-1243, 2011.
* [41] M. Z. Racz and A. Sridhar. Correlated Stochastic Block Models: Exact Graph Matching with Applications to Recovering Communities. In _Advances in Neural Information Processing Systems (NeurIPS)_, volume 34, pages 22259-22273, 2021.
* [42] M. Z. Racz and A. Sridhar. Correlated randomly growing graphs. _The Annals of Applied Probability_, 32(2):1058-1111, 2022.
* [43] M. Z. Racz and A. Sridhar. Matching Correlated Inhomogeneous Random Graphs using the \(k\)-core Estimator. In _2023 IEEE International Symposium on Information Theory (ISIT)_, pages 2499-2504, 2023.
* [44] R. Singh, J. Xu, and B. Berger. Global alignment of multiple protein interaction networks with application to functional orthology detection. _Proceedings of the National Academy of Sciences_, 105(35):12763-12768, 2008.
* [45] H. Wang, Y. Wu, J. Xu, and I. Yolou. Random Graph Matching in Geometric Models: the Case of Complete Graphs. In _Proceedings of the 35th Conference on Learning Theory (COLT)_, volume 178 of _Proceedings of Machine Learning Research (PMLR)_, pages 3441-3488, 2022.
* [46] Y. Wu, J. Xu, and S. H. Yu. Settling the Sharp Reconstruction Thresholds of Random Graph Matching. _IEEE Transactions on Information Theory_, 68(8):5391-5417, 2022.
* [47] J. Yang and H. W. Chung. Graph Matching in Correlated Stochastic Block Models for Improved Graph Clustering. In _Proceedings of the 2023 59th Annual Allerton Conference on Communication, Control, and Computing (Allerton)_, pages 1-8. IEEE, 2023.
* [48] J. Yang, D. Shin, and H. W. Chung. Efficient Algorithms for Exact Graph Matching on Correlated Stochastic Block Models with Constant Correlation. In _Proceedings of the 40th International Conference on Machine Learning (ICML)_, volume 202 of _Proceedings of Machine Learning Research (PMLR)_, pages 39416-39452, 2023.
* [49] L. Yu, J. Xu, and X. Lin. The Power of \(D\)-hops in Matching Power-Law Graphs. _Proceedings of the ACM on Measurement and Analysis of Computing Systems_, 5(2):1-43, 2021.

Organization

The rest of the paper is structured as follows. First, we elaborate on the recovery algorithm for three graphs in Section C. Section D includes some useful preliminary propositions, including some nice properties of almost exact community recovery on \(G_{1}\). Section E discusses the \(k\)-core estimator. After these preparations, we are ready to prove the main theorems in the paper.

Section F proves Theorem 1 for three graphs, where we first validate the accuracy of the community labels for "good" vertices and then classify the remaining "bad" vertices. Section G presents the proof of the impossibility result (Theorem 2) for three graphs. Section H discusses the recovery algorithm for \(K\) graphs and provides a general proof for \(K\) graphs, with additional arguments on how to identify "good" and "bad" vertices. Section I discusses the proof of the impossibility result (Theorem 2) for \(K\) graphs. Section J contains the proof of the threshold for exact graph matching given \(K\) graphs, that is, the proofs of Theorems 3 and 4.

## Appendix B Notation

We introduce here some notation that will be used in the rest of the paper. In most of the paper we focus on the setting of \(K=3\) graphs: \((G_{1},G_{2},G_{3})\sim\mathrm{CSBM}(n,a\frac{\log n}{n},b\frac{\log n}{n},s)\), and this is the setting that we consider here as well.

Let \(V:=[n]=\{1,2,3,...,n\}\) denote the vertex set of the parent graph \(G_{0}\), and let \(V^{+}:=\{i\in[n]:\sigma^{*}(i)=+1\}\) and \(V^{-}:=\{i\in[n]:\sigma^{*}(i)=-1\}\) denote the sets of vertices in the two communities. Let \(\binom{[n]}{2}:=\{(i,j):i,j\in[n],i\neq j\}\) denote the set of all unordered vertex pairs. Given a community labeling \(\sigma\in\{+1,-1\}^{n}\), we define the set of intra-community vertex pairs as \(\mathcal{E}^{+}(\sigma):=\{(i,j)\in\binom{[n]}{2}:\sigma(i)=\sigma(j)\}\) and the set of inter-community vertex pairs as \(\mathcal{E}^{+}(\sigma):=\{(i,j)\in\binom{[n]}{2}:\sigma(i)=-\sigma(j)\}\). Note that \(\mathcal{E}^{+}(\sigma)\) and \(\mathcal{E}^{-}(\sigma)\) form a partition of \(\binom{[n]}{2}\).

Let \(A\), \(B\), and \(C\) denote the adjacency matrices of \(G_{1}\), \(G_{2}\), and \(G_{3}\), respectively. Let \(B^{\prime}\) and \(C^{\prime}\) denote the adjacency matrices of \(G^{\prime}_{2}\) and \(G^{\prime}_{3}\), respectively. Note that, by construction, we have for all \((i,j)\in\binom{[n]}{2}\) that \(B^{\prime}_{i,j}=B_{\pi_{12}(i),\pi_{12}^{*}(j)}\) and \(C^{\prime}_{i,j}=C_{\pi_{13}^{*}(i),\pi_{13}^{*}(j)}\). Observe that we have the following probabilities for every \((i,j)\in\binom{[n]}{2}\). If \(a,b,c\in\{0,1\}^{3}\) and \(a+b+c>0\), then

\[\mathbb{P}\left(\left(A_{ij},B^{\prime}_{ij},C^{\prime}_{ij}\right)=(a,b,c) \right)=\begin{cases}s^{a+b+c}(1-s)^{3-a-b-c}&\text{if }\sigma^{*}(i)=\sigma^{*}(j), \\ s^{a+b+c}(1-s)^{3-a-b-c}q&\text{if }\sigma^{*}(i)\neq\sigma^{*}(j).\end{cases}\]

Furthermore, we have that

\[\mathbb{P}\left(\left(A_{ij},B^{\prime}_{ij},C^{\prime}_{ij}\right)=(0,0,0) \right)=\begin{cases}1-p+(1-s)^{3}p&\text{if }\sigma^{*}(i)=\sigma^{*}(j), \\ 1-q+(1-s)^{3}q&\text{if }\sigma^{*}(i)\neq\sigma^{*}(j).\end{cases}\]

## Appendix C The recovery algorithm for three graphs

Our recovery algorithm is based on discovering a matching between subsets of two graphs.

**Definition C.1**.: _Let \(G_{i}\) and \(G_{j}\) be two graphs in vertex set \([n]\) with adjacency matrix \(A,B\), respectively. The pair \((M_{ij},\mu_{ij})\) is a matching between \(G_{i}\) and \(G_{j}\) if_

* \(M_{ij}\in[n]\)_,_
* \(\mu_{ij}:M_{ij}\rightarrow[n]\)_,_
* \(\mu_{ij}\) _is injective._

Given a matching \((M_{ij},\mu_{ij})\), here are some related notations. Define \(G_{i}\vee_{\mu_{ij}}G_{j}\) to be the union graph, whose vertex set is \(M\), whose vertex index is the same as the vertex index of \(G_{i}\) and whose edge set is \(\{\{\ell,m\}:\ell,m\in M_{ij},A_{\ell m}+B_{\mu_{ij}(\ell),\mu_{ij}(m)}\geq 1\}\). In other words, the edges are those that appear in either \(G_{i}\) or \(G_{j}\). Conversely, \(G_{i}\wedge_{\mu_{ij}}G_{j}\) represents intersection graph, whose vertex set is \(M_{ij}\), whose vertex index is the same as the vertex index of \(G_{i}\) and whose edge set is \(\{\{\ell,m\}:\ell,m\in M_{ij},A_{\ell m}=B_{\mu_{ij}(\ell),\mu_{ij}(m)}=1\}\). In other words, the edges are those that appear in both \(G_{i}\) and \(G_{j}\). Define \(G_{i}\setminus_{\mu_{ij}}G_{j}\) to be the graph \(G_{i}\) minus \(G_{j}\), whose vertex set is \(M_{ij}\), whose vertex index is the same as the vertex index of \(G_{i}\) and the edges are those only appear on \(G_{i}\) and not appear in \(G_{j}\).

**Definition C.2**.: _Let \(G_{i}\) and \(G_{j},G_{k}\) be three graphs on vertex set \([n]\) with adjacency matrix \(A,B,C\), respectively. The pair \((M_{ij},\mu_{ij})\) is a matching between \(G_{i}\) and \(G_{j}\), while the pair \((M_{jk},\mu_{jk})\) is a matching between \(G_{j}\) and \(G_{k}\). Denote \(\mu_{jk}\circ\mu_{ij}\) as the composition matching between \(G_{i}\) and \(G_{k}\), defined on the vertex set \(M_{ij}\cap M_{jk}\)._

For three graphs, we can define the additional notations in the same manner as in Definition C.1 and the core concepts remain consistent. \(G_{i}\vee_{\mu_{ij}}G_{j}\vee_{\mu_{jk}\circ\mu_{ij}}G_{k}\) represents the union graph of \(G_{i},G_{j},G_{k}\), whose vertex set is \(M=M_{ij}\cap M_{jk}\), whose vertex index is the same as the vertex index of \(G_{i}\) and whose edge set is \(\{\{\ell,m\}:\ell,m\in M,A_{\ell m}+B_{\mu_{ij}(\ell),\mu_{ij}(m)}+C_{\mu_{jk} \circ\mu_{ij}(\ell),\mu_{jk}\circ\mu_{ij}(m)}\geq 1\}\). In other words, the edge set are the edges that appears in at least one graph out of \(G_{i},G_{j},G_{k}\). Similarly, \(G_{i}\wedge_{\mu_{ij}}G_{j}\wedge_{\mu_{jk}}G_{k}\) represents the intersection graph, the edge set is \(\{\{\ell,m\}:\ell,m\in M;A_{\ell m}=B_{\mu_{ij}(\ell),\mu_{ij}(m)}=C_{\mu_{jk} \circ\mu_{ij}(\ell),\mu_{jk}\circ\mu_{ij}(m)}=1\}\). Define \(G_{i}\vee_{\mu_{ij}}G_{j}\setminus_{\mu_{jk}}G_{k}\) be the graph whose edge set is those edges that appear in either \(G_{i}\) or \(G_{j}\) and not appear in \(G_{k}\). Similarly, we can define \(G_{i}\wedge_{\mu_{ij}}G_{i}\setminus_{\mu_{jk}}G_{k}\), \(G_{i}\setminus_{\mu_{ij}}(G_{i}\vee_{\mu_{jk}}G_{k})\), and \(G_{i}\setminus_{\mu_{ij}}(G_{i}\wedge_{\mu_{jk}}G_{k})\) as well. Note that all the definitions above are defined on vertex set \(M\) and use vertex index in \(G_{i}\).

Introduce \(d_{\min}(G):=\min_{i\in[n]}d(i)\), where \(d(i)\) is the degree of vertex \(i\).

**Definition C.3**.: _A matching \((M_{ij},\mu_{ij})\) is a \(k\)-core matching of \((G_{i},G_{j})\) if \(d_{\min}(G_{i}\wedge_{\mu_{ij}}G_{j})\geq k\). A matching \((M_{ij},\mu_{ij})\) is called a maximal \(k\)-core matching if it involves the greatest number of vertices, among all \(k\)-core matchings._

**Input:** Pair of graphs \(G_{i},G_{j}\) on \(n\) vertices, \(k\in[n]\).

**Output:** A matching \((\widehat{M}_{ij},\widehat{\mu}_{ij})\) of \(G_{i}\) and \(G_{j}\).

```
1: Enumerating all possible matchings, find the maximal \(k\)-core matching \((\widehat{M}_{ij},\widehat{\mu}_{ij})\) of \(G_{i}\) and \(G_{j}\).
```

**Algorithm 1**\(k\)-core matching

Let \((M_{ij},\mu_{ij})\) be the matching found by Algorithm 1 with \(k=13\). \(M_{ij}\) coincides with the maximal \(k\)-core of \(G_{i}\wedge_{\pi^{*}_{ij}}G_{j}\), denote it as \(M^{*}_{ij}\) while \(\mu_{ij}\) coincides with the true permutation \(\pi^{*}_{ij}\), with high probability (Lemma E.5).

The \(k\)-core matching is symmetric, i.e. \(\mu_{ij}(M_{ij})=M_{ji}\). Note that by Definition C.1, \(M_{ij}\) uses the vertex index of \(G_{i}\) while \(M_{ji}\) uses the vertex index of \(G_{j}\), they are equivalent and exchangeable through the 1-1 mapping. Now define \(F_{ij}:=[n]\setminus M_{ij}\) be the set of vertices which are excluded from the matching. Note that \(F_{ij}\) use the vertice index same as \(G_{i}\). We define \(F^{*}_{ij}:=[n]\setminus M^{*}_{ij}\) be the set of vertices which are outside the maximal \(k\)-core of \(G_{i}\wedge_{\pi^{*}_{ij}}G_{j}\).

As briefly discussed in Section 4, we start with leveraging the "good" vertices in order to find the correct communities. The "good" vertices are those which are part of at least two matchings out of three partial matchings \(\mu_{12},\mu_{13},\mu_{23}\). The details are shown in Algorithm 2.

Figure 3: Schematic landscape of partial matchings over three graphs.

[MISSING_PAGE_EMPTY:16]

### Binomial Probabilities

**Lemma D.1**.: _Suppose that \(a\geq b\). Let \(Y\sim\operatorname{Bin}(m^{+},a\log(n)/n)\) and \(Z\sim\operatorname{Bin}(m^{-},b\log(n)/n)\) be independent. If \(m^{+}=(1+o(1))n/2,m^{-}=(1+o(1))n/2\), then for any \(\epsilon>0\),_

\[\mathbb{P}(Y-Z\leq\epsilon\log n)\leq n^{-\mathrm{D}_{+}(a,b)+\epsilon\log(a/b )/2+o(1)}.\]

Proof.: Proved by [22, Lemma 3.3]. 

### A useful construction of three correlated stochastic block models

In this section, we elaborate on an alternative method for constructing three correlated SBMs, which emphasizes the independent regions of \(G_{1},G_{2}\) and \(G_{3}\). we detail the construction for three graphs to maintain reasonable and manageable notation throughout our discussion. The extension of these ideas to the general case of \(K\) graphs follows a similar structure where the key steps and arguments can be directly applied. This construction is analogous to the construction from [22, Section 3.2], generalizing the case from two graphs to three graphs.

Firstly, we construct a random partition \(\{\mathcal{E}_{ijk},i,j,k,\in\{0,1\}\}\) of \({[n]\choose 2}\). Independently, for each pair \(\{i,j\}\in{[n]\choose 2}\), we let \(\{i,j\}\in\{\mathcal{E}_{ijk}\}\) with a probability of \((1-s)^{3-i-j-k}s^{i+j+k}\). Subsequently, for each pair \(\{i,j\}\in{[n]\choose 2}\), an edge is constructed between \(i\) and \(j\) with probability \(p\) if the two vertices are in the same community, and with probability \(q\) if they are in different communities. Graph \(G_{1}\) is constructed using the edges from \(\cup_{j,k\in\{0,1\},i=1}\mathcal{E}_{ijk}\), while the graph \(G^{\prime}_{2}\) is constructed using edges from \(\cup_{i,k\in\{0,1\},j=1}\mathcal{E}_{ijk}\). Graph \(G_{2}\) is then generated from \(G^{\prime}_{2}\) and \(\pi^{*}_{12}\) by relabeling the vertices of \(G^{\prime}_{2}\) according to \(\pi^{*}_{12}\). Similarly, the graph \(G^{\prime}_{3}\) is constructed using edges from \(\cup_{i,j\in\{0,1\},k=1}\mathcal{E}_{ijk}\) and \(G_{3}\) is obtained from \(G^{\prime}_{3}\) and \(\pi^{*}_{13}\) by relabeling the vertices of \(G^{\prime}_{3}\) according to \(\pi^{*}_{13}\). This construction offers an alternative method for generating multiple correlated SBMs and emphasizes regions of independence between the multiple graphs. The following lemma D.2 describes the idea formally.

**Lemma D.2**.: _The random partition construction of correlated SBMs in Section D.2 is equivalent to the original construction shown in Figure 1. Moreover, conditioned on \(\boldsymbol{\pi}^{\star}:=(\pi^{*}_{12},\pi^{*}_{13},\pi^{*}_{23})\), \(\sigma^{\star}\), and \(\boldsymbol{\mathcal{E}}:=\{\mathcal{E}_{ijk},i,j,k\in\{0,1\}\}\), the graphs that are comprised of edges in disjoint \(\mathcal{E}_{ijk}\) are mutually independent._

Proof.: Firstly we show that the distribution of \((A_{i,j},B_{\pi^{*}_{12}(i),\pi^{*}_{12}(j)},C_{\pi^{*}_{13}(i),\pi^{*}_{13}(j )})\) is the same under two constructions. Then by the indepence of vertex pairs, the equivalence follows. In the first construction,

If \(a+b+c>0\):

\[\mathbb{P}((A_{ij},B_{\pi^{*}_{12}(i)\pi^{*}_{12}(j)},C_{\pi^{*}_{13}(i)\pi^{* }_{13}(j)})=(a,b,c)|\boldsymbol{\pi}^{\star},\sigma^{*})\]

\[=\left\{\begin{array}{ll}s^{a+b+c}(1-s)^{3-a-b-c}p&\mbox{if }\sigma^{*}(i)= \sigma^{*}(j),\\ s^{a+b+c}(1-s)^{3-a-b-c}q&\mbox{if }\sigma^{*}(i)\neq\sigma^{*}(j).\end{array}\right.\]

If \(a+b+c=0\):

\[\mathbb{P}((A_{ij},B_{\pi^{*}_{12}(i)\pi^{*}_{12}(j)},C_{\pi^{*}_{13}(i)\pi^{* }_{13}(j)})=(0,0,0)|\boldsymbol{\pi}^{\star},\sigma^{*})\]

\[=\left\{\begin{array}{ll}1-p+(1-s)^{3}p&\mbox{if }\sigma^{*}(i)=\sigma^{*}(j),\\ 1-q+(1-s)^{3}q&\mbox{if }\sigma^{*}(i)\neq\sigma^{*}(j).\end{array}\right.\]

Under the second construction, if \(\sigma^{*}(i)=\sigma^{*}(j)\):

\[\mathbb{P}((A_{ij},B_{\pi^{*}_{12}(i)\pi^{*}_{12}(j)},C_{\pi^{*}_ {13}(i)\pi^{*}_{13}(j)})=(a,b,c)|\boldsymbol{\pi}^{\star},\sigma^{*})=\mathbb{ P}(\{i,j\}\in\mathcal{E}_{abc})\times p\] \[=\left\{\begin{array}{ll}s^{a+b+c}(1-s)^{3-a-b-c}p&\mbox{if }a+b+c>0, \\ 1-p+(1-s)^{3}p&\mbox{if }a+b+c=0.\end{array}\right.\]

If \(\sigma^{*}(i)\neq\sigma^{*}(j)\), the joint distribution is the same only with \(p\) replaced by \(q\). We can see that the joint distribution under two constructions is the same. To prove the second part of the lemma, note that conditioned on \(\boldsymbol{\pi}^{*},\sigma^{*}\), and the random partition \(\{\mathcal{E}_{ijk},i,j,k\in\{0,1\}\}\), the edges in \(\mathcal{E}_{ijk}\) form independently. Hence the graphs that are comprised of edges in disjoint \(\mathcal{E}_{ijk}\) are mutually independent.

**Definition D.3**.: _Define the constant:_

\[s_{abc}:=\left\{\begin{array}{ll}s^{3}&(a,b,c)=(1,1,1),\\ s^{2}(1-s)&(a,b,c)\in\{(0,1,1),(1,0,1),(1,1,0)\},\\ s(1-s)^{2}&(a,b,c)\in\{(0,0,1),(1,0,0),(0,1,0)\},\\ (1-s)^{3}&(a,b,c)=(0,0,0).\end{array}\right.\]

_The event \(\mathcal{F}\) holds if and only if_

\[n/2-n^{3/4}\leq|V^{+}|,|V^{-}|\leq n/2+n^{3/4},\]

_and the following conditions hold for all \(a,b,c\in\{0,1\},i\in[n]\):_

\[s_{abc}(|V^{\sigma^{*}(i)}|-n^{3/4})\leq|\{j:j\in\mathcal{E}_{ abc}\cap\mathcal{E}^{+}(\sigma^{*}(i))\}|\leq s_{abc}(|V^{\sigma^{*}(i)}|+n^{3 /4}),\] \[s_{abc}(|V^{-\sigma^{*}(i)}|-n^{3/4})\leq|\{j:j\in\mathcal{E}_{ abc}\cap\mathcal{E}^{-}(\sigma^{*}(i))\}|\leq s_{abc}(|V^{-\sigma^{*}(i)}|+n^{3 /4}).\]

**Lemma D.4**.: _Define \(s_{m}:=\min_{a,b,c\in\{0,1\}}s_{abc}\). We have \(\mathbb{P}(\mathcal{F}^{c})\leq 100n\exp(-\frac{s_{m}^{2}\sqrt{n}}{2})\)._

Proof.: Denote \(\mathcal{G}\) holds if and only if \(n/2-n^{3/4}\leq|V^{+}|,|V^{-}|\leq n/2+n^{3/4}\). The event \(\mathcal{G}\) is proved in Lemma 3.8 in [22]. \(\mathbb{P}(\mathcal{G}^{c})\leq 4e^{-\sqrt{n}}\).

Then, look at the remaining condition of event \(\mathcal{F}\). Fix \(i\in[n]\), condition on \(\sigma_{1}^{*},\pi_{12}^{*},\pi_{13}^{*}\). Note that

\[k_{abc}^{+}(i):=|\{j:j\in\mathcal{E}_{abc}\cap\mathcal{E}^{+}( \sigma_{1}^{*}(i))\}|\sim\mathrm{Bin}(|V^{\sigma^{*}(i)}|-1,s_{abc}).\]

By Hoeffding inequality we have

\[\mathbb{P}(|k_{abc}^{+}(i)-s_{abc}(|V^{\sigma^{*}(i)}|-1)|\geq \frac{s_{abc}n^{3/4}}{2}|\pi_{12}^{*},\pi_{13}^{*},\sigma_{1}^{*})1(\mathcal{ G})\] \[\leq 2\exp(-\frac{s_{abc}^{2}n^{3/2}}{2|V^{\sigma^{*}(i)}|})1( \mathcal{G})\leq 2\exp(-(1-o(1))s_{abc}^{2}\sqrt{n}).\]

Then by a union bound,

\[\mathbb{P}(\exists i\in[n]:|k_{abc}^{+}(i)-s_{abc}|V^{\sigma^{*} (i)}||\geq s_{abc}n^{3/4})\] \[\leq\sum_{i=1}^{n}\mathbb{P}(|k_{abc}^{+}(i)-s_{abc}(|V^{\sigma^{ *}(i)}|-1)|\geq\frac{s_{abc}n^{3/4}}{2})\] \[\leq\sum_{i=1}^{n}\mathbb{E}[\mathbb{P}(|k_{abc}^{+}(i)-s_{abc}(| V^{\sigma^{*}(i)}|-1)|\geq\frac{s_{abc}n^{3/4}}{2}|\pi_{12}^{*},\pi_{13}^{*}, \sigma_{1}^{*})1(\mathcal{G})]+\mathbb{P}(\mathcal{G}^{c})\] \[\leq 2n\exp(-(1-o(1))s_{abc}^{2}\sqrt{n})+4\exp(-\sqrt{n})\leq 6n \exp(-(1-o(1))s_{m}^{2}\sqrt{n}).\]

Similarly, we can define \(k_{abc}^{-}(i)\) and through an identical proof we have

\[\mathbb{P}(\exists i\in[n]:|k_{abc}^{-}(i)-s_{abc}|V^{-\sigma^{*}(i)}||\geq s _{abc}n^{3/4})\leq 6n\exp(-(1-o(1))s_{m}^{2}\sqrt{n}).\]

The conclusion then follows by a union bound. 

### Almost exact recovery in a single SBM

**Lemma D.5**.: _The algorithm (Algorithm 1, [22]) correctly classifies all vertices in \([n]\setminus I_{\epsilon}(G)\), where \(I_{\epsilon}(G):=\{v\in[n]:\mathbf{maj}_{G}(v)\leq\epsilon\log n\) or \(N(v)>100\max\{1,a,b\}\log n\}\) if \(a>b\)._

Proof.: Directly proved by [22, Lemma 5.1], adapted from [35, Proposition 4.3]. 

**Lemma D.6**.: _Consider a \(\mathrm{SBM}(n,\alpha\log n/n,\beta\log n/n)\), denote \(\gamma=\max(\alpha,\beta)\). Then for every \(\sigma^{*}\) we have_

\[\mathbb{P}(\forall i\in[n],|N(i)|\leq 100\max(1,\gamma)\log n|\sigma^{*})\geq 1 -n^{-99}.\]

Proof.: Directly proved by [22, Lemma 5.2], based on arguments of [35].

**Lemma D.7**.: _With the assumption of \(D_{+}(a,b)<99\), \(E(|I_{\epsilon}(G)|)\leq 3n^{1-D_{+}(a,b)+\epsilon}|\log(a/b)|\)._

Proof.: Proved by [22, Lemma 5.3]. 

**Lemma D.8**.: _If \(0<\epsilon<\frac{\operatorname{D}_{+}(a,b)}{2\log(a/b)}\), then_

\[\mathbb{P}(\forall i\in[n],|N(i)\cap I_{\epsilon}(G)|\leq 2\lceil\operatorname{D }_{+}(a,b)^{-1}\rceil|\sigma^{*})=1-o(1).\]

Proof.: Proved by [22, Lemma 5.4]. 

## Appendix E Analysis of the \(k\)-core estimator

In this section, we prove two important properties of \(k\)-core estimator. Lemma E.4 describes that all vertices have weak connections with those vertices who are not part of the \(k\)-core, in the logarithmic regime that we are interested in. Lemma E.1 argues that all the vertices with degree larger than a given constant will be part of the \(k\)-core.

**Lemma E.1**.: _Fix \(a,b>0\). Consider the graph \(G\sim\operatorname{SBM}(n,\frac{a\log n}{n},\frac{b\log n}{n})\). For any integer \(m\) satisfying \(m>\frac{2}{a+b}\), all vertices whose degree is greater than \(m+k\) are part of the \(k\)-core with high probability._

Proof.: For a given \(m>\frac{2}{a+b}\), we would like to prove that any vertex \(v\) with degree greater than \(k+m\) will not be part of the \(k\)-core with probability \(o(n^{-1})\). The lemma then follows by a union bound.

**Isolating vertex \(v\) for independence.**

For a fixed \(v\in[n]\), consider the graph \(\widetilde{G}:=G\{[n]\setminus v\}\). Now we look at the \(k\)-core of \(\widetilde{G}\), denote it by \(C_{k}(\widetilde{G})\). Since the \(\deg_{G}(v)>k+2/(a+b)\), we can suppose that \(\deg_{G}(v)=m+k,m>2/(a+b)\). If the vertex \(v\) is not part of the \(k\)-core of \(G\), it must has more than \(m\) neighbors who are \(\notin C_{k}(\widetilde{G})\). Note that the event \(w\notin C_{k}(\widetilde{G})\) is independent of the event \(w\in N_{G}(v)\), while the latter event is stochastically dominated by a binomial distribution with probability \(\nu\log n/n,\nu=\max(a,b)\). Hence, by the tower rule,

\[\mathbb{P}(v\text{ is not part of $k$ - core in }G) \leq\mathbb{P}(|\{w\in N_{G}(v):w\notin C_{k}(\widetilde{G})\}|>m)\] \[\leq\mathbb{E}[1_{\operatorname{Bin}(|\{w:w\notin C_{k}( \widetilde{G})\}|,\nu\log n/n)>m}].\] (E.2)

The size of \(\{w:w\notin C_{k}(\widetilde{G})\}\) can not be directly quantified. Hence, we would like to find a set \(\overline{U}\) based on \(\widetilde{G}\) such that \(\{w\in[n]\setminus v:w\notin C_{k}(\widetilde{G})\}\subset\overline{U}\), where we can bound the size of \(\overline{U}\). Now we denote \(\mu=|\overline{U}|\nu\log n/n\), then we have that

\[\mathbb{E}[1_{\operatorname{Bin}(|\{w:w\notin C_{k}(\widetilde{G})\}|,\nu\log n /n)>m}]\leq\mathbb{E}[1_{\operatorname{Bin}(|\overline{U}|,\nu\log n/n)>m}] \leq\mathbb{E}[\min_{t>0}\exp(\mu(e^{t}-1)-tm)].\] (E.3)

To construct \(\overline{U}\), the idea is motivated by Luczak expansion in [27]. We consider a modified version of expanding the set in our setting.

**Quantify the set \(U\).**

Define \(U\) to be the set of vertices with degree at most \(T\) in the graph \(\widetilde{G}\). The choice of \(T\) would be specified later. Denote \(\mathcal{H}:=\{n/2-n^{3/4}\leq|V^{+}|,|V^{-}|\leq n/2+n^{3/4}\}\). By Lemma D.4,

[MISSING_PAGE_EMPTY:20]

[MISSING_PAGE_FAIL:21]

Proof.: Proved by [22, Lemma 4.13]. 

**Lemma E.7**.: _Suppose \(G_{1},G_{2},G_{3}\) are independently subsampled with probability \(s\) from a parent graph \(G\sim\mathrm{SBM}(n,a\log n/n,b\log n/n)\) for \(a,b>0\). Let \(F^{*}_{ij}\) be the set of vertices outside the \(k\)-core of \(G_{i}\wedge_{\pi_{ij}}G_{j}\)(taking vertex index in \(i\)) with \(k=13\). Prove that with probability \(1-o(1)\), \(|F^{*}_{ij}\cap F^{*}_{jk}|\leq n^{1-(2s^{2}-s^{3})\mathrm{T}_{c}(a,b)+\delta}\), for any \(\delta>0\)._

Proof.: \(|F^{*}_{12}\cap F^{*}_{23}|=|F^{*}_{21}\cap F^{*}_{23}|=|F^{*}_{12}\cap F^{*}_{ 13}|\), by symmetricity of \(G_{1},G_{2},G_{3}\).

Define \(U_{ij}\) to be the set of vertices with degree at most \(m+k\) in the intersection graph \(G_{i}\wedge_{\pi_{ij}}G_{j}\) which marginally follows \(\mathrm{SBM}(n,\frac{as^{2}\log n}{n},\frac{bs^{2}\log n}{n})\), and \(m\) is an integer satisfying \(m>\frac{2}{s^{2}(a+b)}\). Then by Lemma E.1, w.h.p., \(F^{*}_{ij}\subset U_{ij}\). Hence \(|F^{*}_{12}\cap F^{*}_{23}|\leq|U_{12}\cap U_{23}|\) with high probability.

It thus remains to bound \(|U_{12}\cap U_{13}|\). Firstly, we bound the expectation of \(|U_{12}\cap U_{13}|\):

\[\mathbb{E}[|U_{12}\cap U_{13}|]=\sum_{v=1}^{n}\mathbb{E}[\mathbf{1}_{v\in U_{12} \cap U_{13}}]=n\mathbb{E}[\mathbf{1}_{v\in U_{12}}\mathbf{1}_{v\in U_{13}}].\]

Let \(D_{1}\) denote the degree of vertex \(v\) in the graph \(G_{1}\). Let \(X_{a}\sim\text{Bin}((1+o(1))n/2,sa\log n/n)\), and \(X_{b}\sim\text{Bin}((1+o(1))n/2,sb\log n/n)\). On the event \(\mathcal{F},D_{1}\overset{d}{=}X_{a}+X_{b}\), where \(\mathcal{F}\) is defined in Definition D.3, \(X_{a},X_{b}\) are independent. Note that by Lemma D.4, \(\mathbb{P}(\mathcal{F}^{c})=o(\frac{1}{n^{2}})\). We have

\[\mathbb{E}[\mathbf{1}_{v\in U_{12}}\mathbf{1}_{v\in U_{13}}] =\mathbb{E}[\mathbb{E}[\mathbf{1}_{v\in U_{12}}\mathbf{1}_{v\in U _{13}}|D_{1}]]=\mathbb{E}\left[\binom{m+k}{i}\binom{D_{1}}{i}s^{i}(1-s)^{D_{1} -i}\right]^{2}\] \[=\sum_{i=0}^{m+k}\sum_{j=0}^{m+k}C(i,j)\mathbb{E}[D_{1}^{i+j}(1-s) ^{2D_{1}}].\] (E.8)

Here \(C(i,j)\) is a constant related to \(i,j\). Now look at \(\mathbb{E}[D_{1}^{L}(1-s)^{2D_{1}}]\). In our regime, \(L\leq 2(m+k)\) are constant. Hence:

\[\mathbb{E}[D_{1}^{L}(1-s)^{2D_{1}}\mathbf{1}_{\mathcal{F}}] =\mathbb{E}[(X_{a}+X_{b})^{L}(1-s)^{2X_{a}}(1-s)^{2X_{b}}\mathbf{1 }_{\mathcal{F}}]\] \[=\sum_{t=0}^{K}C_{t}\mathbb{E}[X_{a}^{t}(1-s)^{2X_{a}}\mathbf{1}_ {\mathcal{F}}]\mathbb{E}[X_{b}^{L-t}(1-s)^{2X_{a}}\mathbf{1}_{\mathcal{F}}].\] (E.9)

Here \(C_{t}\) is constant related to \(t\), the second equality is due to the independence of \(X_{a},X_{b}\). Now look at \(\mathbb{E}[X_{a}^{t}(1-s)^{2X_{a}}\mathbf{1}_{\mathcal{F}}]\).

\[\mathbb{E}[X_{a}^{t}(1-s)^{2X_{a}}\mathbf{1}_{\mathcal{F}}] \leq\mathbb{E}[X_{a}^{t}(1-s)^{2X_{a}}]\] \[=\sum_{\ell=0}^{(1+o(1))n/2}\ell^{\prime}(1-s)^{2\ell}(\frac{sa \log n}{n})^{\ell}(1-\frac{sa\log n}{n})^{(1+o(1))n/2-\ell}\] \[=\sum_{\ell=0}^{(\log n)^{3}}\ell^{\prime}(\frac{(1-s)^{2}sa\log n }{n})^{\ell}(1-\frac{sa\log n}{n})^{(1+o(1))n/2-\ell}\] \[\quad+\sum_{\ell=(\log n)^{3}+1}^{(1+o(1))n/2}\ell^{\prime}(\frac {(1-s)^{2}sa\log n}{n})^{\ell}(1-\frac{sa\log n}{n})^{(1+o(1))n/2-\ell}.\]

We can bound the first part:

\[\sum_{\ell=0}^{(\log n)^{3}}\ell^{\prime}(\frac{(1-s)^{2}sa\log n }{n})^{\ell}(1-\frac{sa\log n}{n})^{(1+o(1))n/2-\ell}\] \[\leq (\log n)^{3t}\sum_{\ell=0}^{(\log n)^{3}}(\frac{(1-s)^{2}sa\log n }{n})^{\ell}(1-\frac{sa\log n}{n})^{(1+o(1))n/2-\ell}\] \[\leq (\log n)^{3t}\sum_{\ell=0}^{(1+o(1))n/2-\ell}(\frac{(1-s)^{2}sa \log n}{n})^{\ell}(1-\frac{sa\log n}{n})^{(1+o(1))n/2-\ell}\] \[= (\log n)^{3t}(1-(1-(1-s)^{2})\frac{sa\log n}{n})^{(1+o(1))n/2} \leq n^{-(1-(1-s)^{2})sa/2+o(1)}\]

Then we can bound the second part, note that

\[\sum_{\ell=(\log n)^{3}+1}^{(1+o(1))n/2}\ell^{\prime}(\frac{(1-s )^{2}sa\log n}{n})^{\ell}(1-\frac{sa\log n}{n})^{(1+o(1))n/2-\ell}\] \[\qquad\qquad=\sum_{\ell=(\log n)^{3}+1}^{(1+o(1))n/2}\ell^{ \prime}(1-s)^{2\ell}\mathbb{P}(X_{a}=\ell)\leq(\log n)^{3t}(1-s)^{2(\log n)^ {3}}\mathbb{P}(X_{a}>(\log n)^{3})\] \[\qquad\qquad\leq n^{2(\log n)^{2}\log(1-s)+o(1)}=o(n^{-(1-(1-s)^{ 2})sa/2+o(1)}).\]

[MISSING_PAGE_FAIL:24]

Similarly, we have w.h.p.

\[|N_{G_{2}\wedge G_{3}}(\pi_{12}^{*}(i)\cap F_{23}^{*})|<\epsilon\log n/8.\]

What is left is to bound \(|N_{G^{*}\setminus(G_{2}\wedge G_{3})}(i)\cap(F_{23}^{*})|,|N_{G^{*}\setminus(G_ {1}\wedge G_{2})}(i)\cap(F_{12}^{*})|\).

Note that conditioned on \(\pi_{12}^{*},\pi_{13}^{*},\pi_{23}^{*},\sigma^{*},\boldsymbol{\mathcal{E}}:=\{ \mathcal{E}_{ijk},i,j,k\in\{0,1\}\}\), the graph \(G^{*}\setminus(G_{1}\wedge G_{2})\) is independent of \(F_{12}^{*}\) by Lemma D.2, since \(F_{12}^{*}\) depends only on \(G_{1}\wedge G_{2}\). Thus we can stochastically dominate \(|N_{G^{*}\setminus(G_{1}\wedge G_{2})}(i)\cap F_{12}^{*}|\) by a Poisson random variable X with mean

\[\lambda_{n}:=\nu\frac{\log n}{n}|\{j\in F_{12}^{*}:\{i,j\}\in\mathcal{E}_{100 }\cup\mathcal{E}_{101}\cup\mathcal{E}_{001}\cup\mathcal{E}_{010}\cup\mathcal{ E}_{011}\}|\leq\nu\frac{\log n}{n}|F_{12}^{*}|,\nu:=max(a,b).\]

For a fixed \(\delta>0\), define an event \(\mathcal{Z}:=\{|F_{12}^{*}|\leq n^{1-s^{2}\mathrm{T}_{c}(a,b)+\delta}\}\). On \(\mathcal{Z}\), we have that \(\lambda_{n}\leq n^{-s^{2}\mathrm{T}_{c}(a,b)+\delta+o(1)}\). Hence, for any positive integer m:

\[\mathbb{P}(\{|N_{G^{*}\setminus(G_{1}\wedge G_{2})}(i)\cap(F_{12} ^{*})|\geq m\}\cap\mathcal{Z})\leq\mathbb{P}(\{X\geq m\}\cap\mathcal{Z})= \mathbb{E}[\mathbb{P}(X\geq m|F_{12}^{*},\boldsymbol{\mathcal{E}},\sigma^{*}, \boldsymbol{\pi^{*}})\mathbf{1}_{\mathcal{Z}}]\\ \leq\mathbb{E}[(\inf_{\theta>0}e^{-\theta m+\lambda_{n}(e^{\theta -1})})\mathbf{1}_{\mathcal{Z}}]\leq\mathbb{E}[e\lambda_{n}^{m}\mathbf{1}_{ \mathcal{Z}}]\leq n^{-m(s^{2}\mathrm{T}_{c}(a,b)-\delta-o(1))}.\]

Above, the equality on the second line is due to the tower rule and since \(\mathcal{Z}\) is measurable with respect to \(|F_{12}^{*}|\), the inequality on the third line is due to a Chernoff bound; the inequality on the fourth line follows from setting \(\theta=\log(1/\lambda_{n})\) (which is valid since \(\lambda_{n}=o(1)\) if \(\mathcal{Z}\) holds). The final inequality uses the upper bound for \(\lambda_{n}\) on \(\mathcal{Z}\). Taking a union bound, we have

\[\mathbb{P}(\{\exists i\in[n],|N_{G^{*}\setminus(G_{2}\wedge G_{1})}(i)\cap F_{ 12}^{*}|\geq m\}\cap\mathcal{Z})\leq n^{1-m(s^{2}\mathrm{T}_{c}(a,b)-\delta-o (1))}.\]

Here if we take \(m>(s^{2}\mathrm{T}_{c}(a,b))^{-1}\) and \(\delta<s^{2}\mathrm{T}_{c}(a,b)-m^{-1}\), the probability turns to \(o(1)\). Thus, we can set \(m=\lceil(s^{2}\mathrm{T}_{c}(a,b))^{-1}\rceil+1\). In light of Lemma E.6, \(|F_{12}^{*}|\leq n^{1-s^{2}\mathrm{T}_{c}(a,b)+\delta},\delta>0\) w.h.p. Hence, the event \(\mathcal{Z}\) happens with probability \(1-o(1)\). Hence we have

\[\mathbb{P}(\{\forall i\in[n],N_{G^{*}\setminus(G_{2}\wedge G_{1})}(i)\cap F_{1 2}^{*}|\leq\lceil(s^{2}\mathrm{T}_{c}(a,b))^{-1}\rceil\})=1-o(1).\]

By an identical proof, we have that

\[\mathbb{P}(\{\forall i\in[n],N_{G^{*}\setminus(G_{2}\wedge G_{3})}(i)\cap F_{2 3}^{*}|\leq\lceil(s^{2}\mathrm{T}_{c}(a,b))^{-1}\rceil\})=1-o(1).\]

Hence we have, with probability \(1-o(1)\), for \(i\in M_{12}^{*}\cap M_{23}^{*}\),

\[|\mathsf{maj}_{H}(i)-\mathsf{maj}_{G_{1}\vee_{\pi_{12}^{*}}G_{2}\vee_{\pi_{13} ^{*}}G_{3}}(i)|<\epsilon\log n,\]

and hence with probability \(1-o(1)\),

\[\mathsf{maj}_{H}(i)>\epsilon\log n.\]

Then by Lemma E.5, we can replace \(H\) with \(\widetilde{G}\), \(F_{ij}^{*}\) with \(F_{ij}\), the lemma follows. 

Next, prove that each vertex in \(G_{2}\vee_{\pi_{23}^{*}}G_{3}\setminus_{\pi_{12}^{*}}G_{1}\) has a small number of neighbors in \(\pi_{12}^{*}(I_{\epsilon}(G_{1}))\)

**Lemma F.4**.: _If \(0<\epsilon\leq\frac{s\mathrm{D}_{+}(a,b)}{4\lfloor\log(a/b)\rfloor}\), then_

\[\mathbb{P}(\forall i\in[n],|N_{G_{2}\vee_{\pi_{23}^{*}}G_{3}\setminus_{\pi_{12 }^{*}}G_{1}}(i)\cap\pi_{12}^{*}(I_{\epsilon}(G_{1}))|\leq 2\lceil(s \mathrm{D}_{+}(a,b))^{-1}\rceil)=1-o(1).\]

Proof.: Since \(I_{\epsilon}(G_{1})\) depends on \(G_{1}\) alone, it follows that \(I_{\epsilon}(G_{1})\) and \(G_{2}\vee_{\pi_{23}^{*}}G_{3}\setminus_{\pi_{12}^{*}}G_{1}\) are conditionally independent given \(\boldsymbol{\pi^{*}},\sigma^{*},\boldsymbol{\mathcal{E}}\). Hence we can stochastically dominate \(|N_{G_{2}\vee_{\pi_{23}^{*}}G_{3}\setminus_{\pi_{12}^{*}}G_{1}}(i)\cap\pi_{12 }^{*}(I_{\epsilon}(G_{1}))|\) by a Poisson random variable X with mean \(\lambda_{n}\) given by

\[\lambda_{n}:=\nu\log n/n|\{j\in I_{\epsilon}(G_{1}):\{i,j\}\in\mathcal{E}_{01 1}\cup\mathcal{E}_{010}\cup\mathcal{E}_{001}\}|\leq\nu\log n/n|I_{\epsilon}(G _{1})|.\]

Next, define the event \(\mathcal{Z}:=\{|I_{\epsilon}(G_{1})|\leq n^{1-s\mathrm{D}_{+}(a,b)+2\epsilon| \log(a/b)|}\}\).

Notice that \(P(\mathcal{Z})=1-o(1)\) by Lemma D.7 and Markov's inequality, provided \(s\mathrm{D}_{+}(a,b)<99\). Following identical arguments as the proof of Lemma F.2, we arrive at

\[\mathbb{P}(\exists i\in[n],|N_{G_{2}\vee_{\pi_{23}^{*}}G_{3}\setminus_{\pi_{12} ^{*}}G_{1}}(i)\cap\pi_{12}^{*}(I_{\epsilon}(G_{1}))|\geq m)=o(1),\]

when \(m>\lceil(s\mathrm{D}_{+}(a,b)-2\epsilon|\log a/b|)^{-1}\rceil\). If \(\epsilon\leq\frac{s\mathrm{D}_{+}(a,b)}{4\lfloor\log(a/b)\rfloor}\), it suffices to set \(m=2\lceil(s\mathrm{D}_{+}(a,b))^{-1}\rceil+1\).

[MISSING_PAGE_FAIL:26]

By the tower rule, rewrite the term in the right hand side as:

\[\mathbb{E}[\mathbb{P}(E_{i}^{*}|\pi^{*},\sigma^{*},\boldsymbol{\mathcal{E}},F_{b}^{ *})\mathbf{1}_{i\in F_{b}^{*}}\mathbf{1}_{\{|F_{b}^{*}|\leq n^{1-(2s^{2}-s) \mathrm{T}_{\mathrm{c}}(a,b)+\delta\}\cap\mathcal{F}\}}].\] (F.8)

Now look at \(\mathbb{P}(E_{i}^{*}|\pi^{*},\sigma^{*},\boldsymbol{\mathcal{E}},F_{b}^{*})\). Conditional on \(\boldsymbol{\mathcal{E}},\sigma^{*},\pi^{*}\), \(\mathsf{maj}_{H_{i}}(i):\stackrel{{ d}}{{=}}Y-Z\), where \(Y,Z\) are independent with:

\[Y\sim Bin(|j\in M_{12}^{*}\cup M_{13}^{*}:\{i,j\}\in\mathcal{E}_{100}\cap \mathcal{E}^{+}(\sigma^{*})|,a\log n/n),\]

\[Z\sim Bin(|j\in M_{12}^{*}\cup M_{13}^{*}:\{i,j\}\in\mathcal{E}_{100}\cap \mathcal{E}^{-}(\sigma^{*})|,b\log n/n).\]

By Definition D.3 of the event \(\mathcal{F}\), we know that \(|j\in M_{12}^{*}\cup M_{13}^{*}:\{i,j\}\in\mathcal{E}_{100}\cap\mathcal{E}^{- }(\sigma^{*})|=(1-o(1))s(1-s)^{2}n/2\) and \(|j\in M_{12}^{*}\cup M_{13}^{*}:\{i,j\}\in\mathcal{E}_{100}\cap\mathcal{E}^{+ }(\sigma^{*})|=(1-o(1))s(1-s)^{2}n/2\).

Lemma D.1 implies

\[\mathbb{P}(E_{i}^{*}|\pi^{*},\sigma^{*},\boldsymbol{\mathcal{E}},F_{b}^{*}) \mathbf{1}_{i\in F_{b}^{*}}\mathbf{1}_{\{|F_{b}^{*}|\leq n^{1-(2s^{2}-s^{3}) \mathrm{T}_{\mathrm{c}}(a,b)+\delta\}\cap\mathcal{F}\}}\leq n^{-s(1-s)^{2} \mathrm{D}_{+}(a,b)+\epsilon^{\prime}\log(a/b)/2+o(1)}.\]

Follow (F.8) and take a union bound, we have

\[\sum_{i=1}^{n}\mathbb{P}(\{i\in F_{b}^{*}\}\cap E_{i}^{*}\cap\{F_ {b}^{*}\leq n^{1-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+\delta\}\cap \mathcal{F}\}+o(1)\] \[\leq n^{-s(1-s)^{2}\mathrm{D}_{+}(a,b)+\epsilon^{\prime}\log(a/b)/2+o (1)}\mathbb{E}[|F_{b}^{*}|\mathbf{1}_{F_{b}^{*}\leq n^{1-(2s^{2}-s^{3})\mathrm{ T}_{\mathrm{c}}(a,b)+\delta}}]\] \[\leq n^{1-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)-s(1-s)^{2} \mathrm{D}_{+}(a,b)+\epsilon^{\prime}\log(a/b)/2+\delta+o(1)}.\]

Under the condition \((2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+s(1-s)^{2}\mathrm{D}_{+}(a,b)>1\), we can choose \(\epsilon^{\prime},\delta\) small enough so that the right hand side is \(o(1)\). \(\mathsf{maj}_{H_{i}}(i)>\epsilon^{\prime}\log n\) for \(i\in F_{b}^{*}\), by Lemma E.5, \(\mathsf{maj}_{\widetilde{H_{i}}}(i)>\epsilon^{\prime}\log n\) for \(i\in F_{b}\).

Suppose that \(i\in F_{13}\cap F_{12}\), has at most 12 neighbors in the graph \((G_{1}\wedge_{\pi_{12}^{*}}G_{2})\{(M_{12}\cap M_{13})\cup\{i\}\}\), and in the graph \((G_{1}\wedge_{\pi_{13}^{*}}G_{3})\{(M_{12}\cap M_{13})\cup\{i\}\}\). Therefore, i has an at least \((\epsilon^{\prime}\log n-24)\) majority in \(G_{1}\{(M_{12}\cap M_{13})\cup\{i\}\}\), with high probability. Then, Algorithm 3 correctly label all vertices in 

### Notation

Here we review and introduce some notations in brief.

\(\sigma_{i}^{*}:=\) the ground truth community labels in \(G_{i},i=1,2,3\),

\(V_{i}^{+}:=\{j\in[n]:\sigma_{i}^{*}(j)=+1\},V_{i}^{-}:=\{j\in[n]:\sigma_{i}^{*}(j )=-1\},\)

\(\sigma_{2}^{i}(\pi_{12}^{*}(i))=\sigma_{1}^{*}(i)\),

here we have \(V_{2}^{+}=\pi_{12}^{*}(V_{1}^{+})\).

### The MAP estimator

First define the singleton set of a permutation \(\pi\) with respect to the adjacency matrices \(A\), \(B\), and \(C\) to be:

\[R(\pi,A,B,C):=\{i\in[n]:\forall j\in[n],A_{i,j}D_{\pi(i),\pi(j)}=0\},\]

where \(D_{ij}:=\max\{B_{ij},C_{\pi_{23}^{*}(i)\pi_{23}^{*}(j)}\}\). For brevity, write \(R_{\pi}:=R(\pi,A,B,C)\).

**Definition G.2**.: _Define the set \(S(\pi,A,B,C)\) as followings:_

1. \(i\in R(\pi,A,B,C)\)_;_
2. \(i\) _is a singleton in_ \(G_{1}\{R_{\pi}\}\)_;_
3. _If_ \(j\in N_{1}(i)\)_,_ \(\pi(j)\notin N_{H}(\pi(R_{\pi}))\)_._

Where \(A,B,C\) is the adjacency matrix of \(G_{1},G_{2},G_{3}\) respectively and \(D\) is the adjacency matrix in \(H=G_{2}\vee_{\pi_{23}^{*}}G_{3}\). Note that \(D\) is the adjacency matrix of \(H\), so \(N_{H}(\pi(R_{\pi}))=\{i\in[n]:\exists k\in\pi(R_{\pi}),D_{i,k}=1\}\).

Define \(\bar{R}_{\pi}:=R_{\pi}\cup\pi^{-1}(N_{H}(\pi(R_{\pi})))\). The condition 2 and 3 in Definition G.2 can be replaced by \(A_{i,j}=0\) for all \(j\in\bar{R}_{\pi}\). Write \(R^{*}=R(\pi_{12}^{*},A,B,C)\), \(S^{*}=S(\pi_{12}^{*},A,B,C)\), and \(\bar{R}^{*}=\bar{R}_{\pi_{12}^{*}}\) for brevity. We study the MAP estimate provided the additional knowledge \(\sigma_{2}^{*}\), \(\pi_{23}^{*}\), and \(\pi_{12}^{*}\{[n]\setminus S^{*}\}\).

**Theorem 5**.: _Let \(A,B,C,\sigma_{2}^{*},\pi_{23}^{*},\pi_{12}^{*}\{[n]\setminus S^{*}\},S^{*}\) be given. For \(i\in[n]\setminus S^{*},\widehat{\sigma}_{MAP}(i)=\sigma_{2}^{*}(\pi_{12}^{*}(i))\). For vertices in \(S^{*}\), the MAP estimator depends on whether \(a,b\) is larger: 1. If \(a>b\), then the MAP estimator assigns the label +1 to the vertices corresponding to the largest \(|S^{*}\cap V_{1}^{+}|\) values in the collection \(\{\mathsf{maj}(i)\}_{i\in S^{*}}\) and assigns the label -1 to the remaining vertices in \(S^{*}\). 2. If \(a<b\), then the MAP estimator assigns the label +1 to the vertices corresponding to the smallest \(|S^{*}\cap V_{1}^{+}|\) values in the collection \(\{\mathsf{maj}(i)\}_{i\in S^{*}}\) and assigns the label -1 to the remaining vertices in \(S^{*}\)._

Then the following corollary prove the potential failure of the MAP estimator.

**Corollary G.3**.: _If \(a>b\), there exists \(i\in S^{*}\cap V_{1}^{+},j\in S^{*}\cap V^{-}\) such that \(\mathsf{maj}(i)<\mathsf{maj}(j)\), then the MAP estimator fails. Similarly, if \(a<b\), there exists \(i\in S^{*}\cap V_{1}^{+},j\in S^{*}\cap V^{-}\) such that \(\mathsf{maj}(i)>\mathsf{maj}(j)\), then the MAP estimator fails._

Proof.: Suppose \(a>b\). If the MAP estimator classifies \(i\) as \(+1\) correctly. By Theorem 5 the MAP estimator classifies \(j\) as \(+1\) which is wrong. The argument for the case \(a<b\) is similar. 

### The analysis of the failure of MAP estimator

**Definition G.4**.: _The event \(G_{\delta}\) holds if and only if_

\[n^{1-(2s^{2}-s^{3})T_{c}(a,b)-\delta}\leq|R^{*}\cap V_{1}^{+}|,|R^{*}\cap V_{1 }^{-}|,|\bar{R}^{*}\cap V_{1}^{+}|,|\bar{R}^{*}\cap V_{1}^{+}|\leq n^{1-(2s^ {2}-s^{3})T_{c}(a,b)+\delta}.\]

**Lemma G.5**.: _For any fixed \(\delta>0\), \(\mathbb{P}(G_{\delta})=1-o(1)\)._

The proof of this lemma is straightforward but tedious and we defer it to Section G.6.

Now define the variable \(W_{i}\):

\[W_{i}:=\begin{cases}1(i\in S^{*},\mathsf{maj}(i)<0),&i\in R^{*}\cap V_{1}^{+}, \\ 1(i\in S^{*},\mathsf{maj}(i)>0),&i\in R^{*}\cap V_{1}^{-}.\end{cases}\] (G.6)Denote \(\mathcal{I}\) be the sigma algebra induced by the random variables

\[D=\max(B,C),\pi_{12}^{*},\sigma_{1}^{*},R^{*},\{\mathcal{E}_{abc}:a,b,c\in\{0,1\}\}.\]

Note that \(\bar{R}^{*},\bar{R}^{*}\cap V_{1}^{+},\bar{R}^{*}\cap V_{1}^{-}\) are \(\mathcal{I}\) measurable.

Now \(\Gamma\)d like to show that \(\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}>0,\sum_{i\in R^{*}\cap V_{1}^{-}}W_{i}>0\) with high probability, then it follows that \(\exists i\in S^{*}\cap V_{1}^{+},j\in S^{*}\cap V_{1}^{-}\) such that \(\mathsf{mj}(i)<0<\mathsf{mj}(j)\). By Corollary G.3, the MAP estimator fails. Use the first and second method to analyze \(\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i},\sum_{i\in R^{*}\cap V_{1}^{-}}W_{i}\):

**Lemma G.7**.: _Fix \(\delta>0\) and denote \(\theta:=1-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)-s(1-s)^{2}\mathrm{D}_{+ }(a,b)\). We have_

\[\mathbb{E}[\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}|\mathcal{I}]1(\mathcal{F}\cap \mathcal{G}_{\delta}) \geq(1-n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+2\delta})n^ {\theta-\delta-o(1)}1(\mathcal{F}\cap\mathcal{G}_{\delta})\]

_and_

\[\mathbb{E}[\sum_{i\in R^{*}\cap V_{1}^{-}}W_{i}|\mathcal{I}]1(\mathcal{F}\cap \mathcal{G}_{\delta}) \geq(1-n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+2\delta})n^ {\theta-\delta-o(1)}1(\mathcal{F}\cap\mathcal{G}_{\delta}).\]

**Lemma G.8**.: _Fix \(\delta>0\) and denote \(\theta:=1-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)-s(1-s)^{2}\mathrm{D}_{+ }(a,b)\)_

\[\mathrm{Var}(\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}|\mathcal{I})1(\mathcal{F}\cap \mathcal{G}_{\delta})\leq n^{2\theta-3\delta}1(\mathcal{F}\cap\mathcal{G}_{ \delta})\]

_and_

\[\mathrm{Var}(\sum_{i\in R^{*}\cap V_{1}^{-}}W_{i}|\mathcal{I})1(\mathcal{F} \cap\mathcal{G}_{\delta})\leq n^{2\theta-3\delta}1(\mathcal{F}\cap\mathcal{G} _{\delta}).\]

The proofs of these two lemmas are deferred to Section G.7. Using the lemmas above we can now prove Theorem 5.

Proof of Theorem 2 when \(K=3\).: Firstly, show that \(\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}>0\) with high probability. Use the second moment method, we obtain

\[\mathbb{P}(\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}>0|\mathcal{I}) \geq\frac{\mathbb{E}[\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}| \mathcal{I}]^{2}}{\mathbb{E}[(\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i})^{2}| \mathcal{I}]}\] \[=\frac{\mathbb{E}[\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}|\mathcal{I }]^{2}}{\mathbb{E}[\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}|\mathcal{I}]^{2}+ \mathrm{Var}(\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}|\mathcal{I})}\] \[\geq 1-\frac{\mathrm{Var}(\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}| \mathcal{I})}{\mathbb{E}[\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}|\mathcal{I}]^{2 }}.\]

Hence for unconditional probability, let \(\delta\) small enough, \(\delta<\min((2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)/8,\theta/4)\), then

\[\mathbb{P}(\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}>0) \geq\mathbb{P}(\{\sum_{i\in R^{*}\cap V_{1}^{+}}W_{i}>0\}\cap \mathcal{F}\cap\mathcal{G}_{\delta})=\mathbb{E}[\mathbb{P}(\sum_{i\in R^{*} \cap V_{1}^{+}}W_{i}>0|\mathcal{I})1(\mathcal{F}\cap\mathcal{G}_{\delta})]\] \[\geq\mathbb{E}\left[\left(1-\frac{\mathrm{Var}(\sum_{i\in R^{*} \cap V_{1}^{+}}W_{i}|\mathcal{I})}{\mathbb{E}[\sum_{i\in R^{*}\cap V_{1}^{+}}W _{i}|\mathcal{I}]^{2}}\right)1(\mathcal{F}\cap\mathcal{G}_{\delta})\right]\] \[\geq\left((1-o(1))n^{2\theta-3\delta-2(\theta-\delta)+o(1)} \right)\mathbb{P}(\mathcal{F}\cap\mathcal{G}_{\delta})=1-o(1).\]

The inequality on the last line is by Lemma G.7, G.8. The equality in the last line is by Lemma G.5, D.4. The proof for \(\mathbb{P}(\sum_{i\in R^{*}\cap V_{1}^{-}}W_{i}>0)=1-o(1)\) is identical. Hence, in light of Corollary G.3, the MAP estimator fails with probability \(1-o(1)\)

### Analysis of \(S_{\pi}\)

In this section we introduce the set \(\mathcal{A}_{\pi}\) and some properties of \(S_{\pi}\).

First, define the set

\[\mathcal{A}(S^{*},\pi_{12}^{*}\{[n]\setminus S^{*}\}):=\{\pi\in S_{n}:S_{\pi}=S^ {*},\pi([n]\setminus S_{\pi})=\pi_{12}^{*}([n]\setminus S^{*})\}.\]

For brevity, sometimes write \(\mathcal{A}^{*}\).

**Lemma G.9**.: _For any \(\pi\in\mathcal{A}^{*}\), \(A_{i,j}B_{\pi(i),\pi(j)}C_{\pi_{23}^{*}(\pi(i)),\pi_{23}^{*}(\pi(j))}=A_{i,j}B_ {\pi_{12}^{*}(i)\pi_{12}^{*}(j)}C_{\pi_{13}^{*}(i),\pi_{13}^{*}(j)}\). Moreover, if \(i\in S^{*}\) or \(j\in S^{*}\),\(A_{i,j}B_{\pi(i),\pi(j)}C_{\pi_{23}^{*}(\pi(i)),\pi_{23}^{*}(\pi(j))}=A_{i,j}B_ {\pi_{23}^{*}(i)\pi_{12}^{*}(j)}C_{\pi_{13}^{*}(i),\pi_{13}^{*}(j)}=0,A_{i,j}C_ {\pi_{23}^{*}(\pi(i)),\pi_{23}^{*}(\pi(j))}=A_{i,j}C_{\pi_{13}^{*}(i),\pi_{13}^ {*}(j)},0=A_{i,j}B_{\pi_{12}^{*}(i)\pi_{12}^{*}(j)}=0\)._

Proof.: If \(i,j\in[n]\setminus S^{*}\), then \(\pi(i)=\pi_{12}^{*}(i)\) and \(\pi(j)=\pi_{12}^{*}(j)\), hence \(A_{i,j}B_{\pi(i),\pi(j)}C_{\pi_{23}^{*}(\pi(i)),\pi_{23}^{*}(\pi(j))}=A_{i,j}B_ {\pi_{12}^{*}(i)\pi_{12}^{*}(j)}C_{\pi_{13}^{*}(i),\pi_{13}^{*}(j)}\). If \(i\in S^{*}\) or \(j\in S^{*}\), then by Definition G.2, \(i\in R^{*}\) or \(j\in R^{*}\), hence \(A_{i,j}B_{\pi(i),\pi(j)}C_{\pi_{23}^{*}(\pi(i)),\pi_{23}^{*}(\pi(j))}=A_{i,j}B_ {\pi_{12}^{*}(i)\pi_{12}^{*}(j)}C_{\pi_{13}^{*}(i),\pi_{13}^{*}(j)}=0\), \(A_{i,j}C_{\pi_{23}^{*}(\pi(i)),\pi_{

[MISSING_PAGE_FAIL:31]

[MISSING_PAGE_EMPTY:32]

[MISSING_PAGE_FAIL:33]

Proof of Theorem 5.: Given \(A,B,C,\sigma^{*}_{2},\pi^{*}_{2s},S^{*},\pi^{*}_{12}[[n]\setminus S^{*}]\), it's obvious that \(\widehat{\sigma}_{MAP}(i)=\sigma^{*}_{2}(\pi^{*}_{12}(i))\) for \(i\in[n]\setminus S^{*}\). For vertices in \(S^{*}\), note that

\[\frac{p_{100}q_{000}}{p_{000}q_{100}}=\frac{s(1-s)^{2}p(1-(1-(1-s)^{3})q)}{s(1- s)^{2}q(1-(1-(1-s)^{3})q)}=(1+o(1))\frac{p}{q}=(1+o(1))\frac{a}{b}.\]

Thus, by Lemma G.17, if \(a>b\), the MAP estimator maximizes \(\sum_{i\in S^{*}}\sigma_{X}(i)\mathsf{maj}(i)\) while the MAP estimator minimizes \(\sum_{i\in S^{*}}\sigma_{X}(i)\mathsf{maj}(i)\) if \(a<b\). Suppose \(a>b\), while satisfying the condition \(|S^{*}\cap X^{+}|=|S^{*}\cap V^{+}|\), \(|S^{*}\cap X^{-}|=|S^{*}\cap V^{-}|\), the maximum of \(\sum_{i\in S^{*}}\sigma_{X}(i)\mathsf{maj}(i)\) is obtained by setting \(\sigma_{X}(i)=+1\) to the vertices \(i\in S^{*}\) corresponding to the largest \(|S^{*}\cap V^{+}_{1}|\) values in the collection \(\{\mathsf{maj}(i)\}_{i\in S^{*}}\) and assigns the label -1 to the remaining vertices in \(S^{*}\). The proof is the same suppose \(a<b\). Then Theorem 5 follows. 

### Proof of Lemma G.5

Denote \(E_{i}\) as the event that \(i\) is a singleton in \(G_{1}\wedge_{\pi^{*}_{12}}H\), in other words that \(i\in R^{*}\). We assume that the communities are approximately balanced. More precisely, we assume that the event \(\mathcal{G}=\{n/2-n^{3/4}\leq|V^{+}|,|V^{-}|\leq n/2+n^{3/4}\}\) holds. By Lemma D.4, we have that \(\mathbb{P}(\mathcal{G})=1-o(1)\).

Conditioning on \(\sigma^{*}_{1}\), if \(i\in V^{+}_{1}\), then we have

\[\mathbb{P}(E_{i}|\sigma^{*}_{1})1(\mathcal{G})=(1-s(1-(1-s)^{2})a \log n/n)^{|V^{+}_{1}|-1}(1-s(1-(1-s)^{2})b\log n/n)^{|V^{-}_{1}|}1(\mathcal{ G})\] \[\leq \exp(-s(2s-s^{2})\log n/n(a(|V^{+}_{1}|-1)+b|V^{-}_{1}|))1( \mathcal{G})\] \[= \exp(-(1-o(1))(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)\log n)1( \mathcal{G})=n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+o(1)}1(\mathcal{G}).\]

The first inequality uses the fact \(1-x\leq e^{-x}\). Hence

\[\mathbb{E}[|R^{*}\cap V^{+}_{1}||\sigma^{*}_{1}]1(\mathcal{G}) =\sum_{i\in V^{+}}\mathbb{P}(E_{i}|\sigma^{*}_{1})1(\mathcal{G}) \leq|V^{+}_{1}|n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+o(1)}1(\mathcal{ G})\] \[\leq n^{1-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+o(1)}.\]

By Markov's inequality,

\[\mathbb{P}(|R^{*}\cap V^{+}_{1}|\geq n^{1-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}( a,b)+\delta}|\sigma^{*}_{1})1(\mathcal{G})\leq n^{-\delta+o(1)}=o(1).\]

Hence

\[\mathbb{P}(|R^{*}\cap V^{+}_{1}|\geq n^{1-(2s^{2}-s^{3})\mathrm{T }_{\mathrm{c}}(a,b)+\delta})\\ \leq\mathbb{P}(\mathcal{G}^{c})+\mathbb{E}[\mathbb{P}(|R^{*}\cap V ^{+}_{1}|\geq n^{1-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+\delta}|\sigma^{*} _{1})1(\mathcal{G})]=o(1).\]

Now we derive a lower bound for \(|R^{*}\cap V^{+}_{1}|\). For \(\epsilon=\epsilon_{n}\) sufficiently small:

\[(\log(\mathbb{P}(E_{i}|\sigma^{*}_{1})))1(\mathcal{G}) =((|V^{+}_{1}|-1)\log(1-s(1-(1-s)^{2})a\log n/n)\] \[\quad+|V^{-}_{1}|\log(1-s(1-(1-s)^{2})b\log n/n))1(\mathcal{G})\] \[\geq-(1+\epsilon)(2s^{2}-s^{3})\log n/n(a|V^{+}_{1}|+b|V^{-}_{1} |)1(\mathcal{G})\] \[=(1-o(1))(1+\epsilon)(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)( \log n)1(\mathcal{G}).\]

The first inequality uses that \(\log(1-x)\geq-(1+\epsilon)x\) provided \(0<x<\epsilon/(1+\epsilon)\). Setting \(\epsilon=n^{-0.5}\), we have that

\[\mathbb{E}[|R^{*}\cap V^{+}_{1}||\sigma^{*}_{1}]1(\mathcal{G})=\sum_{i\in V^{+} }\mathbb{P}(E_{i}|\sigma^{*}_{1})1(\mathcal{G})\geq n^{1-(2s^{2}-s^{3})\mathrm{ T}_{\mathrm{c}}(a,b)-o(1)}1(\mathcal{G}).\]

Then we bound the variance of \(|R^{*}\cap V^{+}_{1}|\). For \(i,j\in V^{+}_{1},i\neq j\):

\[\mathrm{Cov}(1(E_{i}),1(E_{j})|\sigma^{*}_{1})=\mathbb{P}(E_{i}E_ {j}|\sigma^{*}_{1})-\mathbb{P}(E_{i}|\sigma^{*}_{1})^{2}\\ =(1-s(2s-s^{2})a\log n/n)^{2|V^{+}_{1}|-3}(1-s(2s-s^{2})b\log n/n )^{2|V^{-}_{1}|}(1-(1-s(2s-s^{2})a\log n/n)).\]On event \(\mathcal{G}\), \(2|V_{1}^{+}|-3=(1+o(1))n\), \(2|V_{1}^{-}|=(1+o(1))n\). Hence using the equality \(1-x\leq e^{-x}\), we have that

\[\mathrm{Cov}(1(E_{i}),1(E_{j})|\sigma_{1}^{*})1(\mathcal{G}) \leq s(2s-s^{2})a\log n/n\exp(-(1-o(1))s(2s-s^{2})(a+b)\log n)1( \mathcal{G})\] \[=n^{-1-(2s^{2}-s^{3})(a+b)+o(1)}1(\mathcal{G}).\]

Then

\[\mathrm{Var}(|R^{*}\cap V_{1}^{+}||\sigma_{1}^{*})1(\mathcal{G})\] \[= \mathrm{Var}(\sum_{i\in V_{1}^{+}}1(E_{i})|\sigma_{1}^{*})1( \mathcal{G})=\sum_{i,j\in V_{1}^{+}}\mathrm{Cov}(1(E_{i}),1(E_{j})|\sigma_{1} ^{*})1(\mathcal{G})\] \[\leq \sum_{i\in V_{1}^{+}}\mathbb{P}(E_{i}|\sigma_{1}^{*})1(\mathcal{ G})+\sum_{i\neq j\in V_{1}^{+}}\mathrm{Cov}(1(E_{i}),1(E_{j})|\sigma_{1}^{*})1( \mathcal{G})\] \[\leq (n^{1-(2s^{2}-s^{3})(a+b)+o(1)}+n^{1-(2s^{2}-s^{3})(a+b)/2+o(1)} )1(\mathcal{G})=n^{1-(2s^{2}-s^{3})(a+b)/2+o(1)}1(\mathcal{G}).\]

By the Paley-Zygmund inequality,

\[\mathbb{P}(|R^{*}\cap V_{1}^{+}|\geq n^{1-(2s^{2}-s^{3})\mathrm{T}_{c}(a,b)-\delta}| \sigma_{1}^{*})1(\mathcal{G})\] \[\geq (1-n^{-\delta+o(1)})^{2}\frac{\mathbb{E}[|R^{*}\cap V_{1}^{+}|| \sigma_{1}^{*}]^{2}}{\mathbb{E}[|R^{*}\cap V_{1}^{+}|^{2}|\sigma_{1}^{*}]}1( \mathcal{G})\] \[\geq (1-n^{-\delta+o(1)})^{2}(1-\frac{\mathrm{Var}[|R^{*}\cap V_{1}^{ +}||\sigma_{1}^{*}]}{\mathbb{E}[|R^{*}\cap V_{1}^{+}||\sigma_{1}^{*}]^{2}})1( \mathcal{G})\] \[\geq (1-n^{-\delta+o(1)})^{2}(1-n^{-(1-(2s^{2}-s^{3})\mathrm{T}_{c}(a, b))+o(1)})1(\mathcal{G})=(1-o(1))1(\mathcal{G}).\]

Together with \(\mathbb{P}(\mathcal{G})=1-o(1)\), we have

\[\mathbb{P}(n^{1-(2s^{2}-s^{3})\mathrm{T}_{c}(a,b)-\delta}\leq|R^{*}\cap V_{1}^ {+}|\leq n^{1-(2s^{2}-s^{3})\mathrm{T}_{c}(a,b)+\delta})=1-o(1).\]

The proof for \(|R^{*}\cap V_{1}^{-}|\) is the same. Now we study \(|\bar{R}^{*}\cap V_{1}^{+}|\). Since \(R^{*}\subset\bar{R}^{*}\),we have the lower bound \(\mathbb{P}(|\bar{R}^{*}\cap V_{1}^{+}|\geq|R^{*}\cap V_{1}^{+}|\geq n^{1-(2s^ {2}-s^{3})\mathrm{T}_{c}(a,b)-\delta})=1-o(1)\). For the upper bound,

\[|\bar{R}^{*}\cap V_{1}^{+}|\leq|\bar{R}^{*}|\leq\sum_{i\in R^{*}}(1+|N_{H}( \pi_{12}^{*}(i))|)\leq|R^{*}|(1+\max_{j\in[n]}N_{H}(j)).\]

By Lemma D.6, since \(H\sim\mathrm{SBM}(n,(1-(1-s)^{2})a\log n/n,(1-(1-s)^{2})b\log n/n)\), we have that \(\max_{j\in[n]}N_{H}(j)\leq 100\max a,b(1-(1-s)^{2})\log n\) with probability \(1-o(1)\). Hence we have that with high probability

\[|\bar{R}^{*}\cap V_{1}^{+}| \leq(1+100\max a,b(1-(1-s)^{2})\log n)|R^{*}|\] \[\leq 2(1+100\max a,b(1-(1-s)^{2})\log n)n^{1-(2s^{2}-s^{3}) \mathrm{T}_{c}(a,b)+\delta}\] \[\leq n^{1-(2s^{2}-s^{3})\mathrm{T}_{c}(a,b)+\delta}.\]

### Proof of Lemma g.7, g.8

Firstly, we use some useful conditional independence properties given the sigma algebra \(\mathcal{I}\).

**Lemma G.18**.: _Let \(i\in R^{*}\), conditioned on \(\mathcal{I},\{A_{ij}\,:\,\{i,j\}\,\in\mathcal{E}_{100}\}\) is a collection of mutually independent random variables where_

\[A_{ij}\sim\begin{cases}\mathrm{Ber}(a\log n/n)&\sigma_{1}^{*}(i)=\sigma_{1}^{* }(j),\\ \mathrm{Ber}(b\log n/n)&\sigma_{1}^{*}(i)=-\sigma_{1}^{*}(j).\end{cases}\]

_The random variables \(1(i\in S^{*})\) and \(\sum_{j\in[n]\setminus\bar{R}^{*}}A_{i,j}\sigma_{1}^{*}(j)\) are conditionally independent given \(\mathcal{I}\)._

Proof.: Note that the sets \(R^{*},\bar{R}^{*}\) only depend on \(\pi_{12}^{*},H,G_{1}\wedge_{\pi_{12}^{*}}H\). \(G_{1}\setminus_{\pi_{12}^{*}}H\) is comprised of edges in \(\mathcal{E}_{100}\), the graph \(H\) is comprised of edges in \(\cup_{j+k>0}\mathcal{E}_{ijk}\), the graph \(G_{1}\wedge_{\pi_{12}^{*}}H\) is comprised of edges in \(\cup_{j+k>0}\mathcal{E}_{ijk}\). Thus by lemma D.2, \(G_{1}\setminus_{\pi_{12}^{*}}H\) is conditionally independent of given \(\pi^{*},\sigma_{1}^{*}\) and the partition \(\mathcal{E}\). In particular, \(\{A_{i,j}:\{i,j\}\in\mathcal{E}_{100}\}\) is conditionally independent of \(\mathcal{I}\).

Note that \(1(i\in S^{*})=1(i\in R^{*})1(A_{i,j}=0,\forall j\in\bar{R}^{*})\). Hence \(1(i\in S^{*})\) is measurable with respect to the sigma algebra generated by \(\mathcal{I}\) and the collection \(C_{1}:=\{A_{i,j}:j\in\bar{R}^{*},\{i,j\}\in\mathcal{E}_{100}\}.\) On the other hand, since \(\bar{R}^{*}\) is \(\mathcal{I}-\) measurable, \(\sum_{j\in[n]\setminus\bar{R}^{*}}A_{i,j}\sigma_{1}^{*}(j)\) is measurable with respect to the sigma algebra generated by \(\mathcal{I}\) and the collection \(C_{2}:=\{A_{i,j}:j\in[n]\setminus\bar{R}^{*},\{i,j\}\in\mathcal{E}_{100}\}\). \(C_{1}\cap C_{2}=\emptyset\), the independence of \(A_{i,j}\) implies that the two random variables are conditionally independent given \(\mathcal{I}\). 

**Lemma G.19**.: _For any \(\delta>0\), \(i\in R^{*}\),it holds for sufficiently large \(n\) that_

\[\mathbb{P}(i\in S^{*}|\mathcal{I})1(\mathcal{G}_{\delta})\geq(1-n^{-(2s^{2}-s ^{3})\mathrm{T}_{c}(a,b)+2\delta})1(\mathcal{G}_{\delta}).\]

Proof.: For \(i\in R^{*}\), define the following random sets that are \(\mathcal{I}-\) measurable:

\[C^{+}(i): =\{j\in\bar{R}^{*}:\{i,j\}\in\mathcal{E}_{100}\cap\mathcal{E}^{+ }(\sigma_{1}^{*})\},\] \[C^{-}(i): =\{j\in\bar{R}^{*}:\{i,j\}\in\mathcal{E}_{100}\cap\mathcal{E}^{-} (\sigma_{1}^{*})\}.\]

Note that \(i\in S^{*}\) if and only if \(i\in R^{*}\) and \(A_{i,j}=0\), \(\forall j\in C^{+}(i)\cup C^{-}(i)\) conditioned on \(\mathcal{I}\). Hence by Lemma G.18:

\[\mathbb{P}(i\in S^{*}|\mathcal{I}) =\mathbb{P}(A_{i,j}=0,\forall j\in C^{+}(i)\cup C^{-}(i)|\mathcal{ I})=(1-a\log n/n)^{|C^{+}(i)|}(1-b\log n/n)^{|C_{i}(i)|}\] \[\geq(1-a|C^{+}(i)|\log n/n)(1-b|C^{-}(i)|\log n/n)\] \[\geq 1-(a|C^{+}(i)|+b|C^{-}(i)|)\log n/n.\]

The first inequality is because of Bernoulli's inequality. Note that on event \(G_{\delta},|C^{+}(i)|,|C^{-}(i)|\leq|\bar{R}^{*}|\leq 2n^{1-(2s^{2}-s^{3}) \mathrm{T}_{c}(a,b)+\delta}\). Thus

\[\mathbb{P}(i\in S^{*}|\mathcal{I})1(\mathcal{G}_{\delta})\geq(1-2(a+b)n^{-(2s ^{2}-s^{3})\mathrm{T}_{c}(a,b)+\delta}\log n)1(\mathcal{G}_{\delta}).\]

Since \(2(a+b)\log n\leq n^{\delta}\), the lemma follows. 

Now, define the random variable

\[X_{i}:=\begin{cases}\mathbb{P}(\sum_{j\in[n]\setminus\bar{R}^{*}}A_{i,j} \sigma_{1}^{*}(j)<0|\mathcal{I})&i\in R^{*}\cap V_{1}^{+},\\ \mathbb{P}(\sum_{j\in[n]\setminus\bar{R}^{*}}A_{i,j}\sigma_{1}^{*}(j)>0| \mathcal{I})&i\in R^{*}\cap V_{1}^{-}.\end{cases}\]

Then we will study \(X_{i}\) on the event \(\mathcal{F}\cap G_{\delta}\).

**Lemma G.20**.: _For \(i\in R^{*}\),_

\[X_{i}1(\mathcal{F}\cap G_{\delta})=n^{-s(1-s)^{2}\mathrm{D}_{+}(a,b)+o(1)}1( \mathcal{F}\cap G_{\delta}).\]

Proof.: Suppose \(i\in R^{*}\cap V_{1}^{+}\). Note that \(\bar{R}^{*},\sigma_{1}^{*}\) are \(\mathcal{I}-\) measurable. By Lemma G.18:

\[\sum_{j\in[n]\setminus\bar{R}^{*}}A_{i,j}\sigma_{1}^{*}(j)\stackrel{{ d}}{{=}}Y-Z\]

\[Y\sim\mathrm{Bin}(|\{j\in[n]\setminus\bar{R}^{*}:\{i,j\}\in\mathcal{E}_{100} \cap\mathcal{E}^{+}(\sigma_{1}^{*})|,a\log n/n),\]

\[Z\sim\mathrm{Bin}(|\{j\in[n]\setminus\bar{R}^{*}:\{i,j\}\in\mathcal{E}_{100} \cap\mathcal{E}^{-}(\sigma_{1}^{*})|,b\log n/n).\]

Where \(Y,Z\) are independent. For brevity, suppose \(Y\sim\mathrm{Bin}(y,p)\), \(Z\sim\mathrm{Bin}(z,q)\). On the event \(\mathcal{F}\cap G_{\delta}\), the upper bound for \(y\):

\[y\leq|\{j\in[n]:\{i,j\}\in\mathcal{E}_{100}\cap\mathcal{E}^{+}(\sigma_{1}^{*} )|\leq s(1-s)^{2}(n/2+2n^{3/4})=(1+o(1))s(1-s)^{2}n/2.\]

The lower bound for \(y\):

\[y \geq|\{j\in[n]:\{i,j\}\in\mathcal{E}_{100}\cap\mathcal{E}^{+}( \sigma_{1}^{*})|-|\bar{R}^{*}|\] \[\geq s(1-s)^{2}(n/2-2n^{3/4})-n^{1-(2s^{2}-s^{3})\mathrm{T}_{c}(a,b)+\delta}=(1-o(1))s(1-s)^{2}n/2.\]Same calculation for \(z\) and we can derive:

\[(1-o(1))s(1-s)^{2}n/2\leq z\leq(1+o(1))s(1-s)^{2}n/2.\]

We can rewrite \(p\), \(q\) as \(p=(1+o(1)as(1-s)^{2}\log(s(1-s)^{2}n)/(s(1-s)^{2}n))\), \(q=(1+o(1)bs(1-s)^{2}\log(s(1-s)^{2}n)/(s(1-s)^{2}n))\), hence by Lemma D.1, we have

\[\mathbb{P}(\sum_{j\in[n]\setminus R^{*}}A_{i,j}\sigma_{1}^{*}(j)<0|\mathcal{I} )1(\mathcal{F}\cap G_{\delta})=\mathbb{P}(Y-Z<0|\mathcal{I})1(\mathcal{F}\cap G _{\delta})\leq n^{-s(1-s)^{2}\mathrm{D}_{+}(a,b)+o(1)}.\]

The same argument works for \(i\in R^{*}\cap V_{1}^{-}\). 

Proof of Lemma G.7.: For \(i\in R^{*}\cap V_{1}^{+}\), we have that

\[\mathbb{E}[W_{i}|\mathcal{I}]1(\mathcal{F}\cap\mathcal{G}_{ \delta}) =\mathbb{P}(i\in S^{*},\sum_{j\in[n]\setminus R^{*}}A_{i,j}\sigma _{1}^{*}(j)<0|\mathcal{I})1(\mathcal{F}\cap\mathcal{G}_{\delta})\] \[=\mathbb{P}(i\in S^{*}|\mathcal{I})\mathbb{P}(\sum_{j\in[n] \setminus R^{*}}A_{i,j}\sigma_{1}^{*}(j)<0|\mathcal{I})1(\mathcal{F}\cap \mathcal{G}_{\delta}).\]

The first equality holds because \(A_{i,j}=0\) if \(i\in S^{*},j\in\bar{R}^{*}\). The second equality exits because the conditional independence in Lemma G.18. By Lemma G.19 and G.20, we have that

\[\mathbb{E}[W_{i}|\mathcal{I}]1(\mathcal{F}\cap\mathcal{G}_{ \delta}) \geq(1-n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+2\delta})X_ {i}1(\mathcal{F}\cap\mathcal{G}_{\delta})\] \[\geq(1-n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+2\delta})n^ {-s(1-s)^{2}\mathrm{D}_{+}(a,b)+o(1)}1(\mathcal{F}\cap\mathcal{G}_{\delta}).\]

Summing over \(i\in R^{*}\cap V^{+}\), we have that

\[\mathbb{E}[\sum_{i\in R^{*}\cap V^{+}} W_{i}|\mathcal{I}]1(\mathcal{F}\cap\mathcal{G}_{\delta})\] \[\geq|R^{*}\cap V^{+}|(1-n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c} }(a,b)+2\delta})n^{-s(1-s)^{2}\mathrm{D}_{+}(a,b)+o(1)}1(\mathcal{F}\cap \mathcal{G}_{\delta})\] \[\geq(1-n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+2\delta})n ^{1-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)-s(1-s)^{2}\mathrm{D}_{+}(a,b)- \delta+o(1)}1(\mathcal{F}\cap\mathcal{G}_{\delta}).\]

The second inequality is because on \(\mathcal{G}_{\delta},|R^{*}\cap V^{+}|\geq n^{1-(2s^{2}-s^{3})\mathrm{T}_{ \mathrm{c}}(a,b)-\delta}\). The proof of lower bound for \(i\in R^{*}\cap V_{1}^{-}\) is the same. 

Proof of Lemma G.8.: Suppose \(i\neq j\in R^{*}\cap V_{1}^{+}\), we have

\[\mathbb{E}[W_{i}W_{j}|\mathcal{I}] =\mathbb{P}(i,j\in S^{*},\sum_{k\in[n]\setminus\bar{R}^{*}}A_{i,k }\sigma_{1}^{*}(k)<0,\sum_{k\in[n]\setminus\bar{R}^{*}}A_{j,k}\sigma_{1}^{*}(k) <0|\mathcal{I})\] \[\leq\mathbb{P}(\sum_{k\in[n]\setminus\bar{R}^{*}}A_{i,k}\sigma_{1 }^{*}(k)<0,\sum_{k\in[n]\setminus\bar{R}^{*}}A_{j,k}\sigma_{1}^{*}(k)<0| \mathcal{I})\] \[=\mathbb{P}(\sum_{k\in[n]\setminus\bar{R}^{*}}A_{i,k}\sigma_{1}^{ *}(k)<0|\mathcal{I})\mathbb{P}(\sum_{k\in[n]\setminus\bar{R}^{*}}A_{j,k} \sigma_{1}^{*}(k)<0|\mathcal{I})=X_{i}X_{j}.\]

The second inequality is because by Lemma G.18, \(\{A_{i,k}\}_{k\in[n]\setminus\bar{R}^{*}}\) and \(\{A_{j,k}\}_{k\in[n]\setminus\bar{R}^{*}}\) are conditionally independent given \(\mathcal{I}\). Consider the case \(i=j\),

\[\mathbb{E}[W_{i}^{2}|\mathcal{I}]=\mathbb{P}(i\in S^{*},\sum_{j\in[n] \setminus\bar{R}^{*}}A_{i,j}\sigma_{1}^{*}(j)<0|\mathcal{I})\leq X_{i}.\]

Summing over \(i\in R^{*}\cap V_{1}^{+}\):

\[\mathbb{E}[(\sum_{i\in R^{*}\cap V^{+}}W_{i})^{2}|\mathcal{I}] =\sum_{i\in R^{*}\cap V^{+}}\mathbb{E}[W_{i}|\mathcal{I}]+\sum_{i \neq j\in R^{*}\cap V^{+}}\mathbb{E}[W_{i}W_{j}|\mathcal{I}]\] \[\leq\sum_{i\in R^{*}\cap V^{+}}X_{i}+\sum_{i\neq j\in R^{*}\cap V ^{+}}X_{i}X_{j}\leq\sum_{i\in R^{*}\cap V^{+}}X_{i}+(\sum_{i\in R^{*}\cap V^{+} }X_{i})^{2}.\]Note that

\[\mathbb{E}[\sum_{i\in R^{*}\cap V^{+}_{1}}W_{i}|\mathcal{I}]^{2}1( \mathcal{F}\cap\mathcal{G}_{\delta}) =(\sum_{i\in R^{*}\cap V^{+}_{1}}\mathbb{P}(i\in S^{*},\sum_{j\in[ n]\setminus R^{*}}A_{i,j}\sigma^{*}_{1}(j)<0|\mathcal{I}))^{2}1(\mathcal{F} \cap\mathcal{G}_{\delta})\] \[\geq(1-n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+2\delta})^{ 2}(\sum_{i\in R^{*}\cap V^{+}_{1}}X_{i})^{2}1(\mathcal{F}\cap\mathcal{G}_{ \delta}).\]

Hence we have

\[\mathrm{Var}(\sum_{i\in R^{*}\cap V^{+}_{1}}W_{i}|\mathcal{I})1( \mathcal{F}\cap\mathcal{G}_{\delta})\] \[= \left(\mathbb{E}[(\sum_{i\in R^{*}\cap V^{+}_{1}}W_{i})^{2}| \mathcal{I}]-\mathbb{E}[\sum_{i\in R^{*}\cap V^{+}_{1}}W_{i}|\mathcal{I}]^{2} \right)1(\mathcal{F}\cap\mathcal{G}_{\delta})\] \[\leq \left(\sum_{i\in R^{*}\cap V^{+}_{1}}X_{i}+(\sum_{i\in R^{*}\cap V ^{+}_{1}}X_{i})^{2}\left(1-(1-n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+2 \delta})^{2}\right)\right)1(\mathcal{F}\cap\mathcal{G}_{\delta})\] \[\leq \left(\sum_{i\in R^{*}\cap V^{+}_{1}}X_{i}+2(\sum_{i\in R^{*}\cap V ^{+}_{1}}X_{i})^{2}n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+2\delta} \right)1(\mathcal{F}\cap\mathcal{G}_{\delta})\] \[\leq \left(|R^{*}\cap V^{+}_{1}|n^{-s(1-s)^{2}\mathrm{D}_{+}(a,b)+o(1) }+2\left(|R^{*}\cap V^{+}_{1}|n^{-s(1-s)^{2}\mathrm{D}_{+}(a,b)+o(1)}\right)^{ 2}n^{-(2s^{2}-s^{3})\mathrm{T}_{\mathrm{c}}(a,b)+2\delta}\right)1(\mathcal{F} \cap G_{\delta})\] \[\leq (n^{\theta+\delta+o(1)}+2n^{2\theta+2\delta-(2s^{2}-s^{3})\mathrm{ T}_{\mathrm{c}}(a,b)+2\delta+o(1)})1(\mathcal{F}\cap G_{\delta}).\]

The second inequality uses the fact that \(1-(1-n^{-x})^{2}\leq 2n^{-x}\). The third inequality exists by Lemma G.5, G For a "bad" vertex \(v\), since \(\mathcal{MG}_{v}\) is disconnected, the metagraph has at least two disjointed components. Hence, there must exist two sets \(\Gamma_{g}(v),\Gamma_{b}(v)\) satisfying \(\Gamma_{g}(v)\cap\Gamma_{b}(v)=\emptyset,\Gamma_{g}(v)\cup\Gamma_{g}(b)=[K]\) and for any \(i\in\Gamma_{g}(v)\), \(j\in\Gamma_{b}(v)\), \((i,j)\) is not an edge in \(\mathcal{MG}_{v}\). In other words, \(v\) cannot be matched for any matching between the graph \(G_{i},i\in\Gamma_{g}(v)\) and the graph \(G_{j},j\in\Gamma_{b}(v)\). Heuristically, the definition implies that "bad" vertices cannot utilize the combined information for all \(K\) graphs.

Otherwise,the "good" vertices can utilize the combined information for all \(K\) graphs, as shown in Lemma H.3.

**Lemma H.3**.: _For a "good" vertex \(v\) defined in Definition H.2, for any two node i,j (represents two graphs \(G_{i}\), \(G_{j}\)), there exists a path \(i:=\ell_{0}-\ell_{1}-\ell_{2}\ldots-\ell_{d}:=j\) such that \(v\) can be matched for \(\widetilde{\mu}_{\ell_{m}\ell_{m+1}},m\in\{0,1,...,k-1\}\). Define \(\widehat{\pi}_{ij}(v):=\widehat{\mu}_{\ell_{d-1}\ell_{d}}\circ\widehat{\mu}_{ \ell_{d-2}\ell_{d-1}}\circ\ldots\circ\widehat{\mu}_{\ell_{1}\ell_{2}}\circ \widehat{\mu}_{\ell_{0}\ell_{1}}(v)\)._

Proof.: For a "good" vertex \(v\), since \(\mathcal{MG}_{v}\) is connected, for any two nodes \(i,j\in[K]\), there exists a path \(\psi_{ij}(v):=\{\ell_{0}-\ell_{1}-\ldots-\ell_{d-1}-\ell_{d},\ell_{0}=i,\ell_ {d}=j,(\ell_{m},\ell_{m+1})\in\mathcal{E}(\mathcal{MG}_{v})\}\). We can use the path \(\psi_{ij}(v)\) to define the \(\widehat{\pi}_{ij}(v)\) 

**Remark:** Note that such a path is not unique. However, the choice of path does not matter whp. By Lemma E.5, for \(k\)-core partial matching, \(\widehat{\mu}_{ij}=\pi_{ij}^{*},i,j\in[K]\), with high probability. Hence, for two different paths with endpoints being \(i,j\in[K]\), denoted by \(\psi_{ij}^{1},\psi_{ij}^{2}\), we can define \(\widehat{\pi}_{ij}^{1},\widehat{\pi}_{ij}^{2}\) based on the two paths \(\psi_{ij}^{1},\psi_{ij}^{2}\) separately. Then, with high probability \(\widehat{\pi}_{ij}^{1}=\pi_{ij}^{*}=\widehat{\pi}_{ij}^{2}\).

By Lemma H.3 and its remark, we can have the union graph of \(K\) graphs \((G_{1}\lor G_{2}\lor G_{3}\vee\ldots\lor G_{K})\) for the "good" vertices, using the matchings \(\widehat{\boldsymbol{\pi}}:=(\widehat{\pi}_{12},\widehat{\pi}_{13},\ldots, \widehat{\pi}_{1K})\) where \(\widehat{\pi}_{1K}\) is defined in Lemma H.3. If there are multiple paths existing, pick the shortest one, and break ties in lexicographic order.

### Exact community recovery algorithm for \(K\) graphs

The key steps of the exact community recovery algorithm for \(K\) graphs are essentially the same as the algorithm for three graphs. Based on a given almost exact community recovery \(\widehat{\sigma}_{1}\) and \(\binom{K}{2}\)\(k\)-core matchings pairwise, we divide the vertices into two categories:"good" and "bad" vertices according to Definition H.1, H.2. Then refine the community label according to the majority votes for the "good" and "bad" vertices sequentially, to obtain the exact community recovery label under the given conditions. The full algorithm for exact community recovery is given in Algorithm 5:

```
1:\(\mathcal{MG}_{v}\), \(\widehat{\sigma}_{1}\), \(\widehat{\sigma}_{2}\), \(\widehat{\sigma}_{3}\), \(\widehat{\sigma}_{4}\), \(\widehat{\sigma}_{5}\), \(\widehat{\sigma}_{6}\), \(\widehat{\sigma}_{7}\), \(\widehat{\sigma}_{8}\), \(\widehat{\sigma}_{9}\), \(\widehat{\sigma}_{10}\), \(\widehat{\sigma}_{11}\), \(\widehat{\sigma}_{

[MISSING_PAGE_FAIL:40]

Here \(C(i_{1},i_{2},\ldots,i_{K-L})\) is a constant given \(i_{1},i_{2},\ldots,i_{K-L}\). Now look at \(\mathbb{E}[D^{N}(1-s)^{(K-L)D}]\). In our regime, \(N\leq(m+k)(K-L)L\) are constant. Hence:

\[\mathbb{E}[D^{N}(1-s)^{(K-L)D}\mathbf{1}_{\mathcal{F}}] =\mathbb{E}[(X_{a}+X_{b})^{N}(1-s)^{(K-L)X_{a}}(1-s)^{(K-L)X_{b}} \mathbf{1}_{\mathcal{F}}]\] \[=\sum_{t=0}^{N}C_{t}\mathbb{E}[X_{a}^{t}(1-s)^{(K-L)X_{a}}\mathbf{ 1}_{\mathcal{F}}]\mathbb{E}[X_{b}^{N-t}(1-s)^{(K-L)X_{a}}\mathbf{1}_{\mathcal{ F}}].\]

Here \(C_{t}\) is constant related to \(t\), the second equality is due to the independence of \(X_{a},X_{b}\). Now look at \(\mathbb{E}[X_{a}^{t}(1-s)^{(K-L)X_{a}}\mathbf{1}_{\mathcal{F}}]\).

\[\mathbb{E}[X_{a}^{t}(1-s)^{(K-L)X_{a}}\mathbf{1}_{\mathcal{F}}] \leq\mathbb{E}[X_{a}^{t}(1-s)^{(K-L)X_{a}}]\] \[=\sum_{\ell=0}^{(1+o(1))n/2}\ell^{t}(1-s)^{(K-L)\ell}(\frac{(1-(1 -s)^{L})a\log n}{n})^{\ell}(1-\frac{(1-(1-s)^{L})a\log n}{n})^{(1+o(1))n/2-\ell}\] \[=\sum_{\ell=0}^{(\log n)^{3}}\ell^{t}(\frac{(1-s)^{K-L}(1-(1-s)^{L })a\log n}{n})^{\ell}(1-\frac{(1-(1-s)^{L})a\log n}{n})^{(1+o(1))n/2-\ell}\] \[+\sum_{\ell=(\log n)^{3}+1}^{(1+o(1))n/2}\ell^{t}(\frac{(1-s)^{K-L }(1-(1-s)^{L})a\log n}{n})^{\ell}(1-\frac{(1-(1-s)^{L})a\log n}{n})^{(1+o(1))n/ 2-\ell}.\]

Similarly, we can bound the first part:

\[\sum_{\ell=0}^{(\log n)^{3}}\ell^{t}(\frac{(1-s)^{K-L}(1-(1-s)^{L })a\log n}{n})^{\ell}(1-\frac{(1-(1-s)^{L})a\log n}{n})^{(1+o(1))n/2-\ell}\] \[\leq (\log n)^{3t}\sum_{\ell=0}^{(\log n)^{3}}(\frac{(1-s)^{K-L}(1-(1 -s)^{L})a\log n}{n})^{\ell}(1-\frac{(1-(1-s)^{L})a\log n}{n})^{(1+o(1))n/2-\ell}\] \[\leq (\log n)^{3t}\sum_{\ell=0}^{(1+o(1))n/2}(\frac{(1-s)^{K-L}(1-(1-s )^{L})a\log n}{n})^{\ell}(1-\frac{(1-(1-s)^{L})a\log n}{n})^{(1+o(1))n/2-\ell}\] \[= (\log n)^{3t}(1-(1-(1-s)^{K-L})(1-(1-s)^{L})\frac{sa\log n}{n})^{ (1+o(1))n/2}\] \[\leq n^{-(1-(1-s)^{K-L})(1-(1-s)^{L})a/2+o(1)}.\]

Then we can bound the second part, using the similar arguments in Lemma E.7, we can show that

\[\sum_{\ell=(\log n)^{3}+1}^{(1+o(1))n/2}\ell^{t}(\frac{(1-s)^{K-L }(1-(1-s)^{L})a\log n}{n})^{\ell}(1-\frac{(1-(1-s)^{L})a\log n}{n})^{(1+o(1))n /2-\ell}\\ =o(n^{-(1-(1-s)^{K-L})(1-(1-s)^{L})a/2+o(1)}).\]

Hence, by summing up the two parts, \(\mathbb{E}[X_{a}^{t}(1-s)^{(K-L)X_{a}}]\leq n^{-(1-(1-s)^{K-L})(1-(1-s)^{L})a/ 2+o(1)}\). This is also true for \(X_{b}\). Then, \(\mathbb{E}[D^{N}(1-s)^{(K-L)D}]\leq n^{-(1-(1-s)^{K-L})(1-(1-s)^{L})\mathrm{T} _{c}(a,b)+o(1)}\).

For \(f(x)=(1-s)^{x}+(1-s)^{K-x},x\in[1,K-1]\), the function \(f(x)\) obtains its maximum at \(x=1,K-1\). Hence \(n^{((1-s)^{K-L}-1)((1-(1-s)^{L})\mathrm{T}_{c}(a,b)+o(1)}\leq n^{-s(1-(1-s)^{K- 1})\mathrm{T}_{c}(a,b)+o(1)}\). Similar to Lemma E.7, by Markov inequality, the lemma follows immediately. 

**Lemma H.6**.: _The size of "bad" vertices defined in Definition H.2 can be upper bounded by \(n^{-s(1-(1-s)^{K-1})\mathrm{T}_{c}(a,b)+o(1)}\)._

Proof.: By definition H.2, the meta graph \(\mathcal{MG}_{v}\) for"bad" vertex \(v\) are disconnected. Hence, there exists at least two components of \(\mathcal{MG}_{v}\), where there are no edges between the nodes from two components. 

With all the preparations for "bad" vertices and "good" vertices, we are now ready to prove Theorem 1 for general \(K\) graphs.

### Exact recovery for "good" vertices

By Lemma D.1, we can directly deduce that if \((1-(1-s)^{K})D_{+}(a,b)>1+\epsilon|\log(a/b)|\), then for all \(i\in[n]\) we have that \(\mathsf{maj}_{G_{1}\lor G_{2}\ldots\lor G_{K}}(i)\geq\epsilon\log n\) w.h.p.

Now for a "good"vertex \(i\), there exists a corresponding matching set \(\Psi\) that \(i\) can be matched for all the matchings in \(\Psi\) and there is an union graph \(\widetilde{G}:=(G_{1}\lor G_{2}\vee\ldots\lor G_{3})\) that can be derived from the matchings in \(\Psi\). Let \(M\) be the set of vertices that can be matched for all matchings in \(\Psi\).

**Lemma H.7**.: _Suppose that \((1-(1-s)^{3})D_{+}(a,b)>1+2\epsilon|\log(a/b)|\). Then with probability \(1-o(1)\), all the "good" vertices in \(M\) have an \(\epsilon\log n\) majority in \(\widetilde{G}\{M\}\)._

Proof.: Denote \(F^{*}_{ij}\) the set of vertices outside the 13-core of \(G_{i}\wedge_{\pi^{*}_{ij}}G_{j}\). In light of Lemma E.5 and its remark, we can replace \(\mu_{ij}\) with \(\pi^{*}_{ij}\), \(F_{ij}\) with \(F^{*}_{ij}\),\(M\) with \(M^{*}\) in Lemma F.2. Where we define

\[G^{*}:=G_{1}\vee_{\pi^{*}_{12}}G_{2}\vee\ldots\vee_{\pi^{*}_{1K}}G_{K},\qquad H :=G^{*}\{M^{*}\}.\]

To bound the neighborhood majority in \(H\), for \(i\in M^{*}\) we have:

\[\mathsf{maj}_{H}(i) =\sigma^{*}(i)\sum_{j\in N_{H}(i)}\sigma^{*}(j)\leq\mathsf{maj}_{ G^{*}}(i)+\sum_{\tilde{\mu}_{j\ell}\notin\Psi}|N_{G^{*}}(i)\cap F^{*}_{j\ell}|,\] \[\mathsf{maj}_{H}(i) =\sigma^{*}(i)\sum_{j\in N_{H}(i)}\sigma^{*}(j)\geq\mathsf{maj}_{ G^{*}}(i)-\sum_{\tilde{\mu}_{j\ell}\notin\Psi}|N_{G^{*}}(i)\cap F^{*}_{j\ell}|.\]

To sum up, we have

\[|\mathsf{maj}_{H}(i)-\mathsf{maj}_{G^{*}}(i)|\leq\sum_{\tilde{\mu}_{j\ell} \notin\Psi}|N_{G^{*}}(i)\cap F^{*}_{j\ell}|.\] (H.8)

Note that \(\mathsf{maj}_{G^{*}}(i)>2\epsilon\log n\), \(i\in[n]\) with probability \(1-o(1)\), given that \((1-(1-s)^{K})D_{+}(a,b)>1+2\epsilon|\log(a/b)|\) by Lemma D.1. Now we would like to prove that the right hand side of (H.8) can be bounded by \(\epsilon\log n\).

Note that \(|N_{G^{*}}(i)\cap F^{*}_{j\ell}|\leq|N_{G_{j}\wedge G_{\ell}}(i)\cap(F^{*}_{j \ell})|+|N_{G^{*}\setminus(G_{j}\wedge G_{\ell})}(i)\cap(F^{*}_{j\ell})|\).

First, look at \(|N_{G_{j}\wedge G_{\ell}}(i)\cap(F^{*}_{j\ell})|\), by Lemma E.4, w.h.p.,

\[|N_{G_{j}\wedge G_{\ell}}(i)\cap F^{*}_{j\ell}|<\epsilon\log n/2K^{2}.\]

The remaining thing is to bound \(|N_{G^{*}\setminus(G_{j}\wedge G_{\ell})}(i)\cap(F^{*}_{j\ell})|\). Note that conditioned on \(\boldsymbol{\pi}^{*},\sigma^{*},\boldsymbol{\mathcal{E}}:=\{\mathcal{E}_{i_{1 }i_{2}\ldots i_{K}},i_{1},i_{2},\ldots,i_{K}\in\{0,1\}\}\), the graph \(G^{*}\setminus(G_{j}\wedge G_{\ell})\) is independent of \(F^{*}_{j\ell}\) by Lemma D.2, since \(F^{*}_{j\ell}\) depends only on \(G_{j}\wedge G_{\ell}\). Thus we can stochastically dominate \(|N_{G^{*}\setminus(G_{j}\wedge G_{\ell})}(i)\cap F^{*}_{j\ell}|\) by a Poisson random variable X with mean

\[\lambda_{n}:=\nu\frac{\log n}{n}|\{j\in F^{*}_{j\ell}:\{i,j\}\in G^{*}\setminus (G_{j}\wedge G_{\ell})|\leq\nu\frac{\log n}{n}|F^{*}_{j\ell}|,\nu:=max(a,b).\]

For a fixed \(\delta>0\), define an event \(\mathcal{Z}:=\{|F^{*}_{j\ell}|\leq n^{1-s^{2}\mathrm{T}_{\mathrm{c}}(a,b)+ \delta}\}\). On \(\mathcal{Z}\), \(\lambda_{n}\leq n^{-s^{2}\mathrm{T}_{\mathrm{c}}(a,b)+\delta+o(1)}\). Hence, for any positive integer \(m\):

\[\mathbb{P}(\{|N_{G^{*}\setminus(G_{j}\wedge G_{\ell})}(i)\cap(F^{* }_{j\ell})|\geq m\}\cap\mathcal{Z}\leq\mathbb{P}(\{X\geq m\}\cap\mathcal{Z})= \mathbb{E}[\mathbb{P}(X\geq m|F^{*}_{j\ell},\boldsymbol{\mathcal{E}},\sigma^ {*},\boldsymbol{\pi}^{*})\mathbf{1}_{\mathcal{Z}}]\\ \leq\mathbb{E}[(\inf_{\theta>0}e^{-\theta m+\lambda_{n}(e^{\theta }-1)})\mathbf{1}_{\mathcal{Z}}]\leq\mathbb{E}[\varepsilon\lambda_{n}^{m} \mathbf{1}_{\mathcal{Z}}]\leq n^{-m(s^{2}\mathrm{T}_{\mathrm{c}}(a,b)-\delta-o(1 ))}.\]

Above, the equality on the second line is due to the tower rule and since \(\mathcal{Z}\) is measurable with respect to \(|F^{*}_{j\ell}|\), the inequality on the third line is due to a Chernoff bound; the inequality on the fourth line follows from setting \(\theta=\log(1/\lambda_{n})\) (which is valid since \(\lambda_{n}=o(1)\) if \(\mathcal{Z}\) holds). The final inequality uses the upper bound for \(\lambda_{n}\) on \(\mathcal{Z}\). Taking a union bound, we have

\[\mathbb{P}(\{\exists i\in[n],|N_{G^{*}\setminus(G_{j}\wedge G_{\ell})}(i)\cap F ^{*}_{j\ell}|\geq m\}\cap\mathcal{Z})\leq n^{1-m(s^{2}\mathrm{T}_{\mathrm{c}}(a,b )-\delta-o(1))}.\]

Here if we take \(m>(s^{2}\mathrm{T}_{\mathrm{c}}(a,b))^{-1}\) and \(\delta<s^{2}\mathrm{T}_{\mathrm{c}}(a,b)-m^{-1}\), the probability turns to \(o(1)\). Thus, we can set \(m=\lceil(s^{2}\mathrm{T}_{\mathrm{c}}(a,b))^{-1}\rceil+1\). In light of Lemma E.6, \(|F^{*}_{j\ell}|\leq n^{1-s^{2}\mathrm{T}_{\mathrm{c}}(a,b)+\delta},\delta>0\) w.h.p. Hence, the event \(\mathcal{Z}\) happens with probability \(1-o(1)\). Hence we have

\[\mathbb{P}(\{\forall i\in[n],N_{G^{*}\setminus(G_{j}\wedge G_{\ell})}(i)\cap F ^{*}_{j\ell}|\leq\lceil(s^{2}\mathrm{T}_{\mathrm{c}}(a,b))^{-1}\rceil\})=1-o(1).\]Hence we have, with probability \(1-o(1)\), for \(i\in M^{*}\)

\[|\mathsf{maj}_{H}(i)-\mathsf{maj}_{G^{*}}(i)|<\sum_{\widehat{\mu}_{j}\neq\Psi}( \epsilon\log n/2K^{2}+\lceil(s^{2}\mathrm{T_{c}}(a,b))^{-1}\rceil)<\epsilon\log n,\]

and hence with probability \(1-o(1)\),

\[\mathsf{maj}_{H}(i)>\epsilon\log n.\]

Then by Lemma E.5, we can replace \(H\) with \(\widetilde{G}\), \(F_{ij}^{*}\) with \(F_{ij}\), the lemma follows. 

Next, prove that each vertex in \(G^{*}\setminus_{\pi_{12}^{*}}G_{1}\) has a small number of neighbors in \(I_{\epsilon}(G_{1})\).

**Lemma H.9**.: _If \(0<\epsilon\leq\frac{s\mathrm{D}_{+}(a,b)}{4\lfloor\log(a/b)\rfloor}\), then_

\[\mathbb{P}(\forall i\in[n],|N_{G^{*}\setminus_{\pi_{12}^{*}}G_{1}}(i)\cap I_{ \epsilon}(G_{1})|\leq 2\lceil(s\mathrm{D}_{+}(a,b))^{-1}\rceil)=1-o(1).\]

Proof.: Since \(I_{\epsilon}(G_{1})\) depends on \(G_{1}\) alone, it follows that \(I_{\epsilon}(G_{1})\) and \(G^{*}\setminus_{\pi_{12}^{*}}G_{1}\) are conditionally independent given \(\boldsymbol{\pi}^{*},\sigma^{*},\boldsymbol{\mathcal{E}}\). Hence we can stochastically dominate \(|N_{G^{*}\setminus_{\pi_{12}^{*}}G_{1}}(i)\cap I_{\epsilon}(G_{1})|\) by a Poisson random variable X with mean \(\lambda_{n}\) given by

\[\lambda_{n}:=\nu\log n/n|\{j\in I_{\epsilon}(G_{1}):\{i,j\}\in G^{*}\setminus G _{1}\}|\leq\nu\log n/n|I_{\epsilon}(G_{1})|.\]

Next, define the event \(\mathcal{Z}:=\{|I_{\epsilon}(G_{1})|\leq n^{1-s\mathrm{D}_{+}(a,b)+2e\lfloor \log(a/b)\rfloor}\}\).

Notice that \(P(\mathcal{Z})=1-o(1)\) by Lemma D.7 and Markov's inequality, provided \(s\mathrm{D}_{+}(a,b)<99\). Following identical arguments as the proof of Lemma H.7, we arrive at

\[\mathbb{P}(\exists i\in[n],|N_{G^{*}\setminus_{\pi_{12}^{*}}G_{1}}(i)\cap I_{ \epsilon}(G_{1})|\geq m)=o(1)\]

when \(m>\lceil(s\mathrm{D}_{+}(a,b)-2e|\log a/b|)^{-1}\rceil\). If \(\epsilon\leq\frac{s\mathrm{D}_{+}(a,b)}{4\lfloor\log(a/b)\rfloor}\), then it suffices to set \(m=2\lceil(s\mathrm{D}_{+}(a,b))^{-1}\rceil+1\). 

**Lemma H.10**.: _Suppose that \(a,b,\epsilon>0\) satisfy the following conditions:_

\[(1-(1-s)^{K})\mathrm{D}_{+}(a,b)>1+2\epsilon|\log a/b|,0<\epsilon\leq\frac{s \mathrm{D}_{+}(a,b)}{4\lfloor\log a/b\rfloor}.\]

_With high probability, the algorithm correctly labels all vertices in \(\{i\in[n]\setminus M^{*}\}\)._

Proof.: Compare the neighborhood majority in \(H\) corresponding to \(\widehat{\sigma_{1}}\) with the true majority in \(H\), where \(H\) is defined in Lemma F.2:

\[|\sigma^{*}(i)\sum_{j\in N_{H}(i)}(\widehat{\sigma_{1}}(j)-\sigma ^{*}(j))|\leq|N_{H}(i)\cap I_{\epsilon})|\leq|N_{G^{*}}(i)\cap I_{\epsilon}(G _{1})|\] \[\leq|N_{G^{*}\setminus G_{1}}(i)\cap I_{\epsilon}(G_{1})|+|N_{G_{ 1}}(i)\cap I_{\epsilon}(G_{1})|\leq 2\lceil\mathrm{D}_{+}(a,b)^{-1}\rceil+2 \lceil(s\mathrm{D}_{+}(a,b))^{-1}\rceil\leq\epsilon\log n/2.\]

The first inequality uses Lemma D.5 that the set of errors are contained in \(I_{\epsilon}(G_{1})\). The last inequality is due to Lemma D.8, H.9. Notice that \(\mathsf{maj}_{H}(i)\geq\epsilon\log n\) for \(i\in M^{*}\). Hence, \(\sigma^{*}(i)\sum_{j\in N_{H}(i)}\widehat{\sigma_{1}}(j)\geq\mathsf{maj}_{H}(i )-|\sigma^{*}(i)\sum_{j\in N_{H}(i)}(\widehat{\sigma_{1}}(j)-\sigma^{*}(j))| \geq\epsilon\log n/2>0\), which implies that the sign of neighborhood majorities are equal to the truth community label for any \(i\in M^{*}\), with probability \(1-o(1)\). Then we can convert \(H\) to \(\widetilde{G}\{M\}\), the vertices in \(M\) are correctly labeled with probability \(1-o(1)\). 

Using an identical proof, we can argue that the algorithm correctly labels all "good" vertices with probability \(1-o(1)\).

[MISSING_PAGE_FAIL:44]

[MISSING_PAGE_FAIL:45]

\((1-s)^{K-1})\mathrm{T}_{c}(a,b)>1\), that is, when the condition (3.5) holds, the number of "bad" vertices goes to zero when \(n\) goes to infinity, with high probability. Thus all vertices can be correctly matched and exact graph matching for \(K\) graphs is possible with high probability. 

### Impossibility of exact graph matching for \(K\) graphs

Proof.: Now we consider the graph matching problem with additional information provided, including the true correspondences \(\pi_{23}^{*},\ldots,\pi_{sK}^{*}\) and the community label \(\sigma^{*}\). Then we obtain the union graph \(H:=G_{2}\vee_{\pi_{23}^{*}}G_{3}\vee\ldots\vee_{\pi_{2K}^{*}}G_{K}\). We now prove the impossibility by contradictory. Suppose that there exists an estimator \(\widehat{\pi}\) which can exactly match \(G_{1},G_{2},...,G_{K}\), note that \(H\sim\mathrm{SBM}(n,\frac{(1-(1-s)^{K-1})a\log n}{n},\frac{(1-(1-s)^{K-1})b \log n}{n})\). One key point, is that, we can subsample \(H_{2}^{\prime},H_{3}^{\prime},...,H_{K}^{\prime}\) from \(H\). To be more specific, consider the following parameter: \(r_{i_{1},i_{2},\ldots,i_{K}}=\frac{s^{K-1}_{j=1}\cdot i_{j}(1-s)^{K-\sum_{j= 1}^{K}i_{j}}}{1-(1-s)^{K-1}}\) where \(i_{1},i_{2},\ldots,i_{K}\in\{0,1\}\) and \(\sum_{j=1}^{K}i_{j}>0\). Here \(\sum r_{i_{1},i_{2},\ldots,i_{K}}=1\). Then for any vertex pair \((i,j)\):

1. If \((i,j)\) is not an edge in \(H\), then \((i,j)\) is not an edge in \(H_{2}^{\prime},H_{3}^{\prime},\ldots,H_{K}^{\prime}\).
2. If \((i,j)\) is an edge in \(H\), with probability \(r_{i_{1},i_{2},\ldots,i_{K}},(i,j)\) is an edge in the graphs \(\{H_{i_{j}}^{\prime}\}\) where \(i_{j}=1\) in \(r_{i_{1}

### NeurIPS Paper Checklist

1. **Claims** Question: Do the main claims made in the abstract and introduction accurately reflect the paper's contributions and scope? Answer: [Yes] Justification: As stated in the abstract and introduction, the main contribution of our paper is to derive the precise information-theoretic threshold for exact community recovery given \(K\) correlated stochastic block models, for any constant \(K\geq 3\). This is exactly the content of Theorem 1 and Theorem 2 in Section 3 (as discussed in detail in Sections 2 and 3). Guidelines: * The answer NA means that the abstract and introduction do not include the claims made in the paper. * The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers. * The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings. * It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper.
2. **Limitations** Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] Justification: We discuss limitations, and possible future work that may address these, in Section 6. Guidelines: * The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper. * The authors are encouraged to create a separate "Limitations" section in their paper. * The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be. * The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated. * The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon. * The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size. * If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness. * While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren't acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations.
3. **Theory Assumptions and Proofs**Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? Answer: [Yes] Justification: We clearly define the model and questions that we study in Section 2, and we fully state our main theoretical results, including all assumptions, in Theorem 1, Theorem 2, Theorem 3, and Theorem 4. For all theorems, we provide a brief overview of the proof in Section 4, and we give the full proof in the Appendix. Guidelines: * The answer NA means that the paper does not include theoretical results. * All the theorems, formulas, and proofs in the paper should be numbered and cross-referenced. * All assumptions should be clearly stated or referenced in the statement of any theorems. * The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition. * Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material. * Theorems and Lemmas that the proof relies upon should be properly referenced.
4. **Experimental Result Reproducibility** Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? Answer: [NA] Justification: The paper does not include experiments. Guidelines: * The answer NA means that the paper does not include experiments. * If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not. * If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable. * Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed. * While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example 1. If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm. 2. If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully. 3. If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset). 4. We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results.
5. **Open access to data and code** Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? Answer: [NA] Justification: The paper does not include experiments. Guidelines: * The answer NA means that paper does not include experiments requiring code. * Please see the NeurIPS code and data submission guidelines ([https://nips.cc/public/guides/CodeSubmissionPolicy](https://nips.cc/public/guides/CodeSubmissionPolicy)) for more details. * While we encourage the release of code and data, we understand that this might not be possible, so "No" is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark). * The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines ([https://nips.cc/public/guides/CodeSubmissionPolicy](https://nips.cc/public/guides/CodeSubmissionPolicy)) for more details. * The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc. * The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why. * At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable). * Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted.
6. **Experimental Setting/Details** Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? Answer: [NA] Justification: The paper does not include experiments. Guidelines: * The answer NA means that the paper does not include experiments. * The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them. * The full details can be provided either with the code, in appendix, or as supplemental material.
7. **Experiment Statistical Significance** Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? Answer: [NA] Justification: The paper does not include experiments. Guidelines: * The answer NA means that the paper does not include experiments. * The authors should answer "Yes" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.

* The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).
* The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)
* The assumptions made should be given (e.g., Normally distributed errors).
* It should be clear whether the error bar is the standard deviation or the standard error of the mean.
* It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a 96% CI, if the hypothesis of Normality of errors is not verified.
* For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).
* If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text.
8. **Experiments Compute Resources** Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? Answer: [NA] Justification: The paper does not include experiments. Guidelines: * The answer NA means that the paper does not include experiments. * The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage. * The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute. * The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn't make it into the paper).
9. **Code Of Ethics** Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics [https://neurips.cc/public/EthicsGuidelines?](https://neurips.cc/public/EthicsGuidelines?) Answer: [Yes] Justification: The research conducted in the paper conforms, in every respect, with the NeurIPS Code of Ethics. Guidelines: * The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics. * If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics. * The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction).
10. **Broader Impacts** Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? Answer: [Yes] Justification: The current work is primarily theoretical. Nonetheless, broader societal impacts, both positive and negative, are discussed in Section 1 and Section 5. Guidelines: * The answer NA means that there is no societal impact of the work performed.

* If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.
* Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.
* The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.
* The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.
* If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML).

11. **Safeguards** Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? Answer: [NA] Justification: The paper does not involve any data or models that have a high risk for misuse. Guidelines: * The answer NA means that the paper poses no such risks. * Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters. * Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images. * We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort.
12. **Licenses for existing assets** Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? Answer: [Yes] Justification: Relevant prior work on models (all theoretical) is cited and discussed in detail throughout the paper, following the norms of the research literature. No code or data is used. Guidelines: * The answer NA means that the paper does not use existing assets. * The authors should cite the original paper that produced the code package or dataset. * The authors should state which version of the asset is used and, if possible, include a URL. * The name of the license (e.g., CC-BY 4.0) should be included for each asset. * For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.

* If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, paperswithcode.com/datasets has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.
* For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.
* If this information is not available online, the authors are encouraged to reach out to the asset's creators.
13. **New Assets** Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? Answer: [NA] Justification: The paper does not release any new assets. Guidelines: * The answer NA means that the paper does not release new assets. * Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc. * The paper should discuss whether and how consent was obtained from people whose asset is used. * At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file.
14. **Crowdsourcing and Research with Human Subjects** Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? Answer: [NA] Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: * The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. * Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper. * According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector.
15. **Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects** Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? Answer: [NA] Justification: The paper does not involve crowdsourcing nor research with human subjects. Guidelines: * The answer NA means that the paper does not involve crowdsourcing nor research with human subjects. * Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.

* We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.
* For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review.