# [MISSING_PAGE_FAIL:1]

[MISSING_PAGE_FAIL:1]

likely to be fairly homogeneous. But now suppose that we aim to maximize the probability the user likes at least one recommended movie--accounting for a "unit consumption constraint". Now, recommending only comedy movies is suboptimal. If the user is in the mood for action, they will be left without any options; meanwhile, it is not beneficial to recommend many additional comedy movies, since the user only cares that they have a single good movie to watch. In this way, accounting for consumption constraints intuitively induces diverse recommendations.

#### A model of recommendations

To make this intuition precise--that user utility is aligned with diversity--and to understand when and to what extent it holds, we need to analyze the diversity of accuracy- and utility-maximizing recommendations. (From here on, utility refers to a measure that accounts for capacity constraints.) A primary contribution of our work is a stylized-but-rich model of recommendations that is analytically tractable in this respect.

In our model, items of varying quality belong to discrete types, and each user has a probability distribution over types. In a given session, the user is in the mood for one of these types, where the type is drawn from the distribution. (Uncertainty of a user's mood can arise either due to genuine stochasticity, or limitations in the recommender's inferential abilities.) This model lends itself to an interpretable measure of diversity, where a set of recommendations is diverse if it represents items from many types roughly equally.

We derive results in an asymptotic regime where the number of recommendations grows large, obtaining precise characterizations of accuracy- and utility-maximizing recommendations as a function of model parameters that control the quality of items within and across types. We show in computational experiments that our theoretical findings hold more generally.

#### Diminishing returns drive our results and proof technique

Our results connect the composition of recommendation sets with the rate of diminishing returns when recommending more items of a given type (with respect to accuracy or utility). With large diminishing returns in one type, after recommending a few items of that type, a recommender becomes incentivized to recommend from other types. Roughly speaking, utility induces sharper diminishing returns than accuracy, and thus more diversity. The key steps in our proofs are to (1) precisely characterize the asymptotic behavior of these diminishing returns under different parameterizations of our model, and (2) to show how this behavior determines the asymptotic representation of item types in optimal recommendations.

#### Overview of results

In a basic setting (Theorem 1), the model confirms our intuition in a striking way. In this setting, accuracy-maximizing recommendations are completely homogeneous (representing only items from one type); yet, by accounting for consumption constraints, utility-maximizing recommendations are completely diverse (representing each type with equal proportion) in the limit. This uncovers a surprising fact--that even if the user prefers one type with higher probability than another, the optimal set of recommendations may contain an equal proportion of each.

In a more general setting (Theorems 2a and 2b), we consider differences in item quality within and across types, accounting for the idiosyncratic properties of recommendation settings.

Theorem 2a shows that accuracy-maximizing recommendations become more diverse when item quality decays at a faster rate (i.e., the recommender quickly begins to run out of "good options"). This accords with our conceptual understanding that larger diminishing returns induces more diversity. However, when this rate of decay is "reasonable" (in a sense made precise in Section 3.2), accuracy-maximizing recommendations remain relatively homogeneous--roughly speaking, they represent types "less than proportionally."

Theorem 2b shows that utility-maximizing recommendations are generally diverse. More specifically, however, we show that when there is no decay in item quality, representation of a type varies _inversely_ with the quality of items within that type. This holds empirically whenever the rate of decay is small. While perhaps counterintuitive, this is explained by the need to recommend more items from such a type to ensure that the user likes at least one. We isolate this case in Corollary 3, which we call the "milk and ice cream theorem," since it helps explains the paradoxical empirical fact that while consumers are more likely to buy milk, grocery stores devote much more aisle space to ice cream.

When the rate of decay is "severe," Theorems 2a and 2b collectively show that accuracy- and utility-maximizing recommendations coincide, and are diverse.

#### Implications

Our results lay out the specific ways in which diversity supports user utility, and thus inform how diversity should be incorporated into recommender systems. In particular:

* Maximizing user utility--properly conceived as incorporating consumption constraints--is often aligned with showing users a diverse set of items. Thus, to the extent that real-world systems do not show diverse recommendation sets, our results suggest that they are also failing to optimize user utility. Notably, this is true even before considering other ways in which diversity factors into utility (e.g., an intrinsic preference for diversity).
* Our results suggest principled approaches to diversify recommendations in a way that also optimizes utility. In particular, our results show that when users have consumption constraints, the relative likelihood a user prefers a specific type of item does not asymptotically affect the optimal representation of that item. Therefore, systems should recommend items relatively equally from a user's possible set of interests--even the niche interests.
* When the platform can estimate quality within a type (how often consumers like a specific ice cream flavor, conditional on wanting ice cream), the platform should recommend _more_ items from types in which individual items are _less likely_ to be satisfactory.

#### Paper Outline

In Section 2, we introduce our model. In Section 3, we introduce our theoretical results, first in a basic setting (Section 3.1) and then in a general setting (Section 3.2). In Section 4, we give an overview of our proof technique, sketching how we are able to derive our asymptotic results. In Section 5, we test our theoretical predictions in a range of computational experiments. In particular, we conduct a semi-synthetic experiment in which items and user preferences lie in a continuous space as estimated via matrix factorization, relaxing the assumption that there are a finite number of item and preference types. In Section 6, we conclude. Full proofs and an extended related work are left to the appendix.

## 2. Model

### Specifying a recommendation setting

A recommender is tasked with recommending a fixed number of items to a user. There are \(m\) types of items, and each item belongs to exactly one type. At recommendation time, a user prefers exactly one of these \(m\) types of items. In our exposition, we will treat \(m\) as fixed and omit notation that depends on \(m\).

Types are indexed by \([m]=\{1,2,,m\}\) and we let a user's type preference be given by a random variable \(T\), such that \([T=t]=p_{t}\) (so that \(_{i=1}^{m}p_{t}=1\)). When a user prefers type \(t\) (i.e., \(T=t\)), they only like items of type \(t\). We assume that there are an arbitrarily large number items of each type, and that conditional on \(T=t\), a user likes the \(i\)-th item of type \(t\) independently with probability \(q_{t,i}\). Without loss of generality, we let \(q_{t,1} q_{t,2}\).

Formally, we let the random variable \(V_{t,i}\) indicate if the user likes the \(i\)-th item of type \(t\), so that

\[[V_{t,i}=1] =[T=t][V_{t,i}\,|\,T=t] \] \[=p_{t}q_{t,i}. \]

Note that the random variables \(V_{t,i}\) are independent conditional on \(T\). A **recommendation setting** is thus characterized by:

1. **type probabilities**\(p_{1},p_{2},,p_{t}\);
2. **conditional item probabilities**\(q_{t,1},q_{t,2},\) for \(t[m]\).

In what follows, we assume that a recommendation setting is specified, and will omit dependencies of certain quantities on the recommendation setting.

Remark: Under standard measures of accuracy, like we consider here, items have binary value. However, it is possible to consider a setup in which values can be distributed according to arbitrary distributions. We provide such a setup in Appendix C, and give the analog of Theorem 1 in this setting.)

### Choosing a set of recommendations

We now focus on the task of selecting \(n\) items to recommend. In this case, a set of recommendations can be identified by an ordered tuple \(S=(n_{1},n_{2},,n_{m})\), where the recommender recommends the \(i\)-th item of type \(t\) for all \(t[m]\) and \(i[n_{t}]\). In other words, \(S\) represents the set of recommendations with the top \(n_{t}\) items from each type.1 We will let \(S_{n}:=\{(n_{1},n_{2},,n_{m})_{t=0}^{m}:_{t=1}^{m} n_{t}=n\}\) denote the set of recommendation sets of size \(n\).

We consider two objectives by which to optimize a set of recommendations \(S=(n_{1},n_{2},,n_{m}) S_{n}\):

* **Accuracy**: The expected proportion of items in \(S\) that the user likes, given by \[(S):= [_{t=1}^{m}_{t=1}^{n_{t}}V_{t,i}]\] (3) \[= _{t=1}^{m}p_{t}_{t=1}^{n_{t}}q_{t,i}.\] (4) acc is the standard notion of accuracy commonly used to evaluate machine learning models. By the linearity of expectation, it is maximized by selecting the items with the highest \([V_{t,i}]=p_{t}q_{t,i}\)--i.e., the individual items the user is most likely to like.
* **Utility** (w/ unit consumption constraint): The probability that a user likes at least one item in \(S\), given by \[(S) =[V_{t,i}=1t[m],i[n_{t}]]\] (5) \[= 1-_{t=1}^{m}p_{t}_{i=1}^{n_{t}}(1-q_{t,i}).\] (6) \(_{11}\) aligns with a user's satisfaction when they only intend to use one of the recommended items, as is common. In this case--e.g., when the goal is to find one restaurant to dine at, one movie to watch, or one website to visit--what matters is if the user likes at least one recommended item.

In our analysis, we characterize the accuracy- and utility-maximizing recommendation sets, given by the following notation.

**Definition 1** (\(S_{n}\) and \(S_{n,1}\)).: Given a specified recommendation setting, we let \(S_{n}\) and \(S_{n,1}\) denote the recommendation sets of size \(n\) that maximize acc and \(_{11}\), respectively;2

\[S_{n} =*{arg\,max}_{S S_{n}}(S) \] \[S_{n,1} =*{arg\,max}_{S S_{n}}_{11}(S). \]

To understand the diversity of \(S_{n}\) and \(S_{n,1}\), we consider how well-represented items of each type are.

**Definition 2** (Representation).: For \(S=(n_{1},n_{2},,n_{m})\), define

\[r_{t}(S)=}{_{u=1}^{m}n_{u}}, \]

the _representation_ of type \(t\) in \(S\).

Intuitively, sets with relatively equal representation across types are more diverse. In the following section, we will characterize--in terms of the type probabilities and conditional item probabilities--\(r_{t}(S_{n})\) and \(r_{t}(S_{n,1})\) across several regimes.

## 3. Results

We now introduce our theoretical results, which characterize the composition of the accuracy- and utility-maximizing sets \(S_{n}\) and \(S_{n,1}\). We begin in Section 3.1 by considering a basic setting that starkly contrasts the objectives acc and \(_{11}\); the first has a strong trade-off with diversity, while the second is entirely aligned with diversity. In Section 3.2, we characterize the representation of item types, \(r_{t}(S_{n})\) and \(r_{t}(S_{n,1})\), in a significantly more general setting, where we focus on the effects of different properties of the recommendation setting (i.e., providing comparative statics).

### A Basic Setting

We start with a simple case of our model where we let the type probabilities \(p_{1},p_{2},,p_{m}\) vary but hold the conditional item probabilities \(q_{t,i}=q\) fixed for some \(q(0,1)\). This setting provides a clear illustration of the drastic effect incorporating a consumption constraint can have.

To provide a concrete backdrop, suppose that there are \(m\) types of movie genres. Then the probability a user is in the mood for genre \(t\) is \(p_{t}\). These type probabilities \(p_{t}\) can vary, so that a user is more likely to be in the mood for some genres than others. Conditional on a user being in the mood for any genre \(t\), any movie in that genre is liked by the user independently with probability \(q\).

**Theorem 1**.: _Given type probabilities \(p_{1},p_{2},,p_{m}\) and conditional item probabilities \(q_{t,i}=q\),_

\[r_{t}(S_{n}) =_{\{t=_{t}p_{t}\}} \] \[_{n}r_{t}(S_{n,1}) =. \]

This result conveys a strong dichotomy. (10) says that recommendations maximizing acc contains exclusively items from the genre the user is most likely to prefer, \(_{t}p_{t}\). This reflects the empirical existence of an accuracy-diversity trade-off: the accuracy-maximizing set of recommendations is fully homogeneous.

Meanwhile, (11) says that the set of recommendations that maximizes utility with a unit consumption constraint is fully diverse. Specifically, as the number of recommended items \(n\) grows large, the recommender should recommend an equal proportion of items from each genre.3 In this way, accounting for a user's consumption constraint dissolves the apparent accuracy-diversity trade-off; maximizing the probability a user likes _at least one_ recommended movie is fully aligned with recommending a diverse set of movies. We now take a moment to convey the intuition behind Theorem 1. \(S_{n}\) maximizes acc, which is equivalent to maximizing the expected number of recommended items the user likes. By linearity of expectation, this is achieved when recommending the individual items the user likes with the highest probability. The probability a user likes any item in genre \(t\) is equal to \(p_{t}q\). Therefore, the recommender should only recommend items from genre \(_{t}p_{t}\).

When the objective is to instead maximize util1, the probability a user likes at least one item, recommending items from only one type is suboptimal. After recommending, say, many action movies, the probability the user is in the mood for action but does not like _any_ of the recommended action movies is small (\(p_{t}(1-q)^{n_{t}}\)), where \(n_{t}\) is the number of recommended action movies). At this point, recommending more action movies has diminishing returns, and one should hedge for the possibility that the user is in the mood for a different genre.

A surprising insight of Theorem 1 is that the type probabilities \(p_{t}\) do not play any role asymptotically for \(S_{n,1}\); even when a user watches more action than romance, the optimal set of recommendations represents the genres equally. To give some intuition, let \(X\) be the event that a user does not like _any_ recommended item. For an optimal set of recommendations \(S\), \([X\,|\,T=t]=p_{t}q^{n_{t}}\) should equalized across \(t\); otherwise, there would be an incentive to recommend more items from a type where this probability is higher. If \(p_{1}>p_{2}\), \([X\,|\,T=1]=[X\,|\,T=2]\) when recommending only a constant number \(_{q}}{p_{2}}\) more items from type 1 than type 2. So asymptotically, the proportion of items recommended from each type is equal. Representation thus quickly converges to this asymptotic value as \(n\) increases; this is illustrated in one case in Figure 1.

### A General Setting

We turn to a more general case where we consider heterogeneous conditional item probabilities and analyze comparative statics. Again, we consider arbitrary type probabilities \(p_{1},p_{2},,p_{m}\). Now, we parameterize conditional item probabilities in the following way:

\[q_{t,i}=q_{t}(i+)^{-}, \]

for \(, 0\). This parameterization models heterogeneity of conditional item probabilities both within and across types. Some comments on the parameters \(,\), and \((q_{1},q_{2},,q_{t})\):

* \(\) is the _rate of decay_ of item quality within a type. When \(>1\), this rate is extreme in the following sense: even if a user were recommended an infinite number of items in their preferred type, they (1) would only like a constant number of the items in expectation, and (2) with positive probability, would not like _any_ of the recommended items.4 Therefore, when the recommender has a reasonable "supply" of items, \( 1\) is realistic. * \(\) parameterizes the initial steepness, with higher \(\) corresponding to lower initial steepness. \(\) does not end up appearing in our estimates.
* \(q_{1},q_{2},,q_{m}\) are the _relative type qualities_. If \(q_{t}>q_{t^{}}\), then \(q_{t,i}>q_{t^{},i}\) for all \(i\). Users can be less likely to like items of a certain type, even conditioned on preferring that type. This has

Figure 1. An illustration of Theorem 1. Even while a user prefers type 1 much more often than type 2, as the number of recommendations increases, utility-maximizing recommendations (red) represent both types roughly equally. Meanwhile, accuracy-maximizing recommendations (blue) remain fully homogeneous throughout.

two equivalent interpretations: the user is more picky when they prefer type \(t^{}\), or the recommender has lower quality or more niche items in type \(t^{}\).

We now give two main results, Theorem 2.A and Theorem 2.B which characterize \(r_{t}(S_{n})\) and \(r_{t}(S_{n,1})\) in terms of these parameters.

**Theorem 2.A** (Accuracy-maximizing recommendations).: _Given type probabilities \(p_{1},p_{2},,p_{m}\) and conditional item probabilities \(q_{t,i}:=q_{t}(i+)^{-}\),_

\[_{n}r_{t}(S_{n})=q_{t})^{1/}}{_{u=1}^{m}( p_{u}q_{u})^{1/}} \]

The key takeaway from Theorem 2.A is that accuracy-maximizing recommendations are more diverse when \(\) is larger, i.e., when the quality of items in a type decays faster. Intuitively, this means that a recommender quickly runs out of high-quality items in a type, and thus benefits more from recommending items from other types. On the other hand, with small \(\), the recommender has access to many high-quality items within each type.

Let us consider three cases of Theorem 1 to understand the functional form in (24):

* As \( 0\), and if \(_{t}p_{t}q_{t}\) is unique,5

\[_{n}r_{t}(S_{n})_{\{t=_{s}p_{t}q_{t}\}}, \]

meaning that only the type with highest type probability is recommended.

* For \(=1\),

\[_{n}r_{t}(S_{n}) p_{t}q_{t}, \]

meaning that a type is recommended in proportion to the probability a user likes items in that type.

* For \(\),

\[_{n}r_{t}(S_{n}), \]

meaning that an equal proportion of items from each type are recommended.

As \(\) ranges from \(0\) to \(\), the amount of diversity in \(S_{n}\) smoothly interpolates from maximal homogeneity to proportional representation to maximal diversity. Notably, when \( 1\), diversity is in the range between homogeneity and proportional representation. This suggests that in practice, the accuracy-diversity trade-off is particularly severe when the recommender has access to many high quality items of a type.

We next turn to utility-maximizing recommendations \(S_{n,1}\), which account for a unit consumption constraint.

**Theorem 2.B** (Utility-maximizing recommendations).: _Given type probabilities \(p_{1},p_{2},,p_{m}\) and conditional item probabilities \(q_{t,i}=q_{t}(i+)^{-}\),_

\[_{n}r_{t}(S_{n,1})= })^{-1}}{_{u=1}^{m}(})^{-1}}&= 0\\ _{n}r_{t}(S_{n,1})=q_{t})^{1/}}{_{u=1}^{m}( p_{u}q_{u})^{1/}}&>1. \]

The representation exhibits phase change at \(=1\). As mentioned in our discussion of the parameters, we expect \(>1\) represents an "extreme setting." We thus focus on the case \(=0\), which we

   \(p_{t}\) & a _type probability_; a user prefers type \(t\) with probability \(p_{t}\) \\  \)} & a _conditional item probability_; conditional on preferring type \(t\), a user likes the \(i\)-th item of type \(t\) with probability \(q_{t,i}\); in our general setting, we parameterize \(q_{t,i}\) as \(q_{t,i}=q_{t}(i+)^{-}\) \\  \(\) & the _rate of decay_ of item quality within a type \\  \)} & a _relative type quality_; \(q_{t}\) determines the relative quality of items in \(t\) compared to other types \\  \)} & the set of \(n\) recommendations that maximizes acc, the expected proportion of items a user likes \\  \)} & the set of \(n\) recommendations that maximizes \(_{1}\), the probability a user likes at least one item \\   & \(r_{t}(S)\) & the proportion of items in \(S\) of type \(t\) \\   

Table 1. Key notation in our model pull out as its own result. (Note also that Theorem 1 is obtained by taking \(q_{1}=q_{2}==q_{m}\) and \(=0\).)

Corollary 3 (The "milk and ice cream theorem").: _Given type probabilities \(p_{1},p_{2},,p_{m}\) and conditional item probabilities \(q_{t,t}=q_{t}(i+)^{-}\), when \(=1\),_

\[_{n}r_{t}(S_{n,1})=})^{-1}}{ _{u=1}^{m}(})^{-1}}, \]

_meaning that \(r_{t}(S_{n,1})\) is larger for types \(t\) with lower \(q_{t}\)._

The corollary's name references a paradoxical fact of grocery stores: that even while a customer is much more likely to buy milk than ice cream, significantly more aisle space is devoted to ice cream. The paradox can be resolved by the corollary in the following way. Let milk be type \(1\) and ice cream be type \(2\). A customer is more likely to purchase milk than ice cream, so \(p_{1}>p_{2}\). However, the probability a given carton of ice cream will satisfy a customer trying to purchase milk is lower than the probability that a given bottle of milk will satisfy a customer trying to purchase milk.6 This means that \(q_{1}>q_{2}\). Corollary 3 reveals that more items should be recommended from the type with lower \(q\)-and, in fact, that \(p_{t}\) is asymptotically irrelevant.

Corollary 3 demonstrates a broader insight into recommendations when the user has consumption constraints. Rather than focusing on type probabilities, it is more important to consider the conditional item values _within a type_--in particular, to recommend more items from types with low conditional item values. A good set of recommendations covers its bases across all possible preferences of the user, and "covering" a type requires more items when items in that type have low conditional item probabilities.

Computational experiments suggest that behavior remains similar when \(\) is small but larger than \(0\) (see Figure 2). However, Theorem 2.B shows that the behavior of \(S_{n,1}\) changes when \(>1\). In fact, referring back to Theorem 2.A, we have that in this regime,

\[_{n}r_{t}(S_{n})=_{n}r_{t}(S_{n,1})=q_{t })^{1/}}{_{u=1}^{m}(p_{u}q_{u})^{1/}}. \]

So when \(>1\), both \(S_{n}\) and \(S_{n,1}\) become more diverse as \(\) increases. To provide rough intuition for this equality, note that for large \(\), it is unlikely that a user will like more than one item in each type. Therefore, maximizing the likelihood a user likes at least one item \((_{1})\) is roughly equivalent to maximizing the total number of recommended items a user likes (acc).

### Summary of results

To summarize our theoretical results, while accuracy can exhibit a strong trade-off with diversity (especially when the rate of decay \(\) is relatively small), our measure of utility that accounts for the capacity constraints of users does not exhibit a trade-off with diversity in the settings we study. This is exhibited in computational results shown in Figure 3, which shows how accuracy and utility vary as the level of diversity increases.

## 4. Proof technique

We now provide an overview of our proof technique. We begin with some high-level intuition, from which our formal approach will deviate somewhat. The basic idea is that maximizing functions

Figure 3. In three settings with varying \(\), we plot how accuracy and utility trade off with diversity. We consider sets \(S\) with \(n=100\) items ranging from complete homogeneity (only type \(1\) recommended), to proportional representation (\(r_{t}(S)=p_{t}\)) to complete diversity (\(r_{t}(S)=\)), and plot \((S)\) and \(_{1}(S)\). Notice that in all of the plots, \(_{1}\) is aligned with diversity, while \((S)\) exhibits a strong trade-off with diversity when \(=0\), which becomes less severe for larger \(\). These results agree with the predictions of Theorem 2.A and Theorem 2.B.

of the form

\[_{t=1}^{m}_{t}h(z_{t}), \]

subject to the constraint \((z_{1},,z_{m})^{n}\) is tractable when \(f\) is simple (a monomial, for instance). For example, rough speaking, it is possible to solve

\[_{1}h^{}(x_{1})=_{2}h^{}(x_{2})==_{m}h^ {}(x_{m}), \]

and show that the integer-valued optimum must be near the real-valued optimum. While the objectives acc and \(_{1}\) do not take the exact form as above, we show that there are choices of \(_{t}\) such that the objectives evaluate to

\[_{t=1}^{m}_{t}h_{t}(z_{t}), \]

where even while \(h_{t}(z_{t})\) may be complicated,

\[_{t}(z)}{h(z)}=1 \]

for a simple function \(h\). We can then show that, under some reasonable assumptions on \(h\), the solution to (23) is approximated by that of (20) in the limit as \(n\).

We now outline how this method can be used to prove Theorem 2.A when \(<1\) (the result is the same for \(=1\) and \(>1\), but these cases require separate analysis). Consider type probabilities \(p_{1},p_{2},,p_{m}\) and conditional item probabilities \(q_{t,i} q_{t}(i+)^{-}\). Then we would like to show that

\[_{t}r_{t}(S_{n})=q_{t})^{1/}}{_{t=1}^{m}(p _{t}q_{t})^{1/}} \]

Then \(S_{n}=(z_{1}^{(n)},z_{2}^{(n)},,z_{n}^{(n)})^{n}\) maximizes

\[_{t=1}^{m}p_{t}_{i=1}^{z_{t}}q_{t,i}=_{t=1}^{m}p_{t}_{i=1}^{z _{t}}q_{t}(i+)^{-}=_{t=1}^{m}_{t}h_{t}(z_{t}) \]

over \((z_{1},z_{2},,z_{m})^{n}\), where

\[_{t}=q_{t}}{1-}, h_{t}(z)(1-) _{i=1}^{z}(i+)^{-}. \]

We then show that

\[_{z}(z)}{h(z)}=1 \]

where \(h(z)=z^{1-}\). The result follows by using the following lemma, which is a subcase of Lemma A.1 in the appendix.

Lemma 1.: _Let \(h(z)=z^{}\) for \((0,1)\). For \(t[m]\), suppose \(h_{t}:_{20}\) is monotonically increasing and strictly concave, and that_

\[_{z}(z)}{h(z)}=1. \]

_Let_

\[S^{(n)}=(z_{1}^{(n)},z_{2}^{(n)},,z_{m}^{(n)})*{arg\, max}_{(z_{1},,z_{m})^{n}}_{t=1}^{m}_{t}h_{t}(z_{t}). \]

_Then_

\[_{n}r_{t}(S^{(n)})=^{}}{_ {u=1}^{m}_{u}^{}}. \]

Taking \(=1-\), we can apply the lemma to show that

\[_{n}r_{t}(S_{n})=q_{t}}{1-})^ {1/}}{_{u=1}^{m}(q_{t}}{1-})^{1/} }=q_{t})^{1/}}{_{u=1}^{m}(p_{t}q_{t})^{1/}}. \]

## 5. Computational Experiments

We present results from a range of computational experiments, showing that our theoretical results generalize to practical settings.

### Finite number of recommendations and beyond unit consumption constraints

We first focus on experiments in which \(n\) is finite, ranging from small to moderate. We also relax the assumption that users have _unit_ consumption constraints and consider varying rates of decay \(<1\). Consider the following more general version of utility corresponding to a consumption constraint of \(k\):

\[_{k}(S)[\{_{t[m],i[n _{i}]}V_{t,i}, k\}], \]

the value of the top \(k\) items that a user likes. Accordingly, let

\[S_{nk}*{arg\,max}_{S_{n}}_{ k}(S), \]

where we recall that \(_{n}\) is the set of all possible recommendation sets with \(n\) items. Notice that our previous definitions of \(_{1}\) and \(S_{n,1}\) agree with this more general definition. (Indeed, when \(k=1\), (32) reduces to the probability \(V_{t,i}=1\) for at least one item.)

Also notice that \(S_{n,n}\) maximizes the total number of items the user likes, and thus coincides with the accuracy-maximizing set \(S_{n}\). We would expect our theoretical results about \(_{n}r_{t}(S_{n,1})\) to be more accurate when \(k\) is small, and to diverge from empirics when \(k\) grows closer to \(n\).

Here, we focus on a recommendation setting where there are two item types with \(p_{1}=0.7\) and \(p_{2}=0.3\). We let \(q_{t,i}=q_{t}(i+)^{-}\) where we fix \(q_{t}=0.5\) and \(=1\), and only consider \(<1\). We focus on the case \(<1\) since it constitutes a reasonable rate of decay. We compare our empirical results to the estimate given by Theorem 2.B, which tells us that when \(=0\),

\[_{n}r_{1}(S_{n,1})=, \]

meaning that both types are equally represented. We evaluate how far empirical estimates of \(r_{1}(S_{n,k})\) deviate from this prediction when \(\{0,0.2,0.5,0.9\}\) and \(n\) and \(k\) vary. Results are shown in Table 2. We observe that \(r_{1}(S_{n,k})\) is near \(0.5\) whenever \(\) is relatively small and \(\) is smaller. This suggests that our findings are robust when the consumption constraint \(k\) is small in terms of \(n\) (i.e., users only use a relatively small proportion of recommended items at a given time), and when the quality of items in a type does not decay significantly, i.e., there are many high-quality items per type.

Empirically, our results suggest that the theoretical estimate for \(=0\) is accurate for small \(\), but begins to deteriorate as \(\) approaches \(1\). (This is also corroborated by Figure 2, in which representation begins to change before reaching \(=1\).)We provide additional computational experiments in different settings in the appendix, as well as details for how we determine the empirically objective-maximizing recommendations.

### Continuous Items and User Preferences

We now depart from our assumption that user preferences and items fall into discrete types, and instead represent both by embeddings on the unit \(d\)-dimensional sphere \(S^{d}\). Given a user preference \(t S^{d}\) and an item \(v S^{d}\), we let the value of item \(v\) be equal to the dot product \((t v,0)\). Thus, items that are closer to a user's true preference have higher value and items cannot have negative value. For a set of \(n\) recommendations, we again let accuracy measure the average value of recommended items and utility measure the value of the best-recommended item (that of the highest value). We then compare the performance of an accuracy-maximizing set of recommendations with a heuristically constructed set of diverse recommendations. Our results are plotted in Figure 4. In alignment with our general findings, the accuracy-maximizing set of recommendations is homogeneous, while a diverse set of recommendations improves user utility.

Specifically, we use 10-dimensional embeddings trained using interaction data from GoodReads between 1000 users and 200 books. Embeddings are normalized to lie on \(S^{10}\). We assume user preferences are drawn uniformly from the set of books they have interacted with (since these represent the range of interests the user has). We limit our experiments to the 206 users with at least 20 total interactions. For each user, we consider a "train set" of 10 of the user's past interactions. We then select \(n\) of the 190 remaining books to recommend. The accuracy-maximizing set is chosen to maximize accuracy when user preferences are assumed to be drawn from the train set. The diverse set is chosen by choosing the closest items to each of the books in the train set (thus, covering the full range of user interests). We evaluate recommendations by randomly drawing a user preference from the books they have interacted with that were not already included in the train set. Additional details for our experiment are given in the appendix.

## 6. Conclusion

We introduced and analyzed a model of recommendations that reconciles the apparent accuracy-diversity trade-off. In particular, we showed that accuracy is misaligned with user utility, because it does not consider the consumption constraints of users. By accounting for these consumption constraints, we found that user utility is in fact aligned with and supported by diversity. As a consequence, navigating the accuracy-diversity trade-off can be viewed as a way of incorporating diversity to help align accuracy with the more fundamental goal of user utility. Our results provide insight into how diversity can be incorporated in this manner.

  & (S_{n,k})\)**when \((p_{1},p_{2})=(0.7,0.3)\) and \(q_{t,i}=0.5(i+1)^{-}\)**.**} \\    &  &  &  &  \\   & \(k=1\) & \(k=2\) & \(k=5\) & \(k=10\) & \(k=1\) & \(k=2\) & \(k=5\) & \(k=10\) & \(k=1\) & \(k=2\) & \(k=5\) & \(k=10\) & \(k=1\) & \(k=2\) & \(k=5\) & \(k=10\) \\ 
10 & 0.6 & 0.6 & 1.0 & 1.0 & 0.6 & 0.6 & 1.0 & 0.6 & 0.6 & 1.0 & 0.6 & 0.7 & 0.9 & 0.9 & 0.7 & 0.7 & 0.8 & 0.8 & 0.8 \\
20 & 0.55 & 0.55 & 0.6 & 1.0 & 0.55 & 0.6 & 0.7 & 1.0 & 0.6 & 0.65 & 0.8 & 0.95 & 0.65 & 0.7 & 0.75 & 0.8 & 0.77 \\
50 & 0.52 & 0.48 & 0.52 & 0.54 & 0.52 & 0.56 & 0.54 & 0.66 & 0.56 & 0.58 & 0.64 & 0.86 & 0.64 & 0.62 & 0.78 & 0.76 \\
100 & 0.5 & 0.49 & 0.49 & 0.49 & 0.52 & 0.49 & 0.49 & 0.53 & 0.55 & 0.56 & 0.57 & 0.76 & 0.63 & 0.62 & 0.7 & 0.78 \\   

Table 2. Empirical estimates of \(r_{1}(S_{n,k})\) based on \(5000\) iterations for each setting (i.e., entry in table) for each possible set of recommendations. These can be compared with our theoretical result showing that \(_{n}r_{1}(S_{n,1})=0.5\) for \(=0\). Blue indicates especially close to the result for \(r_{1}(S_{n,k})\), and red indicates cases that deviate from the theoretical result. The result is most applicable when \(k\) is small compared to \(n\) and when \(\) is smaller. Note also that \(S_{n,k}\) is relatively diverse in all cases when \(n\) is large compared to \(k\), and with small \(\) (i.e., there are many high-quality items per type).

Figure 4. Book recommendations that maximize accuracy on a train set are more accurate in evaluation, but also achieve less utility and diversity as compared to a heuristically-chosen diverse set. Here, accuracy is the average value of recommended items, utility is the maximum value of recommended items, and diversity is the average cosine distance between recommendations. The numbers plotted are averages over 100 trials for each of the 206 users we evaluated.