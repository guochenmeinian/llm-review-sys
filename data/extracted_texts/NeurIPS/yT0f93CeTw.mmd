# Fast Conditional Mixing of MCMC Algorithms for Non-log-concave Distributions

Xiang Cheng

MIT

x.cheng@berkeley.edu

&Bohan Wang

USTC

bhwangfy@gmail.com

Jingzhao Zhang

IIIS, Tsinghua; Shanghai Qizhi Institute

jingzhaoz@mail.tsinghua.edu.cn

&Yusong Zhu

Tsinghua University

zhuys19@mails.tsinghua.edu.cn

Alphabetical author order

###### Abstract

MCMC algorithms offer empirically efficient tools for sampling from a target distribution \((x)(-V(x))\). However, on the theory side, MCMC algorithms suffer from slow mixing rate when \((x)\) is non-log-concave. Our work examines this gap and shows that when Poincare-style inequality holds on a subset \(\) of the state space, the conditional distribution of MCMC iterates over \(\) mixes fast to the true conditional distribution. This fast mixing guarantee can hold in cases when global mixing is provably slow. We formalize the statement and quantify the conditional mixing rate. We further show that conditional mixing can have interesting implications for sampling from mixtures of Gaussians, parameter estimation for Gaussian mixture models and Gibbs-sampling with well-connected local minima.

## 1 Introduction

Sampling from a given target distribution of the form \((x) e^{-V(x)}\) plays a central role in many machine learning problems, such as Bayesian inference, optimization, and generative modeling . The Langevin MCMC algorithm in particular has received a lot of recent attention; it makes use of the first-order gradient information \( V(x)\), and can be viewed as the sampling analog of gradient descent.

Langevin MCMC has been shown to converge quickly when \((x)\) is log-concave . More recently, similar guarantees have been established for \(p(x)\) satisfying weaker conditions such as log-Sobolev inequality (LSI) , for instance, \((x) e^{-V(x)}\) can have a good LSI constant when \(V(x)\) is a small perturbation of a convex function. However, few guarantees exist for general non-log-concave distributions. One simple example is when \(p(x)\) is a well-separated mixture of two Gaussian distributions; in this case, one verifies that Langevin MCMC mixes at a rate proportional to the inverse of the exponential of the separation distance.

Many important modern machine-learning problems are highly non-convex, one prominent class being functions arising from neural networks. Though finding the global minimum of a non-convex function can be difficult, gradient descent can often be shown to converge rather quickly to a _local optimum_. This raises the important question:

_What is the sampling analog of a local minimum? And how can we sample efficiently from such a minimum?_In , authors provide a partial answer to this question by adopting the view of Langevin Diffusion as the _gradient flow of KL divergence in probability space_. Under this perspective, the _gradient_ of KL divergence is given by the Fisher Information (FI). Authors of  show that LMC achieves \(\) error in FI in \(O(1/^{2})\) steps.

However, one crucial question remains unanswered: how does the local optimality of FI help us sample from non-convex distributions? Intuitively, small FI is useful for characterizing local convergence when \(\) is multi-modal. Authors of  suggested this connection, but it remains unclear how local mixing is defined and how _small FI_ can quantitatively lead to _good local mixing_. Thus motivated, one of the goals of this paper is to provide a useful interpretation of the FI bound.

To this end, we propose a rigorous quantitative measure of "local mixing". We also provide a more general notion of "stationary point" for the sampling problem. Under these definitions, we show that LMC can achieve \(\) error in our proposed "measure of local mixing", in polynomial time. Finally, we consider discrete-time analog of the aforementioned ideas, and prove local convergence for random walk on a hypercube. Below is a detailed description of our theoretical contributions.

### Main Contributions

1. We define a notion of _conditional convergence_: Let \(\) denote a subset of the state space. We study the convergence of \(_{t}|\) to \(|\), where \(_{t}\) denotes distributions of LMC iterates and \(\) denotes the target distribution. This definition of convergence is much weaker than the standard global convergence, but in exchange, LMC can achieve fast conditional convergence in settings where global convergence is known to be exponentially slow.
2. We define local Logarithmic Sobolev Inequality and show how to combine it with existing results on the convergence of Fisher information to derive the conditional convergence of LMC.
3. When local Logarithmic Sobolev Inequality does not hold, we define local Poincare Inequality and Poincare Fisher information (which is an analogy of Fisher information). We show the convergence of Poincare Fisher information assuming strong dissipativity and show the conditional convergence of LMC when local Poincare Inequality is present.
4. To showcase the applications of our results, we respectively study sampling from Gaussian mixture model with the same covariance and sampling from the power posterior distribution of symmetric two-component Gaussian mixtures. The global isometric constants of these examples are exponential in dimension and may have slow global convergence. We show that the local isoperimetric constants of these examples are polynomial in dimension, and prove fast conditional convergence for these examples.
5. In Theorem 1, we consider an application of our result to Gibbs sampling on discrete state space. We show that fast conditional mixing happens when the spectral gap is not small. We further show in Theorem 2 that a subset has large spectral gap if it contains only one local minimum and is well connected.

## 2 Related Work

When the target distribution \(\) is strongly log-concave, the entropy \(_{}[]\) is known to be strongly convex with respect to \(\), and thus Langevin Dynamics converges exponentially fast . Such a result is later extended to LMC [8; 4; 9; 7; 21]. Several works further loosen the assumption by using isoperimetric inequalities such as Logarithmic Sobolev Inequality and Poincare Inequality instead of strong log-concavity [24; 5; 25; 11]. However, there are few existing works on general non-log-concave sampling. Recently, Balasubramanian  defines convergence in relative Fisher information as a kind of "weak convergence" for sampling and proves a polynomial guarantee in general non-log-concave case only assuming global Lipschitz condition. However, this paper doesn't give any rigorous statistical interpretation of this weak convergence; Majka et al.  and Erdogdu et al.  study the cases when the target distribution is non-log-concave but has some good tail growth or curvature; Ma et al.  analyze the situation when the target distribution is non-log-concave inside the region but log-concave outside. Although these works give strict proofs of polynomial time guarantee in their setting, their results only hold for a small branch of non-log-concave distributions. It is still hardly possible to obtain a polynomial guarantee in general non-log-concave cases. Multimodality, as a special case of non-log-concavity, has attracted lots of attention due to its prevalence in applied science. Many modified versions of MCMC were proposed to try to tackle the sampling of these distributions, such as Darting MC , Wormhole HMC , and etc. However, these algorithms require explicit knowledge of the location of the modes.

## 3 Conditional Mixing for MCMC

In this section, we provide a formal definition of "conditional mixing". Specifically, let \(_{t}\) denote the distribution of a Markov chain \(\{Z_{t}\}_{t}\) at time \(t\). We assume that the Markov chain dynamics is reversible with a unique stationary distribution \(\). Existing analyses mostly focus on understanding the rate of convergence measured by \(d(_{t},)\) where \(d\) is some probability distance.

However, unless the stationary distribution \(\) satisfies certain restrictive properties (e.g., log-concavity), the rate of convergence can be exponentially slow in the problem dimension or the distribution moments even for simple distributions such as the mixture of Gaussians. For this reason, we consider a weaker notion of convergence below.

**Definition 1** (Conditional mixing).: _Given a distribution \(_{t}\) supported on the state space \(\). We say \(_{t}\) converges conditioned on set \(\) with respect to the divergence \(d\) if_

\[d(_{t}|,|),\]

_where we have the conditional distribution_

\[_{t}|(x)=(x)\{x\}}{_{ t}()}.\]

For now we can think of the distance \(d\) as the total variation distance. Later we will discuss stronger divergence such as KL-divergence or Chi-squared divergence.

The focus of our work is on identifying several sufficient conditions for fast convergence, and quantitatively bounding the convergence rate under these conditions. We focus on two MCMC algorithms: the Langevin Monte Carlo in continuous space, and the Gibbs sampling algorithm in discrete space. We further discuss the implications of conditional convergence for the two algorithms.

## 4 Conditional Mixing for Langevin Monte Carlo

In this section, we study the conditional mixing of the Langevin Monte Carlo (LMC) algorithm. This section is organized as follows: in Subsection 4.1, we first introduce the Langevin Monte Carlo algorithm, Langevin Dynamics, functional inequalities, and the Fisher information; in Subsection 4.2, we provide our main results characterizing the conditional convergence of LMC; finally, in Subsection 4.3, we showcase two applications of our main results.

### Preliminaries

**Langevin Monte Carlo.** We are interested in the convergence of Langevin Monte Carlo (LMC), which is a standard algorithm employed to sample from a target probability density \( e^{-V}:^{d}\), where \(V\) is called the _potential function_. The pseudocode of LMC is given in Algorithm 1.

```
0: Initial parameter \(z\), potential function \(V\), step size \(h\), number of iteration \(T\)
1: Initialization \(z_{0} z\)
2:For\(t=0 T\):
3: Generate Gaussian random vector \(_{t}(0,_{d})\)
4: Update \(z_{(t+1)h} z_{th}-h V(z_{th})+_{t}\)
5:EndFor ```

**Algorithm 1** Langevin Monte Carlo

LMC can be viewed as a time-discretization of Langevin Dynamics (LD), described by the following stochastic differential equation:

\[Z_{t}=- V(Z_{t})\,t+B_{t}.\] (1)We can interpolate LMC following the similar manner of LD as

\[Z_{t}=- V(Z_{kh})\,t+B_{t},\;t[kh,kh +1),\;k.\] (2)

One can easily observe that \(\{Z_{kh}\}_{k=0}^{}\) in Eq. (2) has the same joint distribution as \(\{z_{kh}\}_{k=0}^{}\) in Algorithm 1, and thus Eq. (2) is a continuous-time interpolation of Algorithm 1.

**Poincare Inequality & Logarithmic Sobolev Inequalities.** The convergence of LMC does not necessarily hold for all potential functions, and quantitative bounds require specific conditions over the potential function \(V\). Poincare Inequality (PI) and Logarithmic Sobolev Inequality (LSI) are two commonly used conditions in the analysis of LMC convergence. We present these below:

**Definition 2** (Poincare Inequality).: _A probability measure \(\) on \(^{d}\) satisfies the Poincare inequality with constant \(\) > 0 (abbreviated as \(()\)), if for all functions \(f:^{d}\),_

\[\| f(x)\|^{2}\,(x)_{}[f].\] (PI)

**Definition 3** (Logarithmic Sobolev Inequality).: _Given a function \(f:^{d}^{+}\) and a probability measure \(\) on \(^{d}\), define \(_{}(f) f f\,(x)- f\, (x)( f\,(x))\). We say that a distribution \(\) on \(^{d}\) satisfies the Logarithmic Sobolev Inequality (abbreviated as \(()\)) with some constant \(\), if for all functions \(f:^{d}^{+}\),_

\[_{}}{f}\,(x)\, _{}(f).\] (LSI)

Both PI and LSI can imply the convergence of LMC when the step size \(h\) is small. **Specifically, denote \(_{th}\) as the distribution of \(z_{th}\) in LMC (Algorithm 1) and \(_{t}\) as the distribution of \(Z_{t}\) in Langevin Dynamics (Eq.(1)).** We further denote \(_{t}\) as the distribution of \(Z_{t}\) interpolating LMC. The left-hand-side of Eq.(PI) with \(f=_{t}}{}\) is then the derivative (w.r.t. time) of the entropy of \(f\), i.e., \(_{}[_{t}}{}]\), and thus we directly establish the exponential convergence of \(_{p}[_{t}}{}]\). The convergence of LMC can then be induced by bounding the discretization error between LMC and Langevin Dynamics. The methodology is similar when we have LSI.

**Fisher information.** It is well-known that if \(V\) is either strongly convex or convex with bounded support, then it obeys both PI and LSI, and the convergence of LMC follows immediately according to the arguments above. However, real-world sampling problems usually have non-convex potential functions, and for these problems we may no longer have either PI or LSI. If we revisit the above methodology to establish the convergence of LMC under LSI, we find that we still have

\[}{t}\,_{}[_{t }}{}]=-\|_{t}}{}(x)\|^{2 }_{t}(x),_{}[_{0}}{} ]-_{}[_{T}}{}]=_{0}^{T }\|_{t}}{}(x)\|^{2}_ {t}(x)\,t,\]

and thus \(_{T}_{t[0,T]}\|_{t}}{} (x)\|^{2}(x)=0\). Following this methodology,  uses the considers a notion of convergence which is defined using Fisher Information \((\|)\|/\|^{2}\,\), which they use to analyze LMC convergence. We present the result of  for completeness:

**Proposition 1** (Theorem 2, ).: _Assume \( V\) is \(L\)-lipschitz. Then, for any step size \(h(0,)\),_

\[_{0}^{Th}_{}(_{t}\|)t (}{})}{Th}+8L^{2}dh.\]

### Rates of convergence

#### 4.2.1 Conditional mixing under local Logarithmic Sobolev Inequality

We first show that if the target distribution \(\) obeys a local Logarithmic Sobolev Inequality (defined below), then convergence of Fisher information implies conditional convergence.

**Definition 4** (Local Logarithmic Sobolev Inequality).: _We say that a distribution \(\) on \(^{d}\) satisfies the local Logarithmic Sobolev Inequality over a subset \(S^{d}\) with some constant \(\) (abbreviated as \(_{S}()\)), if \(|S\) satisfies \(LSI()\)._Definition 4 characterizes the local property of one distribution. It is considerably weaker than global LSI (i.e., Definition 3) when \(S\) is convex, and recovers LSI when \(S=^{d}\). The intuition is that when the distribution is multi-modal, it is quite possible that LSI does not hold (or hold but with an exponentially small constant). In contrast, we can reasonably expect local LSI hold within each mode. In Subsection 4.3, we will show that a Gaussian mixture model with the same covariance satisfies Local Logarithmic Sobolev Inequality. We show in the following lemma that, whenever we have an estimation on the Fisher information between \(\) and \(\), we can turn it to an estimation of the entropy between \(|S\) and \(|S\) given \(_{S}()\).

**Lemma 1**.: _Let \(S\) and assume that \(\) obeys \(_{S}()\). For any distribution \(\) such that \((||)\), we have that either \((S)}{}\), or \(_{|S}[]}{ }\)._

We defer the proof of Lemma 1 to Appendix A.1. Intuitively, Lemma 1 states that if the distribution \(\) satisfies local LSI over the region \(S\) and has small global Fisher information with respect to a distribution \(\), one can expect that either the probability mass of \(\) over \(S\) is minor, or \(\) is close to \(\) both conditional over \(S\). In other words, \(\) is close to \(\) conditional over \(S\) whenever \(\) has a moderate mass over \(S\). Note that Proposition 1 has already guaranteed global FI of LMC with little assumption, which together with Lemma 1 leads to the following corollary:

**Corollary 1**.: _Assume \( V\) is \(L\)-lipschitz and \(S\) satisfies that \(\) obeys \(_{S}()\). Define \(_{Th}=^{Th}_{t}\,t}{Th}\). Choosing step size \(h=}\), we have that either \(_{Th}(S)( (}{})}}{})\), or_

Corollary 1 is one of our key results. Intuitively, it shows that LMC can achieve local mixing when only local LSI is assumed. As we discussed under Definition 4, we can reasonably expect that local LSI holds within each mode when the distribution is multi-modal, in which case Corollary 1 can be further applied to show local mixing with polynomial rate. Note here the dependence of the local mixing rate is polynomial over the dimension \(d\), meaning that considering local mixing helps to get rid of the exponential dependence over the dimension \(d\) in the global mixing rate when studying multi-modal distributions.

#### 4.2.2 Conditional Convergence under local Poincare Inequality

We have established the conditional convergence of LMC under local Logarithmic Sobolev Inequality above. However, there are cases where even local LSI fails to hold. To tackle these cases and inspired by Poincare Inequality, we introduce a weaker notion than local LSI called local Poincare Inequality:

**Definition 5** (Local Poincare Inequality).: _A distribution \(\) on \(^{d}\) satisfies the local Poincare Inequality over a subset \(S^{d}\) with constant \(\) (abbreviated as \(_{S}()\)), if \(|S\) satisfies \(()\)._

As Poincare Inequality is weaker than Logarithmic Sobolev Inequality, one can easily see that local Poincare Inequality is also weaker than local Logarithmic Sobolev Inequality. Based on local Poincare Inequality, we have the following Poincare version of Lemma 1, which converts an estimation of Poincare Fisher information to an estimation of chi-squared divergence of the conditional distributions.

**Lemma 2**.: _Define Poincare Fisher information as \((||)\|(/)\|^{2}\,\). Let \(S\) and assume that \(\) obeys \(_{S}()\). For any distribution \(\) such that \((||)\), we have that either \((S)^{2}_{|S}[]\)._

To derive the conditional convergence of LMC under local Poincare inequality, we further need to bound Poincare Fisher information of LMC. Such a result, however, does not exist in the literature to our best knowledge. In analogy to the analysis in , we develop the following lemma to control the Fisher information of LD (recall that \(_{t}\) is the distribution of Langevin Dynamics in time \(t\)).

**Proposition 2**.: _Denote \(}_{Th}=^{Th}_{t}\,t}{Th}\). Then, we have the following estimation of the PFI between \(}{_{Th}}\) and \(\)._

\[(}_{Th}\|)\,\,t_{}[_{0}}{}]}{2Th}.\]The proof can be directly derived by taking the derivative of \(_{}[}{2}]\) with respect to \(t\). We defer the formal proof to Appendix A.2. Combining Lemma 2, Proposition 2, and recent advances in discrete error analysis of LD , we obtain the following result showing conditional convergence under local Poincare inequality.

**Corollary 2**.: _Assume \( V\) and \(^{2}V\) is \(L\)-lipschitz, \(V\) satisfies strong dissipativity, i.e., \( V(x),x m\|x\|^{2}-b\), and \(S\) satisfies that \(|_{S}\) obeys \(()\). Initialize \(z_{0}(0,^{2})\) and select \(h=(_{}[}{2}]^{}}{T^{}^{}d})\). Recall that \(_{Th}=^{T_{h}}_{t}t}{Th}\). Then either \(_{Th}(S)=(_{}[}{2}]^{}}{^{}T^{}}})\), or \(D_{TV}[_{Th}|S|||S]=(} _{}[}{2}]^{}}{^{}T^{ }})\)._

Corollary 2 shows that conditional mixing can be established when local PI holds, which is a weaker assumption than local LSI. However, the assumption of Corollary 2 is stronger than its LSI counterpart, and the mixing rate depends on \(_{}[}{}]\) instead of \((_{0}}{})\), which can be considerably large. These drawbacks are mainly due to that the dynamics of chi-square distance are much harder than that of KL divergence, even when global PI holds .

**Extension to Renyi divergence.** In some prior works, e.g. [5; 23], Renyi divergence is considered a natural "measure" of convergence, due to the analytical simplicity of the resulting expressions. One may wonder if our methodology above can be extended to establish a local mixing rate of Renyi divergence. Unfortunately, there are technical difficulties which for now we have not find a way to tackle or bypass, which we list in Appendix A.3.

### Applications

In this subsection, we apply Corollary 1 and Corollary 2 to two concrete examples to demonstrate their usage in obtaining local mixing rates. We start by analyzing the example of sampling from Gaussian Mixture Models with uniform covariance and then turn to the example of sampling from the power posterior distribution of symmetric two-component Gaussian mixtures.

#### 4.3.1 Case Study: Sampling from Gaussian Mixture Model with the uniform covariance

**Target distribution and potential function.** We are interested in the gaussian mixture model formed by gaussians with the same variance but different means. Specifically, the target distribution is defined as \(=_{i=1}^{n}w_{i}p_{i}(^{d})\), where \(w_{i}>0\), \(_{i=1}^{n}w_{i}=1\), \(p_{i}(_{i},)\) and \(^{2}_{d}\). The potential function is then defined as \(V(x)=-(_{i=1}^{n}w_{i}p_{i}(x))\).

**Partition of Space.** We divide the space according to the sub-level set. Specifically, we define \(S_{i}\{x:p_{i}(x) p_{j}(x), j i\}\). One can easily verify that \(_{i=1}^{n}S_{i}=^{d}\). Furthermore, \(S_{i}\) is convex since by the definition of \(p_{i}\), we have

\[S_{i}= \{x:(x-_{i})^{}^{-1}(x-_{i})(x-_ {j})^{}^{-1}(x-_{j}), j i\}.\]

As \(\) is positive definite and symmetric, we can decompose \(\) into \(UU\), where \(U\) is also positive definite and symmetric. We then obtain

\[U^{-1}S_{i}=\{x:(x-U^{-1}_{i})^{}(x-U^{-1}_{i})(x-U^{-1}_{j}) ^{}(x-U^{-1}_{j}), j i\},\]

and thus \(U^{-1}S_{i}\) is one region of the Voronoi diagrams generated by \(\{U^{-1}_{i}\}_{i=1}^{n}\), which is convex. As \(S_{i}\) can be obtained by performing linear transformation to \(U^{-1}S_{i}\), we obtain that \(S_{i}\) is also convex.

**Verification of local Logarithmic Sobolev Inequality.** We prove the local Logarithmic Sobolev Inequality of \(\) over each partition \(S_{i}\) as follows.

**Lemma 3**.: _For all \(i\{1,,n\}\), \(|S_{i}\) obeys \((_{i[n]}w_{i}}{_{i[n]}w_{i}})\)._

Lemma 3 is proved by first showing \(p_{i}|S_{i}\) obeys \((^{-2})\) through Bakry-Emery criterion due to the convexity of \(S_{i}\) and \(p_{i}\) is strongly convex, and then applying Holley-Stroock perturbation principle by viewing \(\) as a perturbation of \(p_{i}\) over \(S_{i}\). The concrete proof is deferred to Appendix B.1.

**Verification of Lipschitz gradient.** By direct calculation, we derive the following bound on the Lipschitz constant of \( V\).

**Lemma 4**.: \( x^{d}\)_, \(\|^{2}V(x)\|\|_{i}-_{j}\|^{2}}{^{4}}+ ^{-2}\)._

As a conclusion, we obtain the following guarantee of running LMC over this example.

**Corollary 3**.: _Let the stepsize of LMC be \(h=(})\). Assume \(T>(}{^{4}}w_{i}^{2}}{^{ -4}_{i[n]}w_{i}^{2}})\). Then, for every \(i[n]\), either \(_{Th}(S_{i})\), or \(_{|S_{i}}[_{Th}|S_{i}}{|S_{i}} ]\)._

Corollary 3 indicates that running LMC over gaussian mixture distribution (with the same covariance) can ensure local mixing with cost polynomial over the dimension and independent of the distance between the means. By contrast, it is a folk-tale that even the global mixing of gaussian mixture with 2 components has a global mixing rate exponential over the distance, which suggests local mixing analysis provide a more concrete analysis of what is going on over each component.

#### 4.3.2 Sampling from the power posterior distribution of symmetric Gaussian mixtures

**Target distribution and potential function.** The symmetric Gaussian mixture model is given as

\[f_{_{0}}(x)(x;_{0},_{d})+ (x;-_{0},_{d}).\]

Here \((x;_{0},_{d})\) denotes the multivariate Gaussian distribution with location parameter \(_{0}^{d}\) and covariance matrix \(_{d}\). Without loss of generality, we assume \(_{0}\{e_{1}\}\), i.e., all coordinates of \(_{0}\) except the first is zero, and \(_{0}=\|_{0}\|e_{1}\). The power posterior distribution, or the target distribution, is defined as \(_{n,/n}(\{X_{i}\}_{i=1}^{n}):=^{ n}\{f_{}(X_{i})\}^{/n}()}{_{i=1}^{ n}\{f_{}(X_{i})\}^{/n}(u)du}\). We set \( 1\) for simplicity. When no ambiguity is possible, we abbreviate \(_{n,/n}(\{X_{i}\}_{i=1}^{n})\) as \(()\). The potential function is then given as \(V():=_{i=1}^{n}(( -X_{i})+(+X_{i}))+ ()\).

**Partition of Space.** With an accuracy budget \(\), we define \(R_{1}=[0,A](0,M)\), \(R_{2}=[-A,0](0,M)\), and \(R_{3}=(R_{1} R_{2})^{c}\), where \(A\) and \(M\) are \(\)-dependent hyperparameter specified latter.

**Verification of local Poincare Inequality over \(R_{1}\) and \(R_{2}\).** We have the following characterization for the local Poincare Inequality over \(R_{1}\) and \(R_{2}\):

**Lemma 5**.: _If \(A,M\|_{0}\|+1\) and \(n((A+M)^{2}d(1/))\), then with probability at least \(1-\) with respect to the sampling of \(\{X_{i}\}_{i=1}^{n}\), we have that \(\) obeys \(_{R_{1}}((1/(A^{4}M^{2})))\) and \(_{R_{2}}((1/(A^{4}M^{2})))\)._

The lemma is derived by first considering the distribution \(\) corresponding to the potential function \(=V\) and proving local Poincare Inequality of \(|R_{1}\) (or \(|R_{2}\)), then bounding the difference between \(\) and \(V\) through concentration inequality, and finally completing the proof by applying Holley-Stroock perturbation principle to pass local Poincare Inequality from \(|R_{1}\) to \(|R_{1}\). A concrete proof is deferred to Appendix B.2.

**Verification of strong dissipativity.** Similar to local Logarithmic Sobolev Inequality, we can show strong dissipativity of \(V\) holds in high probability.

**Lemma 6**.: _If \(n>((d+\|_{0}\|^{2})(1/))\), then with probability at least \(1-\) over the sampling of \(\{X_{i}\}_{i=1}^{n}\), \(\|^{2}V()\|(1+\|_{0}\|^{2}), V( ),(\|\|^{2})-(\|_{0} \|^{2}+1)\), and \(\|^{3}V()\|(d)\)._

**Bounding the probability of \(R_{3}\).** Using strong dissipativity, we can bound \(_{t}(R_{3})\) as follows.

**Lemma 7**.: _If \(n>((d+\|_{0}\|^{2})(1/))\), then with probability at least \(1-\) over the sampling of \(\{X_{i}\}_{i=1}^{n}\), we have \(_{t}(R_{3}) 32e^{\|^{2}+1)+6d-\{A,M \}^{2}}{2}}\)._

All in all, we obtain the following characterization of running LMC over this example.

**Corollary 4**.: _Initialize \(z_{0}(0,^{2})\) for \(^{2}\) and select \(h=(}})\). Set \(A=M=(d+(1/))\). If \(T=(d^{2}/^{12})\) and \(n>((d+\|_{0}\|^{2})(1/))\), then with probability at least \(1-\) over the sampling of \(\{X_{i}\}_{i=1}^{n}\), either \(_{Th}(R_{i})\) or \(D_{TV}[_{Th}|R_{i}|||R_{i}]\) for \(i\{1,2\}\), and \(_{Th}(R_{3})\)._As a comparison, such a problem was also studied by , where they constructed a specific sampling algorithm with prior knowledge of this problem to achieve global convergence. In contrast, we analyze LMC, which does not require any prior knowledge of the problem, and derive the conditional convergence of LMC.

## 5 Conditional Mixing for Gibbs Sampling on Finite States

In previous sections, we showed that conditional mixing can happen for LMC on a continuous state space. We now show that similar results hold for MCMC algorithms on a finite state space. For simplicity, we consider an energy function \(f:\{0,1\}^{d}\{0,1,2,...,M\}=:[M]\) defined on the vertices of a hypercube. Denote its corresponding Gibbs measure \((x) e^{-f(x)}\).

We consider vertices of the hypercube as a d-regular graph where for any \(x,y\{0,1\}^{d}\), an edge exists \(x y\) if and only if they differ by one coordinate, \(d_{}(x,y)=1\). Then a _lazy Gibbs sampler_ has the following transition matrix on this finite graph:

\[p(x,y)=,&y x,\\ 1-_{x^{},\ x^{} x})}{(x^{})+(x)},&y=x,\\ 0,&.\]

Note that the process is lazy because, \(p(x,x) 1/2\) for any \(x\). This is assumed for simplicity of analysis to avoid almost periodic behaviors. This assumption does not make the analysis less general, as a lazy self loop with probability \(1/2\) only changes the mixing time by a multiplicative absolute constant (see Corollary 9.5 ).

To prove conditional convergence, we need an analogue of conditional Poincare Inequality. The story for the discrete state space can be more convoluted as the transition matrix, in addition to the stationary distribution, plays a role here. Many of the analyses below are inspired by .

First, given a finite number of subsets \(\{_{i}\}_{i m}\), we define the conditional probability \(_{i}=|_{i}\) supported on \(_{i}\), and hence for \(w_{i}=(_{i})\),

\[(x)=_{i=1}^{m}w_{i}_{i}(x)\{x_{i} \}.\]

We also need to design a conditioned transition kernel so that \( x,y_{i}\),

\[p_{i}(x,y)=p(x,y)+\{x=y\}P(x,_{i}^{c}),\] (3)

where \(_{i}^{c}\) denotes the complement of \(_{i}\), and hence the conditioned kernel simply rejects all outgoing transitions. Then we can easily tell that \(p_{i}\) is reversible with a unique stationary distribution \(_{i}\). We are now ready to give an analogue of Corollary 1.

**Theorem 1**.: _Given a sequence of subsets \(\{_{i}\}_{i m}\). If for every \(i\), \(P_{i}\) defined in (3) as a distribution on \(_{i}\) has spectral gap at least \(\), then we have that either for some \(t\), the distribution \(_{t}\) has small probability on \(_{i}\), \(_{t}(_{i})(_{i})T^{-1/4}\), or the conditional mixing happens with respect to Chi-squared divergence,_

\[_{t}_{_{i}}[|_{i}}{|_{i}}]}_{}[}{}].\]

The proof builds upon the convergence of the Dirichlet form and can be found in C. The above theorem suggests that if the spectral gap of the Gibbs sampling algorithm is lower bounded on a local subset, then after a polynomial number of iterations, we get either \(_{t}\) has very small probability on this set, or conditioned on the set, the distribution is close to the stationary distribution.

One thing less clear, in finite-state Gibbs sampling as compared to the LMC, is when would the spectral gap for a Gibbs distribution be large. For the Langevin Monte Carlo algorithm, classical results show that the spectral gap cannot be too small if the stationary distribution is locally near log-concave. Below we provide an analogue of this observation for discrete state space.

### Spectral Gap for Gibbs Sampling

We first define a graph \(=(V,E)\), where \(V=\{0,1\}^{d},\) and \((x,y) E\) if and only if \(d_{}(x,y)=1\). Then we define quasi-concavity in this case. Note that Gibbs sampling in each iteration can only move to a neighbor or stay at the current vertex. Then we introduce the counterpart of quasi-convexity on a function defined on vertices of graphs.

**Definition 6**.: _Let \(=(V^{},E^{})\) be a subgraph, \(V^{} V,E^{}=(x,y) E|x V^{},y V^{}\). We say a function \(f:V[M]\) is **quasi-convex with a radius \(\)** on a subgraph \(=(V^{},E^{})\), if there exists a local minimum \(v V^{}\) such that for any \(v V^{}\), any shortest path \(v v_{1}... v^{}\) from \(v v^{}\) is of length at most \(D\), and \(f\) is non-increasing along the path._

Before providing a guarantee for the spectral gap, we give two examples of quasi-convexity.

**Example 5.1**.: _If \(g:^{+}\) is a quasi-convex function defined on positive reals. Then for a given \(x^{} V^{} V\) any function \(f(x)=g(a d(x,x^{})+b)\) is a quasi-convex function on the graph where \(a,b\) are reals and \(d(x,y)\) is the shortest path length from \(x\) to \(y\)._

**Example 5.2**.: _If on a subset \(V^{} V\), \(f(x)=c^{T}x\) for some \(c^{d},x\{0,1\}^{d}\) (i.e. \(f\) is a linear function), then \(f\) is quasi-convex on the graph._

The next theorem states that for such a function, the spectral gap is polynomial in problem dimension \(d\) and the diameter of the region \(D\).

**Theorem 2**.: _If a function \(f\) is quasi-convex with a radius \(\) on a subset \(_{i}\{0,1\}^{d}\), then the conditional transition of Gibbs sampling defined in (3) has a spectral gap lower bounded by \(D^{2}}\)._

The proof studies the conductance of the Markov chain and can be found in Appendix D. The above theorem suggests that although Gibbs sampling can mix very slowly, on any subset with a well connected local minimum, the conditional mixing to the stationary distribution can be fast. This concludes our analysis and we move on to verify our statements with experiments in the next section.

## 6 Experiments

### Observations on Gaussian Mixture

In this section, we conduct experiments to verify the theoretical results and compare global mixing versus conditional mixing for Gaussian mixture models. We take three Gaussian mixtures: \(_{1}=0.9_{1}(-10,1)+0.1_{1}(10,1)\), \(_{2}=0.15_{1}(-5,1)+0.15_{1}(-2.5,1)+0.3_{1 }(0,1)+0.2_{1}(2.5,1)+0.2_{1}(5,1)\), and \(_{3}=0.4_{2}((-5,-5),I_{2})+0.4_{2}((5,5),I_{2})+0.1 _{2}((-5,5),I_{2})+0.1_{2}((5,-5),I_{2})\) as our target distributions. We use Algorithm 1 as our sampling algorithm, and set step size \(h=10^{-2}\). The initial distributions are both uniform in a large enough range. We plot the sampling distribution after \(T=500,5000,500\) rounds respectively in Figure 0(a), 0(b), and 0(c), and plot the conditional and global KL divergence in Figure 0(d), 0(e), and 0(f).

We make the following observations: **(1)** The global KL divergences of the sampling distributions of \(_{1}\) and \(_{3}\) decrease fast at first. Then they maintain at a constant level and never converge to 0. It is reasonable since \(_{1},_{3}\) have very bad LSI constants (exponential in the distance between means). Thus, by classic Langevin Danymics analysis results, global KL divergence would have an exponentially slow convergence rate. **(2)** Both the global and conditional divergences of the sampling distribution of \(_{2}\) converge very fast. This is because dense Gaussian mixtures like \(_{2}\) have good LSI constant. The KL values are noisy due to the limited calculation precision of KL divergence. **(3)** The conditional divergence of the sampling distribution of \(_{2}\) converges faster than the global divergence because the LSI constant bound of \(_{2}\) is much worse than the conclusion in Corollary 1, which means conditional convergence is faster than global convergence. **(4)** The conditional KL divergences of the sampling distributions of \(_{1}\) and \(_{3}\) converge to 0 very fast (the flat part is due to the limit of calculation precision), which could be seen as a verification of our theoretical result. **(5)** The sampling distributions of \(_{1}\) and \(_{3}\) after \(T\) iterations contain all of the Gaussian components in target distributions, the only difference between them is weight. Since learning the right weight and component will directly lead to global KL convergence, this observation could be seen as an example of the gap between global convergence and conditional convergence.

### Observations on LMC with restarts

In the LMC analysis, We study the evolution of a distribution \(p_{0}\) that usually is an absolutely continuous distribution. However, in practice, a more common implementation is as below: one first randomly generates an initial point \(x_{0}\), runs the sampling algorithm for \(T\) iterations, and then collects samples along a single trajectory. A gap between theory and practice here is that we always assume continuity and smoothness conditions on the initial distribution in theory, while in practice, we only generate a limited number of initial points (sometimes only one point) to run the sampling algorithm.

For log-concave sampling, this gap is usually negligible since the ergodicity of Langevin Dynamics guarantees that we could always capture the features of the target distribution. Thus, it's reasonable that there are plenty of works about the discretization error on the time scale, while we hardly pay attention to the approximation error of initial distribution. When it comes to non-log-concave sampling, this gap may become crucial. We conduct several experiments in Appendix E to verify this conjecture and show that LMC with restarts could empirically help to eliminate the gap and improve the convergence speed.

## 7 Conclusions

Our work examines sampling problems where the global mixing of an MCMC algorithm is slow. We show that in such cases, fast conditional mixing can be achieved on subsets where the target distribution has benign local structures. We make the above statements rigorous and provide polynomial-time guarantees for conditional mixing. We give several examples, such as the mixture of Gaussian and the power posterior to show that the benign local structure often exists despite the global mixing rate is exponentially slow.

Much remains to be done. Theoretically, whether faster convergence rates can be achieved or a lower bound exists remain unknown. Instantiating our analyses to more MCMC algorithms may also lead to new observations. More importantly, the implication of being able to sample efficiently from local distributions requires more careful analysis. This may lead to a new theoretical guarantee for problems with symmetry (such as permutation symmetry, sign symmetry, rotation invariance, etc) where all local minima are equally good and sampling from any mode suffices.

Figure 1: we plot the sampling distributions after \(T\) iterations and the KL divergences w.r.t \(t\)