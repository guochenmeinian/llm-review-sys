# SQ Lower Bounds for Learning Mixtures of Linear Classifiers

Ilias Diakonikolas

University of Wisconsin-Madison

ilias@cs.wisc.edu

&Daniel M. Kane

University of California, San Diego

dakane@cs.ucsd.edu

&Yuxin Sun

University of Wisconsin-Madison

yxsun@cs.wisc.edu

###### Abstract

We study the problem of learning mixtures of linear classifiers under Gaussian covariates. Given sample access to a mixture of \(r\) distributions on \(^{n}\) of the form \((,y_{})\), \([r]\), where \((0,_{n})\) and \(y=(_{},))\) for an unknown unit vector \(_{}\), the goal is to learn the underlying distribution in total variation distance. Our main result is a Statistical Query (SQ) lower bound suggesting that known algorithms for this problem are essentially best possible, even for the special case of uniform mixtures. In particular, we show that the complexity of any SQ algorithm for the problem is \(n^{(1/)(r)}\), where \(\) is a lower bound on the pairwise \(_{2}\)-separation between the \(_{}\)'s. The key technical ingredient underlying our result is a new construction of spherical designs that may be of independent interest.

## 1 Introduction

The motivation behind this work is to understand the computational complexity of learning high-dimensional latent variable (aka mixture) models. The task of learning various mixture models has a long history in statistics with an early focus on sample efficiency, starting with the pioneering work of Karl Pearson  on learning Gaussian mixtures. During the past decades, an extensive line of work in machine learning and theoretical computer science has made significant progress on the computational aspects of this general question for a range of mixture models, including mixtures of high-dimensional Gaussians , mixtures of linear regressions , and more generally mixtures of experts .

In this paper, we focus on mixtures of _linear classifiers_, a classical supervised probabilistic model that has been intensely investigated from both statistical and algorithmic standpoints . A linear classifier (or halfspace) is any Boolean function \(h:^{n}\{ 1\}\) of the form \(h()=(,)\), where \(^{n}\) is known as the weight vector and the univariate function \(\) is defined by \((t)=1\) for \(t 0\) and \((t)=-1\) otherwise. For an integer \(r 2\), we can now formally describe an \(r\)-mixture of linear classifiers. The parameters of the model contain \(r\) unknown positive weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\), and \(r\) unknown unit vectors \(_{1},,_{r}^{n}\). A random sample is drawn from the underlying distribution \(D(,y)\) as follows: the sample oracle selects the index \([r]\) with probability \(w_{}\), and we then receive a random point \((,y)^{n}\{ 1\}\) where \((0,_{n})\) and \(y=(_{},))\). The goal is to approximately estimate the model either by learning the underlying distribution \(D(,y)\) in total variation distance (density estimation), or by approximately recovering the hidden parameters, i.e.,\(w_{}\) and \(_{}\), \([r]\) (parameter estimation). An algorithm for parameter estimation can be used for density estimation (because closeness in parameters can be shown to imply closeness in total variation distance). In that sense, parameter estimation is a harder problem.

Before we proceed to describe prior algorithmic work, we provide basic background on the sample complexity of the problem. We start by noting that density estimation for \(r\)-mixtures of linear classifiers on \(^{n}\) is information-theoretically solvable using \((n,r)\) samples (with the optimal bound being \((nr/^{2})\) for total variation error \(\)) without any assumptions on the components. In contrast, for parameter estimation to be information-theoretically solvable with polynomial sample complexity, some further assumptions are needed. The typical assumption involves some kind of pairwise separation between the component vectors and a lower bound on the mixing weights. Let \(}}{{=}}_{i j}\{\|_{i }-_{j}\|_{2},\|_{i}+_{j}\|_{2}\}>0\) be the pairwise separation between the components and \(w_{}\) be the minimum mixing weight. Under these assumptions, the parameter estimation problem is solvable using \((n,r,1/,1/w_{},1/)\) samples to achieve parameter error of \(\). In both cases, the term "information-theoretically solvable" is used to mean that a _sample-efficient_ algorithm exists, without any constraints on computational efficiency. The main question addressed in this paper is to what extent a _computationally efficient_ learning algorithm exists.

On the algorithmic front,  gave provable parameter estimation algorithms under a \(\)-separation assumption. Specifically,  provided two algorithms with different complexity guarantees. Their first algorithm has sample and computational complexity \((n^{O((r)/^{2})},1/w_{},1/)\), while their second algorithm has complexity \(((n/)^{r},1/w_{},1/)\). Here we focus on settings where the number of components \(r\) is large and cannot be viewed as a constant. For the sake of intuition, it is instructive to simplify these upper bounds for the regime of uniform mixtures (corresponding to the special case that \(w_{}=1/r\) for all \([r]\)) and \(\) is not too small. For this regime, the complexity upper bound achieved in  is \(\{n^{O((r)/^{2})},(n/)^{O(r)}\}\). Concretely, if the separation \(\) is \((1)\) or even \(1/(r)\), the first term yields a quasi-polynomial upper bound. On the other hand, for \(=O(1/r^{c})\), for a constant \(c>0\), the resulting upper bound is \(n^{(r)}\). In both regimes, we observe a _super-polynomial_ gap between the information-theoretic sample complexity -- which is \((n,r,)\) -- and the sample complexity of the  algorithms. It is thus natural to ask if this gap is inherent.

_What is the complexity of learning mixtures of linear classifiers? Is there an algorithm with significantly better_ sample-time tradeoff?

We study these questions in a well-studied restricted model of computation, known as the Statistical Query (SQ) model  (and, via , also for low-degree polynomial tests). _Our main result is that in both of these models the complexity of the above-mentioned algorithms is essentially best possible._ Along the way, we establish new results on the existence of spherical designs on the unit sphere that may be of independent interest.

### Our Results

Basics on SQ ModelSQ algorithms are a class of algorithms that, instead of having direct access to samples, are allowed to query expectations of bounded functions of the distribution. Formally, an SQ algorithm has access to the following standard oracle.

**Definition 1.1** (\(\) Oracle).: Let \(D\) be a distribution on \(^{n}\). A _Statistical Query_ is a bounded function \(f:^{n}[-1,1]\). For \(>0\), the \(()\) oracle responds to the query \(f\) with a value \(v\) such that \(|v-_{ D}[f()]|\). A _Statistical Query (SQ) algorithm_ is an algorithm whose objective is to learn an unknown distribution \(D\) by making adaptive calls to the \(()\) oracle.

The SQ model was introduced in . Subsequently, the model has been extensively studied in a range of contexts ). The class of SQ algorithms is broad and captures a range of known supervised learning algorithms. More broadly, several known algorithmic techniques in machine learning are known to be implementable using SQs .

Our main result is a near-optimal SQ lower bound for mixtures of linear classifiers that applies even for the uniform case. Specifically, we establish the following:

**Theorem 1.2** (Main Result: SQ Lower Bound for Uniform Mixtures).: _Let \( c/r\) for some universal constant \(c>0\) sufficiently small. Then, any SQ algorithm that learns a uniform mixture of linear classifiers with directions \(_{1},,_{r}^{n-1}\) satisfying \(_{i j}\{\|_{i}-_{j}\|_{2},\|_{i}+_{j}\|_{2}\}()\) for some \(r^{-1/10}<1\), within error \(\) in total variation distance must either use queries of tolerance \(n^{-(1/) r}\), or make at least \(2^{n^{(1)}}\) queries._

Informally speaking, Theorem 1.2 shows that no SQ algorithm can perform density estimation for uniform mixtures of linear classifiers to small accuracy with a sub-exponential in \(n^{(1)}\) many queries, unless using queries of very small tolerance - that would require at least \(n^{(1/) r}\) samples to simulate. This result can be viewed as a near-optimal information-computation tradeoff for the problem, within the class of SQ algorithms. In more detail, for \(=(1)\), we obtain a quasi-polynomial SQ lower bound of \(n^{( r)}\); while for \(=1/r^{c}\), for some constant \(0<c<1/2\), we obtain an SQ lower bound of \(n^{(r)}\). In both cases, our SQ lower bounds qualitatively match the previously known algorithmic guarantees  (that are easily implementable in the SQ model).

A conceptual implication of Theorem 1.2 is that the uniform (i.e., equal mixing weights) case is essentially as hard as the general case for density estimation of these mixtures. In contrast, for related mixture models, specifically for mixtures of Gaussians, there is recent evidence that restricting the weights may make the problem computationally easier .

**Remark 1.3**.: We note that the condition \( r^{-c}\), for some constant \(0<c<1\), is necessary in the statement of Theorem 1.2 for the following reason: the algorithmic result of  has sample and computational complexity \(\{n^{O((r)/^{2})},(n/)^{O(r)}\}\), which will be \((n/)^{O(r)}<<n^{(1/) r}\) if \(\) is sufficiently small by inverse polynomial in \(r\).

**Remark 1.4**.: Our SQ lower bound result has immediate implications to another well-studied restricted computational model -- that of low-degree polynomial tests .  established that (under certain assumptions) an SQ lower bound also implies a qualitatively similar lower bound in the low-degree model. This connection can be used as a black-box to show a similar lower bound for low-degree polynomials.

The key technical ingredient required for our SQ lower bound is a theorem establishing the existence of spherical designs with appropriate properties. The definition of a spherical design follows.

**Definition 1.5** (Spherical Design).: Let \(t\) be an odd integer. A set of points \(_{1},,_{r}^{n-1}\) is called a spherical \(t\)-design if \([p()]=_{i=1}^{r}p(_{i})\) holds for every homogeneous \(n\)-variate polynomial \(p\) of degree \(t\), where the expectation is taken over the uniform distribution on the unit sphere \(^{n-1}\).

We note that this definition differs slightly from the usual definition of spherical design, which requires that the equation in Definition 1.5 holds for all polynomials \(p\) of degree _at most_\(t\). However, by multiplying by powers of \(\|\|_{2}^{2}\), we note that our definition implies that the equation holds for every odd polynomial of degree at most \(t\), and it is sufficient for the requirement of establishing our SQ lower bound.

Spherical designs have been extensively studied in combinatorial design theory and a number of efficient constructions are known, see, e.g., . However, none of the known constructions seem to be compatible with our separation assumptions. We establish the following result that may be of independent interest in this branch of mathematics.

**Theorem 1.6** (Efficient Spherical Design).: _Let \(t\) be an odd integer and \(r^{5}\). Let \(_{1},,_{r}\) be uniform random vectors over \(^{n-1}\). Then, with probability at least 99/100, there exist unit vectors \(_{i}^{n-1}\) very close to \(_{i}\) such that \((_{1},,_{r})\) form a spherical \(t\)-design._

We mention here that the optimal sample complexity for the existence of spherical \(t\)-design (for even \(t\)) is \(r=\) and our result matches this within a polynomial factor. Theorem 1.6 is essential for our construction of moment-matching. Roughly speaking, the resulting mixture matches moments in the sense we require if and only if the weight vectors \((_{1},,_{r})\) form a _spherical design_. We mention that the closeness between \(_{i}\) and \(_{i}\) is necessary since this leads to the separation of the hidden weight vectors in the mixture of linear classifiers. In order to guarantee the pairwise separation of the weight vectors \(_{i}\)'s, we note that with high probability the \(_{i}\)'s are pairwise separated and therefore if \(_{i}\) is sufficiently close to \(_{i}\) they will be too.

### Technical Overview

Our starting point is the SQ lower bound technique of  and its generalization in . In particular, our overall strategy is to find a mixture of homogeneous halfspaces in some "small" number \(m\) of dimensions that matches its first \(k\) moments with the distribution on \((,y)\), where \(y\) is independent of \(\). By appropriately embedding this low-dimensional construction into \(^{n}\) via a random projection of \(^{n}^{m}\), the SQ lower bound machinery of  can be shown to imply that learning the projection requires either \(2^{n^{(k)}}\) queries or some query of accuracy \(n^{-(k)}\). This generic step reduces our problem to finding an appropriate \(m\)-dimensional construction. Such a construction is the main technical contribution of this work.

Note that specifying a mixture of halfspaces is equivalent to specifying a probability distribution with support consisting of at most \(r\) unit vectors and specifying the orthogonal vectors of the halfspaces. It is not hard to see that the resulting mixture matches moments in the sense we require if and only if these vectors form a _spherical \(k\)-design_: namely, that for any odd polynomial \(p\) of degree less than \(k\) that the average value of \(p\) over our distribution is the same as the average value of \(p\) over the unit sphere (namely, equal to zero). The bulk of our problem now reduces to finding constructions of weighted designs, where: (1) The support size of the design is relatively small. (2) The points in the design are pairwise separated. (3) For equally weighted mixtures, we require that the weight of each vector in the design is uniform.

In \(m=2\) two dimensions, there is a relatively simple explicit construction that can be given. In particular, if we take \(k\) evenly spaced points over the unit circle for some odd \(k\), this matches the first \(k-1\) moments and has separation \((1/k)\). (This is similar to an SQ construction in  for a different setting.) Unfortunately, we cannot obtain better separation in two dimensions, since any \(k\) unit vectors in two dimensions will necessarily have some pair separated by at most \(O(1/k)\). Therefore, if we want constructions with greater separation, we will need to pick larger values of \(m\). Indeed, we show (Proposition 3.2) that a _random_ collection of approximately \(m^{O(k)}\) points can form the support of an appropriate design. This can be proved by applying linear programming duality. Unfortunately, this argument does not allow us to control the mixing weights. Specifically, it may be the case that the minimum weight is exponentially small which seems unnatural in practice.

The case of equal weights requires a significantly more sophisticated argument. In this case, we need to find a spherical design with uniform weight. Indeed, merely selecting a random support will no longer work. Although there is an extensive literature on finding efficient spherical designs , none of the known constructions seem to be compatible with our separation assumptions. In particular,  proves that for each \(r c_{m}k^{m}\), there exists a spherical \(k\)-design, where \(c_{m}\) is a constant depending only on the dimension \(m\). Although it is plausible that their construction can be adapted to satisfy our separation requirement, their sample complexity has a potentially bad dependence on the dimension \(m\). On the other hand,  achieves the optimal sample complexity \(r\) up to polynomials for all \(m\) and \(k\). However, the construction in  definitely does not satisfy our separation requirement. We note that the sample complexity of \(r=()\) should be optimal, and our results are polynomial in this bound. In conclusion, to establish our SQ lower bound, we need to prove a new technical result. Our starting point to that end will be the work of . The basic plan here will be to select random unit vectors \(_{1},_{2},,_{r}^{n}\), and then -- applying topological techniques -- to show that there is some small perturbation set \(_{1},_{2},,_{r}^{n}\) that is a spherical design. In particular, we will find a continuous function \(F\) mapping degree-\(k\) odd polynomials to sets of \(r\) unit vectors such that, for all unit-norm polynomials \(p\), if \(F(p)=(_{1},,_{r})\) then \(_{i=1}^{r}p(_{i})>0\). Given this statement, a standard fixed point theorem  will imply that our design can be found as \(F(q)\) for some \(q\) with norm less than one. To construct the mapping \(F\), we start with the points \(_{1},,_{r}\) and perturb each \(_{i}\) in the direction of \(_{o}p(_{i})\) in order to try to increase the average value of \(p\), where \(_{o}p(_{i})\) is the component of \( p(_{i})\) orthogonal to the direction \(_{i}\). Intuitively, this construction should work because with high probability the average value of \(p(_{i})\) is already small (since the empirical average should approximate the true average), the average gradient of \(p(_{i})\) is not too small, and the contributions to \(p(_{i})\) coming from higher-order terms will not be large as long as \(_{i}\) is sufficiently close to \(_{i}\). These facts can all be made precise with some careful analysis of spherical harmonics (Lemma 4.5).

Finally, we need to show that the hardness of learning the appropriate projection implies hardness of learning the mixture. By standard facts, it suffices to show that mixtures of linear classifiersare far from the distribution \((,y)\), where the uniform label \(y\) is independent of \(\), in total variation distance. To show this, we prove that the total variation distance between any projection and the distribution where \(y\) is independent of \(\) is at least \((/r)\) (Lemma 3.8).

## 2 Preliminaries

For \(n_{+}\), we denote \([n]}}{{=}}\{1,,n\}\). For two distributions \(p,q\) over a probability space \(\), let \(d_{}(p,q)=_{S}|p(S)-q(S)|\) denote the total variation distance between \(p\) and \(q\). In this article, we typically use small letters to denote random variables and vectors. For a real random variable \(x\), we use \([x]\) to denote the expectation. We use \([]\) and \([]\) for the probability and the indicator of event \(\). Let \(_{n}\) denote the standard \(n\)-dimensional Gaussian distribution and \(\) denote the standard univariate Gaussian distribution. Let \(^{n-1}=\{^{n}:\|\|_{2}=1\}\) denote the \(n\)-dimensional unit sphere. For a subset \(S^{n}\), we will use \((S)\) to denote the uniform distribution over \(S\). We will use small boldface letters for vectors and capital boldface letters for matrices. Let \(\|\|_{2}\) be the \(^{2}\)-norm of the vector \(^{n}\). For vectors \(,^{n}\), we use \(,\) to denote their inner product. We denote by \(^{2}(^{n},_{n})\) the function space of all functions \(f:^{n}\) such that \(_{_{n}}[f^{2}()]<\). The usual inner product for this space is \(_{_{n}}[f()g()]\).

For a matrix \(^{m n}\), we denote \(\|\|_{2}\), \(\|\|_{F}\) to be its spectral norm and Frobenius norm respectively. For a tensor \(A(^{n})^{ k}\), let \(\|A\|_{2}\) denote its spectral norm and \(\|A\|_{F}\) denote its Frobenius norm. We will use \(A_{i_{1},,i_{k}}\) to denote the coordinate of the \(k\)-tensor \(A\) indexed by the \(k\)-tuple \((i_{1},,i_{k})\). The inner product between \(k\)-tensors is defined by thinking of tensors as vectors with \(n^{k}\) coordinates. We use the framework of Statistical Query (SQ) algorithms for problems over distributions  and require the following standard definition.

**Definition 2.1** (Decision/Testing Problem over Distributions).: Let \(D\) be a distribution and \(\) be a family of distributions over \(^{n}\). We denote by \((,D)\) the decision (or hypothesis testing) problem in which the input distribution \(D^{}\) is promised to satisfy either (a) \(D^{}=D\) or (b) \(D^{}\), and the goal of the algorithm is to distinguish between these two cases.

Basics on VC-InequalityWe recall the definition of VC dimension for a set system.

**Definition 2.2** (Vc-Dimension).: For a class \(\) of boolean functions on a set \(\), the _VC-dimension_ of \(\) is the largest integer \(d\) such that there exist \(d\) points \(x_{1},,x_{d}\) such that for any boolean function \(g:\{x_{1},,x_{d}\}\{ 1\}\), there exists an \(f\) satisfying \(f(x_{i})=g(x_{i}),1 i d\).

We will use the following probabilistic inequality.

**Lemma 2.3** (VC inequality, see, e.g., ).: _Let \(\) be a class of boolean functions on \(\) with VC-dimension \(d\), and let \(X\) be a distribution on \(\). Let \(>0\) and let \(N\) be an integer at least a sufficiently large constant multiple of \(d/^{2}\). Then, if \(X_{1},X_{2},,X_{N}\) are i.i.d. samples from \(X\), we have that:_

\[[_{f}|^{N}f(X_{j})}{N} -[f(X)]|>]=(-(N^{2})).\]

To apply the VC inequality in our context, we additionally need the following fact which gives the VC-dimension of the class of bounded-degree polynomial threshold functions (PTFs).

**Fact 2.4**.: _Let \(_{k}\) denote the class of degree-\(k\) polynomial threshold functions (PTFs) on \(^{m}\), namely the collection of functions of the form \(f()=(p())\) for some degree at most \(k\) real polynomial \(p\). Then, the VC-dimension of \(_{k}\) is \((_{k})=\)._

## 3 Warmup: SQ Lower Bounds for General Weight Mixtures

SQ Lower Bound Machinery.We start by defining the family of distributions that we will use to prove our SQ hardness result.

**Definition 3.1** ().: Given a function \(g:^{m}[-1,+1]\), we define \(_{g}\) to be the class of distributions over \(^{n}\{ 1\}\) of the form \((,y)\) such that \(_{n}\) and \([y=]=g()\), where \(^{m n}\) with \(^{}=_{m}\).

The following proposition states that if \(g\) has zero low-degree moments, then distinguishing \(_{g}\) from the distribution \((,y)\) with \(_{n},y(\{ 1\})\) is hard in the SQ model.

**Proposition 3.2** ().: _Let \(g:^{m}[-1,1]\) be such that \(_{_{m}}[g()p()]=0\), for every polynomial \(p:^{m}\) of degree less than \(k\), and \(_{g}\) be the class of distributions from Definition 3.1. Then, if \(m n^{a}\), for some constant \(a<1/2\), any SQ algorithm that solves the decision problem \((_{g},_{n}(\{ 1\}))\) must either use queries of tolerance \(n^{-(k)}\), or make at least \(2^{n^{(1)}}\) queries._

We will apply Proposition 3.2 to establish our SQ lower bound for learning mixtures of linear classifiers. The main technical contribution required to achieve this is the construction of a class of distributions \(_{g}\), where each element in \(_{g}\) represents a distribution of mixture of linear classifiers. In particular, we will carefully choose some appropriate unit vectors \(_{1},,_{r}^{m}\) and non-negative weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\), such that \(_{}\) are pairwise separated by \(>0\).

Let \(g()=_{=1}^{r}w_{}(_{}^{ }),^{m}\). For an arbitrary matrix \(^{m n}\) with \(^{}=_{m}\), we denote by \(D_{}\) the instance of mixture of linear classifiers with weight vectors \(^{}_{1},,^{}_ {r}\) and weights \(w_{1},,w_{r}\). In this way, we have that

\[_{(,y) D_{}}[y=]= _{=1}^{r}w_{}((^{}_{ })^{})=_{=1}^{r}w_{}(_{}^{})=g(), ^{n}.\]

### Low-degree Moment Matching

The following proposition shows that there exist unit vectors \(_{1},,_{r}\) and non-negative weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\) such that \(_{}\) are pairwise separated by some parameter \(>0\) and the low-degree moments of \(g\) vanish. Note that since \(g\) is odd (as the sign function is odd), we only require \(_{_{m}}[g()p()]=0\) for every odd polynomial \(p\) of degree less than \(k\).

**Proposition 3.3**.: _Let \(m=\), where \(r^{-1/10}<1\) and \(1.99 c 2\) is a universal constant. Let \(k\) be a positive integer such that \(r C\) for some constant \(C>0\) sufficiently large. There exist vectors \(_{1},,_{r}\) over the unit sphere \(^{m-1}\) and non-negative weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\), such that_

* \(_{_{m}}[g()p()]=0\) _holds for every odd polynomial_ \(p\) _of degree less than_ \(k\)_, where_ \(g()=_{=1}^{r}w_{}(_{}^{ })\)_._
* \(\|_{i}+_{j}\|_{2},\|_{i}-_{j}\|_{2} (), 1 i<j r\)_._

The proof proceeds as follows: We uniformly sample unit vectors \(_{1},,_{r}^{m-1}\). We will prove by the probabilistic method that both statements in Proposition 3.3 hold with high probability. We begin by showing that \([_{1 i<j r}\{\|_{i}-_{j}\|_{2},\| _{i}+_{j}\|_{2}\}<O()]\) is small. By symmetry, it suffices to bound \([_{1 i<j r}\|_{i}-_{j}\|_{2}<O( )]\). Let \(=_{1 i<j r}(_{i},_{j})\). We require the following facts:

**Fact 3.4** (Proposition 3.5 in ).: \([ r^{-}] 1-}{2} ^{m-1}\)_, where \(_{m}=(m/2)}[ },}]\)._

Applying Fact 3.4 by taking \(=(})^{}\) and \(r=^{m-1}}}\) yields that \([] 99/100\). Given some fixed random vectors \(_{1},,_{r}^{m-1}\), we will prove that with high probability there exist non-negative weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\) such that \(_{_{m}^{}}[g()p()]=0\) holds for every odd polynomial \(p\) of degree less than \(k\), where \(g()=_{=1}^{r}w_{}(_{}^{ })\). Noting that \(_{_{m}}[g()p()]= _{=1}^{r}w_{}_{_{m}}[p( )(_{}^{})]\), it suffices to bound the probability that there exist non-negative weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\) such that \(_{=1}^{r}w_{}_{_{m}}[p( )(_{}^{})]=0\) holds for every odd polynomial \(p\) of degree less than \(k\). Our main technical lemma is the following:

**Lemma 3.5**.: _Let \(p:^{m}\) be a polynomial of degree less than \(k\) and \(f^{2}(,)\). Let \(^{m-1}\) be a unit vector. We have that \(_{_{m}}[p()f(^{ })]\) is a polynomial in \(\) of degree less than \(k\)._The proof proceeds by analyzing \(p\) and \(f\) as Hermite expansions. For completeness, we defer the proof of Lemma 3.5 to Appendix B. From Lemma 3.5, we can write \(_{=1}^{r}w_{}_{_{m}}[p( )(_{}^{})]=_{ =1}^{r}w_{}q(_{})\) for some odd polynomial \(q\) of degree less than \(k\) (since \(\) is odd). In this way, it suffices to show that with high probability there exist non-negative weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\) such that \(_{=1}^{r}w_{}q(_{})=0\) for all odd polynomials \(q\) of degree less than \(k\). To prove this, we leverage the following lemma:

**Lemma 3.6**.: _The following two statements are equivalent._

1. _There exist non-negative weights_ \(w_{1},,w_{r}\) _with_ \(_{=1}^{r}w_{}=1\) _such that_ \(_{=1}^{r}w_{}q(_{})=0\) _for all odd polynomials_ \(q\) _of degree less than_ \(k\)_._
2. _There does not exist any odd polynomial_ \(q\) _of degree less than_ \(k\) _such that_ \(q(_{})>0,1 r\)_._

The proof of Lemma 3.6 follows via a careful application of LP duality; see Appendix B.

Proof of Proposition 3.3.: Let \(=_{1 i<j r}_{i},_{j}\). Applying Fact 3.4 by taking \(=(})^{}\) yields \([][ r^{- {m-1}}] 99/100\) (since our choice of \(m\) will imply \(r=1/^{m-1}}\)). This will imply that

\[_{1 i<j r}\{\|_{i}-_{j}\|_{ 2},\|_{i}+_{j}\|_{2}\}() 99/100\.\]

We then show that there exist non-negative weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\) such that \(_{_{m}}[g()p()]=0\) holds for every odd polynomial \(p\) with degree less than \(k\), where \(g()=_{=1}^{r}w_{}(_{}^{ })\). By Lemma 3.5, it suffices to show that there exist non-negative weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\) such that \(_{=1}^{r}w_{}q(_{})=0\) for all odd polynomials \(q\) of degree less than \(k\). By Fact 2.4, we have that \(r Cm+k\\ k=C(_{k})\) for some sufficiently large constant \(C>0\). Note that for any odd polynomial \(q\) in \(m\) variables of degree less than \(k\), we have that \([(q())]=0\). Therefore, by the VC-inequality (Lemma 2.3), we have that

\[[qkq(_{})>0,1 r]\] \[[_{f_{k-1}}^{r}f(_{})}{r}=1][_{f _{k}}|^{r}f(_{})}{r}-[f()]| 1]\] \[(-(r)) 1/100.\]

Finally, applying Lemma 3.6 completes our proof. 

### Proof of SQ Lower Bound for General Weights

Let \(k\) be a positive integer such that \(r Cm+k\\ k\) for some constant \(C>0\) sufficiently large. Let \(m=\), where \(r^{-1/10}<1\) and \(1.99 c 2\). By Proposition 3.3, there exist unit vectors \(_{1},,_{r}^{m}\) such that

* There exist non-negative weights \(w_{1},,w_{r}\) with \(_{=1}^{r}w_{}=1\) such that \(_{_{m}}[g()p()]=0\) holds for every odd polynomial \(p\) with degree less than \(k\), where \(g()=_{=1}^{r}w_{}(_{}^{ })\).
* \(\|_{i}+_{j}\|_{2},\|_{i}-_{j}\|_{2} (), 1 i<j r\) for some \(>0\).

For an arbitrary matrix \(^{m n}\) with \(^{}=_{m}\), denote by \(D_{}\) the instance of mixture of linear classifiers with weight vectors \(^{}_{1},,^{}_ {r}\) and weights \(w_{1},,w_{r}\). Let \(_{g}=\{_{}^{m n },^{}=_{m}\}\). We have that \(\|^{}_{i}^{}_{j} \|_{2}=\|_{i}_{j}\|_{2}(),1 i<j r\), and \(_{(,y) D_{}}[y=]= _{=1}^{r}w_{}((^{}_{ })^{})=_{=1}^{r}w_{}(_{ }^{})=g(), ^{n}\). By Proposition 3.2, any SQ algorithm for the decision problem \((_{g},_{n}(\{ 1\}))\) must either use queries of tolerance \(n^{-(k)}\), or make at least \(2^{n^{(1)}}\) queries. The last step is to reduce the decision problem \((_{g},_{n}(\{ 1\}))\) to the problem of learning mixture of linear classifiers.

**Claim 3.7** (see, e.g., Lemma 8.5 in ).: _Suppose there exists an SQ algorithm to learn an unknown distribution in a family \(\) to total variation distance \(\) using at most \(N\) statistical queriesof tolerance \(\). Suppose furthermore that for each \(D^{}\) we have that \(d_{}(D,D^{})>2(+)\). Then there exists an SQ algorithm that solves the testing problem \((,D)\) using at most \(n+1\) queries of tolerance \(\)._

To apply Claim 3.7, we need to show that the distribution \(D_{}\) in the class \(_{g}\) is sufficiently far from the null hypothesis \(D_{0}=_{n}(\{ 1\})\) in total variation distance.

**Lemma 3.8**.: _Let \(^{m n}\) with \(^{}=_{m}\). We have that \(d_{}(D_{},D_{0})(/r)\)._

We briefly sketch the proof idea and defer the proof details to Appendix B. We consider \(w_{}(_{}^{})\) a halfspace of heaviest weight in \(D_{}\), and pick points \(\) and \(^{}\) close to the defining hyperplane that are mirrors of each other over it. We note that under \(D_{0}\) the expectations of \(y\) conditioned on \(\) being \(\) or \(^{}\) are both \(0\), whereas under \(D_{}\) they likely (in particular, unless they are also on opposite sides of another halfspace) differ by at least \(w_{}\).

## 4 SQ Lower Bound for Uniform Mixtures via Spherical Designs

In this section, we prove our SQ lower bound for mixture of linear classifiers with uniform weights, thereby establishing Theorem 1.2. Our basic lower bound technique is essentially the same as in the previous section, but we need to construct a spherical design with _uniform weight_.

**Proposition 4.1**.: _Let \(m=\), where \(r^{-1/10}<1\) and \(1.99 c 2\) is a constant. Let \(k\) be an odd integer such that \(r^{5}\). There exist vectors \(_{1},,_{r}\) on \(^{m-1}\) such that:_

* \(_{_{m}}[g()p()]=0\) _holds for every odd polynomial_ \(p\) _with degree less than_ \(k\)_, where_ \(g()=_{=1}^{r}(_{}^{ })\)_._
* \(\|_{i}+_{j}\|_{2},\|_{i}-_{j}\|_{2} ()-O1/, 1 i<j r\)_._

By Lemma 3.5, we can write \(_{=1}^{r}_{_{m}}[p( )(_{}^{})]=_{=1}^ {r}q(_{})\) for some odd polynomial \(q\) of degree less than \(k\). Therefore, it suffices to show that with high probability there exist unit vectors \(_{1},,_{r}\) such that \(_{=1}^{r}q(_{})=0\) holds for every odd polynomial \(q\) of degree less than \(k\). To achieve this, we will leverage some techniques from .

### Spherical Design Construction

Notation.We start by introducing some additional notations we will use throughout this section. Let \(_{t}^{d}\) denote the set of homogeneous polynomials in \(d\) variables of some odd degree \(t\). For any \(p,q_{t}^{d}\), we consider the inner product \( p,q=_{(^{d-1})}[p ()q()]\). For any \(p_{t}^{d}\), we define \(\|p\|_{2}^{2}= p,p\). We denote by \(N_{t,d}=\) to be the dimension of \(_{t}^{d}\) and \(_{t}^{d}=\{p_{t}^{d}\|p\|_{2} 1\}\). Let \(_{t}^{d}\) denote the boundary of \(_{t}^{d}\), i.e., \(_{t}^{d}=\{p_{t}^{d}\|p\|_{2}=1\}\). In the remaining part of this section, we will assume that the underlying distribution (over the expectation) is \((^{d-1})\).

The following theorem -- a more detailed version of Theorem 1.6 -- establishes the existence of a spherical \(t\)-design of size \((N_{2t,d})\) with the desired pairwise separation properties.

**Theorem 4.2** (Spherical Design Construction).: _Let \(t\) be an odd integer and \(r N_{2t,d}^{5}\). Let \(_{1},,_{r}\) be uniform random vectors over \(^{d-1}\). Then, with probability at least 99/100, there exist unit vectors \(_{1},,_{r}^{d-1}\) such that \(\|_{i}-_{i}\|_{2} O(1/N_{2t,d}),i[r]\), and \((_{1},,_{r})\) form a spherical \(t\)-design._

To prove Theorem 4.2, we will start from the following result.

**Theorem 4.3** ().: _If there exists a continuous mapping \(F:_{t}^{d}(^{d-1})^{r}\) such that for all \(p_{t}^{d}\), \(_{i=1}^{r}p(_{i}(p))>0\), where \(F(p)=(_{1}(p),,_{r}(p))\), then there exists a polynomial \(p^{*}_{t}^{d}\) such that \([p()]=_{i=1}^{r}p(_{i}(p^{*}))\) holds for every polynomial \(p_{t}^{d}\)._

To apply Theorem 4.3, we need to find a continuous function \(F\) mapping \(_{t}^{d}\) to \((^{d-1})^{r}\) such that for any \(p_{t}^{d}\), \(_{i=1}^{r}p(_{i})>0\), where \(F(p)=(_{1},,_{r})\). We will construct the mapping\(F\) as follows: we sample \(_{1},,_{r}\) uniformly over the unit sphere \(^{d-1}\), and then try to make the value of \(p(_{i})\) larger by moving each point \(_{i}\) in the direction of the gradient. In particular, we let \(_{i}=_{i}+_{o}p(_{i})}{\| _{i}+_{o}p(_{i})\|_{2}}\) for some \(>0\) sufficiently small, where \(_{o}p()\) is the component of \( p()\) orthogonal to the direction \(\). We will prove that with high probability, for any \(p_{t}^{d}\), \(_{i=1}^{r}p(_{i})>0\). Intuitively, this works because of two facts:

1. With high probability over the choice of \(_{i}\), for all \(p_{t}^{d}\), the average value of \(p()\) is already close to zero.
2. Moving in the direction of \(_{o}p(_{i})\) increases \(p(_{i})\) by a notable amount.

**Lemma 4.4**.: _Let \(\) be a subspace of polynomials in \(d\) variables with mean zero. Let \(N\) be the dimension of \(\). Let \(_{1},,_{r}\) be i.i.d. random vectors over \(^{d-1}\). Then, with probability at least \(1-}\), we have that for any \(p\), \(_{i=1}^{r}p(_{i})\| p\|_{2}\)._

To prove Lemma 4.4, we take an orthonormal basis \(p_{1},,p_{N}\) and define \(()}}{{=}}[p_{1}( ),,p_{N}()]^{}\). Noting that \(()\) is a random vector with mean zero and covariance identity, applying Markov's inequality will yield the result. We defer the proof details to Appendix C.

**Lemma 4.5**.: _Let \(^{d-1}\) and \(0< 1/N_{2t,d}^{2}\). For any \(p_{t}^{d}\), let \(=+_{o}p()}{\|+ _{o}p()\|_{2}}\). We have that \(p()-p() C\|_{o}p()\|_{2}^{2}\) for some universal constant \(0<C<1\)._

The proof of Lemma 4.5 follows by Taylor expansion, where the contributions to \(p()\) coming from higher-order terms will not be large as long as \(\) is sufficiently close to \(\). We defer the proof details to Appendix C. By applying the above two lemmas, we establish the following:

**Theorem 4.6**.: _Let \(_{1},,_{r}\) be i.i.d. random vectors over \(^{d-1}\). Let \(=1/N_{2t,d}^{2}\) and \(r N_{2t,d}^{5}\). We consider the mapping \(F:_{t}^{d}(^{d-1})^{r}\) as follows: for any \(p_{t}^{d}\), let_

\[_{i}=_{i}+_{o}p(_{i})}{\| _{i}+_{o}p(_{i})\|_{2}}\,\]

_where \(_{o}p()\) is the component of \( p()\) orthogonal to the direction \(\). Let \(F(p):=(_{1},,_{r})\). Then, with probability at least 99/100, we have that for any \(p_{t}^{d}\), \(_{i=1}^{r}p(_{i})>0\)._

To prove Theorem 4.6, we consider \(()=p()+C(\|_{o}p()\|_{ 2}^{2}-[\|_{o}p()\|_{2}^{2}])\), where \(C,\) comes from Lemma 4.5. Noting that \([()]=0\) and \(()\) is a polynomial containing only monomials of degree \(2t,2t-2,t,0\), we are able to apply Lemma 4.4 to obtain the desired result. See Appendix C for the proof.

We now prove our main technical result, Theorem 4.2.

Proof of Theorem 4.2.: Let \(=1/N_{2t,d}^{2}\). We consider the mapping \(F:_{t}^{d}(^{d-1})^{r}\) as follows: for any \(p_{t}^{d}\), let \(_{i}=_{i}+_{o}p(_{i})}{\| _{i}+_{o}p(_{i})\|_{2}}\), where \(_{o}p()\) is the component of \( p()\) orthogonal to the direction \(\). By Theorem 4.6, with probability at least 99/100, we have that for any \(p_{t}^{d}\), \(_{i=1}^{r}p(_{i})>0\). Applying Theorem 4.3 yields that there exists some \(p^{*}_{t}^{d}\) such that \(F(p^{*})=(_{1}^{*},,_{r}^{*})\) form a spherical \(t\)-design. Furthermore, we can show that \(\|_{i}^{*}-_{i}\|_{2} O(1/N_{2t,d})\) by elementary calculation (see Appendix C). 

### Proof of Theorem 1.2

We first prove Proposition 4.1 based on our construction of spherical \(t\)-design. To achieve this, it suffices to show that with high probability there exist \(_{1},,_{r}^{m-1}\) such that

* \(_{1},,_{r}\) is a spherical \(k\)-design.
* \(\|_{i}+_{j}\|_{2},\|_{i}-_{j}\|_{2} (), 1 i<j r\) for some \(>0\).

Proof of Proposition 4.1.: Let \(=_{1 i<j r}(_{i},_{j})\). Applying Fact 3.4 by taking \(=(})^{}\) yields \([][ r^{- {m-1}}] 99/100\). This will give

\[_{1 i<j r}\{\|_{i}-_{j}\|_{2 },\|_{i}+_{j}\|_{2}\}() 99/100\,\]since our choice of \(m\) will imply that \(r=1/^{m-1}}\). By Theorem 4.2, with probability at least 99/100, there exist unit vectors \(_{1}^{*},,_{r}^{*}^{m-1}\) such that \(\|_{i}^{*}-_{i}\|_{2} O(1/N_{2k,m}),i[r]\) and \((_{1}^{*},,_{r}^{*})\) form a spherical \(k\)-design. Therefore, for any odd homogeneous polynomial \(p\) in \(m\) variables of odd degree \(t<k\), we have that

\[_{i=1}^{r}p(_{i}^{*})=_{i=1}^{r}(\| _{i}^{*}\|_{2}^{2})^{}p(_{i}^{*})= [(\|\|_{2}^{2})^{}p()]=0\,\]

which implies that \(_{i=1}^{r}q(_{i}^{*})=0\) holds for any polynomial \(q\) in \(m\) variables of degree less than \(k\). In addition, for every \(1 i<j r\), we have that

\[\|_{i}^{*}_{j}^{*}\|_{2} = \|(_{i}_{j})+(_{i}^{*}-_{i})(_{j}^{*}-_{j})\|_{2}\|_{i} _{j}\|-\|_{i}^{*}-_{i}\|_{2}-\|_{j}^{* }-_{j}\|_{2}\] \[ \|_{i}_{j}\|_{2}-O(1/N_{2k,m})\.\]

This completes the proof. 

Proof of Theorem 1.2.: Let \(m=\), where \(r^{-1/10}<1\) and \(1.99 c 2\) is a constant. Let \(c^{}=-1}{2}\) and \(k=c^{}m=-1)c r}{2(1/)}\). In this way, we will have that \(r N_{2k,m}^{5}\) (see Appendix C for calculation details). Therefore, by Proposition 4.1, there exist vectors \(_{1},,_{r}^{m-1}\) such that

* \(_{_{m}}[g()p()]=0\) holds for every odd polynomial \(p\) of degree less than \(k\), where \(g()=_{=1}^{r}(_{}^{ })\).
* \(\|_{i}+_{j}\|_{2},\|_{i}-_{j}\|_{2} ()-O(1/N_{2k,m}), 1 i<j r\).

For an arbitrary matrix \(^{m n}\) with \(^{}=_{m}\), denote by \(D_{}\) the instance of mixture of linear classifiers with weight vectors \(^{}_{1},,^{} _{r}\). Let \(_{g}=\{_{}^{m n },^{}=_{m}\}\). By definition, we have that \(_{(,y) D_{}}[y=]= _{=1}^{r}((^{}_{ })^{})=_{=1}^{r}(_{}^{})=g(), ^{n}\), and \(\|^{}_{i}^{}_{j} \|_{2}=\|_{i}_{j}\|_{2}(),1 i<j r\), since \(N_{2k,m}((1/)^{1.89})\) (see Appendix C for the calculation details). Therefore by Proposition 3.2, any SQ algorithm that solves the decision problem \((_{g},_{n}(\{ 1\}))\) must either use queries of tolerance \(n^{-(k)}\), or make at least \(2^{n^{(1)}}\) queries. By Lemma 3.8, for any \(^{m n}\) with \(^{}=_{m}\), we have that \(d_{}(D_{},D_{0})(/r) 2(n^{-(k)}+)\), where \(D_{0}=_{n}(\{ 1\})\). Therefore, by Claim 3.7, any SQ algorithm that learns a distribution in \(_{g}\) within error \(\) in total variation distance must either use queries of tolerance \(n^{-( r/(^{1/(5c)}(1/)))}\), or make at least \(2^{n^{(1)}}\) queries. This completes the proof. 

## 5 Conclusion

This work establishes a near-optimal Statistical Query (SQ) lower bound for learning uniform mixtures of linear classifiers under the Gaussian distribution. Our lower bound nearly matches prior algorithmic work on the problem . Our result applies for the simplest (and well-studied) distributional setting where the covariates are drawn from the standard Gaussian distribution. This directly implies similar information-computation tradeoffs for the setting that the covariates are drawn from a more general distribution family (e.g., an unknown subgaussian or log-concave distribution) that includes the standard normal.

From a technical perspective, we believe that our new efficient construction of spherical designs is a mathematical contribution of independent interest that could be used to establish SQ lower bounds for other related latent variable models (e.g., various mixtures of experts). A natural direction is to establish information-computation tradeoffs for a fixed non-Gaussian distribution on covariates (e.g., the uniform distribution over the Boolean hypercube), for which a different hardness construction is needed.