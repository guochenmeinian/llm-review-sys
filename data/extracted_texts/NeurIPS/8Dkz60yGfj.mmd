# Adjust Pearson's \(r\) to Measure Arbitrary Monotone Dependence

Xinbo Ai

School of Intelligent Engineering and Automation

Beijing University of Posts and Telecommunications

Beijing 100876, China

axb@bupt.edu.cn

###### Abstract

Pearson's \(r\), the most widely-used correlation coefficient, is traditionally regarded as exclusively capturing linear dependence, leading to its discouragement in contexts involving nonlinear relationships. However, recent research challenges this notion, suggesting that Pearson's \(r\) should not be ruled out _a priori_ for measuring nonlinear monotone relationships. Pearson's \(r\) is essentially a scaled covariance, rooted in the renowned Cauchy-Schwarz Inequality. Our findings reveal that different scaling bounds yield coefficients with different capture ranges, and interestingly, tighter bounds actually expand these ranges. We derive a tighter inequality than Cauchy-Schwarz Inequality, leverage it to refine Pearson's \(r\), and propose a new correlation coefficient, i.e., rearrangement correlation. This coefficient is able to capture arbitrary monotone relationships, both linear and nonlinear ones. It reverts to Pearson's \(r\) in linear scenarios. Simulation experiments and real-life investigations show that the rearrangement correlation is more accurate in measuring nonlinear monotone dependence than the three classical correlation coefficients, and other recently proposed dependence measures.

## 1 Introduction

Proposed in the late 19th century, Pearson's \(r\)(Pearson, 1896) has been one of the main tools for scientists and engineers to study bivariate dependence during the 20th century. It is remarkably unaffected by the passage of time (Lee Rodgers and Alan Nice Wander, 1988) and still goes strong in the 21st century (Puccetti, 2022). It has been, and probably still is, the most used measure for statistical associations, and generally accepted as _the_ measure of dependence, not only in statistics, but also in most applications of natural and social sciences (Tjostheim, Otneim, and Stove, 2022).

Despite its popularity, Pearson's \(r\) has a number of shortcomings, and the most serious issue might be that it can only capture linear dependence, as stated in classical textbooks (Wasserman, 2004) and contemporary literatures (Armstrong, 2019; Tjostheim, Otneim, and Stove, 2022). The use of Pearson's \(r\) has been strongly discouraged for forms of associations other than linear ones (Speed, 2011).

Numerous nonlinear alternative coefficients have been proposed to address this deficiency, such as Spearman's \(\)(Spearman, 1904), Kendall's \(\)(Kendall, 1938), Hilbert-Schmidt Independence Criterion(HSIC) (Gretton et al., 2005), distance correlation(dCor) (Szekely, Rizzo, and Bakirov, 2007), Maximal Information Coefficient(MIC) (Reshef et al., 2011), and Chatterjee's \(\)(Chatterjee, 2021). Their capture ranges are extending from linear dependence to monotone dependence, and then to non-monotone dependence. Without exception, all these coefficients adopt radically different approaches for nonlinear dependence, rather than following the original way of Pearson's \(r\) for a breakthrough.

In their recent paper titled "_Myths About Linear and Monotonic Associations: Pearson's \(r\), Spearman's \(\), and Kendall's \(\)_", van den Heuvel and Zhan (2022) challenged the widespread belief that Pearson's \(r\) is only a measure for linear dependence, proving this notion to be false. Their findings indicate that Pearson's \(r\) should not be ruled out _a priori_ for measuring nonlinear monotone dependence. Although this potential has been recognized, the specific approach to using Pearson's \(r\) for accurate measurement of nonlinear monotone dependence remains unresolved.

Pearson's \(r\) is essentially a scaled covariance, with the renowned Cauchy-Schwarz Inequality as its mathematical foundation. We find that different scaling bounds yield coefficients with different capture ranges, and interestingly, tighter bounds actually expand these ranges. We derive a tighter inequality than Cauchy-Schwarz Inequality, leverage it to adjust Pearson's \(r\) to measure nonlinear monotone dependence. The adjusted version of Pearson's \(r\) is more accurate in measuring nonlinear monotone dependence than the three classical correlation coefficients, and other recently proposed dependence measures.

## 2 Methods

### Definitions and notations

Consider real-valued random variables \(X\) and \(Y\) with cdf's (cumulative distribution functions) \(F\) and \(G\) respectively. We denote the covariance of \(X\) and \(Y\) as \((X,Y)\); the variance of \(X\) as \((X)\), and the variance of \(Y\) as \((Y)\). We assume that \(0<(X)<\), \(0<(Y)<\). We define \(X^{}=F^{-1}(U)\), \(X^{}=F^{-1}(1-U)\). Here, \(U\) is a random variable with the uniform distribution on \((0,1)\), and \(F^{-1}\) is the inverse cdf or quantile function defined as \(F^{-1}(u)=\{x:F(x) u \},u(0,1)\). Similarly, \(Y^{}=G^{-1}(U)\), \(Y^{}=G^{-1}(1-U)\).

Let \(x=(x_{1},,x_{n})\) and \(y=(y_{1},,y_{n})\) be samples of \(X\) and \(Y\), each with \(n\) elements. Neither \(x\) nor \(y\) is constant. We denote the sample covariance of \(x\) and \(y\) as \(s_{x,y}\); the sample variance of \(x\) as \(s_{x}^{2}\); the sample variance of \(y\) as \(s_{y}^{2}\). We define the increasing and decreasing rearrangement of \(x\) as \(x^{}=(x_{(1)},x_{(2)},,x_{(n)})\) and \(x^{}=(x_{(n)},x_{(n-1)},,x_{(1)})\) respectively, with \(x_{(1)} x_{(2)} x_{(n)}\). Similarly, we define \(y^{}=(y_{(1)},y_{(2)},,y_{(n)})\), \(y^{}=(y_{(n)},y_{(n-1)},,y_{(1)})\).

**Definition 1**.: _A subset \(S\) of \(^{2}\) is non-decreasing (resp. non-increasing) if and only if for all \((x_{1},y_{1})\), \((x_{2},y_{2})\) in \(S\), \(x_{1}<x_{2}\) implies \(y_{1} y_{2}\) (resp. \(x_{1}<x_{2}\) implies \(y_{1} y_{2}\)). Random variables \(X\) and \(Y\) are called increasing (resp. decreasing) monotone dependent if \((X,Y)\) lies almost surely in a non-decreasing (resp. non-increasing) subset of \(^{2}\). Samples \(x\) and \(y\) are called increasing (resp. decreasing) monotone dependent if \(\{(x,y)\}\) is a non-decreasing (resp. non-increasing) subset of \(^{2}\)._

Definition 1 is sourced from (Mikusinski, Sherwood, and Taylor, 1991). Clearly Definition 1 is symmetrical with respect to \(X\) and \(Y\). The monotone dependence outlined here encompasses a broader scope than definitions like the one in (Kimeldorf and Sampson, 1978), where "_each of \(X\) and \(Y\) is almost surely a monotone function of the other_". This is primarily because it doesn't necessitate a one-to-one mapping. Also, linear dependence, i.e., \(P(Y= X+)=1\) at the population level or \(y=ax+b\) at the sample level, is special case of monotone dependence, and we will refer to dependence which is monotone but not linear as "_nonlinear monotone dependence_".

### Different bounds lead to different capture ranges

With Cauchy-Schwarz Inequality, the well-known covariance inequality can be directly derived as

\[|(X,Y)|(X)(Y)},\]

thus the geometric mean of \((X)\) and \((Y)\), i.e., \((X)(Y)}\), mathematically provides a bound for covariance \((X,Y)\), which ensures that Pearson's Correlation Coefficient

\[r(X,Y)=(X,Y)}{(X)(Y)}}\]

always falls into the range \([-1,+1]\). Scaled by \((X)(Y)}\), Pearson's \(r\) turns into a _normalized covariance_, which is dimensionless and bounded. It possesses significant advantage over the original _covariance_ in the sense that its value will not be affected by the change in the units of \(X\) and \(Y\).

A crucial issue that has been neglected so far is that boundedness doesn't ensure optimum. Scaling \((X,Y)\) to the range \([-1,+1]\) is not the only thing that matters. In fact, different bounds can be utilized to scale covariance to be bounded coefficients, as reported in previous works (Lin, 1989; Zegers, 1986).

For example, with the Mean Inequality Series (Hardy, Littlewood, and Polya, 1952), it is immediate that

\[|(X,Y)|(X)(Y)}( (X)+(Y))\]

in the sense that geometric mean \((X)(Y)}\) is always less than or equal to arithmetic mean \(((X)+(Y ))\) for nonnegative values \((X)\) and \((Y)\). Then we get a looser bound for covariance, i.e., \(((X)+(Y ))\), with which another measure can be defined as follows(Zegers, 1986):

\[r^{+}(X,Y)=(X,Y)}{ ((X)+(Y) )}\]

\(r^{+}(X,Y)\) is named early as _Additivity Coefficient_ (Zegers, 1986) and later as _Standardized Covariance_ (Andraszewicz and Rieskamp, 2014). It is proved that the capture range of \(r^{+}(X,Y)\) is limited to additive relationships, i.e., \(Y= X+\), which are special cases of linear relationships, i.e., \(Y= X+\), with \(\) being fixed to \( 1\)(Zegers, 1986).

Further, we can find an even looser bound for covariance, in the sense that

\[((X)+(Y ))((X)+ (Y)+|-|^{2}),\]

and define a new measure as follows:

\[r^{=}(X,Y)=(X,Y)}{ ((X)+(Y)+ |-|^{2})}\]

\(r^{=}\) is named as _Concordance Correlation Coefficient_ (Lin, 1989), and it is designed to measure identical relationship, i.e., \(Y= X\). When \(X\) and \(Y\) are both positive, it can be utilized to evaluate their agreement by measuring the variation from the 45\({}^{}\) line through the origin (Lin, 1989).

As for the abovementioned three measures, \(r\), \(r^{+}\), and \(r^{=}\), they share the same numerator, \((X,Y)\), the differences lie in their denominators. These denominators serve as bounds for \((X,Y)\). Different bounds lead to different capture ranges. With the bounds being looser, their capture ranges are shrinking from linear (\(Y= X+\)) towards additive (\(Y= X+\)) and ultimately to identical (\(Y= X\)) relationships. The looser the bound, the narrower the capture range.

Up until now, all the efforts have only led to looser bounds and measures with narrower capture ranges. _Could we possibly explore breakthroughs by approaching the problem from the opposite direction, aiming to achieve a tighter bound and consequently, devise a new measure with a broader capture range?_

The bound in Pearson's \(r\) is intrinsically provided by Cauchy-Schwarz Inequality, which is one of the most widespread and useful inequalities in mathematics. Cauchy-Schwartz Inequality is so classic and reliable that one seldom tries to improve it. Both bounds in \(r^{+}\) and \(r^{=}\) are looser than that provided by Cauchy-Schwartz Inequality. To loosen Cauchy-Schwartz Inequality might be easy while to tighten such a classic inequality might be relatively difficult. However, we find that it is not impossible to improve the tightness of Cauchy-Schwarz Inequality. In other words, there exists sharper bound for covariance, which will be depicted in the next section.

### New inequality tighter than Cauchy-Schwarz Inequality

Before deriving the new inequality, we will briefly review the classic Cauchy-Schwarz inequality, which is common in textbooks. The Cauchy-Schwarz inequality states that for \(x\) and \(y\), we have

\[| x,y|\|x\|\|y \|,\]

where \(,\) is the inner product. and \(\|\|\) is the norm. The equality holds if and only if \(x\) and \(y\) are linearly dependent, i.e., \(y=ax\) for some constant \(a\).

After defining an inner product on the set of random variables using the expectation of their product, i.e., \( X,Y=EXY\), the Cauchy-Schwarz inequality becomes

\[|EXY|EY^{2}}.\]

Now, we will sharpen the Cauchy-Schwarz inequality. On the basis of the rearrangement theorems (Hardy, Littlewood, and Polya, 1952), we derive 6 theorems(corollaries/propositions) as follows.

**Theorem 1**.: _For random variables \(X\) and \(Y\), we have_

\[|EXY||EX^{}Y^{}| EY^{2}}.\]

_The equality on the left holds if and only if \(X\) and \(Y\) are monotone dependent, and the equality on the right holds if and only if \(Y^{d} X\), with \(}(EXY)=}()\)._

_Here, \(^{d}\) denotes equality in distribution, and \(EX^{}Y^{}\) is defined as:_

\[EX^{}Y^{}=\{EX^{} Y^{},if&EXY 0\\ EX^{}Y^{},if&EXY<0.\]

For the sake of conciseness, the proofs of Theorem 1 and theorems undermined are all included in Appendix A.1.

**Theorem 2**.: _For samples \(x\) and \(y\) we have_

\[| x,y|| x^{ },y^{}|\|x\| \|y\|.\]

_The equality on the left holds if and only if \(x\) and \(y\) are monotone dependent, and the equality on the right holds if and only if \(y\) is arbitrary permutation of \(ax\), with \(}( x,y)=}(a)\)._

_Here, \( x^{},y^{}\) is defined as:_

**Corollary 1**.: _For random variables \(X\) and \(Y\), we have covariance inequality series as:_

\[|}(X,Y)|| }(X^{},Y^{})| }(X)}(Y)}\] \[(}(X)+ }(Y))\] \[(}(X)+ }(Y)+|-|^{2})\]

_The first equality holds if and only if \(X\) and \(Y\) are monotone dependent, and the second equality holds if and only if \(Y^{d} X+\), with \(}(}(X,Y))= }()\)._

_Here, \(}(X^{},Y^{})\) is defined as:_

\[}(X^{},Y^{})=\{ }(X^{},Y^{} ),&if&}(X,Y) 0\\ }(X^{},Y^{})&if& }(X,Y)<0.\]

**Corollary 2**.: _For samples \(x\) and \(y\), we have covariance inequality series as_

\[|s_{x,y}||s_{x^{},y^{}}| ^{2}s_{y}^{2}}\] \[(s_{x}^{2}+s_{y}^{2})\] \[(s_{x}^{2}+s_{y}^{2}+|-|^{2})\]

_The first equality holds if and only if \(x\) and \(y\) are monotone dependent, and the second equality holds if and only if \(y\) is arbitrary permutation of \(ax+b\), with \(}(s_{x,y})=}(a)\)._

_Here, \(s_{x^{},y^{}}\) is defined as:_

\[s_{x^{},y^{}}=\{s_{x^{},y^{}},if&s_{x,y} 0\\ s_{x^{},y^{}},if&s_{x,y}<0.\]

### The proposed Rearrangement Correlation

The inequality series in Corollary 1 and Corollary 2 provides sharper bounds for covariance at the population level and the sample level respectively. We will leverage them to define the so-called _Rearrangement Correlation_, which is the adjusted version of Pearson's \(r\) proposed here.

**Definition 2**.: _The Rearrangement Correlation of random variables \(X\) and \(Y\) is defined as:_

\[r^{\#}(X,Y)=(X,Y)}{| (X^{},Y^{})|}\]

**Definition 3**.: _The Rearrangement Correlation of samples \(x\) and \(y\) is defined as:_

\[r^{\#}(x,y)=}{|s_{x^{},y^{}}|}\]

The new measure is named "_Rearrangement Correlation_" because its theoretical foundation is the rearrangement inequality, as shown in Theorem 1 and Theorem 2. We adopt the musical sharp symbol # to denote rearrangement correlation, signifying that this measure has sharp values because of its sharp bounds. Analogous to how C# is pronounced as _C-sharp_, \(r^{\#}\) is pronounced as _r-sharp_.

As for the relationship between \(r^{\#}(x,y)\) and \(r^{\#}(X,Y)\), it is clear that \(r^{\#}(x,y)\) converges to \(r^{\#}(X,Y)\) when \(n\) according to their definitions.

The capture range of rearrangement correlation is no longer limited to linear dependence but monotone dependence, which is revealed by the next proposition.

**Proposition 1**.: _For random variables \(X\), \(Y\), and samples \(x,\)\(y\), the following hold:_

* \(|r^{\#}(X,Y)| 1\) _and the equality holds if and only if_ \(X\) _and_ \(Y\) _are monotone dependent._
* \(|r^{\#}(x,y)| 1\) _and the equality holds if and only if_ \(x\) _and_ \(y\) _are monotone dependent._

An interesting question might arise in one's mind: how can the simple adjustment, replacing \((X)(Y)}\) with \(|(X^{},Y^{})|\), leads to the capture range expanding from linear dependence to (nonlinear) monotone dependence? The capture range is inherited from _covariance_ itself. The capture range of covariance is limited neither to identical dependence as that of _Concordance Correlation Coefficient_, additive dependence as that of _Additivity Coefficient_, nor to linear dependence as that of Pearson's \(r\). In fact, it can potentially detect and measure arbitrary monotone dependence, if scaled properly. In other words, Pearson's \(r\) is also measuring nonlinear monotone dependence to some extent. The adjustment is nothing more than compensating for underestimation.

The relationships among the above-mentioned _Concordance Correlation Coefficient_ (\(r^{=}\)), _Additivity Coefficient_ (\(r^{+}\)), _Pearson's \(r\)_, and the new proposed _Rearrangement Correlation_ (\(r^{\#}\)) are depicted in Figure 1.

Figure 1: Covariance inequality series, correlation coefficients and their capture rangesThe following proposition reveals the relationship between Pearson's \(r\) and its adjusted version, i.e., Rearrangement Correlation:

**Proposition 2**.: _For random variables \(X\), \(Y\), and samples \(x\), \(y\), the following hold:_

* \(|r^{\#}(X,Y)||r(X,Y)|\) _and the equality holds if and only if_ \(Y\,}{{=}}$}\, X+\)_, with_ \((r(X,Y))=( )\)_._
* \(|r^{\#}(x,y)||r(x,y)|\) _and the equality holds if and only if_ \(y\) _is arbitrary permutation of_ \(ax+b\)_, with_ \((r(x,y))=(a)\)_._

Proposition 2 shows that \(r^{\#}(X,Y)\) will revert to \(r(X,Y)\) if and only if \(Y\,}{{=}}$}\, X+\), \((r(X,Y))=( )\), and \(r^{\#}(x,y)\) to \(r(x,y)\) if and only if \(y\) is arbitrary permutation of \(ax+b\), with \((r(x,y))=(a)\). It is clear that linear dependence is special case of these conditions. Thus, \(r^{\#}\) reverts to \(r\) in linear scenarios.

Another question to be asked is, do we need a new monotone measure given that rank-based measures such as Spearman's \(\) can already measure monotone dependence? The answer is twofold:

On the one hand, \(r^{\#}\) has a higher _resolution_ and is more accurate. Without exception, all measures designed for monotone dependence are utilizing the order information. However, what we utilize here is the original information, rather than the ranks. Mapping numerical values to their ranks does of course produce a certain loss of information. A small difference between two values may no longer be distinguished from a large difference. With sample size \(n\), there are totally \(-n}{6}\) possible \(\) values between \(-1\) and \(+1\), whatever raw values are and however correlated patterns differ. The _resolution_ of Spearman's \(\) might be inadequate. To take a simple example, let \(x=(4,3,2,1)\) and

* \(y_{1}=(5,4,3,2.00)\)
* \(y_{2}=(5,4,3,3.25)\)
* \(y_{3}=(5,4,3,3.50)\)
* \(y_{4}=(5,4,3,3.75)\)
* \(y_{5}=(5,4,3,4.50)\)

Obviously, \(y_{1}\) and \(x\) behaves exactly in the same way, with their values getting small and small step by step. The behavior of \(y_{2}\), \(y_{3}\), \(y_{4}\), and \(y_{5}\) are becoming more and more different from that of \(x\). However, the \(\) values are all the same for \(y_{2}\), \(y_{3}\) and \(y_{4}\). In contrast, the \(r^{\#}\) values can reveal all these differences exactly.

* \(r^{\#}(x,y_{1})=1.00\), \((x,y_{1})=1.00\)
* \(r^{\#}(x,y_{2})=0.93\), \((x,y_{2})=0.80\)
* \(r^{\#}(x,y_{3})=0.85\), \((x,y_{3})=0.80\)
* \(r^{\#}(x,y_{4})=0.76\), \((x,y_{4})=0.80\)
* \(r^{\#}(x,y_{5})=0.38\), \((x,y_{5})=0.40\)

On the other hand, \(r^{\#}\) is comparable with Pearson's \(r\), while the latter is not. For nonlinear monotone dependence, the value of Spearman's \(\) might be remarkably greater than the value of Pearson's \(r\). One may attempt to search for nonlinear relationships in data by checking whether the value of \(\) far exceeds that of \(r\). However, it might be meaningless and even impossible to compare their values directly. In cases, \(\) can be either greater or less than \(r\), and their sign can even be different. Thus the difference \(||-|r|\) is confusing. On the contrary, the signs of \(r^{\#}\) and \(r\) are always the same, and \(|r^{\#}|\) is always greater than or equal to \(|r|\). \(|r^{\#}|-|r|\) equals to 0 if and only if \(y\) is arbitrary permutation of \(ax+b\). Its value increases with the degree of nonlinearity.

However, Spearman's \(\) can also be superior to \(r^{\#}\) in the sense that the former is robust to outliers while the latter is not. Rearrangement correlation is a scaled covariance, and the limitation of being non-robust to outliers is inherited from covariance itself. In fact, concordance correlation coefficient, additivity coefficient, and Pearson's \(r\) are also scaled covariance measures, and none of them are robust to outliers.

To be more robust, we can also transform the raw data into their ranks before calculating \(r^{\#}\). Interestingly, \(r^{\#}\) becomes equivalent to Spearman's \(\) when calculated on ranks. Let \(P\) and \(Q\) be the ranks of \(x\) and \(y\) respectively. Then, in the sense that \(sd(P,Q)=sd(P^{},Q^{})=\), \(r^{\#}(P,Q)=(P,Q)\). This explains why \(\) can measure nonlinear monotone relationships while \(r\) only measures linear ones, despite them sharing a similar formula. The key is not just the ranking but achieving a sharp bound. Since \(\) and \(r^{\#}\) are equivalent when applied to ranks, and \(r^{\#}\) can measure arbitrary monotone dependence (as proven in our manuscript), \(\) can do the same.

## 3 Experiments

### Performance metrics

The main purpose of proposing Rearrangement Correlation is to provide a measure of dependence strength for nonlinear monotone relationships, rather than to simply serve as a test statistic for testing independence. Thus, our performance metrics focus on strength measurement.

The basic question to be asked when measuring any attribute is how accurate is this measurement, and there should be no exception for dependence measurement. ISO 5725 uses two terms _"trueness"_ and _"precision"_ to describe the accuracy of a measurement method. _Trueness_ refers to the closeness of agreement between the mean or median of measured results and the true or accepted reference value. _Precision_ refers to the closeness of agreement between measured values (ISO, 1994). The comprehensive performance of _trueness_ and _precision_ can be represented as the mean absolute error (_MAE_ for short), and calculated as the mean of the absolute values of the difference between the measured value and the conventional true value. On the whole, a measure with lower MAE value is better.

We evaluate the performance of different measures in a supervised way. We employ the coefficient of determination, \(R^{2}\), which is defined as the proportion of variance for one variable explained by the other variable, as the ground truth of strength of dependence, which is common in practices (Reshef et al., 2011). Further, we take its square root, \(R\), as the conventional true value of the relationship strength. A simple evidence is that Pearson's \(r\), as the golden standard for measuring linear dependence, is equivalent to \(R\), as long as the relationship is linear. Thus, it is reasonable to adopt \(R\) as the reference value.

### Simulation procedure

We investigate the accuracy performance of \(r^{\#}\), along with \(r^{+}\), Pearson's \(r\), Spearman's \(\), Kendall's \(\) and four other leading dependence measures, i.e., HSIC, dCor, MIC and Chatterjee's \(\) in the following way: for each scenario \(y=f(x)\), we generated 512 pairs of \((x,y)\) from the regression model \(y=f(x)+\), and computed the values of different measures between \(x\) and \(y\) at different \(R\) levels. In the regression model, the \(x\) sample is uniformly distributed on the unit interval \((0,1)\), and the noise is normally distributed as \( N(0,)\), with \(\) controlling \(R\) to a certain level.

\[R=}{(Y)}}\]

For the sake of robustness, the computation process is repeated 10 times for each measure at each \(R\) level, and the mean value is adopted.

Simulation procedure is implemented in the _recor_ R package, which is available in supplemental materials. The workflow is to call _accuracy_db_() firstly, _accuracy_results_frm_db_() secondly and _accuracy_plot_lite_() finally. To reproduce the results, just keep all the parameters as default. More details are available in the package help files.

### Performance in simulated scenarios

The simulation is conducted in up to 50 types of different monotone scenarios, including all basic elementary functions, lots of composite functions and several special functions. To our knowledge, our research explores the most extensive and representative range of scenarios. Detailed descriptions of these scenarios can be found in Appendix A.3, and the results are shown in Figure 2.

Figure 2 shows the scatter plots of conventional true value versus measured values in different scenarios. The nine investigated measures are located in nine panels respectively. In each panel, there are totally 50 transparent green lines, representing the measured value (\(Y\)-axis) with respect to conventional true value (\(X\)-axis) for 50 scenarios. The prefixes \(I\)- and \(H\)- refer to _Inverse_ and _Hyperbolic_ respectively. For example, _I-H-Tangent_ stands for _Inverse Hyperbolic Tangent_ function. In all these panels, the dashed diagonal lines represent an ideal measure, the score of which is exactly the same as the conventional true value. Apparently, the closeness to this reference line reflects the performance of a measure for a certain scenario. The median values of each measure among scenarios at different \(R\) levels are also calculated and denoted by the non-transparent red line.

We first look at the extreme values on both sides. It is expected that a measure will score nearly zero when \(X\) and \(Y\) are randomly generated, i.e., \(R 0\), and score one when there is perfect monotone relationship, i.e., \(R=1\). Only Spearman's \(\), Kendall's \(\) and the adjusted \(r^{\#}\) meet this requirement. MIC also scores \(+1\) when \(R=1\), however, it tends to overestimate the strength when \(R\) is near zero, as also reported in other literature before (Chatterjee, 2021). The remaining five measures, i.e., \(r^{+}\), \(r\), HSIC, dCor and \(\), underestimate the strength of nonlinear relationships, and never converge to \(+1\) even when \(R\) approaches to 1.

Now let's take a close look at the intermediate values. It can be seen in Figure 2 that the non-transparent red line of \(r^{\#}\) is the closest one to the dashed line, which means the measured values by \(r^{\#}\) possess the minimum error. To further quantify the accuracy, we add four boxplots at four representative \(R\) levels (approximately, 0.25, 0.50, 0.75, and 1.00) for each measure. \(r^{\#}\) has the highest trueness in all these representative levels. As for precision, the \(r^{\#}\) also outperforms all other measures except HSIC and MIC. Although HSIC and MIC possesses the best precision, they suffer from lower trueness. HSIC tends to underestimate the strength severely, and MIC is also a biased measure, tending to overestimate the strength when the signal is weak, and underestimate it when the signal is strong, as shown in Figure 2.

The overall performance in terms of MAE is ordered as \(\ r^{\#}(0.060)(0.102) dCor(0.127 ) r(0.150)(0.157) MIC(0.1 96)(0.206) r^{+}(0.263) HSIC (0.518)\). \(r^{\#}\) possesses significant accuracy advantage over all other measures.

### Performance in real-life scenarios

In addition to simulated scenarios, we also investigate the performance of these measures on real life scenarios provided by NIST (National Institute of Standards and Technology, 2003). There are five available monotone scenarios: Chwirut1, Hahn1, Rat43, Roszman1, and Thurber. Details for these scenarios are available in Appendix A.4.

The performance of nine measures in these five scenarios are depicted in Figure 3. Bar plots illustrate the measured values, the conventional true value verified by NIST is annotated on the top of each

Figure 2: Performance of different measures in 50 simulated scenarios

scenario group. And the differences between the measured value and the true value are mapped as error bars.

It can be seen from Figure 3 that \(r^{\#}\) possesses minimum error, or best accuracy performance among all these five scenarios, with its MAE value as 0.00141, followed by \(\)(0.0159), MIC(0.0249), dCor(0.0575), \(\)(0.0779), \(r\)(0.0916), \(\)(0.166), HSIC(0.891) and \(r^{+}\)(0.956).

### Performance in non-monotone scenarios

It's worth noting that the aforementioned scenarios only cover monotone cases. To evaluate performance in typical non-monotone contexts, we conducted experiments in 16 scenarios, encompassing those outlined in (Reshef et al., 2011) and (Simon and Tibshirani, 2014). Details for these scenarios are available in Appendix A.5.

As anticipated, the MAE value of \(r^{\#}\) reaches a significant 0.418, notably inferior to those of \(\)(0.141), MIC (0.157) and dCor (0.364). In essence, \(r^{\#}\) struggles to accurately measure non-monotone dependence. This limitation stems from its reliance on _covariance_, which inherently fails to detect non-monotone relationships. To illustrate, consider a standard introductory text book example, i.e., \((X,Y)=0\) despite \(Y\) being totally dependent on \(X\) via \(Y=X^{2}\). Attempts to tighten its bound proves futile.

However, the performance of \(r^{\#}\) is also superior to those of Spearman's \(\)(0.431), Pearson's \(r\)(0.437) and Kendall's \(\)(0.461). As for accuracy performance, \(r^{\#}\) outperforms the three classical correlation coefficients in not only monotone, but also non-monotone scenarios.

## 4 Conclusion and discussion

We proposed here an adjusted version of Pearson's \(r\), i.e., _rearrangement correlation_, which can be treated as counterpart of Pearson's \(r\) for nonlinear monotone dependence.

The basic idea of rearrangement correlation is simple and straightforward. Its mathematical foundation is a sharpened version of the famous Cauchy-Schwarz Inequality. Tighter bound leads to wider capture range. With the adjustment, the capture range of Pearson's \(r\) is extended from linear dependence to (nonlinear) monotone dependence. Simulated and real-life investigations demonstrate that the rearrangement correlation is more accurate in measuring nonlinear monotone dependence than the three classical correlation coefficients and other more recently proposed dependence measures.

We may draw the conclusion that: Pearson's \(r\) is undoubtedly the gold measure for linear dependence. Now, _it might be the gold measure also for nonlinear monotone dependence, if adjusted_.

Figure 3: Performance of Different Measures in 5 Real-life Scenarios