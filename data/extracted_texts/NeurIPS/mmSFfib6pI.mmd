# Validating Climate Models with Spherical Convolutional Wasserstein Distance

Robert C. Garrett\({}^{1}\) Trevor Harris\({}^{2}\) Zhuo Wang\({}^{1}\) Bo Li\({}^{1}\)

\({}^{1}\)University of Illinois Urbana-Champaign \({}^{2}\)Texas A&M University

{rcg4, zhuowang, libo}@illinois.edu

tharris@stat.tamu.edu

###### Abstract

The validation of global climate models is crucial to ensure the accuracy and efficacy of model output. We introduce the spherical convolutional Wasserstein distance to more comprehensively measure differences between climate models and reanalysis data. This new similarity measure accounts for spatial variability using convolutional projections and quantifies local differences in the distribution of climate variables. We apply this method to evaluate the historical model outputs of the Coupled Model Intercomparison Project (CMIP) members by comparing them to observational and reanalysis data products. Additionally, we investigate the progression from CMIP phase 5 to phase 6 and find modest improvements in the phase 6 models regarding their ability to produce realistic climatologies.

## 1 Introduction

Climate Model ValidationGeneral Circulation Models, or climate models, are mathematical representations of the climate system that describe interactions between matter and energy through the ocean, atmosphere, and land (Washington and Parkinson, 2005). Climate models are the primary tool for investigating the response of the climate system to changes in forcing, such as increases in CO\({}_{2}\), and projecting future climate states (Flato et al., 2014). To assess the plausibility of climate models, climate scientists compare output from model simulations against observational data (Rood, 2019). This comparison is the focus of climate model validation techniques for ensuring that climate models capture the dynamics of the climate system (Roca et al., 2021).

The Coupled Model Intercomparison Project (CMIP) was initiated in 1995 as a comprehensive and systematic program for assessing climate models against each other and observational data (Eyring et al., 2016). Each model in CMIP participates in a wide variety of experiments such as performing a historical simulation, a pre-industrial control simulation, and various simulations representing different scenarios for CO\({}_{2}\) emissions (Eyring et al., 2016). Because historical simulations coincide with observational measurements, we can compare each model's synthetic climate distribution to the distribution of observational or quasi-observational data products (Raaisaainen, 2007), to assess their reconstructive skill. For complete spatial coverage we compare against reanalysis data, a blend of observations and short-range weather forecasts through data assimilation (Bengtsson et al., 2004). This has become one popular climate model validation method (Flato et al., 2014).

Previous approachesMany statistical and machine learning-based methods have been applied to assess climate model output against reanalysis fields. The most common approach is to compute the root mean square error (RMSE) between long-term means of the climate model output and the reanalysis field (Li et al., 2021; Zamani et al., 2020; Karim et al., 2020; Ayugi et al., 2021). RMSE provides a direct measure of the differences between two climate fields but does not take into account internal variability, so we should use it with caution in evaluating climate models. Another approach,which is invariant to bias, is to compute measures of correlation between climate model output and reanalysis fields (Zhao et al., 2021; Zamani et al., 2020; Karim et al., 2020; Ayugi et al., 2021).

More comprehensive approaches employ techniques for random processes to compare two spatial fields. For example, Shen et al. (2002) and Cressie et al. (2008) use the wavelet decomposition to compare the spatial-frequency content of two fields. Hering and Genton (2011) measures the loss differential between models of spatial processes, Lund and Li (2009) and Li and Smerdon (2012) compare the first and second moments of two random processes, and Yun et al. (2022) identifies local differences in the mean and dependency structure between two spatiotemporal climate fields. Functional data analysis techniques have been introduced to compare spatial and spatiotemporal random fields, considering the random fields as continuous functions. Many of these approaches compare the underlying mean functions from two sets of functional data (Zhang and Chen, 2007; Horvath et al., 2013; Staicu et al., 2014). Other approaches include the second-order structure in the comparison (Zhang and Shao, 2015; Li et al., 2016), or compare the distributions of two spatial random processes (Harris et al., 2021).

Since climate models aim to mimic the real climate which is the underlying pattern of weather, directly assessing the distributional differences between the modeled and observed data seems a more thorough approach to evaluating climate models. Vissio et al. (2020) proposed to use the Wasserstein distance (WD), a popular metric for comparing probability distributions (Villani, 2009), for such a purpose. The WD has also been considered for other use cases in climate science, such as data assimilation (Tamang et al., 2020, 2021; Tamang et al., 2022). The WD can be computationally expensive or even impossible to calculate between high-dimensional distributions (Kolouri et al., 2019), so Vissio et al. (2020) first converts each climate field to a single spatial mean and then only compares the distribution of spatial means. However, this dimension reduction puts their method at the risk of missing important spatial variability information, and consequently failing to accurately distinguish two climate fields that are different.

Recent contributions in the Machine Learning (ML) literature seek to compare multivariate distributions using many features while leveraging the efficiency of the one-dimensional WD (Vallender, 1974). The sliced WD (Bonneel et al., 2015) compares random projections of distributions on \(^{n}\), and the generalized sliced WD (Kolouri et al., 2019) extends this to a broader class of projections. The convolutional sliced WD (Nguyen and Ho, 2022) compares distributions of discrete square images in the space \(^{n n}\), accounting for the spatial structure using kernel convolutions. However, spatial fields from climate models are defined on a spherical domain, making them incompatible with the vectorized/square nature of these distances. The spherical sliced WD (Bonet et al. and other spherical transport methods (Quellmalz et al., 2023; Cui et al., 2019) can compare distributions of spatial point processes over a sphere, such as locations of natural disasters and extreme weather events, but cannot be used for smooth fields such as daily temperature and precipitation. Lastly, other non-WD approaches have been considered for multivariate distributional comparisons. For example, Mooers et al. (2023) compared distributions arising from global storm-resolving models using variational autoencoders.

Our proposalWe propose the functional sliced WD as a generalization of the sliced WD to distributions of functional data. To create a tailored tool for climate model evaluation, we define the Spherical Convolutional Wasserstein distance (SCWD) as a special case of the functional sliced WD for functions on the unit sphere \(^{2}\), a manifold on which latitude-longitude coordinates are defined. SCWD creates slices containing a small region of spatial fields to characterize local differences in the distribution of climate variables, which are further integrated into a single measure for global differences. Compared to the spatial mean-based WD from Vissio et al. (2020), SCWD accounts for spatial features while maintaining the modest computation for univariate WD when comparing climate models against reanalysis data, resulting in a comprehensive and more robust evaluation. We apply SCWD to rank climate models and assess the progression of the new CMIP era with respect to daily average surface temperature and daily total precipitation.

## 2 Preliminaries

We consider the problem of comparing two probability distributions \(P\) and \(Q\). Each distribution is a member of \(()\), the set of Borel probability measures on some sample space, \(\). In our application, we treat climate fields as functional data (Wang et al., 2016) over a spatial domain \(\), thus we often assume \(\) is a space of functions. Our sample space of interest is \(L^{2}()\), the set of square integrable functions from \(\) where \(\) is a compact subset of \(^{n}\). CMIP model outputs are available at a global scale, so we consider the spatial domain to be the unit sphere \(^{2}\), the space over which latitude and longitude coordinates are assigned to the Earth's surface. In fact, the space \(L^{2}(^{2})\) has been previously considered for modeling climate fields (Heaton et al., 2014). To compare two functional data distributions \(P\) and \(Q\), we define a distance function \(D(P,Q)\) to act as a similarity measure.

Comparing Distributions of FunctionsComparisons for distributions of functions in \(L^{2}()\) have been studied for specific cases of \(\)(Hall and Van Keilegom, 2007; Bugni and Horowitz, 2021; Pomann et al., 2016; Harris et al., 2021), but none of these have focused on \(L^{2}(^{2})\). The mathematical properties of probability measures in \((L^{2}())\) have been studied before (Gijbels and Nagy, 2017; Kim, 2006), but it is challenging to calculate distances such as the WD in this space without additional assumptions (Li and Ma, 2020). To define a similarity measure for distributions in \((L^{2}())\), we build on the theory of the sliced WD and its various extensions, which have only been defined for distributions of finite-dimensional data.

Sliced WDGiven a Borel function \(:\), the pushforward of \(P\) under \(\) is a valid distribution in \(()\) defined as \(\#P(B)=P(^{-1}(B))\) for all Borel sets \(B\) in \(\). The \(r\)-th order sliced WD (Bonneel et al., 2015) between \(P,Q(^{n})\) is a metric defined as the mean of the ordinary WD over univariate pushforwards:

\[SW_{r}(P,Q)=(_{^{n-1}}W_{r}(_{}\#P,_{}\# Q)^{r}d)^{1/r},\] (1)

where \(_{}(x)=x^{T}\) for \(x^{n}\) and \(^{n-1}\). We call \(_{}\) the slicing function because it produces one-dimensional "slices" of the data using projection matrices. Because \(_{}\#P\) and \(_{}\#Q\) are valid distributions in \(()\), the WD inside the integral can be calculated with the commonly used analytical form for univariate measures (Vallender, 1974).

Generalized Sliced WDThe generalized sliced WD (Kolouri et al., 2019) replaces \(_{}\) with a more general class of slicing functions, denoted as \(g_{}\). Because of this increased flexibility, the generalized sliced WD is a pseudometric rather than a metric except for specific cases of \(g_{}\)(Kolouri et al., 2019). For a given use case, the utility and metric properties of the generalized sliced WD are therefore determined by the choice of slicing function. Slicing functions can be chosen via optimization, estimated using neural networks, or specified by the researcher to isolate features of interest (Kolouri et al., 2019). The last option is desirable for our application, allowing the slices to be restricted to spatial features of interest to climate modelers. However, the generalized sliced WD is defined between distributions of data in \(^{n}\), a space that is not suitable for distributions of spatial fields. Climate fields could be coerced to vectors in \(^{n}\) to be made compatible with the generalized sliced WD. However, this would result in a loss of the inherent spatial structure, making it challenging to specify a slicing function that can handle considerations such as area weighting and spatial correlations.

Convolution Sliced WDThe convolution sliced WD (Nguyen and Ho, 2022) represents images as matrices in the space \(^{n n}\). The slicing function is replaced with kernel convolutions, or possibly a sequence of kernel convolutions, of \(d d\) pixels for \(d\). The kernel aggregates nearby locations to isolate local features, which could provide useful information to climate modelers. However, when climate fields are represented on a rectangular grid, the geographic area represented by each grid cell varies drastically between latitudes due to the non-Euclidean structure. Thus, a \(d d\) pixel kernel will cover different sizes and shapes of geographic areas depending on location. For our application, the kernel radius should therefore be defined using geographic distance, not pixels.

## 3 Methods

We introduce the functional sliced WD framework which extends the flexible slicing process from the generalized sliced WD to the infinite-dimensional case of functions in \(L^{2}()\). We focus on the special case of \(L^{2}(^{2})\), which we call the spherical convolutional WD (SCWD), for our climate model validation application. SCWD adapts the kernel convolution-based slicing idea of the convolutional sliced WD to a continuous setting while accounting for the non-euclidean structure of climate fields realized over the Earth's surface.

### Functional Sliced Wasserstein Distance

In general it is not possible to analytically characterize distributions in \((L^{2}())\) and there are no closed form solutions for computing the WD. However, it is possible to slice elements of \(L^{2}()\), meaning we can leverage the analytical form of the one-dimensional WD to define a computable sliced WD. We extend the convolution slicer from Nguyen and Ho (2022) to the functional data case, allowing us to project functions in \(L^{2}()\) to values in \(\) while preserving local spatial information.

**Definition 3.1** (Convolution Slicer).: Let \(\) be a compact subset of \(^{n}\), \(s\), and \(k\), called the kernel function, be a continuous function from \([0,)\). We define the convolution slicer \(c_{s}(f)\), a linear operator from \(f L^{2}()\), as follows:

\[c_{s}(f)=_{}f(u)k(s,u)du.\]

To create a valid functional sliced WD, we construct pushforward measures based on the convolution slicer \(c_{s}(f)\). To satisfy the definition of a pushforward measure, we must show that \(c_{s}(f)\) is a Borel measurable function from \(L^{2}()\). By continuity of \(k\), when location \(s\) is fixed, \(k(s,u)\) is a continuous function from \(u\). Because \(\) is compact, \(k(s,u)\) is a continuous function on a compact set and is thus bounded and \(L^{2}\)-integrable. It follows that the convolution slicer \(c_{s}(f)\) is an integral of the product of two functions \(f,k L^{2}()\), so by Holder's inequality, \(c_{s}(f)\) is a bounded linear operator from \(L^{2}()\). Stein and Shakarchi (2011) states that bounded linear operators are also continuous, so \(c_{s}(f)\) is a continuous linear operator and thus Borel measurable. So, for any measure \(P(L^{2}())\), the pushforward \(c_{s}\#P\) is a valid measure in \(()\). Therefore, we can define a functional sliced WD between distributions in \((L^{2}())\) as follows:

**Definition 3.2** (Functional Sliced WD).: Let \(\) be a compact subset of \(^{n}\), \(r 1\), and \(P,Q(L^{2}())\). Let \(c_{s}\) be an operator satisfying Definition 3.1. We define the (\(r\)-th order) functional sliced WD between \(P\) and \(Q\) as follows:

\[FSW_{r}(P,Q)=(_{}W_{r}(c_{s}\#P,c_{s}\#Q)^{r}ds)^{1/r}\]

where \(W_{r}\) is the Wasserstein metric on \(()\).

Because \(c_{s}\#P\) and \(c_{s}\#Q\) are valid univariate probability measures, the analytical form of the univariate WD can be applied for efficient calculations. We introduce theoretical properties for the functional sliced WD in Theorem 3.3

**Theorem 3.3**.: _For all compact subsets \(^{n}\), \(FSW_{r}\) is a pseudometric on \((_{})\) and maintains the \(r\)-convexity property of the ordinary \(W_{r}\) metric._

Figure 1: Diagram representing the calculation of SCWD between distributions of daily mean surface temperature (in degrees Celsius) from ERA5 and a CMIP6 model. Each day, many projections are computed using kernel convolutions, represented here at two locations. The resulting projections, called slices, summarize the local climate conditions in each dataset. The slices for each day are viewed as a sample from the marginal distribution at each location, represented here as histograms. SCWD is computed as a global mean over the univariate WD between each pair of local distributions.

Proof of Theorem 3.3 is provided in Appendix A. It is unknown if the final positivity property of a metric is satisfied. Proof of this property would require an invertible Radon-like transformation to be defined for probability measures in \((L^{2}())\). Therefore, as with the generalized sliced WD, it is up to the researcher to specify an appropriate kernel function over the domain of interest. We provide such a choice for our application and give theoretical justification in Section 3.2.

### Spherical Convolutional Wasserstein Distance

For our application to climate model validation, we specify the spatial domain \(\) to be the unit sphere \(^{2}\), the space over which latitude-longitude coordinates are assigned to locations on the Earth. To preserve local spatial information, we specify the slicing function to be a radial kernel function. We introduce the spherical convolutional WD (SCWD) as a specific case of the functional sliced WD:

**Definition 3.4** (Spherical Convolutional WD).: Let \(P,Q(L^{2}(^{2}))\) and \(r 1\). We define the (\(r\)-th order) SCWD between \(P\) and \(Q\) as follows

\[SCW_{r}(P,Q)=(_{^{2}}W_{r}(_{s}\#P,_{s}\#Q)^{r} ds)^{1/r},_{s}(f)=_{^{2}}f(u)(s,u)du,\]

where \(_{s}\) is a convolution slicer that satisfies Definition 3.1 with associated radial kernel \((s,u)\). Because \(\) is a radial kernel function, \(_{s}\) aggregates local information and the resulting pushforward measures \(_{s}\#P\) and \(_{s}\#Q\) represent the local distribution around each location \(s\). SCWD is therefore calculated as the global mean of the WD between local distributions at each location. The local WD values can be recorded and later visualized as a map to pinpoint regions with higher or lower similarity. Figure 1 demonstrates the process for calculating SCWD between two distributions of surface temperature fields, and details on the implementation are provided in Appendix B.

KernelIn our analysis, we specify the kernel function to be \((|s-u|;l)\), where \(|s-u|\) is the chordal distance between \(s\) and \(u\) and \(\) is the Wendland kernel function used in Nychka et al. (2015):

\[(d;l)=(1-d)^{6}(35d^{2}+18d+3)/3&d l,\\ 0&d>l,\] (2)

with range parameter \(l>0\) determining the radius over which the kernel is nonzero. The Wendland kernel meets the continuity assumption in Definition 3.1 and is also compact, which enables efficient sparse computations for our analysis.

Positive definite kernels, such as the Wendland kernel for \(l\) less than the diameter (Hubbert and Jager, 2023), allow us to retain full spatial information via the spectral density. This is because the convolution theorem on \(^{2}\)(Driscoll and Healy, 1994) gives an injective correspondence between the spectral density of a function \(f L^{2}(^{2})\) and the spectral density of the convolution \((f*k)(s)=_{^{2}}f(u)k(s,u)du\) when \(k\) is positive definite. Note that as \(l\), the Wendland kernel converges to the flat kernel \((d;)=1\), resulting in a SCWD where every slice is the global mean. In this case, the SCWD will be equal to the global mean-based WD from Vissio et al. (2020), leading to a complete loss of spatial variability information. In our analysis, we ensure a positive definite kernel by specifying \(l\) to be less than the diameter of the Earth (about \(12,750\) km). We study the sensitivity of our results to this parameter in Section 4.4.

Spatial AnalysisProjection selection approaches such as the Max-Sliced WD (Deshpande et al., 2019) and Energy-Based Sliced WD (Nguyen and Ho, 2024) have been introduced as alternatives to the sliced WD that give higher slicing weight to the directions of greatest variability between high-dimensional distributions. Each of our slices corresponds to a local mean around a specific location, so applying projection selection methods to SCWD would be equivalent to identifying the geographic regions in which two distributions of spatial fields have the greatest differences. This is of keen interest when validating climate models, so we examine spatial maps of our slices in Section 4.2 to identify these regions. However, for a comprehensive evaluation of climate fields, we favor the geographically-balanced SCWD in Definition 3.4 when evaluating similarity to reference datasets.

## 4 Climate Model Validation

We consider climate model outputs from the Coupled Model Intercomparison Project (CMIP) historical experiment phases 5 and 6. We focus on daily average near-surface (2m) temperature in degreesCelsius and daily total precipitation in mm. The CMIP6 historical simulations are organized by ensembles, each of which is distinguished with an ripf identifier (rip for CMIP5), representing realization, initialization, physics, and forcings of the model, respectively (Eyring et al., 2016). We obtain 46 CMIP6 model outputs with the rliipfl1 ID and 33 CMIP5 model outputs with the rliip1 ID. Output was obtained either at the daily frequency or aggregated from 3-hourly data. At the time of writing, two of the 79 total models did not have output available at a suitable frequency for surface temperature. All 79 models had output available for total precipitation.

To serve as references for climate model evaluation, we collect the European Centre for Medium-Range Weather Forecasts (ECMWF) Reanalysis 5th Generation (ERA5) (Hersbach et al., 2020) as well as the Reanalysis-2 data from the National Centers for Environmental Protection (NCEP) (Kanamitsu et al., 2002) reanalysis datasets. Both datasets were obtained for surface temperature and total precipitation at a daily frequency. Due to known issues with reanalysis data for precipitation (Tapiador et al., 2017), we obtain observations from the National Centers for Environmental Information (NCEI) Global Precipitation Climatology Project (GPCP) Daily Precipitation Analysis Climate Data Record (Huffman et al., 2001; Adler et al., 2020) as an additional reference for precipitation.

The historical time periods for each climate variable were chosen to maximize the available model outputs and reference datasets. For surface temperature, a common time period of January 1, 1979 to November 30th, 2005 was collected for each CMIP output and reanalysis dataset. For total precipitation, we restrict the time period to October 1, 1996 to November 30th, 2005 to accommodate the first available day of observations in the GPCP dataset. Each data product represents the climate variables on a different latitude-longitude grid, which varies in size and structure. See Appendix C for full details on the spatial resolution and availability of temperature/precipitation for each dataset.

### Evaluation of CMIP6 Models

To evaluate the skill of CMIP6 models in characterizing historical climate distributions, we compute SCWD between each model output and the reference datasets. Models which excel at replicating the local climate distribution in many different areas of the Earth will have a low SCWD. Conversely, models which fail to capture features of the local climate distributions, such as the mean, variance, or extremes, will have a higher SCWD. We do not expect perfect agreement between models and historical data, so, similar to Vissio et al. (2020), we additionally calculate SCWD between the reference datasets as a baseline for comparison. All SCWD calculations in this section use the Wendland kernel with range parameter of 1,000km for slicing.

We select the ERA5 Reanalysis as our reference dataset for (2m) surface temperature due to its high spatial resolution. We calculate distances from each surface temperature model output in our CMIP5 and CMIP6 ensembles to ERA5. In addition, we calculate SCWD between ERA5 and the NCEP Reanalysis to compare the variability between reanalysis datasets to the variability between models and reanalysis. For total precipitation, we select the GPCP observational data as our reference. We calculate distances from each total precipitation model output in our CMIP5 and CMIP6 ensembles to GPCP. We include SCWD calculations from GPCP to both ERA5 and NCEP for comparison, with the secondary goal of assessing the accuracy of each reanalysis in faithfully filling gaps in observed precipitation measurements. Full details on the SCWD rankings can be seen in Tables 2, 3, 4, and 5 in Appendix D. Here, we focus on the results for CMIP6, and Figure 2 provides the SCWD from each CMIP6 model output to the ERA5 surface temperature field and GPCP total precipitation field.

Surface TemperatureFor surface temperature, NCEP has a lower SCWD to ERA5 than all CMIP models. This is not a surprise: both ERA5 and NCEP are based on observations, so we expect their temperature distributions to be similar in most regions. Among the model outputs, many models have a SCWD to ERA5 similar to that of NCEP. In particular, AWI-CM-1-1-MR from the Alfred Wegener Institute and MPI-ESM1-2-HR from the Max Planck Institute have the lowest SCWD for surface temperature, with a few models close behind.

Total PrecipitationCompared to surface temperature, NCEP no longer has a lower SCWD to GPCP than the CMIP6 models. Instead, the ERA5 total precipitation field, which has the lowest SCWD to GPCP, serves as a better baseline for comparison. Deficiencies of precipitation from reanalysis have been reported in previous studies (Janowiak et al., 1998). In brevity, precipitation is sensitive to model physics and is not strongly constrained by observations via data assimilation. The low SCWD of ERA5 can likely be attributed to the high model resolution and more advanced model physics and data assimilation system compared to NCEP. Among the CMIP6 models, the Norwegian Climate Centre NorESM2-MM model output stands out with the lowest SCWD to GPCP by a relatively wide margin. The EC-Earth3 and CESM model outputs also form clusters with low SCWD values for precipitation.

No single model has the lowest SCWD value for both surface temperature and total precipitation, but NorESM2-MM seems to have the best balance of low distances for each variable and is not far off from the intersection of the lines for our reference datasets. Similarly, no model has the highest SCWD value for both climate variables. The GISS-E2-2-G model from NASA's Goddard Institute for Space Studies is a distinct outlier with a high surface temperature SCWD to ERA5, and the Beijing Climate Center BCC-ESM1 model is an outlier in terms of high SCWD to GPCP. We investigate these high SCWD values in Section 4.2.

### Spatial Comparisons

Because SCWD is calculated as a global mean of local WD values, we can investigate the geographic sources of these outlying high SCWD values. Figure 3 provides a spatial breakdown of the local WD values obtained when calculating SCWD for surface temperature between ERA5 and AWI-CM-1-1-MR as well as ERA5 and GISS-E2-2-G, the models with the lowest and highest SCWD to ERA5, respectively. Overall, both maps seem smooth or continuous in space, with little variation between neighboring locations in most cases. For the map between AWI-CM-1-1-MR and ERA5, the local WD values are relatively low everywhere, with regions of slightly higher values near the poles and mountains. Compared to AWI-CM-1-1-MR, the GISS-E2-2-G model has similarly low WD values in the tropics. However, closer to the poles, the local WD values begin to increase. In particular, the Arctic region has extremely high WD values relative to the rest of the Earth. This is indicative of the previously documented winter cool bias in the Arctic region for GISS-E2-2-G (Kelley et al., 2020).

Figure 2: Ranking CMIP6 model outputs using SCWD. Each model output is represented by a point on the scatter plot and models from the same group share the color and shape. The x-axis and y-axis values represent each model’s SCWD to the ERA5 surface temperature and GPCP total precipitation fields, respectively. The NCEP reanalysis is included as a blank triangle with dashed lines representing the SCWD to ERA5 and GPCP. The SCWD from the ERA5 total precipitation field to GPCP is represented as a solid line.

Similar maps are provided for the NorESM2-MM and BCC-ESM1 outputs compared to GPCP total precipitation. Overall, both maps are less smooth than the surface temperature maps, potentially due to the more localized nature of precipitation. Looking at both models, the higher values of SCWD near the equator in the Pacific and Atlantic oceans may be related to the double-Intertropical Convergence Zone problem common in CMIP models, in which excessive precipitation is produced in the southern tropics (Mechoso et al., 1995). This trend is much more pronounced for BCC-ESM1 than for NorESM2-MM. Additionally, BCC-ESM1 has a region of particularly high WD values around eastern Indonesia, where wind-terrain interaction plays an important role in the regional distribution of precipitation. This region has been previously highlighted in Zhang et al. (2021) as an area where BCC-ESM1 heavily overestimates annual mean precipitation. SCWD maps for both climate variables and all CMIP5/CMIP6 model outputs are provided in the supplemental material.

### Comparing CMIP5 and CMIP6

To assess the progression from CMIP5 to CMIP6, Figure 4 provides boxplots of the SCWD from each CMIP model to the reference datasets. The left panel provides SCWD calculations from the surface temperature models and NCEP to the ERA5 Reanalysis. The median SCWD value for CMIP6 models to ERA5 is lower than that of CMIP5. However, the two boxplots share a similar range, so the difference between the CMIP5 and CMIP6 ensembles is subtle. Overall, we see a promising, albeit limited, decrease in SCWD for typical CMIP6 models compared to CMIP5. This indicates improved performance of CMIP6 when it comes to reconstructing realistic temperature distributions at the local level. The right panel provides SCWD calculations from each precipitation model and ERA5/NCEP to the GPCP dataset. The median SCWD value for CMIP6 is again lower than that of CMIP5. Compared to surface temperature, the difference between CMIP5 and CMIP6 is more distinct. This indicates that relative to surface temperature, precipitation modeling has seen greater gains with the transition from CMIP5 to CMIP6. The improvement of CMIP6 models compared to CMIP5 in precipitation representation has been reported in previous studies using different evaluation

Figure 3: Top: Map of local Wasserstein distances from ERA5 to two CMIP6 2m surface temperature outputs: AWI-CM-1-1-MR and GISS-E2-2-G. Bottom: Map of local Wasserstein distances from GPCP to two CMIP6 total precipitation outputs: NorESM2-MM and BCC-ESM1. Color fill at each location is determined by the WD between the local distributions obtained from the convolution slicer in Definition 3.4. The color scale is shared for all maps and continental boundaries are included in black to aid spatial comparisons.

methods (e.g., Chen et al. (2021)). It can be probably attributed to the more advanced model physics and overall higher model resolution in CMIP6.

### Metric Comparison

We compare our method to baseline methods and evaluate the sensitivity of our results to the choice of range parameter. We generate seven additional rankings for the CMIP models: SCWD with a range of 500km and 2,500km respectively, the global mean-based WD (GMWD) from Vissio et al. (2020), RMSE and MAE computed on long-term mean climatologies, and WD and Sliced WD on data regridded to an icosahedral grid to preserve area weighting. Technical details and rankings together with our original 1,000km SCWD results can be seen in Tables 2 and 3 in Appendix D.

All SCWD rankings are nearly identical regardless of the range parameter, except that several precipitation models, such as GFDL-CM4 and E3SM-2-0, rank better with a larger range. From here forward, we focus only on the chosen 1,000km range parameter for SCWD. For most baseline methods (RMSE, MAE, WD, and Sliced WD), their rankings are moderately similar to those of SCWD, indicating general agreements, though each metric still shows unique perspectives. However, there is a large discrepancy between the rankings of GMWD and all other rankings. For surface temperature, SCWD, RMSE, and WD all show that the distance from NCEP to ERA5 is lower than that of all CMIP6 models, and MAE and Sliced WD also rank NCEP favorably among the models. However, GMWD ranks NCEP only among the median CMIP6 models. For precipitation, we see a similar result for ERA5 compared to GPCP: ERA5 has the best ranking when using SCWD, RMSE, MAE, and WD, but is third in the rankings for Sliced WD and again is around the median for GMWD.

To better understand the differences in rankings between SCWD and baseline model evaluation methods such as GMWD and RMSE/MAE, Appendix E provides an experiment and data example. The experiment shows a case where SCWD detects changes in both the climatological mean and the variance of the anomalies, while the other methods detect only one type of change. In particular, we show that the RMSE and MAE criteria are unable to detect isolated changes in the variance of the anomalies. The data example focuses on the SAM0-UNICON surface temperature model. Despite the overall similarity in rankings for CMIP6 surface temperature, this model ranks significantly higher by RMSE/MAE than by SCWD. Further investigation shows that SAM0-UNICON exhibits significant differences in both the climatological mean and the variance of the anomalies. Because RMSE/MAE are unable to detect shifts in the variance of the anomalies they artificially inflate the ranking of this model compared to SCWD.

Figure 4: Left: Boxplots of SCWD from the CMIP5 and CMIP6 model outputs to the ERA5 Reanalysis for 2m surface temperature. Right: Boxplots of SCWD from the CMIP5 and CMIP6 model outputs to the GPCP observational dataset for total precipitation. Each plot contains points representing the SCWD from each CMIP model output to the reference dataset (ERA5 or GPCP), with CMIP5 and CMIP6 separated into two boxplots for comparison. Dotted and dashed lines are included to represent the SCWD from NCEP to ERA5/GPCP and ERA5 to GPCP, respectively.

Discussion

Climate model validation is critical for ensuring that climate models faithfully represent the Earth system. To this end, we developed a new similarity measure, called spherical convolutional Wasserstein distance (SCWD), which quantifies model performance in a way that properly accounts for spatial variability. SCWD builds on previous sliced WD methods to compare distributions of infinite-dimensional functional data, specifically surfaces on the sphere \(^{2}\). Overall, our results indicate that incorporating local perspectives, rather than just the global mean, is essential when evaluating the similarities between climate models and observational data. In both theory and practice, a model that represents the global mean well may have large compensating errors at the regional scale. SCWD better represents the regional performance of climate models than the previously proposed WD-based evaluation criteria in (Vissio et al., 2020). Furthermore, SCWD is not limited to only comparing the long-term mean climate state as with RMSE and MAE, and our convolution slicing provides better spatial insights (in the form of maps) than WD and Sliced WD.

For surface temperature, we found evidence to suggest that SCWD is more accurate than the previous WD-based approach for evaluating climate models, such as the two reanalysis datasets being more similar compared to climate models and reanalysis. However, for precipitation, similar findings were made for only one of the reanalysis datasets. Given the limitations with reanalysis for precipitation discussed in Section 4.1, additional experiments from different perspectives may be needed to fully assess the accuracy of our method. Because we have only shown that SCWD is a pseudometric, rather than a metric, SCWD may not be able to fully distinguish between climate fields which have differences only in the joint spatial distribution, rather than at the local level. We acknowledge that determining the sample complexity of SCWD is an area that requires further investigation.

We hope our method will be tested under many different scenarios and variables in climate science. For example, calculating SCWD on monthly mean or even annual data could help to detect biases in terms of longer range temporal variability. Another idea is to remove long-term climatological means from the data before computing SCWD. This would provide additional insight into which features are being captured beyond the mean climate state. SCWD can also be applied to machine-assisted climate model tuning (Hourdin et al., 2017), a growing area of research that relies on quality model evaluation metrics. Some ideas for future work to further improve SCWD include learning an optimal range value for the Wendland kernel function or using a neural network to estimate the kernel function, similar to Kolouri et al. (2019).

Outside of climate science, SCWD can be used as a loss function for training generative models for 360\({}^{o}\) images. This only requires a straightforward extension of SCWD to allow for multiple convolution layers, similar to the rectangular case in Nguyen and Ho (2022). Likewise, the more general functional sliced WD can be used as a loss function for generative models on any functional manifold. For example, we can apply the functional sliced WD to texture mapping or color transfer on the surface of 3D models, which are typically considered as non-euclidean manifolds. SCWD can be also adapted to compare distributions of spatiotemporal fields, rather than spatial fields as in this article, by including both time and space in the functional data domain. This would require specifying a space-time kernel function (Porcu et al., 2016). The more functional sliced WD framework has a variety of potential use cases for comparing distributions of functions on a broad class of manifolds. Potential application areas where the data lie on non-trivial manifolds include facial recognition (Li et al., 2014), astronomy (Szapudi, 2008), and ecology (Sutherland et al., 2015).