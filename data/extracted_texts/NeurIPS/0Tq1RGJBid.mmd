# A Fast and Accurate Estimator for Large Scale Linear Model via Data Averaging

Rui Wang

Center for Applied Statistics

and School of Statistics

Renmin University of China

Beijing 100872, China 446100240@qq.com

&Yanyan Ouyang

Center for Applied Statistics

and School of Statistics

Renmin University of China

Beijing 100872, China staoyyy@ruc.edu.cn

&Panpan Yu

NavInfo

Beijing 100094, China

yupanpan@navinfo.com

&Wangli Xu

Center for Applied Statistics

and School of Statistics

Renmin University of China

Beijing 100872, China wlxu@ruc.edu.cn

###### Abstract

This work is concerned with the estimation problem of linear model when the sample size is extremely large and the data dimension can vary with the sample size. In this setting, the least square estimator based on the full data is not feasible with limited computational resources. Many existing methods for this problem are based on the sketching technique which uses the sketched data to perform least square estimation. We derive fine-grained lower bounds of the conditional mean squared error for sketching methods. For sampling methods, our lower bound provides an attainable optimal convergence rate. Our result implies that when the dimension is large, there is hardly a sampling method can have a faster convergence rate than the uniform sampling method. To achieve a better statistical performance, we propose a new sketching method based on data averaging. The proposed method reduces the original data to a few averaged observations. These averaged observations still satisfy the linear model and are used to estimate the regression coefficients. The asymptotic behavior of the proposed estimation procedure is studied. Our theoretical results show that the proposed method can achieve a faster convergence rate than the optimal convergence rate for sampling methods. Theoretical and numerical results show that the proposed estimator has good statistical performance as well as low computational cost.

## 1 Introduction

Linear regression model is one of the simplest and the most fundamental models in statistics and machine learning. Suppose one collects independent and identically distributed (i.i.d.) observations \(\{Z_{i},y_{i}\}_{i=1}^{N}\), where \(Z_{i}^{p}\) is the vector of the predictors and \(y_{i}\) is the response. The linear model assumes

\[y_{i}=_{0}+Z_{i}^{}_{1}+_{i}, i=1,,N,\] (1)

where \(_{0}\), \(_{1}^{p}\) are the unknown coefficients and \(_{1},,_{N}\) are random variables representing noise. Let \(X_{i}=(1,Z_{i}^{})^{}\), \(=(_{0},_{1}^{})^{}\), \(=(y_{1},,y_{N})^{}\) and \(=(X_{1},,X_{N})^{}\). The classical least square estimator equals \(_{^{p+1}}\|-\|^ {2}\). If \(\) has full column rank, the least square estimator equals \((_{i=1}^{N}X_{i}X_{i}^{})^{-1}_{i=1}^{N}X_{i}y_{i}\) and the direct computation costs \(O(Np^{2})\)time. For large scale linear models with \(N p\), the computing time \(O(Np^{2})\) of the exact least square estimator is not negligible. Faster estimators of \(\) can largely facilitate the practical data analysis pipelines.

Numerous research efforts have been devoted to the estimation problem for large scale linear model. Many existing work in this area can be understood as matrix sketching methods which explicitly or implicitly use matrix sketches as surrogates for the original observations to reduce the data size. Specifically, sketching methods solve the sketched least square problem

\[_{^{p+1}}\|^{}-^{ }\|^{2},\] (2)

where \(^{N n}\) is a sketching matrix with \(n N\). The solution to the problem (2) is the least square estimator based on the reduced data \(^{}^{n(p+1)}\) and \(^{}^{n}\). Since \(n N\), the sketched least square problem can be solved much faster than the least square estimator for the full data. In this paper, we only consider the case that \(\) is independent of \(_{1},,_{N}\). That is, \(\) may rely on \(\), but not rely on \(\). This guarantees that the solution to (2) is an unbiased estimator of \(\). Note that sampling methods are special cases of the sketching framework (2). In fact, for a sampling method, each column of \(\) is a vector whose elements are all \(0\) except one that equals \(1\). Sketching methods have been intensively researched in algorithmic aspect; see Mahoney (2010); Woodruff (2014); Drineas and Mahoney (2016) for reviews. Recently, the statistical aspect of sketching methods also draws much attention; see, e.g., Ma et al. (2015); Raskutti and Mahoney (2016); Wang et al. (2017); Dobriban and Liu (2019); Ma et al. (2020); Ahfock et al. (2021).

Probably the simplest sketching method is the uniform sampling method which randomly selects \(n\) observations with equal probability to form the reduced data. Recently, Pilanci and Wainwright (2016) provides a minimax lower bound for the mean squared prediction error of random sketching methods. Theorem 1 of Pilanci and Wainwright (2016) shows that for a large class of random sketching methods, including many existing data-oblivious sketching methods and sampling methods, the convergence rate of the mean squared prediction error can not be faster than the uniform sampling method. Hence it is a nontrivial task to construct a sketching method which has significantly better statistical performance than the uniform sampling method.

Recently, Wang et al. (2019) initiates the study of sampling methods based on extreme values. Motivated by the D-optimal criterion, Wang et al. (2019) proposed the information-based optimal subdata selection (IBOSS) algorithm which successively selects informative observations based on extreme values of variables. They showed that for fixed \(p\), the estimator produced by the IBOSS algorithm can have a faster convergence rate than the uniform sampling method. Meanwhile, the computation of the IBOSS algorithm can be completed within \(O(Np+np^{2})\) time which has the same order as the uniform sampling method if \(n=cN/p\) for some constant \(c>0\). Now the algorithm of Wang et al. (2019) has become the building block of some recent methods for large scale problems. For example, Wang (2019) proposed an algorithm which combines the algorithm of Wang et al. (2019) and the divide and conquer strategy. Cheng et al. (2020) extended the algorithm of Wang et al. (2019) to the logistic regression model. Existing asymptotic results for the IBOSS algorithm are obtained in the setting of fixed \(n\) and \(p\). At present, there is still a lack of theoretical understanding of the behavior of the IBOSS algorithm in the setting of varying \(n\) and \(p\).

The IBOSS algorithm is a sampling method and is therefore an instance of the sketching framework (2). Interestingly, the IBOSS algorithm can surpass the minimax lower bound of Pilanci and Wainwright (2016). In fact, a key condition for Theorem 1 of Pilanci and Wainwright (2016) does not hold for the IBOSS algorithm. Thus, the IBOSS algorithm is not restricted by the minimax bound of Pilanci and Wainwright (2016). This fact is detailed in Section 2. Note that there are many potential sketching methods which are not restricted by the minimax bound of Pilanci and Wainwright (2016). To give a more comprehensive understanding of the behavior of these sketching methods, we derive fine-grained lower bounds for the conditional mean squared error of the sketched least square estimators produced by (2) in the setting that \(Z_{i}\) is a standard normal random vector. In particular, our result provides a lower bound for any sampling method which may possibly rely on \(\) but does not rely on \(\). It turns out that if \(p(N/n)\), then the optimal lower bound for sampling methods can have a faster convergence rate than the uniform sampling method. On the other hand, if \((N/n) p\), any sampling method can not largely surpass the uniform sampling method. Furthermore, we derive the asymptotic behavior of the IBOSS algorithm in the setting of varying \(n\) and \(p\). It turns out that under certain conditions, the IBOSS algorithm can achieve the optimal rate for sampling methods.

For large scale linear models, it is often the case that \((N/n) p\). In this case, any sampling method can not have a significantly better statistical performance than the uniform sampling method. Inspired by this phenomenon, we propose an alternative sketching method which can reduce the full data to just a few observations while the resulting estimator of \(\) may have smaller conditional mean squared error than sampling methods. The proposed method is based on data averaging. The main idea is to partition the observations into \(2p\) groups such that the averages of \(Z_{i}\) within groups are separated. The least square estimator based on \(2p\) averaged observations is used to estimate \(\). The computation of the proposed method can be completed within \(O(Np+p^{3})\) time. Our theoretical results show that the proposed method can have a faster convergence rate than any sampling methods with comparative computing time. Also, the proposed method reduces the full data to merely \(2p\) averaged observations. These averaged observations also satisfy the linear model (1) and have independent errors. Consequently, it is convenient to further compute other estimators or conduct statistical inferences using the reduced data. The good performance of the proposed estimator is also verified by simulation results and a real data example. Table 1 summarizes the theoretical performance of the proposed method and compare it with the ideal sampling method implied by Theorem 2 and the IBOSS algorithm.

The rest of the paper is organized as follows. Section 2 investigates lower bounds for the conditional mean squared error of the sketched least square estimators produced by (2). In Section 3, we propose a data averaging method to estimate \(\) and investigate its asymptotic behavior. Section 4 presents the simulation results briefly. Section 5 concludes the paper. The simulation results, a real data analysis and all proofs are deferred to the Supplement Material.

We close this section by introducing some notations and assumptions that will be used throughout the paper. For any real number \(w\), let \( w\) denote the largest integer not larger than \(w\). For any vector \(W\), let \(\|W\|\) denote the Euclidean norm of \(W\). For any matrix \(\), let \(\|\|\) and \(\|\|_{F}\) denote the operator norm and the Frobenious norm of \(\), respectively. Moreover, denote by \(_{:,j}\) the \(j\)th column of \(\). If \(\) is symmetric, denote by \(_{i}()\) the \(i\)th largest eigenvalue of \(\). In this paper, the symmetric matrices are equipped with Loewner partial order. That is, for two symmetric matrices \(_{1}\) and \(_{2}\), \(_{1}>_{2}\) if and only if \(_{1}-_{2}\) is positive definite. For a positive semidefinite matrix \(\), let \(^{1/2}\) denote a positive semidefinite matrix such that \((^{1/2})^{2}=\). For any set \(\), denote by \(^{}\) its complement and \(()\) its cardinality. Let \((x)\) and \((x)\) denote the distribution function and density function of the standard normal distribution, respectively. For random variables \(\) and \(>0\), \(=o_{P}()\) means that \(/\) converges to \(0\) in probability, and \(=O_{P}()\) means that \(/\) is bounded in probability.

Let \(N\) denote the size of full sample, \(p\) denote the dimension of covariates. Let \(=(Z_{1},,Z_{N})^{}\) be an \(N p\) matrix of covariates. Denote by \(z_{i,j}\) the \(j\)th element of \(Z_{i}\), \(i=1,,N\), \(j=1,,p\). Let \(z_{(1),j} z_{(N),j}\) denote the order statistics of \(\{z_{i,j}\}_{i=1}^{N}\), \(j=1,,p\). The following assumption for the data distribution is assumed throughout the paper.

   Methods & Reduced sample size & \(\{\|}_{}}-\|^{2} \}\) & Computing time \\  ISM & \(n\) & \(O_{P}(}{n(p+())})\) & — \\ IBOSS & \(n\) & \(O_{P}(}{n(p+())})\) & \(O(Np+np^{2})\) \\ NEW & \(2p\) & \((1+o_{P}(1))_{}^{2}}{2(2p)N}\) & \(O(Np+p^{3})\) \\   

Table 1: Theoretical performance of the ideal sampling method (abbreviated as ISM), the IBOSS algorithm and the proposed method when \(Z_{1}(_{p},_{p})\). Assume that as \(N\), \(p\), \(p^{3}((p))^{4}(N)/N\), \(n=O(N^{})\) for some \(0<<1/2\) and \(p=O(n^{1/2-^{}})\) for some \(0<^{}<1/2\), \((N/n)=O(p^{2})\). See Theorems 2, 3, 4. The reported computing time is under the assumption that the multiplication of an \(m n\) matrix and an \(n p\) matrix costs \(O(mnp)\) time, and the inversion of a \(p p\) matrix costs \(O(p^{3})\) time.

**Assumption 1**: _Suppose \(\{Z_{i},y_{i}\}_{i=1}^{N}\) are i.i.d. and satisfy the linear model (1), where \((_{1})=0\), \((_{1})=_{}^{2}\) and \(_{1}\) is independent of \(Z_{1}\). Suppose \(Z_{1}\) has a density function \(f(z_{1,1},,z_{1,p})\) with respect to the Lebesgue measure on \(^{p}\), and \((Z_{1})=\), \((Z_{1})=\) are finite. Suppose \(=(_{i,j})_{i,j=1}^{p}\) is positive definite. Suppose \(r>0\). As \(N\), the dimension \(p\) is a function of \(N\), while the distribution of \((Z_{1},y_{1})\) only relies on \(p\). Finally, assume \(_{}^{2}\) is a constant which does not depend on \(N\)._

For simplicity, our notations suppress the dependence of \(p\) on \(N\), and the dependence of the distribution of \((Z_{1},y_{1})\) on \(p\).

## 2 Risk bounds for sketched least square estimators

Theorem 1 of Pilanci and Wainwright (2016) provides a minimax lower bound for the mean squared prediction error of random sketching methods. Their result implies that under certain conditions, there exists a constant \(C>0\) such that for any estimator \(}\) which only relies on \((^{},^{})\),

\[_{^{p}}\{N^{-1}\|( {}-)\|^{2}\}_{}^{2}.\]

The optimal convergence rate \(p/n\) can be achieved by the least square estimator based on \(n\) uniformly selected observations.A key condition for the above result is that

\[\|\,((^{})^{-1}^{} )\| cn/N\] (3)

for some constant \(c>0\).

The result of Pilanci and Wainwright (2016) can be applied to general estimators based on \((^{},^{})\). In this paper, however, we focus on the least square estimator based on \((^{},^{})\). Let \(}_{}\) denote the solution to the sketched least square problem (2). In this paper, we use the conditional mean squared error \(\{\|}_{}-\|^{2} \}\) to measure the performance of \(}_{}\). The following theorem gives a lower bound for the conditional mean squared error of \(}_{}\).

**Theorem 1**: _Suppose Assumption 1 holds, \(Z(_{p},_{p})\), the sketching matrix \(\) is an \(N n\) matrix with full column rank. Assume that \(\) is independent of \(_{1},,_{N}\) and with probability \(1\), \(^{}\) has full column rank. Suppose as \(N\), \(p/N 0\). Then as \(N\), \(\{\|}_{}-\|^ {2}\}\)(1+o_{P}(1)) \(\|((^{})^{-1}^{} )\|^{-1}\,_{}^{2}.\)_

Theorem 1 gives an explicit characterization of the impact of \(((^{})^{-1}^{} )\) on the lower bound of \(\{\|}_{}-\|^{2} \}\). Pilanci and Wainwright (2016) showed that the condition (3) is satisfied by many classical sketching methods. Under the conditions of Theorem 1, for sketching methods satisfying the condition (3), the convergence rate of \(\{\|}_{}-\|^{2} \}\) is lower bounded by \(p/n\), which is the convergence rate for the uniform sampling method. Thus, in order to achieve a faster convergence rate than the uniform sampling method, the condition (3) should be violated.

Many existing sketching methods are through sampling the observations. For sampling methods, \(\) is a column orthogonal matrix and each column of \(\) has a single nonzero element with value \(1\). Hence \((^{})^{-1}^{}\) is a diagonal matrix whose diagonal elements are zeros and ones. For the IBOSS algorithm of Wang et al. (2019), the selected observations are completely determined by \(\) and does not rely on additional randomness. Consequently \(\|\,((^{})^{-1}^{} )\|=\|(^{})^{-1}^{ }\|=1\). In this case, the lower bound provided by Theorem 1 has rate \(p/N\) which is too loose. The following theorem gives a tighter lower bound of the mean squared error for sampling methods.

**Theorem 2**: _Suppose Assumption 1 holds, \(Z(_{p},_{p})\), the sketching matrix \(\) is an \(N n\) matrix with full column rank. Assume that \(\) is independent of \(_{1},,_{N}\) and with probability \(1\), \(^{}\) has full column rank. Furthermore, suppose \(((^{})^{-1}^{} )=(d_{1},,d_{N})\). Let \(d_{}=_{i\{1,,N\}}d_{i}\) Then_

\[\{\|}_{}-\|^{2} \} }{6n(p+(}{n}) )+O_{P}(n)}_{}^{2}.\]If the matrix \(((^{})^{-1}^{} )=(d_{1},,d_{N})\) is diagonal, then

\[d_{}=_{^{N},\|\|=1}^{}\,( (^{})^{-1}^{}) (_{^{N},\|\|=1}^{} (^{})^{-1}^{})=1.\]

Under the conditions of Theorem 2, the optimal convergence rate for sampling methods is lower bounded by

\[}{n(p+())}.\] (4)

Note that if \(p(N/n)\), then the rate (4) is faster than the uniform sampling method. Theorem 4 in Section 3.2 will show that under certain conditions, the method of Wang et al. (2019) can achieve the optimal rate (4).

It is worth mentioning that Theorems 1 and 2 are obtained under the condition \(Z_{i}(_{p},_{p})\). Perhaps, these results can be extended to the case that \(Z_{i}\) has a general multivariate distribution. However, such results may not be valid if the distribution of \(Z_{i}\) has heavier tail than normal distribution. In fact, our numerical results imply that a faster convergence rate may be achieved when the distribution of \(Z_{i}\) has heavy tail.

## 3 An estimator via data averaging

In this section, we would like to propose a new sketching method which can hopefully have good statistical performance with low computational cost. To be simple, when considering computation time, it is understood that the multiplication of an \(m n\) matrix and \(n p\) matrix costs \(O(mnp)\) time, and the inversion of a \(p p\) matrix costs \(O(p^{3})\) time. Note that the computation time \(O(Np)\) is essential if each observation is accessed at least once, e.g., to be loaded into the memory. The sketched least square problem (2) involves \(n\) reduced observations and the direct computation costs \(O(np^{2}+p^{3})\) computation time. The computation time \(O(p^{3})\) comes from the inversion of a \((p+1)(p+1)\) matrix which is essential no matter how \(n\) is chosen. Hence the direct computation of any reasonable estimator which uses the information of the full data requires at least \(O(Np+p^{3})\) time. Thus, we restrict our attention to algorithms that can be completed within \(O(Np+p^{3})\) time.

To complete the computation within \(O(Np+p^{3})\) time, one needs to take \(n=O(N/p+p)\). Theorem 2 implies that if \(n=c_{1}N/p+c_{2}p\) where \(c_{1},c_{2}>0\) are constants, then the optimal convergence rate for sampling methods reduces to \(p/n\) which is equal to the convergence rate for the uniform sampling method. Also, for large \(N\), the reduced sample size \(n=c_{1}N/p+c_{2}p\) may still be large. To achieve a faster convergence rate and a better reduction of data, we would like to consider sketching methods other than sampling methods. This motivates us to propose a new data averaging method.

### Methodology

Let \(_{1},,_{k}\{1,,N\}\) be \(k\) mutually disjoint index sets, each containing \(r\) indices, and \(_{i=1}^{k}_{i}=\{1,,N\}\). To use the information of the full data, we assume \(N=kr\). Let \(_{j}=r^{-1}_{i_{j}}Z_{i}\) and \(_{j}=r^{-1}_{i_{j}}y_{i}\) be the averaged observation within the \(j\)th index set, \(j=1,,k\). It can be seen that

\[_{j}=_{0}+_{j}^{}_{1}+_{j},\]

where \(_{j}=r^{-1}_{i_{j}}_{i}\). Suppose that the choice of the index sets \(_{1},,_{k}\) is based on the covariates \(\{Z_{i}\}_{i=1}^{N}\) and does not rely on the responses \(\{y_{i}\}_{i=1}^{N}\). Then \(_{1},,_{k}\) are mutually independent and are independent of \(\{_{j}\}_{j=1}^{k}\). Also, \(_{j}\) has mean \(0\) and variance \(_{}^{2}/r\). Thus, the averaged observations also satisfy the linear model and one can estimate \(\) by the least square estimator base on \(k\) reduced observations as \(}=(_{j=1}^{k}_{j}_{j}^{})^{-1}(_ {j=1}^{k}_{j}_{j}),\) where \(_{j}=r^{-1}_{i_{j}}X_{i}\), \(j=1,,k\). We would like to choose \(_{1},,_{k}\) such that \(}\) is a fast and accurate estimator of \(\). Let \(=_{=1}^{k}(_{}-)(_{}-)^{}\) and \(=N^{-1}_{i=1}^{N}Z_{i}\). The conditional mean squared error of \(\) is

\[(\|}-\|^{2})= ^{2}}{N}\{( k&_{j=1}^{k}_{j}^{}\\ _{j=1}^{k}_{j}&_{j=1}^{k}_{j}_{j}^{} )^{-1}\}\] \[= ^{2}}{N}\{( +^{}^{-1}&-^{ }^{-1}\\ -^{-1}&^{-1})\}\] \[= (k((^{-1})+^{} ^{-1})+1)^{2}}{N}.\]

In order to achieve a good statistical accuracy, we would like to choose the index sets such that \((^{-1})+^{}^{-1}\) is minimized.

First we consider the simplest case of \(p=1\). In this case, the matrix \(\) reduces to a real number. Since \(^{2}\), one needs at least two observations to estimate \(\). To achieve maximum reduction of data, we take \(k=2\). Then \(\) takes its maximum when \(_{1}=\{i\{1,,N\}:z_{i,1} z_{(N/2),1}\}\) and \(_{2}=\{i\{1,,N\}:z_{i,1} z_{(N/2+1),1}\}\). The least square estimator of \(\) based on the averaged observations is \(}=((_{2}_{1}-_{1}_{2})/(_{2}-_{1}),(_{2}-_{1})/(_{2}-_{1}))^{}\). The above estimator \((_{2}-_{1})/(_{2}-_{1})\) of \(_{1}\) is considered in Barton and Casley (1958) as a quick estimate of \(_{1}\), which only considered the case of \(p=1\). To the best of our knowledge, no previous study generalized this estimator of Barton and Casley (1958) to the case \(p>1\).

For the general case of \(p 1\), the exact minimizer of \((\|}-\|^{2})\) may not be easy to obtain. A simpler criterion to choose the index sets is to maximize the trace \(()=_{=1}^{k}\|_{}-\|^{2}\). This problem is equivalent to minimizing \(_{=1}^{k}_{i_{}}\|Z_{i}-_{}\|^{2}\) and is an instance of the balanced \(k\)-means clustering problem; see Lin et al. (2019) and the references therein. Unfortunately, algorithms for the \(k\)-means clustering problem are computationally intensive. In fact, for the vanilla \(k\)-means algorithm, each iteration takes \(O(Npk)\) time which even exceeds the computing time of the least square estimator based on the full data. To achieve a balance between the statistical accuracy and the computing time, we deal with each variable in turn. We take \(k=2p\) and for \(j=1,,p\), we determine two index sets, namely \(_{r,j}\) and \(_{r,j}\), based on the \(j\)th variable. Hence the set \(\{1,,N\}\) is partitioned into \(2p\) index sets \(_{r,1},,_{r,p}\) and \(_{r,1},,_{r,p}\), each containing \(r=N/(2p)\) indices. The choice of these index sets is based on the following lower bound of \(()\),

\[()= _{j=1}^{p}_{=1}^{p}_{i _{r,}}z_{i,j}-_{i=1}^{N}z_{i,j}^{2}+ _{i_{r,}}z_{i,j}-_{i=1 }^{N}z_{i,j}^{2}}\] \[ _{j=1}^{p}_{=1}^{j-1}_{i_{r,}}z_{i,j}-_{i=1}^{N}z_{i,j} ^{2}+_{i_{r,}}z_{i,j}-_{i=1}^{N}z_{i,j}^{2}}\] \[+(_{j}-_{i _{r,j}}z_{i,j},0)^{2}+(_{i _{r,j}}z_{i,j}-_{j},0)^{2}},\]

where \(_{j}=(2r(p-j+1))^{-1}_{i_{j=1}^{j-1}(_{r, }_{r,})}z_{i,j}\). For \(j=1,,p\), we choose \(_{r,j}\) and \(_{r,j}\) to maximize the \(j\)th term of the above lower bound. Specifically, the first term of the above lower bound is \(\{(_{1}-_{i_{r,1}}z_{i,1}/r,0)\}^{2}+\{(_{i _{r,1}}z_{i,1}/r-_{1},0)\}^{2}\), which takes its maximum when \(_{r,1}=\{i\{1,,N\}:z_{i,1}_{1,1}\}\) and \(_{r,1}=\{i\{1,,N\}:z_{i,1}_{2,1}\}\) where \(_{1,1}=z_{(r),1}\) and \(_{2,1}=z_{(N-r+1),1}\). After obtaining the index sets \(_{r,1},,_{r,j-1}\) and \(_{r,1},,_{r,j-1}\), we choose \(_{r,j}\) and \(_{r,j}\) to maximize the \(j\)th term of the above lower bound, which is equivalent to maximizing \(\{(_{j}-_{i_{r,j}}z_{i,j}/r,0)\}^{2}+\{(_{i _{r,j}}z_{i,j}/r-_{j},0)\}^{2}\). Hence we choose \(_{r,j}\) and \(_{r,j}\) to be the indices of the remaining observations whose \(j\)th variable is no larger than \(_{1,j}\) and no less than \(_{2,j}\), respectively, where \(_{1,j}\) and \(_{2,j}\) are the \(r\)th smallest and the \(r\)th largest element of \(\{z_{i,j}:i\{1,,N\}(_{=1}^{j-1}(_{r, }_{r,}))\}\), respectively. We average the observations within the groups \(_{r,1},,_{r,p}\) and \(_{r,1},,_{r,p}\). Finally, we use the least square estimator based on the \(2p\) averaged observations to estimate \(\). The proposed estimation procedure is summarized in Algorithm 1.

In Algorithm 1, our strategy to select the index sets \(_{r,j}\) and \(_{r,j}\) is closely related to the IBOSS algorithm of Wang et al. (2019). In fact, the index sets in Algorithm 1 is exactly the index sets selected by IBOSS algorithm with subdata size \(n:=N\). Of course, for IBOSS algorithm, taking \(n=N\) is unreasonable since the sample size is not reduced. In fact, for IBOSS algorithm, one needs to take \(n=O(N/p+p)\) to complete the computation within \(O(Np+p^{3})\) time. Thus, the selection procedures of the proposed method and the IBOSS algorithm have different behavior. Theorem 4 will show that under certain conditions, IBOSS can achieve the optimal convergence rate (4) among all sampling methods. We shall see that the statistical performance of Algorithm 1 is even better than the IBOSS algorithm.

Now we give an analysis of the computing time of Algorithm 1. Note that \(_{1,j}\) and \(_{2,j}\) are order statistics of no more than \(N\) elements. It is known that the selection of an order statistic among \(m\) elements can be completed within \(O(m)\) time even in the worst case; see Paterson (1996). Hence the computation of \(_{1,1},,_{1,p}\) and \(_{2,1},,_{2,p}\) can be completed within \(O(Np)\) time in total. It takes only one scan of the full data to compute the averaged observations, which takes \(O(Np)\) time. Finally, the computation of \(}_{}\) based on \(2p\) averaged observations can be completed within \(O(p^{3})\) time. In summary, Algorithm 1 can be completed within \(O(Np+p^{3})\) time and reduces the full data to merely \(2p\) observations.

### Asymptotic results

Now we investigate the asymptotic behavior of the conditional mean squared error of \(}_{}\). In our asymptotic results, we treat \(p\) as a function of \(N\), and \(N\) tends to infinity. Let \(Z=(z_{1},,z_{p})^{}\) be a random vector which is independent of \(\) and \(\) and has the same distribution as \(Z_{1}\). The following theorem gives the exact limit of \(\{\|}_{}-\|^{2} \}\) when \(Z\) is a standard normal random vector.

**Theorem 3**: _Suppose that Assumption 1 holds, \(r=N/(2p)\) is an integer, \(N>2p^{2}\), and \(Z(_{p},_{p})\). Also suppose that as \(N\), \(p\) and \(p^{3}((p))^{4}(N)/N 0\). Then as \(N\),_

\[\{\|}_{}-\|^{ 2}\}=(1+o_{P}(1))_{}^{2}}{2 (2p)N}.\]

Theorem 3 implies that when \(Z\) is a standard normal random vector, the conditional mean squared error of \(}_{}\) has convergence rate \(p^{2}/((2p)N)\). On the other hand, for sampling methods with \(n=c_{1}N/p+c_{2}p\) for constants \(c_{1},c_{2}>0\) such that the computing time may be comparable, Theorem 2 implies that the optimal convergence rate of the conditional mean squared error is \(p^{2}/N\). In this view, the convergence rate of the proposed estimator is faster than sampling methods for \(p\).

The proposed algorithm is closely related to the IBOSS algorithm. We would like to derive the asymptotic behavior of the conditional mean squared error of \(}_{}\). Theorem 6(i) of Wang et al. (2019) gives an asymptotic expression of the conditional covariance of \(}_{}\) under the assumption that \(Z\) is normally distributed. It is implied that if \(n\) and \(p\) are fixed, then as \(N\),

\[\{\|}_{}-\|^{2 }\}=(1+o_{P}(1))(( ^{-1}()^{-1})+1)^{2}}{n}.\] (5)

Now we derive the fine-grained limiting behavior of \(\{\|}_{}-\|^ {2}\}\) for varying \(n\) and \(p\). Let \(_{i,j}=_{i,j}/(_{i,i}_{j,j})^{1/2}\) denote the correlation coefficient between \(z_{i}\) and \(z_{j}\), \(i,j=1,,p\). Define

\[_{N}=,_{N}=_{N} +(1-_{N})( )^{-1}.\]

We have the following theorem.

**Theorem 4**: _Suppose Assumption 1 holds and \(Z(,)\), \(r=n/(2p)\) is an integer, there exist constants \(C_{1},C_{2},C_{3}>0\) such that \(C_{1}<_{p}()<_{1}()<C_{2}\) and \(\|\|<C_{3}\), there exists a constant \(0<<1/\) such that \(_{1 i j p}|_{i,j}|\), there exist \(_{1},_{2}(0,1)\) such that for sufficiently large \(N\), \(4r N^{_{1}}\), \(p N^{_{2}}\) and_

\[(1+2_{2})^{1/2}||+\{(_{1}+2_{2})(1-^{2})\}^{1 /2}<(1-_{1})^{1/2}.\] (6)

_Furthermore, suppose as \(N\),_

\[ 0((n))^{4}}{(n,r (N/r))} 0.\] (7)

_Then as \(N\),_

\[\{\|}_{}-\|^ {2}\}=(1+o_{P}(1))(_{N}( _{N}^{-1})+_{N}^{}_{N}^{-1}+1) {_{}^{2}}{n}.\]

**Remark 1**: _If \(n\) and \(p\) are fixed, then the condition (6) is satisfied for sufficiently large \(N\). On the other hand, if \(_{i,j}=0\) for all \(1 i<j p\), that is, the variables are independent, then the condition (6) becomes \(_{1}+_{2}<1/2\). In this case, the condition (6) holds for \(n=O(N^{})\) for some \(0<<1/2\)._

**Remark 2**: _The condition (7) is satisfied if \(r/N 0\) and \(p=O(n^{1/2-})\) for some \(>0\). Also, the condition (7) can be satisfied for arbitrary \(n\), \(p\) provided \(N\) is sufficiently large._

Compared with Theorem 6(i) in Wang et al. , our Theorem 4 gives a more comprehensive characterization of the asymptotics of \((}_{})\). If \(=_{p}\) and \(_{N} 0\), then Theorem 4 implies that

\[\{\|}_{}-\|^ {2}\}=(1+o_{P}(1))( (^{-1}()^{-1})+1)^{2}}{n}.\] (8)

If we further assume that \((r)/(N) 0\), then the expressions (5) and (8) are equivalent. However, Theorem 4 implies that the expression (8) is not valid if \(_{N}\) does not converge to \(0\).

Now we consider the special case that \(Z(_{p},_{p})\). In this case, Theorem 4 implies that if \(r/N 0\), \(n=O(N^{})\) for some \(0<<1/2\) and \(p=O(n^{1/2-^{*}})\) for some \(0<^{*}<1/2\), then \(\{\|}_{}-\|^{2} \}\) has convergence rate \((_{N}p+1)/n\). We have

\[_{N}==O().\]

Hence if \((N/n)=O(p^{2})\), then \(\{\|}_{}-\|^ {2}\}=O_{P}(p^{2}/(n(p+(N/n)))\) which matches (4). In this case, \(}_{}\) achieves the optimal rate of sampling methods given by Theorem 2, and hence the optimal rate given by Theorem 2 is tight.

Simulation results

In this section, we conduct simulations to examine the performance of the proposed estimator \(}_{}\). For comparison, the simulations also include the vanilla data averaging algorithm (abbreviated as VDA) where the full data is uniformly divided into \(k:=2p\) groups in random and the observations are averaged within groups, the least square estimator based on the uniform sampling method (abbreviated as UNI), the leverage score sampling estimator (abbreviated as LEV) as described in Ma et al. (2015), the sketched least square estimator based on the subsampled randomized Hadamard transform (abbreviated as SRHT), the estimator \(}_{}\) produced by the IBOSS algorithm, and the least square estimator based on the full data (abbreviated as FULL). The methods VDA, UNI, LEV, SRHT and IBOSS are instances of the sketching framework (2). For these three methods, we take \(n=N/p\). For SRHT, if \(N\) is a power of \(2\), then the sketching matrix \(=()^{}\), where \(\) is an \(n N\) matrix whose rows are uniformly sampled from the standard bases of \(^{N}\), \(\) is an \(N N\) Walsh-Hadamard matrix (see, e.g., Dobriban and Liu (2019) and \(\) is an \(N N\) diagonal matrix whose diagonal elements are i.i.d. Rademacher random variables; and if \(N\) is not a power of \(2\), we pad zeros to the original data to make \(N\) reach a power of \(2\). The computation of the proposed method and the IBOSS estimator rely on certain order statistics. For these two methods, the algorithm SELECT of Floyd and Rivest (1975) is used to select the order statistics. The algorithms are implemented by C++. To be fair, for all algorithms, the estimators of \(\) are solved by Gaussian elimination. The simulations are performed on a CPU with 3.30 GHz.

The statistical performance of an estimator \(}\) of \(\) is evaluated by the empirical mean squared error based on \(100\) independent replications. Specifically, the empirical mean squared error is defined as \(100^{-1}_{i=1}^{100}\|}^{(i)}-\|^{2}\), where \(}^{(i)}\) is the estimator in the \(i\)th replication. In all simulations, the ground truth of \(\) is a vector with all elements equal to \(1\). We consider two distributions of \(_{1}\): the normal distribution \(_{1}(0,1)\) and the normalized chi-squared distribution \(_{1}(^{2}(1)-1)/\). We consider the following distributions of \(Z\).

* Case 1: \(\{z_{j}\}_{j=1}^{p}\) are i.i.d. with uniform distribution \((0,1)\).
* Case 2: \(\{z_{j}\}_{j=1}^{p}\) are i.i.d. with normal distribution \((0,1)\).
* Case 3: \(\{z_{j}\}_{j=1}^{p}\) are i.i.d. with lognormal distribution, that is, \((z_{i})(0,1)\).
* Case 4: \(\{z_{j}\}_{j=1}^{p}\) are i.i.d. with student \(t\) distribution with \(3\) degrees of freedom \(t_{3}\).
* Case 5: \(Z(_{p},)\), where the diagonal elements of \(\) all equals \(1\) and the off diagonal elements all equals \(0.5\).
* Case 6: \(Z\) is distributed as a mixture of \((,)\) and \((-,)\) where \(\) has all \(1\) entries, \(\) is defined as in Case 5, and the mixing proportions of the two component distributions are both \(0.5\).

Table 2 and Tables A.1-A.3 in Supplementary Material list the empirical mean squared errors of various estimators, where the proposed method is referred to as NEW. Among the implemented methods, VDA, UNI and SRHT are data-oblivious sketching methods while NEW, LEV and IBOSS are data-aware sketching methods. It can be seen that VDA has the worst performance. This implies that the selection procedure is necessary for the proposed method. The simulation results show that UNI, SRHT, LEV have similar statistical performance. It can be seen that the proposed estimator can achieve substantial improvement over the competing sketching methods. Especially, the proposed method shows superiority when \(p\) is large.

We also evaluate the computing time for various algorithms. Table 3 lists the computing time for Case \(1\) with \(_{1}(0,1)\). Results for other settings are similar. It can be seen that the proposed method is slower than VDA and UNI. Compared with VDA and UNI, however, the proposed method has significantly better statistical performance and can achieve better data reduction. Compared with IBOSS, the proposed method has a comparable computing time but a much better statistical performance. In summary, the new estimator has good performance in both speed and statistical performance.

[MISSING_PAGE_FAIL:10]

[MISSING_PAGE_FAIL:11]