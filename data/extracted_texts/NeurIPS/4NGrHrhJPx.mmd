# The Dormant Neuron Phenomenon in Multi-Agent Reinforcement Learning Value Factorization

Haoyuan Qin\({}^{ab}\), Chennan Ma\({}^{ab}\), Mian Deng\({}^{ab}\), Zhengzhu Liu\({}^{ab}\),

**Songzhu Mei\({}^{c}\), Xinwang Liu\({}^{c}\), Cheng Wang\({}^{ab}\), Siqi Shen\({}^{ab}\)\({}^{}\)**

\({}^{a}\)Fujian Key Laboratory of Sensing and Computing for Smart Cities,

School of Informatics, Xiamen University (XMU), China

\({}^{b}\)Key Laboratory of Multimedia Trusted Perception and Efficient Computing, XMU, China

\({}^{c}\)School of Computer, National University of Defense Technology, China

{haoyuanqin,chennanma}@stu.xmu.edu.cn, {cwang,siqishen}@xmu.edu.cn,

{sz.mei,xinwangliu}@nudt.edu.cn

Equal contributionCorresponding author

###### Abstract

In this work, we study the dormant neuron phenomenon in multi-agent reinforcement learning value factorization, where the mixing network suffers from reduced network expressivity caused by an increasing number of inactive neurons. We demonstrate the presence of the dormant neuron phenomenon across multiple environments and algorithms, and show that this phenomenon negatively affects the learning process. We show that dormant neurons correlates with the existence of over-active neurons, which have large activation scores. To address the dormant neuron issue, we propose ReBorn, a simple but effective method that transfers the weights from over-active neurons to dormant neurons. We theoretically show that this method can ensure the learned action preferences are not forgotten after the weight-transferring procedure, which increases learning effectiveness. Our extensive experiments reveal that ReBorn achieves promising results across various environments and improves the performance of multiple popular value factorization approaches. The source code of ReBorn is available in https://github.com/xmu-rl-3dv/ReBorn.

## 1 Introduction

In cooperative Multi-Agent Reinforcement Learning (MARL) , a group of agents whose value function is approximated using deep neural networks must cooperate to achieve a common goal. Deep neural network is the key driving force that scales MARL for complex decision-making tasks . Recently, researchers have discovered the scaling laws that deep neural network models can increase their capacity by enlarging the size of the model and the dataset. However, single-agent reinforcement learning does not obey the scaling law and suffers from network expressivity issues [3; 4].

To alleviate the network expressivity issues in single-agent RL, researchers have proposed parameter perturbing methods. Igl et al.  periodically _resets_ some layers of the value network. ReSet  resets the last few layers of the neural network while maintaining experience in the replay buffer. ReDo  periodically re-initializes the input weights of some neurons and zero out the neuron's output weights. Albeit these methods can improve the performance of single-agent reinforcement learning, it is unclear whether they work for MARL.

Compared to single-agent RL, MARL is more challenging, including issues such as partial-observability  and the non-stationary of other learning agents' policies. The Centralized Training with Decentralized Execution (CTDE) paradigm  is widely adopted in this context. In CTDE, it is a common practice to use value factorization [2; 9], which factorizes a joint state-action value function \(Q_{tot}\) into individual agent utilities \(Q_{i}\). Each agent acts according to \(Q_{i}\), which is approximated using a deep neural network, named the _agent network_. \(Q_{i}\) are mixed through a neural network, the _mixing network_, to form joint value function \(Q_{tot}\).

In this work, we explore the reasons behind the reduction in network expressivity issues in cooperative MARL. Specifically, we study _dormant neurons_, which remain inactive with low activation levels during learning. We demonstrate that the dormant neuron phenomenon, the number of dormant neurons increases during the training process, exists in multiple popular value-based MARL algorithms (QMIX , QPLEX , DMIX , and RMIX ) across various environments (e.g., SMAC , SMACv2 , predator prey ). We find that the proportion of dormant neurons increases with the number of agents, and that dormant neurons mainly exist in the mixing network. Moreover, we identify the existence of _over-active neurons_, whose activation score accounts for a significant portion of the activation scores for all the neurons.

Typical network parameter perturbing approaches used in single-agent RL (such as Reset [5; 6] and ReDo ) do not work efficiently in MARL. Parameter perturbing methods, which change the weights of neurons, may lead to forgetting of learned knowledge, especially in MARL with high cooperation demands. The cooperation knowledge should not be forgotten even after parameter perturbation. We formulate a memorization requirement that the learned cooperative action preferences remain unchanged after parameter perturbation as the _Knowledge Invariant (KI) principle_. We theoretically show that existing approaches [5; 6; 4] cannot guarantee adherence to the KI principle. Failing to satisfy the KI principle can lead to the violation of the Individual-Global-Max (IGM) principle, which is widely adopted in MARL.

We propose, _ReBorn_, a simple but effective method that transfers the weights from over-active neurons to dormant neurons. It periodically detects dormant and over-active neurons, and balances the weights among them. We theoretically show that ReBorn satisfies the KI principle for various value factorization approaches (e.g., QMIX and QPLEX), distributional value factorization approaches (i.e., DMIX and DDN ), and risk-sensitive value factorization approach (i.e., RMIX ). Through extensive experiments, we demonstrate that ReBorn can improve the performance of multiple MARL value factorization methods, and it performs better than multiple parameter perturbing methods by effectively remembering previously learned knowledge.

## 2 Background

### Dec-POMDPs

We consider Decentralized Partially Observable Markov Decision Processes (Dec-POMDPs)  in modeling cooperative multi-agent reinforcement learning (MARL) scenarios. A Dec-POMDP can be defined by a tuple \(G=,\{_{i}\}_{i=1}^{N},P,r,\{_{i}\}_{ i=1}^{N},\{_{i}\}_{i=1}^{N},N,\), where \(\) is the set of agents, \(\) is the states set, and \(_{i}\) is the action set for agent \(i\). At time step \(t\), each agent \(i\) chooses an action \(u_{t}^{t}\), forming a joint action \(^{t}\), leading to a state transition \(s^{t+1} P(|s^{t},^{t})\) and a joint reward \(r^{t}\). In consideration of partial observability, each agent can only make decisions based on its local observation \(o_{t}^{s}^{i}(|s^{t})_{i}\). Each agent \(i\) act according to its individual policy \(_{i}(u_{t}|_{i})\) based on its local action-observation history \(_{i}=(O_{i} U_{i})^{*}\), forming a joint policy \(=<_{1},,_{N}>\). The joint policy \(\) has a joint action-value function: \(Q^{}(s_{t},_{t})=_{s_{t+1:},_{t+1:}}[R_{t} s_{t},_{t}]\), where \(R_{t}=_{i=0}^{}^{i}r_{t+i}\) is the discounted return, \(\) is the discounting factor.

### Value Function Factorization

In value factorization methods [17; 2; 9; 10; 18], per-agent utilities \(Q_{i}\) is approximated using the _agent network_, and they are mixed through the _mixer network_ to form the joint state-action value function \(Q_{tot}\). For value factorization, the Individual-Global-Max (IGM) principle  is a critical criterion that ensure the consistency between local and joint optimal action selections. It is defined as follows:

**Definition 1** (IGM ).: _For a joint state-action value function \(Q_{}:^{N}^{N}\), where \(^{N}\) is a joint action-observation history and \(\) is the joint action, if there exists individual state-action functions \([Q_{i}:_{i}_{i}]_{i=1}^{N}\), such that the following conditions are satisfied_

\[_{}Q_{}(,)=(_{u_{1}}Q_{1}( _{1},u_{1}),\ ,\ _{u_{n}}Q_{N}(_{N},u_{N})),\] (1)

_then, we can state that \([Q_{i}]_{i=1}^{N}\) satisfy IGM for \(Q_{}\) under \(\), or \(Q_{}(,)\) is factorized by \([Q_{i}(_{i},u_{i})]_{i=1}^{N}\)._

### The Dormant Neuron Phenomenon

**Definition 2** (\(-\)dormant neuron [4; 19]).: _Consider a fully connected layer \(\) within a neural network, where \(H^{}\) denotes the total number of neurons in this layer. For an input distribution \(D\), let \(h_{i}^{}(x)\) represent the activation of neuron \(i\) in layer \(\) under input \(x D\). The normalized activation score of neuron \(i\) is defined as follows:_

\[s_{i}^{}=_{x}|h_{i}^{}(x)|}{}_{k=1}^{H^{}}_{x}|h_{k}^{}(x)|}\] (2)

_Then a neuron \(i\) in layer \(\) can be defined as \(\)-dormant if its score \(s_{i}^{}\). (i.e., 0.1)_

**Definition 3** (\(-\)dormant ratio ).: _The \(\)**-dormant ratio** of a neural network \(\) can be defined as follows:_

\[_{}=_{}N_{}^{}/_{}H^{}\] (3)

\(N_{}^{}\) _is the count of neurons that are \(\)-dormant in layer \(\), \(H^{}\) is number of neurons in layer \(\)._

The **dormant neuron phenomenon** refers to the steady increase in the dormant ratio of the neural network throughout training.

## 3 Related Work

### Value Factorization

Value factorization approaches  are widely adopted in MARL. These methods construct the joint state-action value function \(Q_{tot}\) based on individual utility \(Q_{i}\). VDN  models the joint value function as the sum of individual utility function, while QMIX  models the monotonic increasing relationship among \(Q_{tot}\) and \(Q_{i}\). Qatten  models the relationship through using the attention mechanism. QPLEX  factorizes \(Q_{tot}\) into a value function and an advantage function. QTRAN  and ResQ  decompose the value function into easy-to-factorized forms. For distributional MARL, DMIX  factorizes value function through mean-shape decomposition. A few work [12; 22] explore risk-sensitive value factorization. RMIX  models the monotonic increasing relationship among \(Q_{tot}\) and the CVaR measure of each agent's distributional utility. RiskQ  ensures that the collection of greedy selection of risk-sensitive individual actions is equal to the greedy selection of risk-sensitive joint actions.

These methods focus on modeling the representation ability and functional relationships between the joint state-action value function and individual utilities. Our work, ReBorn, is orthogonal to these approaches, can be used to improve their overall performance by reducing dormant neurons.

### RL neural network expressivity

In deep reinforcement learning, neural networks tend to lose their expressive power as training progresses . Various studies explore the loss of expressiveness from different perspectives and propose corresponding methods to mitigate this issue.

Lyle et al.  show that the instability of the target can cause the network to lose expressive ability. ReSet  addresses early agent experience bias by periodically resetting the last layer of the neural network. The loss of expressive ability can also be attributed to over-fitting, a phenomenon analyzed in depth by Kirk et al.  and Zhang et al.  within reinforcement learning.

To enhance generalization, researchers propose network randomization , convolution architectures , and soft data augmentation . Researchers  find that the loss of plasticity is deeply connected to changes in the curvature of the loss landscape, and plasticity injection  is used to enhance the learning ability of neural networks for new data. D'Oro et al.  and Yang et al.  propose Reset Replay to improve the sample efficiency. ReDo  discovers that dormant neurons occur due to the instability of the target in reinforcement learning. DRM  finds that the dormant neuron phenomenon is related to agent exploration. When the dormancy ratio is high, the agent gradually cease exploration.

ReBorn is a parameter perturbing method for MARL. It can effectively reduce the number of dormant and over-active neurons. Moreover, it ensures that learned action knowledge is not forgotten after parameter perturbation.

## 4 The Dormant Neuron Phenomenon in MARL

**Dormant neurons mainly exist in the mixing network of MARL.** To verify the existence of the dormant neuron phenomenon in MARL, we analyze the number of dormant neurons during the training of QMIX  and QPLEX  across multiple tasks in SMAC . The percentage of dormant neurons are illustrated in Figure 1, presented separately for the agent and the mixing networks. We discover that the dormant neuron phenomenon _primarily occurs in the mixing network_ of MARL. The percentage of dormant neurons the mixing network is initially high and continues to increase, while the percentage of dormant neurons in agent networks is low. This observation is consistent across various algorithms and environments as it is depicted in Appendix D.4. The number of agents in the three tasks are 3, 10, and 27, respectively. As shown in Figure 1 (a) to (c), _with the increasing number of agents, the percentage of dormant neurons increases._

**Dormant neurons hurt the expressive power of mixing networks.** In MARL value factorization methods, the mixing network plays a crucial role in integrating individual utilities into a joint value function. As shown in [9; 20; 21], the expressive power of the mixing network significantly impacts the performance of MARL value factorization methods. The expressive power of neural networks is related to both their depth [33; 34] and width [35; 36; 37]. We study expressive power of mixing networks from the perspective of dormant neurons, We use a mixing network with 2 Multi-layer Perceptron (MLP) layers, and fit it to a simple value function. This network consists of 4 neurons, and

Figure 1: The existence of Dormant Neuron Phenomenon in Value Function Factorization Methods.

Figure 2: (a) The MSE Loss for fitting a simple Mixing Network increases with an increasing number of Dormant Neurons. It indicates that dormant neurons hurt mixing network expressivity. (b) The percentage of dormant neurons in QMIX mixing network with different target network update intervals. (c) The Normalized Activation Score (NAS) percentage ranking for top-25 over-active neurons in the QMIX mixing network.

we change the number of dormant neurons from 0 to 3. As depicted in Figure 2 (a), with increasing dormant neurons, the mean square error (MSE) loss that fits the target value increases. This indicates that _an increase in dormant neurons leads to reduced expressive power_. Please refer to Appendix D.3 for details.

**TD target non-stationarity exacerbates dormant neurons in MARL.** The TD target in reinforcement learning is non-stationary. In the MARL training process, target networks for mixing networks are typically used to stabilize TD targets. We study the impact of target non-stationarity by varying its update interval, where a smaller interval indicates greater non-stationarity. As analyzed in Figure 1, the dormant neuron phenomenon primarily exists in the mixing network, so we only control the target network of the mixing network, and the comparison focuses on the dormancy ratio in the mixing network. Experimental results for the QMIX method are presented in Figure 2 (b). As depicted, with a smaller update interval, the ratio of dormant neurons increases, indicating that increased non-stationarity in the target network results in a higher presence of dormant neurons in the MARL mixing network.

**The presence of over-active neurons correlate with dormant neurons.** Through careful inspection of the neurons during MARL network training, we observe an interesting phenomenon that has not been discovered before: some neurons exhibit very large normalized activation scores (NAS) throughout the training process. We study the percentage contribution of the average NAS of each neuron to the total average NAS of all neurons. To this end, we examine such percentage in the last layer (with 64 neurons) of QMIX's mixing network in 27m_vs_30m from SMAC. Figure 2 (c) depict the top 25 neurons which have the largest percentage. Neurons whose percentage is over 5% is depicted in red, neurons whose percentage are too low are not plotted, while the other neurons are plotted in green. The results show that most NAS are concentrated on a few neurons, while the NAS of other neurons are relatively low. We refer to these neurons with large NAS as over-active neurons, and define them as follows.

**Definition 4** (over-active neuron).: _A neuron \(i\) is an over-active neuron if its score \(s_{i}^{}\) (i.e., 3)._

In Figure 3 (a), the percentage contribution of the numbers of dormant neurons to all neurons, and the percentage contribution of the number of over-active neurons to all neurons, along with the percentage contribution of the sum of NAS for over-active neurons to the sum of NAS of all neurons, are depicted in red, blue and green, respectively. We find that, albeit there are only a few over-active neurons, their NAS takes up a large percentage of the neural network's NAS. This percentage increases steadily with the training process, correlating with the increase of dormant neurons. As the percentage of the over-active neurons' NAS continues to increase, the percentage of NAS for the other neurons decreases. _We conjecture that the presence of over-active neurons impacts the existence of dormant neurons._

**Dormant/Over-active neurons remain dormant/over-active**. To study the impact of over-active neurons on dormant neurons, we examine the percentage of dormant/over-active neurons that remain dormant/over-active. As depicted in Figure 3 (b), there is a significant overlap among dormant/over-active neurons. The presence of over-active neurons appears to be a significant factor contributing to the dormant neuron phenomenon, which has never been considered in previous studies. We use a parameter perturbing method  to periodically recycle the dormant neurons. Then we depict the

Figure 3: Over-active neurons in QMIX mixing networks: (a) The percentage contribution of the number of dormant neurons (depicted as Dormant), the number of over-active neurons (depicted as Overactive-Number), the sum of NAS (depicted as Overactive-Sum) for over-active neurons over time. (b) Overlap coefficients for Dormant/Over-active neurons between the current iteration and previous iterations. (c) Percentage of dormant neurons that re-enter dormancy after ReDo within different time steps.

percentage of dormant neurons that re-enter dormancy within 0.2 Million steps and 0.6 Million steps in Figure 3 (c). As it is depicted in the Figure, there is still a significant overlap among dormant neurons. This indicates that parameter perturbing methods (such as Redo ) may not work efficiently for MARL, as it does not consider over-active neurons. We conjecture that this may be due to the fact that methods developed for single-agent RL may change the neural network weights regarding agent cooperation, which lead to _forgetting learned cooperative knowledge that is encoded in neural network_.

## 5 The ReBorn Method

In this section, we describe the Knowledge Invariant Principle, which ensures that learned action preferences do not change after perturbing neurons. We show that methods failing to satisfy this principle could lead to the violation of the individual-Global-Max (IGM) principle, which is important for MARL. Then, we present the ReBorn method, which satisfies the KI principle. It balances the weights among dormant neurons and over-active neurons for the mixing network.

### Knowledge Invariant Principle

Multi-agent Reinforcement Learning suffers from the dormant neuron phenomenon and the existence of over-active neurons which make the learning process inefficient. Researchers have proposed several methods [4; 5; 6] that change the weights of neurons. However, these methods overlook the complex interactions among multi-agents, and their learned knowledge may be forgotten after perturbing neurons. We formulate the memorization requirement for learned cooperation knowledge after neuron perturbations as the _Knowledge Invariant Principle_, which is defined as follows.

**Definition 5** (Knowledge Invariant Principle (KI)).: _A joint state-action value function is represented as \(Q_{tot}^{,\,}(,)=f_{}(Q_{1}^{ }(_{1},u_{1}),...,Q_{N}^{}(_{N},u_{ N}))\), where \(f_{}\) is the mixing function that mixes \(Q_{i}\) into \(Q_{tot}\), \(\) is joint observation-action history, \(=[u_{1},...u_{N}]\) is the joint action of multi-agent, \(g:\) is a function that maps weights in \(\) to \(\), \(g()=\). \(h:\), \(h()=\), \(h\) map the weights in \(\) to \(\). If the following condition holds:_

\[Q_{tot}^{,\,}(,) Q_{tot}^{, \,}(,^{}) Q_{tot}^{ ,\,}(,) Q_{tot}^ {,\,}(,^{}), !k:u_{k} u_{k}^{}\] (4)

_then, the two functions \(g\) and \(h\) satisfy the Knowledge Invariant Principle for \(Q_{tot}^{,\,}\), where \([Q_{i}(_{i},u_{i})]_{i=1}^{N}\) is individual agent utility function, \(N\) is the number of agents, \(_{i}\) and \(u_{i}\) are the observation-action history and action of agent \(i\), respectively. \(!\) represents the concept of **unique existence**._

Given two functions \(g\) and \(h\) which satisfy the KI principle, if we use them to change the joint state-action value function \(Q_{tot}^{,\,}\) to \(Q_{tot}^{,\,}!k:u_{k} u_{k}^{}\), the learned knowledge that \(\) is preferred over \(^{}\) before applying \(g\) and \(h\) does not change after applying the two functions. With the KI principle, we show the following theorem.

**Theorem 1**.: _Parameter perturbing methods that do not satisfy the Knowledge Invariant (KI) principle cannot guarantee adherence to the Individual-Global-Max (IGM) principle._

We have theoretically shown that a parameter perturbing method that does not satisfy the KI principle could lead to the _violation of the IGM principle_, which is the most important principle in MARL value factorization methods [2; 9; 20; 10]. Furthermore, we theoretically show that two state-of-the-art RL parameter perturbing methods, Redo  and ReSet , do not satisfy the KI principle, as detailed in Theorem 2 and Theorem 3, respectively. These theorems and proofs are detailed in Appendix B.

Figure 4: The procedure of ReBorn neurons. The weights of over-active neurons are distributed to M randomly picked dormant neurons.

### ReBorn: a Weight Sharing Method among Dormant and Over-active Neurons.

To address the issues caused by the dormant neuron phenomenon and the existence of over-active neurons, which reduce network expressivity, we propose ReBorn, a simple but effective method that shares the weights from over-active neurons with dormant neurons.

ReBorn uses an identity function \(h()=\) to map the parameters of agent networks to themselves, and uses function \(g()\) to perturb the parameters \(\) of mixing networks. The process of \(g()\) is described as follows. For each over-active neuron \(x\), we randomly select \(M\) dormant neurons that belong to the same layer as \(x\). Here, \(M\) is an random integer between 2 to 5. The selected dormant neurons, indexed by \(i\), will share weights with neuron \(x\). After weight sharing, these neurons will not be selected again. We denote \(_{x}^{in}\) as the input weights for neuron \(x\), \(b_{x}\) as the bias of neuron \(x\), \(_{x}^{out}\) as the output weights. The main procedure of the ReBorn method is depicted in Figure 4.

The input weights of dormant neurons \(_{i}^{in}\) are reborn as \(_{i}_{x}^{in}\), and the input weight of the over-active neuron \(x\) becomes \(_{0}w_{x}^{in}\). The output weights for neuron \(x\) and \(i\) are reborn as \(}_{0}w_{x}^{out}\) and \(}_{i}w_{x}^{out}\). The biases for the over-active and dormant neurons are set to \(_{0}b_{x},\ _{i}b_{x}\). \([_{i}]_{i=0}^{M}\) are sampled between 0.5 and 1.5. They are used to ensure more variation among neurons. \([_{i}]_{i=0}^{M}\) is obtained through sampling \(M+1\) from a normal distribution, and then a Softmax operator is performed on them to ensure \(_{i=0}^{M}_{i}=1\). For dormant neurons that are not selected, we use Xavier initialization to reset their weights.

Although ReBorn is simple, we have theoretically demonstrated that it satisfies the KI principle for QMIX through the following theorem.

**Theorem 2**.: _ReBorn satisfies the KI principle for the QMIX  value factorization method._

Moreover, we have theoretically shown that ReBorn satisfies the KI principle for a value factorization method: QPLEX in Theorem 4, a distributional value factorization method DMIX in Theorem 5, and a risk-sensitive value factorization method RMIX in Theorem 6. Furthermore, we show that after using ReBorn, the value functions \(Q_{tot}\) learned by QMIX, QPLEX, DMIX, and RMIX still satisfy the IGM principle in Corollary 1 to 4. These theorems and proofs are listed in **Appendix B**.

## 6 Empirical Evaluations

In this section, we present experimental results and discuss their implications. We begin with a brief overview of our experimental setup in Section 6.1. Subsequently, we examine ReBorn's robust applicability to various MARL value factorization algorithms in Section 6.2. Furthermore, we demonstrate that ReBorn outperforms other parameter perturbing methods that are extended to MARL in Section 6.3. Lastly, we conduct a series of ablation studies in Section 6.4. All detailed experimental results can be found in Appendix D.4.

### Environmental Setup

**Environments.** In our experiments, we employ three distinct environments that challenge the coordination and adaptability of MARL algorithms. **Predator-prey** simulates a grid world where multiple predators collaborate to capture preys dispersed throughout the map. A successful capture requires at least 2 predators to execute the _capture_ action simultaneously, posing a great challenge for the algorithm's coordination ability. **The StarCraft Multi-Agent Challenge (SMAC) ** is a popular benchmark used extensively in MARL, where multiple ally units controlled by MARL algorithms aim to defeat enemy units controlled by the game's built-in AI. **SMACv2 ** features units that are randomly generated and positioned, enhancing stochasticity and significantly increasing the complexity of the scenarios. Please refer to Appendix D.2 for detailed descriptions.

**Baselines and training.** ReBorn, as a parameter perturbation mechanism, is applicable to various value factorization algorithms. We select 4 classical algorithms with different types: QMIX, QPLEX, DMIX and RMIX. ReDo, ReSet, SR  and MARR  four common parameter perturbation methods in deep RL, are adapted to MARL variants to serve as baselines. Detailed implementations and parameter configurations for each algorithm are available in Appendix D.1.

### ReBorn can improve the performance of various value factorization algorithms

In this section, we investigate the applicability of ReBorn through validating ReBorn's ability to enhance performance across various value factorization algorithms (QMIX, QPLEX, RMIX) in different experimental scenarios (3s5z_vs_3s6z, MMM2, predator-prey small). According to the experimental results presented in Figures 5, ReBorn can improve the performance of multiple algorithms and effectively reduce the dormant ratio of the mixing networks in diverse settings. More detailed experimental results can be found in Appendix D.4.1 and Appendix D.4.5.

### ReBorn is superior to other RL parameter perturbing methods

We explore the superiority of ReBorn by applying different parameter perturbing methods to QMIX across various experimental scenarios (MMM2, 27m_vs_30m, predator-prey large). We added ReDo, Reset, SR and MARR for comparison and further analyzed the dormant ratios and the over-active sum ratios. ReDo and ReSet are common parameter perturbation methods in deep RL, while SR and MARR are reset replay methods. All of them are adapted to MARL variants to serve as baselines.

The results depicted in Figure 6 illustrate the win rates, the dormant ratios and the over-active sum ratios (the ratio of the sum of normalized activation scores of over-active neurons to the total sum of scores of all neurons) across different scenarios. The results indicate that compared to ReDo and ReSet, ReBorn can further enhance algorithm's performance and more effectively reduce both the dormant and over-active sum ratios of the mixing network. Please refer to Appendix D.4.4 for more experimental results.

### Ablation Study and Discussion

#### 6.4.1 Satisfying the KI Principle is of great importance

In this section, we demonstrate the importance of adhering to the Knowledge Invariance (KI) principle. Our analysis in Appendix B shows that applying ReBorn only to the mixing network adheres to the KI principle, while using it on the entire network results in a violation. We compared the performance of value factorization algorithms under the MMM2 scenario in SMAC, focusing on those that either adhere to or violate the KI principle. As illustrated in Figure 7, maintaining KI with ReBorn enhances the performance across all baseline algorithms, whereas violating it leads to performance drop in QMIX and QPLEX, highlighting the great importance of satisfying the KI principle.

Figure 5: ReBorn can improve the performance of various value factorization algorithms: (a-b) the test win rate for the 3s5z_vs_3s6z and the MMM2 environments, (c) the return for predator-prey small environment, (d-f) the dormant percent for the the 3s5z_vs_3s6z, the MMM2, and the predator-prey small environment.

#### 6.4.2 ReBorn is better than other methods that satisfy the KI principle

In this section, we explore various forms of the weight perturbation function \(g()\) in ReBorn based on QMIX, while keeping the function \(h()=\) constant. In ReBorn, \(g()\) transfers weights from over-active neurons to dormant neurons. In ReBorn (ReDo), \(g()\) periodically re-initializes the weights of dormant neurons. In ReBorn (ReSet), \(g()\) periodically resets the parameters of the last layer of the neural network. In ReBorn (Reverse ReDo), \(g()\) periodically resets the input and output weights of over-active neurons. In ReBorn (Pruning), \(g()\) periodically prunes dormant neurons. To ensure the accuracy of our conclusions, we conduct experiments across various value factorization algorithms. The experimental results shown in Figure 8 demonstrate that compared with other methods, ReBorn significantly enhance the performance of value factorization algorithms.

Figure 6: Comparison with other Parameter Perturbing Methods: (a-c) The test win rate, the dormant percentage and the percentage of the sum of normalized activation score (NAS) for the MMM2 environment. (d-f) The test win rate, the dormant percentage, and the percentage of the sum of NAS for the 27m_vs_30m environment. (g-i) The return, the dormant percentage, and the percentage of the sum of NAS for the predator-prey large environment.

Figure 7: Importance of satisfying the KI Principle for (a) QMIX, (b) QPLEX, and (C) RMIX. A variant of ReBorn without satisfying the KI Principle is depicted as Reborn w/o KI.

#### 6.4.3 Sensitivity analyses of hyper-parameters

The ablation study in Figure 9 illustrates the impact of different hyperparameter settings in QMIX-ReBorn, focusing on the ablation of the dormant threshold \(\), the over-active threshold \(\), and the ReBorn interval \(T\). The default configuration of QMIX-ReBorn is \(=0.1\), \(=3\), and \(T=0.2M\). We modify each hyperparameter individually, and the experimental results indicate that appropriate hyperparameters help to better balance network activation, thereby enhancing overall performance.

## 7 Conclusion

In this work, we identify the dormant neuron phenomenon in Multi-Agent Reinforcement Learning (MARL) Value Factorization. Such a phenomenon mainly exists in the mixing network, which hurts its expressive ability. We discover the existence of over-active neurons, which correlate with dormant neurons. Existing parameter perturbing methods do not work efficiently for the dormant neurons in MARL, due to the ignorance of over-active neurons and the forgotten of learned knowledge. We formulate the memorization requirement for learning agents' cooperation knowledge as the Knowledge Invariant (KI) principle. In this work, we propose ReBorn, which is a simple but effective parameter perturbing method. We show that it satisfies the KI principle and can improve the performance of multiple value factorization methods better than other parameter perturbing methods.

AcknowledgementThis work was partially supported by the Fundamental Research Funds for the Central Universities (No. 20720230033), by PDL (2022-PDL-12). We would like thank the anonymous reviewers for their valuable suggestions.

Figure 8: Comparison with other methods that satisfy the KI principle for (a) QMIX, (b) QPLEX, and (C) RMIX.

Figure 9: Ablation of different hyperparameters in ReBorn. (a) the dormant threshold \(\). (b) the over-active threshold \(\). (c) the ReBorn interval \(T\).