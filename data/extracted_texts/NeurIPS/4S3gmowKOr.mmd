# Explaining Drug Repositioning: A Case-Based Reasoning Graph Neural Network Approach

Carolina Gonzalez-Cavazos,1

The Scripps Research Institute

La Jolla, CA, 92037

agonzalez@scripps.edu

&Roger Tu,

The Scripps Research Institute

La Jolla, CA, 92037

rogertu@scripps.edu

&Meghamala Sinha,

The Scripps Research Institute

La Jolla, CA, 92037

msinha@scripps.edu

&Andrew I. Su

The Scripps Research Institute

La Jolla, CA, 92037

asu@scripps.edu

###### Abstract

Drug repositioning, the identification of novel uses of existing therapies, has become an attractive strategy to accelerate drug development. Knowledge graphs (KGs) have emerged as a powerful representation of interconnected data within the biomedical domain. While link prediction on biomedical can ascertain new connections between drugs and diseases, most approaches only state _whether_ two nodes are related. Yet, they fail to explain _why_ two nodes are related. In this project, we introduce an implementation of the semi-parametric Case-Based Reasoning over subgraphs (CBR-SUBG), designed to derive a drug query's underlying mechanisms by gathering graph patterns of similar nodes. We show that our adaptation outperforms existing KG link prediction models on a drug repositioning task. Furthermore, our findings demonstrate that CBR-SUBG strategy can provide interpretable biological paths as evidence supporting putative repositioning candidates, leading to more informed decisions.

## 1 Introduction

Traditional drug discovery and development is a time-consuming and resource-intensive process . Repositioning existing drugs for new therapeutic uses has emerged as a strategy aimed at reducing drug development costs by decreasing failure rates and time to market.

Over recent years, there has been an increasing interest in utilizing biomedical knowledge graphs (KGs) for drug repositioning . Briefly, biomedical KGs consist of nodes representing biological concepts (such as genes, drugs, diseases, and pathways) and edges describing their relationship (such as drugs treating diseases, or diseases associated with genes) .

A growing number of drug repositioning link prediction approaches on biomedical KGs have emerged to predict connections of drugs to candidate diseases . However, these methods focus on mapping nodes and relations to vector representations via translational distance models, matrix factorization, or neural network models. Then, a scoring function is defined to measure the correctness of a triple in the embedding space. While these projects have been successful predicting novel indication candidates, the limitation of all these methods is that they neither consider nor explain the biological mechanism of drugs and their relationship with a disease.

As a solution, we explore Case-Based Reasoning (CBR) -- an artificial intelligence approach that learns from past experiences to solve new problems . At a high level, the CBR system comprises the following main steps: **retrieve** cases that are similar to the given problem, **reuse** solutions of similar cases for the problem in hand, and **revise** if the solutions are appropriate for solving the given problem .

In this paper we introduce a novel semi-parametric adaptation of CBR strategy over subgraphs (CBR-SUBG) focused on drug repositioning. Previously, Das et al.  demonstrated the utility and effectiveness of this semi-parametric approach for natural language queries . Here, we leverage reasoning paths from similar drugs to identify potential repositioning candidates for a given drug of interest. Our framework utilizes a Graph Neural Network (GNN) trained on a queried drug's CBR extracted subgraph patterns. As the reasoning patterns of similar drug cases (solutions) reoccur within the subgraph of a drug query of interest, a disease answer node can be found analogously located within the subgraph.

Our CBR-SUBG implementation, not only outperforms sophisticated GNN-based models but also enables interpretable biological mechanisms identification to support a given drug's repositioning. Moreover, we present a case study on azlaire and Parkinson's disease, demonstrating the potential of CBR-SUBG for drug repositioning and its effectiveness in uncovering intermediate biological nodes that explain novel drug-disease associations.

## 2 Related work

**Case-based reasoning models** A simple non-parametric CBR approach for KG completion was proposed by Das et al. [16; 17]. Simple CBR finds reasoning chains for a query of interest by retrieving similar cases. However, it only handles symbolic matching to find similarities between a query and similar cases. More recently, Das et al. proposed a CBR-SUBG model that uses soft-matching to compare representations of answer queries and similar answer cases [14; 15]. Our CBR-SUBG implementation for drug repositioning task takes advantage of derived reasoning patterns from similar answer cases to explain putative drug reasoning candidates.

**Graph Neural Networks** In knowledge graph completion frameworks, different GNN architectures, including relational-GCN (R-GCN) , and composition-based multi-relational GCN (CompGCN) , serve as encoders of the entire immediate neighborhood of each node, along with a scoring

Figure 1: Explaining CBR-SUBG workflow for drug repositioning. Given a query (azlaire, _indication_,?), (1) CBR-SUBG first **retrieves**\(k\)-NN similar drug nodes (astemizole, sulindac) to the input query and gathers their reasoning paths that lead to the corresponding disease they treat. (2) Next, these paths are **reused** to address the query of interest. (3) Finally, all gathered nodes by reasoning chains are **revised**. The disease answer node (star) is the node within the query subgraph that exhibits the highest similarity to the disease answer nodes of the \(k\)-NN nodes. Note that the reused paths required to answer the query repeat over similar drugs (highlighted in green), and the reasoning chains not obtained from similar drugs (highlighted in red) lead to incorrect answers.

function such as DistMult , and ConvE . While CBR-SUBG is not dependent on any specific Message Passing Neural Networks (MPNN) scheme, in contrast to other frameworks, a model like CBR-SUBG generates tailored subgraphs, enabling the collection of relevant chains for a query.

## 3 Methods

**Notation** A KG is a directed labeled multi-graph \(G=(,)\), defined by a set of nodes \(()\) and a set of edges \(()\). A KG is a collection of facts represented as triplets of the form \((e_{1},r,e_{2})\) where \(e_{1},e_{2}\)\(\)\(\) and \(r\)\(\)\(\). A path (\(p\)) in a KG is defined as a sequence of alternating nodes and edges connecting a starting node and an ending node. Formally, a path is represented as \(p\) = \((e_{1},r_{1},e_{2},...r_{n},e_{n+1})\).

**Task Description** We formulate drug repositioning as a series of query answering on a biomedical KG. As described, in CBR a new problem is solved based on similar previously observed cases. In our setting, we define a query problem (\(q\)) as \((e_{1},r_{1},?)\) (e.g. Azlaire, _indication_, \(?\)), where \(e_{1}\) denotes a particular drug entity and \(r_{1}\) the missing relation _"indication_" that links to a disease node. Here we define a case (\(c\)) as an observed indication \((e_{1},r,e_{2})\) in the KG along with a set of biological reasoning paths (\(p\)) that connect a drug \(e_{1}\) to the corresponding disease \(e_{2}\) it treats.

**Method overview** As depicted in **Figure 1**, given a drug query input \((q)\), CBR-SUBG first retrieves \(k\)-nearest neighbor drug cases (\(k\)-NN\({}_{q}\)). For each retrieved case \(c\), a collection of reasoning chains \(p\) leading to its corresponding disease answers were collected. Next, paths retrieved were reused on the input query to form a subgraph where a GNN encodes the underlying subgraph structure into a node representation . Lastly, CBR-SUBG reasons across the drug query and retrieved \(k\)-NN\({}_{q}\) drug's subgraphs to identify the correct query answer.

### Model Description

In this section we describe CBR-SUBG's composition and its implementation for drug repositioning task following three main steps of CBR framework; retrieving similar cases, reusing solutions, and revising results.

**1- Retrieve Similar Drug Cases** Given the input drug query \(q\), CBR-SUBG first retrieves \(k\)-NN\({}_{q}\) similar drug cases \(c\) using a pre-computed similarity matrix \(S^{}\) that stores the similarity score between all pairs of nodes. To model this, each drug entity is parameterized in an \(m\)-hot vector \(e^{}\), with dimensions equal to the number of relation types on the KG. An entry in the vector is set to 1 if a drug entity has at least one edge with that relation type, otherwise is set to 0. The similarity score between two drug queries is given by the cosine similarity between their normalized vector representations. Naturally, two drug nodes that capture the same relation types should have a high similarity score. For each retrieved drug case, CBR-SUBG gathers the paths in the graph that connect the drug entity to the corresponding disease it treats. Note that since the number of collected paths between two nodes can grow exponentially, we only considered 1000 randomly sampled paths of length up to three around each drug.

**2- Reuse Drug Solutions** Next, the gathered reasoning paths of retrieved similar drug cases are reused for the query of interest. Beginning with the drug query node, the sequence of relation types (path types) is applied. An example is depicted in Figure 1 where astemizole is retrieved as one of the \(k\)-NN\({}_{q}\) similar drugs to our query, alarine. The recovered path: (astemizole, _affects_, HRH4, _part of_, histamine receptor, _associated_, rhinitis), is reused by gathering the sequence of relation types such as: _affects_ (drug, gene) \(\)_affects_ (gene, pathway) \(\)_associated_ (pathway, disease). After iterating over all similar retrieved cases, the collected chains form a subgraph for the drug query.

**3- Revise Disease Predictions** Once the subgraphs for the drug query and the corresponding \(k\)-NN\({}_{q}\) similar drugs are defined, CBR-SUBG reasons across them. For this, drug representations are encoded with a GNN to incorporate its respective local subgraph structure. Finally, the most similar disease node in the query subgraph to the answers in the \(k\)-NN\({}_{q}\) subgraph drugs is retrieved as the answer.

**Encoding node representations** Considering that biomedical KGs are heterogeneous graphs with labeled edges, we employed the multi-relational R-GCN model . We followed the general MPNN scheme that iteratively updates the representation of each node by aggregating the representation of its neighbors . In particular the \(l^{th}\) layer of GNN is given by,\[a_{e}^{l} =^{l}(h_{s}^{l-1}s(e),h_{e}^{l-1}) (1)\] \[h_{e}^{l} =^{l}(h_{e}^{l-1}a_{e}^{l})(2)\]

where, \(a_{e}^{l}\) is the aggregated message form the neighbors, \(h_{e}^{l}\) denotes the representation of node \(e\) in the \(l^{th}\) layer, and \((e)\) denotes the set of immediate neighbors of node \(e\). For multi-relational R-GCN model, these steps are defined as:

\[a_{e}^{l} =_{r=1}^{}_{e_{r}(e)}W_{r}^{l}h_ {e}^{l-1}(3)\] \[h_{e}^{l} =(W_{self}^{l}h_{e}^{l-1}+a_{e}^{l})(4)\]

where, \(\) is the total number of relation types captured in the KG, \(_{r}(e)\) denotes the immediate outgoing neighbors of node \(e\) under relation \(r\); \(W_{r}^{l}\) is the transformation matrix used to propagate the message in the \(l^{th}\) layer for relation \(r\).

**Training** During training, the disease answer node (\(d_{i}\)) of the query subgraph (\(G_{i}\)) and the disease answer node (\(d_{j}\)) of the \(k\)-NN\({}_{q}\) subgraphs (\(G_{j}\)) are trained to be more similar to each other in comparison to incorrect disease answer nodes. This similarity is calculated as the cosine similarity between the normalized disease answer representations. Considering that retrieved similar drug case could arrive at a set of answers (\(D_{j}\)), we calculate the mean of the scores between \(d_{i}\) and all answer nodes in \(G_{j}\) as \((d_{i}\), \(D_{j})\)\(=\)\(|}_{d_{j} D_{j}}(d_{i}^{}&d_{j} / d_{i} d_{j})\). Then, the similarity mean score of all retrieved similar drug cases is aggregated for the given drug query. The loss function used is an extension of the normalized temperature-scaled cross entropy loss used in Chen et al.  and introduced by Das et al. :

\[L=-log D_{i}}exp(_{q_{j} kNN_{q_{i}}}sim(d_{i},D_{j })/)}{_{x_{i}(G_{i})}exp(_{q_{j} kNN_{q_{ i}}}sim(x_{i},D_{j})/)}(5)\]

where, \(D_{i}\) represents the set of all answer nodes in \(G_{i}\), while \(D_{j}\) denotes the set of all answer nodes of retrieved similar \(k\)-NN\({}_{q}\) drug cases, \(x_{i} G_{i}\) represents all nodes in the subgraph of drug query and \(\) denotes the temperature hyperparameter. This way, the loss score the disease answer nodes in \(D_{i}\) higher than all other nodes in \(G_{i}\) with respect to the answer nodes in \(k\)-NN\({}_{q}\) drug subgraph.

**Reasoning** Message-passing is run across both the drug query subgraph and the subgraphs of retrieved \(k\)-NN\({}_{q}\) drugs, resulting in the generation of node representations. A ranking of similarity scores is returned, where the highest score node in the query subgraph with respect to all answer nodes in the retrieved drug subgraphs is returned as a more likely repositioning answer. For this,

\[ans=argmax_{d_{i} D_{i}}exp(_{q_{j} kNN_{q_{i}}}sim(d_{i},D_{j }))(6)\]

## 4 Experimental setup

**Dataset Details** In this section, we conduct experiments on Mechanistic Repositioning Network with Indications (MIND), a biomedical knowledge graph that integrates two biomedical resources: Mechanistic Repositioning Network (MechRepoNet) and DrugCentral . Briefly, MechRepoNet is a comprehensive biomedical knowledge graph that was constructed by integrating 18 different data sources, consisting of of 9,652,116 edges, 250,035 nodes, 9 node types and 22 relations . DrugCentral, is a publicly available online resource that incorporates information from indications that have received approval from regulatory agencies . Here, we divided MIND into subsets: train (80%, 2087 indications), and test (20%, 390 indications).

**Hyperparameter optimisation** For CBR-SUBG model, we optimized hyperparameters using Optuna software . Next, our model was trained and tested on datasets mentioned above. We used one GCN layer with 64 dimensions and a dropout of 0.7965, where edges are randomly dropped from the graph while aggregating information from the neighborhood. For training and evaluation we used 5 and 10 nearest neighbors, respectively. We optimized the loss using Adam Optimizer. The learning rate is set to be 0.01 with a temperature value of 0.1053.

**Evaluation** We compared CBR-SUBG with various state-of the art models using standard ranking metrics: Hits@_N_ metric, which assesses the accuracy of identifying the correct disease answer within the top \(N\) predictions, and mean reciprocal rank (MRR), the average of the reciprocal of the positional rank for all correct disease answers.

## 5 Results

### Performance Comparison

In this section, we evaluate the performance of CBR-SUBG and other KG completion state-of-the-art models on the MIND dataset to identify drug repositioning candidates. In particular, we compare to other GNN-based link prediction models such as R-GCN , and CompGCN , as well as the non-parametric CBR model  that gathers reasoning chains to find an answer. Evaluation of GNN-based models was conducted using ConvE  and DistMult  as scoring functions. As demonstrated in **Table 1**, our implementation of CBR-SUBG significantly outperforms all the baselines in all metrics. We further discuss the results in section 6.

### Propranolol Case Study

Propranolol was first approved by FDA as a beta-blocker to manage heart-related issues, such as hypertension . Since beta blockers were known to relax the cardiac muscle and block nerve impulses to the muscle, it was later approved for essential tremor . Therefore, we investigated if CBR-SUBG could have predicted this repositioning within MIND (**Figure 2**). While hypertension was predicted in the first position, Parkinson's disease was the second prediction. Notably, one of the primary symptoms of Parkinson's disease is tremor, aligning with propranolol's repositioning potential .

  Model & MRR & Hits@1 & Hits@3 & Hits@5 & Hits@10 \\  RGCN + DistMult & 0.1157 & 0.0180 & 0.1084 & 0.2108 & 0.3494 \\ RGCN + ConvE & 0.1197 & 0.0240 & 0.1144 & 0.1867 & 0.3614 \\ CompGCN + DistMult & 0.27735 & 0.1954 & 0.30651 & 0.36398 & 0.44828 \\ CompGCN + ConvE & 0.36112 & 0.25287 & 0.41762 & 0.47126 & 0.55556 \\ Non-parametric CBR & 0.03269 & 0.0158 & 0.0317 & 0.0396 & 0.0634 \\  CBR-SUBG & **0.3770** & **0.2796** & **0.4329** & **0.4789** & **0.5708** \\  

Table 1: Inference performance results on MIND

Figure 2: Propranolol case study. a) PCA visualization of propranolol disease predictions. The red dot depicts the mean representation of answer nodes derived from \(k\)-NN similar drugs. Color scale illustrates repositioning ranking. Expected true answer (star) and top two predictions are displayed. Note that prediction 500 is shown as scale reference. b) Evidence supporting propranolol prediction for true answer (star) and top two repositioning answers.

Considering the CBR hypothesis, where the representation of answer nodes of drug query \(q\) and retrieved \(k\)-NN\({}_{q}\) drug subgraphs should be similar as the local structure around them share similarities. A PCA visualization of propranolol predictions shows that answer nodes within retrieved \(k\)-NN\({}_{q}\) drug query subgraphs cluster together alongside the top repositioning answers (**Figure 2a**). As illustrated, as the node representation similarity of disease predictions gets apart w.r.t \(k\)-NN\({}_{q}\) answers, the ranking of them decreases.

Illustrated in **Figure 2b**, CBR-SUBG model is able to provide interpretable chains for propranolol indication predictions. These reasoning paths enable the identification of shared biological targets among repositioning answers, ultimately enhancing the quality of decision-making with more comprehensive insights. As illustrated, propranolol binds to beta-2 receptor , member of GCPR family, playing an important role in regulating heart rate . Furthermore, beta-2 receptor is associated with an increased risk of developing Parkinson . Moreover, we detected that propranolol targets interleukin-6  regulating phosphorylation of transcription factor STAT1. This modulation is documented to take part in the pathogenesis of various cardiac insults  and reported to mediate thyroid morphology and function .

## 6 Conclusion

Our work presents a novel adaptation of the CBR paradigm for drug repositioning tasks. While graph computational drug repositioning approaches continue evolving, the interpretable explanation of predictions made continues mostly unsolved. Here, we demonstrated that reasoning chains provided by our implementation of CBR-SUBG approach can provide important domain insights to better assess whether novel drug-disease candidates are plausible.

From the results, we demonstrated CBR-SUBG outperforms various GNN-based and non-parametric CBR models on drug repositioning tasks. While the non-parametric CBR model has the ability to provide reasoning chains that explain drug-disease predictions, it is limited by the exact symbolic matching done to find an answer. Next, compared to GNN-based models, CBR-SUBG only considers important features that are reused from similar solutions. As described, this is done by leveraging the graph structure patterns from similar drug nodes and reasoning over a subgraph query. In other words, instead of considering all the neighbor nodes around a given query during message-passing scheme, CBR-SUBG only considers relevant features to make an inference.