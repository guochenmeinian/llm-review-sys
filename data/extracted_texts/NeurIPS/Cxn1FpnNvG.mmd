# Neural Circuits for Fast Poisson Compressed Sensing

in the Olfactory Bulb

 Jacob A. Zavatone-Veth\({}^{1,2}\), Paul Masset\({}^{1,3}\), William L. Tong\({}^{1,4,5}\), Joseph D. Zak\({}^{6}\),

**Venkatesh N. Murthy\({}^{1,3}\), Cengiz Pehlevan\({}^{1,4,5}\)**

\({}^{1}\)Center for Brain Science, \({}^{2}\)Department of Physics,

\({}^{3}\)Department of Molecular and Cellular Biology,

\({}^{4}\)John A. Paulson School of Engineering and Applied Sciences,

\({}^{5}\)Kempner Institute for the Study of Natural and Artificial Intelligence,

Harvard University

Cambridge, MA 02138

\({}^{6}\)Department of Biological Sciences,

University of Illinois at Chicago

Chicago, IL 60607

jzavatoneveth@g.harvard.edu, paul_masset@fas.harvard.edu,

vnmurthy@fas.harvard.edu, cpehlevan@seas.harvard.edu

JaZ-V and PM contributed equally to this work.VNM and CP jointly supervised this work.

###### Abstract

Within a single sniff, the mammalian olfactory system can decode the identity and concentration of odorants wafted on turbulent plumes of air. Yet, it must do so given access only to the noisy, dimensionally-reduced representation of the odor world provided by olfactory receptor neurons. As a result, the olfactory system must solve a compressed sensing problem, relying on the fact that only a handful of the millions of possible odorants are present in a given scene. Inspired by this principle, past works have proposed normative compressed sensing models for olfactory decoding. However, these models have not captured the unique anatomy and physiology of the olfactory bulb, nor have they shown that sensing can be achieved within the 100-millisecond timescale of a single sniff. Here, we propose a rate-based Poisson compressed sensing circuit model for the olfactory bulb. This model maps onto the neuron classes of the olfactory bulb, and recapitulates salient features of their connectivity and physiology. For circuit sizes comparable to the human olfactory bulb, we show that this model can accurately detect tens of odors within the timescale of a single sniff. We also show that this model can perform Bayesian posterior sampling for accurate uncertainty estimation. Fast inference is possible only if the geometry of the neural code is chosen to match receptor properties, yielding a distributed neural code that is not axis-aligned to individual odor identities. Our results illustrate how normative modeling can help us map function onto specific neural circuits to generate new hypotheses.

## 1 Introduction

Sensory systems allow organisms to detect physical signals in their environments, enabling them to maximize fitness by acting adaptively. This experience of the physical environment, also known as the _Umwelt_, depends on the sensors and sensory organs of each organism . Throughout evolution, organisms have developed specialized sensory mechanisms to extract specific information about thephysical world. In vision and audition--the most studied sensory modalities in neuroscience--stimuli are characterized by intuitive metrics such as orientation or frequency, which have been shown to map onto neural representations from the earliest stages of the sensory systems [3; 4; 5]. One can continuously vary the orientation of an object or the pitch of a tone and quantify resulting changes in perception and neural representations. From a computational point of view, this structure in the representations can be viewed as optimizing the information transfer in the network [6; 7; 8; 9; 10; 11; 12; 13; 14; 15; 16].

In contrast, the geometric structure of the olfactory world is far less clear: How can one 'rotate' a smell? Despite significant effort, attempts to find such structure in olfactory stimuli and link that geometry to maps in olfactory areas have succeeded only in identifying coarse principles for high-level organization, far from the precision of orientation columns or tonotopy in visual and auditory cortices [17; 18; 19]. In the absence of geometric intuitions, the principles of compressed sensing (CS) have emerged as an alternative paradigm for understanding olfactory coding [20; 21; 22; 23; 24; 25; 26; 27]. This framework provides a partial answer to the question of how an organism could identify which of millions of possible odorants are present given the activity of only a few hundred receptor types [28; 29; 30; 31; 32; 33]. However, existing CS circuit models do not admit convincing biologically-plausible implementations that can perform fast inference at scale. Indeed, many proposals assume that the presence of each odorant is represented by a single, specialized neuron, which is inconsistent with the distributed odor coding observed _in vivo_[34; 35; 22; 36]. This axis-aligned coding does not leverage the geometric structure of the sensory space, which can be defined even in the absence of interpretable dimensions [37; 38; 39; 40; 41].

In this paper, we propose a Poisson CS model for the mammalian olfactory bulb. Our primary contributions are as follows:

* We derive a normative CS circuit model which can be mapped onto the circuits of the bulb (SS3). Importantly, this mapping goes beyond basic counting of cell types; it includes detailed biological features like symmetric coupling and state-dependent inhibition (SS4).
* We show that this model enables fast, accurate inference of odor identity in a biologically reasonable regime where tens of odorants are present in a given scene (SS5). This fast inference is enabled by considering the geometry of the olfactory receptor code. This consideration leads to distributed odor coding, resolving a major tension between previous CS circuit models and neural data.
* We extend our circuit model to allow Bayesian inference of uncertainty in odor concentrations (SS6).

In total, our results demonstrate the importance of considering representational geometry when trying to understand neural coding in the olfactory bulb (OB). Importantly, we show that it is the geometry in the space defined by the receptor affinity (or OSN activation) that controls the speed of inference. This view is distinct from previous geometric theories of olfaction, which have focused on the space of odorants [42; 43]. We propose that thinking in terms of the geometry of OSN coding will allow for deeper understanding of early olfactory processing.

## 2 Related work and review of the olfactory sensing problem

We begin with a review of the principles of olfactory coding, and of previous CS models for olfactory circuits. The structural logic of early olfactory processing is broadly conserved across the animal kingdom (Fig. 1A) [44; 45; 46; 47], and this distinctive circuit structure is thought to play a key role in the computational function of the olfactory bulb [48; 49; 50]. In mammals, volatile odorants are first detected by olfactory receptor (ORs) proteins expressed on the surface of olfactory sensory neurons (OSNs). Each OSN expresses only a single OR type; in humans there are around 300 distinct ORs, in mice around 1000 . Importantly, most ORs have broad affinity profiles, and the OSN code for odor identity is combinatorial . In contrast to the immune system's highly adaptable chemical recognition capabilities arising from somatic recombination , ORs are hard coded into the genome as single genes , and therefore can only change over evolutionary timescales [54; 55]. Some adaptation of expression levels across the receptors is possible , but the chemical affinity of the receptor array is fixed. OSNs expressing the same OR then converge onto the same glomerulus, synapsing onto the principal projection cells of the olfactory bulb (OB), the mitral and tufted cells. These in turn send signals to olfactory cortical areas. The OB contains several types of inhibitory interneurons, whose computational role remains to be clarified . Importantly, the excitatory mitral and tufted cells are not reciprocally connected across glomeruli. Instead, they are connected through a network of inhibitory granule cells, the most numerous cell type in the OB .

In our model, we will focus on a particular task: odor component identification within a single sniff [58; 59]. This computational problem differs from many experimental tasks focusing on discrimination between two odorants , which underlie most scientific work on rodent olfactory decision making [61; 62; 60]. Here, the goal is to identify the components of a complex olfactory scene [63; 64; 65; 66]. Importantly, the limits of human performance in this setting remain to our knowledge unknown [67; 68]. To render the problem more tractable, we will make a number of simplifications of the anatomy and physiology of the OB. We will not distinguish between mitral and tufted cells, the two classes of projection neurons. Recent works have shed some light on the distinct computational roles of these cell types; these distinctions are likely to become important when considering richer environmental dynamics than we do here [69; 70]. We will also ignore the fact that odorant concentrations can vary over many orders of magnitude, and OSN responses to large changes in concentration are strongly nonlinear. Here, we will focus on concentration changes of one or two orders of magnitude. Within such ranges, the responses of OB neurons are well characterized by linear models .

On the theoretical side, it is widely recognized that the tremendous compression of dimensionality inherent in the transformation from odorant molecules to receptor activity means that the olfactory decoding problem is analogous to the one faced in compressed sensing (CS) [72; 73; 74; 21; 22; 23; 24; 25; 26; 27; 28; 29; 30; 31; 32; 33]. Classical CS theory shows that sparse high-dimensional signals can be recovered from a small number of random projections [28; 29; 30; 31; 32; 33]. Inspired by these results, previous works have used the principles of CS to build circuit models for olfactory coding [72; 73; 74; 21; 22; 23; 24; 25; 26; 27; 28; 29; 30; 31; 32; 33; 34; 35; 36; 37; 38; 39; 40; 41; 42; 43; 44; 45; 46; 47; 48; 49; 50; 51; 52; 53; 54; 55; 56; 57; 58; 59; 60; 61; 62; 63; 64; 65; 66; 67; 68; 69; 70; 71; 72; 73; 74]. However, these model circuits do not map cleanly onto the neural circuits of the OB and the olfactory cortical areas, particularly because they often assume each granule cell encodes exactly one odorant. Moreover, these works usually assume a Gaussian noise model for OSNs, which is biologically unrealistic (but see [21; 22]). Instead, OSN activity is better captured by a Poisson noise model [75; 76]. Some theoretical guarantees for Poisson CS are known, but the situation is less well-understood than in the Gaussian case [77; 78; 33; 72].

## 3 A neural circuit architecture for Poisson compressed sensing

We now derive a normative, rate-based neural circuit model that performs Poisson CS, which in subsequent sections we will map onto the circuitry of the OB. The design of this model will follow general biological principles, without initially drawing on specific knowledge of the OB. With the goal of sensing within a single sniff in mind, the circuit's objective is to rapidly infer the odorant concentrations \(_{+}^{n_{}}\) underlying a single, static sample of OSN activity \(_{+}^{n_{}}\). For simplicity, we model the mean activity of OSNs as a linear function of the concentration, with a receptor affinity matrix \(_{+}^{n_{} n_{}}\) and a baseline rate \(_{0}_{+}^{n_{}}\). As motivated above,

Figure 1: Circuit architecture of the mammalian olfactory bulb. **A.** Outline of the anatomy of OB circuits. **B.** Fit of the responses of 228 OSN glomerular responses to a panel of 32 odorants. (Gray line, response of single glomeruli, Blue line, Fitted average response.) See Appendix F for details of how these data were collected. **C.** Affinity matrix generated from the data-driven model ensemble. For illustrative purposes, we use only 30 receptors and 100 odorants; in simulations we use 300 receptors to roughly match humans , and 1000 or more odorants.

we use a Poisson noise model for OSN activity given the underlying concentration signal \(\), and correspondingly a Gamma prior over concentrations with shape \(_{+}^{n_{}}\) and scale \(_{+}^{n_{}}\):3

\[\,|\,(_{0}+),(,).\] (1)

Given this likelihood and prior, we construct a neural circuit to compute the maximum _a posteriori_ (MAP) estimate of the concentration \(\) using gradient ascent on the log-posterior probability. Here, we sketch the derivation, deferring some details to Appendix B. Our starting point is the gradient ascent equation

\[}(t)=_{} p(\,|\,) =^{}[(_{0}+)- ]+(-)-,\] (2)

where \(\) denotes elementwise division and \(}(t)=d/dt\). Here, the estimate \(\) is formally constrained to \(_{+}^{n_{}}\); in numerical simulations we will sometimes ignore this constraint. Circuit algorithms of this form were studied in previous work by Grabska-Barwinska et al. .

However, in this most basic setup there is a one-to-one mapping between neurons and odorants, which is at variance with our knowledge of biological olfaction (SS2). To distribute the code, we instead use a projected setup where the firing rates \(^{n_{}}\) of the neurons are mapped to the concentration estimate \(\) through a matrix \(^{n_{} n_{}}\): \((t)=(t)\). Even if \(\) is non-square--in particular, if \(n_{}>n_{}\)--so long as \(^{}\) is positive-definite and the rates follow the dynamics \(_{}}(t)=()^{}[(_{0}+)-]+^{}[(-)()-]\) for some time constant \(_{}\), the concentration estimates will still converge to the MAP. This corresponds to preconditioned gradient ascent . Again, we formally require the constraint that \(_{+}^{n_{}}\), which translates into a constraint on \(\). Most simply, we may take \(_{+}^{n_{}}\) and choose \(\) to be positivity-preserving.

These dynamics include two divisive non-linearities, which can be challenging to implement in biophysical models of single neurons . Using the approach proposed by Chalk et al. , we can linearize the inference by introducing two additional cell types that have as their fixed points the elementwise divisions \((_{0}+)\) and \((-)()\). Concretely, we introduce cell types with rates \(^{n_{}}\) and \(^{n_{}}\) such that their fixed-point rates for fixed \(\) are \(^{*}=(_{0}+)\) and \(^{*}=(-)()\), respectively. This yields the coupled circuit dynamics

\[(t) =(t), _{}}(t) =()^{}(-)+^{}(-),\] \[_{}}(t) =-(_{0}+), _{}}(t) =--,\] (3)

for cell-type-specific time constants \(_{}\), \(_{}\), and \(_{}\), where \(\) denotes elementwise multiplication. In the limit \(_{},_{}_{}\), this circuit will recover the MAP gradient ascent. If \(_{}\) and \(_{}\) are not infinitely fast relative to \(_{}\), we expect these dynamics to approximate the desired dynamics  (see Appendix C for a preliminary analysis of the linear stability of the MAP fixed-point). We will test the accuracy of this approximation for biologically-reasonable time constants using numerical experiments. Moreover, \(\) should formally be constrained to \(_{+}^{n_{}}\), such that the non-negativity of the target ratio is respected. Finally, we note that in the special case \(=\) in which the Gamma prior reduces to an exponential prior, the introduction of the cell type \(\) is no longer required.

## 4 Biological interpretation and predictions of the circuit model

We now argue that the normative model derived in the preceding section can be mapped onto the circuitry of the OB. In particular, though the model was derived based only on general biological principles, its specific features are biologically implementable based on the detailed anatomy and physiology of the OB. In terms of the levels of understanding of neural circuits proposed by David Marr, this is an example of how normative modeling can bridge the gap between algorithmic and mechanistic understanding .

As foreshadowed by our notation, we interpret the cell type \(\) as the granule cells of the OB, and the cell type \(\) as the mitral cells, which are projection neurons. Provided that the elements of the matrix \(\) are non-negative, this interpretation is justified at the coarsest level by the signs with which the two cell types appear in the dynamics: the \(\) neurons excite the \(\) neurons, which in turn inhibit the \(\) neurons. Finally, we interpret the cell type \(\) as representing a form of cortical feedback. In the remainder of this section, we will justify this mapping in detail.

### Circuit anatomy: weight transport, dendro-dendritic coupling, and cortical feedback

The first salient feature of the dynamics (3) is that the cell types \(\) and \(\) do not make direct lateral connections amongst themselves. Rather, they connect only indirectly through the neurons of the opposing cell type, matching the connectivity structure of mitral and granule cells (Fig. 1A). Moreover, the synaptic weights \(\) of the connections from \(\) to \(\) neurons mirror exactly the weights \(()^{}\) of the connections from \(\) to \(\) neurons. Naively, this creates a weight transport problem of the form that renders backpropagation biologically implausible: how should the exact transpose of a matrix be copied to another synapse [84; 85; 86]? However, in the unique case of the OB this does not pose a substantial obstacle, as the mitral and granule cells are coupled by dendro-dendritic synapses, meaning that bi-directional connectivity occurs at a single physical locus (Fig. 1) [49; 57; 87].

This interpretation accounts for the interactions between the cell types \(\) and \(\) in the dynamics (3), but what about the cell type \(\)? These cells give direct excitatory input to the granule cells \(\) with weights \(^{}\), and represent the concentration-dependent contribution to the log-prior gradient. We can therefore interpret these cells as representing feedback from olfactory cortical areas to the OB, which arrives at the granule cells [88; 89; 90]. Though our model can thus flexibly incorporate cortical feedback, for our subsequent simulations we will focus on the simple case in which the prior is static and has \(=\), in which case it reduces to an exponential and feedback is not explicitly required.

Given this mapping of the cell types of our model to the cell types of the bulb, we will henceforth choose the membrane time constants to match experiment, taking \(_{p}=20\) ms  and \(_{g}=30\) ms . This matching of timescales is required for our comparison of model inference timescales to the timescale of a single sniff to be meaningful.

### Choosing the affinity matrix

In theories of Poisson CS, the optimal sensing matrix \(\) is one that has columns that are in some precise sense as orthogonal as possible, so that it acts as an approximate isometry [27; 28; 29; 30; 31; 32; 33]. However, biologically, the olfactory system is not free to choose optimal sensors. Rather, the affinity profiles of each receptor are dictated by biophysics and by evolutionary history [53; 54; 93]. To build a more realistic model for OSN sensing, we therefore turn to biological data. Using two-photon calcium imaging, we recorded the responses of 228 mouse OSNs glomeruli to 32 odorants (see Appendix F for details; these data were previously published in ). In Fig. 1B, we show that the distribution of responses is well-fit by a \(\) distribution with shape 0.37 and scale 0.36 (Appendix F). We then define our ensemble of sensing matrices \(\) by drawing their elements as independently and identically distributed \((0.37,0.36)\) random variables. An example matrix drawn from this ensemble is shown in Fig. 1C.

Figure 2: State-dependent inhibition of mitral cells. **A.** Upon stimulation, mitral cells exhibit a transient burst of activity followed by relaxation to a plateau. Darker color indicates stronger stimulation. **B.** In the circuit for Poisson CS we propose (blue line), the inhibition due to the activation of a second mitral cell (\(MC_{B}\)) is gated by the activity of the cell we are recording from (\(MC_{A}\)), as observed experimentally by Arevian et al.  in their Fig. 2D. This state-dependent gating does not occur in a circuit derived from a Gaussian noise model (orange line). Rates are normalized to the maximal stimulation of the principal cell. Dashed line indicates the unity line. **C.** Strength of inhibition as a function of time and of stimulation intensity; c.f.  Fig. 3B.

### Divisive predictive coding by mitral cells

In our model (3), odorant concentration estimates are decoded from granule cell activity. This feature is shared with previous Gaussian CS models of olfactory coding [20; 24; 25]. Our model, however, matches biology more closely than these previous works because it allows for a distributed code rather than assuming that each granule cell codes for a single odorant.

What, then, is the functional role of the mitral cells in our model? We can interpret their dynamics as implementing a form of predictive coding, in which they are trying to cancel their input by the current prediction. Because the mitral cell activity converges to the ratio of their input to the prediction, this a divisive form of predictive coding . In contrast, a Gaussian noise model gives a subtractive form of predictive coding in which the activity converges to the difference between input and prediction (Appendix D) . In Fig. 2A, we show example timecourses of model mitral cell activity following the onset of a stimulus. Consistent with experimentally-measured responses [96; 97], a sharp transient response at the onset of stimulation is followed by decay to a low level of tonic activity (Fig. 2A).

### State-dependent inhibition of mitral cells

A salient feature of our circuit model is that the inhibition from the granule cells onto a mitral cell is gated by the activity of the mitral cell itself (3). This state-dependent inhibition is reminiscent of _in vitro_ experiments showing that granule cell mediated inhibition is activity dependent . In these experiments, Arevian et al. measured the activity of a primary mitral cell (\(MC_{A}\)) while increasing its level of stimulation under two conditions. In the first condition, no other cells in the circuit are being stimulated. In the second condition, they also activate another mitral cell (\(MC_{B}\)). The activation of the second mitral cell leads to the activation of granule cells connected to both mitral cells and a reduction in the firing evoked by stimulation of the primary cell alone. Strikingly, these authors showed that this inhibition is dependent on the activity of the primary cell .

Here, we show that our proposed circuit reproduces these observations of state-dependent inhibition, and that they do not arise in a similarly-constructed circuit for a Gaussian noise model. To model Arevian et al. 's _in vitro_ experiments, we simulated a reduced circuit with \(2\) mitral cells and \(10\) granule cells. We stimulated \(MC_{A}\) with an input \(s_{A}[1:400]\) while toggling on or off the stimulation \(s_{B}=80\) of the second mitral cell \(MC_{B}\). As observed experimentally, when \(MC_{B}\) is activated, the inhibition of the primary mitral cell \(MC_{A}\) is state dependent (Fig. 2B). To show that this effect arises from our Poisson circuit, we build a similar inference circuit with a Gaussian noise model (Appendix D). Under similar conditions, the inhibition in the Gaussian circuit is independent of the activity of the primary mitral cell \(MC_{A}\) (Fig. 2B). Furthermore, the dynamics of the relative inhibition qualitatively recapitulate those observed experimentally, with sustained inhibition throughout the stimulation period at the stimulation level of \(MC_{A}\) leading to maximal inhibition and inhibition followed by relaxation for stronger stimulation levels of \(MC_{A}\) (Fig. 2C and see  Fig. 3b).

## 5 Geometry, speed, and capacity

We have argued that the model introduced in SS3 could be implemented biologically, but can it perform at scale? Concretely, can a circuit of this architecture with neuron counts comparable to the human OB correctly identify which among a large set of odorants are present in a given scene? This is precisely the question of the capacity of the CS algorithm [98; 99]. In Fig. 3A, we present our algorithm with scenes composed of varying numbers of randomly-selected odorants out of a panel of 1000, which for simplicity we take to be at the same concentration. We first ask how many odorants can be reliably detected within a single sniff, i.e., 200 ms. To convert MAP concentration estimates into presence estimates, we simply binarize the estimated concentrations based on whether they are larger than half of the true odorant concentration. The ability of the one-to-one code to successfully detect odorants falls off rapidly, with the detection fraction falling below one-half even if only a handful of odorants are present (Fig. 3A).4

The limited capacity of the one-to-one code can be overcome by distributing the code in a way that takes into account the geometry of the sensing problem. Here, the information geometry of theproblem is governed by the sensing matrix \(\), which introduces correlations in the input signals to mitral cells because the off-diagonal components of \(^{}\) are non-negligible. To counteract these detrimental correlations, we can choose a readout matrix \(\) such that \(^{}(^{})^{+}\) up to constants of proportionality, where we must take a pseudoinverse because \(^{}\) is highly rank-deficient (see Appendix G for details). Geometrically, this corresponds an approximation of natural gradient descent, in which we use the Gauss-Newton matrix instead of the Fisher information matrix because the latter is state-dependent for Poisson likelihoods . As a control, we also consider a naively distributed code with \(^{}_{n_{}}\). Distributing the code, even without accounting for the geometry of inference, markedly improves the single-sniff capacity to around 10-20, and taking into account the geometry produces a further improvement (Fig. 3A).

To gain a more granular view of how tuned geometry enables faster inference, in Fig. 3B we test the three models' detection capabilities at sub-sniff resolution. We can see that at long times--around a second after odorant onset--the naively distributed and geometry-aware codes achieve similar capacities of around 50-60 odorants. However, the geometry-aware code reaches this detection capacity within a single sniff, whereas the naively distributed code requires the full second of

Figure 3: Fast detection of many odorants. \(\). Fraction of odorants correctly detected within 100 ms (_left_), 200 ms (_center_), and 1 s (_right_) after odorant onset as a function of the number of odorants present, for models with one-to-one, naively distributed, and geometry-aware codes. Here, we consider a repertoire of 1000 possible odorants. \(\). Heatmap with overlaid smoothed contours of correct detection fraction as a function of number of present odorants and time window for models with one-to-one (_left_), naively distributed (_center_), and geometry-aware (_right_) codes. As in \(\), a repertoire of 1000 possible odorants is used. \(\). Threshold number of odorants for which half can be correctly detected as a function of total repertoire size within 100 ms (_left_), 200 ms (_center_), and 1 s (_right_) after odorant onset. See also Supp. Figs. G.1 and G.2 for versions of panels \(\) and \(\) with varying repertoire sizes, from which the capacities shown here are derived. See Appendix G for details of our numerical methods. Shaded patches show \( 1.96\) SEM over realizations throughout.

processing time. The detection capacity of the one-to-one code reaches only around 20 odorants after 1 second, and even then does not appear to have reached its asymptote. These results illustrate two important conceptual points: First, when the strength of individual synapses is bounded, distributed coding can speed up dynamics by increasing the effective total input to a given neuron. Second, given a sensing matrix that induces strong correlations, geometry-aware distributed coding can accelerate inference by counteracting that detrimental coupling.

These tests show show that our model can reliably detect tens of odorants from a panel of thousands of possible odorants, but do not probe how the model's capacity scales to larger odor spaces. While the true dimensionality of odor space remains unknown [100; 101], there may be orders of magnitude more than thousands of possible odorants. As an upper bound, there are on the order of millions of known volatile compounds that are plausibly odorous . Thus, it is important to determine how our model scales to more realistically-sized odor spaces. From the literature on compressed sensing performance bounds, we expect the threshold sparsity to decay slowly--roughly logarithmically--with increasing \(n_{}\)[28; 29; 30; 31; 32; 33]. As a first step, in Supp. Figs. G.1 and G.2, we reproduce Fig. 3A-B for between 500 and 8000 possible odorants, showing that performance does indeed drop off slowly with increasing odor space dimension. To get a more precise estimate of how performance scales with repertoire size, in Fig. 3C we plot the threshold number of odorants for which half can be reliably detected as a function of the repertoire size, showing that for the geometry-aware code it decays only a bit faster than logarithmically. Our ability to simulate larger systems was limited by computational resources. This limitation is present in previous works, and the repertoires tested here are comparable to--or substantially larger than--those used in past studies [21; 22; 24; 26; 72].

## 6 Fast sampling for uncertainty estimation

Thus far, we have focused on a circuit that performs MAP estimation of odorant concentrations. However, to successfully navigate a dynamic, noisy world, animals must estimate sensory uncertainty at the timescale of perception [38; 103; 104; 105; 106; 107]. Fortunately, our circuit model can be easily extended to perform Langevin sampling of the full posterior distribution, allowing for uncertainty estimation while maintaining its attractive structural features. In Appendix B, we provide a detailed derivation of a model that implements Langevin sampling through the granule cells for a Poisson likelihood and Gamma prior. This yields a circuit that is identical to the MAP estimation circuit introduced in SS3 up to the addition of Gaussian noise to the granule cell dynamics:

\[(t) =(t) _{}}(t) =()^{}(-)+ ^{}(-)+(t)\] \[_{}}(t) =-(_{0}+ {}) _{}}(t) =--.\] (4)

Here, \((t)\) is a vector of \(n_{}\) independent zero-mean Gaussian noise processes with covariance \([_{j}(t)_{j^{}}(t^{})]=2_{}_ {jj^{}}(t-t^{})\), and once again the rates \(\) and \(\) should in principle be constrained to be non-negative. In this case, the readout matrix \(\) both preconditions the effective gradient force and shapes the structure of the effective noise \(\), allowing us to mold the geometry of the sampling manifold [37; 40]. By using a projected readout, we maintain the independence of the noise processes for different neurons. This both allows us to have many independent samplers--if \(n_{}>n_{}\)--and is important for biological realism if we interpret the sampling noise as resulting from fluctuations in membrane potential due to synaptic noise .

As a test of how this sampling circuit performs, we consider a simple setup in which one set of odorants appears at a low concentration, and then a second set of odorants appear at a higher concentration while the low odorants are still present. This setup tests both the circuit's ability to converge rapidly enough to give accurate posterior samples within a single sniff, and its ability to correctly infer odorant concentrations even in the presence of distractors [63; 66]. In Fig. 4, we show that circuits with one-to-one or naively distributed codes do not give accurate estimates of the concentration mean within 200 ms, while tuning the geometry to match the receptor affinities enables fast convergence. All three circuits overestimate the posterior variance at short times, consistent with what one would expect for unadjusted Langevin samplers , but the geometry-aware model's estimate decays most rapidly towards the target. Therefore, when the synaptic weights are tuned, our circuit model can enable fast, robust estimation of concentration statistics, even in the presence of distractors.

## 7 Discussion

In this paper, we have derived a novel, minimal rate model for fast Bayesian inference in early olfaction. Unlike previously-proposed algorithms for CS in olfaction, this model has a clear mapping onto the circuits of the mammalian OB. We showed that this model successfully performs odorant identification across a biologically-relevant range of scene sparsities and circuit sizes. This model therefore exemplifies how normative approaches can blur the lines between algorithmic and mechanistic understanding of neural circuits [82; 83]. We now conclude by discussing possible avenues for future inquiry, as well as some of the limitations of our work.

One limitation of our simulations is that we have chosen to distribute the neural code randomly, and have allowed for negative entries in the mitral-granic synaptic weight matrix \(\) (see methods in Appendix G). These features are not entirely biologically satisfactory. However, our model only captures the mitral cells and granule cells, overlooking a number of inhibitory cell types that could contribute to solving this problem, e.g., through feedforward inhibition onto mitral cells or lateral inhibition across granule cells [48; 49]. Fundamentally, negative values in the geometry-aware decoding matrix \(\) arise as although the affinity matrix is positive, its inverse will contain negative elements. A biologically-plausible realization of the geometry-aware code through the introduction of additional cell types could be achieved by decomposing the inverse into several components, yielding sparse, consistently-signed connectivity . As a first step, in Supp. Fig. G.4 we show that similar performance to Fig. 4 can be achieved using a sparse non-negative randomly distributed code. As a result, one objective for future work will be to develop better models for the decoding matrix \(\) that result in more realistic connectivity.

Though our model captures two of the interesting features of the anatomy and physiology of the OB--symmetric dendroendritic coupling and state-dependent inhibition of mitral cells--there are

Figure 4: Fast uncertainty estimation using Langevin sampling of the posterior. Here, we use a simple concentration estimation task in which 5 randomly-selected ‘low’ odorants out of a panel of 1000 appear at concentration 10 at time 0 s, and then a further 5 randomly-selected ‘high’ odorants appear at concentration 40 at time 1 s. \(\). Smoothed timeseries of instantaneous concentration estimates for low, high, and background odorants, for models with one-to-one (_top_), naively distributed (_middle_), and geometry-aware (_bottom_) codes. Background odorant estimates are shown as mean \(\) standard deviation over odorants. Dashed lines show true concentrations over time. \(\). Cumulative estimates of concentration mean for low (_top_) and high (_bottom_) odorants after the onset of the low odorants for one-to-one, naively distributed, and geometry-aware codes. Black lines indicate baseline estimates of the posterior mean. Thick colored lines indicate means over odorants. \(\). As in \(\), but for the estimated variance. \(\). As in \(\), but after the onset of high odorants. \(\). As in \(\), but after the onset of high odorants. See Appendix G for details of our numerical methods, and for individual-odor traces.

many biological details which we have not addressed. First, our linear model for OSN mean firing neglects receptor antagonism, gain control, and other nonlinear effects , which are known to affect the performance of Gaussian CS models for olfaction . Second, our models are rate-based, while neurons in the OB spike. In spiking implementations of sampling networks, the noise is not uncorrelated across neurons, complicating their biological interpretation . Constructing models that capture these richly nonlinear effects will be an important objective for future work. A first step towards such a nonlinear model would be to build a spiking network that approximates the rate-based models considered here, which could be accomplished using the efficient balanced network formalism for distributed spiking networks . Another step would be to add a Hill function nonlinearity to the OSN model to approximate competitive binding, as studied for Gaussian compressed sensing by Qin et al. . One challenge in constructing models that incorporate additional nonlinearity is that the simple linear strategy for distributing the code used here may no longer be directly applicable. In Appendix E, we illustrate this obstacle for the relatively simple case of a model with the same linear OSNs and Poisson likelihood but an \(L_{0}\) instead of Gamma prior, building on recent work on circuits for Gaussian CS with \(L_{0}\) priors .

A closely related point is that we model the weights of the synapses between mitral and granule cells as fixed, and do not consider synaptic plasticity. In particular, we assume that they are tuned to the statistics of the receptor affinities without specifying a mechanism by which this tuning could take place. In biology, receptor abundances and other OSN properties display activity-dependent adaptation over long timescales, meaning that the optimal tuning is unlikely to be static . Some past works have sought to incorporate plasticity of the mitral-granule cell synapses into decoding models , tying into a larger body of research on how plasticity can enable flexible feature extraction in olfaction . This learning should lead to measurable changes in the population response to odorant panels, which our model predicts should be linked in a precise way to account for receptor-induced correlations in the responses to the most frequently present odorants. Experimentally characterizing and carefully modeling these changes in responses across timescales will be an interesting avenue for future work . Experimental techniques to probe these ideas at the neural and behavioral level have recently been proposed  which allow more precise control of stimulus and subjective geometry.

Though the circuit model derived in SS3 incorporates a general Gamma prior represented by cortical feedback, our simulations focus on the special case in which the prior reduces to an exponential, in which the feedback neurons are not needed. Future work will therefore be required to carefully probe the effect of incorporating a Gamma prior with non-unit shape and to dissect the structure of the resulting modeled cortical feedback. More generally, it will be interesting to extend our framework to incorporate data-adaptive priors. Importantly, the stimuli used in this paper constitute an extremely impoverished model for the richness of the true odor world; we do not account for its rich dynamical structure and co-occureure statistics. Adaptive priors as encoded by cortical feedback would allow circuits to leverage this structure, enabling faster and more accurate inference .

We conclude by noting that our work provides an example of how distributed coding can lead to faster inference than axis-aligned disentangled coding. In recent years, the question of when axis-aligned coding is optimal has attracted significant attention in machine learning and neuroscience . Much of this work focuses on the question of when axis-aligned codes are optimal for energy efficiency or for generalization, whereas here we focus on the question of which code yields the fastest inference dynamics. These ideas are one example of the broader question of how agents and algorithms should leverage the rich geometry of the natural world to enable fast, robust learning and inference . We believe that investigating how task demands and biological constraints affect the optimal representational geometry for that task is a promising avenue for illuminating neural information processing in brains and machines .