# Resilient Multiple Choice Learning: A learned scoring scheme with application to audio scene analysis

Resilient Multiple Choice Learning: A learned scoring scheme with application to audio scene analysis

 Victor Letzelter\({}^{1,2}\)

Mathieu Fontaine\({}^{2}\)

Mickael Chen\({}^{1}\)

Patrick Perez\({}^{1}\)

Slim Essid\({}^{2}\)

Gael Richard\({}^{2}\)

\({}^{1}\) valeo.ai, Paris, France

\({}^{2}\) LTCI, Telecom Paris, Institut Polytechnique de Paris, France

###### Abstract

We introduce Resilient Multiple Choice Learning (rMCL), an extension of the MCL approach for conditional distribution estimation in regression settings where multiple targets may be sampled for each training input. Multiple Choice Learning is a simple framework to tackle multimodal density estimation, using the Winner-Takes-All (WTA) loss for a set of hypotheses. In regression settings, the existing MCL variants focus on merging the hypotheses, thereby eventually sacrificing the diversity of the predictions. In contrast, our method relies on a novel learned scoring scheme underpinned by a mathematical framework based on Voronoi tessellations of the output space, from which we can derive a probabilistic interpretation. After empirically validating rMCL with experiments on synthetic data, we further assess its merits on the sound source localization task, demonstrating its practical usefulness and the relevance of its interpretation.

## 1 Introduction

Machine learning models are commonly trained to produce, for any given input, a single prediction. In most cases, for instance, when minimizing the empirical risk with quadratic loss, this prediction can be interpreted as the conditional output expectation given the input. However, there are many tasks for which the conditional output distribution can be multimodal, either by the nature of the task or due to various sources of uncertainty. Temporal tracking and forecasting, for instance, are problems of this type . In such cases, the mean might fall in a low-density region of the conditional probability function, and it would be beneficial to predict multiple hypotheses instead . In this context, Multiple Choice Learning (MCL) has emerged as a simple pragmatic solution . Thanks to a network architecture with multiple heads, MCL models can produce multiple hypotheses, one per head. During supervised training, the gradients are only computed for the head that provides the best prediction given the current input sample. This Winner-Takes-All (WTA) training scheme allows each head to specialize in a region of the output space. Accordingly, Rupprecht et al.  have proposed a probabilistic interpretation of MCL based on Voronoi tessellations.

On that account, MCL suffers from two significant issues: _hypotheses collapse_ and _overconfidence_. _Hypotheses collapse_ occurs during training when a head takes the lead, the others being almost never selected under WTA and thus not updated. This leads to a situation where most heads are not trained effectively and produce meaningless outputs during inference. _Overconfidence_ can also be observed at inference time when looking at MCL under the lens of its probabilistic interpretation. Hypotheses that correspond to rare events tend to be over-represented, thus not reflecting the true distribution of outputs well. Multiple variants of MCL have been developed to alleviate these issues, in particular for classification or segmentation tasks [29; 27; 42; 13].

In this paper, we are interested in MCL in the context of regression settings, which has been mostly overlooked. More specifically, we propose rMCL, for _resilient Multiple Choice Learning_, a MCL variant with a learned scoring scheme to mitigate overconfidence. Unlike prior work, rMCL is designed to handle more general settings where multiple targets may be sampled for each input during training. Moreover, we propose a probabilistic interpretation of rMCL, and show that rMCL's scoring fixes overconfidence by casting multi-choice regression as conditional distribution estimation. While introduced in the context of the original WTA loss, the proposed scoring approach is also compatible with other variants of WTA. We validate our claims with experiments on synthetic data, and we further evaluate the performance of rMCL on the sound source localization problem. The accompanying code with a rMCL implementation is made available.1

## 2 Related Work

**Uncertainty estimation.** The estimation of machine learning model's uncertainty can be studied from different perspectives depending on the type of ambiguity being considered. The uncertainty can concern either the model (_epistemic_) or the data (_aleatoric_) [7; 12]. Kendall and Gal  showed that those types of uncertainty can be combined in deep learning settings, placing both a distribution on the weights and the outputs of the model. Epistemic uncertainty estimation may, for instance, be achieved by variational approximation of the weights posterior [31; 14]. Independent ensembles (IE) of neural networks [18; 11] is another widespread technique for epistemic uncertainty approximation. Several neural networks, trained from different random initializations, provide samples for approximating the weights posterior distribution .

**Multiple Choice learning.** Originally introduced by Guzman-Rivera et al.  and adapted to deep learning settings by Lee et al. [28; 29], MCL is a framework in which multiple output heads propose different possible predictions. Since many datasets contain only a single output realization for each input, the heads are trained with a Winner-Takes-All scheme where only the head that made the best prediction is updated. It can be understood as a specific case of dependent ensembles [8; 46; 4; 47] where the members interact with each other during training. Alternatively,  have shown that MCL can be adapted successfully for multi-label classification .

The Winner-Takes-All training scheme, however, can cause two main issues known as _hypotheses collapse_ and _overconfidence_[34; 6; 10; 19; 10; 27; 42]. Most related previous works tackle either or both of those questions. Hypotheses collapse occurs during training when some heads receive little or no updates due to bad initial values under the WTA loss and other hypotheses taking the lead. To fix this issue, Rupprecht et al.  proposed a relaxed Winner-Takes-All (RWTA, or \(\)-WTA) loss that allows the update of non-winner heads, albeit with gradients scaled by a small constant \(\). While this approach ensures that every head receives gradients updates, it also tends to level the different heads, which counters the initial goal of WTA and thus needs careful tuning. Finally, one can leverage the evolving Winner-Takes-All loss , with the top-\(n\) heads getting updated (top-\(n\)-WTA) instead of only the best one. The authors validate that their approach, with a scheduled decreasing value for \(n\), achieves improved conditioning of the outputs by reducing inconsistent hypotheses in the context of future frames prediction.

On the other hand, overconfidence is an issue that can be observed in inference when evaluating a model as a density estimator. In this case, one would want the different outputs to be distributed across the different modes of the true conditional probability of the outputs. Empirical observations [27; 42] show that this is not usually the case, and rare events tend to be overly represented, rendering such a model inadequate for integration within real-world decision-making systems. In this context, Lee et al.  proposed _Confident Multiple Choice Learning_ (CMCL) for solving overconfidence in a classification setup. Additionally to the WTA loss, CMCL is trained by maximizing the entropy of the class distributions predicted by the non-selected hypotheses. The classifier's final prediction is based on a simple average of the discrete class distributions predicted by each of the heads. Although designed for tackling the overconfidence problem, CMCL reduces the diversity of the hypotheses. On that account, _Versatile Multiple Choice Learning_ (vMCL) proposed to address the issue by leveraging a choice network aiming at predicting a score for each hypothesis head. This may be seen as a variant of Mixture-of-Experts approaches , in which the choice network is supervised with explicit targets. The final prediction in vMCL is derived by weighting the class distributions from each hypothesis by their respective scores. These works focus on classification tasks and aggregate the hypotheses, thereby losing individual information from each head. In contrast, we address regression tasks and demonstrate how to benefit from the diversity of predictions _without_ aggregation.

We propose to revisit the vMCL approach for regression, single-target or multi-target, and to extend accordingly the mathematical interpretation of the WTA proposed by Rupprecht et al. .

## 3 rMCL regression and its probabilistic interpretation

After reviewing MCL, this section introduces resilient Multiple Choice Learning, dubbed rMCL. This proposed variant handles multi-target settings thanks to its scoring scheme. We then provide a distribution learning interpretation of rMCL that is relevant to regression tasks, thus completing the MCL probabilistic interpretations of prior works [9; 34].

### Fixing the overconfidence issue in Multiple Choice Learning

Let \(^{d}\) and \(^{q}\) be the input and output spaces in a supervised learning setting, such that the training set \(\) is composed of samples \((_{s},_{s})\) from an underlying joint distribution \(p(,)\) over \(\).

Multiple choice learning was proposed to address tasks with ambiguous outputs, _i.e._, for which the ground-truth distribution \(p(\,|\,)\) is multimodal [17; 29; 10]. Adapted by Lee et al.  for deep-learning settings in _Stochastic Multiple Choice Learning_ (sMCL), it leverages several models \(f_{}(f_{}^{1},,f_{}^{K})( ,^{K})\), referred to as \(K\)_hypotheses_, trained using the Winner-takes-all (or Oracle) loss. It consists, given an underlying loss function \(\) and for each sample \((_{s},_{s})\) in the current batch, of first the computation of

\[(f_{}(_{s}),_{s})_{k[1,K]} (f_{}^{k}(_{s}),_{s})\] (1)

after each forward pass, followed by backpropagation on the _winner_ hypothesis, that is, the minimizing one. Assuming now that a set \(_{s}\) of targets is available in the training set for input \(_{s}\), Firman et al.  have shown that (1) can be generalized by updating the best hypothesis per target using the meta-loss

\[(f_{}(_{s}),_{s})=_{ {y}_{s}}_{k=1}^{K}(^{k}(_{s}))(f_{}^{k}(_{s}), ),\] (2)

where

\[^{k}()\{,\ (f_{ }^{k}(),)<(f_{}^{r}(), ),\  r k\}.\] (3)

This loss can, however, lead to poor conditioning of the output set of predictions (_hypotheses collapse_), with only one or a few hypotheses being exclusively selected for backpropagation. Furthermore, sMCL is subject to the _overconfidence_ problem. Following Theorem 1 of , a necessary condition for minimizing the risk

\[_{}_{k=1}^{K}_{^{k}()}(f_{ }^{k}(),)p(,) {x},\] (4)

is that each prediction \(f_{}^{k}()\) coincides with the centroid of \(^{k}()\) with respect to \(p(\,|\,)\). We say that the components \(\{^{k}()\}_{k}\) form a _centroidal_ Voronoi tessellation . If \(\) is for instance the \(_{2}\)-loss, this condition means that for each non-zero probability cell \(k\), \(f_{}^{k}()\) amounts to the conditional mean of \(p(\,|\,)\) within the Voronoi cell \(^{k}()\). However, this theorem tells us nothing about the predictions in very low probability zones; in such regions, the inference-time predictions \(f_{}^{k}()\) will be meaningless. During inference, the sMCL indeed faces a limitation: it cannot solely rely on the predicted hypotheses to identify Voronoi cells in the output space with low probability mass (see Figure 1). This observation leads us to propose _hypothesis-scoring_ heads \(_{}^{1},,_{}^{K}( ,)\). Those aim to predict, for unseen input \(\), the probability \((Y_{}^{k}())\) where \(Y_{} p(\,|\,)\) with the aim of mitigating this overconfidence issue.

While MCL variants have often been proposed for classification tasks, we are, to the best of our knowledge, the first to propose to solve this issue for multi-target regression, interpreting the problem as a multimodal conditional distribution estimation.

### Resilient Multiple Choice Learning

We consider hereafter a problem of estimation of a multimodal conditional distribution denoted \(p(\,|\,)\) for each input \(\). In a real-world setting, only one or several samples (the _targets_) drawn from \(p(\,|\,)\) are usually accessible. Sound source localization is a concrete instance of such multimodal prediction for whose \(p(\,|\,_{s})\) represents the sound source position for an input audio clip \(_{s}\) at a given time \(t\).

In this last example, each target sample in \(_{s}\) may represent the location of a _mode_ of the ground-truth multimodal distribution. For such multi-output regression tasks, the MCL training of a randomly initialized multi-hypotheses model with scoring functions, \((f^{1}_{},,f^{K}_{},^{1}_{},,^{K}_{})\) can be adapted as follows.

For each training sample \((_{s},_{s})\), let

\[_{+}(_{s})k^{+} 1,K :_{s},k^{+}*{ argmin}_{k}\,(f^{k}_{}(_{s}),)}\] (5)

and \(_{-}(_{s}) 1,K- _{+}(_{s})\) be the set of _positive_ (or _winner_) and _negative_ hypotheses respectively. It is then possible to combine the multi-target WTA loss \(\) in (2) with a hypothesis scoring loss

\[_{}()-_{k^{+} _{+}(_{s})}^{k^{+}}_{} (_{s})+_{k^{-}_{-}( _{s})}(1-^{k^{-}}_{}(_{s} )),\] (6)

in a compound loss \(+_{}\). This novel approach differs from previous MCL variants  in its ability to predict multimodal distributions in regression settings and by the introduction of separated scoring branches that are updated based on loss (6), such that the target for the scoring branch \(k\) is the probability that hypothesis \(k\) is among the winners for that sample.

A resource-efficient implementation of rMCL is achieved by deriving the hypotheses and score heads from a shared representation, with distinct parameters at the final stages of the architecture (_e.g._, through independent fully connected layers). Designed as such, it is also possible to reduce memory cost by updating only a fraction of score heads associated with the negative hypotheses at each training step, typically with distinct samples \(k^{-}(_{-}(_{s}))\). This trick could also alleviate the imbalanced binary classification task that the scoring heads face with a large number of hypotheses \(|_{-}(_{s})||_{+}(_{s})|\) (typically, the number of target samples at disposal is small relative to the number of hypotheses \(K\)). The variants of the WTA (_e.g._, top-\(n\)-WTA, \(\)-WTA, see Sec. 2) are also compatible with rMCL. Inference with the proposed rMCL model is outlined in Algorithm 1.

As highlighted above, the hypothesis output can be interpreted, in the context of risk minimization, as the conditional mean of the Voronoi cell \(^{k}()\) it defines, providing that the cell has non-zero probability. Furthermore, given (6), the output of the score head \(^{k}_{}()\) can be interpreted as an approximation of the probability of a sample from \(p(\,|\,)\) to belong to this cell.

``` Input: Unlabelled input \(\). Trained hypotheses and score heads \(f^{1}_{},,f^{K}_{},^{1}_{}, ,^{K}_{}(, )^{K}(,)^{K}\). Output: Prediction of the output conditional distribution \(p(\,|\,)\).
1: Perform a forward pass by computing \(f^{1}_{}(),,f^{K}_{}(), ^{1}_{}(),,^ {K}_{}()\).
2: Construct the associated Voronoi components \(^{k}()\) (3) with \(=_{k=1}^{K}^{k}()}\).
3: Normalize the predicted scores \(^{k}_{}()}{{ }}(}}{{}})/_{k=1}^{K} }{{}^{k}_{}()}\).
4: If \(_{} p(\,|\,)\), then for \(k\) such that \(^{k}_{}()>0\), interpret the predictions as estimations of

\[^{k}_{}()= (Y_{}^{k}())\\ f^{k}_{}()=[Y_{}\,|\,Y_{ }^{k}()]\] (7)

[MISSING_PAGE_FAIL:5]

We compared the behavior of our proposed approach rMCL against sMCL and independent ensembles (IE) using a 3-layer perceptron backbone with 256 hidden units and 20 output hypotheses, and \(_{2}\) as the underlying distance. For rMCL, we used scoring weight \(=1\). In addition to the full-fledged rMCL, we assess a variant denoted 'rMCL\({}^{*}\)' where a single negative hypothesis is uniformly selected during training. For independent ensembles, we trained with independent random initialization 20 single-hypothesis models, the predictions of which being combined to be comparable to multi-hypothesis models. The training processes were executed until the convergence of the training loss. We report the checkpoints for which the validation loss was the lowest. All networks were optimized using Adam . We show in Figure 1 (top right) test predictions of the classical sMCL compared to those of the rMCL model. In visualizing the predictions where the ground-truth distribution is known, we observe empirically that the _centroidal_ tessellation property, \([Y_{}^{k}]=f_{}^{k}()\), is verified with good approximation (see red points Figure 1, bottom right). We otherwise notice the _overconfidence_ problem of the sMCL model in low-density zones when the output distribution is multimodal by looking at the output prediction, _e.g._, for \(x=0.1\) and \(x=0.9\) in Figure 1 where the sMCL predictions fail in low-density zones. In contrast, rMCL solves this issue, assigning to each Voronoi cell a score that approximates the probability mass of the ground-truth distribution in this zone (see Figure 1, bottom). Furthermore, the independent ensembles (triangles) suffer from a collapse issue around the conditional mean of the ground-truth distribution. This behavior is expected as the minimizer of the continuous formulation of the risk (4) on the whole output space is the conditional expectation of the output given the input.

From a quantitative perspective, as demonstrated in Fig. 1, we can evaluate the effectiveness of rMCL in addressing the _overconfidence_ issue compared to the classical sMCL. To ensure a fair comparison with sMCL settings, we have opted for using the Earth Mover's Distance (EMD) metric, which measures the discrepancy between the ground truth and predicted distributions. Predicted distributions are considered mixtures of Dirac deltas as in (12) for the metric computation, with sMCL predictions assigning uniform mode weights. As depicted in Fig. 1, rMCL outperforms sMCL when the target distribution is multimodal, _i.e._, for extreme values of \(x\). However, in the unimodal scenario, the performances of rMCL and sMCL are fairly similar. Furthermore, the 'rMCL\({}^{*}\)' variant (depicted by crosses) that is lighter regarding memory consumption exhibits performance comparable to the standard rMCL. Additional assessments, which are detailed in Appendix B.2, have demonstrated the robustness of the rMCL when corrupting the training dataset with outliers in the output space.

Figure 1: **Comparisons on a 2D regression toy problem**. Comparing sMCL with standard WTA (‘sMCL’, pink diamonds), proposed rMCL (blue circles), a variant of rMCL with a single negative hypothesis chosen uniformly at training (‘rMCL\({}^{*}\)’, purple crosses), and Independent Ensemble (‘IE’, yellow triangles). (_Left_) Test EMD for different inputs \(x\); (_Right_) Inference at \(x=0.1,0.6,0.9\) and Voronoi tessellations generated by the hypotheses. Green points are samples from the ground-truth distribution at the corresponding input. Cells conditional mean (red points) matches with the predicted hypotheses. The score predicted in each cell, displayed as color saturation of the blue circles, as per scale on the right, approximates the corresponding proportion of points. At \(x=0.1\) and \(0.9\), we can observe how rMCL tackles well the overconfidence issue in the low-density zones.

Experiments with audio data

### Sound source localization as a conditional distribution estimation problem

Sound source localization (SSL) is the task of predicting the successive angular positions of audio sources from a multichannel input audio clip \(\). This problem can be cast either as a regression problem (estimating the continuous positions of the sources, _e.g._, ) or a classification one (segmenting the output space into zones in which we wish to detect a source, _e.g._, ). While not requiring the number of sources to be known in advance, the classification approach suffers from the lack of balanced data and limited spatial resolution. On the other hand, the regression approach enables off-grid localization but typically suffers from the source permutation problem . Assuming that the maximum number of overlapping sources \(M\) is known, a solution for handling this multi-target regression problem is to predict, at each time frame \(t\) depending on the chosen output resolution, a vector accounting for the sources' activity \(_{t}\{0,1\}^{M}\), as well as azimuth and elevation angles \(_{t}^{M}\) and \(_{t}^{M}\). A model can be trained with a permutation invariant training (PIT) approach  using an optimization criterion of the form

\[()=_{t}_{_{M}}_{} ((}_{t}),_{t})+_{g}(((}_{t}),(}_{t})),(_{t},_{t})),\] (13)

where \(_{}\) and \(_{g}\) correspond respectively to a cross-entropy term and a geometrical loss, the latter being computed only for active sources indexes. \(_{M}\) is the set of permutations of \(M\) elements and the notation \(()\) stands for the \(M\)-dim vector \(\) with its components permuted according to \(\). In the following, we will denote \(_{t}\) the set of source positions at time \(t\).

With the distribution learning mindset, this task can be seen as an attempt to estimate, at each time step, the sound source position distribution \(p(\,|\,)\), which can be viewed as a Dirac mixture, \(p(\,|\,)_{_{i}_{t}}_{_{i}}( )\), if we suppose that the targets are point-wise, with another Dirac mixture representing the predicted active modes at predicted positions. Therefore, a natural way to evaluate such SSL regression models is to solve the linear assignment problem, _e.g._, using Hungarian matching with spherical distance as an underlying metric. To handle more general distributions, we propose to generalize the metric used to the Earth Mover's Distance (see Sec. 4.2).

The rMCL framework is well suited to SSL as it allows one to benefit from both the advantages of the regression and classification viewpoints in the same spirit as . There is no need for prior knowledge of the number of sources, and it avoids challenges related to imbalanced spatial positions and the source permutation problem of (13). This method comes at a low computational cost regarding added parameters when opting for a low-level representation shared by the hypotheses and scores heads (see Sec. 3.2). Furthermore, it allows for producing a heat map of the sound sources' positions with a probabilistic prediction, which could otherwise account for their spatial dispersion depending on the chosen law \(_{k}\) selected in the Voronoi cells. Modeling the sound sources as point sources, a delta law will be selected following the formulation of Proposition 1.

### Experimental setup

**Datasets.** We conducted our experiments on increasingly complex SSL datasets originally introduced by Adavanne et al. : i) ANSYN, derived from DCASE 2016 Sound Event Detection challenge with spatially localized events in anechoic conditions and ii) RESYN, a variant of ANSYN in reverberant conditions. Each dataset is divided into three sub-datasets depending on the maximum number of overlapping events (1, 2, or 3, denoted as D1, D2, and D3). These sub-datasets are further divided into three splits (including one for testing). Each training split contains 300 recordings (30 s), of which 60 are reserved for validation. Preprocessing is detailed in Appendix A.2. For each experiment, we used all training splits from D1, D2, and D3. Evaluation was then conducted for each test set based on the overlapping levels. Moreover, we present results from additional SSL datasets, including REAL and DCASE19, in Appendix B.3.

**Metrics.** To assess the performance of the different methods, we employed the following metrics:

* The _'Oracle' error_ (\(\)): \((_{n},_{n})=_{n}|}_{_{m} _{n}}_{k 1,K}d(f_{}^{k}(_{ n}),_{m})\).
* The _Earth Mover's Distance_ (EMD \(\)): also known as the 1st Wasserstein distance, it is a distance measure between two probability distributions. In this context, these are the predicted distribution, \((\,|\,_{n})=_{k=1}^{K}_{}^{k}(_{n})_{ }^{k}(_{n})()\), and the ground-truth one, \(p(\,|\,_{n})=_{n}|}_{_{m}_{n}} _{_{m}}()\). The EMD solves the optimization problem \(W_{1}(p(|_{n}),(|_{n}))=_{ }_{k=1}^{K}_{_{m}_{n}}_{k,m}d(f_{}^{ k}(_{n}),_{m}),\) where \(=((f_{}^{k}(_{n}),_{m}))_{k,m}\) is a transport plan and \(\) is the set of all valid transport plans .

While the oracle error assesses the quality of the _best_ hypothesis predicted for each target, the EMD metric looks at _all_ hypotheses. It provides insight into the overall consistency of the predicted distribution. The EMD also penalizes the overconfidence issue of the WTA with sMCL as described in Sec. 3.4. In order to fit the directional nature of the sound source localization task, these metrics are computed in a spherical space equipped with distance \(d(},)=[()()+( )()(-)]\), where \((,)\) and \((,)\) are source positions \(}\) and \(\), respectively, expressed as azimuth and elevation angles.

Neural network backboneWe employed the CRNN architecture of SeldNet  as a backbone, which we modified to enable multi-hypothesis predictions. This adaptation involves adjusting the output format and duplicating the last fully-connected layers for hypothesis and scoring heads. As only the prediction heads are adjusted, the number of parameters added to the architecture is negligible. Refer to Appendix A.2 for additional architecture and training details.

BaselinesWe compared the proposed rMCL with several baselines, each utilizing the same feature-extractor backbone as previously described. The baselines include a Permutation Invariant Training variant ('PIT variant') proposed in  for SSL, the conventional WTA setup ('WTA, 5 hyp.') and its single hypothesis variant ('WTA, 1 hyp.'), its \(\)-relaxed version with \(=0.5\) ('\(\)-WTA, 5 hyp.') and its top-\(n\) variant with \(n=3\) ('top-\(n\)-WTA, 5 hyp.'), as well as independent ensembles ('IE'). To ensure a fair comparison, we used the same number of 5 hypotheses for the WTAs, sufficient to cover the maximum of 3 sound sources in the dataset (refer to Sec. 4.5 and the sensitivity study in Table 4). For the single hypothesis WTA, the head is updated by only considering the best target, as this fares better than using one update per target. IE was constructed from five such single hypothesis WTA models trained independently with random initialization.

### Comparative evaluation of rMCL in SSL

   Dataset: **RESYN** & EMD D1 & EMD D2 & EMD D3 & Oracle D1 & Oracle D2 & Oracle D3 \\  PIT variant & 10.53 \(\) 0.90 & 25.09 \(\) 2.14 & 35.05 \(\) 1.98 & 4.89 \(\) 0.55 & 15.92 \(\) 1.36 & 24.95 \(\) 1.62 \\ IE (5 members) & **8.24 \(\) 1.02** & 26.65 \(\) 2.49 & 38.7 \(\) 2.62 & **3.77 \(\) 0.61** & 20.95 \(\) 2.27 & 32.85 \(\) 2.48 \\ WTA, 1 hyp. & 8.32 \(\) 1.28 & 29.26 \(\) 2.85 & 43.25 \(\) 2.94 & 8.32 \(\) 1.28 & 29.26 \(\) 2.85 & 43.25 \(\) 2.94 \\ WTA, 5 hyp. & 57.88 \(\) 1.71 & 51.74 \(\) 1.36 & 47.38 \(\) 1.26 & 5.81 \(\) 0.58 & **9.46 \(\) 0.71** & **13.33 \(\) 0.69** \\ top-\(n\)-WTA, 5 hyp. & 42.74 \(\) 2.86 & 37.25 \(\) 1.88 & 36.48 \(\) 1.40 & 6.21 \(\) 0.79 & 11.02 \(\) 1.00 & 17.32 \(\) 1.11 \\ \(\)-WTA, 5 hyp. & 8.84 \(\) 1.09 & 27.3 \(\) 2.52 & 38.43 \(\) 2.42 & 6.48 \(\) 0.95 & 20.54 \(\) 2.33 & 30.18 \(\) 2.15 \\ rMCL, 5 hyp. & 12.14 \(\) 1.12 & **24.45 \(\) 1.91** & **32.28 \(\) 1.85** & 5.74 \(\) 0.66 & 10.5 \(\) 0.87 & 14.6 \(\) 0.87 \\   

Table 2: **Source localization in reverberant conditions. Results on RESYN dataset, with same table layout as in Table 1.**

   Dataset: **ANSYN** & EMD D1 & EMD D2 & EMD D3 & Oracle D1 & Oracle D2 & Oracle D3 \\  PIT variant & 6.22 \(\) 0.80 & 14.65 \(\) 1.22 & 23.41 \(\) 1.39 & 3.58 \(\) 0.46 & 10.58 \(\) 0.91 & 18.10 \(\) 1.04 \\ IE (5 members) & 4.05 \(\) 0.48 & 21.64 \(\) 2.29 & 34.34 \(\) 2.37 & **1.24 \(\) 0.24** & 16.91 \(\) 2.05 & 28.82 \(\) 2.25 \\ WTA, 1 hyp. & **3.97 \(\) 0.55** & 24.69 \(\) 2.72 & 39.66 \(\) 2.67 & 3.97 \(\) 0.55 & 24.69 \(\) 2.72 & 39.66 \(\) 2.67 \\ WTA, 5 hyp. & 48.22 \(\) 1.78 & 44.41 \(\) 1.25 & 41.83 \(\) 0.96 & 3.56 \(\) 0.39 & **6.53 \(\) 0.44** & **10.44 \(\) 0.58** \\ top-\(n\)-WTA, 5 hyp. & 5.14 \(\) 0.80 & 18.09 \(\) 1.32 & 25.12 \(\) 1.30 & 3.33 \(\) 0.46 & 7.48 \(\) 0.79 & 13.54 \(\) 0.96 \\ \(\)-WTA, 5 hyp. & 5.11 \(\) 0.66 & 19.20 \(\) 1.78 & 28.39 \(\) 1.68 & 3.62 \(\) 0.57 & 10.86 \(\) 1.26 & 17.44 \(\) 1.22 \\ rMCL, 5 hyp. & 7.04 \(\) 0.58 & **13.87 \(\) 0.99** & **20.76 \(\) 1.04** & 3.85 \(\) 0.46 & 7.16 \(\) 0.67 & 11.29 \(\) 0.78 \\   

Table 1: **Source localization in anechoic conditions. Average scores (\(\) standard deviation) on ANSYN dataset for PIT, IE, various WTA-based methods, and proposed rMCL. The ‘EMD’ evaluates all the hypotheses jointly, while the ‘Oracle’ error only looks at the best hypotheses. D1 corresponds to the single-target setting, while D2 and D3 consider up to 2 and 3 targets, respectively.**We present in Tables 1 and 2 the results of rMCL and baselines in the anechoic (ANSYN) and reverberant (RESYN) conditions, respectively. The consistency of the results should be noted. For each model, the metrics tend to improve as the number of sources decreases and, under similar conditions, results are marginally lower for more challenging datasets. Unsurprisingly, the single hypothesis approach exhibits strong performances in the unimodal cases (D1), but performs significantly worse in the multimodal cases (D2 and D3). Ensembling (IE) improves its performance but still displays the lack of diversity already exposed in Section 3.4. As for the 5-hypothesis WTA, in its original form, it is ill-suited for multi-target regression due to the overconfidence issue: despite a strong oracle metric, the EMD results are very poor. On the other hand, rMCL surpasses its competitors and shows the best EMD in every multimodal setting. It also consistently obtains the second-best oracle error, only slightly above WTA, while not suffering from overconfidence.

We also present results for REAL and DCASE19 in Appendix B.3, that display similar trends. We did not observe the collapse issue (see Section 3.1) in our settings, neither with WTA nor with the proposed rMCL model. We believe it is solved in practice by the variability of the data samples in the stochastic optimization during training ; refer to Appendix B.1 for further discussions.

### Combining rMCL with other WTA variants

As noted in Section 3.2, rMCL's improvements are, in theory, orthogonal to that of other WTA variants. In this section, we combine the rMCL with top-\(n\)-WTA and \(\)-WTA approaches into respectively top-\(n\)-rMCL and \(\)-rMCL. The results are shown in Tables 3. We note that while top-\(n\) rMCL does not provide significant improvement to rMCL, \(\)-rMCL, on the other hand improves EMD scores at the expense of increased oracle error. We observe similar effects when this method is applied to WTA, indicating that there are indeed some additive effects of \(\)-WTA and rMCL. Also note that with regards to Tables 1 and 2, all the proposed variants still get better EMD than all competitors under multimodal conditions, showing the robustness of our method.

### Effect of the number of hypotheses

The impact of varying the number of hypotheses on the performance of the rMCL model is presented in Table 4 and Figure B.4. First and foremost, we notice the anticipated trend of the oracle metric improving as the number of hypotheses increases. Concerning the EMD metric, the single hypothesis model, which avoids errors from negative hypotheses, is most effective in handling unimodal

   Dataset: **ANSYN** & EMD D1 & EMD D2 & EMD D3 & Oracle D1 & Oracle D2 & Oracle D3 \\  PTT variant & 6.22 \(\) 0.80 & 14.65 \(\) 1.22 & 23.41 \(\) 1.39 & 3.58 \(\) 0.46 & 10.58 \(\) 0.91 & 18.10 \(\) 1.04 \\ WTA, 1 hyp. & **3.97 \(\) 0.55** & 24.69 \(\) 2.72 & 39.66 \(\) 2.67 & 3.97 \(\) 0.55 & 24.69 \(\) 2.72 & 39.66 \(\) 2.67 \\ rMCL, 3 hyp. & 9.89 \(\) 0.95 & 14.37 \(\) 0.91 & 20.96 \(\) 1.03 & 5.65 \(\) 0.73 & 8.6 \(\) 0.63 & 13.42 \(\) 0.86 \\ rMCL, 5 hyp. & 7.04 \(\) 0.58 & **13.87 \(\) 0.99** & **20.76 \(\) 1.04** & 3.85 \(\) 0.46 & 7.16 \(\) 0.67 & 11.29 \(\) 0.78 \\ rMCL, 10 hyp. & 9.14 \(\) 0.76 & 15.2 \(\) 0.84 & 21.28 \(\) 0.96 & 2.94 \(\) 0.35 & 4.76 \(\) 0.39 & 7.54 \(\) 0.50 \\ rMCL, 20 hyp. & 9.13 \(\) 0.71 & 16.04 \(\) 0.84 & 22.55 \(\) 0.87 & **2.06 \(\) 0.22** & **3.61 \(\) 0.30** & **5.83 \(\) 0.37** \\   

Table 4: **Sensitivity analysis**. Effect of the number of hypotheses on the performance of rMCL.

   Dataset: **ANSYN** & EMD D1 & EMD D2 & EMD D3 & Oracle D1 & Oracle D2 & Oracle D3 \\  rMCL, 5 hyp. & 7.04 \(\) 0.58 & 13.87 \(\) 0.99 & 20.76 \(\) 1.04 & 3.85 \(\) 0.46 & **7.16 \(\) 0.67** & **11.29 \(\) 0.78** \\ top-\(n\)-rMCL, 5 hyp. & **5.46 \(\) 0.62** & 13.88 \(\) 1.06 & 21.45 \(\) 1.10 & 4.2 \(\) 0.55 & 8.04 \(\) 0.74 & 13.72 \(\) 0.89 \\ \(\)-rMCL, 5 hyp. & 5.89 \(\) 0.69 & **12.13 \(\) 0.98** & **19.95 \(\) 1.16** & **3.6 \(\) 0.54** & 8.76 \(\) 0.89 & 14.47 \(\) 1.02 \\   Dataset: **RESYN** & EMD D1 & EMD D2 & EMD D3 & Oracle D1 & Oracle D2 & Oracle D3 \\  rMCL, 5 hyp. & 12.14 \(\) 1.12 & 24.45 \(\) 1.91 & **32.28 \(\) 1.85** & **5.74 \(\) 0.66** & **10.5 \(\) 0.87** & **14.6 \(\) 0.87** \\ top-\(n\)-rMCL, 5 hyp. & 9.3 \(\) 1.15 & 23.81 \(\) 2.22 & 33.33 \(\) 2.06 & 6.99 \(\) 0.85 & 13.43 \(\) 1.40 & 19.72 \(\) 1.29 \\ \(\)-rMCL, 5 hyp. & **8.64 \(\) 1.03** & **22.82 \(\) 2.12** & 32.47 \(\) 1.97 & 6.08 \(\) 0.91 & 18.39 \(\) 2.07 & 26.92 \(\) 1.94 \\   

Table 3: **Combining proposed rMCL with other WTA variants**. Average scores (\(\) standard deviation) for source localization in anechoic (top) and reverberant (bottom) conditions.

distributions. In the case of the EMD metric applied to multimodal distributions, we observe that multiple hypothesis models improve the results, but excessively increasing the number of hypotheses may marginally degrade performances. A further study could examine this phenomenon in detail, which may be related to the expressive power of the hypothesis heads or the accumulation of errors in score heads predictions.

## 5 Discussion and limitations

In the audio experiments, the performance of rMCL was found to be affected by the number of hypotheses to tune depending on the complexity of the dataset. Moreover, as with the other variants of WTA, fixing the overconfidence issue with rMCL slightly degrades the performance of the best hypothesis (oracle error) for a reason that is yet to be determined. Otherwise, while \(\)-WTA behaves as expected with rMCL, trading off the quality of the best hypotheses for overall performance, top-\(n\)-WTA does not exhibit the same behavior. This discrepancy warrants further investigation.

The probabilistic interpretation of rMCL, as presented in Algorithm 1 and in Sec. 3.3, states that the different hypotheses would be organized in an optimal partition of the output space, forming a Voronoi tessellation. Ideally, each hypothesis would capture a region of the distribution, and the scores representing how likely this zone would activate in a given context. This interpretation remains theoretically valid whenever train and test examples are sampled from the same joint distribution \(p(,)\). However, in realistic settings, the hypotheses might not adhere to meaningful regions, but this could be controlled and evaluated, provided that an external validation dataset is available. In future work, we intend to use calibration techniques  to identify and alleviate these issues.

To sum up, this paper proposes a new Multiple Choice Learning variant, suitable for tackling the MCL overconfidence problem in regression settings. Our method is based on a learned scoring scheme that handles situations where a set of targets is available for each input. Furthermore, we propose a probabilistic interpretation of the model, and we illustrate its relevance with an evaluation on synthetic data. Its practical usefulness is also demonstrated in the context of point-wise sound source localization. Further work could include a specific study about the specialization of the predictors, and the validation of the proposed algorithm in increasingly complex real-world datasets.