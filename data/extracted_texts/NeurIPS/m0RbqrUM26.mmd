# StyleTTS 2: Towards Human-Level Text-to-Speech through Style Diffusion and Adversarial Training with Large Speech Language Models

StyleTTS 2: Towards Human-Level Text-to-Speech through Style Diffusion and Adversarial Training with Large Speech Language Models

 Yinghao Aaron Li Cong Han Vinay S. Raghavan

Gavin Mischler Nima Mesgarani

Columbia University

{yl4579,ch3212,vsr2119,gm2944,nm2764}@columbia.edu

###### Abstract

In this paper, we present StyleTTS 2, a text-to-speech (TTS) model that leverages style diffusion and adversarial training with large speech language models (SLMs) to achieve human-level TTS synthesis. StyleTTS 2 differs from its predecessor by modeling styles as a latent random variable through diffusion models to generate the most suitable style for the text without requiring reference speech, achieving efficient latent diffusion while benefiting from the diverse speech synthesis offered by diffusion models. Furthermore, we employ large pre-trained SLMs, such as WavLM, as discriminators with our novel differentiable duration modeling for end-to-end training, resulting in improved speech naturalness. StyleTTS 2 surpasses human recordings on the single-speaker LJSpeech dataset and matches it on the multispeaker VCTK dataset as judged by native English speakers. Moreover, when trained on the LibriTTS dataset, our model outperforms previous publicly available models for zero-shot speaker adaptation. This work achieves the first human-level TTS on both single and multispeaker datasets, showcasing the potential of style diffusion and adversarial training with large SLMs. The audio demos and source code are available at https://stylefts2.github.io/.

## 1 Introduction

Text-to-speech (TTS) synthesis has seen significant advancements in recent years, with numerous applications such as virtual assistants, audiobooks, and voice-over narration benefiting from increasingly natural and expressive synthetic speech [1; 2]. Some previous works have made significant progress towards human-level performance [3; 4; 5]. However, the quest for robust and accessible human-level TTS synthesis remains an ongoing challenge because there is still room for improvement in terms of diverse and expressive speech [5; 6], robustness for out-of-distribution (OOD) texts , and the requirements of massive datasets for high-performing zero-shot TTS systems .

In this paper, we introduce StyleTTS 2, an innovative TTS model that builds upon the style-based generative model StyleTTS  to present the next step towards human-level TTS systems. We model speech styles as a latent random variable and sample them with a probabilistic diffusion model, allowing the model to efficiently synthesize highly realistic speech without the need for reference audio. Since it only needs to sample a style vector instead of the entire speech as a latent variable, StyleTTS 2 is faster than other diffusion TTS models while still benefiting from the diverse speech synthesis enabled by diffusion models. One of the key contributions of StyleTTS 2 is the use of large pre-trained speech language models (SLMs) like Wav2Vec 2.0 , HuBERT , and WavLM  as discriminators, in conjunction with a novel differentiable duration modeling approach. This end-to-end (E2E) training setup leverages SLM representations to enhance the naturalness of the synthesized speech, transferring knowledge from large SLMs for speech generation tasks.

Our evaluations suggest that speech generated by StyleTTS 2 surpasses human recordings as judged by native English speakers on the benchmark LJSpeech  dataset with statistically significant comparative mean opinion scores (CMOS) of \(+0.28\)\((p<0.05)\). Additionally, StyleTTS 2 advances the state-of-the-art by achieving a CMOS of \(+1.07\)\((p 0.01)\) compared to NaturalSpeech . Furthermore, it attains human-level performance on the multispeaker VCTK dataset  in terms of naturalness (CMOS = \(-0.02\), \(p 0.05\)) and similarity (CMOS = \(+0.30\), \(p<0.1\)) to the reference speaker. When trained on a large number of speakers like the LibriTTS dataset , StyleTTS 2 demonstrates potential for speaker adaptation. It surpasses previous publicly available models in this task and outperforms Vall-E  in naturalness. Moreover, it achieves slightly worse similarity to the target speaker with only a 3-second reference speech, despite using around 250 times less data compared to Vall-E, making it a data-efficient alternative for large pre-training in the zero-shot speaker adaptation task. As the first model to achieve human-level performance on publicly available single and multispeaker datasets, StyleTTS 2 sets a new benchmark for TTS synthesis, highlighting the potential of style diffusion and adversarial training with SLMs for human-level TTS synthesis.

## 2 Related Work

**Diffusion Models for Speech Synthesis.** Diffusion models have gained traction in speech synthesis due to their potential for diverse speech sampling and fine-grained speech control . They have been applied to mel-based text-to-speech [16; 17; 18; 19; 20], mel-to-waveform vocoder [21; 22; 23; 24; 25; 26], and end-to-end speech generation [27; 28; 29]. However, their efficiency is limited compared to non-iterative methods, like GAN-based models [30; 31; 32], due to the need to iteratively sample mel-spectrograms, waveforms, or other latent representations proportional to the target speech duration . Furthermore, recent works suggest that state-of-the-art GAN-based models still perform better than diffusion models in speech synthesis [26; 33]. To address these limitations, we introduce style diffusion, where a fixed-length style vector is sampled by a diffusion model conditioned on the input text. This approach significantly improves model speed and enables end-to-end training. Notably, StyleTTS 2 synthesizes speech using GAN-based models, with only the style vector dictating the diversity of speech sampled. This unique combination allows StyleTTS 2 to achieve high-quality synthesis with fast inference speed while maintaining the benefits of diverse speech generation, further advancing the capabilities of diffusion models in speech synthesis.

**Text-to-Speech with Large Speech Language Models.** Recent advancements have proven the effectiveness of large-scale self-supervised speech language models (SLMs) in enhancing text-to-speech (TTS) quality [34; 35; 36; 37] and speaker adaptation [8; 38; 29; 39]. These works typically convert text input into either continuous or quantized representations derived from pre-trained SLMs for speech reconstruction. However, SLM features are not directly optimized for speech synthesis, while tuning SLMs as a neural codec [34; 35; 8; 29] involves two-stage training. In contrast, our model benefits from the knowledge of large SLMs via adversarial training using SLM features without latent space mapping, thus directly learning a latent space optimized for speech synthesis like other end-to-end (E2E) TTS models. This innovative approach signifies a new direction in TTS with SLMs.

**Human-Level Text-to-Speech.** Several recent works have advanced towards human-level TTS [3; 4; 5] using techniques like BERT pre-training [4; 40; 7] and E2E training [32; 5] with differentiable duration modeling [41; 42]. VITS  demonstrates MOS comparable to human recordings on the LJSpeech and VCTK datasets, while PnG-BERT  obtains human-level results on a proprietary dataset. NaturalSpeech , in particular, achieves both MOS and CMOS on LJSpeech statistically indistinguishable from human recordings. However, we find that there is still room for improvement in speech quality beyond these state-of-the-art models, as we attain higher performance and set a new standard for human-level TTS synthesis. Furthermore, recent work shows the necessity for disclosing the details of evaluation procedures for TTS research . Our evaluation procedures are detailed in Appendix E, which can be used for reproducible future research toward human-level TTS.

## 3 Methods

### StyleTTS Overview

StyleTTS  is a non-autoregressive TTS framework using a style encoder to derive a style vector from reference audio, enabling natural and expressive speech generation. The style vector is incorporated into the decoder and duration and prosody predictors using adaptive instance normalization (AdaIN) , allowing the model to generate speech with varying duration, prosody, and emotions.

The model comprises eight modules, organized into three categories: (1) a speech generation system (acoustic modules) with a text encoder, style encoder, and speech decoder; (2) a TTS prediction system with duration and prosody predictors; and (3) a utility system for training, including a discriminator, text aligner, and pitch extractor. It undergoes a two-stage training process: the first stage trains the acoustic modules for mel-spectrogram reconstruction, and the second trains TTS prediction modules using the fixed acoustic modules trained in the first stage.

In the first stage, the text encoder \(T\) encodes input phonemes \(\) into phoneme representations \(_{}=T()\), while the text aligner \(A\) extracts speech-phoneme alignment \(_{}=A(,)\) from input speech \(\) and phonemes \(\) to produce aligned phoneme representations \(_{}=_{}_{}\) via dot product. Concurrently, the style encoder \(E\) obtains the style vector \(=E()\), and the pitch extractor \(F\) extracts the pitch curve \(p_{}=F()\) along with its energy \(n_{}=\|\|\). Lastly, the speech decoder \(G\) reconstructs \(}=G(_{},,p_{},n_{})\), which is trained to match input \(\) using a \(L_{1}\) reconstruction loss \(_{}\) and adversarial objectives \(_{}\), \(_{}\) with a discriminator \(D\). Transferable monotonic aligner (TMA) objectives are also applied to learn optimal alignments (see Appendix G for details).

In the second stage, all components except the discriminator \(D\) are fixed, with only the duration and prosody predictors being trained. The duration predictor \(S\) predicts the phoneme duration with \(_{}=S(_{},)\), whereas the prosody predictor \(P\) predicts pitch and energy as \(_{},_{}=P(_{},)\). The predicted duration is trained to match the ground truth duration \(_{}\) derived from the summed monotonic version of the alignment \(_{}\) along the time axis with an \(L_{1}\) loss \(_{}\). The predicted pitch \(_{}\) and energy \(_{}\) are trained to match the ground truth pitch \(p_{}\) and energy \(n_{}\) derived from pitch extractor \(F\) with \(L_{1}\) loss \(_{f0}\) and \(_{n}\). During inference, \(_{}\) is used to upsample \(_{}\) through \(_{}\), the predicted alignment, obtained by repeating the value 1 for \(_{}[i]\) times at \(_{i-1}\), where \(_{i}\) is the end position of the \(i^{}\) phoneme \(_{i}\) calculated by summing \(_{}[k]\) for \(k\{1,,i\}\), and \(_{}[i]\) are the predicted duration of \(_{i}\). The mel-spectrogram is synthesized by \(_{}=G(_{}_{},E(}),_{}},_{}})\) with \(}\) an arbitrary reference audio that influences the style of \(_{}\), which is then converted into a waveform using a pre-trained vocoder.

Despite its state-of-the-art performance in synthesizing diverse and controllable speech, StyleTTS has several drawbacks, such as a two-stage training process with an additional vocoding stage that degrades sample quality, limited expressiveness due to deterministic generation, and reliance on reference speech hindering real-time applications.

### StyleTTS 2

StyleTTS 2 improves upon the StyleTTS framework, resulting in a more expressive text-to-speech (TTS) synthesis model with human-level quality and improved out-of-distribution performance. We introduce an end-to-end (E2E) training process that jointly optimizes all components, along with direct waveform synthesis and adversarial training with large speech language models (SLMs) enabled by our innovative differentiable duration modeling. The speech style is modeled as a latent variable sampled through diffusion models, allowing diverse speech generation without reference audio. We outline these important changes in the following sections with an overview in Figure 1.

#### 3.2.1 End-to-End Training

E2E training optimizes all TTS system components for inference without relying on any fixed components like pre-trained vocoders that convert mel-spectrograms into waveforms [3; 32]. To achieve this, we modify the decoder \(G\) to directly generate the waveform from the style vector, aligned phoneme representations, and pitch and energy curves. We remove the last projection layer for mel-spectrograms of the decoder and append a waveform decoder after it. We propose two types of decoders: HifiGAN-based and iSTFTNet-based. The first is based on Hifi-GAN , which directly generates the waveform. In contrast, the iSTFTNet-based decoder  produces magnitude and phase, which are converted into waveforms using inverse short-time Fourier transform for faster training and inference. We employ the snake activation function , proven effective for waveform generation in . An AdaIN module  is added after each activation function to model the style dependence of the speech, similar to the original StyleTTS decoder. We replace the mel-discriminator in  with the multi-period discriminator (MPD)  and multi-resolution discriminator (MRD) along with the LSGAN loss functions  for decoder training, and incorporate the truncated pointwise relativistic loss function  to enhance sound quality (see Appendix F and G for details).

We found that well-trained acoustic modules, especially the style encoder, can accelerate the training process for TTS prediction modules. Therefore, before jointly optimizing all components, we first pre-train the acoustic modules along with the pitch extractor and text aligner via \(_{},_{},_{}\) and TMA objectives for \(N\) epochs where \(N\) depends on the size of the training set, in the same way as the first training stage of . However, we note that this pre-training is not an absolute necessity: despite being slower, starting joint training directly from scratch also leads to model convergence,

After acoustic module pre-training, we jointly optimize \(_{},_{},_{}, _{},_{}\) and \(_{}\), where \(_{}\) is modified to match the mel-spectrograms of waveforms reconstructed from predicted pitch \(_{}\) and energy \(_{}\) (Fig 1a). During joint training, stability issues emerge from diverging gradients, as the style encoder must encode both acoustic and prosodic information. To address this inconsistency, we introduce a _prosodic_ style encoder \(E_{p}\) alongside the original _acoustic_ style encoder \(E_{a}\), previously denoted as \(E\) in section 3.1. Instead of using \(_{a}=E_{a}()\), predictors \(S\) and \(P\) take \(_{p}=E_{p}()\) as the input style vector. The style diffusion model generates the augmented style vector \(=[_{p},_{a}]\). This modification effectively improves sample quality (see section 5.3). To further decouple the acoustic modules and predictors, we replace the phoneme representations \(_{}\) from \(T\), now referred to as _acoustic_ text encoder, with \(_{}\) from another text encoder \(B\) based on BERT transformers, denoted as _prosodic_ text encoder. Specifically, we employ a phoneme-level BERT  pre-trained on extensive corpora of Wikipedia articles as the prosodic text encoder. This approach has been shown to enhance the naturalness of StyleTTS in the second stage , similar to our proposed usage here.

Figure 1: Training and inference scheme of StyleTTS 2 for the single-speaker case. For the multi-speaker case, the acoustic and prosodic style encoders (denoted as \(\)) first take reference audio \(_{}\) of the target speaker and produce a reference style vector \(=(_{})\). The style diffusion model then takes \(\) as a reference to sample \(_{p}\) and \(_{a}\) that correspond to the speaker in \(_{}\).

With differentiable upsampling and fast style diffusion, we can generate speech samples during training in a fully differentiable manner, just as during inference. These samples are used to optimize \(_{slm}\) (eq. 5) during joint training to update the parameters of all components for inference (Fig 0(b)).

#### 3.2.2 Style Diffusion

In StyleTTS 2, we model the speech \(\) as a conditional distribution \(p(|)= p(|,)p(|)\,d\) through a latent variable \(\) that follows the distribution \(p(|)\). We call this variable the _generalized speech style_, representing any characteristic in speech beyond phonetic content \(\), including but not limited to prosody, lexical stress, formant transitions, and speaking rate . We sample \(\) by EDM  that follows the combined probability flow  and time-varying Langevin dynamics :

\[=-()[()()+()] _{} p_{}(|)\,d+ ()\,d_{},\] (1)

where \(()\) is the noise level schedule and \(()\) is its time derivative, \(()\) is the stochasticity term, \(_{}\) is the backward Wiener process for \([T,0]\) and \(_{} p_{}(|)\) is the score function at time \(\).

We follow the EDM  formulation with the denoiser \(K(;,)\) preconditioned as:

\[K(;,):=(}}{^{}} )^{2}+}}{^{}} V (}{^{}};,),\] (2)

where \(\) follows a log-normal distribution \((P_{},P_{}^{2})\) with \(P_{}=-1.2\), \(P_{}=1.2\), \(^{}:=+_{}^{2}}\) is the scaling term, \(_{}=0.2\) is the empirical estimate of the standard deviation of style vectors, and \(V\) is a 3-layer transformer  conditioned on \(\) and \(\) which is trained with:

\[_{}=_{,,, (0,I)}[()\|K(()+; ,)-()\|_{2}^{2}],\] (3)

where \(():=[E_{a}(),E_{p}()]\), and \(():=(^{}/(_{})) ^{2}\) is the weighting factor. Under this framework, equation 16 becomes an ODE where the score function depends on \(\) instead of \(\):

\[}{d}=-_{} p_{}(|)= -K(;,)}{},\ \ \ \ \ ((T))(0,(T)^{2}I).\] (4)

Unlike  that uses 2nd-order Heun, we solve eq. 4 with the ancestral DPM-2 solver  for fast and diverse sampling as we demand speed more than accuracy. On the other hand, we use the same scheduler as in  with \(_{}=0.0001,_{}=3\) and \(=9\). This combination allows us to sample a style vector for high-quality speech synthesis with only three steps, equivalent to running a 9-layer transformer model, minimally impacting the inference speed (see Appendix B for more discussions).

\(V\) conditions on \(\) through \(_{}\) concatenated with the noisy input \(()+\), and \(\) is conditioned via sinusoidal positional embeddings . In the multispeaker setting, we model \(p(|,)\) by \(K(;,,)\) with an additional speaker embedding \(=(_{})\) where \(_{}\) is the reference audio of the target speaker. The speaker embedding \(\) is injected into \(V\) by adaptive layer normalization .

#### 3.2.3 SLM Discriminators

Speech language models (SLMs) encode valuable information ranging from acoustic to semantic aspects , and SLM representations are shown to mimic human perception for evaluating synthesized speech quality . We uniquely transfer knowledge from SLM encoders to generative tasks via adversarial training by employing a 12-layer WavLM  pre-trained on 94k hours of data 1 as the discriminator. As the number of parameters of WavLM is greater than StyleTTS 2, to avoid discriminator overpowering, we fix the pre-trained WavLM model \(W\) and append a convolutional neural network (CNN) \(C\) as the discriminative head. We denote the SLM discriminator \(D_{SLM}=C W\). The input audios are downsampled to 16 kHz before being fed into \(D_{SLM}\) to match that of WavLM. \(C\) pools features \(_{}=W()\) from all layers with a linear map from \(13 768\) to 256 channels. We train the generator components (\(T,B,G,S,P,V\), denoted as \(\)) and \(D_{SLM}\) to optimize:

\[_{slm}=_{}_{D_{SLM}}(_{}[ D_{ SLM}()]+_{}[(1-D_{SLM}(())) ]),\] (5)where \(()\) is the generated speech with text \(\), and \(\) is the human recording.  shows that:

\[D^{*}_{SLM}()=_{W}()}{ _{W}()+_{W}()},\] (6)

where \(D^{*}_{SLM}()\) is the optimal discriminator, \(\) and \(\) represent true and generated data distributions, while \(_{}\) and \(_{}\) are their respective densities. The optimal \(^{*}\) is achieved if \(_{W}=_{W}\), meaning that when converged, \(^{*}\) matches the generated and true distributions in the SLM representation space, effectively mimicking human perception to achieve human-like speech synthesis.

In equation 5, the generator loss is independent of ground truth \(\) and relies only on input text \(\). This enables training on out-of-distribution (OOD) texts, which we show in section 5.3 can improve the performance on OOD texts. In practice, to prevent \(D_{SLM}\) from over-fitting on the content of the speech, we sample in-distribution and OOD texts with equal probability during training.

#### 3.2.4 Differentiable Duration Modeling

The duration predictor produces phoneme durations \(_{}\), but the upsampling method described in section 3.1 to obtain \(_{}\) is not differentiable, blocking gradient flow for E2E training. NaturalSpeech  employs an attention-based upsampler  for human-level TTS. However, we find this approach unstable during adversarial training because we train our model using differentiable upsampling with only the adversarial objective described in eq. 5 and without extra loss terms due to the length mismatch caused by deviations of \(_{}\) from \(_{}\). Although this mismatch can be mitigated with soft dynamic time warping as used in , we find this approach both computationally expensive and unstable with mel-reconstruction and adversarial objectives. To achieve human-level performance with adversarial training, a non-parametric upsampling method is preferred for stable training.

Gaussian upsampling  is non-parametric and converts the predicted duration \(_{}\) into \(_{}[n,i]\) using a Gaussian kernel \(_{c_{i}}(n;)\) centered at \(c_{i}:=_{i}-_{}[i]\) with the hyperparameter \(\):

\[_{c_{i}}(n;):=(-)^{2}}{2 ^{2}}),)}_{i}: =_{k=1}^{i}_{}[k],\] (8)

where \(_{i}\) is the end position and \(c_{i}\) is the center position of the \(i^{}\) phoneme \(_{i}\). However, Gaussian upsampling has limitations due to its fixed width of Gaussian kernels determined by \(\). This constraint prevents it from accurately modeling alignments with varying lengths depending on \(_{}\). Non-attentive Tacotron  extends this by making \(_{i}\) trainable, but the trained parameters introduce instability for E2E training with adversarial loss, similar to issues of attention-based upsamplers.

We propose a new non-parametric differentiable upsampler without additional training while taking into account the varying length of the alignment. For each phoneme \(_{i}\), we model the alignment as a random variable \(a_{i}\), indicating the index of the speech frame the phoneme \(_{i}\) is aligned with. We define the duration of the \(i^{}\) phoneme as another random variable \(d_{i}\{1,,L\}\), where \(L=50\) is the maximum phoneme duration hyperparameter, equivalent to 1.25 seconds in our setting. We observe that \(a_{i}=_{k=1}^{i}d_{k}\), but each \(d_{k}\) is dependent on each other, making the sum difficult to model. Instead, we approximate \(a_{i}=d_{i}+_{i-1}\). The approximated probability mass function (PMF) of \(a_{i}\) is

\[f_{a_{i}}[n]=f_{d_{i}+_{i-1}}[n]=f_{d_{i}}[n]*f_{_{i-1}}[n]= _{k}f_{d_{i}}[k]_{_{i-1}}[n-k],\] (9)

where \(_{_{i-1}}\) is the PMF of \(_{i-1}\), a constant defined in eq. 8. This delta function is not differentiable, so we replace it with \(_{_{i-1}}\) defined in eq. 7 with \(=1.5\) (see Appendix C.2 for more discussions).

To model \(f_{d_{i}}\), we modify the duration predictor to output \(q[k,i]\), the probability of the \(i^{}\) phoneme having a duration of at least \(k\) for \(k\{1,,L\}\), optimized to be 1 when \(_{} k\) with the cross-entropy loss (see Appendix G). Under this new scheme, we can approximate \(_{}[i]:=_{k=1}^{L}q[k,i]\), trained to match \(_{}\) with \(_{}\) as in section 3.1. The vector \(q[:,i]\) can be viewed as the unnormalized version of \(f_{d_{i}}\), though it is trained to be uniformly distributed across the interval \([1,d_{i}]\). Since the number of speech frames \(M\) is usually larger than the number of input phonemes \(N\), this uniform distribution aligns single phonemes to multiple speech frames as desired. Finally, we normalize the differentiable approximation \(_{a_{i}}[n]\) across the phoneme axis, as in , to obtain \(_{}\) using the softmax function:

\[_{}[n,i]:=_{a_{i}}[n]))}}{ _{i=1}^{N}e^{(_{a_{i}}[n])}},)}_{a_{i}}[n]:=_{k=0}^{}q[n,i] _{_{i-1}}(n-k;),\] (11)

where \(:=_{N}\) is the predicted total duration of the speech and \(n\{1,,\}\). An illustration of our proposed differentiable duration modeling is given in Figure 4 (Appendix C).

## 4 Experiments

### Model Training

We performed experiments on three datasets: LJSpeech, VCTK, and LibriTTS. Our single-speaker model was trained on the LJSpeech dataset, consisting of 13,100 short audio clips totaling roughly 24 hours. This dataset was divided into training (12,500 samples), validation (100 samples), and testing (500 samples) sets, with the same split as [3; 5; 6]. The multispeaker model was trained on VCTK, comprising nearly 44,000 short clips from 109 native speakers with various accents. The data split was the same as , with 43,470 samples for training, 100 for validation, and 500 for testing. Lastly, we trained our model on the combined LibriTTS _train-clean-460_ subset  for zero-shot adaptation. This dataset contains about 245 hours of audio from 1,151 speakers. Utterances longer than 30 seconds or shorter than one second were excluded. We distributed this dataset into training (98%), validation (1%), and testing (1%) sets, in line with . The _test-clean_ subset was used for zero-shot adaptation evaluation with 3-second reference clips. All datasets were resampled to 24 kHz to match LibriTTS, and the texts were converted into phonemes using phonemizer .

We used texts in the training split of LibriTTS as the out-of-distribution (OOD) texts for SLM adversarial training. We used iSTFTNet decoder for LJSpeech due to its speed and sufficient performance on this dataset, while the HifiGAN decoder was used for the VCTK and LibriTTS models. Acoustic modules were pre-trained for 100, 50, and 30 epochs on the LJSpeech, VCTK, and LibriTTS datasets, and joint training followed for 60, 40, and 25 epochs, respectively. We employed the AdamW optimizer  with \(_{1}=0,_{2}=0.99\), weight decay \(=10^{-4}\), learning rate \(=10^{-4}\) and a batch size of 16 samples for both pre-training and joint training. The loss weights were adopted from  to balance all loss terms (see Appendix G for details). Waveforms were randomly segmented with a max length of 3 seconds. For SLM adversarial training, both the ground truth and generated samples were ensured to be 3 to 6 seconds in duration, the same as in fine-tuning of WavLM models for various downstream tasks . Style diffusion steps were randomly sampled from 3 to 5 during training for speed and set to 5 during inference for quality. The training was conducted on four NVIDIA A40 GPUs.

### Evaluations

We employed two metrics in our experiments: Mean Opinion Score of Naturalness (MOS-N) for human-likeness, and Mean Opinion Score of Similarity (MOS-S) for similarity to the reference for multi-speaker models. These evaluations were conducted by native English speakers from the U.S. on Amazon Mechanical Turk. All evaluators reported normal hearing and provided informed consent as monitored by the local institutional review board and in accordance with the ethical standards of the Declaration of Helsinki 2. In each test, 80 random text samples from the test set were selected and converted into speech using our model and the baseline models, along with ground truth for comparison. Because  reported that many TTS models perform poorly for OOD texts, our LJSpeech experiments also included 40 utterances from Librirox spoken by the narrator of LJSpeech but from audiobooks not in the original dataset as the ground truth for OOD texts. To compare the difference between in-distribution and OOD performance, we asked the same raters to evaluate samples on both in-distribution and OOD texts.

Our baseline models consisted of the three highest-performing public models: VITS , StyleTTS , and JETS  for LJSpeech; and VITS, YourTTS , and StyleTTS for LibriTTS. Each synthesizedspeech set was rated by 5 to 10 evaluators on a 1-5 scale, with increments of 0.5. We randomized the model order and kept their labels hidden, similar to the MUSHRA approach . We also conducted Comparative MOS (CMOS) tests to determine statistical significance, as raters can ignore subtle differences in MOS experiments . Raters were asked to listen to two samples and rate whether the second was better or worse than the first on a -6 to 6 scale with increments of 1. We compared our model to the ground truth and NaturalSpeech  for LJSpeech, and the ground truth and VITS for VCTK. For the zero-shot experiment, we compared our LibriTTS model to Vall-E .

All baseline models, except for the publicly available VITS model on LibriTTS from ESPNet Toolkit , were official checkpoints released by the authors, including vocoders used in StyleTTS. As NaturalSpeech and Vall-E are not publicly available, we obtained samples from the authors and the official Vall-E demo page, respectively. For fairness, we resampled all audio to 22.5 kHz for LJSpeech and VCTK, and 16 kHz for LibriTTS, to match the baseline models. We conducted ablation studies using CMOS-N on LJSpeech on OOD texts from LibriTTS _test-clean_ subset for more pronounced results as in . For more details of our evaluation procedures, please see Appendix E.

## 5 Results

### Model Performance

The results outlined in Table 1 establish that StyleTTS 2 outperforms NaturalSpeech by achieving a CMOS of \(+1.07\)\((p 0.01)\), setting a new standard for this dataset. Interestingly, StyleTTS 2 was favored over the ground truth with a CMOS of \(+0.28\) (\(p<0.05\)). This preference may stem from dataset artifacts such as fragmented audiobook passages in the LJSpeech dataset that disrupt narrative continuity, thus rendering the ground truth narration seemingly unnatural. This hypothesis is corroborated by the performance of StyleTTS 2 on the VCTK dataset, which lacks narrative context, where it performs comparably to the ground truth (CMOS = \(-0.02,p 0.05\)). Samples from our model were more similar to the reference audio speaker than the human recording, suggesting our model's effective use of the reference audio for style diffusion. Moreover, StyleTTS 2 scored higher than the previous state-of-the-art model VITS on VCTK, as evidenced by CMOS-N and CMOS-S.

Consistent with the CMOS results, our model achieved a MOS of 3.83, surpassing all previous models on LJSpeech (Table 2). In addition, all models, except ours, exhibited some degrees of quality degradation for out-of-distribution (OOD) texts. This corroborates the gap reported in , with our results providing additional ground truth references. On the other hand, our model did not show any degradation and significantly outperformed other models in MOS for OOD texts (Table 2), demonstrating its strong generalization ability and robustness towards OOD texts.

In zero-shot tests, StyleTTS 2 surpasses Vall-E in naturalness with a CMOS of \(+0.67\)\((p 0.01)\), although it falls slightly short in similarity (Table 1). Importantly, StyleTTS 2 achieved these results with only 245 hours of training data, compared to Vall-E's 60k hours, a 250x difference. This makes StyleTTS 2 a data-efficient alternative to large pre-training methods like Vall-E. The MOS results in Table 3 support these findings, as our model exceeds all baseline models in both MOS-N and MOS-S. However, the difference in

   Model & Dataset & CMOS-N (p-value) & CMOS-S (p-value) \\  Ground Truth & LJSpeech & **+0.28**\((p=0.021)\) & — \\ NaturalSpeech & LJSpeech & **+1.07**\((p<10^{-6})\) & — \\  Ground Truth & VCTK & \(-0.02\)\((p=0.628)\) & **+0.30**\((p=0.081)\) \\ VITS & VCTK & **+0.45**\((p=0.009)\) & **+0.43**\((p=0.032)\) \\  Vall-E & LibriSpeech (zero-shot) & **+0.67**\((p<10^{-3})\) & \(-0.47\)\((p<10^{-3})\) \\   

Table 1: Comparative mean opinion scores of naturalness and similarity for StyleTTS 2 with p-values from Wilcoxon test relative to other models. Positive scores indicate StyleTTS 2 is better.

   Model & MOS\({}_{}\) (CI) & MOS\({}_{}\) (CI) \\  Ground Truth & 3.81 (\(\) 0.09) & 3.70 (\(\) 0.11) \\ StyleTTS 2 & **3.83** (\(\) **0.08**) & **3.87** (\(\) **0.08**) \\ JETS & 3.57 (\(\) 0.09) & 3.21 (\(\) 0.12) \\ VITS & 3.34 (\(\) 0.10) & 3.21 (\(\) 0.11) \\ StyleTTS + HifiGAN & 3.35 (\(\) 0.10) & 3.32 (\(\) 0.12) \\   

Table 2: Comparison of MOS with 95% confidence intervals (CI) on LJSpeech. MOS\({}_{}\) represents MOS-N for in-distribution texts, while MOS\({}_{}\) is that for OOD texts.

[MISSING_PAGE_FAIL:9]

Table 5 details the ablation study, underlying the importance of our proposed components. When style vectors from style diffusion are substituted with randomly encoded ones as in , the CMOS is \(-0.46\), highlighting the contribution of text-dependent style diffusion to achieving human-level TTS. Training without our differentiable upsampler and without the SLM discriminator results in a CMOS of \(-0.21\) and \(-0.32\), validating their key roles in natural speech synthesis. Removing the prosodic style encoder also yields a \(-0.35\) CMOS. Last, excluding OOD texts from adversarial training leads to a CMOS of \(-0.15\), proving its efficacy for improving OOD speech synthesis. Table 6 in Appendix A.3 shows similar outcomes with objective evaluations, further affirming the effectiveness of various components we proposed in this work. Figure 7 in Appendix D details a layer-wise analysis of input weights of the SLM discriminator, providing a different view of the efficacy of SLM discriminators.

## 6 Conclusions and Limitations

In this study, we present StyleTTS 2, a novel text-to-speech (TTS) model with human-level performance via style diffusion and speech language model discriminators. In particular, it exceeds the ground truth on LJSpeech and performs on par with it on the VCTK dataset. StyleTTS 2 also shows potential for zero-shot speaker adaption, with remarkable performance even on limited training data compared to large-scale models like Vall-E. With our innovative style diffusion method, StyleTTS 2 generates expressive and diverse speech of superior quality while ensuring fast inference time. While StyleTTS 2 excels in several areas, our results indicate room for improvement in handling large-scale datasets such as LibriTTS, which contain thousands of or more speakers, acoustic environments, accents, and other various aspects of speaking styles. The speaker similarity in the aforementioned zero-shot adaptation speaker task could also benefit from further improvements.

However, zero-shot speaker adaptation has the potential for misuse and deception by mimicking the voices of individuals as a potential source of misinformation or disinformation. This could lead to harmful, deceptive interactions such as theft, fraud, harassment, or impersonations of public figures that may influence political processes or trust in institutions. In order to manage the potential for harm, we will require users of our model to adhere to a code of conduct that will be clearly displayed as conditions for using the publicly available code and models. In particular, we will require users to inform those listening to samples synthesized by StyleTTS 2 that they are listening to synthesized speech or to obtain informed consent regarding the use of samples synthesized by StyleTTS 2 in experiments. Users will also be required to use reference speakers who have given consent to have their voice adapted, either directly or by license. Finally, we will make the source code publicly available for further research in speaker fraud and impersonation detection.

In addition, while human evaluators have favored StyleTTS 2 over ground truth with statistical significance on the LJSpeech dataset, this preference may be context-dependent. Original audio segments from larger contexts like audiobooks could inherently differ in naturalness when isolated, potentially skewing the evaluations in favor of synthesized speech. Additionally, the inherent variability in human speech, which is context-independent, might lead to lower ratings when compared to the more uniform output from StyleTTS 2. Future research should aim to improve evaluation methods to address these limitations and develop more natural and human-like speech synthesis models with longer context dependencies.

## 7 Acknowledgments

We thank Menoua Keshishian, Vishal Choudhari, and Xilin Jiang for helpful discussions and feedback on the paper. We also thank Grace Wilsey, Elden Griggs, Jacob Edwards, Rebecca Saez, Moises Rivera, Rawan Zayter, and D.M. for assessing the quality of synthesized samples and providing feedback on the quality of models during the development stage of this work. This work was funded by the national institute of health (NIHNIDCD) and a grant from Marie-Josee and Henry R. Kravis.