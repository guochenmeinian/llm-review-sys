# Bayesian Learning via \(Q\)-Exponential Process

Shuyi Li Michael O'Connor Shiwei Lan

_School of Mathematical & Statistical Sciences_

_Arizona State University, Tempe, AZ 85287_

slan@asu.edu

###### Abstract

Regularization is one of the most fundamental topics in optimization, statistics and machine learning. To get sparsity in estimating a parameter \(u^{d}\), an \(_{q}\) penalty term, \(\|u\|_{q}\), is usually added to the objective function. What is the probabilistic distribution corresponding to such \(_{q}\) penalty? What is the _correct_ stochastic process corresponding to \(\|u\|_{q}\) when we model functions \(u L^{q}\)? This is important for statistically modeling high-dimensional objects such as images, with penalty to preserve certain properties, e.g. edges in the image. In this work, we generalize the \(q\)-exponential distribution (with density proportional to) \((-|u|^{q})\) to a stochastic process named _q-exponential (Q-EP) process_ that corresponds to the \(L_{q}\) regularization of functions. The key step is to specify consistent multivariate \(q\)-exponential distributions by choosing from a large family of elliptic contour distributions. The work is closely related to Besov process which is usually defined in terms of series. Q-EP can be regarded as a definition of Besov process with explicit probabilistic formulation, direct control on the correlation strength, and tractable prediction formula. From the Bayesian perspective, Q-EP provides a flexible prior on functions with sharper penalty (\(q<2\)) than the commonly used Gaussian process (GP, \(q=2\)). We compare GP, Besov and Q-EP in modeling functional data, reconstructing images and solving inverse problems and demonstrate the advantage of our proposed methodology.

## 1 Introduction

Regularization on function spaces is one of the fundamental questions in statistics and machine learning. High-dimensional objects such as images can be viewed as discretized functions defined on 2d or 3d domains. Statistical models for these objects on function spaces demand regularization to induce sparsity, prevent over-fitting, produce meaningful reconstruction, etc. Gaussian process [GP 38, 24] has been widely used as an \(L_{2}\) penalty (negative log-density as a quadratic form) or a prior on the function space. Despite the flexibility, sometimes random candidate functions drawn from GP are over-smooth for modeling certain objects such as images with sharp edges. To address this issue, researchers have proposed a class of \(L_{1}\) penalty based priors including Laplace random field  and Besov process . They have been extensively applied in spatial modeling , signal processing , imaging analysis  and inverse problems . Figure 1 demonstrates an application of nonparametric regression models on functions endowed with GP, Besov and our proposed \(q\)-exponential process (Q-EP) priors respectively to reconstruct a blurry image of a satellite. Q-EP model generates the best reconstruction, indicating its advantage over GP in modeling objects with abrupt changes or sharp contrast such as "edges" in image.

For these high-dimensional (refer to its discretization) inhomogeneous objects on \(d^{*}\) domains \(D^{d^{*}}\), particularly 2d images with sharp edges (\(d^{*}=2\)), one can model them as a random function \(u\) from aBesov process represented by the following series for a given orthonormal basis \(\{_{}\}_{=1}^{}\) in \(L^{2}(D)\)[31; 15]:

\[u:D, u(x)=_{=1}^{}_{}u_{ }_{}(x), u_{}_{q}() (-||^{q})\] (1)

where \(q 1\) and \(_{}=^{--(}+- {1}{q})}\) with (inverse) variance \(>0\) and smoothness \(s>0\). When \(q=2\) and \(\{_{}\}\) is chosen to be Fourier basis, this reduces to GP  but Besov is often used with \(q=1\) and wavelet basis  to provide "edge-preserving" function candidates suitable for image analysis. Historically,  discovered that the total variation prior degenerates to GP prior as the discretization mesh becomes denser and thus loses the edge-preserving properties in high dimensional applications. Therefore,  proposed the Besov prior defined as in (1) and proved its discretization-invariant property. Though straightforward, such series definition lacks a direct way to specify the correlation structure as GP does through the covariance function. What is more, once the basis \(\{_{}\}\) is chosen, there is no natural way to make prediction with Besov process.

We propose a novel stochastic process named _q-exponential process (Q-EP)_ to address these issues. We start with the \(q\)-exponential distribution \(_{q}()\) and generalize it to a multivariate distribution (from a family of elliptic contour distributions) that is consistent to marginalization. Such consistency requires the joint distribution and the marginalized one (by any subset of components) to have the same format of density (See Section 3). We then generalize such multivariate \(q\)-exponential distribution to the process Q-EP and establish its connection and contrast to the Besov process. Note, if we view the negative log-density of the proposed distribution and process, Q-EP would impose an \(L_{q}\) regularization on the function space, similarly as \(L_{2}\) regularization given by GP whose negative log-density is a quadratic form of the input variable \(x\) (See Remark 2).

Connection to existing worksThe proposed Q-EP process is related to the student-\(t\) process (TP)  as alternatives to GP. TP generalizes multivariate \(t\)-distribution (MVT) and is derived as a scale mixture of GP. Both TP and Q-EP can be viewed as a special case of the elliptical process  which gives the condition on general elliptic distributions that can be generalized to a valid stochastic process. Both papers focus on extending GP to robust models for heavier tail data, while our proposed work innovates a new Bayesian learning method on function spaces through the regularization parameter \(q\) (See Figure 3 for its effect on regularization when it varies), as is usually done in the optimization. Both our proposed Q-EP and  are inspired by Kano's consistency result , however the later focuses on a completely different process named squeezebox process. Our work on Q-EP makes multi-fold contributions to the learning of functional data in statistics and machine learning:

1. We propose a novel stochastic process Q-EP corresponding to the \(L_{q}\) regularization on function spaces.
2. For the first time we define/derive Besov process probabilistically as Q-EP with direct ways to configure correlation and to make prediction.
3. We provide flexible Bayesian inference methods based on the Markov Chain Monte Carlo (MCMC) algorithms using a white-noise representation for Q-EP prior models.

The rest of the paper is organized as follows. Section 2 introduces the \(q\)-exponential distribution and its multivariate generalizations. We propose the Q-EP with details in Section 3 and introduce it as a nonparametric prior for modeling functional data. In Section 4 we demonstrate the advantage of Q-EP over GP and Besov in time series modeling, image reconstruction, and Bayesian inverse problems (Appendix C.4). Finally we discuss some future directions in Section 5.

Figure 1: Image of satellite: true image, blurred observation, and reconstructions by GP, Besov and Q-EP models with relative errors 75.19%, 21.94% and 20.35% respectively.

The \(Q\)-exponential distribution and its multivariate generalizations

Let us start with the \(q\)-exponential distribution for a scalar random variable \(u\). It is named in  and defined with the following density not in an exact form (as a probability density normalized to 1):

\[_{q}(u)|u|^{q})}.\] (2)

This \(q\)-exponential distribution (2) is actually a special case of the following _exponential power (EP)_ distribution \((,,q)\) with \(=0\), \(=1\):

\[p(u|,,q)=(1/q)}||^{q}\}}\] (3)

where \(\) denotes the gamma function. Note the parameter \(q>0\) in (3) controls the tail behavior of the distribution: the smaller \(q\) the heavier tail and vice versa. This distribution also includes many commonly used ones such as the normal distribution \((,^{2})\) for \(q=2\) and the Laplace distribution \(L(,b)\) with \(=2^{-1/q}b\) when \(q=1\).

How can we generalize it to a multivariate distribution and further to a stochastic process? Gomez  provided one possibility of a multivariate EP distribution, denoted as \(_{d}(,,q)\), with the following density:

\[p(|,,q)= )}{2()}2^{-} ^{-}||^{-}[(-)^{}^{-1}(-)]^{}\}}\] (4)

When \(q=2\), it reduces to the familiar multivariate normal (MVN) distribution \(_{d}(,)\).

Unfortunately, unlike MVN being the foundation of GP, the Gomez's EP distribution \(_{d}(,,q)\) fails to generalize to a valid stochastic process because it does not satisfy the marginalization consistency as MVN does (See Section 3 for more details). It turns out we need to seek candidates in an even larger family of _elliptic_ (contour) distributions \(_{d}(,,g)\):

**Definition 2.1** (Elliptic distribution).: _A multivariate elliptic distribution \(_{d}(,,g)\) has the following density _

\[p()=k_{d}||^{-}g(r), r()=( -)^{}^{-1}(- )\] (5)

_where \(k_{d}>0\) is the normalizing constant and \(g()\), a one-dimensional real-valued function independent of \(d\) and \(k_{d}\), is named density generating function ._

Every elliptic (contour) distributed random vector \(_{d}(,,g)\) has a stochastic representation mainly due to Schoenberg , as stated in the following theorem.

**Theorem 2.1**.: \(_{d}(,,g)\) _if and only if_

\[}{{=}}+RS\] (6)

_where \(S(^{d+1})\) uniformly distributed on the unit-sphere \(^{d+1}\), \(\) is the Cholesky factor of \(\) such that \(=^{}\), \(R S\) and \(R^{2}}{{=}}r() f(r)=}}{()}k_{d}r^{-1}g(r)\)._

The Gomez's EP distribution \(_{d}(,,q)\) is a special elliptic distribution \(_{d}(,,g)\) with \(g(r)=\{-r^{}\}\) and \(R^{q}(=,=)\). Not all elliptical distributions can be used to create a valid process . In the following, we will carefully choose the density generator \(g\) in \(_{d}(,,g)\) to define a consistent multivariate \(q\)-exponential distribution generalizable to a process appropriately.

## 3 The \(Q\)-exponential process

To generalize \(_{d}(,,g)\) to a valid stochastic process, we need to choose proper \(g\) such that the resulting distribution satisfies two conditions of Kolmogorov extension theorem :

**Theorem 3.1** (Kolmogorov's Extension).: _For all \(t_{1},,t_{k} T\), \(k\) let \(_{t_{1},,t_{k}}\) be probability measures on \(^{dk}\) satisfying_

\[(K1):&_{t_{(1)},,t_{ (k)}}(F_{1} F_{k})=_{t_{1},,t_{k}}(F_{ ^{-1}(1)} F_{^{-1}(k)})\, S(k)\\ (K2):&_{t_{1},,t_{k}}(F_{1} F _{k})=_{t_{1},,t_{k},t_{k+1},,t_{k+n}}(F_{1} F _{k}^{d}^{d})\,\,m \] (7)

_Then there exists a probability space \((,,P)\) and a stochastic process \(\{X_{t}\}\) on \(\), \(X_{t}:^{n}\) such that_

\[_{t_{1},,t_{k}}(F_{1} F_{k})=P[X_{t_{1}} F_{1}, ,X_{t_{k}} F_{k}]\] (8)

_for all \(t_{i} T\), \(k\) and all Borel sets \(F_{i}\). (K1) and (K2) are referred to as_ **exchangeability** _and_ **consistency** _conditions respectively._

As pointed out by Kano , the elliptic distribution \(_{d}(,,g)\) in the format of Gomez's EP distribution (4) with \(g(r)=\{-r^{}\}\) does not satisfy the consistency condition [also c.f. Proposition 5.1 of 23]. Figure 2 (left panel) also illustrates such inconsistency numerically. However, Kano's consistency theorem  suggests a different viable choice of \(g\) to make a valid generalization of \(_{d}(,,g)\) to a stochastic process :

**Theorem 3.2** (Kano's Consistency).: _An elliptic distribution is consistent if and only if its density generator function, \(g()\), has the following form_

\[g(r)=_{0}^{}^{} -}\,p(s)ds\] (9)

_where \(p(s)\) is a strictly positive mixing distribution independent of \(d\) and \(p(s=0)=0\)._

### Consistent Multivariate \(Q\)-exponential Distribution

In the above theorem 3.2, if we choose \(p(s)=_{r^{-1}}(s)\), then we have \(g(r)=r^{(-1)}\{- }}{2}\}\), which leads to the following consistent _multivariate \(q\)-exponential distribution \(-_{d}(,)\)_.

**Definition 3.1**.: _A multivariate \(q\)-exponential distribution, denoted as \(-_{d}(,)\), has the following density_

\[p(|,,q)=(2)^{-}| |^{-[-1) }}{2}]}\{-}}{2}\}, r() =(-)^{}^{-1}(- )\] (10)

**Remark 1**.: _When \(q=2\), \(-_{d}(,)\) reduces to MVN \(_{d}(,)\). When \(d=1\), if we let \(C=1\), then we have the density for \(u\) as \(p(u)|u|^{-1}\{-|u|^{q}\}\), differing from the original un-normalized density \(_{q}\) in (2) by a term \(|u|^{-1}\). This is needed for the consistency of process generalization. Numerically, it has the similar "edge-preserving" property as the Besov prior._

**Remark 2**.: _If taken negative logarithm, the density of \(-_{d}\) in (10) yields a quantity dominated by some weighted \(L_{q}\) norm of \(-\), i.e. \(r^{}=\|-\|_{}^{q}\). From the optimization perspective, \(-_{d}\), when used as a prior, imposes \(L_{q}\) regularization in obtaining the maximum a posterior (MAP)._

Regardless of the normalizing constant, our proposed multivariate \(q\)-exponential distribution \(-_{d}(,)\) differs from the Gomez's EP distribution \(_{d}(,,q)\) by a boxed term \(r^{(-1)^{}}\). As stated in the following theorem, \(-_{d}\) satisfies the two conditions of Kolmogorov extension theorem thus is ready to generalize to a stochastic process (See the right panel of Figure 2 for the consistency).

**Theorem 3.3**.: _The multivariate \(q\)-exponential distribution is both_ **exchangeable** _and_ **consistent**_._

Proof.: See Appendix A.1. 

Like student-\(t\) distribution  and other elliptic distributions , we can show (See Appendix A.5) that \(-_{d}\) is represented as a scale mixture of Gaussian distributions for \(0<q<2\).

Numerically, thanks to our choice of density generator \(g(r)=r^{(-1)}\{-^{2}}{2}\}\), one can show that \(R^{q}_{d}^{2}\) (as in Appendix A.4) thus \(R\) in Theorem 2.1 can be sampled as \(q\)-root of a \(_{d}^{2}\) random variable, which completes the recipe for generating random vector \(-_{d}(0,)\) based on the stochastic representation (6). This is important for the Bayesian inference as detailed in Section 3.3.1. Note the matrix \(\) in the definition (10) characterizes the covariance between the components, as shown in the following proposition.

**Proposition 3.1**.: _If \(-_{d}(,)\), then we have_

\[[]=,\;()=}(+)}{d()} d ^{-1},\;\;d\] (11)

Proof.: See Appendix A.4. 

### \(Q\)-exponential Process as Probabilistic Definition of Besov Process

To generalize \(-_{d}(0,)\) to a stochastic process, we need to scale it to \(^{*}=d^{-}\) so that its covariance is asymptotically finite. If \(-_{d}(0,)\), then we denote \(^{*}-_{d}^{*}(0,)\) following a _scaled_\(q\)-exponential distribution. Let \(:L^{q} L^{q}\) be a kernel operator in the trace class, i.e. having eigen-pairs \(\{_{},_{}(x)\}_{=1}^{}\) such that \(_{}(x)=_{}(x)_{}\), \(\|_{}\|_{2}=1\) for all \(\) and \(()=_{=1}^{}_{}<\). Now we are ready to define the _q-exponential process (Q-EP)_ with the scaled \(q\)-exponential distribution.

**Definition 3.2** (Q-EP).: _A (centered) \(q\)-exponential process \(u(x)\) with kernel \(\) in the trace class, \(-(0,)\), is a collection of random variables such that any finite set, \(=(u(x_{1}), u(x_{d}))\), follows a scaled multivariate \(q\)-exponential distribution, i.e. \(-_{d}^{*}(0,)\)._

Note, the process is defined on the \(d^{*}\)-dimensional space depending on the applications (\(x^{d^{*}}\)); while \(d\) refers to the dimension of discretized process (\(^{d}\)). While Q-EP reduces to GP when \(q=2\), \(q=1\) is often adopted for imaging analysis as an "edge-preserving" prior. Illustrated in Figure 3 for selected \(q(0,2]\), smaller \(q\) leads to sharper image reconstruction with varying \(q\) interpolating between different regularization effects. Both Besov and Q-EP are valid stochastic processes stemming from the \(q\)-exponential distribution \(_{q}\). They are both designed to generalize GP to have sharper regularization (through \(q\)) but Q-EP has advantages in 1) the capability of specifying correlation structure directly and 2) the tractable prediction formula.

It follows from (1) immediately that the covariance of the Besov process \(u()\) at two points \(x,x^{}^{d^{*}}\):

\[(u(x),u(x^{}))=_{=1}^{}_{}^{2}_{ }(x)_{}(x^{})\] (12)Although the smoothness and correlation strength of Besov process can be configured by proper orthonormal basis \(\{_{}\}\) as in (12), it is less straightforward than the kernel function working for GP. On the other hand, Q-EP has more freedom on the correlation structure through (11) with flexible choices from a large class of kernels including powered exponential, Matern and periodic where we can directly specify the correlation length.

While Q-EP can be viewed as a probabilistic definition of Besov, the following theorem further establishes their connection in sharing equivalent series representations.

**Theorem 3.4** (Karhunen-Loeve).: _If \(u(x)-(0,)\) with a trace class operator \(\) having eigen-pairs \(\{_{},_{}(x)\}_{=1}^{}\) such that \(_{}(x)=_{}(x)_{},\ \|_{}\|_{2}=1\) for all \(\) and \(_{=1}^{}_{}<\), then we have the following series representation for \(u(x)\):_

\[u(x)=_{=1}^{}u_{}_{}(x), u_{}:=_{D}u(x )_{}(x)-^{*}(0, _{})\] (13)

_where \([u_{}]=0\) and \((u_{},u_{})=_{}_{^{}}\) with Dirac function \(_{^{}}=1\) if \(=^{}\) and \(0\) otherwise._

Proof.: See Appendix A.5. 

**Remark 3**.: _If we factor \(}\) out of \(u_{}\), we have the following expansion for Q-EP more comparable to (1) for Besov:_

\[u(x)=_{=1}^{}}u_{}_{}(x), u _{}-(0,1) _{q}()\] (14)

### Bayesian Modeling with \(Q\)-exponential Process

Now let us consider the generic Bayesian regression model:

\[y=u(x)+, L(;0,)\] (15) \[u_{0}(du)\]

where \(L(;0,)\) denotes some likelihood model with zero mean and covariance \(\), and the mean function \(u\) can be given a prior either Besov or Q-EP. Because of the definition (1) in terms of expanded series, there is no explicit formula for the posterior prediction using Besov prior. By contrast, a tractable formula exists for the posterior predictive distribution for (15) with Q-EP prior \(_{0}=-(0,)\) when the likelihood happens to be \(L(;0,C)=-(,)\), as stated in the following theorem.

**Theorem 3.5** (Posterior Prediction).: _Given covariates \(=\{x_{i}\}_{i=1}^{N}\) and observations \(=\{y_{i}\}_{i=1}^{N}\) following \(-\) in the model (15) with \(-\) prior for the same \(q>0\), we have the following posterior predictive distribution for \(u(x_{*})\) at (a) new point(s) \(x_{*}\):_

\[u(x_{*})|,,x_{*}-( ^{*},^{*}),^{*}=_{*}^ {}(+)^{-1},^{*}=_{**}-_{*}^{}(+)^{-1}_{*}\] (16)

_where \(=(,)\), \(_{*}=(,x_{*})\), and \(_{**}=(x_{*},x_{*})\)._

Proof.: See Appendix A.6. 

**Remark 4**.: _From Theorem 3.5, we know that \(Q\)-EP has same predictive mean as GP. But their predictive covariances differ by a constant \(()^{}+)}{ ()}\) (asymptotically 1) based on Proposition 3.1._

When the likelihood \(L\) is not Q-EP, e.g. multinomial, such conjugacy is absent. Then we refer to the following sampling method for the posterior inference.

Figure 3: Image of satellite: MAP estimates by Q-EP with varying \(q\) parameters.

#### 3.3.1 Inference by White-Noise MCMC

We follow  to consider the pushforward (\(T\)) of Gaussian white noise \(_{0}\) for non-Gaussian measures \(_{0}=T^{}_{0}\). More specifically, we construct a measurable transformation \(T:\) that maps standard Gaussian random variables to \(q\)-exponential random variables. The transformation based on the stochastic representation (6) is more straightforward than that for Besov based on series expansions proposed by .

Recall the stochastic representation (6) of \(-_{d}(,)\): \(=RS\) with \(R^{q}_{d}^{2}\) and \(S(^{d+1})\). We can rewrite \(S}}{{=}}}{\|\|_{2} }, R^{q}}}{{=}}\|\|_{2}^{2}, \ _{d}(,_{d})\). Therefore, we have the pushforward mapping (\(T\)) and its inverse (\(T^{-1}\)) as

\[=T()=\|\|^{-1}, =T^{-1}()=^{-1}\|^{-1 }\|^{-1}\] (17)

Figure B.1 illustrates that sampling with the white-noise representation (17) is indistinguishable from sampling by the stochastic representation (6). Then we can apply such white-noise representation to dimension-independent MCMC algorithms including preconditioned Crank-Nicolson (pCN) , infinite-dimensional Metropolis adjusted Langevin algorithm (\(\)-MALA) , infinite-dimensional Hamiltonian Monte Carlo (\(\)-HMC) , and infinite-dimensional manifold MALA (\(\)-mMALA)  and HMC (\(\)-mHMC) . See Algorithm 1 for an implementation on pCN, hence named _white-noise pCN (wn-pCN)_.

#### 3.3.2 Hyper-parameter Tuning

As in GP, there are hyper-parameters in the covariance function of Q-EP, e.g. variance magnitude (\(^{2}\)) and correlation length (\(\)), that require careful adjustment and fine tuning. If the data process \(y(x)\) and its mean \(u(x)\) are both Q-EP with the same \(q\), then we can have the marginal likelihood  as another Q-EP (c.f. Theorem 3.5). In general, when there is no such tractability, hyper-parameter tuning by optimizing the marginal likelihood is unavailable. However, we could impose conjugate hyper-priors on some parameters or even marginalize them to facilitate the inference of them (See Appendix A.7 for a proposition on such conditional conjugacy for the variance magnitude \(^{2}\)).

To tune the correlation length (\(\)), we could impose a hyper-prior for \(\) and sample from \(p(\,|)\). We then alternate updating \(\) and hyper-parameters in a Gibbs scheme. In general, one could also use Bayesian optimization methods [33; 18; 4] for the hyper-parameter tuning.

## 4 Numerical Experiments

In this section, we compare GP, Besov and Q-EP by modeling time series (temporal), reconstructing images (spatial) from computed tomography and solving a (spatiotemporal) inverse problem (Appendix C.4). These numerical experiments demonstrate that our proposed Q-EP enables faster convergence in obtaining a better maximum a posterior (MAP) estimate. What is more, white-noise MCMC based inference provides appropriate uncertainty quantification (UQ) (by the posterior standard deviation). More numerical results can be found in the supplementary materials which also contain some demonstration codes. All the computer codes are publicly available at https://github.com/lanzithinking/Q-EXP.

### Time Series Modeling

We first consider two simulated time series, one with step jumps and the other with sharp turnings, whose true trajectories are as follows:

\[u_{}(t) =1, t; 0.5, t(1,1.5]; 2, t(1.5,2]; 0, otherwise\] \[u_{}(t) =1.5t, t; 3.5-2t, t(1.5]; 3t-4, t(1.5,2]; 0, otherwise\]

We generate the time series \(\{y_{i}\}\) by adding Gaussian noises to the true trajectories evaluated at \(N=200\) evenly spaced points \(\{t_{i}\}\) in \(\), that is, \(y_{i}^{*}=u_{*}(t_{i})+_{i},\ _{i}}{{}}N(0,_{*}^{2}(t_{i})),\ i=1, ,N,\ *=,\). Let \(_{}/\|u_{}\|=0.015\)\(for\ t_{i}\) and \(_{}/\|u_{}\|=0.01\)\(if\ t_{i};\ 0.07\ if\ t_{i}(1,2]\). In addition, we also consider two real data sets of Tesla and Google stock prices in 2022. See Figures 4 (and Figures C.2) for the true trajectories (blue lines) and realizations (orange dots) respectively.

We use the above likelihood and test three priors: GP, Besov and Q-EP. For Besov, we choose the Fourier basis \(_{b}(t)=,\ _{t}(t)=( t),\ \) (results with other wavelet bases including Haar, Shannon, Meyer and Mexican Hat are worse hence omitted). For both GP and Q-EP, we adopt the Matern kernel with \(=\), \(^{2}=1\), \(=0.5\) and \(s=1\): \(C(t,t^{})=^{2}}{()}w^{}K_{}(w), w =(\|t-t^{}\|/)^{s}\). In both Besov and Q-EP, we set \(q=1\). Figures 3(a) and 3(c) (and Figures 4(a) and 3(c)) compare the MAP estimates (red dashed lines). We can see that Q-EP yields the best estimates closest to the true trajectories in the simulation and the best fit to the Tesla/Google stock prices. We also investigate the negative posterior densities and relative errors, \(\|a_{s}-u_{*}\|/\|u_{*}\|\), as functions of iterations in Figure 5. Though incomparable in the absolute values, the negative posterior densities indicate faster convergence in both GP and Q-EP models than in Besov model. The error reducing plots on the right panels of subplots in Figure 5 indicate that Q-EP prior model can achieve the smallest errors. Table 1 compares them in terms of root mean of squared error (RMSE) and log-likelihood (LL).

Then we consider the prediction problem. In the simulations, the last \(1/8\) portion and every other of the last but \(3/8\) part of the data points are selected for testing. The models with GP and Q-EP priors are trained on the rest of the data, as indicated by short "ticks" in Figures 3(b) and 3(d) (and Figures 4(b) and 4(d)). For the Tesla/google stocks, we select every other day in the first half year, every 4 days in the 3rd quarter and every 8 days in the last quarter for training and test on the rest. They pose challenges on both interpolation (among observations) and extrapolation (at no-observation region) tasks. As we can see in those figures, uncertainty grows as the data become scarce. Nevertheless, the Q-EP yields smaller errors than GP. Note, such prediction is not immediately available for models with Besov prior.

    &  &  \\  Data Sets & GP & Besov & Q-EP & GP & Besov & Q-EP \\  simulation (jumps) & 1.2702 & 2.1603 & **1.1083** & -31.4582 & -89.8549 & -74.0590 \\ simulation (turnings) & 1.4270 & 2.4556 & **0.9987** & -39.8234 & -56.7874 & -87.3124 \\  Tesla stocks & 180.3769 & 136.8769 & **51.2236** & -488.6458 & -281.3796 & -39.4070 \\ Google stocks & 44.4236 & 39.4809 & **36.8686** & -386.1546 & -305.0058 & -265.9790 \\   

Table 1: Time series modeling: root mean of squared errors (RMSE) and log-likelihood (LL) values at MAP estimates by GP, Besov and Q-EP prior models.

Figure 4: (a)(c) MAP estimates by GP (left), Besov (middle) and Q-EP (right) models. (b)(d) Predictions by GP (left) and Q-EP (right) models. Orange dots are actual realizations (data points). Blue solid lines are true trajectories. Black ticks indicate the training data points. Red dashed lines are MAP estimates. Red dot-dashed lines are predictions with shaded region being credible bands.

### Computed Tomography Imaging

Computed tomography (CT) is a medical imaging technique used to obtain detailed internal images of human body. CT scanners use a rotating X-ray tube and a row of detectors to measure X-ray attenuations by different tissues inside the body from different angles. Denote the true imaging as a function \(u(x)\) on the square unit \(D=^{2}\) taking values as the pixels. The observed data, \(\), (a.k.a. sinogram) are results of Radon transformation (\(\)) of the discretized \(n n\) field \(\) with \(n_{}\) angles and \(n_{s}\) sensors, contaminated by noise \(\):

\[=+,(,_{}^{2} ),^{n_{}n_{s}}, ^{n_{}n_{s} n^{2}},^{n^{2}}\]

In general \(n_{}n_{s} d=n^{2}\) so the linear inverse problem is under-determined. Baysian approach could fill useful prior information (e.g. edges) in the sparse data.

We first consider the Shepp-Logan phantom, a standard test image created by Shepp and Logan in  to model a human head and to test image reconstruction algorithms. In this simulation, we create the true image \(u^{}\) for a resolution of \(n^{2}=128 128\) and project it at \(n_{}=90\) angles with \(n_{s}=100\) equally spaced sensors. The generated sinogram is then added by noise with signal noise ratio \(=\|u^{}\|/\|\|=100\). The first two panels of Figure 5 show the truth and the observation.

Note, the computation involving a full sized (\(d d\)) kernel matrix \(\) for GP and Q-EP is prohibitive. Therefore, we consider its Mercer's expansion (12) with Fourier basis for a truncation at the first \(L=2000\) items. Figure 5 shows that while GP and Besov models reconstruct very blurry phantom images, the Q-EP prior model produces MAP estimate of the highest quality. For each of the three models, we also apply wn-pCN to generate \(10000\) posterior samples (after discarding \(5000\)) and use them to reconstruct \(u\) (posterior mean or median) and quantify uncertainty (posterior standard deviation).

Table 2 summarizes the errors relative to MAP (\(u^{*}\)) and posterior mean (\(\)) respectively, \(\|-u^{}\|/\|u^{}\|\) (with \(\) being \(u^{*}\) or \(\)), log-likelihood (LL), and several quality metrics in imaging analysis including the peak signal-to-noise ratio (PSNR) , the structured similarity index (SSIM) , and the Haar wavelet-based perceptual similarity index (HaarPSI) . Q-EP attains the lowest error and highest quality scores in most cases. In Figure C.3, we compare the uncertainty by these models. It seems that GP has uncertainty filed with more recognizable shape than the other two. However, the posterior standard deviation by GP is much smaller (about 1% of that with Q-EP) compared with the other two. Therefore, this raises a red flag that GP could be over-confident about a less accurate estimate.

    &  \\   & GP & Besov & Q-EP & GP & Besov & Q-EP \\  RLE & 0.6810 & 0.7027 & **0.4087** & 0.4917(6.16e-7) & 0.4894(3.53e-5) & **0.4890**(4.79e-5) \\ LL & -1.55e+6 & -1.54e+6 & -1.57e+5 & -5.21e+5(8.47) & -4.80e+5(196.34) & -4.56e+5(307.97) \\ PSNR & 15.5531 & 15.2806 & **19.9887** & 18.3826(1.09e-5) & 18.4226(6.27e-4) & **18.430**(3.851e-4) \\ SSIM & 0.4028 & 0.3703 & **0.5967** & **0.5561**(3.92e-7) & 0.5535(2.38e-4) & 0.5403(5.26e-4) \\ HaarPSI & 0.0961 & 0.0870 & **0.3105** & 0.3126(1.52e-8) & **0.3126**(3.36e-4) & 0.3122(3.06e-4) \\   

Table 2: Posterior estimates of Shepp-Logan phantom by GP, Besov and Q-EP prior models: relative error, \(:=\|-u^{}\|/\|u^{}\|\), of MAP (\(=u^{*}\)) and posterior mean (\(=\)) respectively, log-likelihood (LL), PSNR, SSIM and HarrPSI. Numbers in the bracket are standard deviations obtained repeating the experiments for 10 times with different random seeds.

Figure 5: Shepp-Logan phantom: true image, observation (sinogram), and MAP estimates by GP, Besov and Q-EP models with relative errors 68.10%, 70.27% and **40.87**% respectively.

Finally, we apply these methods to CT scans of a human cadaver and torso from the Visible Human Project . These images contain \(n^{2}=512 512\) pixels and the sinograms are obtained with \(n_{}=200\) angles and \(n_{s}=512\) sensors. The first two panels of each row in Figure 6 show a highly calibrated CT reconstruction (treated as "truth") and the observed sinogram. The rest three panels illustrate that both Besov and Q-EP models outperform GP in reconstructions, as verified in the quantitative summaries in Table C.2. Figure C.4 indicates that GP tends to underestimate the uncertainty.

In these CT reconstruction examples, we observe larger discrepancy of performance between Besov and Q-EP in the low-dimensional data-sparse application (Shepp-Logan phantom at resolution \(n^{2}=128 128\) with \(n_{}=90\) angles and \(n_{s}=100\) sensors) compared with the high-dimensional data-intensive applications (two human body CTs at resolution \(n^{2}=512 512\) with \(n_{}=200\) angles and \(n_{s}=512\) sensors). This may be due to the truncation in Mercer's kernel representation (12) and different rates of posterior contraction . We will explore them in another journal paper.

## 5 Conclusion

In this paper, we propose the \(q\)-exponential process (Q-EP) as a prior on \(L^{q}\) functions with a flexible parameter \(q>0\) to control the degree of regularization. Usually, \(q=1\) is adopted to capture abrupt changes or sharp contrast in data such as edges in the image as the Besov prior has recently gained popularity for. Compared with GP, Q-EP can impose sharper regularization through \(q\). Compared with Besov, Q-EP enjoys the explicit formula with more control on the correlation structure as GP. The numerical experiments in time series modeling, image reconstruction and Bayesian inverse problems demonstrate our proposed Q-EP is superior in Bayesian functional data modeling.

In the numerical experiments of current work, we manually grid-search for the optimal hyper-parameters. The reported results are not sensitive to some of these hyper-parameters such as the variance magnitude (\(^{2}\)) and the correlation length (\(\)) but may change drastically to others like the regularity parameter (\(\)) and the smoothness parameter (\(s\)). In future, we will incorporate hyper-priors for some of those parameters and adopt a hierarchical scheme to overcome such shortcoming. We plan to study the properties such as regularity of function draws of Q-EP and the posterior contraction, and compare the contraction rates among GP, Besov and Q-EP priors . Future work will also consider operator based kernels such as graph Laplacian .