# Deep activity propagation via weight initialization in spiking neural networks

Aurora Micheli

Delft University of Technology

a.micheli@tudelft.nl

Olaf Booij

Delft University of Technology

o.booij@tudelft.nl

Jan van Gemert

Delft University of Technology

j.c.vangemert@tudelft.nl

Nergis Tomen

Delft University of Technology

n.tomen@tudelft.nl

###### Abstract

Spiking Neural Networks (SNNs) offer advantages such as sparsity and ultra-low power consumption, making them a promising alternative to conventional neural networks (ANNs). However, training deep SNNs is challenging due to the quantization of membrane potentials into binary spikes, which can cause information loss and vanishing spikes in deeper layers. Traditional weight initialization methods from ANNs are often used in SNNs without accounting for their distinct computational properties. In this work, we derive an optimal weight initialization method tailored for SNNs, specifically taking into account the quantization operation. We demonstrate through theoretical analysis and simulations with up to 100 layers that our method enables the propagation of activity in deep SNNs without loss of spikes. Experiments on MNIST confirm that the proposed initialization scheme leads to higher accuracy, faster convergence, and robustness against variations in network and neuron hyperparameters.

## 1 Introduction

Spiking Neural Networks (SNNs) are a class of artificial neural networks inspired by the dynamics of biological brains, where information is encoded and transmitted through discrete spikes [1; 2; 3]. This unique mode of communication enables SNNs to perform fast computations with low power consumption [4; 5], especially when combined with specialized neuromorphic hardware [6; 7; 8]. However, SNNs still underperform compared to conventional artificial neural networks (ANNs), mainly due to the additional challenges associated with their training. While ANNs are typically trained via gradient descent, the discrete nature of spikes in SNNs complicates the use of backpropagation. Different methods such as ANN-SNN conversion [9; 10; 11] and backpropagation with surrogate functions [12; 13] have been proposed to circumvent this problem. Nevertheless, the proposed solutions haven't been sufficient to fully bridge the performance gap between SNNs and ANNs, without compromising the efficiency advantages of SNNs.

Similarly to ANNs, in SNNs a suboptimal weight initialization can hamper the training process [14; 15], especially in deep networks . While ANN weight initialization strategies tailored to specific activation functions and weight distributions have been widely explored [17; 18; 19], these methods are also often inappropriately applied to SNNs. Unlike ANNs, SNNs feature temporal dynamics, resetting mechanisms, information quantization and their activation function differs from those examined in the ANN literature. Hence, ANN initialization schemes are inadequate for SNNs and often cause undesired effects such as vanishing or exploding spikes in deeper layers.

In this paper, we analytically derive a weight initialization method that accounts for the specific activation function of Spiking Neural Networks (SNNs), building on the approach proposed in for standard ANNs. We empirically demonstrate that, unlike the standard ReLU-based method, our initialization enables spiking activity to propagate through deep networks without dissipation or amplification. Additionally, we show that proper weight initialization leads to improved accuracy, faster convergence, and lower latency in a simple classification task.

## 2 Related work

A proper initialization method should avoid reducing or amplifying the magnitudes of input signals. In ANNs, Glorot & Bengio in  address the issue of saturated units for the logistic sigmoid activation function and propose a new weight initialization scheme aimed at maintaining constant activations and gradient variance across layers. He et. al  extend this analysis to Rectified Linear Unit (ReLU) activations, introducing the widely adopted Kaiming initialization for deep ANNs.

In contrast, research on initialization schemes for SNNs is scarce and the problem of information propagation in SNNs has been often indirectly addressed. In  and  the appropriate membrane leak factor and firing threshold are learnt during training. Similarly, in [22; 23] some learnable parameters are incorporated in the SNN to optimize the neuron firing rate, thus increasing the computational complexity. Additionally, approaches like global unsupervised firing rate normalization , batch normalization adapted to SNNs [25; 26] and constraints on the membrane potential distributions [27; 28] help regulate spike response and information flow.

Some studies regard ANN-SNN conversion as an initialization method , but this is limited to rate-based encoding, restricting its applicability to networks with alternative encoding schemes.

Only a few studies directly address what constitutes a good initial state for SNNs. Some works attempt to empirically determine a suitable weight scale in the case of SNNs, often lacking a solid theoretical foundation [16; 30; 31; 32]. In  the authors derive a new initialization strategy considering the asymptotic spiking response given a mean-driven input.  proposes a fluctuation-driven initialization scheme, but neglects both the spiking and the resetting mechanism. In  a specular approach similar to the one presented in  is studied, yet the theoretical insights lack empirical validation.

## 3 Methods

### The spiking neuron

The Leaky-Integrate-and-Fire (LIF) neuron  is one of the most popular models used in SNNs [2; 35] and neuromorphic hardware [7; 6] to emulate the functionality of biological neurons. The state of a LIF neuron at time \(t\) is given by the membrane potential \(U(t)\) which evolves according to

\[=-U(t)+RI(t),\] (1)

where \(\) is the membrane time constant, \(R\) is the resistance of the membrane and \(I(t)\) is the time-varying input current. Following previous works  we use the discretized equation with time step \( t\) which gives membrane potential \(u\) at time step \(t\) as:

\[u^{t}= u^{t-1}+_{j}w_{j}x_{j}^{t},\] (2)

where \((1- t/)\) is a leak factor \(\) governing the rate at which the membrane potential decays over time, \(j\) is the index of the pre-synaptic neuron, \(w_{j}\) represents the weight of the connection between the pre- and post-synaptic neurons and \(x_{j}\) is the binary spike activation. When the membrane potential \(u\) exceeds a firing threshold \(\), the neuron emits a binary output spike \(x=1\). After firing, the membrane potential is reset by subtracting from its value the threshold \(\) (soft reset).

### Weight initialization for a spiking neural network

Our derivation is inspired by He et al. , which suggests that an effective weight initialization should enable information flow across many network layers by keeping the variance of the input to each layer constant. We examine the variance of responses within each layer of a fully-connected SNN initialized at time step \(t=0\).

For a generic layer \(l\) with \(m\) neurons:

\[_{l} =_{l}_{l}\] (3) \[_{l} =f(_{l-1})\] (4)Here \(_{l}\{0,1\}^{n}\) is a binary vector representing the \(n\) input spikes, \(_{l}^{m n}\) is the weight matrix and \(_{l}^{m}\) represents the membrane potentials of neurons in layer \(l\). \(_{l}\) is obtained by applying the activation function \(f\) to the membrane potentials of layer \(l-1\). In a conventional SNN \(f\) is defined as the Heaviside step function:

\[f(_{l-1})=1,&\ \ u_{l-1}>\\ 0,&\ \ u_{l-1}<\] (5)

where \(u_{l-1}\) are the elements of \(_{l-1}\) and \(>0\) is the neurons firing threshold. We assume that the elements of \(_{l}\) are mutually independent and share the same distribution (i.i.d.). Following  and , the elements of \(_{l}\) are also considered to be mutually independent and identically distributed (i.i.d.). Lastly, \(_{l}\) and \(_{l}\) are independent of each other. We can then write:

\[[u_{l}]=n_{l}[w_{l}x_{l}].\] (6)

Here \(u_{l}\), \(w_{l}\), and \(x_{l}\) represent each random variable element in \(_{l}\), \(_{l}\) and \(_{l}\) respectively. We choose \(w_{l}\) to be symmetrically distributed around 0. Since \(w_{l}\) and \(x_{l}\) are independent of each other, we can rewrite the variance of their product as:

\[[u_{l}]=n_{l}[w_{l}]E[x_{l}^{2}],\] (7)

where \(E[x_{l}^{2}]\) is the expected value of \(x_{l}^{2}\). It is worth noting that the expression \(E[x_{l}^{2}]\) strongly depends on the network activation function. Here is where our derivations differ from He et al. .

By assuming that \(u_{l-1}\) is zero-centered and symmetric around its mean, for a ReLU activation function, \(x_{l}=(0,u_{l-1})\), one obtains \(E[x_{l}^{2}]=[u_{l-1}]\). This result stems from the fact that the ReLU function preserves exactly the positive half of the distribution it acts upon. As depicted in Figure 1, this doesn't hold true for the activation function of SNNs where, by definition, \(>0\). This difference leads to considerably sparser activations in SNNs. In the case of an SNN, we can express \(E[x_{l}^{2}]\) as:

\[E[x_{l}^{2}]=_{j=1}^{n}x_{l}^{j^{2}}P(x_{l}=x_{l}^{j}).\] (8)

The binary elements \(x_{l}^{j}\{0,1\}\) represent spikes. Applying the SNN activation function (5) to Eq. 8, we find that \(E[x_{l}^{2}]=P(u_{l-1}>)\). Equation 7 can then be rewritten as:

\[[u_{l}]=n_{l}[w_{l}]P(u_{l-1}>).\] (9)

As commonly done in recent works [28; 20; 36; 23], we consider a real-valued input \(I_{0}\) encoded to binary spikes using the first layer of the SNN. When feeding \(I_{0}\) to the membrane potentials \(u_{0}\) of the initial layer, \(u_{0}=I_{0}\) and \(u_{0}\) trivially follows the same distribution as the input. We let \(I_{0}\) be standard normal distributed \(I_{0}(=0,^{2}=1)\), thus \([u_{0}]\ =\ 1\), \(E[u_{0}]\ =\ 0\). A proper initialization method should avoid reducing or amplifying the magnitudes of the input signals when propagated

Figure 1: Comparison of standard activation functions for ANNs (_top_) and SNNs (_bottom_). When applied to pre-activation distribution \(u_{l-1}\) (_left_) the SNN thresholding mechanism (_middle_) generates binarized activations \(x_{l}\) (_right_). The dark shaded areas of \(u_{l-1}\) correspond to the fraction of neurons which will be activated and provide non-zero input to the next layer. With identical input distributions, this fraction is considerably lower for SNNs. This highlights why weight initializations optimized for ReLU will lead to vanishing activity in deep SNNs.

across the network layers. This condition can be met if \([u_{l}]=1\) for every layer \(l\), which lets us simplify Eq. 9 and leads to a zero-mean Gaussian weight distribution with variance:

\[[w_{l}]=P(u_{l-1}>)}\] (10)

Equation 10 is our proposed weight initialization method for training deep SNNs. Note that in terms of architecture parameters, it only depends on the number of input neurons \(n\).

Because \(u_{l-1}\) is symmetric around 0 and \(>0\), then \(P(u_{l-1}>)<\). It is important to note that:

\[P(u_{l-1}>)}>},\] (11)

Where \(}\)is the standard initialization for a ReLU network . Thus, initializing the weights of an SNN using a method designed for conventional ANNs with ReLU activation functions does not ensure the propagation of information from the input throughout the network.

## 4 Validation with numerical simulations

Unless otherwise specified, we consider fully-connected SNNs with 100 layers and \(n=1000\) LIF neurons in each layer. The input \(I_{0}\) is real-valued and randomly drawn from \((=0,^{2}=1)\). Consistently with the derivation in 3.2, we encode the inputs to binary spikes by feeding them to the membrane potentials of the initial LIF layer \(u_{0}\).

We investigate the behavior of activity propagation under different weight initialization schemes and compare our method against the prevailing choice for conventional ANNs: Kaiming initialization (). The weights in the network are therefore randomly initialized respectively from \((0,>)}})\) (our method) and \((0,})\) (Kaiming), where \(n\) is the layer width. Since \(u_{0}(0,1)\), \(P(u_{0}>)\) is defined as:

\[P(u_{0}>)=_{}^{}}e^{-^{2} }{2}}du_{0}.\] (12)

The integral in Eq. 12 doesn't have a closed-form solution, but it can be numerically estimated using the error function . We recall from 3.2 that, to retain the activity over depth, we aim to conserve \([u_{l}]\) across the layers. We initialize the network at time \(t=0\), propagate the input across its layers, record the values of the membrane potentials \(u_{l}\) in every layer \(l\) and compute their variance. Figure 2 shows how \([u_{l}]\) evolves with depth for the 2 different initialization schemes and for 6 different values of the firing threshold \(\). For every different value of \(\), we run the simulation 20 times and plot the average. The shaded areas represent the standard deviation over the different runs.

The results (Figure 2, left) demonstrate that in an SNN initialized with our proposed method, the variance \([u_{l}]\) of the neuron states stays constant across layers regardless of the threshold \(\), as the theory predicts. Conversely, with Kaiming initialization, information dissipates across layers, especially as firing thresholds increase. The only effective way to preserve information with Kaiming is to set \(=0\), where the activation function becomes effectively equivalent to ReLU.

Figure 2: Propagation of \([u_{l}]\) across network layers for (_left_) our initialization scheme and (_right_) Kaiming for six firing threshold values (\(\)). For all \(\), our proposed initialization method enables information propagation across all 100 layers. In contrast, Kaiming initialization leads to information dissipation across layers, particularly evident with higher threshold values. Each simulation was repeated 20 times, and the shaded areas represent the standard deviation over these runs.

### Extension to multiple time steps

SNNs excel at processing time-dependent input thanks to the intrinsic memory of their spiking neurons, represented by the membrane potential \(u\). This makes them particularly suited for tasks involving dynamic temporal patterns, like speech recognition and video analysis [38; 39; 40].

In this section, we extend the analysis from Section 4 to examine how weight initialization impacts information propagation across both space _and_ time in multiple time-step simulations of deep SNNs. We employ fully-connected SNNs of 100 layers with \(n=1000\) neurons in each layer. We consider LIF neurons with soft reset and numerically compute the discrete-time dynamics based on Eq. 2. The dynamics of the membrane potentials including the reset term is given by:

\[u_{l}^{t}=w_{l}^{t}x_{l}^{t}+ u_{l}^{t-1}-x_{l+1}^{t-1}\] (13)

for time step \(t>0\) and layer \(l\). \(\) is the leak factor. Network weights are randomly initialized either using our initialization scheme or Kaiming, and the inputs are randomly drawn from \((0,1)\), same as in Section 4. Differently, in this section, we iteratively feed the input (constant over time) to the membrane potentials of the initial LIF layer \(u_{0}^{t}\) at every time step \(t\). We compute the variance of the membrane potentials \(u_{l}^{t}\) and the total number of spikes at every layer \(l\) and time step \(t\), for a total of \(T=20\) time steps. We repeat each simulation 10 times, and report their average.

The network initialized with our method succeeds in conserving the \([u_{l}^{t}]\) across both space and time, whereas the network initialized with Kaiming fails (Fig. 2(a)). Conserving \([u_{l}^{t}]\) is crucial, as it means conserving the number of spikes, and therefore ensuring a consistent network output.

Although our mathematical derivation does not explicitly take time into account, unlike methods derived for ANNs, it considers the specific SNN activation function, and by keeping the variance of the membrane potentials \(u_{l}\) constant, it aims to indirectly keep the variance of the layer input \(w_{l}x_{l}\) constant (Eq. 3). This helps to effectively propagate information also across multiple time steps. Nevertheless, deviations from theory are expected due to the leak and reset terms (Eq. 13). In particular, the reset operation affects the membrane potential distributions, violating the assumption of a normal distribution symmetrically centered around \(0\) (see Appendix 7: Figure 5). However, how well the normal distribution still holds as an approximation depends on neuron hyperparameters. For example, deviations from theory are visible at higher values of \(\). A larger \(\) leads to broader distributions of \(u_{l}^{t}\), and thus to a more abrupt change in the distributions when neurons with \(u_{l}^{t}>\) are reset. As illustrated in Fig. 2(b), when \(=0.9\), the network dissipates energy over time. We attribute this dissipation to the shift in \(u_{l}^{t}\) distributions. Still, we note that with our proposed initialization method, we can still successfully retrieve an output, unlike with Kaiming.

Figure 3: Propagation of \([u_{l}^{t}]\) (_top row_) and number of spikes (_bottom row_) across layers and time steps for our initialization method and Kaiming averaged over 10 runs. **(a)** Our proposed weight initialization preserves activity and propagates spikes through 100 layers and 20 time steps. In contrast, with Kaiming initialization neuronal activity rapidly dies out. **(b)** The effect of the leak and reset terms becomes more pronounced for high values of \(\) and pushes the network into the dissipative regime. However, with our proposed initialization method, we can still successfully retrieve an output.

Experiments on MNIST

To empirically evaluate our variance-conserving weight initialization, we conduct object classification experiments using the MNIST digits dataset . The 28x28 pixel grey-scale images are normalized to have mean 0 and variance 1, in line with the assumptions used in the derivations. As in Section 4 the inputs are encoded to binary spikes using the first LIF layer. The final layer of the network outputs binary spikes, which are accumulated over time steps and passed to the cross-entropy loss function. Unless otherwise specified, we employ a fully-connected SNN consisting of 10 layers, each comprising \(n=600\) LIF neurons with soft reset. We set \(=1\) and \(=0.5\).

Commonly, SNNs performing spike-count based object classification use a large number of total time steps \(T\). A typical range of \(T\) can be between 10 and a few thousand . Here, we set the number of total time steps to \(T=3\). We hypothesize that initializations which enable constant information propagation across depth might also enable inference with low latency, where there is no need to wait for many time steps to accumulate the necessary number of output spikes.

The network is trained for 150 epochs using backpropagation through time (BPTT)  and the arctan surrogate gradient function . We utilize the Adam optimizer  with a learning rate of \(1 10^{-3}\) and employ cosine annealing scheduling. The runtime for each experiment is approximately 2 hours on a single GPU. Our weight initialization method is compared to Kaiming, as in previous sections.

The results illustrated in Figure 4 show that our method generally allows an SNN to converge faster and to achieve better accuracy than Kaiming for different values of network depth and \(\). We attribute the poor convergence and lower task performance of Kaiming-initialized networks to inadequate activity propagation, as supported by both theoretical insights and empirical findings from previous sections. Specifically, training becomes increasingly challenging with deeper networks, lower values of \(\) (leading to less information retention from the previous time step) and higher values of \(\) (resulting in fewer neurons emitting spikes) (see Appendix 7: Figure 6).

## 6 Conclusion and Discussion

In this paper, we address the problem of weight initialization in Spiking Neural Networks (SNNs) and show how the techniques developed for ANNs, such as Kaiming initialization, are inadequate for SNNs. We analytically derive and empirically test a novel weight initialization method which takes into account the specific activation function of SNNs. Our weight initialization depends only on the number of input neurons \(n\) to a layer and is therefore broadly applicable to all deep, spiking network architectures with fixed connectivity maps. We demonstrate that our proposed initialization is robust against variations in several network and neuron hyperparameters, which can enable deep activity propagation for diverse models and machine learning tasks.

A limitation of our proposed initialization is that it does not account for the temporal dynamics of membrane potentials \(u_{l}\). Specifically, after neurons are reset, our assumption that \(u_{l}\) is normally distributed around zero is violated. We observe that the extent to which the normal distribution remains a valid approximation depends on the neuron hyperparameters, although our initialization seems more robust than Kaiming and the theory can be expanded to explicitly take into account the temporal variations in \(u_{l}\). Another assumption of our derivation is that the activations \(x_{l}\) are mutually independent. This assumption is typically violated in the case of real-world data, such as images. Empirically, in section 5 we illustrate how, for an SNN trained on MNIST, our variance-conserving initialization scheme still translates into accelerated training, improved accuracy and low latency compared to Kaiming. Nevertheless, we acknowledge the necessity of extending this analysis to more complex architectures and datasets, in order to evaluate its effectiveness in various settings.

Figure 4: Test accuracy on MNIST for different values of network depth (_left_) and \(\) (_right_). Our proposed initialization (solid lines) achieves better generalization than Kaiming (dashed lines).