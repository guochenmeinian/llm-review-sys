# (\nabla^{2}\)DFT: A Universal Quantum Chemistry Dataset of Drug-Like Molecules and a Benchmark for Neural Network Potentials

(^{2}\)DFT: A Universal Quantum Chemistry Dataset of Drug-Like Molecules and a Benchmark for Neural Network Potentials

Kuzma Khrabrov\({}^{1,}\), Anton Ber\({}^{1}\), Artem Tsypin\({}^{1}\), Konstantin Ushenin\({}^{1}\), Egor Rumiantsev\({}^{2}\), Alexander Telepov\({}^{1}\), Dmitry Protasov\({}^{1}\), Ilya Shenbin\({}^{6}\), Anton Alekseev\({}^{3,\,6}\), Mikhail Shirokikh\({}^{3}\), Sergey Nikolenko\({}^{4,\,6}\), Elena Tutubalina\({}^{1,\,4,\,5}\), and Artur Kadurin\({}^{1,\,4,\,5}\)

\({}^{1}\)AIRI, Moscow

\({}^{2}\)EPFL, Lausanne

\({}^{3}\)St. Petersburg State University, St. Petersburg

\({}^{4}\)ISP RAS Research Center for Trusted Artificial Intelligence, Moscow

\({}^{5}\)Sber AI, Moscow

\({}^{6}\)St. Petersburg Department of the Steklov Institute of Mathematics, St. Petersburg

\({}^{}\){khrabrov, Kadurin}@airi.net

Anton Ber\({}^{1}\), Artem Tsypin\({}^{1}\), Konstantin Ushenin\({}^{1}\), Egor Rumiantsev\({}^{2}\), Alexander Telepov\({}^{1}\), Dmitry Protasov\({}^{1}\), Ilya Shenbin\({}^{6}\), Anton Alekseev\({}^{3,\,6}\), Mikhail Shirokikh\({}^{3}\), Sergey Nikolenko\({}^{4,\,6}\), Elena Tutubalina\({}^{1,\,4,\,5}\), and Artur Kadurin\({}^{1,\,4,\,5}\)

\({}^{1}\)AIRI, Moscow

\({}^{2}\)EPFL, Lausanne

\({}^{3}\)St. Petersburg State University, St. Petersburg

\({}^{4}\)ISP RAS Research Center for Trusted Artificial Intelligence, Moscow

\({}^{5}\)Sber AI, Moscow

\({}^{6}\)St. Petersburg Department of the Steklov Institute of Mathematics, St. Petersburg

\({}^{}\){khrabrov, Kadurin}@airi.net

###### Abstract

Methods of computational quantum chemistry provide accurate approximations of molecular properties crucial for computer-aided drug discovery and other areas of chemical science. However, high computational complexity limits the scalability of their applications. Neural network potentials (NNPs) are a promising alternative to quantum chemistry methods, but they require large and diverse datasets for training. This work presents a new dataset and benchmark called \(^{2}\)DFT that is based on the nablaDFT. It contains twice as much molecular structures, three times more conformations, new data types and tasks, and state-of-the-art models. The dataset includes energies, forces, 17 molecular properties, Hamiltonian and overlap matrices, and a wavefunction object. All calculations were performed at the DFT level (\(\)B97X-D/def2-SVP) for each conformation. Moreover, \(^{2}\)DFT is the first dataset that contains relaxation trajectories for a substantial number of drug-like molecules. We also introduce a novel benchmark for evaluating NNPs in molecular property prediction, Hamiltonian prediction, and conformational optimization tasks. Finally, we propose an extendable framework for training NNPs and implement 10 models within it.

## 1 Introduction

Solving the many-particle Schrodinger equation (SE) for electrons makes it possible to describe the electronic structure of matter. This structure determines the equilibrium and transport properties of matter that are crucial in downstream applications such as computer-aided drug design or material design [1; 2; 3; 4; 5; 6; 7; 8]. However, since an analytic solution to the many-particle SE is unknown, various approximate solutions are used in practice, leading to a trade-off between accuracy and computational cost. The most accurate methods, such as Post-Hartree-Fock  and quantum Monte Carlo methods  are prohibitively expensive, applicable to systems with at most tens of atoms; for a comprehensive overview of numerical methods at different levels of accuracy see .

_Density functional theory_ (DFT) [12; 13; 14] is currently the primary approach for solving the many-particle SE for electrons. It provides reasonably accurate predictions while being computationally tractable for systems on a scale of 1000 electrons . However, even a single iteration of this method may take several CPU-hours , which restricts its use in molecular modeling tasks where a single method has to be called many times (e.g., more than \(10^{6}\) times for molecular dynamics simulation). Neural networks have recently emerged as an alternative to the computationally expensive quantum chemistry (QC) approaches. However, they require substantial amounts of data for training. Since collecting data at the highest level of theory (such as Post-Hartree-Fock or Quantum Monte Carlo) is extremely expensive, most existing datasets (see Section 2) use DFT-based methods.

There are multiple ways to parametrize the solution of the SE equation with a neural network (NN). The most general approach is to directly predict the wavefunction of the atomic system [17; 18; 19; 20; 21; 22; 23; 24], which allows to infer interesting properties of the system quickly. In general, this approach does not require a dataset to train on and does not depend on a specific method of solving the many-particle SE, but this family of methods is very resource-demanding . Another approach is to predict the quantum Hamiltonian matrix [25; 26; 27; 28; 29; 30], which fully defines the wavefunction on the Kohn-Sham density functional and Hartree-Fock levels of theory. This approach is not as general since it can only operate on certain levels of theory but retains all merits of wavefunction prediction. Finally, the most popular approach involves training _neural network potentials_ (NNPs) [31; 32; 33; 34; 35; 36; 37; 38; 39; 40], i.e., neural networks designed to predict potential energy and interatomic forces in atomic systems based on the structural arrangement of the atoms. Their inference time scales at most quadratically in the number of atoms in the system, which makes NNPs relatively cheap to train and applicable in such important tasks as molecular dynamics simulations [32; 41; 42; 43] and molecular conformation optimization [44; 45; 46].

In this work, we aim to aid the training of Hamiltonian-predicting models and NNPs for druglike molecules by significantly extending and improving the nablaDFT dataset . We double the number of molecules and conformations to 1,936,929 and 12,676,264, respectively. We call the proposed dataset \(^{2}\)DFT. For each conformation, we provide various QC properties, including energy, forces, Hamiltonian and overlap matrices, and the wavefunction object that allows to either directly infer or calculate additional QC properties. All calculations were performed at the \(\)B97X-D/def2-SVP DFT level.

Although estimating QC properties in any given conformation is important, it is even more important to estimate them in low-energy conformations (conformers), traditionally obtained with an iterative optimization process that utilizes a computational method at every optimization step. This process is called conformational (geometry) optimization or relaxation. Multiple calls to the computational method make geometry optimization extremely expensive in terms of computations, but it can be sped up by using an NNP instead [44; 45; 46; 47]. GOLF paper  emphasizes that training such neural networks requires a large amount of data comprised of geometry optimization trajectories. To facilitate research on NN-based conformational optimization of druglike molecules, we extend our dataset with geometry optimization trajectories for 60,226 conformations of 16,974 molecules from the \(^{2}\)DFT. Together with these trajectories, the dataset contains 15,716,667 conformations in total.

Figure 1: Our comprehensive workflow for dataset and benchmark construction as elaborated in Sections 3 and 4. First, a diverse set of conformations is generated for molecules from the MOSES dataset. Second, Quantum Chemistry (QC) properties are computed for these conformations, accompanied by optimization trajectories. Third, this data is then arranged into training and testing splits. Finally, ten state-of-the-art models are trained and evaluated based on these splits.

A complete set of properties provided for each conformation, together with a unique dataset of relaxation trajectories for druglike molecules, make the \(^{2}\)DFT dataset _universal_.

In addition to the dataset, we propose a benchmark to evaluate the performance of NN-based models for QC and a framework that contains adaptations of 10 models, including the current state of the art. The framework is designed to be extendable and easy to use. The benchmark covers three important tasks in QC: Hamiltonian prediction (see Section 4.1), potential energy and atomic forces prediction (Section 4.2), and conformational optimization (Section 4.3). We implement Hamiltonian prediction models and NNPs within the proposed framework and carefully evaluate them on these three tasks. Models that directly predict wavefunctions, while promising, do not currently scale to large atomic systems and have generalization issues (see Section 2), so we leave their implementation and evaluation for future work. We highlight the **contributions** of this paper as follows: (1) a **universal dataset** that includes more than 30 QC properties such as energies, forces, Hamiltonians and overlap matrices, wavefunction objects, and optimization trajectories for druglike molecules; (2) a **comprehensive benchmark** for evaluating quantum chemistry models, encompassing tasks such as Hamiltonian prediction, energy and force prediction, and conformational optimization, with 12 predefined training and test splits for agile experimental design to assess how model performance depends on the available data and generalization to unseen geometries and novel molecules (see Figure 2); (3) an **extendable framework1** that contains adaptations of 10 quantum chemistry models together with reported benchmark metrics and checkpoints.

## 2 Related work

We begin with related datasets, grouped below according to the source of the original chemical information; detailed information is summarized in Table 1 and Table 9 in the Appendix.

**GDB-11/GDB-13/GDB-17**. QM7 , QM7b , QM8 , and QM9  comprise one of the first families of datasets for ML research in computational chemistry. QM9 is the largest, with 130,000 small molecules in 5 atom types. However, QM9 includes only one low-energy conformation (conformer) per molecule, does not provide atomic forces, and only contains 5 atom types. QH9  is a version of the QM9 dataset that provides Hamiltonians. MultiXC-QM9  is a version of QM9 that provides energies calculated with several basis sets and exchange-correlation functionals. QM7-X  provides forces and contains several conformations per molecule, but it is limited to 7 heavy atoms and has ~7000 unique molecules. QM1B  contains larger molecules and provides 1 billion conformations but does not provide forces. The ANI-1 , ANI-1x, ANI-1cxx  family exceeds QM9 both in the number of conformations and size of molecules: ANI-1x has ~20M conformations for 57,000 molecules, and provides forces; but the ANI-XX family only has 4 atom types. GEOM  is a dataset of conformers for 450K molecules with ~37M conformations, but most computations were performed at a less accurate semi-empirical level of theory.

Figure 2: The figure illustrates the structure of \(^{2}\)DFT, which includes 12 predefined training and test splits designed for agile experimental design. Conformational test splits contain molecules that are also in the training splits, testing the models’ ability to generalize to unseen molecular geometries. In contrast, Scaffold and Structure test sets are entirely independent of the training splits, evaluating the models’ ability to generalize to completely new molecules.

**ChEMBL/CHEMBL27**. OrbNet Denali  contains ~16,000 molecules, ~2,300,000 conformations, and 17 atom types; it does not provide forces and has a low molecule diversity. QMugs  includes ~665,000 molecules and ~2,000,000 conformers, 10 atom types, and up to 228 atoms per molecule. QMugs provides about 50 molecular properties and the density matrix but does not provide forces, and an additional step of the SCF solver is required to obtain the Hamiltonian.

**PubChemChem**. The latest version of PubChemQC  includes 85,938,443 molecules and a single conformer for each molecule, with up to 51 atoms per molecule and 13 atom types. This dataset does not provide forces and Hamiltonians but includes full solver convergence reports that can be parsed to obtain QC properties. The SPICE  dataset combines a subset of PubChem, DES370K, and some other sources of chemical information; the small molecule part of SPICE includes ~14,600 molecules, 730,000 conformations, 10 atom types, and provides information about forces. The main drawbacks include a small number of molecules and the lack of Hamiltonians.

**Combinatorial**. Instead of sampling molecules from a specific database, VQM24  covers the full chemical space of molecules with up to 5 heavy atoms (~258,000 molecules and ~577,000 conformations) via a combinatorial algorithm with filtering. Additionally, conformers of 10,793 molecules with up to 4 heavy atoms are evaluated with quantum Monte Carlo.

**Other domains**. Other QC datasets include materials, chemical reactions, peptides, nanotubes, and more, or provide molecular dynamic (MD) trajectories. ISO17  and MD17  provide MD trajectories for several organic molecules. MD22  is a dataset of MD trajectories for several large atomic structures. OC20 , OC22 , and OC20-Dense  provide optimization trajectories for various adsorbate-catalyst pairs. PCQM4Mv2, a part of the Open Graph Benchmark project , contains a subset of properties from the PubChemQC dataset. QMOF  is a dataset of metal-organic substances. GeckoQ  is a dataset with atomic structures of atmospherically relevant

    & \(^{2}\)**DFT (our)** & \(\)**DFT** & **QM7** & **QM7b** & **QM7-X** & **QM9** & **MultiXC-** & **QM1B** & **Q19** \\  Chem, inf. & & MOSES, & & & & & & & & & \\ source & & ZINC21 (Zinc & ZINC21 (Zinc & GDB-13 & GDB-13 & GDB-13 & GDB-17 & GDB-17 & GDB-11 & GDB-13, \\  & Clean Leads) & Clean Leads) & & & & & & & & \\ \# molecules & 2M & 1M & 7K & 7K & 7K & 134K & 134K & 1M & 130K \\ \# conformers & 1QM & 5M & 7K & 7K & 4M & 134K & 134K & 1B & 130K \\ \# atoms & 8-62 & 8-62 & 1-23 & 1-23 & 1-23 & 3-29 & 3-29 & 9-11 & 3-29 \\ \# heavy atoms & 8-27 & 8-27 & 1-7 & 1-7 & 1-7 & 1-9 & 1-9 & — & 1-9 \\ Atoms & H,C,N,O,S, & H,C,N,O, & & & & & & & & \\  & CL,F,Br & & & & & & & & & \\  & & & & & & & & & & \\  & & & & & & & & & & \\  & & & & & & & & & & \\  & & & & & & & & & & \\   

Table 1: Summary of quantum chemistry datasets; \(*\) - not provided directly but can be derived.

molecules. DES370K  is a dataset of dimers computed with the CCSD(T) level of theory. Transition1x  is a dataset of molecules and reaction pathways.

The key feature of \(^{2}\)DFT that separates it from other datasets is its universality. It provides all the above-mentioned molecular properties, full Psi4 wavefunction objects, Hamiltonian matrices, and geometry optimization trajectories, all calculated at a reasonably accurate DFT level for a large number of diverse molecules with 8 atom types and up to 62 atoms. Moreover, our source of chemical information is the MOSES dataset of structures of commercially available drug-like molecules  (ZINC Clean Leads ), which makes \(^{2}\)DFT most relevant for the chemical and pharmaceutical industry.

**Neural Network Potentials**. NNPs are a family of models that predict potential energies and atomic forces based on conformations; NNPs are useful for downstream applications and represent the primary focus of our benchmark. Most existing models [31; 32; 33; 34; 35; 36; 37; 38; 39; 40] are based on message passing in NNs . Importantly, NNPs can perform molecular dynamics (MD) by predicting forces.

**Wavefunction learning and Hamiltonian prediction**. _PauliNet_ and _FermiNet_ are two deep learning wavefunction Ansatze that provide nearly exact solutions to the electronic Schrodinger equation for single atoms and small molecules such as LiH, ethanol, and bicyclobutane. However, scaling these approaches to larger systems and increasing the number of molecules presents significant challenges: training _PauliNet_ and _Ferminet_ requires a substantial amount of computation even for a system of two nitrogen atoms . Recently proposed models [19; 20; 21; 22; 23; 24; 72; 73] employ Transformers, adapter models structure, and other approaches to get better accuracy and generalization, but still can deal with only small structures and need lots of compute; nevertheless, the \(^{2}\)DFT dataset provides all necessary data for the training of such models. Instead of directly learning a wavefunction, one can predict Hartree-Fock or DFT Hamiltonian matrices. _SchNOrb_ is a direct continuation of the _SchNet_ model . _PhiSNet_ can be seen as a SE(3)-Equivariant variation of _SchNOrb_, which makes it more accurate and stable. _DeepH_ and _DeepH-E3_ are similar models which can be applied to crystal structures. Finally, the works [29; 30] propose variations of _PhiSNet_ tested not only in a single molecule scenario but also on _QM9_-based datasets. Considering this a promising approach, we add three of these models to our benchmark to test their performance and generalizability in a more difficult scenario.

**Geometry optimization with neural networks**. Guan et al.  and Lu et al.  frame the conformation optimization problem as a conditional generation task, training models to generate low-energy conformations conditioned on conformations generated by RDKit or randomly sampled from pseudo-optimization trajectories by minimizing RMSD between predicted and real atom coordinates. Another approach [44; 45; 46] is to use interatomic forces, predicted by an NNP, as antigradients for an optimization method such as L-BFGS . Tsypin et al.  investigate the iterative optimization of molecules and demonstrate that NNPs can match the optimization quality of DFT-based methods by utilizing extensive datasets comprised of geometry optimization trajectories. In this work, we augment \(^{2}\)DFT with geometry optimization trajectories and establish a new benchmark to support further research on the iterative optimization of molecular conformations with NNPs.

## 3 Dataset

The primary contribution of this work is \(^{2}\)**DFT**, an extension of the large-scale **nablaDFT** dataset of QC properties for druglike molecules . \(^{2}\)**DFT** is based on the Molecular Sets (MOSES) dataset ; it contains 1,936,929 molecules with atoms C, N, S, O, F, Cl, Br, and H, 448,854 unique Bemis-Murcko scaffolds , and 58,315 unique BRICS fragments .

For each molecule from the dataset, we have run the conformation generation method from the _RDKit_ software suite  proposed by Wang et al. , getting 1 to 100 conformations per molecule. Next, we clustered the resulting conformations with the Butina clustering method , selected the minimal set of clusters that cover \(95\%\) of the conformations, and included their centroids as conformations in \(^{2}\)**DFT**, obtaining \(1\) to \(69\) unique conformations for each molecule, with 12,676,264 total conformations in the full dataset. For each conformation, we calculated its electronic properties, including the total energy (E), interatomic forces \(\), DFT Hamiltonian matrix (H), and DFT overlap matrix (S) (see the full list in Table 2). All properties were calculated using the Kohn-Sham method  at \(\)B97X-D/def2-SVP level of theory using the quantum-chemical software _Psi4_, version 1.5, with default parameters: the Lebedev-Treutler grid with a Treutler partition of the atomic weights, 75 radial points and 302 spherical points, convergence of energy and density up to \(10^{-6}\) as the criterion for SCF cycle termination, and \(10^{-12}\) as the integral calculation threshold.

We applied a multi-step filtration protocol to ensure the validity of the provided QC computations. We filtered \(31\) molecules from the MOSES dataset where the above procedure could not produce valid conformations. Then, we filtered samples with anomalous values of QC properties: _('DTF TOTAL ENERGY' > 0)_, _('DFT TOTAL DIPOLE' < 20)_, or _('DFT FORMATION ENERGY' < 0)_. We excluded 29 conformations and discarded \(2\) more molecules, totaling \(33\). Finally, 17 additional molecules and 145 conformations with an atomic forces norm exceeding \(99.999\) percentile were discarded.

To set up the \(^{2}\)DFT benchmark, we provide several data splits that can be used to compare different models fairly (see Fig. 2). First, we fix the training set \(^{}\) that consists of 1,583,996 molecules with 8,849,983 conformations and its smaller subsets \(^{}\), \(^{}\), \(^{}\), and \(^{}\) with 99,018, 9689, 5768, and 2809 molecules and 500,552, 49,725, 28,362, and 12,145 conformations respectively. These subsets help study how the performance of various models depends on available data.

We select 176,001 random molecules, not present in \(^{}\), and call it the _structure test set_\(^{}\). We also select another 176,917 molecules containing a Bemis-Murcko scaffold, which are not present in \(^{}\), and call it the _scaffold test set_\(^{}\). Finally, for each training set we have the corresponding _conformation test set_ that contains different conformations of the same molecules: \(^{}\), \(^{}\), \(^{}\), \(^{}\), and \(^{}\), with 1,491,937, 90,973, 9345, 5527, 2747) molecules and 1,542,971, 93,530, 9532, 5634, 2774 conformations respectively (the sizes are different from training sets because molecules with a single conformation cannot appear here). Conformation test sets are designed to test the ability of the models to generalize to unseen _geometries_ of molecules; structure and scaffold test sets, to unseen _molecules_. We expect the conformation test set to be the easiest and the scaffold test set to be the most challenging as it contains unseen molecular fragments.

We also present the second dataset based on \(^{2}\)DFT: \(^{2}\)DFT\({}_{}\) that contains relaxation trajectories for approximately 60K conformations of 17K molecules, resulting in approximately 3M geometries. We report the energy (E) and forces matrix (F) for each geometry from these trajectories. We split the trajectories data into 3 datasets: \(^{}\), \(^{}\), and \(^{}\). \(^{}\) is designed for fast validation of NNPs for conformation optimization contains optimization trajectories of 1000 molecules from \(^{}\) and 1000 molecules from \(^{}\), \(^{}\) contains trajectories for 9538 molecules from \(^{}\), and \(^{}\) provides additional optimization trajectories for 5462 molecules, suitable both for training and validation. As part of the benchmark, we provide databases

  
**Access mode** & **Content** \\  Main data (basic & Atom numbers, atom positions, energy (’DFT FORMATION ENERGY’), forces, \\ dataloader) & Hamiltonian (Fock matrix), overlap matrix, coefficients matrix \\   & ’DFT TOTAL ENERGY’, ’DFT XC ENERGY’, ’DFT NUCLEAR REPULSION \\  & ENERGY’, ’DFT ONE-ELECTRON ENERGY’, ’DFT TWO-ELECTRON ENERGY’, \\  & ’DFT DIPOLE X’, ’DFT DIPOLE Y’, ’DFT DIPOLE Z’, ’DFT TOTAL DIPOLE’, ’DFT ROT CONSTANT A’, ’DFT ROT CONSTANT A’, ’DFT ROT CONSTANT B’, ’DFT ROT CONSTANT C’, ’DFT HOMO’, ’DFT LUMO’, ’DFT HOMO-LUMO GAP’, ’DFT ATOMIC ENERGY’, ’DFT FORMATION ENERGY’ \\   & _All data from two previous rows_. Ca/Cb (molecular orbital coefficients), Da/Db (density matrix), Fa/Fb (Fock matrix), H (Core Hamiltonian), S (overlap matrix), X (XC-functional matrix), aotoso (Atomic Orbital to Symmetry Orbital), \\  & epsilon\_a/epsilon_b (orbital eigenvalues), SCF DIPOLE, doccpi (number of doubly occupied orbitals), nmo (number of molecule orbitals), ’DISPERSIO CORRECTION ENERGY’, ’GRID ELECTRONS TOTAL’ \\   & _All data from three previous rows_. Electric dipole moment, Electric quadrupole moment, \\  & All moments up order N, Electrostatic potential at nuclei, Electrostatic potential on grid, \\   & Electric field on grid, Molecular orbital extents, Mulliken atomic charges, Löwdin atomic charges, Wiberg bond indices, Mayer bond indices, Natural orbital occupations, \\   & Stockholder Atomic Multipoles, Hirshfeld volume ratios \\   

Table 2: Properties available for each data instance in \(^{2}\)DFT.

for each subset and task and a complete archive with wavefunction files produced by _Psi4_ that contain QC properties of the corresponding molecule and can be used in further computations.

## 4 Benchmark setup and results

The goal of our benchmark is to advance and standardize studies in the field of machine learning methods for computational quantum chemistry. We focus on three fundamental tasks: (1) DFT Hamiltonian matrix prediction, (2) molecular conformation energy and atomic forces prediction, and (3) conformational optimization. In the first two tasks, we measure the ability of state-of-the-art models to generalize across a diverse set of molecules. In the third, we evaluate the performance of NNPs trained to predict energies and atomic forces for conformational optimization. For the Hamiltonian prediction task we compare _SchNOrb_, _PhiSNet_ and _QHNet_ models; note that we predict full Hamiltonian (Fock) matrices, while Khrabrov et al.  predicted core Hamiltonian matrices. For the energy and atomic forces prediction, we compare linear regression, _SchNet_, _SchNOrb_, _Dimenet++_, _PaiNN_, _Graphormer3D_, _GemNet-OC_[37; 38], _EquiformerV2_, and _eSCN_. All models have been trained on \(^{}\), \(^{}\), \(^{}\), \(^{}\) subsets of \(^{2}\)DFT and evaluated on \(^{},^{},^{ }\) with mean absolute error (MAE), as shown in (2), (3), (4). Details of the training procedure are given in Appendix A.

### Hamiltonian matrix prediction

Neural networks are trained to minimize \(L_{1}\) or \(L_{2}\) loss for the Hamiltonian matrix \(^{n_{s} n_{s}}\), where \(n_{s}\) is the number of electronic orbitals for a conformation \(s\). PhiSNet and SchNOrb are also trained to predict the overlap matrix \(S\), and SchNOrb predicts energy. A comparison of the MAE metrics (see Appendix B.3) is reported in Table 3. _PhiSNet_ performs best, even though training did not converge for larger splits (we stopped training after 1920 GPU hours). The _SchNOrb_ model benefits vastly from the additional energy prediction task, compared with , but still performs worse than _PhiSNet_ and _QHNet_, which agrees with the results of a single molecule setup .

The models perform better on the conformation test splits \(^{}\); this is expected because the training set is more similar to the test set in this case. Hamiltonian prediction results on \(^{2}\)DFT are worse than previously published; e.g., _PhiSNet_ has MAE \(1.8 10^{-5}E_{h}\) for the molecules from _MD17_; _QHNet_, \(7 10^{-5}E_{h}\) on _QH9_. We believe this is caused by a higher diversity of \(^{2}\)DFT, and our benchmark highlights generalization issues of Hamiltonian prediction models.

### Energy and atomic forces prediction

We denote the DFT energy for conformation \(s\) as \(E_{s}\). For energy and atomic forces prediction, a neural network takes a conformation \(s\) as input and outputs the energy \(_{s}=f(s;),\;f(s;):\{,\} \). To predict interatomic forces, we take the gradients of \(_{s}\) w.r.t. coordinates of atoms \(\) in case of _SchNet_, _PaiNN_ and _DimeNet++_+: \(}_{s}\ =\ )}{},}_{s}\ \ ^{n 3}\), where \(n\) is the number of atoms in the system. For _EquiformerV2_, _Graphormer3D_, _GemNet-OC_ and _eSCN_ we use a separate head:

    &  & E_{h}\)} & \)} \\  & & \(^{}\) & \(^{}\) & \(^{}\) & \(^{}\) & \(^{}\) & \(^{}\) & \(^{}\) & \(^{}\) & \(^{}\) \\   & SchNOrb & 19.8 & 19.6 & 19.6 & 19.8 & 1320 & 1310 & 1320 & 1340 \\  & PhiSNet & **0.19** & **0.32** & **0.34** & **0.36** & **2.7** & **3.0** & **2.9** & **3.3** \\  & QHNet & 0.98 & 0.79 & 0.52 & 0.69 & - & - & - & - \\   & SchNOrb & 19.9 & 19.8 & 20. & 19.9 & 1330 & 1320 & 1330 & 1340 \\  & PhiSNet & **0.19** & **0.32** & **0.34** & **0.36** & **2.6** & **2.9** & **2.9** & **3.2** \\  & QHNet & 0.98 & 0.79 & 0.52 & 0.69 & - & - & - & - \\   & SchNOrb & 21.5 & 20.7 & 20.7 & 20.6 & 1410 & 1360 & 1370 & 1370 \\  & PhiSNet & **0.18** & **0.33** & **0.35** & **0.37** & **3.0** & **3.2** & **3.1** & **3.5** \\   & QHNet & 0.84 & 0.73 & 0.52 & 0.68 & - & - & - & - \\   

Table 3: Prediction metrics for Hamiltonian and overlap matrices; mean absolute error, less is better.

[MISSING_PAGE_FAIL:8]

## 5 Limitations

\(^{2}\)DFT does not contain solvated molecules or protein-ligand pairs (important for ML applications in drug design). It lacks charged and open-shell systems, nano-particles, nanotubes, big rings, and other non-drug-like structures. Moreover, \(^{2}\)DFT is unsuitable for material science and inorganic chemistry and for ML-based studies of long-range and non-covalent interactions.

## 6 Conclusion

This work introduces \(^{2}\)DFT, a universal dataset of drug-like molecules for quantum chemistry models. It contains ~16 million conformations of ~2 million molecules, with key properties such as energy, forces, and Hamiltonian matrices. A unique property of \(^{2}\)DFT is relaxation trajectories for ~60,000 conformations of ~17,000 molecules, aiding conformational optimization research. We propose a novel benchmark for evaluating quantum chemistry models and an extendable framework for training them. Our experiments highlight the importance of training on large datasets and emphasize the need for further dataset development.