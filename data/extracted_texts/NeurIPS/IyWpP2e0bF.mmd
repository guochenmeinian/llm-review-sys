# Block Coordinate Plug-and-Play Methods

for Blind Inverse Problems

 Weijie Gan

Washington University in St. Louis

weijie.gan@wustl.edu

&Shirin Shoushtari

Washington University in St. Louis

s.shirin@wustl.edu

&Yuyang Hu

Washington University in St. Louis

h.yuyang@wustl.edu

&Jiaming Liu

Washington University in St. Louis

jiaming.liu@wustl.edu

&Hongyu An

Washington University in St. Louis

hongyuan@wustl.edu

&Ulugbek S. Kamilov

Washington University in St. Louis

kamilov@wustl.edu

###### Abstract

Plug-and-play (PnP) prior is a well-known class of methods for solving imaging inverse problems by computing fixed-points of operators combining physical measurement models and learned image denoisers. While PnP methods have been extensively used for image recovery with known measurement operators, there is little work on PnP for solving blind inverse problems. We address this gap by presenting a new block-coordinate PnP (BC-PnP) method that efficiently solves this joint estimation problem by introducing learned denoisers as priors on both the unknown image and the unknown measurement operator. We present a new convergence theory for BC-PnP compatible with blind inverse problems by considering _nonconvex_ data-fidelity terms and _expansive_ denoisers. Our theory analyzes the convergence of BC-PnP to a stationary point of an _implicit_ function associated with an _approximate_ minimum mean-squared error (MMSE) denoiser. We numerically validate our method on two blind inverse problems: automatic coil sensitivity estimation in magnetic resonance imaging (MRI) and blind image deblurring. Our results show that BC-PnP provides an efficient and principled framework for using denoisers as PnP priors for jointly estimating measurement operators and images.

## 1 Introduction

Many problems in computational imaging, biomedical imaging, and computer vision can be formulated as _inverse problems_ involving the recovery of high-quality images from low-quality observations. Imaging inverse problems are generally ill-posed, which means that multiple plausible clean images could lead to the same observation. It is thus common to introduce prior models on the desired images. While the literature on prior modeling of images is vast, current methods are often based on _deep learning (DL)_, where a deep model is trained to map observations to images .

_Plug-and-play (PnP) priors_ is one of the most widely-used DL frameworks for solving imaging inverse problems. PnP methods circumvent the need to explicitly describe the full probability density of images by specifying image priors using image denoisers. The integration of state-of-the-art deep denoisers with physical measurement models within PnP has been shown to be effective in a number of inverse problems, including image super-resolution, phase retrieval, microscopy, andmedical imaging  (see also recent reviews ). Practical success of PnP has also motivated novel extensions, theoretical analyses, statistical interpretations, as well as connections to related approaches such as score matching and diffusion models .

Despite the rich literature on PnP, the existing work on the topic has primarily focused on the problem of image recovery where the measurement operator is known exactly. There is little work on PnP for _blind_ inverse problems, where both the image and the measurement operator are unknown. This form of blind inverse problems are ubiquitous in computational imaging with well-known applications such as blind deblurring  and parallel magnetic resonance imaging (MRI) . In this paper, we address this gap by developing a new PnP approach that uses denoisers as priors over both the unknown measurement model and the unknown image, and efficiently solves the joint estimation task as a _block-coordinate PnP (BC-PnP)_ method. While a variant of BC-PnP was proposed in the recent paper , it was never used for jointly estimating the images and the measurement operators. Additionally, the convergence theory in  is inadequate for blind inverse problems since it assumes convex data-fidelity terms and nonexpansive denoisers. We present a new convergence analysis applicable to _nonconvex_ data-fidelity terms and _expansive_ denoisers. Our theoretical analysis provides explicit error bounds on the convergence of BC-PnP for _approximate_ minimum mean squared error (MMSE) denoisers under a set of clearly specified assumptions. We show the practical relevance of BC-PnP by solving joint estimation problems in blind deblurring and accelerated parallel MRI. Our numerical results show the potential of denoisers to act as PnP priors over the measurement operators as well as images. Our work thus addresses a gap in the current PnP literature by providing a new efficient and principled framework applicable to a wide variety of blind imaging inverse problems.

All proofs and some details that have been omitted for space appear in the supplementary material.

## 2 Background

**Inverse Problems.** Many imaging problems can be formulated as inverse problems where the goal is to estimate an unknown image \(^{n}\) from its degraded observation \(=+\), where \(^{m n}\) is a measurement operator and \(^{m}\) is the noise. A common approach for solving inverse problems is based on formulating an optimization problem

\[}^{n}}{}\,f() f()=g()+h()\;,\] (1)

where \(g\) is the data-fidelity term that quantifies consistency with the observation \(\) and \(h\) is the regularizer that infuses a prior on \(\). For example, a widely-used data-fidelity term and regularizer in computational imaging are the least-squares \(g()=\|-\|_{2}^{2}\) and the total variation (TV) functions \(h()=\|\|_{1}\), where \(\) is the image gradient, and \(>0\) a regularization parameter.

The traditional inverse problem formulations assume that the measurement operator \(\) is known exactly. However, in many applications, it is more practical to model the measurement operator as \(()\), where \(^{p}\) are unknown parameters to be estimated jointly with \(\). This form of inverse problems are often referred to as _blind_ inverse problems and arise in a wide-variety of applications, including prallell MRI , blind deblurring , and computed tomography .

**DL.** There is a growing interest in DL for solving imaging inverse problems . Instead of explicitly defining a regularizer, DL approaches for solving inverse problems learn a mapping from the measurements to the desired image by training a convolutional neural network (CNN) to perform regularized inversion . Model-based DL (MBDL) has emerged as powerful DL framework for inverse problems that combines the knowledge of the measurement operator with an image prior specified by a CNN (see reviews ). The literature of MBDL is vast, but some well-known examples include PnP, regularization by denoising (RED), deep unfolding (DU), compressed sensing using generative models (CSGM), and deep equilibrium models (DEQ) . All these approaches come with different trade-offs in terms of imaging performance, computational and memory complexity, flexibility, need for supervision, and theoretical understanding.

The literature on DL approaches for blind inverse problems is broad, with many specialized methods developed for different applications. While an in-depth review would be impractical for this paper, we mention several representative approaches adopted in prior work. The direct application of DL to predict the measurement operator from the observation was explored in . Deep image prior (DIP) was used as a learning-free prior to regularize the image and the measurement operator in . Generative models, including both GANs and diffusion models, have been explored as regularizers for blind inverse problems in . Other work considered the use of a dedicated neural network to predict the parameters of the measurement operator, adoption of model adaptation strategies, and development of autocalibration methods based on optimization .

**PnP**. PnP  is one of the most popular MBDL approaches based on using deep denoisers as imaging priors (see also recent reviews ). For example, the proximal gradient method variant of PnP (referred to as PnP-ISTA in this paper) can be formulated as a fixed-point iteration 

\[^{k}_{}(^{k}) ^{k}^{k-1}- g(^{k-1})\;,\] (2)

where \(_{}\) is a denoiser with a parameter \(>0\) for controlling its strength and \(>0\) is a step-size. The theoretical convergence of PnP-ISTA has been explored for convex functions \(g\) using monotone operator theory  as well as for nonconvex functions based on interpreting the denoiser as a MMSE estimator . The analysis in this paper builds on the convergence theory in  that uses an elegant formulation by Gribonval  establishing a direct link between MMSE estimation and regularized inversion. Many variants of PnP have been developed over the past few years , which has motivated an extensive research on its theoretical properties .

_Block coordinate regularization by denoising (BC-RED)_ is a recent PnP variant for solving large-scale inverse problems by updating along a subset of coordinates at every iteration . BC-RED is based on regularization by denoising (RED), another well-known variant of PnP that seeks to formulate an explicit regularizer for a given image denoiser . BC-RED was applied to several non-blind inverse problems and was theoretically analyzed for convex data-fidelity terms.

PnP was extended to blind deblurring in  by considering an additional prior on blur kernels that promotes sparse and nonegative solutions. PnP was also applied to holography with unknown phase errors by using the Gaussian Markov random field model as the prior for the phase errors . _Calibrated RED (Cal-RED)_ is a recent related extension of RED that calibrates the measurement operator during RED reconstruction by combining the traditional RED updates over an unknown image with a gradient descent over the unknown parameters of the measurement operator. However, this prior work does not leverage any learned priors for the measurement operator and does not provide any theoretical analysis.

**Our contributions.**_(1)_ Our first contribution is in the use of learned deep denoisers for regularizing the measurement operators within PnP. While the idea of calibration within PnP was introduced in , denoisers were not used as priors for measurement operators. **(2)** Our second contribution is the application of BC-PnP as an efficient method for jointly estimating the unknown image and the measurement operator. While BC-RED was introduced in  as a block-coordinate variant of PnP, the method was used for solving non-blind inverse problems by using patch-based image denoisers. **(3)** Our third contribution is a new convergence theory for BC-PnP for the _sequential_ and _random_ block-selection strategies under approximate MMSE denoisers. Our analysis does _not_ assume convex data-fidelity terms, which makes it compatible with blind inverse problems. Our analysis can be seen as an extension of  to block-coordinate updates and approximate MMSE denoisers. **(4)** Our fourth contribution is the implementation of BC-PnP using learned deep denoisers as priors for two distinct blind inverse problems: blind deblurring and auto-calibrated parallel MRI. Our code--which we share publicly--shows the potential of learning deep denoisers over measurement operators and using them for jointly estimating the uknown image and the uknown measurement operator.

## 3 Block Coordinate Plug-and-Play Method

We propose to efficiently solve blind inverse problems by using a block-coordinate PnP method, where each block represents one group of unknown variables (images, measurement operators, etc). The novelty of our work relative to  is in solving blind inverse problems by introducing learned priors on both the unknown image and the uknown measurement operator. Additionally, unlike , our work proposes a fully nonconvex formulation that is more applicable to blind inverse problems.

Consider the decomposition of a vector \(^{n}\) into \(b 1\) blocks

\[=(_{1},,_{b})^{n_{1}} ^{n_{b}} n=n_{1}++n_{b}.\] (3)For each \(i\{1,,b\}\), we define a matrix \(_{i}^{n n_{i}}\) that injects a vector in \(^{n_{i}}\) into \(^{n}\) and its transpose \(_{i}^{}\) that extracts the \(i\)th block from a vector in \(^{n}\). For any \(^{n}\), we have

\[=_{i=1}^{b}_{i}_{i}_{i}= _{i}^{}^{n_{i}}, i=1,,b _{i=1}^{b}_{i}_{i}^{}= .\] (4)

Note that (4) directly implies the norm preservation \(\|\|_{2}^{2}=\|_{1}\|_{2}^{2}++\|_{b}\|_{2}^{2}\) for any \(^{n}\). We are interested in a block-coordinate algorithm that uses only a subset of operator outputs corresponding to coordinates in some block \(i\{1,,b\}\). Hence, for an operator \(:^{n}^{n}\), we define the block-coordinate operator \(_{i}:^{n}^{n_{i}}\) as

\[_{i}()\,\,[()]_{i}=_{i}^{ }()^{n_{i}},^{ n}.\] (5)

We are in-particular interested in two operators: (a) the gradient \( g()=(_{1}g(),,_{b}g())\) of the data-fidelity term \(g\) and (b) the denoiser \(_{}()=(_{_{1}}(_{1}),, _{_{b}}(_{b}))\), where the vector \(=(_{1},,_{b})^{b}_{+}\) consists of parameters for controlling the strength of each block denoiser. Note how the denoiser acts in a separable fashion across different blocks.

When \(b=1\), we have \(_{1}=_{1}^{}=\) and BC-PnP reduces to the conventional PnP-ISTA . When \(b>1\), we have at least two blocks with BC-PnP updating only one block at a time

\[_{j}^{k}=_{j}^{k-1}&j i_{k}\\ _{_{j}}(_{j}^{k-1}-_{j}g(^{k-1}))& j=i_{k}, j\{1,,b\}.\] (6)

As with any coordinate descent method (see  for a review), BC-PnP can be implemented using different block selection strategies. One common strategy is to simply update blocks sequentially as \(i_{k}=1+(k-1,b)\), where \(()\) denotes the modulo operator. An alternative is to proceed in epochs of \(b\) consecutive iterations, where at the start of each epoch the set \(\{1,,b\}\) is reshuffled, and \(i_{k}\) is then selected consecutively from this ordered set. Finally, one can adopt a fully randomized strategy where indices \(i_{k}\) are selected as i.i.d. random variables distributed uniformly over \(\{1,,b\}\).

Throughout this work, we will assume that each denoiser \(_{_{i}}\) is an _approximate_ MMSE estimator for the following AWGN denoising problem

\[_{i}=_{i}+_{i}_{i} p_{ _{i}},_{i}(0,_{i}^{2}),\] (7)

where \(i\{1,,b\}\) and \(_{i}^{n_{i}}\). We rely only on an _approximation_ of the MMSE estimator of \(_{i}\) given \(_{i}\), since the _exact_ MMSE denoiser corresponds to the generally intractable posterior mean

\[_{_{i}}^{*}(_{i})\,\,[_{i}| {z}_{i}]=_{^{n_{i}}}p_{_{i}|_{i}}(|_{i})\,.\] (8)

Approximate MMSE denoisers are a useful model for denoisers due to the use of the MSE loss

\[(_{_{i}})=[\|_{i}-_ {_{i}}(_{i})\|_{2}^{2}]\] (9)

for training deep denoisers, as well as the optimality of MMSE denoisers with respect to widely used image-quality metrics such as signal-to-noise ratio (SNR).

As a simple illustration of the generality of BC-PnP, consider \(b=2\) with the least-squares objective

\[g()=\|-()\|_{2}^{2}\,\,(,),\] (10)where \(^{n_{i}}\) denotes the unknown image and \(^{n_{2}}\) denotes the unknown parameters of the measurement operator. BC-PnP can then be implemented by first pre-training a dedicated AWGN denoiser \(_{_{i}}\) for each block \(i\) and using it as a prior within Algorithm 1. It is also worth noting that the functions \(g\) in (10) is nonconvex with respect to the variable \(^{n}\). In the next section, we present the full convergence analysis of BC-PnP without any convexity assumptions on \(g\) and nonexpansiveness assumptions on the denoiser \(_{}\).

## 4 Convergence Analysis of BC-PnP

In this section, we present two new theoretical convergence results for BC-PnP. We first discuss its convergence under the sequential updates and then under fully random updates. It is worth mentioning that BC-RED with fully random updates was theoretically analyzed in . The novelty of our analysis here lies in that it allows for nonconvex functions \(g\) and expansive denoisers \(_{_{i}}\). The nonconvexity of \(g\) is essential since most data-fidelity terms used for blind inverse problems are nonconvex. On the other hand, by allowing expansive \(_{_{i}}\), our analysis avoids the need for the spectral normalization techniques that were previously suggested for PnP methods [21; 22].

In the following, we will denote as \(_{}^{*}(_{_{1}}^{*},, _{_{b}}^{*})\) the exact MMSE denoiser in (8). Our analysis will require five assumptions that will serve as sufficient conditions for our theorems.

**Assumption 1**.: _The blocks \(_{i}\) are independent with non-degenerate priors \(p_{_{i}}\) over \(^{n_{i}}\)._

As a reminder, a probability distribution \(p_{_{i}}\) is _degenerate_ over \(^{n_{i}}\), if it is supported on a space of lower dimensions than \(n_{i}\). Assumption 1 is required for establishing an explicit link between the MMSE denoiser (8) and the following regularizer (see also [23; 66] for additional background)

\[h()=_{i=1}^{b}h_{i}(_{i}),=(_{1},,_{n})^{n},\] (11)

where each function \(h_{i}\) is defined as (see the derivation in Section D.2 of the supplement)

\[h_{i}(_{i})\,\,-\|_{i}-( _{_{i}}^{*})^{-1}(_{i})\|_{2}^{2}+^{2}}{ }h_{_{i}}((_{_{i}}^{*})^{-1}(_{i}))&_{i}(_{ _{i}}^{*})\\ +&_{i}(_{_{i}}^{*}), \] (12)

where \(>0\) is the step size, \((_{_{i}}^{*})^{-1}:(_{_{i}}^{*}) ^{n_{i}}\) is the inverse mapping, which is well defined and smooth over \((_{_{i}}^{*})\), and \(h_{_{i}}()\,\,-(p_{_{i}}())\), where \(p_{_{i}}\) is the probability distribution over the AWGN corrupted observations (7). Note that the function \(h_{i}\) is smooth for any \(_{i}(_{_{i}}^{*})\), which is the consequence of the smoothness of both \((_{_{i}}^{*})^{-1}\) and \(h_{_{i}}\).

**Assumption 2**.: _The function \(g\) is continuously differentiable and \( g\) is Lipschitz continuous with constant \(L>0\). Additionally, each block gradient \(_{i}g\) is block Lipschitz continuous with constant \(L_{i}>0\). We define the largest block Lipschitz constant as \(L_{}\,\,\{L_{1},,L_{b}\}\)._

Lipschitz continuity of the gradient \( g\) is a standard assumption in the context of imaging inverse problems. Note that we always have the relationship \((L/b) L_{} L\) (see Section 3.2 in ).

**Assumption 3**.: _The explicit data-fidelity term and the implicit regularizer are bounded from below_

\[_{^{n}}g()>-,_{ ^{n}}h()>-.\] (13)

Assumption 3 implies that there exists \(f^{*}>-\) such that \(f() f^{*}\) for all \(^{n}\). Since Assumptions 1-3 correspond to the standard assumptions used in the literature, they are broadly satisfied in the context of inverse problems.

Our analysis assumes that at every iteration, BC-PnP uses inexact MMSE denoisers on each block. While there are several ways to specify the nature of "inexactness," we consider the case where at every iteration \(k\) of BC-PnP the distance of the output of \(_{_{i}}\) to \(_{_{i}}^{*}\) is bounded by a constant \(_{k}\).

**Assumption 4**.: _Each block denoiser \(_{_{i}}\) in \(_{}\) satisfies_

\[\|_{_{i}}(_{i}^{k})-_{_{i}}^{*}(_{i} ^{k})\|_{2}_{k}, i\{1,,b\}, k=1,2,3,,\]

_where \(_{_{i}}^{*}\) is given in (8) and \(_{i}^{k}=_{i}^{k-1}-_{i}g(^{k-1})\)._For convenience, we will define quantities \(^{2}\,\,\{_{1}^{2},_{2}^{2}, \}\) and \(_{i}^{2}\,\,(1/t)(_{1}^{2}++ _{t}^{2})\) that correspond to the largest and the mean squared-distances between the inexact and exact denoisers. Assumption 4 states that the error of the approximate MMSE denoiser used for inference is bounded relative to the exact MMSE denoiser, which is reasonable when the approximate MMSE denoiser is a CNN trained to minimize the MSE.

It has been shown in the prior work  that the function \(h\) in (11) is infinitely continuously differentiable over \((_{}^{*})\). Our analysis requires the extension of the region where \(h\) is smooth to include the range of the approximate MMSE denoiser, which is the goal of our next assumption.

**Assumption 5**.: _Each regularizer \(h_{i}\) in (12) associated with the MMSE denoiser (8) is continously differentiable and has a Lipschitz continuous gradient with constant \(M_{i}>0\) over the set_

\[_{}(_{_{i}}^{*})\,\,\{ ^{n_{i}}:\|-_{_{i}}^{*}()\|_{2} ,\,^{n_{i}}\}, i\{1,,b\}.\]

We will define \(M_{}\,\,\{M_{1},,M_{b}\}\) to be the largest Lipschitz constant and \(_{}(_{}^{*})\,\,\{ ^{n}:_{i}_{}(_{_{ i}}^{*}),\,i\{1,,b\}\}\) to be the set over which \(h\) is smooth. Assumption 5 expands the region where the regularizer associated with the exact MMSE denoiser is smooth by including the range of the approximate MMSE denoiser. For example, this assumption is automatically true when the exact and approximate MMSE denoisers have the same range, which is reasonable when the approximate MMSE denoiser is trained to imitate the exact one.

Our first theoretical result considers the sequential updates, where at each iteration, \(i_{k}\) is selected as \(i_{k}=1+(k-1,b)\) with \(()\) being the modulo operator. We can then express any iterate \(ib\) produced by BC-PnP for \(i 1\) as

\[^{ib}=(_{1}^{ib},,_{b}^{ib})=(_{1}^{(i-1)b+1}, ,_{b}^{ib}).\]

Note that \(^{ib}_{}(_{}^{*})\) since each block is an output of the denoiser. We prove the following result.

**Theorem 1**.: _Run BC-PnP under Assumptions 1-5 using the sequential block selection and the step \(0<<1/L_{}\). Then, we have_

\[}\,\| f(^{ib})\|_{2}^{2} _{i=1}^{t}\| f(^{ib})\|_{2}^{2}}{t} (f(^{0})-f^{*})+C_{2}_{tb}^{2},\]

_where \(C_{1}>0\) and \(C_{2}>0\) are iteration independent constants. If additionally the sequence of error terms \(\{_{i}\}_{i 1}\) is square-summable, we have that \( f(^{tb})\) as \(t 0\)._

Our second theoretical result considers fully random updates, where at each iteration, \(i_{k}\) is selected as i.i.d. random variables distributed over \(\{1,,b\}\). In this setting, we analyze the convergence of BC-PnP in terms of the sequence \(\{(^{k})\}_{k 0}\). Note that it is straightforward to verify that \(()=( f)\), which makes this analysis meaningful. We prove the following result.

**Theorem 2**.: _Run BC-PnP under Assumptions 1-5 using the random i.i.d. block selection and the step \(0<<1/L_{}\). Then, we have_

\[}\,[\|(^{k-1} )\|_{2}^{2}][_{k=1}^{t}\|( ^{k-1})\|_{2}^{2}]}{t}(f(^{0})-f^{*})+D_{2} _{t}^{2},\]

_where \(D_{1}>0\) and \(D_{2}>0\) are iteration independent constants. If additionally the sequence of error terms \(\{_{i}\}_{i 1}\) is square-summable, we have that \((^{t})}{}\) as \(t\)._

The expressions for the constants in Theorems 1 and 2 are given in the proofs. The theorems show that if the sequence of approximation errors is square-summable, BC-PnP asymptotically achieves a stationary point of \(f\). On the other hand, if the sequence of approximation errors is not square-summable, the convergence is only up to an error term that depends on the average of the squared approximation errors. Both theorems can thus be viewed as more flexible alternatives for the convergence analysis in . It is also worth mentioning that the theorems are interesting even when the denoiser errors are not square-summable, since they provide explicit error bounds on convergence. While the analysis in  assumes convex \(g\) and nonexpansive \(_{}\), the analysis here does not require these two assumptions. It instead views the denoiser \(_{}\) as an _approximation_ to the MMSE estimator \(_{}^{*}\), where the approximation error is bounded by \(_{k}\) at every iteration of BC-PnP. This view is compatible with denoisers trained to minimize the MSE loss (9).

## 5 Numerical Validation

We numerically validate BC-PnP on two blind inverse problems: (a) _compressed sensing parallel MRI (CS-PARI)_ with automatic coil sensitivity map (CSM) estimation and (b) _blind image deblurring_. We adopt the traditional \(_{2}\)-norm loss in (10) as the data-fidelity term for both problems. We will use \(\) to denote the unknown image and \(\) to denote the unknown parameters of the measurement operator. We use the relative root mean squared error (RMSE) and structural similarity index (SSIM) as quantitative metrics to evaluate the performance.

We experimented with several ablated variants of BC-PnP, including PnP, PnP-GD\({}_{}\), and PnP-oracle\({}_{}\). PnP and PnP-oracle\({}_{}\) denote basic variants of PnP that use pre-estimated and ground truth measurement operators, respectively. PnP-GD\({}_{}\) is a variant of PnP based on , where \(\) is estimated without any DL prior. It is worth noting that PnP-oracle\({}_{}\) is provided as an idealized reference in our experiment. As discussed in the following subsections, we also compare BC-PnP against several widely-used baseline methods specific to CS-PMRI and blind image deblurring.

### Compressed Sensing Parallel MRI

The measurement operator of CS-PMRI consists of complex measurement operators \(()^{m n}\) that depend on unknown CSMs \(\{_{i}\}\) in \(^{n}\). Each sub-measurement operator can be parameterized as \(_{i}(_{i})=(_{i})\), where \(\) is the Fourier transform, \(^{m n}\) is the sampling operator, and \((_{i})\) forms a matrix by placing \(_{i}\) on its diagonal. We used T2-weighted MR brain acquisitions of 165 subjects obtained from the validation set of the fastMRI dataset  as the the fully sampled measurement for simulating measurements. We obtained reference \(_{i}\) from the fully sampled measurements using ESPIRiT . These 165 subjects were split into 145, 10, and 10 for training, validation, and testing, respectively. BC-PnP and baseline methods were tested on 10 2D slices, randomly selected from the testing subjects. We followed  to retrospectively undersample the fully sampled data using 1D Cartesian equispaced sampling masks with 10% auto-calibration signal (ACS)  lines. We conducted our experiments for acceleration factors \(R=6\) and \(8\). We adopted DRUNet  as the architectures of \(_{}\) for training both the image and CSM denoisers. BC-PnP and its ablated variants are initialized using CSMs \(_{0}\) pre-estimated using ESPIRiT  and images \(_{0}(_{0})^{}\), where \(^{}\) denotes the Hermitian transpose of \(\).

We considered several baseline methods, including ENLIVE , ESPIRiT-TV , Unet , and ISTANet+ . ENLIVE is an iterative algorithm that jointly estimates images and coil sensitivity profiles. ESPIRiT-TV is an iterative algorithm that applies TV reconstruction method in (1). Unet is trained to map raw measurements to desired ground truth without the knowledge of measurement operator. ISTANet+ denotes a widely-used DU architecture. We tested ESPIRiT-TV and ISTANet+ using CSMs pre-estimated using ESPIRiT.

Figure 1 illustrates the convergence behaviour of BC-PnP on the test set for the acceleration factor \(R=8\). Figure 2 illustrates reconstruction results for the acceleration factor \(R=6\). Table 1 summarizes the quantitative evaluation of BC-PnP relative to other PnP variants and the baseline methods. These results show that joint estimation can lead to significant improvements and that BC-PnP can perform as well as the idealized PnP-oracle\({}_{}\) that knowns the true measurement operator.

Figure 1: _Illustration of the BC-PnP convergence using the sequential and random i.i.d. block selection rules on CS-PMRI with the sampling factor \(R=8\). Leftmost two plots: Evolution of the distance between two consecutive image and CSM iterates. Rightmost three plots: Evolution of the RMSE and SSIM metrics relative to the true solutions across BC-PnP iterations. Note how both block selection rules lead to a nearly identical convergence behaviour of BC-PnP in this experiment._

### Blind Image Deblurring

The measurement operator in blind image deblurring can be modeled as \(()=*\), where \(\) is the unknown blur kernel, \(\) is the unknown image, and \(*\) is the convolution. We randomly selected 10 testing ground truth image from CBSD68  dataset. We generated \(25 25\) Gaussian kernels with \(=10^{1}\). We tested the algorithms on 2 Gaussian kernels. We used a pre-trained image denoiser, as in the experimental setting of . The kernel denoiser was trained on 10,000 generated kernels at several noise levels. We adopted DnCNN with 17 layers as the architectures of \(_{}\) for training kernel denoisers. BC-PnP and its ablated variants are initialized with the blur kernels \(_{0}\) pre-estimated using Pan-DCP  and images \(_{0}(_{0})^{}\).

We compared BC-PnP against several baseline methods, including Pan-DCP , SelfDeblur , DeblurGAN , USRNet . Pan-DCP is an optimization-based method that jointly estimates image and blur kernel. SelfDeblur trains two deep image priors (DIP)  to jointly estimate the blur kernel and the image. DeblurGAN is a supervised learning-based method that lacks the capability for kernel estimation, but can reconstruct images via direct inference. USRNet is a DU baseline that was tested using blur kernel estimated from . The results of DeblurGAN and USRNet are obtained by running the published code with the pre-trained weights.

Figure 3 illustrates the reconstruction results with a Gaussian kernel. Figure 3 demonstrates that BC-PnP can reconstruct the fine details of the snake skin, as highlighted by the white arrows, while both Pan-DCP and PnP produce smoother reconstructions. Additionally, BC-PnP generates a more accurate blur kernel compared to the ground truth kernel, whereas Pan-DCP and SelfDeblur yield blur kernels with artifacts. Table 2 presents the quantitative evaluation of the reconstruction results using

    &  &  &  \\   & & \(_{}_{}_{}_{}_{} _{}\) \\  ENLIVE  & ✓ & 0.371 & 0.763 & — & 0.419 & 0.730 & — \\ ESPIRiT-TV  & ✓ & 0.218 & 0.884 & 0.256 & 0.361 & 0.818 & 0.356 \\ Unet  & ✗ & 0.218 & 0.904 & — & 0.195 & 0.907 & — \\ ISTANet+  & ✗ & 0.110 & 0.946 & — & 0.140 & 0.928 & — \\  PnP & ✗ & 0.111 & 0.950 & 0.256 & 0.171 & 0.924 & 0.356 \\  PnP-GD\({}_{}\) & ✓ & 0.116 & 0.950 & 0.254 & 0.163 & 0.926 & 0.355 \\  BC-PnP (Ours) & ✓ & 0.091 & 0.961 & 0.247 & 0.122 & 0.946 & 0.337 \\  PnP-oracle\({}_{}\)\({}^{}\) & ✗ & 0.069 & 0.969 & 0.000 & 0.082 & 0.962 & 0.000 \\   ^{}\) not available in practice for blind inverse problems.} \\ 

Table 1: RMSE and SSIM performance of several methods on CS-PMRI. The table highlights the best and second best results. The _Calibration_ column highlights methods specifically designed to solve the blind inverse problem. Note how the use of a DL prior over the measurement operator enables BC-PnP to outperform PnP and PnP-GD\({}_{}\) and approach the performance of the oracle algorithm.

Figure 2: _Illustration of results from several well-known methods on CS-PMRI with the sampling factor \(R=6\). The quantities in the top-left corner of each image provide RMSE and SSIM values for each method. The squares at the bottom of each image visualize the error and the corresponding zoomed area in the image. Note how BC-PnP using a deep denoiser on the unknown CSMs outperforms uncalibrated PnP and matches PnP-oracle\({}_{}\) that knows the true CSMs._a Gaussian kernel, indicating that BC-PnP outperforms the baseline methods and nearly matches the SSIM and RMSE values of PnP-\(_{}\) that is based on the ground truth blur kernel.

## 6 Conclusion

The work presented in this paper proposes a new BC-PnP method for jointly estimating unknown images and unknown measurement operators in blind inverse problems, presents its theoretical analysis in terms of convergence and accuracy, and applies the method to two well-known blind inverse problems. The proposed method and its theoretical analysis extend the recent work on PnP by introducing a learned prior on the unknown measurement operator, dropping the convexity assumptions on the data-fidelity term, and nonexpansiveness assumptions on the denoiser. The numerical validation of BC-PnP shows the improvements due to the use of learned priors on the measurement operator and the ability of the method to match the performance of the oracle PnP method that knows the true measurement operator. One conclusion of this work is the potential effectiveness of PnP for solving inverse problems where the unknown quantities are not only images.

## Limitations

The work presented in this paper comes with several limitations. The proposed BC-PnP method is based on PnP, which means that its performance is inherently limited by the use of AWGN denoisers as priors. While denoisers provide a convenient, principled, and flexible mechanism to specify priors,

    &  & \)} & \)} \\   & & \(_{}_{}_{}\) & \(_{}_{}_{}\) \\  Pan-DCP  & ✓ & 0.087 & 0.835 & 0.283 & 0.114 & 0.733 & 0.246 \\ SelfDeblur  & ✓ & 0.219 & 0.495 & 0.775 & 0.176 & 0.553 & 0.831 \\ DeblurGAN  & � & 0.090 & 0.823 & — & 0.118 & 0.716 & — \\ USRNet  & � & 0.106 & 0.855 & — & 0.114 & 0.769 & — \\  PnP & � & 0.082 & 0.857 & 0.283 & 0.106 & 0.763 & 0.246 \\ PnP-GD\({}_{}\) & ✓ & 0.082 & 0.857 & 0.283 & 0.108 & 0.767 & 0.246 \\ BC-PnP (Ours) & ✓ & 0.055 & 0.921 & 0.097 & 0.098 & 0.794 & 0.107 \\  PnP-\(_{}\)\({}^{}\) & � & 0.051 & 0.929 & 0.000 & 0.088 & 0.817 & 0.000 \\  ^{}\) not available in practice for blind inverse problems.} \\ 

Table 2: Quantitative evaluation of BC-PnP in blind image deblurring. We highlighted the best and second best results, respectively. The _Calibration_ column highlights methods specifically designed to solve the blind inverse problem. Note how the use of a prior over the measurement operator enables BC-PnP to nearly match the performance of the oracle algorithm.

Figure 3: _Illustration of results from several well-known methods on blind image deblurring with the Gaussian kernel. The squares at the top of each image show the estimated kernels. The quantities in the top-left corner of each image provide RMSE and SSIM values for each method. The squares at the bottom of each image highlight the error and the corresponding zoomed image region. Note how the BC-PnP using a deep denoiser on the unknown kernel significantly outperforms the traditional PnP method and matches the performance of the oracle PnP method that knows the true blur kernel. Note also the effectiveness of BC-PnP for estimating the unknown blur kernel._

they are inherently self-supervised and their empirical performance can thus be suboptimal compared to priors trained in a supervised fashion for a specific inverse problem. PnP running over many iterations can also have higher computational complexity compared to some end-to-end alternatives, such as DU with a small number of steps. Our analysis is based on the assumption that the denoiser used for inference computes an approximation of the true MMSE denoiser. While this assumption is reasonable for deep denoisers trained using the MSE loss, it is not directly applicable to denoisers trained using other common loss functions, such as the \(_{1}\)-norm or SSIM. Finally, as is common with most theoretical work, our analysis only holds when our assumptions are satisfied, which might limit its applicability in practice. Our future work will investigate ways to improve on the results presented here by exploring new PnP strategies for relaxing assumptions for convergence, considering end-to-end trained variants of BC-PnP based on DEQ , and exploring BC-PnP using explicit regularizers .

## Broader Impact

The expected impact of this work is in the area of imaging inverse problems with potential applications to computational imaging. There is a growing interest in computational imaging to leverage pre-trained deep models for estimating the unknown image as well as the unknown parameters of the imaging system. The ability to better address such problems can lead to new imaging tools for biomedical and scientific studies. While novel DL methods, such as the proposed BC-PnP approach, have the potential to enable new technological capabilities, they also come with a downside of being more complex and requiring higher-levels of technical sophistication. While our aim is to positively contribute to humanity, one can unfortunately envisage nonethical use of imaging technology.

Research presented in this article was supported in part by the NSF CCF-2043134. This work is also supported by the NIH R01EB032713, RF1AG082030, RF1NS116565, and R21NS127425.