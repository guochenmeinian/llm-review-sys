# CLIP4HOI: Towards Adapting CLIP for

Practical Zero-Shot HOI Detection

 Yunyao Mao\({}^{1}\) Jiajun Deng\({}^{2}\) Wengang Zhou\({}^{1}\)\({}^{}\) Li Li\({}^{1}\) Yao Fang\({}^{3}\) Houqiang Li\({}^{1}\)\({}^{1}\)

\({}^{1}\)CAS Key Laboratory of Technology in GIPAS, EEIS Department,

University of Science and Technology of China

\({}^{2}\)The University of Adelaide, AIML \({}^{3}\)Merchants Union Consumer Finance Company Limited

myy2016@mail.ustc.edu.cn, jiajun.deng@adelaide.edu.au, zhwg@ustc.edu.cn

li11@ustc.edu.cn, fangyao@mucfc.com, lihq@ustc.edu.cn

Corresponding authors: Wengang Zhou and Houqiang Li

###### Abstract

Zero-shot Human-Object Interaction (HOI) detection aims to identify both seen and unseen HOI categories. A strong zero-shot HOI detector is supposed to be not only capable of discriminating novel interactions but also robust to positional distribution discrepancy between seen and unseen categories when locating human-object pairs. However, top-performing zero-shot HOI detectors rely on seen and predefined unseen categories to distill knowledge from CLIP and jointly locate human-object pairs without considering the potential positional distribution discrepancy, leading to impaired transferability. In this paper, we introduce CLIP4HOI, a novel framework for zero-shot HOI detection. CLIP4HOI is developed on the vision-language model CLIP and ameliorates the above issues in the following two aspects. First, to avoid the model from overfitting to the joint positional distribution of seen human-object pairs, we seek to tackle the problem of zero-shot HOI detection in a disentangled two-stage paradigm. To be specific, humans and objects are independently identified and all feasible human-object pairs are processed by Human-Object interactor for pairwise proposal generation. Second, to facilitate better transferability, the CLIP model is elaborately adapted into a fine-grained HOI classifier for proposal discrimination, avoiding data-sensitive knowledge distillation. Finally, experiments on prevalent benchmarks show that our CLIP4HOI outperforms previous approaches on both rare and unseen categories, and sets a series of state-of-the-art records under a variety of zero-shot settings.

## 1 Introduction

Human-Object Interaction (HOI) detection aims at locating paired humans and objects and identifying their interactions. It finds applications in several downstream tasks, including surveillance, robotics, and human-computer interaction. Despite significant progress in recent years, in most previous works, the task of HOI detection has been conventionally restricted to predefined HOI categories. Given the flexibility of verb-object combinations in human-object interaction scenarios, obtaining a comprehensive dataset is laborious and time-consuming. Moreover, the obtained detectors also struggle to generalize to unseen HOI categories, even if both verb and object in the novel category are present (but never composed together) in the training set. These facts motivate and highlight the exploration of zero-shot HOI detection, which targets to development of transferable HOI detectors. Latest zero-shot HOI detectors  seek to harness the general visual and linguistic knowledge of CLIP  for identifying novel HOIs. Despite notable advancements over conventional compositional learning approaches , these methods exhibit certain limitations.

First, the prevailing approaches  adhere to the one-stage framework, where each query or pair thereof is required to jointly localize the human and the object. This strategy bears the inherent risk of overfitting the decoder to the joint positional distribution of human-object pairs for seen HOI categories, which results in compromised efficacy of the model when encountering novel HOIs that exhibit significant distribution discrepancy with the seen categories, as shown in Figure 1b. Second, the knowledge of CLIP is transferred to the detector through knowledge distillation, the effectiveness of which largely depends on the completeness of the training data. However, given the absence of unseen categories during training, the distillation process is dominated by samples from seen categories, resulting in impaired generalization of the model to unseen categories. Although the latest approach  tries to mine potential unseen categories during training, the text descriptions of unseen categories are required in advance. As a result, the generalization capability of the detector is restricted to predefined unseen HOI categories, which is not conducive to practical applications.

To this end, we propose CLIP4HOI, a novel framework for zero-shot generalizable HOI detection. On the one hand, in view of the overfitting issue associated with the joint localization of humans and objects, we seek to tackle the problem of zero-shot HOI detection in a two-stage paradigm, as shown in Figure 1a. Specifically, with the help of an off-the-shelf object detector, the first stage focuses on the accurate identification of humans and objects from images, followed by traversing all feasible human-object combinations in the Human-Object (HO) interactor for pairwise HOI proposal generation. On the other hand, instead of employing data-sensitive knowledge distillation from CLIP to existing detectors, we demonstrate that the adapted CLIP is a natural fit for generalizable fine-grained HOI discrimination. Specifically, based on the generated pairwise proposals, a transformer-based HOI decoder is designed to aggregate contextual visual clues from the output of the CLIP image encoder. HOI scores are then obtained in the HOI classifier by comparing the text embeddings of prompted HOI descriptions with the visual features from different granularities. The final scores for all human-object pairs are the integration of HOI scores and the object class priors out of the object detector. Thanks to the distribution-agnostic pairwise proposal generation and the strong transferability of CLIP, the resulting HOI detector exhibits better robustness to positional distribution discrepancy and superior generalization capability to unseen HOI categories, as shown in Figure 1c.

To verify the effectiveness, we conducted extensive experiments on two prevalent HOI detection benchmarks, _i.e._, HICO-DET  and V-COCO . Results show that our approach exhibits superior performance under a variety of zero-shot settings. Specifically, compared to previous state-of-the-art methods GEN-VLKT  and EoID , our CLIP4HOI achieves absolute mAP gains of 6.43, 4.67, and 8.41 on the unseen categories of RF-UC, NF-UC, and UO settings, respectively. Moreover, our CLIP4HOI also demonstrates exceptional performance under the fully supervised setting, particularly in rare categories where it outperforms Liu _et al._ by 3.65 mAP on the HICO-DET dataset.

Overall, we make the following three-fold contributions:

* Given the compromised generalization capability of the joint human-object localization, we propose a novel two-stage framework, termed CLIP4HOI, for zero-shot HOI detection, which leverages the generalizable knowledge of CLIP for unseen interaction identification.

Figure 1: In our CLIP4HOI, the CLIP model is elaborately adapted for fine-grained pairwise HOI discrimination, avoiding data-sensitive knowledge distillation (a). Thanks to the distribution-agnostic proposal generation, our CLIP4HOI demonstrates better robustness when encountering large positional distribution discrepancy between seen and unseen HOI categories (b)(c). The distribution statistics are the angles between the line from the person to the object and the x-axis. The distribution discrepancy is measured with KL divergence.

* Instead of relying on data-sensitive knowledge distillation, we demonstrate that by carefully designing the adaptation modules, the CLIP model itself exhibits a strong capability for fine-grained HOI discrimination, enabling the unrivaled zero-shot transferability of our CLIP4HOI.
* We conduct extensive experiments on two prevalent benchmarks to verify the effectiveness of the proposed approach. Compared to previous methods, our CLIP4HOI exhibits remarkable performance and sets a series of state-of-the-art records.

## 2 Related Work

**Human-Object Interaction Detection:** There are two mainstream solutions for HOI detection, one-stage and two-stage. Two-stage methods [4; 10; 11; 12; 15; 26; 28; 29; 33; 25; 26; 29; 33; 37; 42; 56] first detect human and object instances in the image with an off-the-shelf object detector. Then relation modeling strategies like multi-steam fusion  and graph reasoning  are designed to identify interactions between each pair of detected humans and objects. One-stage methods, on the other hand, undertake detection, association, and classification in a single stage. Early one-stage methods adopt interaction point [30; 45] or union box  as anchors to facilitate the joint localization of humans and objects. Recent one-stage approaches [5; 6; 21; 23; 24; 40; 41; 43; 57; 24] have been inspired by the query-based object detector , wherein a group of learnable queries is employed in the transformer decoder to simultaneously predict \( human,verb,object\) triplets. Despite the promising performance under the fully-supervised setting, we argue that such a joint localization strategy tends to overfit the decoder to the joint position distribution of humans and objects for known verb-object combinations. Therefore in this work, we seek to solve the problem of zero-shot HOI detection in a more generalizable two-stage paradigm.

**Contrastive Language-Image Pre-Training:** Contrastive Language-Image Pre-Training (CLIP)  is a multimodal learning framework that entails joint training of an image encoder and a text encoder on large-scale image-text pairs. While traditional approaches rely exclusively on either visual or textual cues for learning, CLIP utilizes both modalities to acquire a shared representation space that aligns images and their corresponding captions in a common embedding space. The outcome of this joint training is the ability of CLIP to facilitate zero-shot and few-shot learning on a variety of downstream tasks, including image classification , object detection [8; 13; 9], and image retrieval . The success of CLIP also opens up new avenues for zero-shot HOI detection.

**Zero-shot Human-Object Interaction Detection:** Zero-shot human-object interaction (HOI) detection strives to develop a detector that can effectively generalize to HOI categories not encountered during training. It is of practical significance due to the flexibility of verb-object combinations.

Early works [17; 18; 19; 20; 34; 36; 2; 2; 34] mainly adopt compositional learning for zero-shot HOI detection. VCL  decomposes HOI representation into object- and verb-specific features and then composes novel HOI samples in the feature space via stitching the decomposed features. FCL  introduces an object fabricator to generate large-scale HOI samples for rare and unseen categories. ATL  decouples HOI representation into a combination of affordance and object representation. Novel interactions are then discovered by combining affordance representation and novel object representation from additional object images. ConsNet  proposes a knowledge-aware framework for explicit relation modeling among objects, actions, and interactions in an undirected graph. It leverages graph attention networks to enable knowledge propagation among HOI categories and their constituents. SCL  devises a self-compositional learning framework for HOI concept discovery.

Recently, the development of multimodal learning has led to a surge of interest in transferring knowledge from pre-trained vision-language models like CLIP  to existing HOI detectors for high-performance zero-shot HOI detection. GEN-VLKT  extracts CLIP text embeddings for prompted HOI labels to initialize the classifier and leverages the CLIP visual feature to guide the learning of interactive representation. EoID  distills the distribution of action probability from CLIP to the HOI model and detects potential action-agnostic interactive human-object pairs by applying an interactive score module combined with a two-stage bipartite matching algorithm. To avoid data-sensitive knowledge distillation and facilitate better transferability, in our approach, the CLIP model is directly adapted as a fine-grained classifier for generalizable HOI identification.

As a concurrent work, HOICLIP  adopts the one-stage design following GEN-VLKT  and proposes query-based knowledge retrieval for efficient knowledge transfer from CLIP to HOI detection tasks. During evaluation, it exploits zero-shot CLIP knowledge as a training-free enhancement.

Differently, our CLIP4HOI leverages the two-stage proposal generation strategy to mitigate the overfitting of the method to the joint positional distribution of human-object pairs during training.

## 3 Preliminary

### Problem Formulation

In this section, we introduce the problem formulation of zero-shot HOI detection. Let \(=\{v_{1},v_{2},,v_{N_{v}}\}\) be the set of action verbs and \(=\{o_{1},o_{2},,o_{N_{o}}\}\) be the set of objects that can be interacted with. The conventional fully-supervised solutions try to incorporate samples of all feasible verb-object pairs \(=\{(v_{i},o_{j})|v_{i};o_{j}\}\) into the training set and assign each sample a discrete label for to learn a closed-set classifier. Given the inherent flexibility of verb-object combinations, it is impractical to collect a complete HOI dataset. Consequently, researchers have pursued the zero-shot HOI detection paradigm as an alternative direction, where the detector needs to generalize well to unseen categories \(_{}\) during the test. Let \(_{}\), \(_{}\), and \(_{}_{}\) denote seen verbs, seen objects, and seen categories during training, respectively. According to whether verbs and objects in the unseen categories \(_{}\) exist during training, zero-shot HOI detection can be divided into three settings: (1) Unseen Composition (UC), where for all \((v_{i},o_{j})_{}\), we have \(v_{i}_{}\) and \(o_{j}_{}\); (2) Unseen Object (UO), where for all \((v_{i},o_{j})_{}\), we have \(v_{i}_{}\) and \(o_{j}_{}\); (3) Unseen Verb (UV), where for all \((v_{i},o_{j})_{}\), we have \(v_{i}_{}\) and \(o_{j}_{}\).

### Revisiting DETR

DEtection TRansformer (DETR)  is an end-to-end object detector that approaches object detection as a direct set prediction problem. At the core of DETR is a transformer encoder-decoder architecture, which is responsible for processing the input image and producing a set of object queries that correspond to potential objects in the image. DETR uses a bipartite matching algorithm that associates the object queries with ground-truth objects during training. Thanks to this query-based detection paradigm, we can easily obtain the features corresponding to each detected instance, enabling efficient extraction of pairwise representation for interaction recognition.

## 4 Methodology

### Framework Overview

In this section, we give an overview of the proposed framework. As shown in Figure 2, The proposed CLIP4HOI comprises three key components: Human-Object interactor (HO interactor), HOI decoder, and HOI classifier. Given a single image as input, all humans and objects are first detected using a pre-trained transformer-based detector DETR . Then, the HO interactor takes the decoded query features that correspond to individual human-object pairs as input and derive pairwise HOI tokens through feature interaction and pairwise spatial information injection. After that, with pairwise HOI tokens serving as the input queries, the HOI decoder is engaged to generate pairwise HOI visual features by aggregating the contextual visual clues from the output of the CLIP image encoder. Finally, in the HOI classifier, global and pairwise HOI scores are obtained by comparing the text embeddings of prompted HOI descriptions with the class token from the CLIP image encoder and the decoded pairwise HOI visual features, respectively.

### HO Interactor

Following , the detections from DETR are first post-processed with non-maximum suppression and thresholding. The filtered result is denoted as \(\{,,,\}\), where \(^{N_{d} 4}\), \(^{N_{d} C_{d}}\), \(\{0,1,,N_{c}-1\}^{N_{d}}\), and \(^{N_{d}}\) denote bounding boxes, decoded query features, object classes, and confidence scores, respectively. \(N_{d}\) denotes the number of detected instances. Then, we perform feature interaction between instances and traverse all valid human-object pairs to generate pairwise HOI tokens \(\). These are done through the Human-Object Interactor (HO Interactor). Specifically, the HO Interactor borrows the design of the lightweight interaction head in UPT , which consists of a cooperative layer and a competitive layer. Given the detected boxes, unary and pairwise spatial features  (box center, width, height, pairwise IOU, relative area, and direction) are first extracted and mapped into pairwise positional encodings \(^{N_{d} N_{d} C_{r}}\). Then, decoded query feature \(^{N_{d} C_{d}}\) of detected instances are fed into the cooperative layer along with \(\) for feature interaction and pairwise spatial information injection:

\[}=(,)^{N_{d}  C_{r}}.\] (1)

After that, the competitive layer generates pairwise HOI tokens \(\) for all valid human-object pairs:

\[_{}=\{(u,v)|u v,c_{u}=\},\] (2) \[_{}^{N_{} 2C_{r}}, _{}^{[i]}=(}^{[u]},}^{[v]}),\ (u,v)=_{}^{[i]},\] (3) \[_{}^{N_{} C_{r }},_{}^{[i]}=^{[u,v]},\ (u,v)= _{}^{[i]},\] (4) \[=(_{}, _{},_{})^{N_{} 2 C_{r}},\] (5)

where \(_{}\) is the index set of valid human-object pairs and has size \(N_{}\). \(_{}^{1 C_{b}}\) is the global visual feature from the backbone of DETR . Please refer to  and also the supplementary material for more technical details of the HO interactor.

### HOI Decoder

After obtaining the pairwise HOI tokens, we feed them into the HOI decoder to aggregate contextual features from the CLIP image encoder, yielding pairwise HOI visual features. Specifically, the HOI decoder is stacked by \(N_{l}\) customized transformer layers, each of which contains a cross-attention block, a self-attention block, and a feed-forward network (FFN) block. Given the collection of pairwise HOI tokens \(^{N_{} 2C_{r}}\), patch level CLIP image features \(^{N_{} C_{c}}\), and the global CLIP image class token \(^{1 C_{c}}\), the pairwise HOI visual features \(^{N_{} C_{c}}\) are computed as follows:

\[_{0}=(),\] (6) \[_{l}^{}=((_{l-1 }),(),())+_{l-1}, l 1,,N_{l}\] (7) \[_{l}^{}=(((,_{l}^{})))+(,_{l}^{ }), l 1,,N_{l}\] (8) \[_{l}=((_{l}^{ [1:}))+_{l}^{[1:}, l 1,,N_{l}\] (9) \[=_{N_{l}},\] (10)

Figure 2: The pipeline of the proposed CLIP4HOI. CLIP4HOI is developed based on the prevalent DETR  with three new components, _i.e._, HO interactor, HOI decoder, and HOI classifier. Based on the detections from DETR, the HO interactor generates pairwise HOI tokens by feature interaction and spatial information injection. The HOI decoder then aggregates the CLIP image representation to produce pairwise HOI visual features, with the pairwise HOI tokens serving input queries. Finally, in the HOI classifier, global and pairwise HOI scores are obtained by comparing the text embeddings of HOI descriptions with the CLIP image class token and the pairwise HOI visual features, respectively.

where Linear denotes the linear projection \(_{}():^{2C_{r}}^{C_{c}}\) that maps the pairwise HOI tokens into CLIP's joint feature space. LN, MHCA, MHSA, MLP, and CAT denote layer normalization, multi-head cross-attention, multi-head self-attention, multilayer perceptron, and concatenation, respectively. So far, the obtained pairwise HOI visual features \(\) integrate the relative positional information between humans and objects as well as the contextual visual clues from the large-scale pre-trained CLIP model, greatly promoting the subsequent fine-grained HOI recognition.

### HOI Classifier

Given the notable transferability of the CLIP model, this study endeavors to adapt it as a fine-grained classifier for transferable HOI detection. Thanks to the shared embedding space of image and text learned by CLIP after large-scale contrastive pre-training, we can perform fine-grained HOI recognition for both seen and unseen HOI categories by transforming their verb-object combinations into textual descriptions and comparing their embeddings with pairwise HOI visual features. Considering that the manual prompt lacks task-specific heuristics and robustness , we choose to train a learnable prompt for text embedding generation. Specifically, we insert several learnable tokens before the verb and object of each HOI category following , which we denote as [PREFIX] and [CONJUN], respectively. We denote the obtained text embedding as \(^{N_{c} C_{o}}\) (\(N_{c}\) denotes the number of HOI categories). As shown in Figure 2, we compute both global and pairwise HOI scores as follows:

\[^{}=(), ^{}=(),\] (11) \[}=(),} =(^{}),}=( ^{}),\] (12) \[_{}=(} }^{}/),_{}=( }}^{}/),\] (13)

where Linear denotes the linear projection head \(_{}():^{C_{o}}^{C_{o}}\), Norm denotes L2 normalization operation, and \(\) is the learnable scale factor that rescales the intermediate logits.

The obtained global and pairwise scores \(_{}^{1 N_{c}}\) and \(_{}^{N_{} N_{c}}\) indicate the presence of HOI categories in the whole image and each human-object pair, respectively. Since each human-object pair may correspond to multiple HOI categories, we adopt the Sigmoid function when computing the HOI scores instead of Softmax with mutually exclusive properties. During inference, the two HOI scores along with the class priors from the object detector are integrated to produce the final classification result for each human-object proposal.

### Training and Inference

**Training:** For the global HOI score, the training label is the union of all seen HOI categories present in the image. For the pairwise HOI score, we compare each proposal (detected human-object pair) to the seen HOI targets. When the IOU of both the human and the object exceeds a certain threshold, we consider the proposal a positive sample for the compared target and assign the corresponding label to it. Note that a single proposal may correspond to multiple HOI labels. Considering the scarcity of positive samples, we adopt binary focal loss for training. The final training loss is formulated as the combination of global loss and pairwise loss:

\[_{}=(_{}, _{})+(_{},_{}),\] (14)

where \(_{}\{0,1\}^{1 N_{c}}\) and \(_{}\{0,1\}^{N_{} N_{c}}\) are global and pairwise labels, respectively. \(\) is a hyper-parameter that adjusts the weight of pairwise loss.

**Inference:** Let \(_{}^{N_{} 1}\) and \(_{}^{N_{} 1}\) be the confidence scores out of DETR for paired humans and objects. During inference, the final HOI scores \(_{}^{N_{} N_{c}}\) are obtained by element-wise multiplication (with broadcasting) of \(_{}\), \(_{}\), \(_{}\), and \(_{}\):

\[_{}=_{}_{}_{}^{}_{}^{},\] (15)

where a hyper-parameter \(\) is introduced to suppress overconfident detections following . \(N_{c}\) is equal to the number of seen/full HOI categories during training/test. Based on the object class priors provided by DETR, scores of irrelevant HOIs in \(_{}\) are manually set to 0.

## 5 Experiments

### Implementation Details

We adopt pre-trained DETR as the object detector, with ResNet-50  serving as the backbone. The HOI classifier is built upon the CLIP model, which takes ViT-B/16  as its visual encoder. During training, the parameters of both the DETR and CLIP models are frozen. The HOI decoder has \(N_{l}=6\) layers. In each layer, the embedding dimension is 768, the head number of the multi-head attention is 12, and the hidden dimension of the feed-forward network is 3072. The prompt lengths for [PREFIX] and [CONJUN] are 8 and 2, respectively. Following , the hyper-parameter \(\) is set to 1 during training and 2.8 during inference. Please refer to the supplementary material for the training details.

### Compare with the State-of-the-art Methods

**Zero-Shot HOI Detection:** In Table 1, we evaluate the generalization capability of our approach on the HICO-DET  dataset. Performance is reported under three zero-shot settings.

Under the Unseen Composition (UC) setting, CLIP4HOI surpasses most previous top-performing methods. Specifically, compared to EoID , our CLIP4HOI exhibits relative mAP improvements of 29.17% (**28.47**_vs_ 22.04) and 17.44% (**31.44**_vs_ 26.77) on unseen categories under rare first UC and non-rare first UC settings, respectively. Notably, our CLIP4HOI also outperforms the concurrent work HOICLIP  by considerable margins in terms of the unseen mAP.

For a fair comparison with previous methods, under the Unseen Object (UO) setting, we provide an additional variant of our approach (marked with * in Table 1), which only uses the bounding boxes of the detections as subsequent inputs. Results show that both versions of our CLIP4HOI exhibit outstanding performance. Specifically, our CLIP4HOI surpasses HOICLIP  by a relative mAP improvement of 16.79% (**18.92**_vs_ 16.20) on the unseen categories.

Following GEN-VLKT , EoID , and HOICLIP , we report the performance of our approach under the Unseen Verb (UV) setting, where the proposed CLIP4HOI also exhibits promising results. It is worth mentioning that compared to the previous state-of-the-art methods, the advantages is mainly reflected in unseen categories, _e.g._, relative mAP improvements of 14.58% (**26.02**_vs_ 22.71) and 7.08% (**26.02**_vs_ 24.30) compared to EoID  and HOICLIP , respectively. This demonstrates the superior generalization capability of our approach.

Table 1: Zero-shot HOI detection results on HICO-DET. UC, UO, and UV denote unseen composition, unseen object, and unseen verb settings, respectively. RF- and NF- denote rare first and non-rare first.

**Fully-supervised HOI Detection:** This work focuses on the development of a transferable HOI detector. Nonetheless, we also test the efficacy of our CLIP4HOI for fully-supervised HOI detection, as shown in Table 2. For the HICO-DET  dataset, the proposed approach demonstrates remarkable performance, outperforming GEN-VLKT  by a margin of 1.11 mAP for full categories. It is worth mentioning that the performance improvement mainly comes from the rare categories, where our CLIP4HOI outperforms GEN-VLKT and  by margins of 4.70 mAP and 3.65 mAP, respectively. This indicates that the HOI classifier adapted from CLIP can better handle the long-tailed distribution of HOI categories. For the V-COCO  dataset, we ignore HOIs defined with no object labels and report the results in Scenario 2. As shown in Table 2, our CLIP4HOI achieves 66.3 role AP, surpassing GEN-VLKT  and  by margins of 1.8 mAP and 1.1 mAP, respectively. Compared to the concurrent work HOICLIP , our approach also shows advantages on rare categories and performs better under the default setting.

**Robustness to Distribution Discrepancy:** In Table 3, we report the mAP gain of CLIP4HOI over previous top-performing EOID . Performance is evaluated on four unseen subsets of the HICO-DET dataset under the NF-UC setting, each of which exhibits varying degrees of positional distribution discrepancy (measured with KL divergence) from its corresponding seen subset. Results show that our CLIP4HOI exhibits better robustness to positional distribution discrepancy. A detailed definition of the distribution discrepancy is in the supplementary material.

### Ablation Study

In this section, we conduct several ablative experiments to verify the effectiveness of our CLIP4HOI. Performance is evaluated on HICO-DET under the RF-UC setting.

**Component Analysis:** As shown in Table 4, we first verified the effectiveness of: (1) _HO interactor_. Without the HO interactor, the overall performance drops by 1.1 mAP, verifying the effectiveness of pairwise feature interaction and spatial information injection. (2) _HOI decoder_. The HOI decoder is designed to aggregate relevant CLIP visual features for better feature alignment in interaction recognition, without which the performance drops by 3.54 mAP and 4.67 mAP for seen and unseen categories, respectively.

    &  &  &  \\   & & & Default & &  & \\   & & Full & Rare & Non-rate & Full & Rare & Non-rate & AP\({}_{role}^{S2}\) \\  IDN(NeurIPS20)  & ResNet-50 & 23.36 & 22.47 & 23.63 & 26.43 & 25.01 & 26.85 & 60.3 \\ Zou _et al._(CVPR21)  & ResNet-50 & 23.46 & 16.91 & 25.41 & 26.15 & 19.24 & 28.22 & - \\ HOTR(CVPR21)  & ResNet-50 & 25.10 & 17.34 & 27.42 & - & - & - & 64.4 \\ ATL(CVPR21)  & ResNet-50 & 28.53 & 21.64 & 30.59 & 31.18 & 24.15 & 33.29 & - \\ AS-Net(CVPR21)  & ResNet-50 & 28.87 & 24.25 & 30.25 & 31.74 & 27.07 & 33.14 & - \\ QPIC(CVPR21)  & ResNet-50 & 29.07 & 21.85 & 31.23 & 31.68 & 24.14 & 33.93 & 61.0 \\ FCL(CVPR21)  & ResNet-50 & 29.12 & 23.67 & 30.75 & 31.31 & 25.62 & 33.02 & - \\ GGNNet(CVPR21)  & ResNet-50 & 29.17 & 22.13 & 30.84 & 33.50 & 26.67 & 34.89 & - \\ SCG(IJCV21)  & ResNet-50 & 31.33 & 24.72 & 33.31 & 34.37 & 27.18 & 36.52 & 60.9 \\ UPT(CVPR21)  & ResNet-50 & 31.66 & 25.94 & 33.36 & 35.05 & 29.27 & 36.77 & 64.5 \\ CDN(NeurIPS21)  & ResNet-50 & 31.78 & 27.55 & 33.05 & 34.53 & 29.73 & 35.96 & 64.4 \\ Iwin(ECCV22)  & ResNet-50 & 32.03 & 27.62 & 34.14 & 35.17 & 28.79 & 35.91 & - \\ Liu _et al._(CVPR22)  & ResNet-50 & 33.51 & 30.30 & 34.46 & 36.28 & 33.16 & 37.21 & 65.2 \\ GEN-VLKT(CVPR22)  & ResNet-50 & 33.75 & 29.25 & 35.10 & 36.78 & 32.75 & 37.99 & 64.5 \\ HOICLIP(CVPR2)  & ResNet-50 & 34.69 & 31.12 & **35.74** & **37.61** & 34.47 & **38.54** & 64.8 \\
**CLIP4HOI** & ResNet-50 & **35.33** & **33.95** & **35.74** & 37.19 & **35.27** & 37.77 & **66.3** \\   

Table 2: Fully-supervised HOI detection results on HICO-DET and V-COCO test sets.

   KL divergence & [0,0.3) & [0,3.0) & [0,6.0) & [0.9,\(\)) \\  EOID  & 26.69 & 27.50 & 26.82 & 18.92 \\
**CLIP4HOI** & **30.97** & **33.06** & **34.15** & **28.23** \\ mAP gain & 4.28 & 5.56 & 7.33 & 9.31 \\   

Table 3: Robustness comparison between our CLIP4HOI and EOID against distribution discrepancy. Performance is evaluated on the unseen categories of HICO-DET under the NF-UC setting.

Then, we explored the input of the HOI decoder: (1) _CLIP class token_. In the HOI decoder, the CLIP class token \(\) is incorporated as the input of the self-attention block. Without \(\), the overall performance decreases slightly by 0.58 mAP, which verifies the effectiveness of the CLIP class token for providing holistic representation of input images. (2) _Mid-level CLIP features_. We also train a variant of CLIP4HOI where each layer of the HOI decoder aggregates the corresponding mid-level features of the CLIP visual encoder layer. Experiments show that aggregating mid-level CLIP visual features results in an overall performance drop of 1.25 mAP.

Finally, we discussed the design of the HOI classifier: (1) _Global HOI score_. While the performance of CLIP4HOI on seen categories exhibits a minor improvement of 0.58 mAP upon removing the global HOI score, the efficacy of the model to identify novel interactions deteriorates significantly by 2.99 mAP. (2) _Class priors from DETR_. The removal of the class priors out of DETR caused a consistent decrease in performance, particularly a drop of 3.79 mAP for unseen categories.

**HOI Decoder Layer Number:** In Table 4(a), we experimented with different numbers of HOI decoder layers. Results show that a layer number of 6 exhibits the best overall performance. Adding more layers does not bring consistently better performance, but higher computational overhead.

**Text Prompt Length:** As shown in Table 4(b), we explored the impact of different prompt lengths for text embedding generation. Results show that the best performance is observed when the lengths of [PREFIX] and [CONJUN] are set to 8 and 2, respectively. We also experimented with the manual prompt "A photo of a person [verb][object]", whose performance is much lower than the learnable one, especially for the unseen categories (23.92 _vs_**28.47** in mAP).

**Training Loss Weight:** We investigate the impact of varying weights for pairwise loss in Table 4(c). Results show that the performance of CLIP4HOI is not substantially influenced by the weight of loss functions. A straightforward summation of global and pairwise losses just works well.

### Qualitative Visualization

As shown in Figure 3, we visualize some detection results and their corresponding attention maps in the HOI decoder. We can find that: (1) The HOI decoder can effectively attend to the regions associated with human-object interactions, resulting in accurate aggregation of contextual visual clues from the output of the CLIP image encoder. (2) The obtained HOI detector exhibits remarkable discrimination capability for unseen categories.

  Configuration & Full & Seen & Unseen \\ 
**Full version** & **34.08** & 35.48 & **28.47** \\ 
**Global:** & & & \\ w/o HO interactor & 32.98 & 34.36 & 27.43 \\ w/o HOI decoder & 30.31 & 31.94 & 23.80 \\ 
**HOI decoder:** & & & \\ w/o CLIP class token & 33.50 & 34.85 & 28.10 \\ w/ Mid-level CLIP features & 32.83 & 34.40 & 26.56 \\ 
**HOI classifier:** & & & \\ w/o Global HOI score & 33.94 & **36.06** & 25.48 \\ w/o Class priors from DETR & 33.13 & 35.24 & 24.68 \\  

Table 4: Component analysis of CLIP4HOI on HICO-DET. The performance is evaluated on HICO-DET under the rare first UC (RF-UC) setting.

Table 5: Ablative experiments for hyper-parameters like (a) HOI decoder layer number, (b) text prompt length, and (c) training loss weight. The manual prompt is set to ”A photo of a person [verb][object]”. The performance is evaluated on HICO-DET under the rare first UC (RF-UC) setting.

## 6 Conclusion

This paper presents CLIP4HOI, a novel two-stage framework for zero-shot HOI detection, where the generalizable knowledge of the vision-language model CLIP is leveraged for novel interaction identification. By disentangling the detection of humans and objects in the proposal generation phase, the proposed approach exhibits strong robustness to the positional distribution discrepancy between seen and unseen HOI categories. To avoid data-sensitive knowledge distillation and facilitate better knowledge transfer for novel human-object interactions, the CLIP model is elaborately adapted into a fine-grained classifier for pairwise HOI discrimination. Extensive experiments on two prevalent benchmarks verify the effectiveness of the proposed CLIP4HOI framework.

## 7 Acknowledgments

This work was supported by NSFC under Contract U20A20183 and 62021001. It was also supported by GPU cluster built by MCC Lab of Information Science and Technology Institution, USTC, and the Supercomputing Center of the USTC.