# A Globally Optimal Portfolio for m-Sparse Sharpe Ratio Maximization

Yizun Lin\({}^{1}\)   Zhao-Rong Lai\({}^{1}\)   Cheng Li\({}^{1}\)

\({}^{1}\)Department of Mathematics

College of Information Science and Technology

Jinan University, Guangzhou, China

{linyizun,laizhr}@jnu.edu.cn

licheng@stu2020.jnu.edu.cn

Correspondence to: Zhao-Rong Lai

###### Abstract

The Sharpe ratio is an important and widely-used risk-adjusted return in financial engineering. In modern portfolio management, one may require an \(m\)-sparse (no more than \(m\) active assets) portfolio to save managerial and financial costs. However, few existing methods can optimize the Sharpe ratio with the \(m\)-sparse constraint, due to the nonconvexity and the complexity of this constraint. We propose to convert the \(m\)-sparse fractional optimization problem into an equivalent \(m\)-sparse quadratic programming problem. The semi-algebraic property of the resulting objective function allows us to exploit the Kurdyka-Lojasiewicz property to develop an efficient Proximal Gradient Algorithm (PGA) that leads to a portfolio which achieves the globally optimal \(m\)-sparse Sharpe ratio under certain conditions. The convergence rates of PGA are also provided. To the best of our knowledge, this is the first proposal that achieves a globally optimal \(m\)-sparse Sharpe ratio with a theoretically-sound guarantee.

## 1 Introduction

The Sharpe ratio (SR)  is an important and widely-used performance metric in finance. Suppose an investing strategy is represented by a portfolio \(^{N}\) of \(N\) assets from a financial market. \(^{N}\) and \(^{N N}\) denote the expected return vector (in excess of the risk-free rate) and its covariance matrix for the \(N\) assets, respectively. It can be seen that \(^{}\) and \(^{}}\) represent the expected return and its standard deviation (i.e., risk) for the portfolio \(\). The original definition of SR is given as the follow quotient between return and risk:

\[S_{0}()=^{}}{^{}}}.\] (1.1)

Ever since the proposal of SR, how to maximize it becomes an attractive research topic. Ordinary portfolio optimization methods based on either the mean-variance approach [5; 10] or the exponential growth rate approach [22; 24] can reduce the portfolio risk and increase the portfolio return to some extent , and hence improve the SR. On the other hand, direct SR optimization methods are also proposed. Hung et al. , Yu and Xu  consider the SR as a differentiable function of the portfolio, which can be solved via the augmented Lagrangian method. Pang  converts the SR maximization under the self-financing and long-only constraints into a linear complementarity problem, which can be solved via the Parametric Linear Complementarity Technique (PLCT) and the principle pivoting algorithm . Note that PLCT requires \(_{i}>0\) for at least some asset \(i\) in order to be feasible.

In modern portfolio management, it is widely-recognized that the number of selected assets should be restricted to a manageable size, in order to keep simplicity and save time and financial costs. Managerial strategies provide an approach to achieve this objective, such as the revenue driven resource allocation , the endowment model , and selling stocks after market crashes . However, the managerial approaches still require intensive administration and abundant experience in management and finance. Hence researchers turn to sparsity models for solutions via the computational approaches. In , a Sparse and Stable Markowitz Portfolio (SSMP) is proposed by imposing \(_{1}\)-regularization on the portfolio. Ao et al.  further propose a mean-variance model with an \(_{1}\) constraint based on a maximum-Sharpe-ratio estimation. In , the exponential growth rate (EGR) criterion [1; 13; 19; 23] is exploited to develop a Short-term Sparse Portfolio Optimization (SSPO). Furthermore, a Short-term Sparse Portfolio Optimization with \(_{0}\)-regularization (SSPO-\(_{0}\)) is developed in . In , a nonlinear shrinkage of the covariance matrix is proposed to obtain an appropriate size of free parameters. Motivated by this strategy, Lai et al.  characterize a sparse structure for covariance estimation to construct a portfolio via the machine learning approach.

The \(_{1}\)-regularization and the \(_{1}\) constraint cannot control the exact number of selected assets. One has to tune the sparsity parameter to roughly adjust this number. On the other hand, suppose we want to select no more than \(m\) active assets out of \(N\) assets to construct a portfolio, then this can be exactly represented by the \(m\)-sparse (or \(_{0}\)) constraint \(\|\|_{0} m\), where the \(_{0}\) norm \(\|\|_{0}\) denotes the number of nonzero components of a vector. Although many sparsity models are established for the Markowitz portfolio, few existing methods can optimize the SR (1.1) with the \(_{0}\) constraint, due to the nonconvexity and the complexity of this constraint. In addition to the \(_{0}\) constraint, other realistic constraints should also be imposed to ensure feasibility. For example, the self-financing constraint represents full re-investment and no external loans; the long-only constraint represents no short position. If all these constraints are imposed, the whole model becomes even much more difficult to solve.

To overcome these difficulties, we observe that this optimization is essentially an \(m\)-sparse fractional optimization that can be transformed into an equivalent \(m\)-sparse quadratic programming. Then the resulting objective function is semi-algebraic, so that the Kurdyka-Lojasiewicz (KL) property  can be exploited to develop an efficient Proximal Gradient Algorithm (PGA) . It converges to a portfolio which achieves the globally optimal \(m\)-sparse SR under certain conditions. To the best of our knowledge, this is the first proposal that achieves a globally optimal \(m\)-sparse SR with a theoretically-sound guarantee. Our main contributions can be summarized as follows.

1. We propose to directly maximize the SR with the \(_{0}\) constraint, the self-financing constraint and the long-only constraint on the portfolio. This model aims to obtain a feasible and realistic portfolio that optimizes the SR with exact sparsity.
2. SR maximization is essentially a fractional optimization. We convert this \(m\)-sparse fractional optimization problem into an equivalent \(m\)-sparse quadratic programming problem, which reduces the difficulty of solving it.
3. We observe that the resulting objective function is semi-algebraic, thus exploit the KL property to develop an efficient PGA that leads to a globally or at least a locally optimal solution of the \(m\)-sparse SR maximization model. The convergence rates of PGA are also provided.

Besides the above contributions, our approach also has several advantages: \((i)\) It can be extended to a wide range of optimization problems with semi-algebraic objective functions and constraints. \((ii)\) The actual sparsity is robust to the choice of \(m\). \((iii)\) It needs very little parameter tuning. \((iv)\) It does not require any external algorithms or commercial optimizers.

## 2 Related Works and Existing Problems

There are some existing works that indirectly or directly optimize the SR to some extent via the computational approach. We introduce some examples and then analyze some unsolved problems.

### Ordinary Portfolio Optimization

An intuitive approach is to directly optimize the portfolio, so that the expected return is maximized and/or the risk is minimized. These methods can be categorized into the mean-variance approach and the exponential growth rate approach . Let \(^{T N}\) be the sample asset return matrix with \(T\) trading times and \(N\) assets, and \(_{n}\) denotes the vector of \(n\) ones. Brodie et al.  propose to impose \(_{1}\)-regularization on the mean-variance model, forming a Sparse and Stable Markowitz Portfolio (SSMP):

\[}=*{argmin}_{^{N}}\{ \|-_{T}\|_{2}^{2}+\|\|_{1}\},^{}}=,\ ^{}_{N}=1,\] (2.1)

where \(}:=^{}_{T}\) denotes the column vector of sample mean returns, and \( 0\) is the regularization parameter. \(\|\|_{2}\) and \(\|\|_{1}\) denote the \(_{2}\)-norm and the \(_{1}\)-norm, respectively. The quadratic form \(\|-_{T}\|_{2}^{2}\) actually computes the mean squared error between the sample portfolio return \(^{(t)}\) (\(^{(t)}\) is the \(t\)-th row of \(\)) and the given return level \(\). Equations \(^{}}=\) and \(^{}_{N}=1\) are the expected return constraint and the self-financing constraint, respectively. Model (2.1) can be approximately solved by a surrogate model  and the Least Absolute Shrinkage and Selection Operator (Lasso) . Goto and Xu  also exploit the Lasso to solve a mean-variance model through sparse hedging restrictions.

Ao et al.  propose a maximum-Sharpe-ratio estimated and sparse regression (MAXER) to approach mean-variance efficiency. Assume there are sufficient observations \(T>(N+2)\). MAXER first computes the maximum-Sharpe-ratio estimated regression response \(_{c}\) as follows:

\[_{s}=}^{}}^{-1}},\ :=_{s}-N}{T},\ _{c}:=}{}},\] (2.2)

where \(}\) and \(}\) denote the sample mean and the sample covariance, respectively, \(\) is the risk constraint parameter. Then it adopts the Lasso to obtain the portfolio:

\[}=*{argmin}_{^{N}}\| -_{c}_{T}\|_{2}^{2},\|\|_ {1}.\] (2.3)

Instead of the mean-variance approach, our method takes an essentially different objective that directly maximizes the SR in (1.1). Besides, our method does not require \(T>(N+2)\).

Based on the exponential growth rate criterion , Lai et al.  propose to minimize a kind of negative potential return \(^{}\) with \(_{1}\)-regularization but without any risk term, forming a Short-term Sparse Portfolio Optimization (SSPO) model

\[}=*{argmin}_{^{N}}\{^{ }+\|\|_{1}\},^{ }_{N}=1.\] (2.4)

It develops an unconstrained augmented Lagrangian with the existence of a saddle point that can be solved by the alternating direction method of multipliers (ADMM). Luo et al.  further propose the SSPO-\(_{0}\) model

\[}=*{argmin}_{}\{^{}+\|\|_{0}\},:=\{^{ N}\ _{N}\ \ ^{}_{N}=1\},\] (2.5)

where \(\) is the \(N\)-dimensional simplex. This simplex constraint \(\) is the combination of the long-only and the self-financing constraints. Under this constraint, the \(_{0}\)-regularization problem (2.5) has a closed-form solution \(}_{}^{min}:=\{i_{N}\ _{i}_{j_{N}}_{j}+\}\) with a tolerance \( 0\), where \(_{N}:=\{1,2,,N\}\).

On the other hand, Lai et al.  propose a rank-one covariance estimator based on the operator space decomposition, in order to capture the rapidly-changing risk structure in the financial market:

\[=_{J}_{J}^{},\ =^{2}-_{J}^{ }_{T}_{T}^{}_{J},\ _{1}^{*}=(()}{N(T-1)} )^{-}_{1},\ }_{RO}:=_{1}_{1}^{*}_{1}^{},\]

where \(=+_{T N}\) denotes the price relative matrix and \(_{J}_{J}^{}\) is its singular value decomposition (SVD), \(_{1}\) and \(_{1}\) are the largest eigenvalue and its eigenvector, respectively.

Although the above portfolio optimization methods may partly improve the SR, they may not be competitive to direct SR optimization. Hence direct SR optimization methods should still be developed and investigated.

### Sharpe Ratio Optimization

Pang  proposes to optimize the following SR model:

\[_{^{N}}S_{0}(), ,\;,\] (2.6)

where \(S_{0}()\) is defined by (1.1), \(^{l N}\) and \(^{l}\) form a linear constraint for \(\). It can be transformed into the following equivalent parametric linear complementarity problem:

\[=-++(^{}-_{N}^{})_{N},_{N},\\ =-(-_{N}^{})_{l}, _{l},\\ ^{}=^{}=0.\] (2.7)

Problem (2.7) can be efficiently solved by the principle pivoting algorithm , but it requires \(_{i}>0\) for at least some asset \(i\) in order to be feasible. Moreover, if we aim to construct an \(m\)-sparse \(\), this approach becomes invalid. In Section 3, we will convert the \(m\)-sparse SR optimization into an equivalent \(m\)-sparse quadratic programming, and the latter is still a nonconvex optimization. We further elaborate a proximal gradient algorithm to obtain a globally or locally optimal SR.

Another viable approach is to consider the SR as a function of the portfolio and directly optimize it under some realistic constraints. Hung et al.  propose the following IPSRM-D model to optimize the SR:

\[_{}\{():=^{} +_{1}^{}}{^{}}+_{2} {w}^{}(_{N}-)\},\] (2.8)

where \(^{N N}\) and \(^{N N}\) are upside and downside risk matrices, respectively, \(^{}(_{N}-)\) is a diversification term. \(_{1}\) and \(_{2}\) are hyperparameters that control the strength of upside risk and diversification, respectively. Interested readers can further refer to  for some practical estimators for \(\), \(\) and \(\).

However, \(()\) in model (2.8) is different from the original SR \(S_{0}()\) (1.1) in several significant parts. First, \(()\) uses second-order moments \(^{}\) and \(^{}\) as risk metrics, but \(S_{0}()\) uses the first-order moment \(^{}}\) instead. In general, a first-order moment is more appropriate because the expected return \(^{}\) should remain in the same order of magnitude as \(^{}}\). Second, the numerator of \(S_{0}()\) does not contain any risk term, while the numerator of \(()\) contains \(^{}\). This may change the meaning of SR as an equilibrium point in the efficient frontier based on the CAPM theory . These facts may affect the performance of SR optimization.

Another problem is the lack of effective solving algorithms that could really maximize the SR under constraints. A conventional way is to adopt gradient methods, since \(()\) is a differentiable function when \(_{N}\). Hung et al. , Yu and Xu  propose to adopt the augmented Lagrangian method to optimize (2.8). Though they do not specify which form of Lagrangian models is used, we give the following one without loss of generality:

\[(,):=()+(^{}_{N}-1)^{2}+^{},\] (2.9)

where \((^{}_{N}-1)^{2}\) with hyperparameter \( 0\) is a regularization term for the self-financing constraint, and \(^{N}_{+}\) is the dual variable with respect to (w.r.t.) \(\) for the long-only constraint \(_{N}\). \(^{N}_{+}\) denotes the set of all \(N\)-dimensional nonnegative vectors. The update scheme is

\[^{(k+1)}=^{(k)}+_{1}_{}( {w}^{(k)},^{(k)}),\\ ^{(k+1)}=^{(k)}-_{2}_{} (^{(k+1)},^{(k)}),\] (2.10)

where \(_{1},_{2} 0\) are update step sizes. Note that \(\) is a nonconvex function w.r.t. \(\), and the augmented Lagrangian method is a surrogate method that approximates model (2.8). Hence (2.10) does not necessarily lead to the maximum SR. Worse still, due to the augmented term \((^{}_{N}-1)^{2}\), (2.10) may not even decrease the objective function \(\). Moreover, the Lagrangian \((^{(k)},^{(k)})\) is increased by the \(^{(k)}\) updates but decreased by the \(^{(k)}\) updates, hence (2.10) cannot guarantee convergence to a point \((^{*},^{*})\) without a thorough investigation of the update scheme. To summarize, the augmented Lagrangian method and most existing gradient methods cannot guarantee global or local optimality for model (2.8).

PGA for m-Sparse Sharpe Ratio Maximization

In this section, we formulate the maximization problem of SR as a nonconvex fractional optimization under constraints. Instead of directly solving the proposed model, we develop an efficient proximal gradient algorithm to solve a simpler surrogate model (subtraction form) that is equivalent to the original constrained fractional optimization model.

### m-Sparse Sharpe Ratio Maximization Model

In order to retain the risk premium meaning of SR in finance, we directly maximize the original SR in (1.1) instead of a variant like (2.8). In the perspective of statistical estimation, suppose we have a sample asset return (in excess of the risk-free rate) matrix \(^{T N}\) with \(T\) trading times and \(N\) assets. Then the original SR (1.1) can be represented by

\[S():=_{T}^{}}{ \|-(_{T}^{})_{T}\|_{2}^{2}+ \|\|_{2}^{2}}},\] (3.1)

where \(\|\|_{2}^{2}\) is a regularization term for a positive definite \(_{}\) defined in (3.2). The parameter \(\) can be an arbitrarily-small positive parameter, whose effect on the risk term can be negligible. To simplify the notation, we define

\[:=^{}_{T},\;\;:=} (-_{T T})\;\;\;\;_{}:=^{}+.\] (3.2)

Then the maximization of SR under the \(m\)-sparse, long-only and self-financing constraints is given by

\[_{\\ \|\|_{0} m}S():=^{}}{ ^{}_{}}},\] (3.3)

where the simplex \(\) is defined in (2.5). Note that minimizing \(-S()\) under the constraint \(\|\|_{0} m\) is essentially quite different from minimizing the \(_{0}\)-regularization version \(-S()+\|\|_{0}\) with some positive \(\). In general, the latter is easier because it incorporates the \(_{0}\) norm into the objective function and enlarges the feasible set by dropping the constraint \(\|\|_{0} m\). We simply call (3.3) the \(m\)-Sparse Sharpe Ratio Maximization (mSSRM) model. In fact, to solve the mSSRM model, it suffices to solve the following simpler constrained minimization model

\[_{_{}\\ \|\|_{0} m}\{^{} _{}-^{}\}.\] (3.4)

To see this, we establish the relation between the solutions of these two models in the following theorem, whose proof is provided in Appendix A.1. We define the constraint sets in model (3.3) and (3.4) by

\[_{1}:=\{|\,\|\|_{0} m\}\;\;\;\; :=\{^{N}|\,_{N}\;\;\| \|_{0} m\},\] (3.5)

respectively. It is obvious that \(_{1}\).

**Theorem 1**: _Suppose that there exists some \(}_{1}\) such that \(^{}}>0\). If \(}\) is an optimal solution of model (3.3), then \(^{}}}{^{}_{}}} }\) is an optimal solution of model (3.4). Conversely, if \(}\) is an optimal solution of model (3.4), then \(}}{^{}_{N}}\) is an optimal solution of model (3.3)._

Defining the indicator function \(_{}\) by

\[_{}():=0,&if\;;\\ +,&otherwise,\] (3.6)

we can rewrite model (3.4) as the following two-term unconstrained minimization model:

\[_{^{N}}\{f()+_{}()\}, \;\;f():=^{}_{}- ^{}.\] (3.7)

We then turn to solving model (3.7) instead of the mSSRM model in (3.3).

### Proximal Gradient Algorithm

To develop a proximal gradient algorithm for solving model (3.7), we recall the notion of proximity operator, and then establish the relation between the solution of model (3.7) and the proximity characterization (3.8) in Theorem 2. For a proper function \(:^{n}}\), its proximity operator at \(^{n}\) is defined by \(_{}():=_{^{n}}\{ \|-\|_{2}^{2}+()\}\). We remark that for function \(\) that is nonconvex, \(_{}()\) may not be unique. Throughout this paper, the formula \(=_{}()\) represents \(_{}()\). For \(^{*}^{N}\) and \(>0\), we denote by \(B(^{*};)\) the neighborhood of \(^{*}\) with radius \(\). If there exists some \(>0\) such that \(f(^{*}) f()\) holds for all \( B(^{*};)\), then we say that \(^{*}\) is a locally optimal solution of model (3.7).

**Theorem 2**: _Let function \(_{}\) and \(f\) be defined by (3.6) and (3.7), respectively. If \(^{*}\) is a globally optimal solution of model (3.7), then for any \((0,_{}\|_{2}})\),_

\[^{*}=_{_{}}(^{*}- f(^{*})).\] (3.8)

_Conversely, we have the following two statements:_

* _If_ \(\) _and (_3.8_) holds, then_ \(^{*}\) _is a globally optimal solution of model (_3.7_)._
* _For any_ \(>0\)_, if (_3.8_) holds, then_ \(^{*}\) _is a locally optimal solution of model (_3.7_)._

The proof of Theorem 2 is provided in Appendix A.2. Based on this theorem, the Proximal Gradient Algorithm (PGA) for solving model (3.7) can be given by the following iterative scheme:

\[^{(k+1)}=_{_{}}(^{(k)}- f (^{(k)})),\ \ \ k,\ >0,\ ^{(0)}.\] (3.9)

We then compute the closed form of \(_{_{}}\). For a vector \(^{N}\), we denote by \(m_{}\) and \(J_{}^{}\) the number of positive components and the index set of positive components of \(\). If \(m_{} m\), then we denote by \(J_{m}^{}\) an index set of the \(m\)-largest positive components of \(\). Specifically, by letting \(\{v_{j_{i}}\}_{i_{N}}\) be an rearrangement of \(\{v_{j}\}_{j_{N}}\) such that \(v_{j_{1}} v_{j_{2}} v_{j_{N}}\), then \(J_{m}^{}:=\{j_{1},j_{2},,j_{m}\}\). Throughout this paper, for a given vector \(^{N}\), we shall always compute \(_{_{}}()\) according to the following proposition. Its proof is given in Appendix A.3.

**Proposition 3**: _Let \(_{}\) be defined by (3.6), \(^{N}\), and define the index set \(J^{}\) by_

\[J^{}=J_{m}^{},&if\ m_{}>m;\\ J_{}^{},&if\ m_{} m.\]

_Then the vector \(\) given by \(h_{j}=v_{j},&if\ j J^{};\\ 0,&if\ j_{N} J^{}\) satisfies that \(_{_{}}()\)._

### Convergence Analysis of PGA

In this subsection, we delve into the convergence analysis of PGA. We aim to demonstrate that PGA possesses the capability to converge to a globally optimal solution of model (3.4). The limit point obtained by PGA can also yield a globally optimal solution of the original model (3.3), under certain conditions. We also demonstrate the convergence rates of PGA.

Firstly, we introduce a proposition that illustrates the convergence and monotonic decreasing behavior of the objective function values for the iterative sequence, as well as the vanishing gap between consecutive iterates. The proof of this proposition is provided in Appendix A.4.

**Proposition 4**: _Let function \(_{}\) and \(f\) be defined by (3.6) and (3.7), respectively, and let \(F:=f+_{}\). If \((0,_{}\|_{2}})\), then for arbitrary initial vector \(^{(0)}^{N}\), the sequence \(\{^{(k)}\}_{k}\) generated by PGA satisfies the following properties:_

* \(^{(k)}\) _for all_ \(k\)_;_
* \(F(^{(k+1)})+a\|^{(k+1)}-^{(k)}\|_{2}^{2} F(^ {(k)})\) _for all_ \(k\)_, where_ \(a:=(-\|_{}\|_{2})>0\)_;_
* \(_{k}F(^{(k)})\) _exists;_
* \(_{k}\|^{(k+1)}-^{(k)}\|_{2}=0\)_._Though we have established the convergence of \(\{F(^{(k)})\}_{k}\) and the vanishing gap between consecutive iterates, further efforts are necessary to rigorously confirm the convergence of the iterative sequence \(\{^{(k)}\}_{k}\). We demonstrate the convergence of \(\{^{(k)}\}_{k}\) to a local minimizer of function \(F\) and the corresponding convergence rates in the following theorem. In order to maintain consistency with the original SR maximization model (as outlined in Theorem 1), we further define sequence \(\{^{(k)}\}_{k}\) based on \(\{^{(k)}\}_{k}\) and conduct an analysis of the convergence rate of \(\{^{(k)}\}_{k}\). To prove the theorem, we need to introduce the notions of subdifferential, semi-algebraic function and Kurdyka-Lojasiewicz property, along with several technical lemmas. Detailed proofs and relevant content can be found in Appendix A.5.

**Theorem 5**: _Suppose that there exists some \(}\) such that \(^{}}>0\). For arbitrary initial vector \(^{(0)}^{N}\), let \(\{^{(k)}\}_{k}\) be generated by PGA, and let \(\{^{(k)}\}_{k}\) be defined by_

\[^{(k)}:=^{(k)}}{(^{(k)})^{}_{N }},&(^{(k)})^{}_{N} 0;\\ _{N},&.\]

_If \((0,_{*}\|_{2}})\), then the following statements hold:_

* \(\{^{(k)}\}_{k}\) _converge to a locally optimal solution_ \(^{*}\) _of model (_3.4_) with convergence rates_ \(\|^{(k)}-^{*}\|_{2}=O(1/)\) _and_ \(|f(^{(k)})-f(^{*})|=O(1/k)\)_._
* _The limit point_ \(^{*}\) _of_ \(\{^{(k)}\}_{k}\) _satisfies that_ \(^{*}_{N}\) _and_ \(^{*}_{N}\)_._
* \(\{^{(k)}\}_{k}\) _converge to_ \(^{*}:=^{*}}{(^{*})^{}_{N}}\) _with convergence rates_ \(\|^{(k)}-^{*}\|_{2}=O(1/)\) _and_ \(|S(^{(k)})-S(^{*})|=O(1/)\)_, where_ \(S\) _is defined in (_3.3_)._

In the remainder of this section, we always let \(^{*}\) be the locally optimal solution of model (3.7) that sequence \(\{^{(k)}\}_{k}\) converges to. We recall that \(m_{^{*}}\) and \(J^{^{*}}_{}\) denote the number of positive components and the index set of positive components of \(^{*}\), respectively. Suppose that there exists some \(}\) such that \(^{}}>0\). Then item \((ii)\) in Theorem 5 together with \(^{*}\) yields that \(1 m_{^{*}} m\). In fact, \(^{*}\) is also the globally optimal solution of the convex model

\[_{}\{^{}_{}- ^{}\},\{^{N}|\, _{N}v_{j}{=}0j_{N} J^{^{*}}_{ }\}.\] (3.10)

Certainly, \(\) due to the condition \(m_{^{*}} 1\). According to the definition of \(\), it is straightforward to observe that \(^{*}\). Furthermore, \(\) is a closed convex set and \(\). To analyze the relation between \(^{*}\) and the original \(m\)-sparse Sharpe ratio maximization model (3.3), we define

\[_{1}:=\{|\,v_{j}=0j_{N}  J^{^{*}}_{}\},\] (3.11)

where \(\) is given by (2.5). It is easy to see that \(_{1}_{1}\), where \(_{1}\) defined in (3.5) is the constraint set of model (3.3). We then have the following theorem, whose proof is provided in Appendix A.6.

**Theorem 6**: _Suppose that there exists some \(}\) such that \(^{}}>0\), where \(\) is defined in (3.10), and let \(^{*}:=^{*}}{(^{*})^{}_{N}}\). Then the following statements hold:_

* \(^{*}\) _is the unique globally optimal solution of model (_3.10_)._
* \(^{*}\) _is a globally optimal solution of model_ \(_{_{1}}\,S()\)_._
* _If_ \(m_{^{*}}=m\)_, then_ \(^{*}\) _is a locally optimal solution of model (_3.3_)._

Item \((iii)\) in Theorem 6 demonstrates that the limit point of the sequence obtained by PGA can yield a locally optimal solution of model (3.3). In fact, according to item \((i)\) in Theorem 2, we have the following theorem that provides sufficient conditions for obtaining a globally optimal solution of model (3.3), whose proof is provided in Appendix A.7.

**Theorem 7**: _Suppose that there exists some \(}_{1}\) such that \(^{}}>0\), and let \(^{*}:=^{*}}{(^{*})^{}_{N}}\). If one of the following two conditions holds:_

* \(m_{^{*}}<m\)_;_\((ii)\): \(m_{^{*}}=m\): and \(_{i}f(^{*})>-\{v_{i}^{*}|i( {v}^{*})\}\) for all \(i_{N}(^{*})\), then \(^{*}\) is a globally optimal solution of model (3.3)._

Combining Theorem 7 and item \((iii)\) in Theorem 6, we see that the proposed method can obtain a globally optimal solution of model (3.3) when \(m_{^{*}}<m\). Even if this condition does not hold, we can obtain at least a locally optimal solution. To test validation of PGA's global optimality, we conduct a set of simulation experiments, whose details are presented in Appendix A.8. The codes for the simulation experiments are accessible via the link: https://github.com/linyizun2024/mSSRM/tree/main/Codes_for_Simulation.

We call the existence of \(}\) such that \(^{}}>0\) in Theorem 6 the Existence of Positive Expected Return (EPER) condition. Although the EPER condition is required to guarantee the convergence of \(^{*}\) to a locally optimal solution of the original model (3.3), the proposed method is still of high practical significance in the case that the EPER condition does not hold. From the proofs of item \((i)\) in Theorem 5 and item \((i)\) in Theorem 6, we see that even if the EPER condition does not hold, the sequence generated by PGA still converges to a locally optimal solution \(^{*}\) of model (3.4), which is also the globally optimal solution of model (3.10). In these two models, the objective function \(^{}_{}-^{}\) subtraction form) w.r.t. \(\) represents risk minus expected return, whose minimization gives smaller risk and less loss in revenue, even if the expected return is not positive. For the case that the expected return is not positive, compared with the failure of Sharpe ratio of fractional form, the globally or locally optimal solution of the subtraction form seems to have more realistic significance. We recall from item \((ii)\) in Theorem 5 that \(^{*}\) may be equal to \(_{N}\) if the EPER condition does not hold. In this case, we shall set \(^{*}=_{N}\) and keep all the wealth in the risk-free asset to avoid loss in revenue. To close this section, we summarize the whole \(m\)-sparse Sharpe ratio maximization method, which we abbreviate to mSSRM-PGA, in Appendix A.9.

## 4 Experimental results

Extensive experiments with real-world financial data sets are conducted to evaluate the performance of the proposed mSSRM-PGA. Moreover, we also consider one baseline method: 1/N , as well as \(9\) state-of-the-art methods: IPSRM-D , PLCT , SSMP , MAXER , SSPO , SPOLC , S1, S2 and S3 , as competitors in the experiments. We use 6 real-world monthly benchmark data sets: FF25, FF25EU, FF32, FF49, FF100 and FF100MEINV to compare different methods. These data sets are collected from the baseline and commonly-used Kenneth R. French's Real-world Data Library2. Details regarding these competitors and data sets are given in Appendix A.10. As for mSSRM-PGA, we examine three levels of sparsity \(m=10\), \(m=15\), \(m=20\) and set \(=10^{-3}\). The setting of other parameters are presented in Appendix A.9. The codes of mSSRM-PGA are accessible via the link: https://github.com/linyizun2024/mSSRM/tree/main/Codes_for_Experiments_in_Paper.

### Results for Sharpe ratios

We adopt the moving-window trading framework in  to imitate real-world portfolio management. For each method, we use the asset returns \(\{_{(t)}\}_{t=1}^{T}\) or the price relatives \(\{_{(t)}:=_{(t)}+_{N}\}_{t=1}^{T}\) in the time window \(t=[1:T]\) to update the portfolio \(}_{(T+1)}\) for the next trading time. On the \((T+1)\)-th time, we compute the portfolio return by \(_{(T+1),}}=_{(T+1)}^{}}_{(T+1)}-1\) and then turn to the next round where the time window moves to \(t=[2:(T+1)]\) and a new portfolio \(}_{(T+2)}\) is computed. This procedure is repeated till the last trading time \(\), which yields a return sequence \(\{_{(t),}}\}_{t=1}^{}\). This sequence can be used to compute the test SR:

\[=^{}_{(t),}})/( -T)}{^{}(_{(s),}}-( _{t=T+1}^{}_{(t),}})/(-T))^{2})/( -T-1)}}.\]

The 1/N strategy does not involve the time window size \(T\). For all other methods, we examine two conventional settings for the time window size in the finance industry : \(T=60\) and \(T=120\)Table 1 shows the (monthly) SRs of the \(11\) compared methods. Because MAXER requires \(T>(N+2)\), it is unavailable on FF100 and FF100MEINV when \(T=60\). It is worth noting that the trivial strategy 1/N outperforms most competitors in most situations. The reason is that 1/N diversifies the risk over all the assets, which is also an effective risk control approach . However, mSSRM-PGA outperforms all the competitors including 1/N on all the \(6\) data sets when \(T=60\) and on \(5\) data sets when \(T=120\). For example, its SR is more than \(70\%\) higher than that of 1/N on FF25EU whether \(T=60\) or \(T=120\). Hence mSSRM-PGA achieves competitive SRs with sparse portfolios, which saves much managerial cost.

### Results for Cumulative Wealths

Ordinary investors are also concerned about how much they gain when using an investing strategy. Without loss of generality, we can set the initial wealth for an investing strategy as \(S_{(0)}=1\), then the final cumulative wealth can be conveniently computed by \(S_{()}=_{t=1}^{}(_{(t),}}+1)\). The results of final cumulative wealths are shown in Table 2. The two competitors 1/N and PLCT perform well in general. Nevertheless, mSSRM-PGA achieves the best final cumulative wealths on 4 out of the 6 data sets. Besides, it outperforms each competitor on at least 5 out of the 6 data sets. For example, mSSRM-PGA is about \(20\%\) higher than the second best competitor PLCT on FF49 when \(T=60\) and \(m=10\). On the data sets where mSSRM-PGA is not the best method, it is still the second best method. These results indicate that mSSRM-PGA is an effective strategy for pursuing return gain in a practical perspective.

### Results for Transaction Costs

Cumulative wealth with transaction cost can also be tested to see how the transaction cost influences the performance of different methods. We adopt the proportional transaction cost model [8; 26; 21]

\[S^{}\!\!=\!\!S_{(0)}_{t=1}^{}[(}_{(t)}^{ }_{(t)})(1-_{i=1}^{N}|_{(t),i }-_{(t-1),i}|)],_{(t-1),i}\!\!=\!\!_{(t-1),i}_{(t-1),i}}{_{(t-1)}^{}_{(t- 1)}},\]

where \(_{(t-1),i}\) is the evolved portfolio weight of the \(i\)-th asset at the end of the \((t-1)\)-th period, and \(\) is the bidirectional transaction cost rate. When the cost rate of buying is the same as that

  Strategy & FF25 & FF25EU & FF32 & FF49 & FF100 & FF100MEINV & FF25 & FF25EU & FF32 & FF49 & FF100 & FF100MEINV \\   & &  &  \\ 
1/N & 355.98 & 13.05 & 424.42 & 235.48 & 364.87 & **428.70** & 355.98 & 13.05 & 424.42 & **235.48** & 364.87 & 428.70 \\ SPOLC & 57.53 & 0.96 & 169.58 & 54.4 & 23.9 & 14.05 & 70.46 & 1.03 & 259.14 & 10.09 & 16.03 & 36.20 \\ SSPO & 129.35 & 1.22 & 30.20 & 1.33 & 0.89 & 8.98 & 286.51 & 2.67 & 130.21 & 1.61 & 1.74 & 25.62 \\ S1 & 100.76 & 1.08 & 29.47 & 1.09 & 0.54 & 9.25 & 265.82 & 2.78 & 121.47 & 2.23 & 1.27 & 15.57 \\ S2 & 66.24 & 2.17 & 39.27 & 1.39 & 1.15 & 20.45 & 103.31 & 2.73 & 93.13 & 1.89 & 2.67 & 43.66 \\ S3 & 70.88 & 2.01 & 36.88 & 1.28 & 1.20 & 2.237 & 129.90 & 2.61 & 89.51 & 1.92 & 2.62 & 38.70 \\ SSMP & 248.67 & 13.47 & 158.98 & 186.79 & 10.09 & 154.27 & 237.45 & 3.25 & 149.65 & 143.18 & 2.26 & 222.35 \\ MAXER & 173.39 & 47.56 & 200.003 & 142.31 & NAV & NAV & 216.94 & 55.71 & 117.42 & 98.85 & 79.82 & 188.54 \\ IPSRM-D & 398.55 & 37.25 & 243.83 & 69.57 & 240.12 & 146.40 & 567.76 & 77.79 & 507.47 & 50.04 & 457.86 & 188.34 \\ PLCT & 581.41 & **266.04** & 918.62 & 238.27 & 471.44 & 354.70 & 608.65 & **148.19** & 854.83 & 157.50 & 552.41 & 399.48 \\ 
**mSSRM-PGA (m=10)****615.34** & 126.02 & **991.98** **286.52** **527.09** & 375.75 & **640.89** & 147.17 & **928.19 & 188.38 & **635.65** & 421.97 \\
**mSSRM-PGA (m=15)****614.71** & 125.19 & **996.32** **262.64** **522.82** & 383.44 & **633.44** & 447.17 & **927.21** & 172.95 & **597.67** & **435.01** \\
**mSSRM-PGA (m=20)****614.70** & 125.19 & **996.23** **262.66** **515.50** & 384.65 & **643.44** & 147.17 & **927.16** & 173.27 & **603.05** & **433.15** \\  

Table 2: Cumulative wealths of different portfolio optimization methods on 6 benchmark data sets.

  Strategy & FF25 & FF25EU & FF32 & FF49 & FF100 & FF10MEINV & FF25 & FF25EU & FF32 & FF49 & FF100 & FF100MEINV \\   & &  &  \\ 
1/N & 355.98 & 13.05 & 424.42 & 235.48 & 364.87 & **428.70** & 355.98 & 13.05 & 424.42 & **235.48** & 364.87 & 428.70 \\ SPOLC & 57.53 & 0.96 & 169.58 & 54.4 & 23.9 & 14.05 & 70.46 & 1.03 & 259.74 & 10.09 & 16.03 & 36.20 \\ SSPO & 129.35 & 1.22 & 30.20 & 1.33 & 0.89 & 8.98 & 286.51 & 2.67 & 130.21 & 1.61 & 1.74 & 25.62 \\ S1of selling, updating the evolved portfolio \(}_{(t-1)}\) as the next portfolio \(}_{(t)}\) yields a proportional transaction cost of \(_{i=1}^{N}|_{(t),i}-_{(t-1),i}|\). Figure 2 in Appendix A.10 shows the final cumulative wealths of different methods as \(\) varies from \(0\) to \(0.5\%\) with \(T=60\). mSSRM-PGA outperforms all other competitors on FF25, FF25EU and FF32 for all \([0,0.5\%]\), and on FF100 for \( 0.45\%\). mSSRM-PGA is the second best method on FF100MEINV, following 1/N. This is because 1/N naturally keeps a small trading volume. Note that a manager for a mutual fund with sufficient trades and capital is able to negotiate for a small enough \(\). Thus mSSRM-PGA is applicable to scenarios with a certain level of transaction cost.

### Sparsity for mSSRM-PGA

In this subsection, we examine the sparsity of the portfolios \(\{}_{(t)}\}\) generated by mSSRM-PGA. The sparsity can be measured by the cardinality of the support set of \(}_{(t)}\): \(|(}_{(t)})|\). For each data set and each setting of \(m\), the mean and the standard deviation (STD) of \(\{|(}_{(t)})|\}\) are computed to provide a general description, shown in Table 3. It indicates that mSSRM-PGA further increases sparsity compared with the preseted sparsity level \(m\). Moreover, mSSRM-PGA keeps stable sparsity w.r.t. the change of \(m\). For example, the average sparsity for mSSRM-PGA is about \(4.9\) when \(T=60\) (or \(4.4\) when \(T=120\)) on FF25EU, for all the settings \(m=10,15,20\). As the total number of assets \(N\) increases, mSSRM-PGA gets more advantageous in sparsity. For example, the average sparsity for mSSRM-PGA is about \(8 11\) on FF100 and FF100MEINV, compared with \(N=100\). It indicates that mSSRM-PGA selects only \(8\% 11\%\) of the assets in the whole asset pool, while the widely-used 1/N strategy has to maintain the whole asset pool. Therefore, mSSRM-PGA can save much managerial cost by reducing the proportion of selected assets, while keeping a competitive performance in SR optimization.

## 5 Concluding Remarks

The Sharpe ratio (SR) is a very important measurement for the performance of returns attributable to risk in finance. On the other hand, modern portfolio management usually restricts the number of selected assets to a relatively small size, in order to save managerial and financial costs. The \(m\)-sparse (\(_{0}\)) constraint is an exact constraint for a sparse portfolio, but it is nonconvex and complex. Thus few existing methods can optimize the SR with the \(m\)-sparse constraint. In this study, we convert the \(m\)-sparse fractional optimization problem into an equivalent \(m\)-sparse quadratic programming problem. Then we develop an efficient, easy-to-implement and mathematically sound proximal gradient algorithm to solve this nonconvex problem. We theoretically prove that this algorithm yields a portfolio that achieves the globally optimal \(m\)-sparse Sharpe ratio under certain conditions.

We conduct extensive experiments on \(6\) real-world monthly benchmark data sets built on the Kenneth R. French's widely-used public data library. The numerical results demonstrate that the proposed mSSRM-PGA improves the SR, compared with 9 state-of-the-art portfolio optimization methods including SPOLC, SSPO, S1, S2, S3, SSMP, MAXER, IPSRM-D, PLCT and one baseline method 1/N. For another evaluating metric cumulative wealth, mSSRM-PGA outperforms each competitor on at least 5 out of the 6 data sets. Besides, mSSRM-PGA can withstand a considerable level of transaction cost rate. Sparsity experiments indicate that mSSRM-PGA successfully generates portfolios with stable sparsity, and its advantage increases as the size of the whole asset pool increases. In summary, the proposed mSSRM-PGA is a promising approach in managing portfolios or other financial issues, which is worth further investigations. A limitation of this research lies in its inability to directly apply to fractional optimization models featuring nondifferentiable numerator and denominator. Future work will strive to broaden the theoretical and methodological foundations, ultimately enabling its application to a broader spectrum of fractional optimization models in machine learning.

   m & FF25 & FF25EU & FF32 & FF49 & FF100 & FF100MEINV & FF25 & FF25EU & FF32 & FF49 & FF100 & FF100MEINV \\   & Mean & 6.3511 & 4.8342 & 6.4159 & 8.1214 & 8.0097 & 7.9175 & 7.1359 & 4.4560 & 7.0825 & 8.4790 & 8.3706 & 8.8722 \\  & STD & 2.4164 & 2.1763 & 2.3654 & 1.9918 & 2.2473 & 2.3915 & 2.2221 & 1.4645 & 2.4464 & 1.9080 & 2.3343 & 2.0117 \\   & Mean & 6.4746 & 4.9352 & 7.4286 & 9.0000 & 8.9709 & 9.0825 & 7.1637 & 4.4430 & 7.4919 & 9.6003 & 9.8754 & 10.5906 \\  & STD & 3.0451 & 2.3573 & 3.0590 & 3.0713 & 3.3964 & 3.5906 & 2.2995 & 1.4462 & 2.2567 & 3.1731 & 3.6169 & 3.4845 \\   & Mean & 6.4763 & 4.9352 & 7.4692 & 9.0421 & 9.1974 & 9.2994 & 7.1637 & 4.4430 & 7.4919 & 9.6828 & 10.0437 & 10.7621 \\  & STD & 3.0462 & 2.3573 & 3.1734 & 3.1620 & 3.8949 & 4.0125 & 2.2995 & 1.4462 & 2.2567 & 3.3349 & 3.9160 & 3.7460 \\  

Table 3: Sparsity of the portfolios generated by mSSRM-PGA: \(|(}_{(t)})|\).