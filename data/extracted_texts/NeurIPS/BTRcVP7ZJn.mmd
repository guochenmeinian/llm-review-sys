# Greedy Pruning with Group Lasso Provably

Generalizes for Matrix Sensing

Nived Rajaraman

EECS Department

University of California, Berkeley

nived.rajaraman@eecs.berkeley.edu &Devrit

CS Department

The University of Texas at Austin

devvrit.03@gmail.com &Aryan Mokhtari

ECE Department

The University of Texas at Austin

mokhtari@austin.utexas.edu &Kannan Ramchandran

EECS Department

University of California, Berkeley

kannanr@eecs.berkeley.edu

###### Abstract

Pruning schemes have been widely used in practice to reduce the complexity of trained models with a massive number of parameters. In fact, several practical studies have shown that if a pruned model is fine-tuned with some gradient-based updates it generalizes well to new samples. Although the above pipeline, which we refer to as pruning + fine-tuning, has been extremely successful in lowering the complexity of trained models, there is very little known about the theory behind this success. In this paper, we address this issue by investigating the pruning + fine-tuning framework on the overparameterized matrix sensing problem with the ground truth \(U_{}^{d r}\) and the overparameterized model \(U^{d k}\) with \(k r\). We study the approximate local minima of the mean square error, augmented with a smooth version of a group Lasso regularizer, \(_{i=1}^{k}\|Ue_{i}\|_{2}\). In particular, we provably show that pruning all the columns below a certain explicit \(_{2}\)-norm threshold results in a solution \(U_{}\) which has the minimum number of columns \(r\), yet close to the ground truth in training loss. Moreover, in the subsequent fine-tuning phase, gradient descent initialized at \(U_{}\) converges at a linear rate to its limit. While our analysis provides insights into the role of regularization in pruning, we also show that running gradient descent in the absence of regularization results in models which are not suitable for greedy pruning, i.e., many columns could have their \(_{2}\) norm comparable to that of the maximum. To the best of our knowledge, our results provide the first rigorous insights on why greedy pruning + fine-tuning leads to smaller models which also generalize well.

## 1 Introduction

Training overparameterized models with a massive number of parameters has become the norm in almost all machine learning applications. While these massive models are successful in achieving low training error and in some cases good generalization performance, they are hard to store or communicate. Moreover, inference with such large models is computationally prohibitive. To address these issues, a large effort has gone into compressing these overparameterized models via different approaches, such as quantization schemes , unstructured  and structured  pruning mechanisms, and distillation techniques using student-teacher models . Among these approaches, _greedy pruning_, in which we greedily eliminate the parameters of the trained modelbased on some measure (e.g., the norms of the weight vectors associated with individual neurons) has received widespread attention [3; 9; 10; 11; 12; 13]. This is mostly due to the fact that several practical studies have illustrated that training an overparameterized model followed by greedy pruning and fine-tuning leads to better generalization performance, compared to an overparameterized model trained without pruning . Furthermore, a phenomenon that has been observed by several practical studies, is that different forms of regularization during training, such as \(_{0}\) or \(_{1}\) regularization [15; 16; 17] or \(_{2}\) regularization including group Lasso  lead to models that are better suited for pruning, and leading to better generalization post fine-tuning. While the greedy pruning framework has shown impressive results, there is little to no theory backing why this pipeline works well in practice, nor understanding of the role of regularization in helping generate models which are suitable for greedy pruning. In this work, we address the following questions:

_Does the greedy pruning + fine-tuning pipeline provably lead to a simple model with good generalization guarantees? What is the role of regularization in pruning?_

In this paper, we use the symmetric matrix sensing problem  as a test-ground for the analysis of greedy pruning framework, a model very closely related to shallow neural networks with quadratic activation functions [20; 19]. In this setting, the underlying problem for the population loss (infinite samples) is defined as \(\|UU^{T}-U_{}U_{}^{T}\|_{F}^{2}\), where \(U_{}^{d r}\) is an unknown ground-truth rank-\(r\) matrix, with \(r\) also being unknown, and \(U^{d k}\) is the overparameterized learning model with \(k r\). As we discuss in the Appendix F, the columns of \(U\) can be thought of as the weight vectors associated with individual neurons in a \(2\)-layer shallow neural network with quadratic activation functions, a connection first observed in . Thus, the data generating model has \(r\) neurons, while the learner trains an overparameterized model with \(k\) neurons.

While the statistical and computational complexity of the overparameterized matrix sensing problem has been studied extensively, we use it as a model for understanding the efficacy of greedy pruning. In particular, we aim to answer the following questions: Does there exist a simple pruning criteria for which we can _provably_ show that the pruned model generalizes well after fine-tuning _while having the minimal necessary number of parameters_? What is the role of regularization during training in promoting models which are compatible with greedy pruning? Finally, what generalization guarantees can we establish for the pruned model post fine-tuning?

**Contributions.** Our main contribution is to show that the discussed pruning pipeline not only recovers the correct ground-truth \(U_{}U_{}^{T}\) approximately, but also automatically adapts to the correct number of columns \(r\). In particular, we show that training an overparameterized model on the empirical mean squared error with an added group Lasso based regularizer to promote column sparsity, followed by a simple norm-based pruning strategy results in a model \(U_{}\) having exactly the minimum number of columns, \(r\). At the same time, we show that \(\|U_{}U_{}^{T}-U_{}U_{}^{T}\|_{F}^{2}\) is small, but non-zero. Hence, the pruned model can subsequently be fine-tuned using a small number of gradient steps, and in this regime, \(\|U_{t}U_{t}^{T}-U_{}U_{}^{T}\|_{F}^{2}\) shows linear convergence to its limit. Moreover, the pruned model can be shown to admit finite sample generalization bounds which are also statistically optimal for a range of parameters. In particular, we show that to obtain a model \(U_{}\) that has exactly \(r\) columns and its population error is at most \(\|U_{}U_{}^{T}-U_{}U_{}^{T}\|_{F}\), our framework requires \(O(dk^{2}r^{5}+})\) samples, which is statistically optimal for sufficiently small \(\). We should also add that our framework does not require any computationally prohibitive pre- or post-processing (such as SVD decomposition) for achieving this result.

While there are several works [22; 19; 23] establishing that gradient descent in the "exactly-parameterized" setting requires \(O(rd/^{2})\) samples to achieve a generalization error of \(\), and converges linearly to this limit, the picture is different in the overparameterized setting. In , the authors showed that in the overparametrized setting, vanilla gradient descent requires \(O(kd/^{2})\) samples to achieve a generalization error of \(\|U_{}U_{}^{T}-U_{}U_{}^{T}\|_{F}\), degrading with the overparameterization of the model. Moreover the resulting solution does not have the correct column sparsity. In order to obtain a model which can be stored concisely, \(U_{}\) has to be post-processed by computing its SVD, which is computationally expensive in the high dimensional regime.

As our second continuation, we show that use of explicit regularization to promote column sparsity while training is important to learn models suitable for greedy pruning. Specifically, we show that while implicit regularization [19; 24] suffices to learn models with the correct rank, these approaches learn solutions with a large number of columns having \(_{2}\)-norms comparable to that of the maximum, even if \(r=1\). Hence, it is unclear how to sparsify such models based on the norms of their columns.

## 2 Setup and Algorithmic Framework

Given \(n\) observation matrices \(\{A_{i}\}_{i=1}^{n}\), in the matrix sensing framework, the learner is provided measurements \(y_{i}= A_{i},U_{}U_{}^{T}+_{i}\) where \(,\) indicates the trace inner product and \(_{i}\) is measurement noise assumed to be distributed i.i.d. \((0,^{2})\)1. Here \(U_{}^{d r}\) is the unknown parameter, and the rank \(r d\) is unknown. The goal of the matrix sensing problem is to learn a candidate matrix \(X\) such that \(X U_{}U_{}^{T}\). For computational reasons, it is common to factorize \(X\) as \(UU^{T}\) for \(U^{d k}\). In this paper, we study the factored model in the overparameterized setting, where \(k r\). The empirical mean squared error is,

\[_{}(U)=_{i=1}^{n}( A_{i},UU^{T }-y_{i})^{2}. \]

For the case that \(A_{i}\)'s are sampled entry-wise i.i.d. \((0,1/d)\) and as \(n\), up to additive constants which we ignore, the population mean square error can be written down as,

\[_{}(U)=\|UU^{T}-U_{}U_{}^{T}\|_{F}^{2}. \]

There is an extensive literature on how to efficiently learn the right product \(U_{}U_{}^{T}\) in both finite sample and population settings . In particular, there are several works on the efficiency of gradient-based methods with or without regularization for solving this specific problem . While these approaches guarantee learning the correct product \(UU^{T} U_{}U_{}^{T}\), in the overparameterized setting the obtained solutions are not column sparse and storing these models requires \((kd)\) bits of memory (ignoring precision). As a result, in order to obtain a compressed solution \(U_{}^{d r}\) with the correct number of columns, one has to post-process \(U\) and do a singular value decomposition (SVD), an operation which is costly and impractical in high-dimensional settings.

The goal of this paper is to overcome this issue and come up with an efficient approach to recover a solution \(U_{}\) which generalizes well, in that \(_{}(U)\) is small, while at the same time having only a few non-zero columns, i.e. is sparse. Specifically, we show that via some proper regularization, it is possible to obtain a model that approximately learns the right product \(U_{}U_{}^{T}\), while having only a few significant columns. As a result, many of its columns can be eliminated by a simple \(_{2}\) norm-based greedy pruning scheme, without significantly impacting the training loss. In fact, post pruning we end up with a model \(U_{}^{d r}\) that has the correct dimensionality and its outer product \(U_{}U_{}^{T}\) is close to the true product \(U_{}U_{}^{T}\). When the resulting "exactly parameterized" model is fine-tuned, the generalization loss \(_{}(U)\) can be shown to converge to \(0\) at a linear rate.

To formally describe our procedure, we first introduce the regularization scheme that we study in this paper, and then we present the greedy pruning scheme and the fine-tuning procedure.

Regularization.The use of regularization for matrix sensing (and matrix factorization) to encourage a low rank solution , or to control the norm of the model for stability reasons , or to improve the landscape of the loss by eliminating spurious local minima  has been well-studied in the literature. While these approaches implicitly or explicitly regularize for the rank of the learned matrix, the solution learned as a result is often not column sparse. Indeed, note that a matrix can be low rank and dense at the same time, if many columns are linear combinations of the others. We propose studying the following regularized matrix sensing problem with a group Lasso based regularizer . In the population case, the loss is defined as

\[_{}(U)+(U), (U)=_{i=1}^{k}\|Ue_{i}\|_{2}. \]

Note that \(>0\) is a properly selected regularization parameter. Imposing \(\) as a penalty on the layer weights of a neural network is a special case of a widely used approach commonly known as _Structured Sparsity Learning_ (SSL) . The regularizer promotes sparsity across "groups" as discussed by . Here, the groups correspond to the columns of \(U\). The use of matrix mixed-norms as a regularizer for sparsity was also considered in . Furthermore, a connection of the groupLasso penalty with the Schatten-\(1/2\) norm was considered in , where the authors show that stationary points of the factored objective also serve as stationary points of the unfactored objective and heuristically argue that the regularizer promotes sparse solutions.

As we prove in Section 4, the solution obtained by minimizing a smooth version of the regularized loss in (3), denoted by \(U_{}\), is approximately column-sparse, i.e., \(k-r\) of its columns have small \(_{2}\) norm. As a result, it is suitable for the simple greedy pruning scheme which we also introduce in Algorithm 1. Interestingly, in Section 3, we will first show a negative result - the model obtained by minimizing the _unregularized_ loss, \(_{}(U)\) (eq. (2)) using gradient descent updates could fail to learn a solution which is suitable for greedy pruning. This shows the importance of adding some form of regularization during the training phase of the overparameterized model.

Greedy Pruning.The greedy pruning approach posits training a model (possibly a large neural network) on the empirical loss, followed by pruning the resulting trained network greedily based on some criteria. The resulting model is often fine-tuned via a few gradient descent iterations before outputting. In the literature, various criteria have been proposed for greedy pruning. Magnitude-based approaches prune away the individual weights/neurons based on some measure of their size such as \(_{1}/_{2}\) norm of the associated vectors [16; 10].

In this work, we also focus on the idea of greedy pruning and study a mechanism to prune the solution obtained by minimizing the regularized empirical loss. Specifically, once an approximate second-order stationary point of the loss in Section 4, we only keep its columns whose \(_{2}\) norm are above a threshold (specified in Algorithm 1) and the remaining columns with smaller norm are removed. We further show that post pruning, the obtained model \(U_{}\) continues to have a small empirical loss, i.e., small \(_{}(U_{})\), while having exactly \(r\) columns.

Post-pruning fine-tuning.As mentioned above, it is common to fine-tune the smaller pruned model with a few gradient updates before the evaluation process . We show that the pruned model \(U_{}\) has the correct rank and is reasonably close to the ground-truth model \(U_{}\) in terms of its population loss. By running a few gradient updates on the mean square error, it can be ensured that \(UU^{T}\) converges to \(U_{}U_{}^{T}\) at a linear rate. Algorithm 1 summarizes the framework that we study.

## 3 Implicit regularization does not lead to greedy pruning-friendly models

In various overparameterized learning problems, it has been shown that first-order methods, starting from a small initialization, implicitly biases the model toward "simple" solutions, resulting in models that generalize well [41; 42], a phenomenon known as implicit regularization. In particular, for matrix sensing, [43; 19; 24] show that in the absence of any regularization, running gradient descent on the population loss _starting from a small initialization_ biases \(UU^{T}\) to low rank solutions, and learns the correct outer product \(UU^{T} U_{}U_{}^{T}\). However, as discussed earlier, low-rank solutions are not necessarily column sparse, nor is it clear how to sparsify them without computing an SVD. It is unclear whether implicit regularization suffices to learn models that are amenable for greedy pruning.

In this section, we address this question and show that minimizing the unregularized population loss \(_{}\) leads to models which are not suitable for greedy pruning, i.e., have many columns with large \(_{2}\) norm. Specifically, we show that by running gradient flow from a small random initialization, even if the ground truth \(U_{}\) is just a single column and \(r=1\), the learnt solution \(U\) has a large number of columns that are "active", i.e. having \(_{2}\)-norm comparable to that of the column with maximum norm. Thus, in the absence of the knowledge of \(r\), it is unclear how to determine it from just observing the columns \(_{2}\) norm. We thus claim that such trained models are not compatible with greedy pruning. In the following theorem, we formally state our result.

**Theorem 1**.: _Consider the population loss in eq. (2), for \(r=1\) and \(k 1\) and suppose \(\|U_{}\|_{}=1\). Further, suppose the entries of the initial model \(U_{0}\) are i.i.d. samples from \((0,^{2})\), where \( c_{1}/k^{3}d(kd)\) for some constant \(c_{1}>0\). For another absolute constant \(c_{1}^{}>0\), as \(t\), the iterates of gradient flow with probability \( 1-O(1/k^{c_{1}^{}})\) converge to a model \(U_{gd}\) where \((k^{c_{1}^{}})\) active columns satisfy_

\[e_{i}\|_{2}}{_{j[k]}\|U_{gd}e_{j}\|_{2}} 0.99. \]Theorem 1 claims that the iterates of gradient descent converge to a solution for which a large number (\((k^{c_{1}^{}})\)) of columns of \(U_{}\) have their \(_{2}\) norm at least \(0.99\) times the maximum. An inspection of the proof shows that the constant \(0.99\) is arbitrary and can be extended to any constant bounded away from \(1\). Therefore, the models learnt by vanilla gradient descent cannot be reduced to the right sparsity level by simply pruning away columns with \(_{2}\) norm below any fixed constant threshold.

We provide a general guarantee in Theorem 22 (Appendix A). It is worth noting that from  that the learned model \(U_{gd}^{d k}\) is guaranteed to achieve a small generalization error, i.e., \(U_{gd}U_{gd}^{T} U_{}U_{}^{T}\). Hence, the algorithm does learn the correct ground-truth product - what we show is that the learnt model is not "pruning-friendly" - it cannot be sparsified to the correct level by on any simple norm based pruning strategies. This is also observed in Figure 1: the model trained with implicit regularization has many significant columns and it is unclear how many to prune. We provide a proof sketch below, and refer the reader to Appendix A for more details.

Proof sketch of Theorem 1.Without loss of generality we assume in the proof that \(\|U_{}\|_{2}=1\). Defining \(U(t)\) as the iterate at time \(t\), gradient flow on \(_{}\) follows the below dynamic,

\[=-_{}(U)=-(UU^{T}-U_{}U_{}^ {T})U, \]

where for ease of notation we drop the explicit dependence on \(t\) in \(U(t)\). In our proof, we exactly characterize the limiting point of gradient flow as a function of the initialization in a certain sense, which may be of independent interest. In particular, up to a small multiplicative error, we show,

\[ i[k],\;\|U_{}e_{i}\|_{2},U(0 )e_{i}|}{\|U_{}^{T}U(0)\|_{2}}. \]

Also, with Gaussian initialization, \( U_{},U(0)e_{i}}{}(0, ^{2})\) across different values of \(i\). In particular, we show that for some constant \(c_{1}^{}>0\), \((k^{c_{1}^{}})\) columns will have correlations comparable to the maximum, with \(| U_{},U(0)e_{i}| 0.99_{j[k]}| U_{},U (0)e_{j}|\). For any of these columns, \(i\),

\[\|U_{}e_{i}\|_{2},U(0)e_{i}|}{ \|U_{}^{T}U(0)\|_{2}} 0.99_{j[k]},U(0)e_{ j}|}{\|U_{}^{T}U(0)\|_{2}} 0.99_{j[k]}\|U_{}e_{j}\|_{2}, \]

which completes the proof sketch of Theorem 1.

## 4 Explicit regularization gives pruning-friendly models: population analysis

In this section, we study the properties of the squared error augmented with group Lasso regularization in the population (infinite sample) setting. We show that second-order stationary points of the

Figure 1: We run gradient updates to minimize the loss in eq. (2) until convergence. The model is highly overparameterized with \(d=k=500\) and \(r=4\). In the left figure, the vertical axis represents the fraction of columns having their norm at least \(x\) times the largest norm across columns, with \(x\) on the horizontal axis. In the right figure, for the same experiment we plot a histogram of column norms. Using regularization leads to solutions with most of the columns having small \(_{2}\) norm, and only a few significant columns. Without regularization, a large number of columns have their \(_{2}\) norm comparable to the largest column norm. Thus, training with explicit regularization leads to models that are more suitable for pruning.

regularized loss are suitable for greedy pruning, while at the same time achieving a small but non-zero generalization error. Note that the \(_{2}\) norm is a non-smooth function at the origin, and therefore, the overall regularized loss is non-smooth and non-convex. While there are several notions of approximate stationary points for non-differentiable and non-convex functions, for technical convenience, we replace \(\) by a smooth proxy. In particular, for a smoothing parameter \(>0\), define a smooth version of the \(_{2}\) norm, and the corresponding smooth regularizer \(_{}\) as,

\[_{}(U)=_{i=1}^{k}_{2}^{}(Ue_{i}), _{2}^{}(v)=^{2}}{^{2}+ }}. \]

Note that the smaller the value of \(\) is, the closer is \(_{2}^{}(v)\) to \(\|v\|_{2}\). Considering this definition, the overall regularized loss we study in the population setting is

\[f_{}(U)=_{}(U)+_{}(U), \]

where \(_{}=\|UU^{T}-U_{}U_{}^{T}\|_{F}^{2}\) as defined in eq. (2). The above optimization problem is nonconvex due to the structure of \(_{}(U)\), and finding its global minimizer can be computationally prohibitive. Fortunately, for our theoretical results, we do not require achieving global optimality and we only require an approximate second-order stationary point of the loss in eq. (9), which is defined below.

**Definition 2**.: _We say that \(U\) is an \((,)\)-approximate second-order stationary point of \(f\) if,_

1. _The gradient norm is bounded above by_ \(\)_, i.e.,_ \(\| f(U)\|_{2}\)_._
2. _The eigenvalues of the Hessian are larger than_ \(-\)_, i.e.,_ \(_{}(^{2}f(U))-\)_._

The full algorithmic procedure that we analyze in this section is summarized in Algorithm 1. Once we find an \((,)\)-approximate second-order stationary point (SOSP) of eq. (9) for some proper choices of \(\) and \(\), we apply greedy pruning on the obtained model \(U\) and by eliminating all of its columns with \(_{2}\) norm below a specific threshold. As a result, the pruned model \(U_{}\) has fewer columns than the trained model \(U\). In fact, in our following theoretical results, we show that if the parameters are properly selected, \(U_{}\) has exactly \(r\) columns, which is the same as \(U_{}\). Finally, we fine-tune the pruned solution by running gradient descent on the unregularized loss \(_{}\) (resp. \(_{}\)). Next, we state the properties of the pruned model generated by Algorithm 1 in the infinite sample setting.

```
1:Inputs: Measurements \(\{(A_{i},y_{i})y_{i}= A_{i},U_{}U_{}^{T}+ _{i}\}_{i=1}^{n}\) (in the population setting \(n=\));
2:Initialization: Set parameters: \(,,,\) and \(m_{}\).
3:Greedy pruning phase:
4:Find an \((,)\)-approximate SOSP of \(f_{}\) (resp. \(f_{}\)), \(U\), satisfying \(\|U\|_{} 3\).
5:Let \(S=\{i[k]:\|Ue_{i}\|_{2} 2_{2}\).
6:Create a new matrix \(U_{}\) which only preserves the columns of \(U\) in \([k] S\), deleting the columns in \(S\).
7:Fine-tuning phase:
8:Run \(m_{}\) iterations of gradient descent on \(_{}(U)\) (resp. \(_{}(U)\)) initialized at \(U_{}\) to get \(U_{}\).
9:return\(U_{}\).
```

**Algorithm 1** Greedy pruning based on group-Lasso regularization

**Theorem 3**.: _Consider the population loss with regularization in eq. (9), where \(U_{}\) has rank \(r\) and its smallest singular value is denoted by \(_{r}^{}\). Moreover, consider \(U_{}\) as the output of the pruning phase in Algorithm 1 with parameters \(,,,\) satisfying the conditions2,_

\[=c_{}^{})^{2}}{r},=c_{} ^{})^{3}}{}, c_{}^{})^{3}}{r^{5/2}}, c_{} ^{})^{7/2}}{r^{5/2}}, \]

_for some absolute constants \(c_{},c_{},c_{},c_{}>0\). Then, we have_

1. \(U_{}\) _has exactly_ \(r\) _columns._
2. \(\|U_{}U_{}^{T}-U_{}U_{}^{T}\|_{F}(_{r}^{})^{2}\)This result relies on showing that all bounded SOSPs of the regularized loss in eq. (9) are suitable for greedy pruning: removing the columns of \(U\) below a certain \(_{2}\)-norm threshold results in a solution \(U_{}\) having exactly \(r\) columns, while at the same time having a small generalization error. Hence, it can serve as a proper warm-start for the fine-tuning phase.

Proof sketch of Theorem 3.The key idea is to identify that if we have a matrix \(U\) such that \(UU^{T}=U_{}U_{}^{T}\), and the columns of \(U\) are orthogonal to one another, then \(U\) has exactly \(r\) non-zero columns, where \(r\) is the rank of \(U_{}\). This statement can be shown to hold even when \(UU^{T} U_{}U_{}^{T}\) and the columns of \(U\) are only approximately orthogonal. The main observation we prove is that a bounded \((,)\)-approximate SOSPs of eq. (9) denoted by \(U\) satisfies the following condition:

\[ i,j:\|Ue_{i}\|_{2},\|Ue_{j}\|_{2} 2,,Ue_{j}}{\|Ue_{i}\|_{2}\|Ue_{j}\|_{2}} 0. \]

In other words, all the large columns of \(U\) have their pairwise angle approximately \(90^{}\). Thus, by pruning away the columns of \(U\) that have an \(_{2}\) norm less than \(2\), the remaining columns of \(U\), i.e., the columns of \(U_{}\), are now approximately at \(90^{}\) angles to one another. If \(\) is chosen to be sufficiently small, after deleting the low-norm columns, the approximation \(U_{}U_{}^{T} UU^{T}\) holds. By the second order stationarity of \(U\), we also have that \(UU^{T} U_{}U_{}^{T}\). Together, this implies that \(U_{}U_{}^{T} U_{}U_{}^{T}\) and \(U_{}U_{}^{T}\) is close to a rank \(r\) matrix. Since \(U_{}\) has orthogonal columns, this also means that it has exactly \(r\) columns. Finally, to establish a bound on the approximation error, we simply use the triangle inequality that \(\|U_{}U_{}^{T}-U_{}U_{}^{T}\|_{F}\|UU^{T }-U_{}U_{}^{T}\|_{F}+\|UU^{T}-U_{}U_{}^{T}\|_ {F}\). The former is small by virtue of the fact that \(U\) is an approximate second order stationary point of \(f_{}_{}\) when \(\) is small; the latter term is small by the fact that only the small norm columns of \(U\) were pruned away.

Now the only missing part that remains to justify is why the \(_{}\) regularizer promotes orthogonality in the columns of approximate second order stationary points and the expression in eq. (11) holds. This is best understood by looking at the regularized loss for the case \(=0\), which is equivalent to \(\|UU^{T}-U_{}U_{}^{T}\|_{F}^{2}+_{i=1}^{k}\|Ue_{i}\|_{2}\) and consider any candidate first-order stationary point \(U\) of this objective. Let \(Z^{d k}\) be a variable constrained to satisfy \(ZZ^{T}=UU^{T}\). Stationarity of \(U\) implies that the choice \(Z=U\) must also be a first-order stationary point of the constrained optimization problem,

\[\|ZZ^{T}-U_{}U_{}^{T}\|_{F}^{2}+_{i=1}^{k }\|Ze_{i}\|_{2},ZZ^{T}=UU^{T}. \]

The first term in the objective is a constant under the constraint and we may remove it altogether. When \(U\) is a full-rank stationary point, constraint qualification holds, and it is possible to write down the necessary KKT first-order optimality conditions, which reduce to,

\[ i[k],-}{\|Ze_{i}\|_{2}}+(+^{ T})Ze_{i}=0 \]

where \(^{d d}\) is the set of optimal dual variables. Since \(Z=U\) is a first-order stationary point of the problem in eq. (12) and it satisfies eq. (13), the above condition means that the columns \(Ue_{i}\) are the eigenvectors of the symmetric matrix \(+^{T}\). If all the eigenvalues of \(+^{T}\) were distinct, then this implies that the eigenvectors are orthogonal and \(Ue_{i} Ue_{j}\) for all \(i j\).

While this analysis conveys an intuitive picture, there are several challenges in extending this further. It is unclear how to establish that the eigenvalues of \(+^{T}\) are distinct. Moreover, this analysis only applies for full-rank stationary points and does not say anything about rank deficient stationary points \(U\), where constraint qualification does not hold. Furthermore, it is even more unclear how to extend this analysis to approximate stationary points. Our proof will circumvents each of these challenges by \((a)\) showing that at approximate SOSPs, even if the eigenvalues of \(+^{T}\) are not distinct, the columns of \(U\) are orthogonal, and \((b)\) directly bounding the gradient and Hessian of the regularized loss, rather than studying the KKT conditions to establish guarantees even for approximate stationary points which may be rank deficient. Having established guarantees for the pruning phase of the algorithm in the population setting, we next prove a result in the finite sample setting.

Finite sample analysis

Next, we extend the results of the previous section to the finite sample setting. Here, we also focus on the smooth version of the regularizer and study the following problem

\[f_{}(U)=_{}(U)+_{ }(U), \]

where the empirical loss \(_{}\) is defined in eq. (1) and the smooth version of the group Lasso regularizer \(_{}(U)\) is defined in eq. (8). In the finite sample setting, we assume that the measurement matrices satisfy the restricted isometry property (RIP) , defined below.

**Assumption 1**.: _Assume that the measurement matrices \(\{A_{1},,A_{n}\}\) are \((2k,)\)-RIP. In other words, for any \(d d\) matrix with rank \( 2k\),_

\[(1-)\|X\|_{F}^{2}_{i=1}^{n} A_{i},X ^{2}(1+)\|X\|_{F}^{2}. \]

_This condition is satisfied, for instance, if the entries of the \(A_{i}\)'s were sampled \((0,1/d)\) (i.e. Gaussian measurements), as long as \(n dk/^{2}\)._

**Theorem 4**.: _Consider the empirical loss with smooth regularization in eq. (14), where \(U_{}\) has rank \(r\) and unit spectral norm, with its smallest singular value denoted \(_{}^{}\), and noise variance \(^{2}\). Consider \(U_{}\) as the output of the pruning phase in Algorithm 1 with parameters \(,,,\) chosen as per eq. (10). If Assumption 1 is satisfied with \( c_{}^{})^{3/2}}{r^{5/2}}\) and the number of samples is at least \(n C_{4}}{(_{}^{2})^{4}}dk^{2}r^{5}(d/)\), where \(C_{4}>0\) is a sufficiently large constant, then with probability at least \(1-\),_

1. \(U_{}\) _has exactly_ \(r\) _columns._
2. \(U_{}\) _satisfies the spectral initialization condition:_ \(\|U_{}U_{}^{T}-U_{}U_{}^{T}\|_{F}(_{r}^{})^{2}\)_._

With Gaussian measurements, the overall sample requirement (including that from the RIP condition) in Theorem 4 is satisfied when \(n(}{(_{r}^{})^{4}}dk^{ 2}r^{5})\). The high level analysis of this result largely follows that of Theorem 3 in the population setting - we approximate the finite-sample gradient and Hessian by their population counterparts and show that the approximation error decays with the number of samples as \(O(1/)\).

### Fine-tuning phase: Realizing the benefits of pruning

In the fine-tuning phase, the learner runs a few iterations of gradient descent on \(_{}\) initialized at the pruned solution \(U_{}\). Since the model is no longer overparameterized after pruning (by Theorem 4), there are several works analyzing the generalization performance and iteration complexity of gradient descent. Here we borrow the local convergence result of  which requires the initial condition that \(\|U_{0}U_{0}^{T}-U_{}U_{}^{T}\|_{F} c(_{}^{})^{2}\), where \(c\) is any constant less than \(1\). As shown in part (b) of Theorem 4, this initial condition is satisfied by \(U_{}\).

**Theorem 5**.: _[_22_, Corollary 2]_ _Suppose \(\|U_{}\|_{}=1\). If we use the output of the greedy pruning in Algorithm 1 denoted by \(U_{}^{d r}\) as the initial iterate for the fine-tuning phase, then after \(t m_{}=C_{5}(_{1}^{}/_{r}^{} )^{10}(_{r}^{}/_{1}^{} n/d)\) iterations, for some sufficiently large absolute \(C_{5}>0\), the iterates \(\{U_{t}\}_{t 1}\) of factored gradient descent on \(_{}()\) satisfy,_

\[\|U_{t}U_{t}^{T}-U_{}U_{}^{T}\|_{F}^{})^{2}}}. \]

Theorem 5 shows that in the fine-tuning phase, the iterates of gradient descent converges at a linear rate to the generalization error floor of \(/(_{}^{})^{2}\), which is also known to be statistically (minimax) optimal [46; 47]. This is possible because the learner is able to correctly identify the rank of the model in the pruning phase and operate in the exactly specified setting in the fine-tuning phase. In contrast, one may ask how this guarantee compares with running vanilla factored gradient descent in the overparameterized setting. This corresponds to the case where no pruning is carried out to reduce the size of the model.  presented a guarantee for the convergence of factored gradient descent from a warm start in the overparameterized setting. In comparison with the exactly specified case, the generalization error floor \(_{t}\|U_{t}U_{t}^{T}-U_{*}U_{*}^{T}\|_{F}\) is shown to scale as \(O(/(_{*}^{*})^{2})\)3 which now depends on \(k\). Furthermore, linear convergence can no longer be established for vanilla gradient descent because of the ill-conditioning of the objective. This is not just an artifact of the proof - experimentally too, the convergence slowdown was noticed in [23, Figure 1].

This discussion shows that greedy pruning the model _first_, prior to running gradient descent, in fact generates solutions which generalize better and also converge much faster.

**Remark 6**.: _Based on Theorem 4 and Theorem 5 (eq. (16)), under Gaussian measurements, given_

\[n n_{,}=O(}{(_{*}^{*})^{4}} {rd}{^{2}}+}{(_{*}^{*})^{4}}dk^{2}r^{5} (d/)) \]

_samples, with probability \( 1-\), Algorithm 1 produces \(U_{out}\) that has exactly \(r\) columns and satisfies \(\|U_{}U_{out}^{T}-U_{*}U_{*}^{T}\|_{F}\). Note that the sample complexity depends on the amount of overparameterization, \(k\), only in the lower order (independent of \(\)) term._

Note that this result uses the fact that under Gaussian measurements, the RIP condition required in Theorem 4 is satisfied if \(n n_{}\).

## 6 Implementing Algorithm 1: Smoothness and optimization oracles

In this section we instantiate the optimization oracle in Algorithm 1, which outputs an approximate SOSP with bounded operator norm. First, we establish that the loss \(f_{}\) is well behaved on the domain \(\{U:\|U\|_{} 3\}\), in that its gradient and Hessian are Lipschitz continuous. These conditions are required by many generic optimization algorithms which return approximate second order stationary points . We establish these properties for the population loss for simplicity and leave extensions to the empirical loss for future work.

**Theorem 7**.: _Consider the population loss \(f_{}\) in eq. (9). Assume \(\{,\}\) and \(\|U_{*}\|_{}=1\). The objective \(f_{}()\) defined in eq. (9) satisfies for any \(U,V^{d k}\) such that \(\|U\|_{},\|V\|_{} 3\),_

1. _Lipschitz gradients:_ \(\| f_{}(U)- f_{}(V)\|_{F}\|U-V\|_{F}\)_,_
2. _Lipschitz Hessians:_ \(\|^{2}f_{}(U)-^{2}f_{}(V)\|_{} \|U-V\|_{F}\)_._

Under the Lipschitz gradients and Lipschitz Hessian condition, a large number of algorithms in the literature show convergence to an approximate SOSP. A common approach for finding such a point is using the noisy gradient descent algorithm . However, note that we establish these Lipschitzness properties on the bounded domain \(\{U:\|U\|_{} 3\}\), and it remains to verify whether these algorithms indeed approach such points. A similar concern is present with Algorithm 1, which requires access to an optimization oracle which finds an \((,)\)-approximate SOSP of \(f_{}\) which are also bounded, in that \(\|U\|_{} 3\). The final step is to identify conditions under which these algorithms indeed output stationary points which are bounded, satisfying \(\|U\|_{} 3\). We establish this behavior for a wide family of perturbed gradient based methods.

Perturbed gradient descent:We consider gradient descent with the following update rule: starting from the initialization \(U_{0}\), for all \(t 0\),

\[U_{t+1} U_{t}-( f_{}(U_{t})+P_{t}) \]

where \(P_{t}\) is a perturbation term, which for example, could be the explicit noise \((P_{t}((r))\) for appropriate \(r)\) added to escape strict saddle points in . Over the course of running the update rule eq. (18), we show that \(\|U_{t}\|_{}\) remains bounded under mild conditions if the algorithm is initialized within this ball. In combination with Theorem 7, this shows that the noisy gradient descent approach of  can be used to find the SOSPs required for Algorithm 1.

**Theorem 8**.: _Consider optimization of the regularized population loss using the update rule in eq. (18). Assume that \(\|U_{*}\|_{}=1\) and suppose the parameters are selected as\( 1/8\) and \(\), and we have \(\|P_{t}\|_{} 1\) almost surely for each \(t 0\). Then, assuming that the condition \(\|U_{0}\|_{} 3\) is satisfied at initialization, for every \(t 1\), we have \(\|U_{t}\|_{} 3\)._Thus, when perturbed gradient descent is carried out to optimize the regularized loss \(f_{}\) eq. (9), the algorithm always returns bounded iterates. In conjunction with Theorem 7, this implies, for example, that noisy gradient descent  converges to an approximate second-order stationary point of the regularized population objective. Moreover, the authors of the same paper show the number of gradient calls made by noisy gradient descent to find an \((,)\)-SOSP is upper bounded by \((1/\{^{2},^{2}\})\) for a non-convex objective with \(O(1)\)-smooth gradients and Hessians. Combining with the choices of \(\) and \(\) in eq. (10) results in the following theorem.

**Theorem 9**.: _Assume Gaussian measurements and rescale so that \(\|U_{}\|_{}=1\). Given \(n n_{,}\) samples (eq. (17)), consider the algorithm which uses the output of greedy pruning (Algorithm 1), \(U_{}^{d r}\), as the initial iterate for the fine-tuning phase, and runs noisy gradient descent  on \(_{}\) in the fine-tuning phase. Overall, the algorithm makes,_

\[T_{}=(^{})^{10}} (^{}})+}{(_{}^ {})^{7}}) \]

_gradient calls and with probability \( 1-\), returns a \(U_{}\) satisfying \(\|U_{}U_{}^{T}-U_{}U_{}^{T}\|_{F}\)._

## 7 Conclusion

In this paper, we studied the efficacy of the greedy pruning + fine-tuning pipeline in learning low-complexity solutions for the matrix sensing problem, as well as for learning shallow neural networks with quadratic activation functions. We showed that training on the mean squared error augmented by a natural group Lasso regularizer results in models which are suitable for greedy pruning. Given sufficiently many samples, after pruning away the columns below a certain \(_{2}\)-norm threshold, we arrived at a solution with the correct column sparsity of \(r\). Running a few iterations of gradient descent to fine-tune the resulting model, the population loss was shown to converge at a linear rate to an error floor of \(O()\), which is also statistically optimal. We also presented a negative result showing the importance of regularization while training the model. To the best of our knowledge, our results provide the first theoretical guarantee on the generalization error of the model obtained via the greedy pruning + fine-tuning framework.