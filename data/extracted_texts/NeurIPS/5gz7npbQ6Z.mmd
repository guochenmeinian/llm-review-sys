# A Cross-Moment Approach for Causal Effect Estimation

Yaroslav Kivva

School of Computer and Communication Sciences

EPFL, Lausanne, Switzerland

yaroslav.kivva@epfl.ch

&Saber Salehkaleybar

School of Computer and Communication Sciences

EPFL, Lausanne, Switzerland

saber.salehkaleybar@epfl.ch

&Negar Kiyavash

College of Management of Technology

EPFL, Lausanne, Switzerland

negar.kiyavash@epfl.ch

###### Abstract

We consider the problem of estimating the causal effect of a treatment on an outcome in linear structural causal models (SCM) with latent confounders when we have access to a single proxy variable. Several methods (such as difference-in-difference (DiD) estimator or negative outcome control) have been proposed in this setting in the literature. However, these approaches require either restrictive assumptions on the data generating model or having access to at least two proxy variables. We propose a method to estimate the causal effect using cross moments between the treatment, the outcome, and the proxy variable. In particular, we show that the causal effect can be identified with simple arithmetic operations on the cross moments if the latent confounder in linear SCM is non-Gaussian.In this setting, DiD estimator provides an unbiased estimate only in the special case where the latent confounder has exactly the same direct causal effects on the outcomes in the pre-treatment and post-treatment phases. This translates to the common trend assumption in DiD, which we effectively relax. Additionally, we provide an impossibility result that shows the causal effect cannot be identified if the observational distribution over the treatment, the outcome, and the proxy is jointly Gaussian. Our experiments on both synthetic and real-world datasets showcase the effectiveness of the proposed approach in estimating the causal effect.

## 1 Introduction

Estimating the effect of a treatment (or an action) on an outcome is an important problem in many fields such as healthcare , social sciences , and economics . Randomized control trials are the gold standard to estimate causal effects. However, in many applications, performing randomized experiments are too costly or even infeasible, say due to ethical or legal concerns. Thus, estimating the causal effect from merely observational studies is one of the main topics of interest in causal inference. This problem has been studied extensively in two main frameworks, potential outcome (PO) framework  and structural causal model (SCM) framework . The mainquantity of interest in PO framework is the individual-based response variable, i.e., the value of outcome for a specific individual in the population considering a particular value for the treatment. In SCM framework, a set of structural causal assignments are defined to describe the data generation mechanism among a set of variables. This set of assignments is often represented by a directed acyclic graph (DAG) to show the causal relationships among the variables in the model. It can be shown that the two frameworks are logically equivalent in the sense that any theorem in one can be translated to the other .

Difference-in-Difference (DiD)  is one of the most frequently used non-experimental methods to estimate the effect of a treatment by comparing the average of outcome before and after applying the treatment in a treatment and control group. In fact, 26 of 100 most cited papers published by the American Economic Review used some variant of DiD or two-way fixed effect (an extension to multi-group and multi-time slots) to estimate the causal effect . DiD is an estimation process in PO framework for the setting where we have access to a population partitioned into control and treatment groups. The goal is to estimate the effect of treatment \(D\) on outcome \(Y\) where \(D\) is equal to one if a treatment is given to an individual and zero otherwise. It is also assumed that the value of the outcome is observed just before giving any treatment (this pre-treatment value is denoted by \(Z\)) and it can be seen as a proxy variable for latent common causes of \(D\) and \(Y\). DiD method computes the causal effect by subtracting the difference of average outcome in two groups before applying treatment (i.e., \([Z|D=1]-[Z|D=0]\)) from the one after the treatment (i.e., \([Y|D=1]-[Y|D=0]\)). It can be shown the output of DiD is an unbiased estimate of the causal effect under some assumptions such as the parallel/common trend assumption which states that the outcome of the treatment group would have followed the same trend as the control group in the absence of the treatment (see (2) for the exact definition).

Although the initial setting of DiD is in PO framework, its counterpart in the SCM framework was considered in the negative outcome control approach . A negative outcome variable is a type of proxy variable that is not causally affected by the treatment. The causal graph in this approach is represented in Figure 1 where the unmeasured common cause of \(D\) and \(Y\) is represented by a latent variable \(U\) and \(D\) is not a cause of proxy variable \(Z\). The causal effect of \(D\) on \(Y\) cannot be identified from the observational distribution over \((D,Y,Z)\) because of the common confounder \(U\). However, imposing further assumptions on the SCM, the causal effect of \(D\) on \(Y\) can become identified. Such assumptions include monotonicity , knowledge of the conditional probability \(P(Z|U)\), or having at least two proxy variables , all of which may not hold in practice (see related work in Section 4 for a more detailed discussion). Recently,  considered linear SCMs with non-Gaussian exogenous noise 1 and proposed a method that can identify the causal effect for the causal graph in Figure 1 from the observational distribution over \((D,Y,Z)\). The proposed method is based on solving an over-complete independent component analysis (OICA) . However given the landscape of the optimization problem, in practice, OICA can get stuck in bad local minima and return wrong results .

In this paper, we consider the setup in causal graph in Figure 1 in linear SCM where we have access to a proxy variable \(Z\). We propose a "Cross-Moment" algorithm that estimates the causal effect using cross moments between the treatment, the outcome, and the proxy variable. Our main contributions are as follows:

* We show that the causal effect can be identified correctly from the observational distribution if there exists \(n\) such that for the latent confounder \(U\), we have: \([U^{n}](n-1)[U^{n-2}][U^{2}]\) (Theorem 1). Under additional mild assumption (Assumption 3), this condition implies that our proposed method can recover the causal effect when \(U\) is non-Gaussian. Additionally, when the observational distribution is jointly Gaussian, we prove that it is impossible to identify the causal effect uniquely (Theorem 3).

Figure 1: The suggested causal graph in SCM framework for the approaches in DiD and negative outcome control.

* Unlike previous work  which requires solving an OICA problem, the proposed approach only performs simple arithmetic operations on cross moments. Therefore, it does not suffer from the drawbacks of OICA such as getting stuck in bad local optima.
* We show that DiD estimator in general provides a biased estimate of the causal effect over the data generated by the linear SCM consistent with the causal graph in Figure 1 unless the latent confounder has exactly the same values of direct causal effects on the outcomes in the pre-treatment and post-treatment phases. Our proposed method does not require such a strong restriction.

The structure of the paper is as follows. In Section 2, we define the notation and provide some background on DiD estimator. In Section 3, we describe Cross-Moment algorithm and show that it recovers the true causal effect under mild assumptions on the distribution of the latent confounder. We also show that DiD estimator is in general biased if the data generative model follows a linear SCM. In Section 4, we review the related work. In Section 5, we evaluate the proposed algorithm experimentally and show its superior performance compared to the state of the art. Finally, we conclude the paper in Section 6.

## 2 Preliminaries and Notations

Throughout the paper, we denote random variables by capital letters and their realizations by small letters e.g., \(X\) and \(x\), respectively. Bold capital letters are used to specify a set of random variables and their realizations are denoted by small capital letters (e.g., \(\) and \(\)).

A SCM \(\) over a set of random variables \(\) is defined by a set of assignments \(\{X:=f_{X}^{}(_{}(X),_{X})\}_{X }\), where \(_{X}\) is the exogenous noise corresponding to \(X\) and \(_{}(X)\). It is assumed that the exogenous noises are mutually independent. Let us denote by \(\) and \(\), the set of observed and unobserved variables in \(\), respectively. Note that \(=\) and \(=\).

The set of assignments in SCM \(\) is commonly represented by a DAG. Let \(=(,)\) be a DAG with the set of vertices \(\) and set of edges \(\). For ease of notation, we use the notation of \(\) for the set of vertices in the graph. We also use the term "vertex" and "random variable" interchangeably. Each vertex in the graph represents some random variable and each direct edge shows a direct causal relationship between a pair of random variables. In particular, we say that \(X\) is a parent of \(Y\) or, equivalently, \(Y\) is a child of \(X\) if \((X,Y)\). We define \(_{}(X)\) as a set of all parents of \(X\) in graph \(\).

### Difference-in-Difference (DiD)

Difference-in-difference (DiD) was proposed in the PO framework in order to estimate the causal effect from observational studies under some assumptions. In this framework, the population under study is divided into control and treatment groups and only individuals in the treatment group receive the treatment. In particular, the treatment variable \(D\) represents treatment assignment which is equal to \(1\) if the treatment was given and \(0\) otherwise. Let \(Y(0)\) and \(Y(1)\) be two random variables representing the outcome under treatment value \(D=0\) and \(D=1\), respectively. Denote the value of the outcome right before administering the treatment by \(Z\) and assume it is measurable. Our goal is to obtain the average causal effect in the treatment group \([Y(1)-Y(0)|D=1]\). DiD estimate of the average causal effect equals:

\[([Y|D=1]-[Y|D=0])-([Z|D=1]-[Z|D=0]).\] (1)

This quantity is an unbiased estimate of the average causal effect as long as the following assumptions hold.

* Stable Unit Treatment Value Assumption (SUTVA): \[Y=DY(1)+(1-D)Y(0).\]
* Common trend assumption: \[[Y(0)-Z(0)|D=1]=[Y(0)-Z(0)|D=0].\] (2)

SUTVA states that the potential outcome for each individual is not related to the treatment value of the other individuals. The common trend assumption states that there would be the same "trend" in both groups in the absence of treatment which allows us to subtract group-specific means of the outcome in estimating the average causal effect in (1).

Methodology: Cross-Moment Algorithm

In this section, we propose Cross-Moment algorithm to estimate the causal effect of treatment \(D\) on outcome \(Y\). Throughout this section, we consider linear SCMs, i.e., each random variable in SCM \(\) is a linear combination of its parents and its corresponding exogenous noise. More precisely, the linear assignments in \(\) for the causal graph in Figure 2 are:

\[ U&:=_{u},\\ Z&:=_{z}U+_{z}=_{z}_{u}+ _{z},\\ D&:=_{d}U+_{d}=_{d}_{u} +_{d},\\ Y&:= D+ U+_{y}=(_{d}+ )_{u}+_{d}+_{y},\] (3)

Without loss of generality, we assume that \(_{u}\), \(_{y}\), \(_{z}\), \(_{d}\) are arbitrary random variables with zero mean. This assumption can always be achieved by centering the observational data.

Moreover, we assume that the only observed random variables are given by \(=\{D,Y,Z\}\). Our goal is to identify \(\) (the causal effect of \(D\) on \(Y\)) from the distribution over the observed variables \(\). We consider SCMs that satisfy the following assumption.

**Assumption 1**.: In the linear SCM given by (3), \(_{z} 0\) and \((_{d})>0\).

Assumption 1 is necessary for identifying the causal effect. In particular, if \(_{z}=0\), the directed edge from \(U\) to \(Z\) is removed and the causal effect cannot be identified even if all the exogenous noises are non-Gaussian as shown in . Moreover, if \((_{d})=0\), then \(_{d}\) is zero almost surely (as we assumed that all the exogenous noises are mean zero). In this case, we can construct another SCM \(^{}\) which encodes the same observational distribution as our original SCM but results in a different value of the causal effect of \(D\) on \(Y\) compared to the original SCM. More specifically, in this SCM, we delete the directed edge from \(U\) to \(Y\) and change the structural assignment of \(Y\) to \(Y:=(+/_{d})D+_{y}\). Hence, the assumption \((_{d})>0\) is necessary for the unique identification of the causal effect.

Under Assumption 1, it can be shown that:

\[=(D,Y)-}{_{z}}(Y,Z)}{ (D)-}{_{z}}(D,Z)},\] (4)

where \((A,B)\) denotes the covariance of random variables \(A\) and \(B\) and \((A)\) is the variance of \(A\). \(\) is identifiable as long as the ratio \(_{d}/_{z}\) is known as we can obtain \((D,Y),(Y,Z),(D),\) and \((D,Z)\) from the observational distribution. In the sequel, we will show how this ratio can be learnt as long as \(_{u}\) has bounded moments.

**Assumption 2**.: For all \(n\), assume that: \([_{u}^{n}]<\).

When the bounded moment assumption of 2 holds, the following theorem provides an approach for recovering \(_{d}/_{z}\).

**Theorem 1**.: _For variables \(Z\) and \(D\) as defined in (3), under Assumptions 2, \(}{_{z}}\) can be determined uniquely if \( n\) such that:_

\[[_{u}^{n}](n-1)[_{u}^{n-2}][_{u}^{2}],\] (5)

_where \(_{u}=_{z}}_{u}\)._

The detailed proof of the Theorem 1 is provided in the Appendix A.

It is interesting to see for what families of distributions, the condition in Theorem 1 is satisfied. Assume (5) is not satisfied. Recall that from the definition of SCM (3), \([_{u}]=0\) and \([(})^{2}]=[DZ]\). These in a combination with \([_{u}^{n}]=(n-1)[_{u}^{n-2}][_{u}^{2}]\) for any \(n\) determine

Figure 2: The considered causal graph with linear assignments in the SCM framework.

uniquely all the moments of \(_{u}\). More specifically, recursively solving for \([_{u}^{n}]\) we have \([_{u}^{n}]=(n-1)!![(_{u})^{2}]\) for even \(n 1\) and \([_{u}^{n}]=0\) for odd \(n 1\) where \(n!!\) denotes double factorial. Double factorial notation \(n!!\) denotes the product of all numbers from 1 to \(n\) with the same parity as \(n\). Specifically the moments of Gaussian distribution satisfy the aforementioned moment equation. Therefore when \(_{u}\) is Gaussian, we cannot identify the causal effect. Under some mild technical assumption on \(_{u}\) (see Assumption 3 in the following), we can prove that the moments of \(_{u}\)_uniquely_ determine its distribution. As a result, as long as \(_{u}\) is non-Gaussian, we can identify the causal effect.

**Assumption 3**.: We assume that there exists some \(s>0\) such that the power series \(_{k}[_{u}^{k}]r^{k}/k!\) converges for any \(0<r<s\).

**Corollary 1**.: _Under Assumptions 1, 2 and 3, the causal effect \(\) can be recovered uniquely as long as \(_{u}\) is not Gaussian._

In , it was shown that \(\) can be recovered as long as _all_ exogenous noises are non-Gaussian. Therefore, our result relaxes the restrictions on the model in  by allowing \(_{D},_{Y},_{Z}\) to be Gaussian.

Based on Theorem 1, we present Cross-Moment algorithm in Algorithm 1 that computes coefficient \(\) from the distribution over the observed variables \(Z,D,Y\). Algorithm 1 is comprised of two functions _GetRatio_ and _GetBeta_. In the proof of Theorem 1, we show that \(|_{d}/_{z}|=(/)^{1/(n-2)}\) for the smallest \(n\) such that \( 0\) where num and den are defined in lines 6 and 7 of function _GetRatio_, respectively. Moreover, \([DZ]\) has the same sign as \(_{d}/_{z}\) and we can recover the sign of the ratio \(_{d}/_{z}\) from \([DZ]\). Thus, in lines 8-10, for the smallest \(n\) such that \( 0\), we obtain the ratio \(_{d}/_{z}\) and then use it in function _GetBeta_ to recover \(\).

For ease of presentation, we presented the Cross-Moment algorithm for the specific causal graph in Figure 2 with only one proxy. However, the Cross-Moment algorithm can be utilized in a more general setting with additional covariates and latent confounders such as in the graph depicted in Figure 3. This generalization is stated in the following theorem.

**Theorem 2**.: _Suppose that the linear SEM of (3) with the graph in Figure 2 is extended with observed covariates \(\), non-Gaussian latent confounders \(\) and proxy variables \(\) such that_

* _none of the observed covariate is a descendant of any latent variable;_
* _no latent confounder_ \(U\) _of variables_ \(D\) _and_ \(Y\) _is an ancestor of any other latent confounder;_
* _for each latent confounder_ \(U\) _there exists a unique proxy variable_ \(Z\) _which is not an ancestor of_ \(Y\)_;_
* _each latent confounder and its unique proxy variable satisfy the Assumptions_ 1_,_ 2 _and_ 3_._

_Then the causal effect \(\) from \(D\) to \(Y\) can be computed uniquely from the observational distribution._

The proof of the theorem appears in Appendix A. The main idea of the proof is to reduce the problem to a set of sub-problems that can be solved with Cross-Moment algorithm. As mentioned earlier, an example of the causal graph satisfying the conditions of the theorem is depicted in Figure 3.

Figure 3: Example of causal graph extended with two observed covariates, two latent confounders, and corresponding proxy variables.

### Impossibility Result

In the previous sections, we showed that the causal effect \(\) can be identified if the distribution of latent confounder is non-Gaussian. Herein, we show that no algorithm can learn \(\) uniquely if the observed variables are jointly Gaussian in any linear SCM defined by (3) satisfying the following assumption.

**Assumption 4**.: In the linear SCM defined by (3), \(_{d} 0\), \( 0\) and \((_{z})>0\).

**Theorem 3**.: _Suppose that the observed variables in linear SCM defined by (3) are jointly Gaussian. Under Assumptions 1, 2 and 4, the total causal effect \(\) cannot be identified uniquely._

The proof of the Theorem 3 appears in the Appendix A. The key idea in the proof is to show that there exist two linear SCMs that encode the same observational distribution and are consistent with the causal graph in Figure 2 but the causal effect of \(D\) on \(Y\) has two different values in these two models.

Note that it is known that the causal structure is not identifiable in a linear SCM with Gaussian exogenous noises . Our impossibility result here is different from the non-identifiability result in linear Gaussian models. Specifically, in the linear Gaussian models, the goal is to recover all the coefficients in the linear SCM from the observational distribution. In our setting, we have additional knowledge of the exact DAG (restriction on the form of the linear SCM in (3)), and the goal is to identify a specific coefficient (i.e., \(\)) from the linear SCM. Therefore, we have more constraints on the model and need to infer less information about it. Still, we show that the target coefficient \(\) cannot be determined in the causal graph in Figure 2 if the observed variables are jointly Gaussian.

### Bias in DiD Estimator

Suppose that the data is generated from a linear SCM consistent with the causal graph in Figure 2. We show that DiD estimator is biased except when the latent variable \(U\) has the exact same direct causal effect on \(Z\) that it has on \(Y\), i.e., \(_{Z}=\). Our Cross-Moment algorithm identifies the true causal effect without any such restrictive assumption on the coefficients of the linear SCM.

DiD estimator is given by the following linear regression :

\[=_{1}T+_{2}D+DT,\] (6)

where \(_{1}\), \(_{2}\), and \(\) are the regression coefficients and \(T\) is a binary variable that equals zero for the pre-treatment phase and equals one otherwise. In the pre-treatment phase, \(Z\) (i.e., the outcome before the treatment) is predicted as \(_{2}D\) and in the post-treatment phase, \(Y\) (the outcome after giving treatment to the treatment group) is predicted accordingly as \(_{1}+(+_{2})D\). In order to obtainthe regression coefficients, the expectation of squared residuals over the population is minimized as follows (see Appendix C for the derivations of the following minimization problem and subsequent equations in this section):

\[_{_{1},_{2},}[(Z-_{2}D )^{2}]+[(Y-_{1}-(+_{2})D)^{2}].\]

This results in the following regression coefficients:

\[_{1}=0,_{2}=[ZD]}{[D^{2} ]},=[YD]-[ZD]}{[D^{2}]}.\]

DiD estimator returns \(\) in the above equation as the estimation of causal effect which is equal to:

\[=+(-_{z})[U^{2}]}{ [D^{2}]}.\] (7)

Thus, \(\) is an unbiased estimate of \(\) only when \(=_{z}\). In other words, latent variable \(U\) should have the same direct causal effect on \(Z\) and \(Y\). This is akin to the so-called common trend assumption which says that the average natural drift (here, the effect of \(U\)) is assumed to be the same across both the control and treatment groups. This result is consistent with the findings in , which studied a similar phenomenon in the DiD setting. In summary, whenever the common trend assumption is violated, the DiD estimator is biased.

## 4 Related work

In the past few years, there has been a growing interest in the literature to exploit proxy variables to de-bias the effect of latent confounders. A special type of such proxy variable is the so-called negative outcome which is a variable known not to be causally affected by the treatment . For instance, the variable \(Z\) in Figure 1 may be considered as negative outcome. In fact,  interpreted DiD as a negative outcome control approach and proposed a method inspired by change-in-change  to identify the causal effect under the assumption that \(Y(0)\) and \(Z\) are monotonic increasing functions of latent confounders and some observed covariates.

 considered three settings in causal inference with proxy variables: 1- There exists only one proxy variable such as \(Z\) as a negative outcome. In this case, for discrete finite variables \(Z\) and \(U\), they showed that the causal effect can be identified if \((Z|U)\) is known from some external studies such as pilot studies. 2- Two proxy variables, for instance \(Z\) and \(W\) are considered where \(U\), \(Z\), and \(W\) are all discrete finite variables and \(Z\) does not have a directed path to \(D\) or \(Y\). It has been shown that the causal effect is identifiable under some assumptions on the conditional probabilities of \((Y|D,U)\) and \((Z,W|X)\). In the setting, it is not necessary to know \((Z|U)\) but two proxy variables are required to identify the causal effect. 3- In linear SCM,  showed that \(\) (the average causal effect of \(D\) on \(Y\)) can be recovered using two proxy variables. Later,  also considered a setting with two proxy variables \(Z\) and \(W\). Unlike the second setting in , here, \(Z\) and \(W\) can be parents of \(D\) and \(Y\), respectively. For the discrete finite variables, they showed that the causal effect can be identified if the matrix \(P(W|Z,D=d)\) is invertible. Moreover, they provided the counterpart of this condition for continuous variables.  extended the identification result in , with a weaker set of assumptions. Still, they required two proxy variables to identify the causal effect. Based on the results in ,  introduced a proximal causal inference in PO framework. Later,  provided an alternative proximal identification result to that of , again when two proxy variables were available. More recently,  considered the PO framework under linearity assumptions for treatment and post-treatment phase. In this setting, the authors showedthe identifiability of causal effect if in the pre-treatment phase, the latent confounder jointly with observed outcome follows a multivariate Gaussian distribution, and in the treatment phase, the exogenous noise of outcome variable is non-Gaussian.

In linear SCMs, to the best of our knowledge, the methods that can identify the causal effect with only one proxy variable in Figure 2 are based on solving an OICA problem. In particular,  considered linear SCM with non-Gaussian exogenous noises in the presence of latent variables. They showed that under some structural conditions, the causal effects among observed variables can be identified and the causal graph in Figure 2 satisfies such structural conditions.  extended the results in . They showed that the causal structure (direction) can always be identified, and the causal effect can be identified up to equivalence classes depending on the graphical conditions (the causal graph in Figure 2 is still uniquely identifiable). However, both proposed methods  require solving an OICA, and existing algorithms for solving such a problem might get stuck in bad local optima. Recently,  provided two graphical conditions for the same setting in  which are necessary for the identification of the causal structure. These conditions are closely related to the sparsity of the causal graphs. For the causal graph in Figure 2, the method proposed in  for estimating the causal effect is the same as the one in  and thus has the same drawback. Concurrent to our submission,  considered the problem of causal discovery for the linear non-Gaussian models. Under the specific assumptions on the true causal graph, they proposed an algorithm for learning the causal structure as well as the causal coefficients using high-order cumulants.

In PO framework, the setting of having just a pre-treatment phase and a post-treatment phase can be generalized to the case with multiple time slots in the panel data model . In this paper, we mainly focus on the setting with two groups and two time slots but one can also study the extensions of the current work for other settings in the panel data model described in the following. Consider two \(N T\) matrices \(\) and \(\) where \(N\) is the number of individuals in the population and \(T\) is the number of time slots. Assume that only the outcome for some individuals and time slots is observable. In particular: \(Y_{it}=(1-D_{it})Y_{it}(0)+D_{it}Y_{it}(1)\), where the realized outcome for individual \(i\) at time slot \(t\) is denoted by \(Y_{it}(D_{it})\). DiD method has been proposed for the case \(T=2\), i.e., two time slots (pre-treatment and post-treatment phases). In the literature, other cases have been also studied for various assumptions on matrix \(\). For instance, in unconfounded case , the number of individuals is much larger than the number of time slots (\(N T\)), and the treatment is provided only at the last time slot. Another setting is that of synthetic control  where \(T N\). In this setting, there is a single treated individual (suppose individual \(N\)) and the goal is to estimate its missing potential outcomes for any \(t[T_{0},T]\) after administering the treatment at time \(T_{0}\). The last setting considers \(N T\) and a two-way-fixed-effect (TWFE) regression model has been proposed to estimate the causal effect (see for a survey on TWFE in ). It is noteworthy that TWFE estimator is equivalent to DiD estimator for two groups and two time slots.

## 5 Experiments

In this section, we first evaluate our algorithm on synthetic data and compare it to DiD estimator and as well as the related work in  which estimates the causal effect in linear SCMs with two proxy variables. Further, we apply our algorithm to a real dataset provided by . The implementation of the algorithm and additional experimental results are provided in https://github.com/ykivva/Cross-Moments-Method.

### Synthetic data

We generated samples according to the SCM in (3) and with all the exogenous noises distributed according to exponential distribution. Note that the distribution of \(_{u}\), i.e., the exponential distribution satisfies Assumptions 2 and 3. Therefore \(\) is identifiable according to the Corollary 1.

Given the observational data, we estimated the value of \(\) from the following four approaches:

1. Cross-Moment algorithm (proposed in this work).
2. DiD estimator of (6).
3. A simple linear regression model based on the following equation: \(= Z+D\).
4. Causal effect estimate for linear SCM with two proxy variables (proposed in ). In the experiments, we call this estimate "two-proxy" method.

It is noteworthy that we also evaluated the method in  which uses OICA as a subroutine. Unfortunately, the performance was too poor to be included.

For each sample size, we sampled parameters \(_{z}\), \(_{d}\), \(\), \(\) randomly and then generated the samples of \(Z\), \(D\), \(Y\) accordingly to (3) (More details regarding the data generation mechanism can be found in Appendix B). We ran an experiment \(10\) times and reported the the average relative error for each value of sample size: \(err=[|}{}|].\)Figure 3(a), depicts the performances of Cross-Moment algorithm, DiD estimator, and the simple linear regression when we have access to only one proxy variable. The colored region around each curve shows the empirical standard deviation of \(|(-)/|\). Cross-Moment algorithm outperforms the other two methods significantly. In fact, DiD estimator is biased if \(_{z}\) which occurs with measure one as \(_{z}\) and \(\) are generated randomly. Moreover, DiD estimate is no better than simple linear regression if \(\) is not close to \(_{z}\). In the literature, it has been noted that the parallel trend assumption (in linear SCM, this assumption is equivalent to the condition \(_{z}=\)) is violated if the scale of the proxy variable \(Z\) and outcome variable \(Y\) are different which can be the case in many practical applications [L\({}^{+}\)11].

We compared Cross-Moment with the two-proxy method in [KP14] when we have access to two proxy variables. In particular, we assumed that there is an additional proxy variable \(W\) such that \(W:=_{w}U+_{w}\). For Cross-Moment algorithm, we considered three versions: I - "Cross-Moment: Z", which estimates the causal effect by using only proxy variable \(Z\) (we denote this estimate by \(_{Z}\)), II - "Cross-Moment: W", which estimates \(\) from only proxy variable \(W\) (which we denote the estimate by \(_{W}\)), III - "Cross-Moment: W-Z", which estimates \(\) from aggregating the estimates of the methods I and II. In particular, "Cross-Moment: W-Z" uses bootstrapping method (Monte Carlo algorithm for case resampling [ET94]) to estimate the variances of estimates \(_{Z}\) and \(_{W}\), denoted by \(^{2}_{_{Z}}\) and \(^{2}_{_{W}}\), respectively. Subsequently, \(\) is estimated by combining two estimates \(_{Z}\) and \(_{W}\) with an inverse-variance weighting scheme [SHK11] where we give a higher weight to the estimate with the lower variance: \(_{_{Z}}}{^{2}_{_{Z}}+^{2}_{_{W}}} _{W}+_{_{W}}}{^{2}_{_{Z}}+^{2}_{ _{W}}}_{Z}\). When \((_{w})/(W)\) and \((_{z})/(Z)\) are small, the causal effect can be estimated with a low estimation error from either \(Z\) or \(W\) as they contain low noise versions of the latent confounder \(U\). In our experiments, we considered the case where one of the proxy variables (herein, \(W\)) is too noisy but not the other one. Specifically, we choose\((_{w})/(_{u})=10\) and \((_{z})/(_{u})=0.1\). Figure 3(b) illustrates the performances of the three aforementioned variants of Cross-Moment algorithm and the two-proxy method in [KP14]. "Cross-Moment: Z" has the best performance since it uses \(Z\) with less noise as the proxy variable. Moreover, "Cross-Moment: W-Z" has a comparable performance by combining the estimates of \(_{Z}\) and \(_{W}\). The two-proxy estimate does not exhibit robustness and has a large average relative error for various values of sample size.

### Minimum Wage and Employment Dataset

We evaluate our method on the real data which contains information about fast-food stores (Burger King, Roy Rogers, and Wendy's stores) in New Jersey and Pennsylvania in 1992, and some details about them such as minimum wage, product prices, open hours, etc [CK93]. The goal of study was to estimate the effect of the increment in minimum wage in New Jersey from $ 4.25 to $ 5.05 per hour on the employment rate.

Figure 4: The performance measure \(err\) against the number of samples. Colored regions show the standard deviation of the \(err\).

The data was collected by interviews in two waves, before and after the rise in the minimum wage. The information was gathered from \(410\) restaurants with similar average food prices, store hours, and employment levels. In this experiment, stores from Pennsylvania are treated as a control group and stores from New Jersey are considered as the treatment group. We define employment level \(Y\) as \(Y=Y_{f}+Y_{p},\) where \(Y_{p}\) is a number of employees working part-time and \(Y_{f}\) is a number of employees working full-time.

First, we reproduced the results in . We considered an extended version of TWFE model :

\[=_{1}T+^{T}+_{2}D+DT,\]

where \(\) is the estimate of number of employees in the store, \(T\) is a binary variable that equals \(0\) prior to raising the minimum wage and equals to \(1\) after the raise. \(D\) is equal to \(0\) if the store is in Pennsylvania and equal to \(1\) if the store is in New Jersey. \(\) is a vector that contains additional information such as the opening hours, product prices, etc. \(\) is also a vector of parameters corresponding to the vector \(\). We dropped all the stores from the dataset that contain NaN values after which \(246\) restaurants were left. The estimate of \(\) computed by TWFE is given in the first row of Table 1. According to , the estimate of \(\) is equal to \(2.76\). The difference in estimation is due to the slight difference in the features of the vector \(\), i.e.,  added a few additional manually computed features to \(\).

For the Cross-Moment algorithm, in order to incorporate the features \(\) in estimating \(\), we first regressed \(Y\) on \(\) and then used \(Y-\) instead of \(Y\) as the outcome. The result of applying Cross-Moment algorithm to this newly defined outcome is given in the first row of Table 1 and is very close to the estimate by TWFE.

Finally, we assumed that the additional information \(\) gathered during the interview is not available. Then TWFE model for the employment level takes the following form

\[=_{1}T+_{2}D+DT.\]

We used the previously pre-processed dataset but dropped the columns corresponding to \(\). Subsequently, we applied TWFE and Cross-Moment method to estimate \(\). The respective estimates appear in the second row of Table 1, which stipulate the rise in the minimum wage had a positive effect on the employment level.

## 6 Conclusion

We considered the problem of estimating the causal effect of a treatment on an outcome in the linear SCM where we have access to a proxy variable for the latent confounder of the treatment and the outcome. This problem has been studied in both PO framework (such as DiD estimator) and SCM framework (such as the negative outcome control approach). We proposed a method that uses cross moments between the treatment, the outcome, and the proxy variable and recovers the true causal effect if the latent confounder is non-Gaussian. We also showed that the causal effect cannot be identified if the joint distribution over the observed variable are Gaussian. Unlike previous work which requires solving an OICA problem, our performs simple arithmetic operations on the cross moments. We evaluated our proposed method on synthetic and real datasets. Our experimental results show the proposed algorithm has remarkable performance for synthetic data and provides consistent results with previous studies on the real dataset we tested on.