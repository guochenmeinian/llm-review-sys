# Randomized Truthful Auctions with Learning Agents

Gagan Aggarwal

Google Research

gagana@google.com

&Anupam Gupta

New York University, Google Research

anupam.g@nyu.edu

&Andres Perlroth

Google Research

perlroth@google.com

&Grigoris Velegkas

Yale University

grigoris.velegkas@yale.edu

Part of the work was done while the author was a research intern at Google Research in Mountain View.

###### Abstract

We study a setting where agents use no-regret learning algorithms to participate in repeated auctions. Kolumbus and Nisan (2022) showed, rather surprisingly, that when bidders participate in second-price auctions using no-regret bidding algorithms, no matter how large the number of interactions \(T\) is, the runner-up bidder may not converge to bidding truthfully. Our first result shows that this holds for _general deterministic_ truthful auctions. We also show that the ratio of the learning rates of the bidders can _qualitatively_ affect the convergence of the bidders. Next, we consider the problem of revenue maximization in this environment. In the setting with fully rational bidders, Myerson (1981) showed that revenue can be maximized by using a second-price auction with reserves. We show that, in stark contrast, in our setting with learning bidders, _randomized_ auctions can have strictly better revenue guarantees than second-price auctions with reserves, when \(T\) is large enough. Finally, we study revenue maximization in the non-asymptotic regime. We define a notion of _auctioneer regret_ comparing the revenue generated to the revenue of a second price auction with truthful bids. When the auctioneer has to use the same auction throughout the interaction, we show an (almost) tight regret bound of \((T^{3/4})\). If the auctioneer can change auctions during the interaction, but in a way that is oblivious to the bids, we show an (almost) tight bound of \(()\).

## 1 Introduction

In auction design, truthfulness is a highly sought-after property. It allows bidders to simply reveal their true valuations, simplifying the bidding process. In the standard single item setting with fully rational profit-maximizing bidders, Myerson's seminal paper Myerson (1981) shows that an auctioneer can achieve optimal revenue by using a _truthful and deterministic_ auction mechanism - a Second Price Auction (SPA) with a reserve price.

In many applications nowadays, buyers no longer bid directly in the auction but, instead, use learning algorithms to bid on their behalf. For example, in online advertising, platforms offer automated bidding tools that manage ad campaigns on behalf of advertisers. Such bidders learn to bid over many rounds and are not fully rational. In a surprising result, Kolumbus and Nisan (2022) show that some appealing properties of second-price auctions break down in the presence of such learning bidders. In particular, when (profit-maximizing) bidders use no-regret learning algorithms, the second-price auction does not achieve as much revenue as with fully rational bidders. Indeed, bidders do not learn to bid their value, and consequently, the runner-up bidder's bid is less than their value with positive probability, which diminishes the second price auction's revenue. Moreover, Kolumbus and Nisan(2022b) show that for a setting where rational agents are using learning algorithms to bid, then it is no longer optimal to truthfully submit their value as the input to the learning algorithm. This raises a crucial question: are there truthful auctions that promote convergence to the true valuations within a learning environment, and can they also guarantee strong revenue performance?

In this paper we provide an affirmative answer to this question. In doing so, we also showcase the value of _randomized_ mechanisms -- often overlooked in settings with profit-maximizing bidders -- for environments where bidders are learning agents. While randomization introduces inherent inefficiencies due to allocations to low-valuation bidders, this very behavior facilitates learning among low-valuation bidders. A revenue-maximizing auctioneer must now carefully balance the randomization within a truthful mechanism to incentivize learning without incurring excessive revenue loss due to mis-allocation.

We build our theory based on the model presented by Kolumbus and Nisan (2022a). We consider single-item repeated interactions over \(T\) periods. There are two profit-maximizing bidders participating in the auctions, with valuations that are drawn independently from the same distribution, and fully persistent over time. This assumption is motivated by online ad auctions, where multiple auctions are taking place every second, and the valuations of the advertisers remain stable for certain time scales, e.g., a day or a week. Thus, there is typically a very large sequence of auctions where the valuations of the participating agents are persistent. Bidders use mean-based no-regret learning algorithms (Braverman et al., 2018) and receive full feedback on which they base their updates. (Many of our results extend immediately to multiple bidders. We discuss other extensions, such as the partial feedback settings, in Appendix G.) The auctioneer focuses on truthful auctions, and their objective is to maximize the total revenue they achieve over the \(T\) rounds of interaction. Our results are the following:

### Our Results and Techniques

**Limitations of Deterministic Auctions.** Our first set of results (in Section 3) characterize the convergence of learners who are using Multiplicative Weights Update (MWU) in repeated _deterministic auctions_. In particular, we show the following sharp phase transition:

* If the _learning rate_ of the winning type is at least as fast as the learning rate of the runner-up type, then the runner-up type will not converge to bidding truthfully, even as \(T\); in fact, it will be bidding strictly below its true value, in expectation.
* On the other hand, we show that in many auctions, such as SPA, if the learning rate of the runner-up type is strictly faster than that of the winning type, then the runner-up type will indeed converge to truthful bidding.

These generalize the results of Kolumbus and Nisan (2022a) who showed that in SPA, when bidders are using MWU with the same learning rate, then the low type will not converge to bidding truthfully. The main challenges to proving this set of results arise from our study of general deterministic auctions, which have less structure than second-price auctions. Indeed, small differences in the learning rates can affect the landscape qualitatively, as is manifested from our results. Moreover, while the auctions are deterministic, the learning algorithms are randomized and highly correlated. Hence our approach is to break down the interaction into several epochs and establish some qualitative properties which hold, with high probability, at the end of each epoch. This requires a careful accounting of the cumulative utility of each bid of both bidders within every epoch; in particular, if our estimation is off by even some \((1)\) term, then it will not be sufficient to establish our result.

**Strictly-IC Auctions and the Power of Randomized Mechanisms.** The results in Section 3 show that since the low valuation bidder tends to underbid, an auctioneer using SPA with reserve makes strictly less revenue than that predicted by the model with rational agents. Motivated by this, we consider a special class of randomized auctions called _strictly-IC auctions_. These are randomized truthful auctions where for each bidder, it is strictly better to bid their true valuation compared to any other bid. We show that any strictly-IC auction is asymptotically truthful: that is, the limit point of the bidder's bid converges to their true value. Furthermore, we provide a black-box transformation from any truthful auction \(A\) (deterministic or not) to a randomized auction \(A^{}\) that has the following two properties: (i) the bidders converge towards truthful bidding, and (ii) the difference between the allocation and payment rules of the original auction \(A\) and its strictly-IC counterpart \(A^{}\) are negligible for any bid profile. Hence, such an auction \(A^{}\) behaves similarly to \(A\), but, crucially, it conveysinformation to the low bidder to help it converge to truthful bidding. As a corollary of this result, we get that SPA with reserve is not revenue-maximizing in this setting, and that randomization can get strictly more revenue than SPA with reserve. This is in stark contrast with the seminal result of Myerson (1981) which shows that SPA with reserve is optimal for rational bidders.

At a more conceptual level, our results for randomized mechanisms can be viewed as showing that having enough randomness is key to the low bidder converging to truthful bidding: this randomness can come from the process itself, e.g., if bidder values are independently drawn in each round, as in Feng et al. (2021). But if not, and if the ranking of the bidders does not change much due to the lack of inherent randomness, our results show that injecting external randomness into the auction induces the desired learning behavior and hence improves the revenue. Having persistent valuations is just one case of the ranking of the bidders remaining stable over time: studying this case allows us to showcase our main ideas, but a central message of our work is that the presence or absence of stability in the rankings of the bidders is the main factor that dictates convergence to truthful bidding.

**A Non-Asymptotic Analysis.** Our next set of results in Section 5 address the non-asymptotic regime. Here we consider the _prior-free_ setting, meaning that the valuations of the bidders could be drawn from potentially different distributions that are unknown to the auctioneer. In order to evaluate its revenue performance when bidders are learning agents, we introduce the notion of _auctioneer regret_ for an auction, which measures the difference between the revenue achieved over \(T\) rounds of implementing a given auction with learning bidders and the revenue achieved by implementing the optimal auction with rational bidders (i.e., SPA with a reserve price). Proposition 5.2 shows that if the auctioneer is constrained to use the same auction rule for all \(T\) rounds, then no truthful auction -- deterministic or randomized -- can achieve an auctioneer-regret better than \((T^{3/4})\) in the setting of adversarial valuations. However, if the auctioneer can change the auction rule just once within the \(T\) rounds, with the change happening at a time independent of the bid history, then the auctioneer's regret drops to \(()\), as we show in Section 5 Moreover, we show in Proposition 5.4 that this bound of \(()\) is optimal even if the auctioneer can design the auction schedule. As a byproduct of our result, we show that the first-stage randomized auction used by the mechanism leads to the fastest convergence to truthful bidding from no-regret learning agents.

To show that an auctioneer facing learning bidders using MWU must suffer an \((T^{3/4})\) revenue loss compared to the setting when it is facing rational agents, we break down the revenue loss into two non-overlapping epochs: one where the learning bidders have not converged to truthful bidding, and the other where the bidders are truthful. Now an auctioneer using the same auction throughout the interaction faces a trade-off: they can speed up the learning process to reduce the revenue loss from the first epoch, but this loses revenue in the second epoch due to the fact that the auction now differs significantly from SPA. Our result optimizes this trade-off to show that an \((T^{3/4})\) revenue loss is unavoidable. This naturally suggests decomposing the interaction into two epochs: in the first one, the auctioneer uses a truthful auction to facilitate the convergence to truthful bidding, and in the second one it uses SPA. We then design an auction that guarantees the fastest convergence to truthful bidding for mean-based learners in the prior-free setting, and we show that an improved revenue loss of at most \(()\) can be achieved with this approach. (Importantly, to maintain truthfulness, the decisions of the auctioneers are fixed before the beginning of the interaction and are not affected by the bids.) This regret of \(()\) seems surprising, because in traditional no-regret learning settings the optimal regret is achieved when the _exploration_ and _exploitation_ phase are intermixed.

### Related Work

The most closely related works to our setting are Feng et al. (2021); Deng et al. (2022); Kolumbus and Nisan (2022); Banchio and Skrzypacz (2022); Rawat (2023). All these works study the long-term behavior of bidding algorithms that participate in repeated auctions, focusing on first-price and second-price auctions, but they give qualitatively different results. This is because they make different assumptions across two important axes: the type of learning algorithms that the bidders use and whether their valuation is _persistent_ across the interaction or it is freshly drawn in each round. Feng et al. (2021) studied the convergence of no-regret learning algorithms that bid repeatedly in second-price and first-price auctions, where all agents have i.i.d. valuation that are redrawn in every round from a discrete distribution that has non-negligible mass on each point. They show that in this setting the bidders exhibit the same-long term behavior in both second-price and first-priceauctions that classical theory predicts, i.e., the bids in second-price auctions are truthful and the bids in first-price auctions form Bayes-Nash equilibria. Kolumbus and Nisan (2022) studied the same setting with the crucial difference that agents' valuations are persistent across the execution and they are not resampled from some distribution at every iteration. Interestingly, they showed that in the case of two bidders with in second-price auctions, the agent that has the highest valuation will end up bidding between the low valuation and its valuation, whereas the agent with the low type will end up bidding strictly below its valuation. Intuitively, in their setting the high type bidder quickly learns to bid above the valuation of the low type bidder and always win the auction, and thus the low type does not get enough signal to push its bid distribution up to its valuation. On the other hand, when the valuations are redrawn as in Feng et al. (2021), the competition that the agents face varies. In the long run, this gives enough information to the algorithms to realize that bidding truthfully is the optimal strategy. In the case of first-price auctions where the agents have persistent valuations, both Kolumbus and Nisan (2022); Deng et al. (2022) provide convergence guarantees of no-regret learning algorithms. The type of "meta-games" we touch upon in our work, where we want to understand the incentives of the agents who are submitting their valuations to bidding algorithms that participate in the auctions on the behalf of these agents, were originally studied by Kolumbus and Nisan (2022) and, subsequently, for more general classes of games by Kolumbus and Nisan (2022).

The pioneering work of Hart and Mas-Colell (2000) showed that when players deploy no-regret algorithms to participate in games they converge to _coarse-correlated equilibria_. Recently, there has been a growing interest in the study of no-regret learning in repeated auctions. The empirical study of Nekipelov et al. (2015) showed that the bidding behavior of advertisers on Bing is consistent with the use of no-regret learning algorithms that bid on their behalf. Subsequently, Braverman et al. (2018) showed, among other things, that when a seller faces a no-regret buyer in repeated auctions and can use non-truthful, it can extract the whole welfare as its revenue. A very recent work (Cai et al., 2023) extended some of the previous results to the setting with multiple agents. For a detailed comparison between our work and Cai et al. (2023), we refer to Appendix B.

Banchio and Skrzypacz (2022); Rawat (2023) diverge from the previous works and consider agents that use \(Q\)-learning algorithms instead of no-regret learning algorithms. Their experimental findings show that in first-price auctions, such algorithmic bidders exhibit collusive phenomena, whereas they converge to truthful bidding in second-price auctions. One of the main reasons for these phenomena is the _asynchronous_ update used by the \(Q\)-learning algorithm. The collusive behavior of such algorithms has also been exhibited in other settings (Calvano et al., 2020; Asker et al., 2021, 2022; den Boer et al., 2022; Epivent and Lambin, 2022; Asker et al., 2022). Notably, Bertrand et al. (2023) formally proved that \(Q\)-learners do collude when deployed in repeated prisoner's dilemma games.

In a related line of work, Zhang et al. (2023) study the problem of steering no-regret learning agents to a particular equilibrium. They show that the auctioneer can use _payments_ to incentivize the algorithms to converge to a particular equilibrium that the designer wants them to. An interpretation of our results is that _randomization_ is a way to achieve some kind of equilibrium steering in repeated auctions.

Diverging slightly from the setting we consider, some recent papers have illustrated different advantages of using randomized auctions over deterministic ones. Mehta (2022); Liaw et al. (2023) showed that there are randomized auctions which induce equilibria with better welfare guarantees for value-maximizing autobidding agents compared to deterministic ones. In the setting of revenue maximization in the presence of heterogeneous rational buyers, Guruganesh et al. (2022) showed that randomization helps when designing prior-free auctions with strong revenue guarantees, when the valuations of the buyers are drawn independently from, potentially, non-identical distributions.

## 2 Model

Our model follows the setup used in Kolumbus and Nisan (2022). There are \(T\) rounds, and the auctioneer sells a single item in each round \(t=1,,T\). There are two bidders, with bidder \(i\{1,2\}\) having a persistent private valuation \(v_{i}\) drawn i.i.d. over the discrete set \(B_{}:=\{0,,,,1\}\) from a regular distribution \(F\). (A discrete distribution is _regular_ if the discrete virtual valuation function \((v):=v- v}[v^{ }]}{[v]}\) is non-decreasing.) Given an allocation probability \(x\) and price \(p\), the bidder with valuation \(v\) receives a payoff of \(v x-p\). In what follows, we refer to the bidder with valuation \(v_{L}=\{v_{1},v_{2}\}\) (resp. \(v_{H}=\{v_{1},v_{2}\}\)) as the _low type_ (resp. _high type_).

We are interested in truthful auctions, (also called strategy-proof auctions, or dominant-strategy incentive-compatible mechanisms) that are individually rational, so that at every round \(t\) the auctioneer uses a mechanism \(((x_{1}^{t},x_{2}^{t}),(p_{1}^{t},p_{2}^{t}))\) satisfying

\[v_{i} x_{i}^{t}(v_{i},b^{})-p_{i}^{t}(v_{i},b^{})  v_{i} x_{i}^{t}(b,b^{})-p_{i}^{t}(b,b^{}),  v_{i},b,b^{} B_{},\,i=1,2\,,\] \[v_{i} x_{i}^{t}(v_{i},b^{})-p_{i}^{t}(v_{i},b^{ })  0,  v_{i},b^{} B_{},\,i=1,2\,.\]

In this work, we study various properties of _randomized_ truthful auctions.

**Definition 2.1** (Randomized Truthful Auction).: _A truthful auction \(((x_{1},x_{2}),(p_{1},p_{2}))\) is randomized if there is some bid profile \((b_{1},b_{2}) B_{}\) such that either \(x_{1}(b_{1},b_{2})(0,1)\) or \(x_{2}(b_{1},b_{2})(0,1)\)._

Bidders employ _learning algorithms_ that bid over the \(T\) rounds. We assume that the learning algorithms are _mean-based no-regret_ learning algorithms (Braverman et al., 2018). For the following discussion, define \(U_{i}^{t}(b_{-i}^{t}):=_{=1}^{t}v_{i} x_{i}^{}( b,b_{-i}^{})-p_{i}^{}(b,b_{-i}^{})\) to be the cumulative reward of agent \(i\) when they bid \(b\) over the \(t\) rounds, whereas the other agent's bids are \(_{-i}^{t}=\{b_{-i}^{}\}_{[t]}\). The mean-based property states that if a bid \(b B_{}\) has performed significantly better than bid \(b^{} B_{}\), then the probability of bidding \(b^{}\) in the next round is negligible. This is formalized below.

**Definition 2.2** (Mean-Based Property (Braverman et al., 2018)).: _An algorithm for agent \(i\) is \(\)-mean-based if for any bid sequence \(_{-i}^{t}\) such that \(U_{i}^{t-1}(b_{-i}^{t})-U_{i}^{t-1}(b^{}_{- i}^{t})> T\), for some \(b,b^{} B_{}\), the probability of playing bid \(b^{}\) in the next round is at most \(\). We say that an algorithm is mean-based if it is \(\)-mean-based for some \(=o(1)\)._

The no-regret learning property states that the cumulative utility that the bidding algorithm generates is close to the cumulative utility that the optimal fixed bid would have generated, regardless of the history of bids the other bidders played. This is formalized in Definition C.1. Mean-based no-regret learning algorithms are becoming a standard class of learning algorithms to use in auction environments (see, e.g., Braverman et al. (2018); Feng et al. (2021); Deng et al. (2022); Kolumbus and Nisan (2022a), and references therein) and include many known no-regret learning algorithms, including the multiplicative-weights update algorithm (MWU). For completeness, we present the version of MWU that we use in our work in Algorithm 1. The above definitions consider a fixed value of \(T\). Thus, given a sequence of such values \(T\) and the limiting behavior as \(T\), we say that a family of algorithms, parameterized by the time horizon \(T\), satisfies the mean-based definition if there exists \(\{_{T}\}_{T}\) such that \(_{T}_{T}0\), and each algorithm in this family is \(_{T}\)-mean-based. We define the no-regret property of such a family of algorithms in a similar way. In general, the asymptotic behavior of the algorithms we study in this work is with respect to \(T\) and the big \(O\) notation suppresses quantities that do not depend on \(T\).

For the sake of exposition, we focus on the _full feedback_ setting: after every round \(t[T]\), the algorithm learns for each bid \(b B_{}\) the (expected) utility it would have generated had it played bid \(b\). In Appendix G, we discuss potential extensions.

Throughout this paper we make a natural assumption on the algorithms which restrict bidders to never bid over their value. Specifically, for any round \(t\), and any history of bids before period \(t\), agent \(i\) bids \(b_{i}>v_{i}\) with zero probability. Without this assumption, Braverman et al. (2018); Cai et al. (2023) show that the auctioneer can extract the entire welfare in the setting where the valuations of the agents are drawn i.i.d. in each round. We focus on the _last-iterate_ convergence of the distribution of the bids of the algorithms as \(T\). This is a desirable property of algorithms in multi-agent games, and recent work has focused on establishing it for learning algorithms (Cai et al., 2022b,a; Cai and Zheng, 2022). This is formalized in Definition C.2.

Due to space limitations, all the proofs of our results can be found in the appendix.

## 3 Deterministic Truthful Auctions

In this section we study the effect of the learning rate on the convergence of no-regret learning algorithms in non-degenerate _deterministic_ truthful auctions. Informally, the non-degeneracy requirement states that **i)** the winning bidder \(W\) under truthful bidding gets strictly positive utility, **ii)** there is some sufficiently small bid of the winning bidder such that the runner-up bidder \(R\) wins the item by bidding \(v_{R}\) but does not win by bidding \(v_{R}-}{{}}\). The formal definition is given in Definition D.1.

We focus our attention to bidders that use MWU to participate in the auctions and we study the bidding distribution they converge to as a function of the ratio of the learning rate of their algorithms. Throughout this section we refer to the bidder who wins the auction under truthful bidding as the winning bidder and to the bidder that loses the auction under truthtelling as the runner-up bidder. Our main result in this section shows the following behavior in non-degenerate deterministic truthful auctions:

* The winning bidder converges to bidding between its minimum winning bid and its true value, no matter what the choice of the learning rates of the algorithms are.
* If the learning rate of the runner-up bidder is strictly faster than the learning rate of the winning bidder, then the runner-up bidder converges to bidding truthfully.
* If the learning rate of the runner-up bidder is not strictly faster than that of the winning bidder, then the runner-up bidder converges to a bidding distribution whose mean is strictly smaller than its true value. This result holds under an even milder requirement than non-degeneracy. Namely, as long as the utility of the winning bidder under truthful bidding is strictly positive.

We remark that, when the learning rates of the algorithms are instantiated before the random draw of the two valuations of the agents that are i.i.d. from some distribution \(F\), then with probability at least \(1/2\) the runner-up bidder will not converge to bidding truthfully, if the underlying auction is deterministic. As we will show later, this behavior worsens the revenue guarantees of the auction.

Let us first set up some notation to facilitate our discussion. We denote by \(v_{W}\{v_{L},v_{H}\}\) and \(_{T}^{W}\) (resp., \(v_{R}\{v_{L},v_{H}\}\), and \(_{T}^{R}\)) the value and learning rate of the winning bidder (i.e., the one who wins if both bidders bid truthfully) and the runner-up bidder, respectively. We would like to remind the readers that, typically, the learning rate \(_{T}\) of MWU is a decreasing function of \(T\) and is chosen in a way to minimize the quantity \({}^{C_{}/_{T}}+C^{}_{}_{T} T\,,\) where \(C_{},C^{}_{}\) are discretization-dependent constants. Usually, it is instantiated with \(_{T}=1/\). However, for the purposes of our analysis we will say that \(_{T}\) is _non-degenerate_ if \(_{T}_{T} T=,_{T}_{T} T=0\,.\) The intuition is that if the learning rate is slower than \(1/T\), the bidder will be adjusting its bid distribution very slowly, so it will not learn to bid correctly. On the other hand, if the rate is faster than \(1/ T\) then the bidder will be adjusting its distribution too aggressively.

Our results show that in _deterministic_ auctions the convergence behavior of the bidders depends heavily on the ratio between the learning rates. In particular, for the bidder with valuation \(v_{W}\), we show that its bids converge to a distribution supported between \(\), the price it would pay if both bidders bid truthfully, and its value \(v_{W}\), no matter what the choice of the learning rate of its algorithm is. On the other hand, the convergence behavior of the runner-up bidder is more nuanced: if \(_{T}^{_{T}^{W}}/_{T}^{W}=(1),\) i.e., the runner-up bidder learns more aggressively than the winning bidder, then it converges to bidding truthfully. However, if \(_{T}^{}/_{T}^{}<C_{},\) where \(C_{}\) is some discretization-dependent constant, then the runner-up converges to a bidding distribution that puts positive mass on every (discretized) point between \(0\) and \(v_{R}\), and, in particular, its expected value is strictly less than \(v_{R}.\) We remark that even though our proof idea is inspired by Kolumbus and Nisan (2022a), our analysis considers all the possible learning rates that MWU could be instantiated with and requires a more technically involved argument. In particular, we notice that while the result of Kolumbus and Nisan (2022a) is, implicitly, proved for _identical_ learning rates, we show that the choice of the learning rate affects the qualitative behavior of the algorithms in a crucial way.

We prove this result in two parts. We start with the case where \(^{R}}}{{_{T}^{W}}}<C_{}.\) The idea of the proof is to split the horizon into consecutive periods of size \(O(1/_{T}^{R}),\) which we call _epochs_. Now following the idea of Kolumbus and Nisan (2022a), we show that within each epoch the runner-up bidder bids truthfully \((1/_{T}^{W})\) many times, so the total utility of the winning bidder for bidding between \(\) and \(v_{W}\) will be at least \((1/_{T}^{W})\) greater than bidding anything between \(0\) and \(-1/.\) Because its learning rate is \(_{T}^{W},\) this means that it will move a constant fraction of its mass from the region \(\{0,1/,,-1/\}\) to the region \(\{,,v_{W}\}.\) Summing this geometric series, we see that the winning bidder will submit bids in the region \(\{0,1/,,-1/\}\) at most \(O(1/_{T}^{W})\) many times. Let us now focus on the runner-up bidder. Following the previous argument, its total utility for bidding \(v_{R}\) will be at most \(O(1/_{T}^{W})\) greater than bidding some other bid \(b^{} B_{}.\) Since \(_{R}^{R}/_{T}^{W}<C,\) this means the probability of bidding \(b^{}\) after \(T\) rounds is only smaller than the probability of bidding \(v_{R}\) by a discretization-dependent multiplicative constant. The formal statement of this result and its proof follow are postponed to Appendix D.

Our next result illustrates that the convergence behavior of the runner-up type exhibits a sharp phase-transition phenomenon: if \(_{T}^{R}\) is even slightly faster than \(_{T}^{W}\), i.e., \(_{T}^{R}/_{T}^{W}=(1),\) then the runner-up will learn to bid truthfully. Let us first give a high-level idea of the proof. Similarly as before, we split the horizon into intervals of size \(O(1/_{T}^{W})\). We consider the first interval of this interaction. Because of the choice of the learning rate, we can show that the winning bidder will bid \(v_{R}-1/\) at least \((1/_{T}^{W})\) many times. Thus, this means that the total utility of bidding \(v_{R}\) for the runner-up bidder will be at least \((1/_{T}^{W})\) greater than bidding any other bid. Since \(_{T}^{R}/_{T}^{W}=(1)\), after the first epoch the MWU algorithm will place all but a \(o(1)\)-fraction of the probability mass to bidding truthfully. The formal statement and its proof appear in Appendix D.

Next, we discuss the implications that our results have to the revenue guarantees of the auctioneer. In the setting with rational bidders, the seminal work of Myerson (1981) showed that using second-price auctions with an anonymous reserve price, which depends on the value distribution \(F\), generates the optimal revenue for the auctioneer. Our next result shows that this is no longer true when the bidders are learning agents, even when the valuations of the agents are drawn i.i.d. from the uniform distribution on \(B_{}\), which we denote by \(U[B_{}]\). Intuitively, this happens because, no matter what the reserve price is, with some non-zero probability the valuations of both agents will be higher than the reserve price. Then, since the runner-up bids will be strictly lower than the true valuation, the generated revenue will be strictly lower than in the setting with rational agents, even when \(T\).

**Theorem 3.1** (SPA with Reserve Is Not Revenue Optimal).: _Let two agents draw their valuations from the uniform distribution over \(U[B_{}]\) and participate in \(T\) repeated auctions using mean-based learners. Let \(b_{1}^{T},b_{2}^{T}\) be the bid distributions after \(T\) rounds. Let \((b_{1},b_{2};r)\) denote the revenue of the second-price auction with reserve price \(r\) when the bids are \(b_{1},b_{2} B_{}^{2}.\) Then, for all \(r<1-1/,\)_

\[*{}_{v_{1},v_{2} U[B_{}]}[_{T }*{}_{b_{1} b_{1}^{T},b_{2} b_{2}^{T}}[ (b_{1},b_{2};r) v_{1},v_{2}]]<*{ }_{v_{1},v_{2} U[B_{}]}[(v_{1},v_{ 2};r)]-c\,,\]

_where \(c>0\) is some constant that does not depend on \(T\)._

## 4 The Value of Randomized Truthful Auctions: The Asymptotic Case

In this section we show that there is a class of randomized auctions such that when mean-based no-regret learners participate in them repeatedly, they converge to _truthful_ bidding. This holds for any choice of the learning rates of these algorithms, which is in contrast to the results of Section 3. We start by defining a class of auctions called _strictly_ IC.

**Definition 4.1** (Strictly IC Auctions).: _An auction is called strictly IC if for every bidder \(i[n]\), valuation \(v_{i} B_{}\), and bid profile \(b_{-i} B_{}^{n-1}\) it holds that \(v_{i} x_{i}(v_{i},b_{-i})-p_{i}(v_{i},b_{-i})>v_{i} x_{i}(b,b_{-i})- p_{i}(b,b_{-i}),\, v_{i}\,.\)_

The next result, which is very useful for our derivation, states that when mean-based no-regret learning algorithms bid in some strictly IC auction they converge to bidding truthfully. Recall the definition of a mean-based learner (cf. Definition 2.2) which states that if the cumulative utility of some bid \(b\) up until round \(t-1\) is much smaller than the utility of some other bid \(b^{}\), then the probability of playing \(b\) in the next round \(t\) is negligible. The proof is postponed to Appendix E.

**Lemma 4.2** (Convergence in Strictly IC Auctions).: _Consider \(n\) bidders that participate in a repeated strictly IC auction \(A\) using mean-based no-regret learning algorithms. Then, as \(T\), the bidders converge to truthful bidding in a last-iterate sense._

The next important observation is that when we are taking a non-trivial combination of an IC auction with a strictly IC auction, the resulting auction is strictly IC. The notion of mixture we consider is formalized in Definition 4.3.

**Definition 4.3** (Mixture of Auctions).: _Let \(A=(x(),p())\) be an IC auction and \(A^{}=(x^{}(),p^{}())\) be a strictly IC auction. For some \(q(0,1)\) we define the \(q\)-mixture of the auctions \(A,A^{}\) to the be auction \(_{q}=(q x()+(1-q) x^{}(),q p( )+(1-q) p^{}())\,.\)_Notice that for the allocation rule \(q x()+(1-q) x^{}()\) Myerson's lemma states that the corresponding payment rule that makes the auction truthful is indeed \(q p()+(1-q) p^{}()\). The following claim, whose proof follows from the definition of this class of auctions, formalizes the fact that the class of strictly IC auctions is closed under mixtures with IC auctions.

**Claim 1** (Mixture of IC and Strictly IC Auction).: _Let \(A,A^{}\) be an IC, strictly IC auction, respectively. Then, for any \(q(0,1)\) the auction \(q A+(1-q) A^{}\) is strictly IC._

We remark that we can construct strictly IC auctions using randomization; such an example is presented in Section 5. Equipped with the above results, we can show that there is a black-box transformation from any IC auction \(A\) to a strictly IC auction \(A^{}\) so that as \(T,\) any mean-based learning algorithms converges to truthful bidding, and the auction \(A^{}\) is close to the auction \(A\) in the sense that \(|x_{i}(b)-x^{}_{i}(b)|=o(1),|p_{i}(b)-p^{}_{i}(b)|=o(1), i [n], b B^{n}_{}.\) The formal statement of the result follows.

**Theorem 4.4**.: _Let \(A\) be an IC auction for \(n\) agents with valuations \(v_{1},,v_{n}\). Let each agent \(i[n]\) use a mean-based no-regret learning algorithm to bid in the auction. Then, there exists an auction \(A^{}\) such that for each agent \(i[n]\) we have that \(_{T}b_{i}^{T}=v_{i}\) and \(|x_{i}(b)-x^{}_{i}(b)|=o(1),|p_{i}(b)-p^{}_{i}(b)|=o(1), b  B^{n}_{},\) where \(x_{i}(),x^{}_{i}()\) (resp. \(p_{i}(),p^{}_{i}()\)) is the allocation (resp. payment) rule of \(A,A^{}\)._

**Equilibria of Meta-Game in Repeated Strictly IC Auctions** We now describe the implications that our results have for the meta-game that we alluded to in Section 1. Recall that this game is defined as follows: the agents submit their valuations to mean-based no-regret learning algorithms and then, given these fixed valuations, they bid on the behalf of the agents in a repeated truthful auction \(A\). The main question we are interested in understanding is given the specification of the auctions and the valuations of the agents, what is the optimal value they should submit to the algorithms in order to maximize their utility, after a large number of steps?

Despite the fact that \(A\) is IC and IR, Kolumbus and Nisan (2022a) showed that, rather surprisingly, when two agents use MWU to participate in repeated second price auctions there are instances where the agent with the low valuation has an incentive to report a higher value to its algorithm than its true one. This is because the valuation reported by one agent affects the bidding distribution that the other agent will converge to. To illustrate this point, assume that the low type reports \(v^{}_{L}>v_{H}\) to its bidding algorithm. Then, the bidder with type \(v_{H}\) will take the role of the low bidder in the interaction and will converge to bidding strictly below \(v_{H}.\) Now if its expected bid is also below \(v_{L}\), this will generate strictly positive utility for its opponent. Using our previous construction from Theorem 4.4 and transforming the auction \(A\) to a strictly IC auction \(A^{},\) we can show that in the new meta-game every agent can gain at most \(o(1)\) more utility in the long run by misreporting to the algorithm than reporting its true valuation. The reason why we observe a qualitatively different behavior in our construction is that every algorithm converges to bidding its reported value, no matter what the reported values of the other agents are. Due to space constraints, we refer the interested reader to Appendix E

**Revenue Maximization in the Learning Setting** In this section, we illustrate another application of Theorem 4.4 to revenue maximization in the learning setting. We are interested in auctions with strong revenue guarantees when the bids are coming from the limiting distribution of the algorithms, as \(T.\) This has the additional complication that not only do agents draw their valuations from the distribution \(F,\) but also their bids come from the limiting distribution that the algorithms converge to, as \(T.\) As we have seen already, this distribution depends on the valuation reported to the algorithm, the particular mean-based algorithm that it is using, and, potentially, the reported valuations and the algorithms of the opposing bidders.

As we explained in Section 3, second price auctions with reserves have strictly worse revenue guarantees in the setting with learning bidders compared to the setting with rational bidders. Using our transformation described in Theorem 4.4 we can restore their revenue guarantees. The following result whose formal proof is deferred to Appendix E is, essentially, a corollary of Theorem 4.4. Let us denote by \((A;b_{1},,b_{n})\) the revenue of some auction \(A\) and by \((;b_{1},,b_{n})\) the revenue of Myerson's optimal auction for \(F,\) where the bid profile is \(b_{1},,b_{n} B^{n}_{}.\)

**Corollary 4.5**.: _Consider an environment with \(n\) agents that draw their values i.i.d. from some regular distribution \(F\) and participate in repeated single-item auctions using mean-based no-regret learning algorithms. Then, there is a randomized auction \(A\) so that_

\[}_{v_{1},,v_{n} F^{n}}[_{T }}_{b_{1} b_{1}^{T},,b_{n} b_{n}^{T}}[ (A;b_{1},,b_{n})]\,\,\,v_{1},,v_{n}]\] \[}_{v_{1},,v_{n} F^{n}}[ (;_{1},,_{n}) ]-o(1).\]

Given the results from Theorem 3.1 and Corollary 4.5 we would like to remark the following.

**Remark 1** (Randomized Auctions vs. SPA with Reserve).: _Our results illustrate that randomized auctions have strictly better revenue guarantees compared to SPA with reserve price, when the bidders are using mean-based no-regretar learning algorithms. This is a property of randomized auctions that is not witnessed in the setting where the bidders are fully rational, as proven by Myerson (1981)._

## 5 Revenue Maximization in the Finite Time Horizon Setting

So far, we have focused on the asymptotic regime and we have studied the convergence of the learning bidders under various auctions. In this section, we study the _finite-horizon_ setting, where our goal is to come up with auctions that have strong _revenue_ guarantees for the auctioneer. We focus on the _prior-free_ setting, meaning that the auctioneer does not have any distributional knowledge about the valuation of the agents. Similarly to the rest of the paper, we assume that the two buyers are using mean-based no-regret learning algorithms to participate in single-item auctions for \(T\) rounds. Since we are working on the prior-free setting, it is natural to compete with the cumulative revenue of the second-price auction. The goal of the auctioneer is to choose an auction in a way that minimizes

\[}_{T}(A;v_{L},v_{H})=_{t=1}^{T} (v_{L},v_{H};)-}[ _{t=1}^{T}(b_{L}^{t},b_{H}^{t};A)]\,,\]

where the expectation is taken with respect to the randomness of the learning algorithms and, potentially, the auction. We will refer to this benchmark as the _auctioneer regret_. One quantity that will be useful for the derivation of our results is the following

\[_{A}=_{i\{1,2\},b_{i},b_{-i},v_{i} B_{}^{3} :b_{i} v_{i}}\{(v_{i} x_{i}(v_{i},b_{-i})-p_{i}(v_{i},b_{-i}))-( v_{i} x_{i}(b_{i},b_{-i})-p_{i}(b_{i},b_{-i}))\}\,,\]

i.e., the minimum increase in the utility by bidding truthfully instead of bidding non-truthfully in \(A\).

Our first goal is to understand the dependence of the auctioneer regret on the time horizon \(T\). Then, we will move on to establishing bounds with respect to the number of discretized bids \(\). Our first result shows that given any strictly IC auction \(A\) there exists an auction \(A_{T}\) that achieves auctioneer regret \(O(T}{_{A}}}).\) This is formalized below and the proof is postponed to Appendix F.

**Proposition 5.1**.: _There exists auction \(A_{T}\) which is a mixture of some strictly IC auction \(A\) and \(\) such that, for all \(v_{L},v_{H}^{2}\) and for all \(_{T}\)-mean-based learning algorithms it holds that \(}_{T}(A_{T};v_{L},v_{H})=O(}{_{A}}} T), v_{L},v_{H} B_{ }^{2}\,.\)_

We emphasize that for common mean-based no-regretar learning algorithms such as MWU it is the case that \(_{T}=(}{{}}),\) which implies that the auctioneer regret from Proposition 5.1 grows as \((T^{3/4}).\) Our next result complements this result by showing that even if the high-valuation bidder always bids truthfully and the low-valuation bidder uses MWU with learning rate \((}{{}}),\) no auction can achieve a better auctioneer regret than \(O(T^{3/4}).\)

**Proposition 5.2** (Lower Bound for Constant Auction Policies).: _Consider a repeated auction environment where the high-valuation bidder bids truthfully and the low-valuation bidder uses MWU with rate \((}{{}}).\) Then, every truthful auction \(A_{T}\) has an auctioneer regret \(}_{T}(A_{T};v_{L},v_{H}) C_{} T^{ 3/4},\) where \(C_{}>0\) is some constant that depends on the discretization parameter._

The proof is postponed to Appendix F. We note that choosing the learning rate of MWU to be \(1/\) gives the optimal no-regret guarantees. Other choices, such as \(_{T}=(1),\) have trivial regret bounds.

Having established the previous results for repeated auctions where the auctions remain _constant_ across all the iterations, it is natural to ask whether we can get improved results when the auctioneer is allowed to change the underlying auction, but in a way that is _oblivious_ to the bids that bidders have submitted so far. In other words, the auctioneer has to commit to an _auction schedule_\(\{A_{1},,A_{T}\}\)_before_ the beginning of the interaction. We extend the definition of the auctioneer regret in a natural way to allow for different auctions in every timestep and we denote \(}_{T}(A_{1},,A_{T};v_{L},v_{H})=_{t=1}^{T} (v_{L},v_{H};)-[_{t=1}^{T}(b_{L }^{t},b_{H}^{t};A_{t})]\,.\) Our next result shows that there exists an auction schedule where the auctioneer changes the underlying auction only _once_ throughout the interaction so that its regret is bounded by \((_{T} T).\) For typical choices of \(_{T}\) this translates to an auctioneer regret bounded by \(().\) The main insight is that the auctioneer can split the interaction into two intervals: the first interval has size \(T_{0},\) for some appropriately chosen \(T_{0}[T],\) where the auctioneer uses some strictly IC auction \(A\) that encourages the learners to converge to bidding truthfully. Then, assuming that \(T_{0}\) is large enough to guarantee this convergence, the auctioneer switches to using second-price auction. This is perhaps counterintuitive because in other no-regret learning settings, such as multi-armed bandits, the optimal regret bound is achieved when _exploration_ and _exploitation_ are happening simultaneously, whereas in our setting these two phases are separated.

**Theorem 5.3**.: _There exists an auction schedule \((A_{1},,A_{T})\) in which \(A_{1}=A_{2}==A_{T_{0}}=A,\) where \(A\) is any strictly IC auction, and \(A_{T_{0}+1}=A_{T_{0}+2}==A_{T}=\), that achieves \(}(A_{1},,A_{T};v_{L},v_{H}) O(_{T}  T(}+)), v_{L},v_{ H} B_{}^{2}\,.\)_

The formal proof of this result is postponed to Appendix F. The previous result shows that for \(_{T}=(}{{}})\) the auctioneer regret of the auction schedule we designed is \(().\) Thus, we see an \((T^{1/4})\) improvement compared to the previous setting where the auctioneer was restricted to be using the same auction across all iterations.

Next, we prove that even if the auctioneer uses a different auction in every step, our bound from Theorem 5.3 is (almost) optimal with respect to the time horizon \(T.\) The proof idea is that when the agents are using MWU with learning rate \(_{T},\) the signals in the first \(O(1/_{T})\) steps are insufficient for them to move their bidding distribution to truthful bids. I.e., with at least some constant probability in every round within the first \(O(1/_{T})\) rounds, they will not be bidding their true valuation. Importantly, our lower bound holds even in the (unrealistic) setting where the auctioneer can choose \(A_{1},,A_{T},\) conditioned on \(v_{L},v_{H}.\) This is formalized below; the proof is postponed to Appendix F.

**Proposition 5.4**.: _When two agents are using MWU with learning rate \(}{{}}\) to participate in repeated single-item auctions for all the auction schedules \((A_{1},,A_{T})\) it holds that \(}(A_{1},,A_{T};v_{L},v_{H})=()\,.\)_

Having established the optimal dependence with respect to the time horizon \(T,\) we now shift our attention to understanding the dependence of the auctioneer regret on the discretization parameter \(.\) First, we define an auction \(\) that satisfies \(_{}=(}{{^{2}}}).\)

**Definition 5.5** (Staircase Auction).: _We define the allocation rule of auction \(\) in the following way: with probability \(1/2\) select a bidder \(i\{1,2\}\) independently of their bids and then allocate to \(i\) with probability \(b_{i}.\) We define the payment rule in the way that makes the auction truthful._

A simple application of Myerson's lemma shows that \(_{}=(}{{^{2}}}).\) This is because between any two consecutive bids, i.e., bids whose distance is \(1/,\) the increase in the allocation is \(}{{2}}\) and the function is linear. A corollary of Theorem 5.3 shows the following bound in the auctioneer regret.

**Corollary 5.6**.: _Let the bidders use a mean-based learner with \(_{T}=(}{{T}}})\) and the auctioneer use the schedule \((A_{1},,A_{T})\) with \(A_{1}==A_{T_{0}}=,A_{T_{0}+1}=A_{T_{0}+2}==A_{T}=,\) for \(T_{0}=(}}{{^{2}}})\). Then, \(}(A_{1},,A_{T};v_{L},v_{H}) (^{2}), v_{L},v_{H} B_{}^{2}\,.\)_

## 6 Conclusion

Our work studies the behavior of learning bidders in repeated single-item auctions, with persistent valuations. We show the limitations of deterministic mechanisms, and how nuances such as learning rates can qualitatively affect participant behavior. Moreover, we show that randomized auctions can encourage faster convergence of bidders to truthful behavior. We hope our work paves the way to better understanding of learning agents' behavior in single-parameter environments, and of the power of randomization.