# Hongzhi Wen\({}^{3}\), Haoyu Han\({}^{3}\), Hanqing Lu\({}^{1}\), Zhengyang Wang\({}^{1}\), Ruirui Li\({}^{1}\), Zhen Li\({}^{1}\), Monica Cheng\({}^{1}\), Rahul Goutam\({}^{1}\), Haiyang Zhang\({}^{1}\), Karthik Subbian\({}^{1}\), Suhang Wang\({}^{4}\), Yizhou Sun\({}^{5}\), Jiliang Tang\({}^{3}\), Bing Yin\({}^{1}\)**, and **Xianfeng Tang\({}^{1}\)

Amazon-M2: A Multilingual Multi-locale Shopping Session Dataset for Recommendation and Text Generation

 Wei Jin\({}^{12}\)1, Haitao Mao\({}^{3}\)2, Zheng Li\({}^{1}\), Haoming Jiang\({}^{1}\), Chen Luo\({}^{1}\),\({}^{1}\) Amazon.com \({}^{2}\) Emory University \({}^{3}\) Michigan State University \({}^{4}\) The Pennsylvania State University \({}^{5}\) University of California, Los Angeles

{joewjin,amzzhe,jhaoming,zhengywa,ruirul,luhanqin,cheluo}@amazon.com,

{amzzhn,chengxc,rgoutam,hhaiz,ksubbian,alexbyin,xianft}@amazon.com, wei.jin@emory.edu,

szw494@psu.edu, yzsun@cs.ucla.edu, {haitaoma,wenhongz,hanhaoy1,tangjili}@msu.edu

Equal contribution.

###### Abstract

Modeling customer shopping intentions is a crucial task for e-commerce, as it directly impacts user experience and engagement. Thus, accurately understanding customer preferences is essential for providing personalized recommendations. Session-based recommendation, which utilizes customer session data to predict their next interaction, has become increasingly popular. However, existing session datasets have limitations in terms of item attributes, user diversity, and dataset scale. As a result, they cannot comprehensively capture the spectrum of user behaviors and preferences. To bridge this gap, we present the _Amazon Multilingual Multi-locale Shopping Session Dataset_, namely _Amazon-M2_. It is the first multilingual dataset consisting of millions of user sessions from six different locales, where the major languages of products are English, German, Japanese, French, Italian, and Spanish. Remarkably, the dataset can help us enhance personalization and understanding of user preferences, which can benefit various existing tasks as well as enable new tasks. To test the potential of the dataset, we introduce three tasks in this work: (1) next-product recommendation, (2) next-product recommendation with domain shifts, and (3) next-product title generation. With the above tasks, we benchmark a range of algorithms on our proposed dataset, drawing new insights for further research and practice. In addition, based on the proposed dataset and tasks, we hosted a competition in the KDD CUP 20232 and have attracted thousands of users and submissions. The winning solutions and the associated workshop can be accessed at our website https://kddcup23.github.io/.

## 1 Introduction

In the era of information explosion, recommender systems have become a prevalent tool for understanding user preferences and reducing information overload . Traditionally, the majority of recommendation algorithms focus on understanding long-term user interests through utilizing user-profiles and behavioral records. However, they tend to overlook the user's current purpose which often has a dominant impact on user's next behavior. Besides, many recommendation algorithms require access to user profiles , which can be incomplete or even missing in real-world situations especially when users are browsing in an incognito mode. In these cases, only the most recent user interactions in the current session can be utilized for understanding their preferences. Consequently, the session-based recommendation has emerged as an effective solution for modeling user's short-term interest, focusing on a user's most recent interactions within the current session to predict the next product. Over the past few years, the session-based recommendation has gained significant attention and has prompted the development of numerous models .

A critical ingredient for evaluating the efficacy of these methods is the session dataset. While numerous session datasets  have been carefully curated to meet the requirements of modeling user intent and are extensively employed for evaluating session-based recommender systems, they have several drawbacks. First, existing datasets only provide limited product attributes, resulting in incomplete product information and obscuring studies that leverage attribute information to advance the recommendation. Second, the user diversity within these datasets is limited and may not adequately represent the diversity of user-profiles and behaviors. Consequently, it can result in biased or less accurate recommendations, as the models may not capture the full range of customer preferences. Third, the dataset scale, particularly in terms of the product set, is limited, which falls short of reflecting real-world recommendation scenarios with vast product and user bases.

To break the aforementioned limitations, we introduce the _Amazon Multilingual Multi-Locale Shopping Session Dataset_, namely _Amazon-M2_, a large dataset of anonymized user sessions with their interacted products collected from multiple language sources at Amazon. Specifically, the dataset contains samples constructed from real user session data, where each sample contains a list of user-engaged products in chronological order. In addition, we provide a table of product attributes, which contains all the interacted products with their associated attributes such as title, brand, color, etc. Modeling such session data can help us better understand customers' shopping intentions, which is also the main focus of e-commerce. Particularly, the proposed dataset exhibits the following characteristics that make it unique from existing session datasets.

1. [label=()]
2. **Rich semantic attributes**: _Amazon-M2_ includes rich product attributes (categorical, textual, and numerical attributes) as product features including title, price, brand, description, etc. These attributes provide a great opportunity to accurately comprehend the user's interests. To our best knowledge, it is _the first session dataset to provide textual features_.
3. **Large scale**: _Amazon-M2_ is a large-scale dataset with millions of user sessions and products, while existing datasets only contain tens of thousands of products.
4. **Multiple locales**: _Amazon-M2_ collected data from diverse sources, i.e., six different locales including the United Kingdom, Japan, Italian, Spanish, French, and Germany. Thus, it provides a diverse range of user behaviors and preferences, which can facilitate the design of less biased and more accurate recommendation algorithms.
5. **Multiple languages**: Given the included locales, _Amazon-M2_ is special for its multilingual property. Particularly, six different languages (English, Japanese, Italian, Spanish, French, and German) are provided. It enables us to leverage recent advances such as language models  to model different languages in user sessions.

By utilizing this dataset, we can perform diverse downstream tasks for evaluating relevant algorithms in recommendation and text generation. Here, we focus on three different tasks, consisting of (1) next-product recommendation, (2) next-product recommendation with domain shifts, and (3) next-product title generation. **The first task** is the classic session-based recommendation which requires models to predict the ID of the next product, where the training dataset and test dataset are from the same domain. **The second task** is similar to the first task but requires the models to pre-train on the large dataset from large locales and transfer the knowledge to make predictions on downstream datasets from different domains (i.e., underrepresented locales). **The third task** is a novel task proposed by us, which asks models to predict the title of the next product which has never been shown in the training set. Based on these tasks, we benchmark representative baselines along with simple heuristic methods. Our empirical observations suggest that the representative baselines fail to outperform simple heuristic methods in certain evaluation metrics in these new settings. Therefore, we believe that _Amazon-M2_ can inspire novel solutions for session-based recommendation and enable new opportunities for tasks that revolve around large language models and recommender systems.

## 2 Dataset & Task Description

### Dataset Description

Before we elaborate on the details of the proposed _Amazon-M2_ dataset, we first introduce session-based recommendation. Given a user session, session-based recommendation aims to provide a recommendation on the product that the user might interact with at the next time step. As shown in Figure 0(a), each session is represented as a chronological list of products that the user has interacted with. Specifically, we use \(S=\{s_{1},s_{2},,s_{n}\}\) to denote the session dataset containing \(n\) sessions, where each session is represented by \(s=\{e_{1},e_{2},,e_{t}\}\) with \(e_{t}\) indicating the product interacted by the user at time step \(t\). In addition, let \(V=\{v_{1},v_{2},,v_{m}\}\) denote a dictionary of unique products that appeared in the sessions, and each product is associated with some attributes.

Designed for session-based recommendation, _Amazon-M2_ is a large-scale dataset composed of customer shopping sessions with interacted products. Specifically, the dataset consists of two components: (1) user sessions where each session is a list of product IDs interacted by the current user (Figure 0(a)), and (2) a table of products with each row representing the attributes of one product (Figure 0(b)). Particularly, the user sessions come from six different locales, i.e., the United Kingdom (UK), Japan (JP), German (DE), Spain (ES), Italian (IT), and France (FR). Given its multi-locale nature, the dataset is also multilingual: the textual attributes (e.g., title and description) of the products in the user sessions are in multiple languages, namely, English, Italian, French, Germany, and Spanish. Based on this dataset, we construct the training/test dataset for each task. A summary of our session dataset is given in Table 2. It includes the number of sessions, the number of interactions, the number of products, and the average session length for six different locales. We can find that UK, DE, and JP have approximately 10 times the number of sessions/products compared to ES, FR, and IT. More details about the collection process of the dataset can be found in Appendix B.

**Comparison with Existing Datasets.** We summarize the differences between existing session datasets (especially from session-based recommendation) and _Amazon-M2_ in Table 1. First of all, _Amazon-M2_ is the first dataset to provide textural information while other datasets majorly focus on the product ID information or categorical attributes. Without comprehensive product attributes, the recommendation models may struggle to capture the nuanced preferences of customers. Second, existing datasets only provide sessions from a single locale (or country) which limits their user diversity. Consequently, it may lead to biased or less accurate recommendations, as the models may not capture the full range of customer preferences. By contrast, our proposed _Amazon-M2_ is collected from multiple locales and is multilingual in nature. Third, our proposed _Amazon-M2_ provides a large number of user sessions and is on a much larger product scale, which can better reflect real-world recommendation scenarios with huge product bases.

### Task Description

The primary goal of this dataset is to inspire new recommendation strategies and simultaneously identify interesting products that can be used to improve the customer shopping experience. We introduce the following three different tasks using our shopping session dataset.

1. **Task 1. Next-product recommendation**. This task focuses on traditional session-based recommendation task, aiming to identify the next product of interest within a user session. Given a user session, the goal of this task is to predict the next product that the user will interact with. Note that the training/test data are from the same distribution of large locales (JP, UK, and DE).

    & \#Train Sessions & \#Test Sessions & \#Products & Textual feat. & Multilingual & Multi-locale & Diverse products \\  Yoochoose  & 1,956,539 & 15,324 & 30,660 & ✗ & ✗ & ✗ & ✓ \\ Tmall  & 195,547 & 4,742 & 40,728 & ✗ & ✗ & ✗ & ✓ \\ Diginetica  & 186,670 & 15,963 & 43,097 & ✗ & ✗ & ✓ & ✓ \\ Dressipi  & 1,000,000 & 100,000 & 23,496 & ✗ & ✗ & ✓ & ✗ \\  _Amazon-M2_ & 3,606,249 & 361,659 & 1,410,675 & ✓ & ✓ & ✓ & ✓ \\   

Table 1: Comparison among popular session datasets. Note that “Diverse products” indicates whether the products are from diverse categories or only specific categories (e.g., fashion clothes).

2. **Task 2. Next-product recommendation with domain shifts**. This task is similar to Task 1 but advocates a novel setting of transfer-learning: practitioners are required to perform pretraining on a large pretraining dataset (user sessions from JP, UK, and DE) and then finetune and make predictions on the downstream datasets of underrepresented locales (user sessions from ES, IT, and FR). Thus, there is a domain shift between the pretraining dataset and the downstream dataset, which requires the model to transfer knowledge from large locales to facilitate the recommendation for underrepresented locales. This can address the challenge of data scarcity in these languages and improve the accuracy and relevance of the recommendations. More discussions on distribution shift can be found in Section 3.
3. **Task 3. Next-product title generation**. This is a brand-new task designed for session datasets with textual attributes, and it aims to predict the title of the next product that the user will interact with within the current session. Notably, the task is challenging as the products in the test set do not appear in the training set. The generated titles can be used to improve cold-start recommendation and search functionality within the e-commerce platform. By accurately predicting the title of the next product, users can more easily find and discover items of interest, leading to improved user satisfaction and engagement.

The tasks described above span across the fields of recommender systems, transfer learning, and natural language processing. By providing a challenging dataset, this work can facilitate the development of these relevant areas and enable the evaluation of machine learning models in realistic scenarios.

## 3 Dataset Analysis

In this section, we offer a comprehensive analysis of the _Amazon-M2_ dataset to uncover valuable insights. Our analysis covers several essential perspectives: long-tail phenomenon, product overlap between locales, session lengths, repeat pattern, and collaborative filtering pattern. Corresponding codes can be found here.

**Long-tail phenomenon**[26; 27] is a significant challenge in the session recommendation domain. It refers to the situation where only a handful of products enjoy high popularity, while the majority of products receive only a limited number of interactions. To investigate the presence of the long-tail phenomenon in _Amazon-M2_ dataset, we analyze the distribution of product frequencies, as depicted

Figure 1: An illustration of the proposed _Amazon-M2_ dataset. (a) A user session contains a list of previous products that the user has interacted with and the next product that the user is going to interact with. The user sessions come from multiple locales such as UK, ES, JP, etc. It is import to note that one product can appear in multiple locales. (b) The product attributes are publicly available and can be accessed on Amazon.com. Users can find information about a specific product by its ASIN number.

in Figure 1(a). The results clearly demonstrate the existence of a long-tail distribution, where the head of the distribution represents popular items and the tail consists of less popular ones. Furthermore, we observe that the long-tail phenomenon is also evident within each individual locale. For detailed experimental results regarding this phenomenon in each locale, please refer to Appendix B.2. The long-tail distribution makes it difficult to effectively recommend less popular products, as a small number of popular items dominate the recommendations.

**Product overlap ratio between locales** is the proportion of the same products shared by different locales. A large number of overlapping products indicates a better transferability potential when transferring the knowledge from one locale to the other. For example, cross-domain recommendation algorithms like  can then be successfully applied, which directly transfers the learned embedding of the overlapping products from popular locales to the underrepresented locales. We then examine product overlap between locales in _Amazon-M2_ with the product overlap ratio. It is calculated as \(_{a}_{b}|}{|N_{a}|}\), where \(_{a}\) and \(_{b}\) correspond to the products set of locale \(a\) and \(b\), respectively. In Figure 1(b) we use a heatmap to show the overlap ratio, where \(x\) and \(y\) axes stand for locale \(a\) and \(b\), respectively. From the figure, we make several observations: (1) For the products in the three large locales, i.e., UK, DE, and JP, there are not many overlapping products, except the one between UK and DE locales;

    & &  &  \\  Language & \#Products & \#Sessions & \#Interactions & Avg. Length & \#Sessions & \#Interactions & Avg. Length \\  UK & 500,180 & 1,182,181 & 4,872,506 & 4.1 & 115,936 & 466,265 & 4.0 \\ DE & 518,327 & 1,111,416 & 4,836,983 & 4.4 & 104,568 & 450,090 & 4.3 \\ JP & 395,009 & 979,119 & 4,388,790 & 4.5 & 94,647 & 434,777 & 4.5 \\ ES & 42,503 & 89,047 & 326,256 & 3.7 & 8,176 & 31,133 & 3.8 \\ FR & 44,577 & 117,561 & 416,797 & 3.5 & 12,520 & 48,143 & 3.9 \\ IT & 50,461 & 126,925 & 464,851 & 3.7 & 13,992 & 53,414 & 3.8 \\  Total & 1,410,675 & 3,606,249 & 15,306,183 & 4.2 & 361,659 & 1,483,822 & 4.2 \\   

Table 2: Statistics of the multilingual shopping session dataset for training and test: the number of sessions, the number of products, the number of interactions, and the average session length.

Figure 2: Data analysis on _Amazon-M2_. (a)(c)(e) illustrate the long-tail phenomenon of product frequency, session length distribution, and the number of repeat products in a single session. (b) shows product overlap ratio between locales. (d) illustrates the proportion of sessions with repeat patterns in different locales. (f) shows most sessions can find relevant products of high SKNN scores.

(2) Considering the product overlap ratio between large locales and underrepresented locales, i.e., ES, FR, and IT, we can see a large product overlapping, indicating products in the underrepresented domain also appear in the large locales. Particularly, the overlap ratio between small locales and DE can reach around 0.4. Thus, it has the potential to facilitate knowledge transfer from large locales and areas to underrepresented regions.

Notably, despite the existence of overlapping products between different locales, there still remains a large proportion of distinguished products in each locale, indicating the difficulty of transferability with distribution shift. Moreover, the multilingual property, where the product textual description from different locales is in different languages, also induces to distribution shift issue. Such a multilingual issue is a long-established topic in the NLP domain. For instance, [29; 30; 31] point out morphology disparity, tokenization differences, and negative transfer in the multilingual scenario, leading to distribution shift.

**Session length** is an important factor in the session recommendation domain. Typically, a longer session length may lead to the interest shift challenge problem  with difficulties in capturing multiple user interests in one single session. Most existing algorithms [13; 16] show a better performance on the shorter sessions while failing down on the longer ones. As shown in Figure 1(c). We can observe that the session length also exhibits a long-tail distribution: most sessions are short while only few sessions are with a length larger than 100.

**Repeat pattern**[32; 33; 34; 35] is also an important user pattern, which refers to the phenomenon that a user repeatedly engages the same products multiple times in a single session. The presence of repeat patterns in recommender systems can potentially result in the system offering more familiar products that match users' existing preferences, which may lead to a less diverse and potentially less satisfying user experience. On the other hand, the repeat pattern is also an important property utilized in the graph-based session recommendation algorithms [13; 17; 36; 37]. Typically, those graph-based algorithms construct a session graph where each node represents a product and each edge indicates two products interacted by the user consecutively. Complicated session graphs with different structure patterns can be built when sessions exhibit evident repeat patterns. In Figure 1(d), we report the proportion of sessions with repeat patterns for the six locales and we can observe that there are around 35% sessions with repeat patterns across different locales. Furthermore, we examine the number of repeat products in those sessions with repeat patterns and report results on the distribution of repeated products in Figure 1(e). We make two observations: (1) the number of repeated products varies on different sessions; and (2) the number of repeated products in a session also follows the long-tail distribution where most sessions only appear with a few repeated products.

**Collaborative filtering pattern.** Collaborative filtering is a widely used technique that generates recommended products based on the behavior of other similar users. It is generally utilized as an important data argumentation technique to alleviate the data sparsity issue, especially for short sessions [38; 39]. Since _Amazon-M2_ encompasses a much larger product set than existing datasets, we investigate whether collaborative filtering techniques can potentially operate in this challenging data environment. Specifically, we utilize the session collaborative filtering algorithm, Session-KNN (SKNN) , to identify sessions that are similar to the target user's current session. The similarity score of SKNN can be calculated in the following steps. First, for a particular session \(s\), we first determines a set of its most similar sessions \((s) S\) with the cosine similarity \((s,s_{j})=|s s_{j}|/|}\). Second, the score of a candidate product \(e\) in similar sessions \((s)\) is then calculated by: \((e,s)=_{n(s)}(s,n)I_{n}(e)\), where the indicator function \(I_{n}(e)\) is \(1\) if \(n\) contains item \(e\). Third, for each session \(s\), we choose the 10th highest \((e,s)\) to indicate the retrieval quality of candidate products. In Figure 1(f), we show the distribution of the 10th highest SKNN scores for all sessions. A notable observation is that the majority of sessions exhibit a high SKNN score, hovering around 1. This finding suggests that for most sessions, it is possible to retrieve at least 10 similar products to augment the session data.

## 4 Benchmark on the Proposed Three Tasks

### Task 1. Next-product Recommendation

In this task, we evaluate the following popular baseline models (deep learning models) in session-based recommendation on our proposed _Amazon-M2_, with the help of Recobole package :* GRU4REC++  is an improved model based on GRU4Rec which adopts two techniques to improve the performance of GRU4Rec, including a data augmentation process and a method to account for shifts in the 1input data distribution
* NARM  employs RNNs with attention mechanism to capture the user's main purpose and sequential behavior.
* STAMP  captures user's current interest and general interests based on the last-click product and whole session, respectively.
* SRGNN  is the first to employ GNN layer to capture user interest in the current session.
* CORE  ensures that sessions and items are in the same representation space via encoding the session embedding as a linear combination of item embeddings.
* MGS  incorporates product attribute information to construct a mirror graph, aiming to learn better preference understanding via combining session graph and mirror graph. Notably, MGS can only adapt categorical attributes. Therefore, we discretize the price attribute as the input feature.

In addition, we include a simple yet effective method, Popularity, by simply recommending all users the most popular products. We utilize Mean Reciprocal Rank@K (MRR@100) and Recall@100 to evaluate various recommendation algorithms. More results on NDCG@100 metric can be found in Appendix C. Corresponding codes can be found here.

**Results & Observations.** The experiment results across different locales can be found in Table 3. We can observe that the popularity heuristic generally outperforms all the deep models with respect to both MRR and Recall. The only exception is that CORE achieves better performance on Recall. On one hand, the success of the popularity heuristic indicates that the product popularity is a strong bias for this dataset. On the other hand, it indicates that the large product set in _Amazon-M2_ poses great challenges in developing effective recommendation algorithms. Thus, more advanced recommendation strategies are needed for handling the challenging _Amazon-M2_ dataset.

    &  &  \\   & Methods & ES & FR & IT & Overall & ES & FR & IT & Overall \\  Heuristic & Popularity & 0.2854 & 0.2940 & 0.2706 & 0.2829 & 0.5118 & 0.5166 & 0.4914 & 0.5058 \\   & GRU4Rec++ & 0.2538 & 0.2734 & 0.2420 & 0.2564 & 0.5817 & 0.5995 & 0.5753 & 0.5856 \\  & NARM & 0.2598 & 0.2805 & 0.2493 & 0.2632 & 0.5894 & 0.6061 & 0.5803 & 0.5920 \\  & STAMP & 0.2555 & 0.2752 & 0.2430 & 0.2578 & 0.5162 & 0.5365 & 0.5116 & 0.5217 \\  & SRGNN & 0.2627 & 0.2797 & 0.2500 & 0.2640 & 0.5426 & 0.5543 & 0.5322 & 0.5429 \\  & CORE & 0.1978 & 0.2204 & 0.1941 & 0.2045 & 0.6931 & 0.7215 & 0.6937 & 0.7034 \\  & MGS & 0.2491 & 0.2775 & 0.2411 & 0.2560 & 0.5829 & 0.5811 & 0.5689 & 0.5766 \\    & STAMP & 0.2701 & 0.2878 & 0.2584 & 0.2719 & 0.4792 & 0.4988 & 0.4637 & 0.4803 \\   & SRGNN & 0.2747 & 0.2980 & 0.2612 & 0.2779 & 0.5835 & 0.6101 & 0.5714 & 0.5883 \\   & CORE & 0.1685 & 0.1839 & 0.1632 & 0.1720 & 0.6946 & 0.7156 & 0.6851 & 0.6985 \\   & MGS & 0.2612 & 0.2870 & 0.2693 & 0.2722 & 0.5747 & 0.6133 & 0.5812 & 0.5913 \\   

Table 4: Experimental results on Task 2, next-product recommendation with domain shifts.

    &  &  \\   & UK & DE & JP & Overall & UK & DE & JP & Overall \\  Popularity & 0.2302 & 0.2259 & 0.2766 & 0.2426 & 0.4047 & 0.4065 & 0.4683 & 0.4243 \\  GRU4Rec++ & 0.1656 & 0.1578 & 0.2080 & 0.1757 & 0.3665 & 0.3627 & 0.4185 & 0.3808 \\ NARM & 0.1801 & 0.1716 & 0.2255 & 0.1908 & 0.4021 & 0.4016 & 0.4559 & 0.4180 \\ STAMP & 0.2050 & 0.1955 & 0.2521 & 0.2159 & 0.3370 & 0.3320 & 0.3900 & 0.3512 \\ SRGNN & 0.1841 & 0.1767 & 0.2282 & 0.1948 & 0.3882 & 0.3862 & 0.4403 & 0.4032 \\ CORE & 0.1510 & 0.1510 & 0.1846 & 0.1609 & 0.5591 & 0.5525 & 0.5898 & 0.5591 \\ MGS & 0.1668 & 0.1739 & 0.2376 & 0.1907 & 0.5641 & 0.5479 & 0.4677 & 0.5194 \\   

Table 3: Experimental results on Task 1, next product prediction.

### Task 2. Next-product Recommendation with Domain Shifts

The purpose of Task 2 is to provide next-product recommendations for underrepresented locales, specifically ES, IT, and FR. To evaluate the baseline methods, we consider two training paradigms. (1) Supervised training, which involves directly training models on the training data on ES, IT, and FR and then testing them on their test data. The goal of this paradigm is to evaluate the models' efficacy when no other data is available. (2) Pretraining & finetuning, which begins with pretraining the model using data from large locales, i.e., JP, UK, and DE, and then finetuning this pretrained model on the training data from ES, IT, and FR. This approach tests the models' ability to transfer knowledge from one source to another. In both paradigms, we incorporate the same baseline models used in Task 1, which include GRU4REC++ NARM, STAMP, SRGNN, and CORE. Additionally, we compare these methods with the popularity heuristic.

**Results & Observations.** The results across different locales can be found in Table 4. From the results, we have the following observations: (1) In the context of supervised training, the popularity heuristic outperforms all baselines in terms of MRR on underrepresented locales, which is consistent with observations from Task 1. Interestingly, despite this, most deep learning models surpass the popularity heuristic when considering Recall. This suggests a promising potential for deep learning models: they are more likely to provide the correct recommendations among the retrieved candidate set while the rankings are not high. (2) Finetuning most methods tends to enhance the performance in terms of both MRR and Recall compared to supervised training alone. This demonstrates that the knowledge of large locales can be transferred to underrepresented locales despite the existence of domain shifts. Importantly, it highlights the potential of adopting pretraining to enhance the performance on locales with limited data in the _Amazon-M2_ dataset.

**Ablation Study.** Notably, the aforementioned methods utilized random initialization as the product embeddings. To enhance the model's ability to transfer knowledge across different locales, we can initialize product embeddings with embeddings from textual attributes. Specifically, we introduce SRGNNF and GRU4RecF to enable SRGNN and GRU4Rec++ to leverage the textual attributes (i.e., product title), respectively. To obtain the text embedding, we opt for pre-trained Multilingual Sentence BERT  to generate additional item embeddings from the item titles. As shown in Table 5, this straightforward approach has unintended effects in our ablation study. This could be due to the fact that the pre-training data for Multilingual Sentence BERT does not align with the text of product titles. Therefore, how to effectively utilize textual features remains an open question. We look forward to more research concerning the integration of language models with session recommendation.

### Task 3. Next-product Title Generation

In this task, the goal is to generate the title of the next product of interest for the user, which is a text generation task. Therefore, we adopt the bilingual evaluation understudy (BLEU) score, a classic metric in natural language generation, as the evaluation metric. For the same reason, in this task, we explore the effectiveness of directly applying language models as a baseline recommendation model. We fine-tune a well-known multilingual pre-trained language model, mT5 , using a generative objective defined on our dataset. Specifically, the language model receives the titles of the most recent \(K\) products and is trained to predict the title of the next product. We compare the performance by varying \(K\) from 1 to 3, while also investigating the impact of parameter size. Additionally, we offer a simple yet effective baseline approach, namely Last Product Title, in which the title for the next product is predicted as that of the last product. We randomly select \(10\%\) of training data for validation, and report the BLEU scores of different methods on validation and test set in Table 6.

    &  &  \\   & ES & FR & IT & Overall & ES & FR & IT & Overall \\  SRGNN & 0.2627 & 0.2797 & 0.2500 & 0.2640 & 0.5426 & 0.5543 & 0.5322 & 0.5429 \\ SRGNNF & 0.2107 & 0.2546 & 0.2239 & 0.2303 & 0.4541 & 0.5132 & 0.4788 & 0.4976 \\ GRU4Rec++ & 0.2538 & 0.2734 & 0.2420 & 0.2564 & 0.5817 & 0.5995 & 0.5753 & 0.5856 \\ GRU4RecF & 0.2303 & 0.2651 & 0.2303 & 0.2427 & 0.4976 & 0.5631 & 0.5353 & 0.5454 \\   

Table 5: Ablation study on whether models can effectively leverage textual features.

**Results & Observations.** The results in Table 6 demonstrate that for the mT5 model, extending the session history length (\(K\)) does not contribute to a performance boost. Furthermore, the simple heuristic, Last Product Title, surpasses the performance of the finetuned language model. This observation highlights two issues: (1) The last product bears significant importance, as the user's next interest is often highly correlated with the most recent product. This correlation becomes particularly evident when the product title serves as the prediction target. For instance, the next product title can have a large overlap with the previous product (e.g., same product type or brand). (2) The mT5 model did not function as effectively as expected, potentially due to a mismatch between the pre-training and downstream texts. Thus, even an escalation in the model's size (from mT5-small to mT5-base) did not result in a performance gain. This suggests the necessity for a domain-specific language model to leverage text information effectively. Moreover, we illustrate some examples of generated results compared with the ground truth title in Figure 3 to intuitively indicate the quality of the generated examples. We note that the generated titles look generally good, nonetheless, the generated ones still lack details, especially numbers,e.g., (180x200cm) in example 2. In addition, we anticipate that larger language models such as GPT-3/GPT-4 [45; 46] could achieve superior performance in this task, given their exposure to a more diverse corpus during pre-training. We reserve these explorations for future work.

## 5 Discussion

In this section, we discuss the new opportunities that the proposed _Amazon-M2_ dataset can introduce to various research topics in academic study and industrial applications. Due to the space limit, we only list five topics in this section while leaving others in Appendix B.4.

**Pre-Training & Transfer Learning.** Our dataset comprises session data from six locales with different languages, three of which have more data than the remaining three. This property presents a unique opportunity to investigate pre-training and transfer learning techniques for recommendation algorithms [14; 47; 48], as demonstrated in Task 2. Due to the inherent sparsity of session data , building accurate models that can capture users' preferences and interests based on their limited interactions can be challenging, particularly when the number of sessions is small. One solution to address the data sparsity problem is to transfer knowledge from other domains. Our dataset is advantageous in this regard because it provides data from sources (locales/languages), which enables the transfer of user interactions from other locales, potentially alleviating the data sparsity issue.

**Large Language Models in Recommendation.** The rich textual features in _Amazon-M2_ give researchers a chance for leveraging large language models (LLMs) [50; 46; 45; 51] in providing recommendations. For example, there has been a growing emphasis on evaluating the capability of ChatGPT  in the context of recommender systems [52; 53; 54; 55; 56; 57; 58; 59; 60]. The proposed _Amazon-M2_ presents an excellent opportunity for researchers to explore and experiment with their ideas involving LLMs and recommendation.

    & Validation & Test \\  mT5-small, \(K=1\) & 0.2499 & 0.2265 \\ mT5-small, \(K=2\) & 0.2401 & 0.2176 \\ mT5-small, \(K=3\) & 0.2366 & 0.2142 \\ mT5-base, \(K=1\) & 0.2477 & 0.2251 \\ Last Product Title & 0.2500 & 0.2677 \\   

Table 6: BLEU scores in Task 3.

Figure 3: Comparison between ground truth title and product titles generated by mT5-small, K=1.

**Text-to-Text Generation.** Our dataset presents ample opportunities for exploring natural language processing tasks, including text-to-text generation. In Task 3, we introduced a novel task that involves predicting the title of the next product, which requires the recommender system to generate textual results, rather than simply predicting a single product ID. This new task resembles to _Question Answering_ and allows us to leverage advanced text-to-text generation techniques , such as the popular GPT models [62; 51], which have demonstrated significant success in this area.

**Cross-Lingual Entity Alignment.** Entity alignment is a task that aims to find equivalent entities across different sources [63; 64; 65]. Our dataset provides a good resource for evaluating various entity alignment algorithms, as it contains entities (products) from different locales and languages. Specifically, the dataset can be used to test the performance of entity alignment algorithms in cross-lingual settings, where the entities to be aligned are expressed in different languages.

**Graph Neural Networks.** As powerful learning tools for graph data, graph neural networks (GNNs) [66; 67; 68] have tremendously facilitated a wide range of graph-related applications including recommendation [13; 4], computation biology [69; 70], and drug discovery . Our dataset provides rich user-item interaction data which can be naturally represented as graph-structured data. Thus, it is a good tool for evaluating various GNNs and rethinking their development in the scenarios of recommendation and transfer learning. In addition, the abundant textual and structural data in _Amazon-M2_ provides a valuable testing platform for the recent surge of evaluating LLMs for graph-related tasks [72; 73; 74; 75; 76].

**Item Cold-Start Problem.** The item cold-start problem [77; 38] is a well-known challenge in recommender systems, arising when a new item is introduced into the system, and there is insufficient data available to provide accurate recommendations. However, our dataset provides rich items attributes including detailed textual descriptions, which offers the potential to obtain excellent semantic embeddings for newly added items, even in the absence of user interactions. This allows for the development of a more effective recommender system that places greater emphasis on the semantic information of the items, rather than solely relying on the user's past interactions. Therefore, by leveraging this dataset, we can overcome the cold-start problem and deliver better diverse recommendations, enhancing the user experience.

**Data Imputation.** Research on deep learning requires large amounts of complete data, but obtaining such data is almost impossible in the real world due to various reasons such as damages to devices, data collection failures, and lost records. Data imputation  is a technique used to fill in missing values in the data, which is crucial for data analysis and model development. Our dataset provides ample opportunities for data imputation, as it contains entities with various attributes. By exploring different imputation methods and evaluating their performance on our dataset, we can identify the most effective approach for our specific needs.

## 6 Conclusion

This paper presents the _Amazon-M2_ dataset, which aims to facilitate the development of recommendation strategies that can capture language and location differences. _Amazon-M2_ provides rich semantic attributes including textual features, encompasses a large number of sessions and products, and covers multiple locales and languages. These qualities grant machine learning researchers and practitioners considerable flexibility to explore the data comprehensively and evaluate their models thoroughly. In this paper, we introduce the details of the dataset and provide a systematic analysis of its properties. Furthermore, through empirical studies, we highlight the limitations of existing session-based recommendation algorithms and emphasize the immense potential for developing new algorithms with _Amazon-M2_. We firmly believe that this novel dataset provides unique contributions to the pertinent fields of recommender systems, transfer learning, and large language models. The detailed discussion on broader impact and limitation can be found in Appendix D.

## 7 Acknowledgement

We want to thank AWS and amazon science for their support. We also appreciate the help from Yupeng Hou, in adding our dataset into RecBole.