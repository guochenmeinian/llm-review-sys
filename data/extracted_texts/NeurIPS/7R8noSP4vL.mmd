# Tempo Adaptation in Non-stationary Reinforcement Learning

Hyunin Lee\({}^{1,*}\)   Yuhao Ding\({}^{1}\)   Jongmin Lee\({}^{1}\)   Ming Jin\({}^{2,*}\)

Javad Lavaei\({}^{1}\)   Somayeh Sojoudi\({}^{1}\)

\({}^{1}\)UC Berkeley, Berkeley, CA 94709

\({}^{2}\)Virginia Tech, Blacksburg, VA 24061

{hyunin,yuhao_ding,jongmin.lee,lavaei,sojoudi}@berkeley.edu

jimming@vt.edu

Corresponding authors. This work was supported by grants from ARO, ONR, AFOSR, NSF, and the UC Noyce Initiative.

###### Abstract

We first raise and tackle a "time synchronization" issue between the agent and the environment in non-stationary reinforcement learning (RL), a crucial factor hindering its real-world applications. In reality, environmental changes occur over wall-clock time (t) rather than episode progress (\(k\)), where wall-clock time signifies the actual elapsed time within the fixed duration \(t[0,T]\). In existing works, at episode \(k\), the agent rolls a trajectory and trains a policy before transitioning to episode \(k+1\). In the context of the time-desynchronized environment, however, the agent at time \(t_{k}\) allocates \( t\) for trajectory generation and training, subsequently moves to the next episode at \(t_{k+1}=t_{k}+ t\). Despite a fixed total number of episodes (\(K\)), the agent accumulates different trajectories influenced by the choice of _interaction times_ (\(t_{1},t_{2},...,t_{K}\)), significantly impacting the suboptimality gap of the policy. We propose a Proactively Synchronizing Tempo (ProST) framework that computes a suboptimal sequence \(\{t_{1},t_{2},...,t_{K}\}(=\{t\}_{1:K})\) by minimizing an upper bound on its performance measure, i.e., the dynamic regret. Our main contribution is that we show that a suboptimal \(\{t\}_{1:K}\) trades-off between the policy training time (agent tempo) and how fast the environment changes (environment tempo). Theoretically, this work develops a suboptimal \(\{t\}_{1:K}\) as a function of the degree of the environment's non-stationarity while also achieving a sublinear dynamic regret. Our experimental evaluation on various high-dimensional non-stationary environments shows that the ProST framework achieves a higher online return at suboptimal \(\{t\}_{1:K}\) than the existing methods.

## 1 Introduction

The prevailing reinforcement learning (RL) paradigm gathers past data, trains models in the present, and deploys them in the _future_. This approach has proven successful for _stationary_ Markov decision processes (MDPs), where the reward and transition functions remain constant . However, challenges arise when the environments undergo significant changes, particularly when the reward and transition functions are dependent on time or latent factors , in _non-stationary_ MDPs. Managing non-stationarity in environments is crucial for real-world RL applications. Thus, adapting to changing environments is pivotal in non-stationary RL.

This paper addresses a practical concern that has inadvertently been overlooked within traditional non-stationary RL environments, namely, the time synchronization between the agent and the environment. We raise the impracticality of utilizing _episode-varying_ environments in existing non-stationary RLresearch, as such environments do not align with the real-world scenario where changes occur regardless of the agent's behavior. In an episode-varying environment, the agent has complete control over determining the time to execute the episode \(k\), the duration of policy training between the episodes \(k\) and \(k+1\), and the transition time to the episode \(k+1\). The issue stems from the premise that the environment undergoes dynamic changes throughout the course of each episode, with the rate of non-stationarity contingent upon the behavior exhibited by the agent. However, an independent _wall-clock time_ (t) exists in a real-world environment, thereby the above three events are now recognized as wall-clock time \(_{k}\), training time \(\), and \(_{k+1}\). The selection of interaction times (\(_{k},_{k+1}\)) has a notable impact on the collected trajectories, while the interval \(_{k+1}-_{k}\) establishes an upper limit on the duration of training (\(\)). This interval profoundly influences the suboptimality gap of the policy. In the context of a time-desynchronized environment, achieving an optimal policy requires addressing a previously unexplored question: the determination of the _optimal time sequence_\(\{_{1},_{2},..,_{K}\}(=\{\}_{1:K})\) at which the agent should interact with the environment.

We elucidate the significance of the aforementioned research question through an example. Consider a robot with the goal of reaching inside a gray-shaded non-fixed target box, known as the goal reacher (Appendix A.1). Note that the reward changes as the position of the box changes over time (Figure 1-(a)). We begin by considering a scenario in which the wall-clock time and episode are synchronized, wherein the environment evolves alongside the episode. During each episode \(k\), the agent rollouts a trajectory and iteratively updates the policy \(N\) times, with the assumption that one policy update requires one second, and then the agent transitions to the subsequent episode \(k+1\). In conventional non-stationary RL environments, it is evident that a larger value of \(N\) provides an advantage in terms of a faster adaptation to achieve a near-optimal policy. However, regardless of the chosen value of \(N\), the agent will consistently encounter the same environment in the subsequent episode. Now, consider a scenario in which the wall-clock time and episode are desynchronized. In this context, given a fixed wall-clock time duration \(\), the agent is faced with the additional task of determining both the total number of interactions (denoted as the total episode \(K\)) and the specific time instances for these interactions \(\{\}_{1:K}\), where \(_{k},_{k-1}<_{k}\) for \( k[K]\). Figure 1(a) shows an agent that interacts with the environment ten times, that is, \(\{\}_{1:K}=\{1,2,...,10\}\), and spends the time interval \((_{k},_{k+1})\) to train the policy, which consumes one second (\(K=10,N=1\)). The high frequency of interaction (\(K=10\)) provides adequate data for precise future box position learning (\(=11\)), yet a single policy update (\(N=1\)) may not approximate the optimal policy. Now, if the agent interacts with the environment four times, i.e. \(\{\}_{1:K}=\{1,4,7,10\}\) (see Figure 1(b)), it becomes feasible to train the policy over a duration of three seconds (\(K=4,N=3\)). A longer period of policy training (\(N=3\)) helps the agent in obtaining a near-optimal policy. However, limited observation data (\(K=4\)) and large time intervals (\(\{11,12,13\}\)) may lead to less accurate box predictions. This example underscores the practical importance of aligning the interaction time of the agent with the environment in non-stationary RL. Determining the optimal sequence \(\{\}_{1:K}\) involves a trade-off between achieving an optimal model and an optimal policy.

Based on the previous example, our key insight is that, in non-stationary environments, the new factor **tempo** emerges. Informally, tempo refers to the pace of processes occurring in a non-stationary

Figure 1: (a) 2D goal reacher in a time-desynchronized environment for one policy update, where the agent learns an inaccurate policy on an accurate model; (b) For three policy updates, the agent learns a near-optimal policy on an inaccurate model; (c) Rewards per episode in 2D goal reacher with four model-free baselines, where ProST-T\({}^{*}\) is one of our proposed methods.

environment. We define **environment tempo** as how fast the environment changes and **agent tempo** as how frequently it updates the policy. Despite the importance of considering the tempo to find the optimal \(\{\}_{1:K}\), the existing formulations and methods for non-stationarity RL are insufficient. None of the existing works has adequately addressed this crucial aspect.

Our framework, ProST, provides a solution to finding the optimal \(\{\}_{1:K}\) by computing a minimum solution to an upper bound on its performance measure. It proactively optimizes the time sequence by leveraging the agent tempo and the environment tempo. The ProST framework is divided into two components: future policy optimizer (\(_{}\)) and time optimizer (\(_{}\)), and is characterized by three key features: 1) it is _proactive_ in nature as it forecasts the future MDP model; 2) it is _model-based_ as it optimizes the policy in the created MDP; and 3) it is a _synchronizing tempo_ framework as it finds a suboptimal training time by adjusting how many times the agent needs to update the policy (agent tempo) relative to how fast the environment changes (environment tempo). Our framework is general in the sense that it can be equipped with any common algorithm for policy update. Compared to the existing works [7; 8; 9], our approach achieves higher rewards and a more stable performance over time (see Figure 1(c) and Section 5).

We analyze the statistical and computational properties of ProST in a tabular MDP, which is named ProST-T. Our framework learns in a novel MDP, namely elapsed time-varying MDP, and quantifies its non-stationarity with a novel metric, namely time-elapsing variation budget, where both consider wall-clock time taken. We analyze the dynamic regret of ProST-T (Theorem 1) into two components: dynamic regret of \(_{}\) that learns a future MDP model (Proposition 1) and dynamic regret of \(_{}\) that computes a near-optimal policy in that model (Theorem 2, Proposition 2). We show that both regrets satisfy a sublinear rate with respect to the total number of episodes regardless of the agent tempo. More importantly, we obtain suboptimal training time by minimizing an objective that strikes a balance between the upper bounds of those two dynamic regrets, which reflect the tempos of the agent and the environment (Theorem 3). We find an interesting property that the future MDP model error of \(_{}\) serves as a common factor on both regrets and show that the upper bound on the dynamic regret of ProST-T can be improved by a joint optimization problem of learning both different weights on observed data and a model (Theorem 4, Remark 1).

Finally, we introduce ProST-G, which is an adaptable learning algorithm for high-dimensional tasks achieved through a practical approximation of ProST. Empirically, ProST-G provides solid evidence on different reward returns depending on policy training time and the significance of learning the future MDP model. ProST-G also consistently finds a near-optimal policy, outperforming four popular RL baselines that are used in non-stationary environments on three different Mujoco tasks.

**Notation**

The sets of natural, real, and non-negative real numbers are denoted by \(,\), and \(_{+}\), respectively. For a finite set \(Z\), the notation \(|Z|\) denotes its cardinality and the notation \((Z)\) denotes the probability simplex over \(Z\). For \(X\), we define \([X]\):=\(\{1,2,..,X\}\). For a variable \(X\), we denote \(\) as a _forecasted_ (or _predicted_) variable at the current time, and \(\) as the observed value in the past. Also, for any time variable \(>0\) and \(k\), we denote the time sequence \(\{_{1},_{2},..,_{k}\}\) as \(\{\}_{1:k}\), and variable \(X\) at time \(_{k}\) as \(X_{_{k}}\). We use the shorthand notation \(X_{(k)}\)(or \(X^{(k)}\)) for \(X_{_{k}}\)(or \(X^{_{k}}\)). We use the notation \(\{x\}_{a:b}\) to denote a sequence of variables \(\{x_{a},x_{a+1},...,x_{b}\}\), and \(\{x\}_{(ab)}\) to represent a sequence of variables \(\{x_{t_{a}},x_{_{a+1}},...,x_{_{b}}\}\). Given two variables \(x\) and \(y\), let \(x y\) denote \((x,y)\), and \(x y\) denote \((x,y)\). Given two complex numbers \(z_{1}\) and \(z_{2}\), we write \(z_{2}=W(z_{1})\) if \(z_{2}e^{z_{2}}=z_{1}\), where \(W\) is the Lambert function. Given a variable \(x\), the notation \(a=(b(x))\) means that \(a C b(x)\) for some constant \(C>0\) that is independent of \(x\), and the notation \(a=(b(x))\) means that \(a C b(x)\) for some constant \(C>0\) that is independent of \(x\). We have described the specific details in Appendix C.1.

## 2 Problem statement: Desynchronizing timelines

### Time-elapsing Markov Decision Process

In this paper, we study a non-stationary Markov Decision Process (MDP) for which the transition probability and the reward change over time. We begin by clarifying that the term _episode_ is agent-centric, not environment-centric. Prior solutions for episode-varying (or step-varying) MDPs operate under the assumption that the timing of MDP changes aligns with the agent commencing a new episode (or step). We introduce the new concept of **time-elapsing MDP**. It starts from the wall-clock time \(=0\) to \(=T\), where \(T\) is fixed. The time-elapsing MDP at time \([0,T]\) is defined as \(_{}=\{,,H,P_{},R_{ },\}\), where \(\) is the state space, \(\) is the action space, \(H\) is the number of steps, \(P_{}:( )\) is the transition probability \(,R_{}:\) is the reward function, and \(\) is a discounting factor. Prior to executing the first episode, the agent determines the total number of interactions with the environment (denoted as the number of total episode \(K\)) and subsequently computes the sequence of interaction times \(\{\}_{1:K}\) through an optimization problem. We denote \(_{k}\) as the wall-clock time of the environment when the agent starts the episode \(k\). Similar to the existing non-stationary RL framework, the agent's objective is to learn a policy \(^{_{k}}:()\) for all \(k\). This is achieved through engaging in a total of \(K\) episode interactions, namely \(\{_{_{1}},_{_{1}},..., _{_{K}}\}\), where the agent dedicates the time interval \((_{k},_{k+1})\) for policy training and then obtains a sequence of suboptimal policies \(\{^{_{1}},^{_{2}},...,^{_{K}}\}\) to maximize a non-stationary policy evaluation metric, _dynamic regret_.

Dealing with time-elapsing MDP instead of conventional MDP raises an important question that should be addressed: within the time duration \([0,T]\), what time sequence \(\{\}_{1:K}\) yields favorable trajectory samples to obtain an optimal policy? This question is also related to the following: what is optimal value of \(K\), i.e. the total number of episode that encompasses a satisfactory balance between the amount of observed trajectories and the accuracy of policy training? These interwind questions are concerned with an important aspect of RL, which is the computation of the optimal policy for a given \(_{k}\). In Section 4, we propose the ProST framework that computes a suboptimal \(K^{*}\) and its corresponding suboptimal time sequence \(\{^{*}\}_{1:K^{*}}\) based on the information of the environment's rate of change. In Section 3, we compute a near-optimal policy for \(\{^{*}\}_{1:K^{*}}\). Before proceeding with the above results, we introduce a new metric quantifying the environment's pace of change, referred to as time-elapsing variation budget.

### Time-elapsing variation budget

_Variation budget_[10; 11; 12] is a metric to quantify the speed with which the environment changes. Driven by our motivations, we introduce a new metric imbued with real-time considerations, named _time-elapsing variation budget_\(B()\). Unlike the existing variation budget, which quantifies the environment's non-stationarity across episodes \(\{1,2,..,K\}\), our definition accesses it across \(\{_{1},_{2},...,_{K}\}\), where the interval \(=_{k+1}-_{k}\) remains constant regardless of \(k[K-1]\). For further analysis, we define two time-elapsing variation budgets, one for transition probability and another for reward function.

**Definition 1** (Time-elapsing variation budgets).: _For a given sequence \(\{_{1},_{2},..,_{K}\}\), assume that the interval \(\) is equal to the policy training time \(_{}\). We define two time-elapsing variation budgets \(B_{p}(_{})\) and \(B_{r}(_{})\) as_

\[B_{p}(_{})_{k=1}^{K-1}_{s,a}\|P_{_{k+1}} (\,|s,a)-P_{_{k}}(\,|s,a)\|_{1},\ B_{r}(_{}) _{k=1}^{K-1}_{s,a}|R_{_{k+1}}(s,a)-R_{_{k}}(s,a)|.\]

To enhance the representation of a real-world system using the time-elapsing variation budgets, we make the following assumption.

**Assumption 1** (Drifting constants).: _There exist constants \(c>1\) and \(_{r},_{p} 0\) such that \(B_{p}(c_{}){}c^{_{p}}B_{p}(_{})\) and \(B_{r}(c_{}){}c^{_{r}}B_{r}(_{})\). We call \(_{p}\) and \(_{r}\) the drifting constants._

### Suboptimal training time

Aside from the formal MDP framework, the agent can be informed of varying time-elapsing variation budgets based on the training time \(_{}(0,T)\) even within the same time-elapsing MDP. Intuitively, a short time \(_{}\) is inadequate to obtain a near-optimal policy, yet it facilitates frequent interactions with the environment, leading to a reduction in empirical model error due to a larger volume of data. On the contrary, a long time \(_{}\) may ensure obtaining a near-optimal policy but also introduces greater uncertainty in learning the environment. This motivates us to find a **suboptimal training time**\(_{}^{*}(0,T)\) that strikes a balance between the sub-optimal gap of the policy and the empirical model error. If it exists, then \(_{}^{*}\) provides a suboptimal \(K^{*}= T/_{}^{*}\), and a suboptimal time sequence where \(_{k}^{*}=_{1}+_{}^{*}(k-1)\) for all \(k[K^{*}]\). Our ProST framework computes the parameter \(_{}^{*}\)then sets \(\{^{*}\}_{1:K^{*}}\), and finally finds a _future_ near-optimal policy for time \(^{*}_{k+1}\) at time \(^{*}_{k}\). In the next section, we first study how to approximate the one-episode-ahead suboptimal policy \(^{*,_{k+1}}\) at time \(_{k}\) when \(\{\}_{1:K}\) is given.

## 3 Future policy optimizer

For given \(_{k}\) and \(_{k+1}\), the future policy optimizer (\(_{}\)), as a module of the ProST framework (Figure 2), computes a near-optimal policy for the future time \(_{k+1}\) at time \(_{k}\) via two procedures: (i) it first forecasts the future MDP model of time \(_{k+1}\) at time \(_{k}\) utilizing the MDP forecaster function, (ii) it then utilizes an arbitrary policy optimization algorithm within the forecasted MDP model \(_{}\) to obtain a future near-optimal policy \(^{*,_{k+1}}\).

### MDP forecaster

Our ProST framework is applicable in an environment that meets the following assumption.

**Assumption 2** (Observable non-stationary set \(\)).: _Assume that the non-stationarity of \(_{_{k}}\) is fully characterized by a non-stationary parameter \(o_{_{k}}\). Assume also that the agent observes a noisy non-stationary parameter \(_{_{k}}\) at the end of episode \(k[K]\) (at time \(_{k}\))._

It is worth noting that Assumption 2 is mild, as prior research in non-stationary RL has proposed techniques to estimate \(o_{(k)}\) through latent factor identification methods , and our framework accommodates the incorporation of those works for the estimation of \(o_{(k)}\). Based on Assumption 2, we define the MDP forecaster function \(g f\) below.

**Definition 2** (MDP forecaster \(g f\)).: _Consider two function classes \(\) and \(\) such that \(:^{w}\) and \(: ()\), where \(w\). Then, for \(f_{(k)}\) and \(g_{(k)} G\), we define MDP forecaster at time \(t_{k}\) as \(g f_{(k)}:^{w} ()\)._

The function \(f_{(k)}\), acting as a non-stationarity forecaster, predicts a non-stationary parameter \(_{(k+1)}\) at time \(t_{k+1}\) based on the last \(w\) observations given by the set \(\{\}_{(k-w+1:k)}\), i.e., \(_{(k+1)}=f(\{\}_{(k-w+1,k)})\). The agent can determine the number of used historical observations, denoted as \(w\), by leveraging information from the environment (Section 4). Then, the function \(g_{(k)}\), acting as a model predictor, predicts a reward \(_{(k+1)}(s,a)\) and a transition probability \(_{(k+1)}(|s,a)\) for time \(t_{k+1}\), i.e., \((_{(k+1)},_{(k+1)})=g_{(k)}(s,a,_{k+1})\). Finally, the \(_{}\) generates the estimated future MDP \(}_{(k+1)}=,,H,_{(k+1)},_{(k+1)},\) associated with time \(t_{k+1}\).

### Finding future optimal policy

Now, consider an arbitrary RL algorithm provided by the user to obtain an optimal policy from the model \(}_{(k+1)}\). For a given time sequence \(\{\}_{1:K}\), the \(_{}\) finds a near-optimal future policy as follows: (1) observe and forecast, (2) optimize using the future MDP model.

**(1) Observe and forecast.** At time \(_{k}\), the agent executes an episode \(k\) in the environment \(_{(k)}\), completes its trajectory \(_{(k)}\), and observes the noisy non-stationary parameter \(_{(k)}\) (Assumption 2). The algorithm then updates the function \(f_{(k)}\) based on the last \(w\) observed parameters, and the

Figure 2: ProST framework

function \(g_{(k)}\) with input from all previous trajectories. Following these updates, the MDP forecaster at time \(t_{k}\) predicts \(_{(k+1)}\) and \(_{(k+1)}\), thus creating the MDP model \(}_{(k+1)}\) for time \(_{k+1}\).

**(2) Optimize using the future MDP model.** Up until time \(_{k+1}\), the agent continually updates the policy within the estimated future MDP \(}_{(k+1)}\) for a given duration \(_{}\). Specifically, the agent rollouts synthetic trajectories \(_{(k+1)}\) in \(}_{(k+1)}\), and utilizes any policy update algorithm to obtain a policy \(_{(k+1)}\). Following the duration \(_{}\), the agent stops the training by the time \(_{k+1}\) and moves to the next episode \(_{(k+1)}\) with policy \(_{(k+1)}\).

We elaborate on the above procedure in Algorithm 1 given in Appendix F.1.

## 4 Time optimizer

### Theoretical analysis

We now present our main theoretical contribution, which is regarding the time optimizer (\(_{}\)): computing a suboptimal policy training time \(_{}^{*}\) (the agent tempo). Our theoretical analysis starts with specifying the components of the \(_{}\) optimizer, which we refer to as ProST-T (note that -T stands for an instance in the tabular setting). We employ the Natural Policy Gradient (NPG) with entropy regularization  as a policy update algorithm in \(_{}\). We denote the entropy regularization coefficient as \(\), the learning rate as \(\), the policy evaluation approximation gap arising due to finite samples as \(\), and the past reference length for forecaster \(f\) as \(w\). Without loss of generality, we assume that each policy iteration takes one second. The theoretical analysis is conducted within a tabular environment, allowing us to relax Assumption 2, which means that one can estimate non-stationary parameters by counting visitation of state and action pairs at time \(_{k}\), denoted as \(n_{(k)}(s,a)\), rather than observing them. Additionally, we incorporate the exploration bonus term at time \(_{k}\) into \(_{(k+1)}\), denoted as \(_{w}^{(k)}(s,a)\), which is proportional to \(_{r=k-w+1}^{k}(n_{()}(s,a))^{-1/2}\) and aims to promote the exploration of states and actions that are visited infrequently.

We compute \(_{}^{*}\) by minimizing an upper bound on the ProST-T's dynamic regret. The dynamic regret of ProST-T is characterized by the _model prediction error_ that measures the MDP forecaster's error by defining the difference between \(}_{(k+1)}\) and \(_{(k+1)}\) through a Bellman equation.

**Definition 3** (Model prediction error).: _At time \(_{k}\), the MDP forecaster predicts a model \(}_{(k+1)}\) and then we obtain a near-optimal policy \(^{(k+1)}\) based on \(}_{(k+1)}\). For each pair \((s,a)\), we denote the state value function and the state action value function of \(^{(k+1)}\) in \(}_{(k+1)}\) at step \(h[H]\) as \(_{h}^{(k+1)}(s)\) and \(_{h}^{(k+1)}(s,a)\), respectively. We also denote the model prediction error associated with time \(_{k+1}\) calculated at time \(_{k}\) as \(_{h}^{(k+1)}(s,a)\), which is defined as_

\[_{h}^{(k+1)}(s,a)=(R_{(k+1)}+ P_{(k+1)}_{h+ 1}^{(k+1)}-_{h}^{(k+1)})(s,a).\]

We now derive an upper bound on the ProST-T dynamic regret. We expect the upper bound to be likely controlled by two factors: the error of the MDP forecaster's prediction of the future MDP model and the error of the NPG algorithm due to approximating the optimal policy within an estimated future MDP model. This insight is clearly articulated in the next theorem.

**Theorem 1** (ProST-T dynamic regret \(\)).: _Let \(_{H}^{K}=_{k=1}^{K-1}_{h=0}^{H-1}_{h}^{(k+1)}(s_{h}^{(k+1) },a_{h}^{(k+1)})\) and \(_{}^{K}_{k=1}^{K-1}\|_{}^{k+1}\|_ {}\), where \(_{H}^{K}\) is a data-dependent error. For a given \(p(0,1)\), the dynamic regret of the forecasted policies \(\{^{(k+1)}\}_{1:K-1}\) of ProST-T is upper bounded with probability at least \(1-p/2\) as follows:_

\[(\{^{(k+1)}\}_{1:K-1},K))_ {I}+_{II}\]

_where \(_{I}=_{}^{K}/(1-)-_{H}^{K}+C_{p} ,\ \ _{II}=C_{II}_{}(K-1)\), and \(C_{p},C_{II}[_{}]\) are some functions of \(p\), \(_{}\), respectively._

Specifically, the upper bound is composed of two terms: \(_{I}\) that originates from the MDP forecaster error between \(_{(k+1)}\) and \(}_{(k+1)}\), and \(_{II}\) that arises due to the suboptimality gap between \(^{*,(k+1)}\) and \(^{(k+1)}\). Theorem 1 clearly demonstrates that a prudent construction of the MDPforecaster that controls the model prediction errors and the selection of the agent tempo \(_{}\) is significant in guaranteeing sublinear rates for \(_{I}\) and \(_{II}\). To understand the role of the environment tempo in \(_{I}\), we observe that the MDP forecaster utilizes \(w\) previous observations, which inherently encapsulates the environment tempo. We expect the model prediction errors, at least in part, to be controlled by the environment tempo \(B(_{})\), so that a trade-off between two tempos can be framed as the trade-off between \(_{I}\) and \(_{II}\). Hence, it is desirable to somehow minimize the upper bound with respect to \(_{}\) to obtain a solution, denoted as \(_{}^{*}\), which strikes a balance between \(_{I}\) and \(_{II}\).

#### 4.1.1 Analysis of \(_{II}\)

A direct analysis of the upper bound \(_{I}+_{II}\) is difficult since its dependence on \(K\) is not explicit. To address this issue, we recall that an optimal \(_{}^{*}\) should be a natural number that guarantees the sublinearity of both \(_{I}\) and \(_{II}\) with respect to the total number of episodes \(K\). We first compute a set \(_{II}\) that includes those values of \(_{}\) that guarantee the sublinearity of \(_{II}\), and then compute a set \(_{I}\) that guarantees the sublinearity of \(_{I}\). Finally, we solve for \(_{}^{*}\) in the common set \(_{I}_{II}\).

**Proposition 1** (\(_{}\) bounds for sublinear \(_{II}\)).: _A total step \(H\) is given by MDP. For a number \(>0\) such that \(H=(((_{} r_{} )/))\), we choose \(,,\) to satisfy \(=(),\ =(/| |)\) and \((1-)/\), where \(_{}\) and \(r_{}\) are the maximum reward of the forecasted model and the maximum reward of the environment, respectively. Define \(_{II}\):=\(\{n n>((+2 )}{}),n\}\), where \(C_{1}\) is a constant. Then \(_{II} 4(K-1)\) for all \(_{}_{II}\)._

As a by-product of Proposition 1, the sublinearity of \(_{II}\) can be realized by choosing \(=((K-1)^{-1})\) for any \([0,1)\), which suggests that a tighter upper bound on \(_{II}\) requires a smaller \(\) and subsequently a larger \(_{}_{II}\). The hyperparameter conditions in Proposition 1 can be found in Lemma 1 and 2 in Appendix D.3.

#### 4.1.2 Analysis of \(_{I}\)

We now relate \(_{I}\) to the environment tempo \(B(_{})\) using the well-established non-stationary adaptation technique of Sliding Window regularized Least-Squares Estimator (SW-LSE) as the MDP forecaster . The tractability of the SW-LSE algorithm allows to upper-bound the model predictions errors \(_{H}^{K}\) and \(_{}^{K}\) by the environment tempo extracted from the past \(w\) observed trajectories, leading to a sublinear \(_{I}\) as demonstrated in the following theorem.

**Theorem 2** (Dynamic regret \(_{I}\) with \(f=}\)).: _For a given \(p(0,1)\), if the exploration bonus constant \(\) and regularization parameter \(\) satisfy \(=(||H)\) and \( 1\), then \(_{I}\) is bounded with probability at least \(1-p\) as follows:_

\[_{I} C_{I}[B(_{})] w+C_{k} (1+w)}+C_{p}\]

_where \(C_{I}[B(_{})]=(1/(1-)+H) B_{r}(_{})+(1+H_{ })/(1-) B_{p}(_{})\), and \(C_{k}\) is a constant on the order of \((K)\)._

For a brief sketch of how SW-LSE makes the environment tempo appear in the upper bound, we outline that the model prediction errors are upper-bounded by two forecaster errors, namely \(P_{(k+1)}\) - \(_{(k+1)}\) and \(R_{(k+1)}\) - \(_{(k+1)}\), along with the visitation count \(n_{(k)}(s,a)\). Then, the SW-LSE algorithm provides a solution \((_{(k+1)},_{(k+1)})\) as a closed form of linear combinations of past \(w\) estimated values \(\{,\}_{(k-w=1:w)}\). Finally, employing the Cauchy inequality and triangle inequality, we derive two forecasting errors that are upper-bounded by the environment tempo. For the final step before obtaining a suboptimal \(_{}^{*}\), we compute \(_{I}\) that guarantees the sublinearity of \(_{I}\).

**Proposition 2** (\(_{}\) bounds for sublinear \(_{I}\)).: _Denote \(B(1)\) as the environment tempo when \(_{}=1\), which is a summation over all time steps. Assume that the environment satisfies \(B_{r}(1)+B_{p}(1)_{}/(1-)=o(K)\) and we choose \(w=((K-1)^{2/3}/(C_{I}[B(_{})])^{2/3})\). Define the set \(_{I}\) to be \(\{n n<K,\ n\}\). Then \(_{I}\) is upper-bounded as \(_{I}=(C_{I}[B(_{})]^{1/3}(K-1)^{ 2/3}[B(_{})])})\) and also satisfies a sublinear upper bound, provided that \(_{}_{I}\)._The upper bound on the environment tempo \(B(1)\) in proposition 2 is aligned with our expectation that dedicating an excessively long time to a single iteration may not allow for an effective policy approximation, thereby hindering the achievement of a sublinear dynamic regret. Furthermore, our insight that a larger environment tempo prompts the MDP forecaster to consider a shorter past reference length, aiming to mitigate forecasting uncertainty, is consistent with the condition involving \(w\) stated in Proposition 2.

#### 4.1.3 Suboptimal tempo \(_{}^{*}\)

So far, we have shown that an upper bound on the ProST dynamic regret is composed of two terms \(_{I}\) and \(_{II}\), which are characterized by the environment tempo and the agent tempo, respectively. Now, we claim that a suboptimal tempo that minimizes ProST's dynamic regret could be obtained by the optimal solution \(_{}^{*}=_{_{}_{II}_{II }}(_{I}^{}+_{II}^{})\), where \(_{I}^{}\) and \(_{II}^{}\) denote the upper bounds on \(_{I}\) and \(_{II}\). We show that \(_{}^{*}\) strikes a balance between the environment tempo and the agent tempo since \(_{I}^{}\) is a non-decreasing function of \(_{}\) and \(_{II}^{}\) is a non-increasing function of \(_{}\). Theorem 3 shows that the optimal tempo \(_{}^{*}\) depends on the environment's drifting constants introduced in Assumption 1.

**Theorem 3** (Suboptimal tempo \(_{}^{*}\)).: _Let \(k_{}=(_{r}_{p})^{2}C_{I}[B(1)]\), \(k_{}=(1/(1-))C_{1}(K-1)(+2)\). Consider three cases: **case1**: \(_{r}_{p}=0\), **case2**: \(_{r}_{p}=1\), **case3**: \(0<_{r}_{p}<1\) or \(_{r}_{p}>1\). Then \(_{}^{*}\) depends on the environment's drifting constants as follows:_

* _Case1:_ \(_{}^{*}=T\)_._
* _Case2:_ \(_{}^{*}=_{1-}(k_{}/k_{})+1\)_._
* _Case3:_ \(_{}^{*}=(-W[-,_{p})-1}])\)_, provided that the parameters are chosen so that_ \(k_{}=(1-)k_{}\)_._

### Improving MDP forecaster

Determining a suboptimal tempo by minimizing an upper bound on \(_{I}+_{II}\) can be improved by using a tighter upper bound. In Proposition 1, we focused on the \(Q\) approximation gap \(\) to provide a justifiable upper bound on \(_{I}+_{II}\). It is important to note that the factor \(\) arises not only from the finite sample trajectories as discussed in , but also from the forecasting error between \(_{(k+1)}\) and \(}_{(k+1)}\). It is clear that the MDP forecaster establishes a lower bound on \(\) denoted as \(_{}\), which in turn sets a lower bound on \(\) and consequently on \(_{I}\). This inspection highlights that the MDP forecaster serves as a common factor that controls both \(_{I}\) and \(_{II}\), and a further investigation to improve the accuracy of the forecaster is necessary for a better bounding on \(_{I}+_{II}\).

Our approach to devising a precise MDP forecaster is that, instead of _selecting_ the past reference length \(w\) as indicated in Proposition 2, we set \(w=k\), implying the utilization of all past observations. However, we address this by solving an additional optimization problem, resulting in a tighter bound on \(_{I}\). We propose a method that adaptively assigns different weights \(q_{+}^{k}\) to the previously observed non-stationary parameters up to time \(t_{k}\), which reduces the burden of choosing \(w\). Hence, we further analyze \(_{I}\) through the utilization of the Weighted regularized Least-Squares Estimator (W-LSE) . Unlike SW-LSE, W-LSE does not necessitate a predefined selection of \(w\), but it instead engages in a joint optimization procedure involving the data weights \(q\) and the future model \((_{(k+1)},_{(k+1)})\). To this end, we define the forecasting reward model error as \(_{k}^{r}(s,a)=|(R_{(k+1)}-_{(k+1)})(s,a )|\) and the forecasting transition probability model error as \(_{k}^{p}(s,a)=\|(P_{(k+1)}-_{(k+1)})(  s,a)\|_{1}\).

**Theorem 4** (\(_{I}\) upper bound with \(f\)=W-LSE).: _By setting the exploration bonus \(_{(k)}(s,a)=_{k}^{r}(s,a)+_{}} {2(1-)}_{k}^{p}(s,a)\), it holds that_

\[_{I}(4H+|}{1-} (+H))(_{k=1}^{K-1} _{k}^{r}(s,a)+_{}}{2(1-)}_{k=1}^{K-1 }_{k}^{p}(s,a)).\]

**Remark 1** (Tighter \(_{}\) upper bound with \(f=\)).: _If the optimization problem of \(\) is feasible, then the optimal data weight \(q^{*}\) provides tighter bounds for \(_{k}^{T}\) and \(_{k}^{p}\) in comparison to \(\), consequently leading to a tighter upper bound for \(_{}\). We prove in Lemmas 4 and 6 in Appendix D.3 that \(_{}^{K}\) and \(-_{H}^{}\) are upper-bounded in terms of \(_{k}^{T}\) and \(_{k}^{p}\)._

### ProST-G

The theoretical analysis outlined above serves as a motivation to empirically investigate two key points: firstly, the existence of an optimal training time; secondly, the role of the MDP forecaster's contribution to the ProST framework's overall performance. To address these questions, we propose a practical instance, named ProST-G, which particularly extends the investigation in Section 4.2. ProST-G optimizes a policy with the soft actor-critic (SAC) algorithm , utilizes the integrated autoregressive integrated moving average (ARIMA) model for the proactive forecaster \(f\), and uses a bootstrap ensemble of dynamic models where each model is a probabilistic neural network for the model predictor \(g\). We further discuss specific details of ProST-G in Appendix F.3 and in Algorithm 3.

## 5 Experiments

We evaluate ProST-G with four baselines in three Mujoco environments each with five different non-stationary speeds and two non-stationary datasets.

**(1) Environments: Non-stationary desired posture.** We make the rewards in the three environments non-stationary by altering the agent's desired directions. The forward reward \(R_{t}^{f}\) changes as \(R_{t}^{f}=o_{t}_{t}^{f}\), where \(_{f}\) is the original reward from the Mujoco environment. The non-stationary parameter \(o_{k}\) is generated from the sine function with five different speeds and from the real data \(A\) and \(B\). We then measure the time-elapsing variation budget by \(_{k=1}^{K-1}|o_{k+1}-o_{k}|\). Further details of the environment settings can be found in Appendix D.1.1.

**(2) Benchmark methods.** Four baselines are chosen to empirically support our second question: the significance of the forecaster. **MBPO** is the state-of-the-art model-based policy optimization . **Pro-OLS** is a policy gradient algorithm that predicts the future performance and optimizes the predicted performance of the future episode . **ONPG** is an adaptive algorithm that performs a purely online optimization by fine-tuning the existing policy using only the trajectory observed online . **FTRL** is an adaptive algorithm that performs follow-the-regularized-leader optimization by maximizing the performance on all previous trajectories .

## 6 Discussions

### Performance compare

The outcomes of the experimental results are presented in Table 1. The table summarizes the average return over the last 10 episodes during the training procedure. We have illustrated the complete training results in Appendix E.3. In most cases, ProST-G outperforms MBPO in terms of rewards, highlighting the adaptability of the ProST framework to dynamic environments. Furthermore, except for data \(A\) and \(B\), ProST-G consistently outperforms the other three baselines. This supports our motivation of using the proactive model-based method for a higher adaptability in non-stationary environments compared to state-of-the-art model-free algorithms (Pro-OLS, onNPG, FTRL). We elaborate on the training details in Appendix E.2.

    &  &  &  &  \\   & & & & & & & & & & & & & & & & & \\   & 16.14 & -0.40 & -0.26 & -0.08 & -0.08 & **0.65** & -0.78 & -0.379 & -0.533 & -0.177 & -24.59 & **-0.69** & **96.38** & 95.39 & 97.18 & 92.88 & 92.77 \\  & 2 & 32.15 & 0.20 & -0.12 & 0.14 & -0.01 & **1.84** & -0.379 & 45.65 & -0.866 & -21.59 & **-20.21** & 96.78 & 97.34 & **96.92** & 96.55 & 98.13 \\  & 3 & 47.86 & -0.13 & 0.09 & 0.13 & 0.04 & **1.52** & -0.42 & **35.57** & -0.826 & -1.40 & **-21.84** & 97.70 & 97.84 & 98.06 & 90.58 & **100.42** \\  & 4 & 77.34 & -0.23 & -0.09 & 0.17 & 0.16 & **2.81** & -0.32 & 45.51 & -0.511 & -21.60 & -19.78 & 97.86 & 97.46 & 97.96 & 98.66 & **100.43** \\  & 4 & 77.34 & -0.23 & -0.09 & 0.17 & 0.16 & **2.81** & -0.32 & 45.51 & -0.511 & -21.60 & -19.78 & 97.86 & 97.46 & 97.96 & 98.66 & **100.44** \\  & 5 & 77.34 & -0.25 & -0.09 & 0.17 & 0.16 & 8.77 & -0.55 & -0.53 & -0.55 & -0.57 & 87.42 & 97.87 & 97.87 & 97.51 & 97.11 & 90.92 & 111.56 \\  & 5 & 7.34 & -1.45 & -0.12 & **3.37** & 0.16 & 8.75 & -0.55 & -0.55 & -0.55 & -0.55 & -0.57 & 88.34 & 91.72 & **19.87** & 15.21 & 101.09 & 111.56 \\  & 8 & 4.68 & **1.79** & -0.72 & -1.20 & 0.19 & 0.20 & -0.04 & 46.96 & -0.55 & -29.28 & **78.56** & **18.82** & **131.23** & 110.90 & 100.29 & 127.74 \\   

Table 1: Average reward returns

### Ablation study

An ablation study was conducted on the two aforementioned questions. The following results support our inspection of Section 4.2 and provide strong grounds for Theorem 3.

Suboptimal \(_{}^{*}\).The experiments are performed over five different policy training times \(_{}\{1,2,3,4,5\}\), aligned with SAC's number of gradient steps \(G\{38,76,114,152,190\}\), under a fixed environment speed. Different from our theoretical analysis, we set \(_{t}=1\) with \(G=38\). We generate \(o_{k}=sin(2_{}k/37)\), which satisfies Assumption 1 (see Appendix E.1). The shaded areas of Figures 3 (a), (b) and (c) are 95 % confidence area among three different noise bounds of 0.01,0.02 and 0.03 in \(o_{k}\). Figure 3(a) shows \(_{t}=4\) is close to the optimal \(G^{*}\) among five different choices.

Functions \(f,g\).We investigate the effect of the forecaster \(f\)'s accuracy on the framework using two distinct functions: ARIMA and a simple average (SA) model, each tested with three different the values of \(w\). Figure 3(b) shows the average rewards of the SA model with \(w\{3,5,7\}\) and ARIMA model (four solid lines). The shaded area is 95 % the confidence area among 4 different speeds \(\{1,2,3,4\}\). Figure 3(c) shows the corresponding model error. Also, we investigate the effect of the different model predictor \(g\) by comparing MBPO (reactive-model) and ProST-G with \(f=\)ARIMA (proactive-model) in Figure 3(c). The high returns from ProST-G with \(f=\)ARIMA, compared to those from MBPO, empirically support that the forecasting component of the **ProST** framework can provide a satisfactory adaptability to the baseline algorithm that is equipped with. Also, Figures 3(b) and 3(c) provide empirical evidence that the accuracy of \(f\) is contingent on the sliding window size, thereby impacting the model accuracy and subsequently influencing the agent's performance.

## 7 Conclusion

This work offers the first study on the important issue of time synchronization for non-stationary RL. To this end, we introduce the concept of the tempo of adaptation in a non-stationary RL, and obtain a suboptimal training time. We propose a Proactively Synchronizing Tempo (ProST) framework, together with two specific instances ProST-T and ProST-G. The proposed method adjusts an agent's tempo to match the tempo of the environment to handle non-stationarity through both theoretical analysis and empirical evidence. The ProST framework provides a new avenue to implement reinforcement learning in the real world by incorporating the concept of adaptation tempo.

As a future work, it is important to generalize the proposed framework to learn a safe guarantee policy in a non-stationary RL by considering the adaptation tempo of constraint violations . Another generalization is to introduce an alternative dynamic regret metric, enabling a fair performance comparison among agents, even when they have varying numbers of total episodes. Another future work is to find an optimal tempo of the distribution correction in offline non-stationary RL, specifically how to adjust the relabeling function to offline data in a time-varying environment that is dependent on the tempo of the environment .