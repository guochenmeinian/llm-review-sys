# Improving Environment Novelty Quantification for

Effective Unsupervised Environment Design

 Jayden Teoh, Wenjun Li12, Pradeep Varakantham

Singapore Management University

{jxteoh.2023, wjli.2020, pradeepv}@smu.edu.sg

Equal contribution.Corresponding author.

###### Abstract

Unsupervised Environment Design (UED) formalizes the problem of autocurricula through interactive training between a teacher agent and a student agent. The teacher generates new training environments with high learning potential, curating an adaptive curriculum that strengthens the student's ability to handle unseen scenarios. Existing UED methods mainly rely on _regret_, a metric that measures the difference between the agent's optimal and actual performance, to guide curriculum design. Regret-driven methods generate curricula that progressively increase environment complexity for the student but overlook environment _novelty_-a critical element for enhancing an agent's generalizability. Measuring environment novelty is especially challenging due to the underspecified nature of environment parameters in UED, and existing approaches face significant limitations. To address this, this paper introduces the _Coverage-based Evaluation of Novelty In Environment_ (CENIE) framework. CENIE proposes a scalable, domain-agnostic, and curriculum-aware approach to quantifying environment novelty by leveraging the student's state-action space coverage from previous curriculum experiences. We then propose an implementation of CENIE that models this coverage and measures environment novelty using Gaussian Mixture Models. By integrating both regret and novelty as complementary objectives for curriculum design, CENIE facilitates effective exploration across the state-action space while progressively increasing curriculum complexity. Empirical evaluations demonstrate that augmenting existing regret-based UED algorithms with CENIE achieves state-of-the-art performance across multiple benchmarks, underscoring the effectiveness of novelty-driven autocurricula for robust generalization.

## 1 Introduction

Although recent advancements in Deep Reinforcement Learning (DRL) have led to many successes, e.g., super-human performance in games [26; 9] and reliable control in robotics [2; 3], training generally-capable agents remains a significant challenge. DRL agents often fail to generalize well to environments only slightly different from those encountered during training [21; 63]. To address this problem, there has been a surge of interest in _Unsupervised Environment Design_ (UED; [56; 23; 57; 28; 27; 33; 37]), which formulates the autocurricula  generation problem as a two-player zero-sum game between a _teacher_ and a _student_ agent. In UED, the teacher constantly adapts training environments (e.g., mazes with varying obstacles and car-racing games with different track designs) in the curriculum to improve the student's ability to generalize across all possible levels.

To design effective autocurricula, researchers have proposed various metrics to capture learning potential, enabling teacher agents to create training levels that adapt to the student's capabilities.

The most popular metric, _regret_, measures the student's maximum improvement possible in a level. While regret-based UED algorithms [23; 27; 28] are effective in producing levels at the frontier of the student's capability, they do not guarantee diversity in the student's experiences, limiting the training of generally-capable agents especially in large environment design spaces. Another line of work in UED recognizes this limitation, leading to methods exploring the prioritization of novel levels during curriculum generation [56; 57; 33]. This strategic shift empowers the teacher to introduce novel levels into the curriculum such that the student agent can actively explore the environment space and enhance its generalization capabilities.

To more effectively evaluate environment novelty, we introduce the _Coverage-based Evaluation of Novelty In Environment_ (CENIE) framework. CENIE operates on the intuition that a novel environment should induce unfamiliar experiences, pushing the student agent into unexplored regions of the state space and introducing variability in its actions. Therefore, signals about an environment's novelty can be derived by modeling and comparing its state-action space coverage with those of environments already encountered in the curriculum. We refer to this method of estimating novelty based on the agent's past experiences as _curriculum-aware_. By evaluating novelty in relation to the experiences induced by other environments within the curriculum, CENIE prevents redundant environments--those that elicit similar experiences as existing ones--from being classified as novel. Curriculum-aware approaches ensure that levels in the student's curriculum collectively drive the agent toward novel experiences in a sample-efficient manner.

Our contributions are threefold. First, we introduce CENIE, a scalable, domain-agnostic, and curriculum-aware framework for quantifying environment novelty via the agent's state-action space coverage. CENIE addresses shortcomings in existing methods for environment novelty quantification, as discussed further in Sections 3 and 4. Second, we present implementations for CENIE using _Gaussian Mixture Models_ (GMM) and integrated its novelty objective with \(^{-1}\) and ACCEL, the leading UED algorithms in zero-shot transfer performance. Finally, we conduct a comprehensive evaluation of the CENIE-augmented algorithms across three distinct benchmark domains. By incorporating CENIE into these leading UED algorithms, we empirically validate that CENIE's novelty-based objective not only exposes the student agent to a broader range of scenarios in the state-action space, but also contributes to achieving state-of-the-art zero-shot generalization performance. This paper underscores the importance of novelty and the effectiveness of the CENIE framework in enhancing UED.

## 2 Background

We briefly review the background of Unsupervised Environment Design (UED) in this section. UED problems are modeled as an Underspecified Partially Observable Markov Decision Process (UPOMDP) defined by the tuple:

\[ S,A,O,,,,,\]

where \(S\), \(A\) and \(O\) are the sets of states, actions, and observations, respectively. \(\) represents a set of free parameters where each \(\) defines a specific instantiation of an environment (also known as a _level_). We use the terms "environments" and "levels" interchangeably throughout this paper. The level-conditional observation and transition functions are defined as \(:S O\) and \(:S A(S)\), respectively. The student agent, with policy \(\), receives a reward based on the reward function \(:S A\) with a discount factor \(\). The student seeks to maximize its expected value for each \(\) denoted by \(V^{}()=_{}[_{t=0}^{T}R(s_{t},a_{t})^{t}]\). The teacher's goal is to select levels forming the curriculum by maximizing a utility function \(U(,)\), which depends on \(\).

Different UED approaches vary primarily in the teacher's utility function. _Domain Randomization_ (DR; ) uniformly randomizes environment parameters, with a constant utility \(U^{}(,)=C\), making it agnostic to the student's policy. _Minimax training_ adversarially generates challenging levels, with utility \(U^{}(,)=-V^{}()\), to minimize the student's return. However, this approach incentivizes the teacher to make the levels completely unsolvable, limiting room for learning. Recent UED methods address this by using a teacher that maximizes _regret_, defined as the difference between the return of the optimal policy and the current policy. Regret-based utility is defined as \(U^{}(,)=^{}(,^{*})=V^{}( ^{*})-V^{}()\) where \(^{*}\) is the optimal policy on \(\). Regret-based objectives have been shown to promote the simplest levels that the student cannot solve optimally, and benefit from the theoretical guarantee of a minimax regret robust policy upon convergence in the two-player zero-sum game. However, since \(^{*}\) is generally unknown, regret must be approximated. Dennis et al. , the pioneer UED work, introduced a principled level generation based on the regret objective and proposed the _PAIRED_ algorithm, where regret is estimated by the difference between the returns attained by an antagonist agent and the protagonist (student) agent. Later on, Jiang et al.  introduced _PLR\({}^{}\)_ which combines DR with regret using _Positive Value Loss_ (PVL), an approximation of regret based on Generalized Advantage Estimation (GAE; ):

\[^{}()=_{t=0}^{T}(_{k=t}^{T}( )^{k-t}_{k}^{},0),\] (1)

where \(\) and \(T\) are the GAE discount factor and MDP horizon, respectively. \(_{k}^{}\) is the TD-error at time step \(k\) for \(\). The state-of-the-art UED algorithm, _ACCEL_, improves \(^{}\) by replacing its random level generation with an editor that mutates previously curated levels to gradually introduce complexity into the curriculum.

## 3 Related Work

It is important to note that regret-based UED approaches provide a minimax regret guarantee at Nash Equilibrium; however, they provide no explicit guarantee of convergence to such equilibrium. Beukman et al.  demonstrated that the minimax regret objective does not necessarily align with learnability: an agent may encounter UPOMDPs with high regret on certain levels where it already performs optimally (given the partial observability constraints), while there exist other levels with lower regret where it could still improve. Consequently, selecting levels solely based on regret can lead to _regret stagnation_, where learning halts prematurely. This suggests that focusing exclusively on minimax regret may inhibit the exploration of levels where overall regret is non-maximal, but opportunities for acquiring transferable skills for generalization are significant. Thus, there is a compelling need for a complementary objective, such as novelty, to explicitly guide level selection towards enhancing zero-shot generalization performance and mitigating regret stagnation.

The _Paired Open-Ended Trailbizer_ (POET; ) algorithm computes novelty based on environment encodings--a vector of parameters that define level configurations. POET maintains a record of the encodings from previously generated levels and computes the novelty of a new level by measuring the average distance between the k-nearest neighbors of its encoding. However, this method for computing novelty is domain-specific and relies on human expertise in designing environment encodings, posing challenges for scalability to complex domains. Moreover, due to UED's underspecified nature, where free parameters may yield a one-to-many mapping between parameters and environments instances, each inducing distinct agent behaviors, quantifying novelty based on parameters alone is futile.

_Enhanced POET_ (EPoET; ) improves upon its predecessor by introducing a domain-agnostic approach to quantify a level's novelty. EPOET is grounded in the insight that novel levels offer new insights into how the behaviors of agents within them differ. EPOET evaluates both active and archived agents' performance in each environment, converting their performance rankings into rank-normalized vectors. The level's novelty is then computed by measuring the Euclidean distance between these vectors. Despite addressing POET's domain-specific limitations, EPOET encounters its own challenges. The computation of rank-normalized vectors only works for population-based approaches as it requires evaluating multiple trained student agents and incurs substantial computational costs. Furthermore, EPOET remains curriculum-agnostic, as its novelty metric relies on the ordering of raw returns within the agent population, failing to directly assess whether the environment elicits rarely observed states and actions in the existing curriculum.

_Diversity Induced Prioritized Level Replay_ (DIPLR; ), calculates novelty using the Wasserstein distance between occupancy distributions of agent trajectories from different levels. DIPLR maintains a level buffer and determines a level's novelty as the minimum distance between the agent's trajectory on the candidate level and those in the buffer. While DIPLR incorporates the agent's experiences into its novelty calculation, it faces significant scalability and robustness issues. First, relying on the Wasserstein distance is notoriously costly. Additionally, DIPLR requires pairwise distance computations between all levels in the buffer, causing computational costs to grow exponentially with more levels. Finally, although DIPLR promotes diversity within the active buffer, it fails to evaluate whether state-action pairs in the current trajectory have already been adequately explored through past curriculum experiences, making it arguably still curriculum-agnostic. Further discussions on relevant literature can be found in Appendix B.

## 4 Approach: CENIE

The limitations of prior approaches to quantifying environment novelty underscore the need for a more robust framework, motivating the development of CENIE. CENIE quantifies environment novelty through state-action space coverage derived from the agent's accumulated experiences across previous environments in its curriculum. In single-environment online reinforcement learning, coverage within the training distribution is often linked to sample efficiency , providing inspiration for the CENIE framework. Given UED's objective to enhance a student's generalizability across a vast and often unseen (during training) environment space, quantifying novelty in terms of state-action space coverage has several benefits. By framing novelty in this way, CENIE enables a sample-efficient exploration of the environment search space by prioritizing levels that drive the agent towards unfamiliar state-action combinations. This provides a principled basis for directing the environment design towards enhancing the generalizability of the student agent. Additionally, a distinctive benefit of this approach is that it is not confined to any particular UED or DRL algorithms since it solely involves modeling the agent's state-action space coverage. This flexibility allows us to implement CENIE atop any UED algorithm.

CENIE's approach to novelty quantification through state-action coverage introduces three key attributes, effectively addressing the limitations of previous methods: (1) **domain-agnostic**, (2) **curriculum-aware**, and (3) **scalable**. CENIE is domain-agnostic, as it quantifies novelty solely based on the state-action pairs of the student, thus eliminating any dependency on the encoding of the environment. CENIE achieves curriculum-awareness by quantifying novelty using a model of the student's past aggregated experiences, i.e., state-action space coverage, ensuring that the selection of environments throughout the curriculum is sample-efficient with regards to expanding the student's state-action coverage. Lastly, CENIE demonstrates scalability by avoiding the computational burden associated with exhaustive pairwise comparisons or costly distance metrics.

### Measuring the Novelty of a Level

To evaluate the novelty of new environments using the agent's state-action pairs, the teacher needs to first model the student's past state-action space coverage distribution. We propose to use GMMs as they are particularly effective due to their robustness in representing high-dimensional continuous distributions [14; 5]. A GMM is a probabilistic clustering model that represents the underlying distribution of data points using a weighted combination of multivariate Gaussian components. Once the state-action distribution is modeled using a GMM, we can leverage it for density estimation. Specifically, the GMM allows us to evaluate the likelihood of state-action pairs induced by new environments, where lower likelihoods indicate experiences that are less represented in the student's current state-action space. This likelihood provides a quantitative measure of dissimilarity in state-action space coverage, enabling a direct comparison of novelty between levels. It is important to note that CENIE defines a general framework for quantifying novelty through state-action space coverage;

Figure 1: An overview of the CENIE framework. The teacher will utilise environment regret and novelty for curating student’s curriculum. \(\) contains past experiences and \(\) is the recent trajectory.

GMMs represent just one possible method for modeling this coverage. Future research may explore alternatives to model state-action space coverage within the CENIE framework (see Section C in the appendix for more discussions).

Before detailing our approach, we first define the notations used in this section. Let \(l_{}\) be a particular level conditioned by an environment parameter \(\). We refer to \(l_{}\) as the candidate level, for which we aim to determine its novelty. The agent's trajectory on \(l_{}\) is denoted as \(_{}\), and can be decomposed into a set of sample points, represented as \(X_{}=\{x=(s,a)_{}\}\). The set of past training levels is represented by \(L\) and \(=\{x=(s,a)_{L}\}\) is a buffer containing the state-action pairs collected from levels across \(L\). We treat \(\) as the ground truth of the agent's state-action space coverage, against which we evaluate the novelty of state-action pairs from the candidate level \(X_{}\).

To fit a GMM on \(\), we must find a set of Gaussian mixture parameters, denoted as \(_{}=\{(_{1},_{1},_{1}),...,(_{K},_{K}, _{K})\}\), that best represents the underlying distribution. Here, \(K\) denotes the predefined number of Gaussians in the mixture, where each Gaussian component is characterized by its weight (\(_{k}\)), mean vector (\(_{k}\)), and covariance matrix (\(_{k}\)), with \(k\{1,...,K\}\). We employ the _kmeans++_ algorithm  for a fast and efficient initialization of \(_{}\). The likelihood of observing \(\) given the initial GMM parameters \(_{}\) is expressed as:

\[P(_{})=_{j=1}^{J}_{k=1}^{K}_{k}(x_{j}_{k},_{k})\] (2)

where \(x_{j}\) is a state-action pair sample from \(\). \((x_{j}_{k},_{k})\) represents the multi-dimensional Gaussian density function for the \(k\)-th component with mean vector \(_{k}\) and covariance matrix \(_{k}\). To optimise \(_{}\), we use the Expectation Maximization (EM) algorithm  because Eq. 2 is a non-linear function of \(_{}\), making direct maximization infeasible. The EM algorithm iteratively refines the initial \(_{}\) to estimate a new \(_{}^{}\) such that \(P(X_{}^{})>P(X_{})\). This process is repeated iteratively until some convergence, i.e., \(_{}^{}-_{}\|<\), where \(\) is a small threshold.

Once the GMM is fitted, we can use \(_{}\) to perform density estimation and calculate the novelty of the candidate level \(l_{}\). Specifically, we consider the set of state-action pairs from the agent's trajectory, \(X_{}\), and compute their posterior likelihood under the GMM. This likelihood indicates how similar the new state-action pairs are to the learned distribution of past state-action coverage. Consequently, the novelty score of \(l_{}\) is represented as follows:

\[_{l_{}}=-|}(X_{ }_{})=-|}_{t=1}^{T} p(x_{t} _{})\] (3)

where \(x_{t}\) is a sample state-action pair from \(X_{}\). As shown in Eq. 3, we take the negative mean log-likelihood across all samples in \(X_{}\) to attribute higher novelty scores to levels with state-action pairs that are less likely to originate from the aggregated past experiences, \(\). This novelty metric promotes candidate levels that induce more novel experiences for the agent during training. More details on fitting GMMs are explained in Appendix D.1.

Design considerations for the GMMFirst, we specifically designate the state-action coverage buffer, i.e., \(\), as a First-In-First-Out (FIFO) buffer with a fixed window length. By focusing on a fixed window rather than the entire history of state-action pairs, our novelty metric avoids bias toward experiences that are outdated and have not appeared in recent trajectories. This design choice helps reduce the effects of catastrophic forgetting prevalent in DRL. Next, it is known that by allowing the adaptation of the number of Gaussians in the mixture, i.e., \(K\) in Eq. 2, any smooth density distribution can be approximated arbitrarily close . Therefore, to optimize the GMM's representation of the agent's state-action coverage distribution, we fit multiple GMMs with varying numbers of Gaussians within a predefined range at each time step and select the best one based on the silhouette score , an approach inspired by Portelas et al. . The silhouette score evaluates clustering quality by measuring both intra-cluster cohesion and inter-cluster separation. This approach enables CENIE to construct a pseudo-online GMM model that dynamically adjusts its complexity to accommodate the agent's changing state-action coverage distribution.
With a scalable method to quantify the novelty of levels, we demonstrate its versatility and effectiveness by deploying it on top of the leading UED algorithms, PLR\({}^{}\) and ACCEL. For convenience, in subsequent sections, we will refer to this CENIE-augmented methodology of PLR\({}^{}\) and ACCEL using GMMs as PLR-CENIE and ACCEL-CENIE, respectively. Both PLR\({}^{}\) and ACCEL utilize a replay mechanism to train their students on the highest-regret levels curated within the level buffer. To integrate CENIE within these algorithms, we use normalized outputs of a prioritization function to convert the level scores (novelty and regret) into level replay probabilities (\(P_{S}\)):

\[P_{S}=)^{}}{_{j}h(S_{j})^{}}\] (4)

where \(h\) is a prioritization function (e.g. rank) with a tunable temperature \(\) that defines the prioritization of levels with regards to any arbitrary score \(S\). Following the implementations in PLR\({}^{}\) and ACCEL, we employ \(h\) as the rank prioritization function, i.e., \(h(S_{i})=1/(S_{i})\), where \((S_{i})\) is the rank of level score \(S_{i}\) among all scores sorted in descending order. In ACCEL-CENIE and PLR-CENIE, we use both the novelty and regret scores to determine the level replay probability:

\[P_{replay}= P_{N}+(1-) P_{R}\] (5)

where \(P_{N}\) and \(P_{R}\) are the novelty-prioritized probability and regret-prioritized probability respectively, and \(\) allows us to adjust the weightage of each probability. The complete procedures for ACCEL-CENIE are provided in Algorithm 1, and for PLR-CENIE in the appendix (see Algorithm 2). Key steps specific to CENIE using GMMs are highlighted in blue.

```
0: Level buffer size \(N\), Component range \([K_{},K_{}]\), FIFO window size \(\), level generator \(\)
0: Student policy \(_{}\), level buffer \(\), state-action buffer \(\), GMM parameters \(_{}\)
1: Generate \(N\) initial levels by \(\) to populate \(\)
2: Collect \(_{}\)'s trajectories on each level in \(\) and fill up \(\)
3:while not converged do
4: Sample replay decision, \( U\)
5:if\( 0.5\)then
6: Generate a new level \(l_{}\) by \(\)
7: Collect trajectories \(\) on \(l_{}\), with stop-gradient \(_{}\)
8: Compute novelty score for \(l_{}\) using \(_{}\) (Eq.3 and Eq.4)
9: Compute regret score for \(l^{}_{}\) (Eq.1 and Eq.4)
10: Update \(\) with \(l_{}\) if \(P_{replay}(l_{})\) is greater than that of any levels in \(\) (Eq.5)
11:else
12: Sample a replay level \(l_{}\) according to \(P_{replay}\)
13: Collect trajectories \(\) on \(l_{}\)
14: Update \(_{}\) with rewards \(R()\)
15: Update \(\) with \(\) and resize to \(\)
16:for\(k\) in range \(K_{}\) to \(K_{}\)do
17: Fit a GMM\({}_{k}\) with \(k\) components on \(\) and compute its silhouette score
18:endfor
19: Select GMM parameters with the highest silhouette score to replace \(_{}\)
20: Perform edits on \(l_{}\) to produce \(l^{}_{}\)
21: Collect trajectories \(\) on \(l^{}_{}\), with stop-gradient \(_{}\)
22: Compute novelty score for \(l^{}_{}\) using \(_{}\) (Eq.3 and Eq.4)
23: Compute regret score for \(l^{}_{}\) (Eq.1 and Eq.4)
24: Update \(\) with \(l^{}_{}\) if \(P_{replay}(l^{}_{})\) is greater than that of any levels in \(\) (Eq.5)
25:endif
26:endwhile ```

**Algorithm 1** ACCEL-CENIE

## 5 Experiments

In this section, we benchmark PLR-CENIE and ACCEL-CENIE against their predecessors and a set of baseline algorithms: Domain Randomization (DR), Minimax, PAIRED, and DIPLR. The technical details of each algorithm are presented in Appendix E. We empirically demonstrated the effectiveness of CENIE on three distinct domains: Minigrid, BipedalWalker, and CarRacing. Minigrid is a partially observable navigation task under discrete control with sparse rewards, while BipedalWalker and CarRacing are partially observable continuous control tasks with dense rewards. Due to the complexity of mutating racing tracks, CarRacing is the only domain where ACCEL and ACCEL-CENIE are excluded. The experiment details are provided in Appendix D. Following standard UED practices, all agents were trained using Proximal Policy Optimization (PPO; ) across the domains, and we present their zero-shot performance on held-out tasks. We also conducted ablation studies to assess the isolated effectiveness of CENIE's novelty metric (see Appendix A).

For reliable comparison, we employ the standardized DRL evaluation metrics , presenting the aggregate inter-quartile mean (IQM) and optimality gap plots after normalizing the performance with a min-max range of solved-rate/returns. Specifically, IQM focuses on the middle 50% of combined runs, discarding the bottom and top 25%, thereby providing a robust measure of overall performance. Optimality gap captures the amount by which the algorithm fails to meet a desirable target (e.g., 95% solved rate), beyond which further improvements are considered unimportant. Higher IQM and lower optimality gap scores are better. The hyperparameters for the algorithms in each experiment are specified in the appendix.

### Minigrid Domain

First, we validated the CENIE-augmented methods in Minigrid [23; 20], a popular benchmark due to its ease of interpretability and customizability. Given its sparse reward signals and partial observability, navigating Minigrid requires the agent to explore multiple possible paths before successfully solving the maze and receiving rewards for policy updates. Therefore, Minigrid is an ideal domain to validate the exploration capabilities of the CENIE-augmented algorithms.

Following prior UED works, we train all student agents for 30k PPO updates (approximately 250 million steps) and evaluate their generalization on eight held-out environments (see Figure 2). Figure 2 demonstrates that ACCEL-CENIE outperforms ACCEL in all testing environments. Moreover, PLR-CENIE shows significantly better performance in seven test environments compared to PLR\({}^{}\). This underscores the ability of CENIE's novelty metric to complement the UED framework, particularly in improving generalization performance beyond the conventional learning potential metric, regret. Further empirical validation in Figure 3(a) confirms ACCEL-CENIE's superiority over ACCEL in both IQM and optimality gap. PLR-CENIE also outperforms its predecessor, PLR\({}^{}\), by a significant margin. Notably, PLR-CENIE's performance is able to match ACCEL's, which is significant considering PLR-CENIE uses a random generator while ACCEL uses an editing mechanism to introduce gradual complexity to environments.

Beyond the normal-size testing mazes, we consider a more challenging evaluation setting. We evaluate the fully-trained student policy of PLR\({}^{}\), PLR-CENIE, ACCEL, and ACCEL-CENIE on PerfectMazeLarge (shown in Figure 3(b)), an out-of-distribution environment which has \(51 51\) tiles and a episode length of 5000 timesteps - a much larger scale than training levels. We evaluate the agents for 100 episodes (per seed), using the same checkpoints in Figure 2. ACCEL-CENIE and ACCEL achieved comparable zero-shot transfer performance. Notably, PLR-CENIE achieved close

Figure 2: Zero-shot transfer performance in eight human-designed test environments. The plots are based on the median and interquartile range of solved rates across 5 independent runs.

to 50% solved rate, matching ACCEL's performance. This is a significant improvement from PLR\({}^{}\), which had less than a 10% solved rate.

### BipedalWalker Domain

We also evaluated the CENIE-augmented algorithms in the BipedalWalker domain , which is a partially observable continuous domain with dense rewards. We train all the algorithms for 30k PPO updates (\(\)1B timesteps) and then evaluate their generalization performance on six distinct test environments: BipedalWalker (default), Hardcore, Stair, PitGap, Stump, and Roughness (visualized in Figure 6(a)). To monitor the student's generalization performance evolution, we assess the student policy every 100 PPO updates across six testing environments during the training period.

In Figure 4, ACCEL-CENIE outperforms ACCEL in five testing environments, with both achieving parity in the Roughness challenge, establishing ACCEL-CENIE as the leading UED algorithm in BipedalWalker. Similarly, PLR-CENIE consistently outperforms PLR\({}^{}\) across all testing instances, except for the Stump challenge, where both algorithms exhibit similar performance. We present the aggregate results after min-max normalization (with range= on all test environments) in Figure 6(b). Both ACCEL-CENIE and PLR-CENIE exhibit better performance compared to their predecessors in the IQM and optimality gap metrics. Notably, ACCEL-CENIE outperforms all benchmarks by a substantial margin, achieving close to 55% of optimal performance.

Next, we tracked the evolution of state-action space coverage throughout training to evaluate the impact of CENIE's novelty objective on the curriculum's exploration of the state-action space. During

    & PLR\({}^{}\) & PLR-CENIE & ACCEL & ACCEL-CENIE \\  State-action & 43.4\% & 55.3\% & 42.5\% & 47.6\% \\ Space Coverage & & & & \\   

Table 1: Coverage of state-action space across 30k PPO updates in the BipedalWalker domain.

Figure 4: Student’s generalization performance on 6 BipedalWalker testing environments during training. Each curve is measured across 5 independent runs (mean and standard error).

Figure 3: (a) Aggregate zero-shot transfer performance in Minigrid domain across 5 independent runs. (b) Zero-shot test performance of PLR\({}^{}\), PLR-CENIE, ACCEL, and ACCEL-CENIE on PerfectMazeLarge across 5 independent runs.

training, state-action pairs encountered by the agent were collected for both PLR\({}^{}\) and ACCEL, along with their CENIE-augmented versions. To visualize the distribution of these high-dimensional state-action pairs, we applied t-distributed Stochastic Neighbor Embedding (t-SNE; ) to project them into a 2-D space. The resulting evolution plot and detailed implementation steps are provided in Appendix A.2. Afterwards, we quantified state-action space coverage by discretizing the 2-D scatterplot into cells and calculating the percentage of total cells occupied by each algorithm. As shown in Table 1, CENIE drives ACCEL-CENIE and PLR-CENIE to achieve significantly broader state-action coverage by the end of 30k PPO updates compared to their predecessors. This evidence supports that the inclusion of CENIE's novelty objective for level replay prioritization contributes to broader state-action space coverage.

To understand ACCEL-CENIE's improvement over ACCEL, we analyzed the difficulty composition of replayed levels at various training intervals across five seeds, as shown in Figure 5. Level difficulty is assessed based on environment parameters such as stump height and pit gap width, using metrics adapted from Wang et al.  (details in Appendix A.2). It is evident that ACCEL predominantly favors "Easy" to "Moderate" difficulty levels, whereas ACCEL-CENIE progressively incorporates "Challenging" levels into its replay selection throughout training.

The disparity in level difficulty distribution between ACCEL and ACCEL-CENIE is a critical factor in understanding their observed performance differences. ACCEL's training curriculum tends to remain within a comfort zone, consistently selecting a limited subset of simpler levels where the agent experiences high regret. However, this can be problematic when considering the regret stagnation problem. Specifically, in the event where the easier levels exhibit _irreducible regret_, it can restrict the agent's exposure to more complex scenarios, thereby constraining its generalization potential. In contrast, ACCEL-CENIE's integration of a novelty objective actively selects challenging levels, pushing the agent beyond its comfort zone into unfamiliar, complex environments. This novelty-based regularization fosters the exploration of under-explored regions in the state-action space, even if regret levels are low, thereby enhancing the agent's generalization capabilities. Furthermore, with a mutation-based approach like ACCEL, this environment selection strategy may generate or mutate new levels with high learning potential, further enriching the training curriculum.

### CarRacing Domain

Finally, we evaluated the effectiveness of CENIE by implementing it on PLR\({}^{}\) within the CarRacing domain [16; 27]. In this domain, the teacher manipulates the curvature of racing tracks using Bezier

Figure 5: Difficulty composition of levels replayed by ACCEL and ACCEL-CENIE during training.

Figure 6: (a) BipedalWalker domain and (b) Aggregate zero-shot transfer performance in BipedalWalker.

curves defined by a sequence of 12 control points, while the student drives on the track under continuous control with dense rewards. We train the students in each algorithm for 2.75k PPO updates (\(\)5.5M steps), after which we test the zero-shot transfer performance of the different algorithms on 20 levels replicating real-world Formula One (F1) tracks introduced by Jiang et al. . These tracks are guaranteed to be OOD as their configuration cannot be defined by Bezier curves with only 12 control points. The middle image in Figure 5(b) shows a track generated by domain randomization and the rightmost image shows a bird's-eye view of the F1-USA benchmark track.

The aggregate performance after min-max normalization of all algorithms is summarized in Figure 6(b). Note that the min-max range varies across F1 tracks due to different specifications on the maximum episode steps (see Table 5 in the appendix for more details). Once again, the CENIE-augmented algorithm, PLR-CENIE, achieves the best generalization performance in both IQM and optimality gap scores. Table 3 in the appendix shows the zero-shot transfer returns on all 20 F1 tracks. PLR-CENIE consistently outperforms or matches the best-performing baseline on all tracks.

Figure 8 presents the total regret in the level replay buffer for both PLR\({}^{}\) and PLR-CENIE throughout the training process. Interestingly, PLR-CENIE maintains comparable, or even slightly higher, levels of regret across the training distribution, despite not directly optimizing for it. This outcome suggests that CENIE's novelty objective synergizes with the discovery of high-regret levels, providing counterintuitive evidence that optimizing solely for regret is not the only, nor necessarily the most effective, strategy for identifying levels with high learning potential (as approximated by regret). Intuitively, value predictions are inherently less reliable in regions of lower coverage density-areas characterized by higher entropy or high uncertainty regarding optimal actions-since these regions are less frequently sampled for agent's learning. These high-entropy regions are prime candidates for high-regret outcomes, especially when using a bootstrapped regret estimate, as in Eq. 1, due to the value estimation error in such states. By pursuing novel environments based on coverage, CENIE indirectly enhances the discovery of high-regret states, highlighting that novelty-driven autocurricula can effectively complement regret-based methods in uncovering diverse and challenging training scenarios.

## 6 Conclusion

In this paper, we introduced Coverage-based Evaluation of Novelty In Environment (CENIE), a scalable, domain-agnostic, and curriculum-aware framework for quantifying environment novelty in UED. We then proposed an implementation of CENIE that models this coverage and measures environment novelty using Gaussian Mixture Models. By incorporating CENIE with existing UED algorithms, we validated the framework's effectiveness in enhancing agent exploration capabilities and zero-shot transfer performance across three distinct benchmark domains. This promising approach marks a significant step towards unifying novelty-driven exploration and regret-driven exploitation for training generally capable RL agents. We encourage motivated readers to refer to the appendix for further studies and discussions on CENIE.

Figure 8: Total regret in level replay buffer for PLR\({}^{}\) and PLR-CENIE over training in CarRacing.

Figure 7: (a) CarRacing domain and (b) Aggregate zero-shot transfer performance in CarRacing.