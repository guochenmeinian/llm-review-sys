# Improving the Knowledge Gradient Algorithm

Le Yang

Department of Systems Engineering

City University of Hong Kong

lyang272-c@my.cityu.edu.hk

&Siyang Gao

Department of Systems Engineering

City University of Hong Kong

siyangao@cityu.edu.hk

&Chin Pang Ho

School of Data Science

City University of Hong Kong

clint.ho@cityu.edu.hk

###### Abstract

The knowledge gradient (KG) algorithm is a popular policy for the best arm identification (BAI) problem. It is built on the simple idea of always choosing the measurement that yields the greatest expected one-step improvement in the estimate of the best mean of the arms. In this research, we show that this policy has limitations, causing the algorithm not asymptotically optimal. We next provide a remedy for it, by following the manner of one-step look ahead of KG, but instead choosing the measurement that yields the greatest one-step improvement in the probability of selecting the best arm. The new policy is called improved knowledge gradient (iKG). iKG can be shown to be asymptotically optimal. In addition, we show that compared to KG, it is easier to extend iKG to variant problems of BAI, with the \(\)-good arm identification and feasible arm identification as two examples. The superior performances of iKG on these problems are further demonstrated using numerical examples.

## 1 Introduction

The best arm identification (BAI) is a sequential decision problem where in each stage, the agent pulls one out of \(k\) given arms and observes a noisy sample of the chosen arm. At the end of the sampling stage, the agent needs to select the arm that is believed to be the best according to the samples. In this research, we let the best arm be the one with the largest mean. BAI is a useful abstraction of issues faced in many practical settings [1; 2] and has been widely studied in the machine learning community [3; 4]. Since in practical problems, the target arm(s) (to be identified) is not necessarily the best arm, some variant models of BAI have also been proposed in the literature, e.g., top-\(m\) arm identification [5; 6], Pareto front identification , \(\)-good arm identification , feasible arm identification [9; 10], etc.

In this research, we focus on the fixed-budget BAI, in which the total number of samples (budget) is fixed and known by the agent. The goal is to correctly identify the best arm when the budget is used up. To solve this problem, many methods have been proposed, e.g., successive rejects (SR) , expected improvements (EI) , top-two sampling [12; 13], knowledge gradient (KG) [14; 15], optimal computing budget allocation (OCBA)[16; 17; 18], etc. Among these methods, KG has been prevailing. It was first proposed in  and further analyzed in [20; 21]. It is built on the simple idea of always pulling the arm that yields the greatest expected one-step improvement in the estimate of the best mean of the arms. This improvement measure is analytical, making the algorithm easily implementable. KG often offers reasonable empirical performances and has been successfully applied in a number of real applications [22; 23].

However, we observe that this definition of KG has limitations, causing the algorithm not asymptotically optimal. Here by not being asymptotically optimal, we mean that the KG algorithm is not rate optimal, in the sense that the probability of the best arm being falsely selected based on the posterior means of the \(k\) arms does not converge to zero at the fastest possible rate. This is resulted from KG allocating too few samples to the best arm and excessive samples to the remaining arms. Note that Frazier et al.  claimed that KG is "asymptotically optimal", but in their context, "asymptotically optimal" is consistent, i.e., all the arms will be infinitely sampled as the round \(n\), so that the best arm will be correctly selected eventually. This is a relatively weak result for BAI algorithms (the simple equal allocation is also consistent). In this paper, asymptotically optimal refers to rate optimal.

**Contributions.** We propose a new policy that can overcome this limitation of KG. The new policy follows the manner of one-step look ahead of KG, but pulls the arm that yields the greatest one-step improvement in the probability of selecting the best arm. We call it improved knowledge gradient (iKG) and show that it is asymptotically optimal. This policy is originated from the thought of looking at whether the best arm has been selected at the end of sampling, instead of looking at the extent that the mean of the selected arm has been maximized. Although both ways can identify the best arm, it turns out that the algorithms developed from them are significantly different in the rates of posterior convergence. Another advantage of iKG over KG is that iKG is more general and can be more easily extended to variant problems of BAI. We use \(\)-good arm identification and feasible arm identification as examples, develop algorithms for them using the idea of iKG and establish asymptotic optimality for the algorithms.

This paper is conceptually similar to  which improves the EI algorithm for BAI. However, for EI, sampling ratios of any two arms in the non-best set are already asymptotically optimal. One only needs to introduce a parameter \(\) to balance the probabilities of sampling the best arm and the non-best set without changing the sampling policy within the non-best set to further improve EI. For KG, sampling ratios are not asymptotically optimal for any two out of the \(k\) arms. It requires a fundamental change on the sampling policy that influences the sampling rates of all the arms to improve KG. Moreover, the improved rate of posterior convergence of EI in  still depends on \(\) which is not necessarily optimal, while we can show that this rate of iKG is optimal.

## 2 Knowledge Gradient and its Limitations

In this section, we review KG and discuss its limitations. Suppose there are \(k\) arms in BAI. In each round \(t\), the agent chooses any arm \(i\) to pull and obtains a noisy sample \(X_{t+1,i}\). After \(n\) rounds, the agent needs to select an arm that he/she believes to be the best. Under the framework of the KG algorithm, \(X_{t+1,i}\)'s are assumed to be independent across different rounds \(t\) and arms \(i\) and following the normal distribution \((_{i},_{i}^{2})\) with unknown means \(_{i}\) and known variances \(_{i}^{2}\). The best arm is assumed to be unique. Without loss of generality, let \(_{ 1}>_{ 2}_{ k}\), where \( i\) indicates the arm with \(i\)-th largest mean.

The KG algorithm can be derived from a dynamic programming (DP) formulation of BAI. The state space \(\) consists of all the possible posterior means and variances of the arms, denoted as \(^{k}(0,)^{k}\). State \(S_{t}\) in round \(t\) can be written as \(S_{t}=(_{t,1},_{t,2},,_{t,k},_{t,1}^{2},_{t,2}^{2},,_{t,k}^{2})^{}\). In the Bayesian model, the unknown mean \(_{i}\) is treated as random and let \(_{i}\) be the random variable following its posterior distribution. We adopt normal distribution priors \((_{0,i},_{0,i}^{2})\). With samples of the arms, we can compute their posterior distributions, which are still normal \((_{t,i},_{t,i}^{2})\) in round \(t\) by conjugacy. The posterior mean and variance of arm \(i\) are

\[_{t+1,i}=^{-2}_{t,i}+_{i}^{-2}X_{t +1,i}}{_{t,i}^{-2}+_{i}^{-2}}&I_{t}=i,\\ _{t,i}&I_{t} i,_{t+1,i}^{2}= ^{-2}+_{i}^{-2}}&I_{t}=i,\\ _{t,i}^{2}&I_{t} i.\] (1)

In this paper, we adopt a non-informative prior for each arm \(i\), i.e., \(_{0,i}=0\) and \(_{0,i}=\). Denote the action space as \(\{1,2,,k\}\) and transition function as \( \). Suppose \(_{t,i}\) is a random variable following the posterior distribution \((_{t,i},_{i}^{2})\) of arm \(i\). Then, the state transition can be written as \(S_{t+1}=(S_{t},i,_{t,i})\). Let \(\) be the sampling policy that guides the agent to pull arm \(I_{t}\) in round \(t\) and \(\) be the set of sampling policies \(=(I_{0},I_{1},,I_{n-1})\) adapted to the filtration \(I_{0},X_{1,I_{0}},,I_{t-1},X_{t,I_{t-1}}\). After \(n\) rounds, the estimated best arm \(I_{n}^{*}\) is selected and a terminal reward \(v_{n}(S_{n})\) is received. We can write our objective as

\[_{}_{}v_{n}(S_{n}).\] (2)

The DP principle implies that the value function in round \(0 t<n\) can be computed recursively by

\[v_{t}(S)_{i}[v_{t+1}((S,i, _{t,i}))], S.\]

We define the Q-factors as

\[Q_{t}(S,i)[v_{t+1}((S,i,_{t,i}))], S ,\]

and the DP principle tells us that any policy satisfying

\[I_{t}(S)*{argmax}_{i}Q_{t}(S,i), S \]

is optimal. However, the optimal policy is basically intractable unless for problems with very small scales, known as the "curse of dimensionality".

On the other hand, note that except the terminal reward \(v_{n}(S_{n})\), this problem has no rewards in the other rounds, so we can restructure \(v_{n}(S_{n})\) as a telescoping sequence

\[v_{n}(S_{n})=[v_{n}(S_{n})-v_{n}(S_{n-1})]++[v_{n}(S_{t+1})-v_{n}(S_{t} )]+v_{n}(S_{t}).\]

Thus, \(v_{n}(S_{n})\) can be treated as the cumulation of multiple one-step improvements \(v_{n}(S_{l})-v_{n}(S_{l-1})\), \(l=t+1,,n\). A class of one-step look ahead algorithms iteratively pull the arm that maximizes the expectation of the one-step improvement on the value function

\[[v_{n}((S_{t},i,_{t,i}))-v_{n}(S_{t})].\] (3)

These algorithms are not optimal in general unless there is only one round left, i.e., \(n=t+1\).

The KG algorithm falls in this class. It sets the terminal reward as \(v_{n}(S_{n})=_{I_{n}^{*}}\). With this reward, the one-step improvement in (3) becomes

\[_{t,i}=[\{(_{t,i},i,_{t,i}),_{ i^{} i}_{t,i^{}}\}-_{i}_{t,i}],\]

and in each round, the KG algorithm pulls the arm \(I_{t}(S_{t})*{argmax}_{i}_{t,i}\).

``` Input:\(k 2\), \(n\)
1 Collect \(n_{0}\) samples for each arm \(i\);
2while\(t<n\)do
3 Compute \(_{t,i}\) and set \(I_{t}=*{argmax}_{i}_{t,i}\);
4 Play \(I_{t}\);
5 Update \(_{t+1,i}\) and \(_{t+1,i}\);
6
7
8 end while
9
10 end while ```

**Algorithm 1**KG Algorithm

We next characterize for the KG algorithm the rate of posterior convergence of \(1-\{I_{n}^{*}=I^{*}\}\), the probability that the best arm is falsely selected.

**Proposition 1**.: _Let \(c_{ i}=-_{ i})/ _{ i}}{(_{ 1}-_{ 2})/_{  2}},\,i=2,...,k\). For the KG algorithm,_

\[_{n}-(1-\{I_{n}^{*}=I^{*}\})=^{ },\]

_where_

\[^{}=_{i 1}-_{  1})^{2}}{2((_{i 1}_{ 2}/c_{  i}+_{ 1})_{ 1}+c_{  i}_{ i}^{2}(_{i 1}1/c_{ i }+_{ 1}/_{ 2})}.\]

We observe that \(^{}\) is not optimal. To make this point, Proposition 2 gives an example that \(^{}\) is no better than this rate of the TTEI algorithm  when the parameter \(\) (probability of sampling the best arm) of TTEI is set to some suboptimal value.

**Proposition 2**.: _For the TTEI algorithm , the rate of posterior convergence of \(1-\{I_{n}^{*}=I^{*}\}\) exists and is denoted as \(^{}\). Let its probability of sampling the best arm \(=(_{ 2}/_{ 1}_{i 1}1/c_{  i}+1)^{-1}\). We have \(^{}^{}\)._

According to the proof of Proposition 2, there are configurations of the BAI problem leading to \(^{}<^{}\), i.e., \(^{}\) is not optimal. In fact, with \(=(_{ 2}/_{ 1}_{i 1}1/c_{  i}+1)^{-1}\), \(^{}=^{}\) is achieved only in some special cases, e.g., when \(k=2\).

## 3 Improved Knowledge Gradient

In this section, we propose an improved knowledge gradient (iKG) algorithm. We still follow the manner of one-step look ahead of KG, but set the terminal reward of problem (2) as \(v_{n}(S_{n})=\{I_{n}^{*}=I^{*}\}\). That is, for the goal of identifying the best arm, we reward the selected arm by a 0-1 quantity showing whether this arm is the best arm, instead of the mean of this arm (as in KG).

In this case, \([v_{n}(S_{n})]=\{I_{n}^{*}=I^{*}\}\), where

\[\{I_{n}^{*}=I^{*}\}=_{i I_{n}^{*}}( _{I_{n}^{*}}>_{i})}=1-_{i I _{n}^{*}}(_{i}>_{I_{n}^{*}})}.\] (4)

However, the probability \(_{i I_{n}^{*}}(_{i}>_{I_{n}^{*}}) }\) in (4) does not have an analytical expression. To facilitate the algorithm implementation and analysis, we adopt an approximation to it using the Bonferroni inequality :

\[_{i I_{n}^{*}}(_{i}>_{I_{n}^{*}}) }_{i I_{n}^{*}}(_{i}>_{I_{n}^{*}}),\]

and \([v_{n}(S_{n})]\) can be approximately computed as

\[[v_{n}(S_{n})] 1-_{i I_{n}^{*}}(_{i} >_{I_{n}^{*}})=1-_{i I_{n}^{*}}- _{n,I_{n}^{*}})^{2}}{2(_{n,i}^{2}+_{n,I_{n}^{*}}^{2})})}.\] (5)

Note that the Bonferroni inequality has been adopted as an approximation of the probability of correct selection in the literature for development of BAI algorithms . For our purpose, we can show that the use of this approximation still makes the resulting algorithm asymptotically optimal and empirically superior.

**Input:**\(k 2\), \(n\)

Collect \(n_{0}\) samples for each arm \(i\);

**while \(t<n\)do**

Compute iKG\({}_{t,i}\) and set \(I_{t}=*{argmax}_{i}_{t,i}\);

Play \(I_{t}\);

Update \(_{t+1,i}\), \(_{t+1,i}\) and \(I_{t+1}^{*}\);

**Output:**\(I_{n}^{*}\)

**Algorithm 2**iKG Algorithm

Let iKG\({}_{t,i}\) be the one-step improvement in (3) with \(I_{t}^{*}\) treated as unchanged after one more sample and \([v_{n}(S_{n})]\) approximated by (5). We have the following proposition to compute iKG\({}_{t,i}\). The iKG algorithm pulls the arm with the largest iKG\({}_{t,i}\) in each round.

**Proposition 3**.: _With the definition of iKG\({}_{t,i}\) above, we have_

\[i_{t,i}=-_{t,I_{t}^{*}})^ {2}}{2(_{t,i}^{2}+_{t,I_{t}^{*}}^{2})})}--_{t,I_{t}^{*}})^{2}}{2(_{t+1,i}^{2}+_{t,I_{t}^{*}}^{2 }+_{i}^{2}(_{t+1,i}^{2}/_{i}^{2})^{2})})},&i I_{t}^{*},\\ _{i^{} I_{t}^{*}}}-_{t, I_{t}^{*}})^{2}}{2(_{t,i^{}}^{2}+_{t,I_{t}^{*}}^{2})})}- _{i^{} I_{t}^{*}}}-_{t,I_{t }^{*}})^{2}}{2(_{t,i^{}}^{2}+_{t+1,I_{t}^{*}}^{2}+_{I_{t }^{*}}^{2}(_{t+1,I_{t}^{*}}^{2}/_{I_{t}^{*}}^{2})^{2})})},& i=I_{t}^{*}.\] (6)Both KG and iKG are greedy algorithms that look at the improvement only one-step ahead. The essential difference between them is on the reward they use for the event of best arm identification. For KG, it is the mean of the arm selected, while for iKG, it is a 0-1 quantity showing whether the best arm is selected. It is interesting to note that the choice between these two rewards has been discussed in the control community for optimization of complex systems, known as cardinal optimization (similar to KG) vs. ordinal optimization (similar to iKG) , with the discussion result in line with this research, indicating that ordinal optimization has advantages over cardinal optimization in the convergence rates of the optimization algorithms .

**Theorem 1**.: _For the iKG algorithm, \(_{n}-(1-\{I_{n}^{*}=I^{*}\})= ^{}\), where_

\[^{}=-_{ 1})^{2}}{2( _{ i}^{2}/w_{ i}+_{ 1}^{2}/w_{  1})},\] (7)

_and \(w_{i}\) is the sampling rate of arm \(i\) satisfying_

\[_{i=1}^{k}w_{i}=1,^{2}}{_{ 1 }^{2}}=_{i=2}^{k}^{2}}{_{ i }^{2}}-_{ 1 })^{2}}{2(_{ i}^{2}/w_{ i}+_{  1}^{2}/w_{ 1})}= }-_{ 1})^{2}}{2(_{ i^{}}^{2}/w_{  i^{}}+_{ 1}^{2}/w_{ 1})},\ \ i i^{ } 1.\] (8)

_In addition, for any BAI algorithms,_

\[_{n}-(1-\{I_{n}^{*}=I^{*}\}) ^{}.\]

Theorem 1 shows that the rate of posterior convergence \(^{}\) of the iKG algorithm is the fastest possible. We still use TTEI as an example. This theorem indicates that \(^{}^{}\) for any \((0,1)\) and the equality holds only when \(\) is set to \(^{*}\), where \(^{*}\) is the optimal value of \(\) and is typically unknown.

## 4 Variant Problems of BAI

Another advantage of iKG over KG is that iKG is more general, in the sense that it can be easily extended to solve variant problems of BAI. In the variants, the target arms to be identified are not the single best arm, but no matter how the target arms are defined, one can always look at the event that whether these arms are correctly identified at the end of sampling and investigate the probability of this event to develop iKG and the algorithm. In contrast, it is difficult to extend KG to identify arms that cannot be found through optimizing means of these (and/or other) arms. In this section, we extend iKG to two BAI variants: \(\)-good arm identification  and feasible arm identification . We develop algorithms for them and establish their asymptotic optimality. Note that in these two variant problems, the target arms need to be found by comparing their means with some fixed values. In such cases, the idea of KG is not straightforward.

### \(\)-Good Arm Identification

We follow the notation in Sections 2 and 3. For the \(k\) arms, suppose \(_{ 1}_{ 2}_{  k}\). Given \(>0\), the \(\)-good arm identification problem aims to find all the arms \(i\) with \(_{ i}>_{ 1}-\), i.e., all the arms whose means are close enough to the best (\(\)-good). Assume that no arms have means lying on \(_{ 1}-\). Denote the set of \(\)-good arms as \(G^{}\) and the estimated set of \(\)-good arms after \(n\) rounds as \(G^{}_{n}\). We set the terminal reward \(v_{n}(S_{n})=\{G^{}_{n}=G^{}\}\), i.e., whether the set \(G^{}\) is correctly selected. Then, \([v_{n}(S_{n})]=\{G^{}_{n}=G^{}\}\), where

\[\{G^{}_{n}=G^{}\} =_{i G^{}_{n}}(_{i}> _{i^{{}^{}}}_{i^{{}^{}}}-) _{i G^{}_{n}}(_{i}<_{i^{{}^{ }}}_{i^{{}^{}}}-)}\] \[=1-_{i G^{}_{n}}(_{i}< _{i^{{}^{}}}_{i^{{}^{}}}-) _{i G^{}_{n}}(_{i}>_{i^{{}^{ }}}_{i^{{}^{}}}-)}.\]

Again, applying the Bonferroni inequality,

\[\{G^{}_{n}=G^{}\} 1-_{i G^{}_{n}} (_{i}<_{i^{{}^{}}}_{i^{{}^{}} }-)-_{i G^{}_{n}}(_{i} >_{i^{{}^{}}}_{i^{{}^{}}}-).\] (9)Let iKG\({}^{}_{t,i}\) be the one-step improvement in (3) with \(I^{}_{t}\) treated as unchanged after one more sample and \([v_{n}(S_{n})]\) approximated by the right-hand side of (9). We have the following proposition to compute iKG\({}^{}_{t,i}\).

**Proposition 4**.: _With the definition of iKG\({}^{}_{t,i}\) above, we have_

\[iKG^{}_{t,i}=(--_{t,I^{ }_{t}}+)^{2}}{2(^{2}_{t,i}+^{2}_{t,I^{}_{t} })})-(--_{t,I^{}_{t}}+)^{2}} {2(^{2}_{t+1,i}+^{2}_{t,I^{}_{t}}+^{2}_{i}(^{2 }_{t+1,i}/^{2}_{i})^{2})}),&i I^{}_{t},\\ _{i^{} I^{}_{t}}(-}-_{t,I^{}_{t}}+)^{2}}{2(^{2}_{t,i^{}}+ ^{2}_{t,I^{}_{t}})})-_{i^{} I^{}_{t}} (-}-_{t,I^{}_{t}}+)^{2}}{2(^ {2}_{t,i^{}}+^{2}_{t+1,I^{}_{t}}+^{2}_{I^{}_{t}}( ^{2}_{t+1,I^{}_{t}}/^{2}_{I^{}_{t}})^{2})}),&i=I^{}_{t}.\] (10)

``` Input:\(k 2\), \(n\)
1 Collect \(n_{0}\) samples for each arm \(i\);
2while\(t<n\)do
3 Compute iKG\({}^{}_{t,i}\) and set \(I_{t}=*{argmax}_{i}^{}_{t,i}\);
4 Play \(I_{t}\);
5 Update \(_{t+1,i}\), \(_{t+1,i}\) and \(I^{}_{t+1}\);
6
7
8
9
10 end while
11
12 end while ```

**Algorithm 3**iKG-\(\) Algorithm (\(\)-good Arm Identification)

To identify the \(\)-good arms, the iKG-\(\) algorithm pulls the arm with the largest iKG\({}^{}_{t,i}\) in each round. For this algorithm, we can show that the rate of posterior convergence of \(1-\{G^{}_{n}=G^{}\}\) is the fastest possible.

**Theorem 2**.: _For the iKG-\(\) algorithm, \(_{n}-(1-\{G^{}_{n}=G^{ }\})=^{}\), where_

\[^{}=-_{ 1}+ )^{2}}{2(^{2}_{ i}/w_{ i}+^{2 }_{ 1}/w_{ 1})},\] (11)

_and \(w_{i}\) is the sampling rate of arm \(i\) satisfying_

\[_{i=1}^{k}w_{i}=1,_{ 1}}{^{2}_{  1}}=_{i=2}^{k}_{ i}}{^{2}_{  i}}-_{  1}+)^{2}}{2(^{2}_{ i}/w_{ i }+^{2}_{ 1}/w_{ 1})}=-_{ 1}+)^{2}}{2(^{2}_{ i^{}}/w_{  i^{}}+^{2}_{ 1}/w_{ 1})},\ i i^{ } 1.\] (12)

_In addition, for any \(\)-good arm identification algorithms,_

\[_{n}-(1-\{G^{}_{n}=G^ {}\})^{}.\]

### Feasible Arm Identification

In the feasible arm identification, samples from pulling arms \(i\) are \(m\)-dimensional vectors \(_{t+1,i}=[X_{t+1,i1},,X_{t+1,im}]\) instead of scalars, where each dimension of the vector corresponds to some measure of the system performance and \(X_{t+1,ij}\) is the observation associated with arm \(i\) and measure \(j\). Suppose \(X_{t+1,ij}\)'s follow the normal distribution with unknown means \(_{ij}\) and known variances \(^{2}_{ij}\). We impose constraints \(_{ij}_{j}\) on arms \(i=1,2,,k\) and measures \(j=1,2,,m\). The goal of this problem is to find the set of feasible arms \(^{1}\). Let the estimated set of feasible arms after \(n\) rounds be \(^{1}_{n}\) and \(^{2}=^{1}\). We assume that \(X_{t+1,ij}\)'s are independent across different rounds \(t\) and measures \(j\), and \(_{ij}\)'s do not lie on the constraint limits \(_{j}\). To facilitate the analysis, we also define for round \(t\) the set of measures \(^{1}_{t,i}\{j:_{t,ij}_{j}\}\) satisfied by arm \(i\) and the set of measures \(^{2}_{t,i}\{j:_{t,ij}>_{j}\}\) violated by arm \(i\).

Set the terminal reward \(v_{n}(S_{n})=\{_{n}^{1}=^{1}\}\), i.e., whether the set \(^{1}\) is correctly selected. Then, \([v_{n}(S_{n})]=\{_{n}^{1}=^{1}\}\), where

\[\{_{n}^{1}=^{1}\} =_{i_{n}^{1}} _{j=1}^{m}(_{ij}_{j})_{i_{n}^{2}}_{j=1}^{m}(_{ij}>_{j})}\] \[=1-_{i_{n}^{1}} _{j=1}^{m}(_{ij}>_{j})_{i_ {n}^{2}}_{j=1}^{m}(_{ij}_{j})}.\]

Applying the Bonferroni inequality,

\[\{_{n}^{1}=^{1}\} 1-_{i_ {n}^{1}}_{j=1}^{m}(_{ij}>_{j})-_{i_{n}^{2}}_{j_{t,i}^{2}}(_{ij}_{j}).\] (13)

The inequality holds because \(0<_{j_{n,i}^{1}}(_{ij}_{j}) 1\).

Let iKG\({}_{t,i}^{}\) be the one-step improvement in (3) with \(_{t}^{1}\), \(_{t}^{2}\) and \(_{t,i}^{2}\) treated as unchanged after one more sample and \([v_{n}(S_{n})]\) approximated by the right-hand side of (13). We have the following proposition to compute iKG\({}_{t,i}^{}\).

**Proposition 5**.: _With the definition of iKG\({}_{t,i}^{}\) above, we have_

\[_{t,i}^{}= _{j=1}^{m}(--_{t,ij})^{2 }}{2_{t,ij}^{2}}\{i_{t}^{1}\})-( --_{t,ij})^{2}}{2(_{t+1,ij}^{2}+_{ij}^{2}( _{t+1,ij}^{2}/_{ij}^{2})^{2})}\{i_{t}^{1} \})\] \[+(-_{j_{t,i}^{2}}- _{t,ij})^{2}}{2_{t,ij}^{2}}\{i_{t}^{2}\})- (-_{j_{t,i}^{2}}-_{t,ij})^{2}}{2 (_{t+1,ij}^{2}+_{ij}^{2}(_{t+1,ij}^{2}/_{ij}^{2})^{2}) }\{i_{t}^{2}\})\!.\] (14)

``` Input:\(k 2\), \(n\)
1Collect \(n_{0}\) samples for each arm \(i\);
2while\(t<n\)do
3 Compute iKG\({}_{t,i}^{}\) and set \(I_{t}=*{argmax}_{i}_{t,i}^{}\);
4 Play \(I_{t}\);
5 Update \(_{t+1,i}\), \(_{t+1,i}\), \(_{t+1}^{1}\), \(_{t+1}^{2}\), \(_{t+1,i}^{1}\) and \(_{t+1,i}^{2}\); Output:\(_{n}^{1}\) ```

**Algorithm 4**iKG-F Algorithm (Feasible Arm Identification)

To identify the feasible arms, the iKG-F algorithm pulls the arm with the largest iKG\({}_{t,i}^{}\) in each round. For this algorithm, we can show that the rate of posterior convergence of \(1-\{_{n}^{1}=^{1}\}\) is also the fastest possible.

**Theorem 3**.: _For the iKG-F algorithm, \(_{n}-(1-\{_{n}^{1}= ^{1}\})=^{}\), where_

\[^{}=w_{i}_{j_{i}^{1}}-_{ij})^ {2}}{2_{ij}^{2}}\{i^{1}\}+w_{i}_{j _{i}^{2}}-_{ij})^{2}}{2_{ij}^{2}}\{i^{2}\},\] (15)

_and \(w_{i}\) is the sampling rate of arm \(i\) satisfying_

\[_{i=1}^{k}w_{i}=1,\] \[w_{i}_{j_{i}^{1}}-_{ij})^ {2}}{2_{ij}^{2}}\{i^{1}\}+w_{i}_{j _{i}^{2}}-_{ij})^{2}}{2_{ij}^{2}} \{i^{2}\}\] (16) \[=w_{i^{}}_{j_{i^{}}^{1}}-_{i^{}j})^{2}}{2_{i^{}j}^{2}}\{i^{ }^{1}\}+w_{i^{}}_{j_{i^{}}^{2}} -_{i^{}j})^{2}}{2_{i^{}j}^{2}}\{i^ {}^{2}\},\,\,\,i i^{}.\]_In addition, for any feasible arm identification algorithms_

\[_{n}-(1-\{_{n}^{1}= ^{1}\})^{F}.\]

## 5 Numerical Experiments

In this section, we show empirical performances of the iKG, iKG-\(\) and iKG-F algorithms on synthetic and real-world examples. For the best arm identification problem, we compare iKG with the following algorithms.

* Expected Improvement (EI) . This is another common strategy for BAI. In each round, it pulls the arm offering the maximal expected improvement over the current estimate of the best mean of the arms.
* Top-Two Expected Improvement (TTEI) . This is a modification of the EI algorithm by introducing a parameter \(\) to control the probabilities of sampling the best arm and the non-best set. We set the parameter \(\) in TTEI as its default value \(1/2\).
* Knowledge Gradient. This is the algorithm under study in this research.

For the \(\)-good arm identification problem, we compare iKG-\(\) with the following algorithms.

* APT Algorithm . It is a fixed-budget algorithm for identifying the arms whose means are above a given threshold. We set the input tolerance parameter as \(0.0001\) and the threshold as the posterior mean of the estimated best arm minus \(\).
* \(()^{2}\) Algorithm . It is a fixed-confidence algorithm for \(\)-good arm identification. It pulls three arms in each round, the estimated best arm, one arm above the threshold and one arm below the threshold. We set the input tolerance parameter as \(0.0001\) and \(=0\).

For the feasible arm identification problem, we compare iKG-F with the following algorithms.

* MD-UCBE Algorithm . This is a fixed-budget algorithm for feasible arm identification based on the upper confidence bound. We set the input tolerance parameter as \(0.0001\) and hyperparameter \(a=\), where \(H\) is a constant that can be computed. Katz-Samuels and Scott  showed that with \(a=\), the performance of MD-UCBE is nearly optimal.
* MD-SAR Algorithm . This is a fixed-budget algorithm for feasible arm identification based on successive accepts and rejects. We set the input tolerance parameter as \(0.0001\).

In addition, iKG, iKG-\(\) and iKG-F will be compared with the equal allocation, where each arm is simply played with the same number of rounds. It is a naive method and is often used as a benchmark against which improvements might be measured.

The examples for testing include three synthetic examples, called Examples 1-3, and three real examples, namely the Dose-Finding Problem, Drug Selection Problem, and Caption Selection Problem. For Example 1-3 and the Dose-Finding problem, samples of the arms are two-dimensional. We call the measures of them measures 1 and 2. When the examples are tested for the best arm identification and \(\)-good identification, only measure 1 will be used for identifying good/best arms. When the examples are tested for the feasible arm identification, both measures will be used for feasibility detection. For the Drug Selection and Caption Selection problems, samples of the arms are one-dimensional. They are tested for the best arm identification, \(\)-good identification and feasible arm identification.

**Synthetic Datasets**. We consider three examples, all containing ten arms.

Example 1. The means in measure 1 of the ten arms are \(0.1927\), \(0.6438\), \(3.0594\), \(3.0220\), \(1.3753\), \(1.4215\), \(0.9108\), \(1.0126\), \(0.1119\) and \(1.8808\), and the means in measure 2 of the ten arms are \(0.4350\), \(0.7240\), \(1.1566\), \(0.8560\), \(3.4712\), \(0.8248\), \(3.8797\),\(1.9819\), \(3.2431\) and \(1.4315\), all of which are uniformly generated in \((0,4)\). Samples of the arms are corrupted by normal noises \((0,1)\). The best arm is arm \(3\) and \(0.1\)-good arms are arms 3 and 4. For the feasible arm identification, we choose arms with means in both measures less than \(2\). Then the feasible arms are arms \(1\), \(2\), \(6\), \(8\) and \(10\).

Example 2. We keep the setting of Example 1. Distributions of the noises for arms 1-5 are changed to \((0,4)\).

Example 3. Consider functions \(y_{1}(x)=-0.05x^{2}\), \(y_{2}(x)=-0.06(7-x)\) and \(y_{3}(x)=0.06(x-6)\). The means in measure 1 of the ten arms are \(y_{1}(x)\) with \(x=1,2,,10\). The means in measure 2 of the ten arms are \(y_{2}(x)\) with \(x=1,,6\) and \(y_{3}(x)\) with \(x=7,,10\). Noises follow the normal distribution \((0,1)\). The best arm is arm \(1\) and \(0.5\)-good arms are arms 1-3. For the feasible arm identification, we choose arms with means in measure \(1\) greater than \(-0.5\) and means in measure \(2\) less than \(0\). The feasible arms are arms 1-3.

**Dose-Finding Problem**. We use the data in  (see ACR\(50\) in week \(16\)) for treating rheumatoid arthritis by the drug secukinumab. There are four dosage levels, \(25\)mg, \(75\)mg, \(150\)mg, and \(300\)mg, and a placebo, which are treated as five arms. We develop a simulation model based on the dataset. Each arm is associated with two performance measures: the probability of the drug being effective and the probability of the drug causing infections. The means of the five arms are \(}=(0.151,0.259)\), \(}=(0.184,0.184)\), \(}=(0.209,0.209)\), \(}=(0.171,0.293)\) and \(}=(0.06,0.16)\). Samples of each arm are corrupted by normal noises \((0,0.25)\). The best arm is arm 3 and the 0.03-good arms are arms 2 and 3. For the feasible arm identification, we find the arms whose probability of being effective is larger than \(0.18\) and the probability of causing infections is less than \(0.25\). The feasible arms are arms 2 and 3.

**Drug Selection Problem**. We consider five contraceptive alternatives based on the Drug Review Dataset (https://doi.org/10.24432/C5SK5S): Ethinyl estradiol / levorongrest, Ethinyl estradiol / norethindro, Ethinyl estradiol / norgestimat, Etongestrel and Nexplanon, which can be treated as five arms. The dataset provides user reviews on the five drugs along with related conditions and ratings reflecting overall user satisfaction. We set the means of the five arms as \(_{1}=5.8676\), \(_{2}=5.6469\), \(_{3}=5.8765\), \(_{4}=5.8298\) and \(_{5}=5.6332\), and the variances of the five arms as \(_{1}^{2}=3.2756\), \(_{2}^{2}=3.4171\), \(_{3}^{2}=3.2727\), \(_{4}^{2}=3.3198\) and \(_{5}^{2}=3.3251\), all calculated by the data. When this example is used for the best arm identification and \(\)-good arm identification, the best arm (with the highest user satisfaction) and 0.003-good arm are both arm 3 (Ethinyl estradiol / norgestimat). When this example is used for feasible arm identification, we will select the drugs whose ratings are over \(5.6\), and the feasible arms are arm \(1\) (Ethinyl estradiol / levorongrest), arm \(2\) (Ethinyl estradiol / norethindro), arm \(3\) (Ethinyl estradiol / norgestimat), arm \(4\) (Etongestrel) and arm \(5\) (Nexplanon).

**Caption Selection Problem**. We aim to select good captions based on the New Yorker Cartoon Caption Contest Dataset (https://nextml.github.io/caption-contest-data/). In the contests, each caption can be treated as an arm. The dataset provides the mean and variance of each arm, which can be used to set up our experiments. We will test contests 853 (Caption 853) and 854 (Caption 854).

In Caption 853, we randomly select ten captions as arms. We set the means of the ten arms as \(_{1}=1.1400\), \(_{2}=1.0779\), \(_{3}=1.4160\), \(_{4}=1.0779\), \(_{5}=1.1081\), \(_{6}=1.1467\), \(_{7}=1.1333\), \(_{8}=1.1075\), \(_{9}=1.1026\) and \(_{10}=1.4900\), and the variances of the arms as \(_{1}^{2}=0.1418\), \(_{2}^{2}=0.0991\), \(_{3}^{2}=0.4871\), \(_{4}^{2}=0.0728\), \(_{5}^{2}=0.0977\), \(_{6}^{2}=0.1809\), \(_{7}^{2}=0.1843\), \(_{8}^{2}=0.0970\), \(_{9}^{2}=0.0932\) and \(_{10}^{2}=0.4843\), which are all calculated by the data. When this example is used for the best arm identification, the best arm (with the highest furniness score) is arm 10. When this example is used for \(\)-good arm identification, the 0.1-good arms are arms 3 and 10. When this example is used for feasible arm identification, we will select the captions whose funniness scores are over 1.4, and the feasible arms are arms 3 and 10.

In Caption 854, we also randomly select ten captions as arms. We set the means of the ten arms as \(_{1}=1.1986\), \(_{2}=1.1890\), \(_{3}=1.1400\), \(_{4}=1.2621\), \(_{5}=1.1544\), \(_{6}=1.0339\), \(_{7}=1.1349\), \(_{8}=1.2786\), \(_{9}=1.1765\) and \(_{10}=1.1367\), and the variances of the arms as \(_{1}^{2}=0.1879\),

   & Example & Example 1 & Example 2 & Example 3 & Dose-finding & Drug Selection & Caption 853 & Caption 854 \\   &  &  & 5000 & 4400 & 18000 & 400 & 1000 & 1200 & 13000 & 2400 & 98000 & 1600 & 3000 & 12000 & 18000 \\   & & Equal Allocation & 0.38 & 0.22 & 0.44 & 0.31 & 0.25 & 0.13 & 0.35 & 0.05 & 0.43 & 0.27 & 0.17 & 0.11 & 0.26 & 0.18 \\   & & El & 0.36 & 0.21 & 0.40 & 0.28 & 0.28 & 0.22 & 0.46 & 0.21 & 0.46 & 0.37 & 0.14 & 0.12 & 0.26 & 0.23 \\   & & TTEI & 0.25 & 0.07 & 0.32 & 0.09 & 0.13 & 0.02 & 0.31 & 0.03 & 0.55 & 0.28 & 0.04 & 0.01 & 0.10 & 0.06 \\   & & KG & 0.29 & 0.14 & 0.32 & 0.13 & 0.14 & 0.03 & 0.4

[MISSING_PAGE_FAIL:10]

*  E. Even-Dar, S. Mannor, Y. Mansour, and S. Mahadevan. Action elimination and stopping conditions for the multi-armed bandit and reinforcement learning problems. _Journal of Machine Learning Research_, 7(6), 2006.
*  J.-Y. Audibert, S. Bubeck, and R. Munos. Best arm identification in multi-armed bandits. In _23rd Conference on Learning Theory_, pages 41-53, 2010.
*  S. Bubeck, T. Wang, and N. Viswanathan. Multiple identifications in multi-armed bandits. In _International Conference on Machine Learning_, pages 258-265. PMLR, 2013.
*  H. Xiao and S. Gao. Simulation budget allocation for selecting the top-m designs with input uncertainty. _IEEE Transactions on Automatic Control_, 63(9):3127-3134, 2018.
*  P. Auer, C. K. Chiang, R. Ortner, and M. Drugan. Pareto front identification from stochastic bandit feedback. In _Artificial Intelligence and Statistics_, pages 939-947. PMLR, 2016.
*  B. Mason, L. Jain, A. Tripathy, and R. Nowak. Finding all \(\)-good arms in stochastic bandits. _Advances in Neural Information Processing Systems_, 33:20707-20718, 2020.
*  S. Gao and W. Chen. Efficient feasibility determination with multiple performance measure constraints. _IEEE Transactions on Automatic Control_, 62(1):113-122, 2016.
*  J. Katz-Samuels and C. Scott. Feasible arm identification. In _International Conference on Machine Learning_, pages 2535-2543. PMLR, 2018.
*  S. E. Chick, J. Branke, and C. Schmidt. Sequential sampling to myopically maximize the expected value of information. _INFORMS Journal on Computing_, 22(1):71-80, 2010.
*  C. Qin, D. Klabjan, and D. Russo. Improving the expected improvement algorithm. In _Proceedings of the 31st International Conference on Neural Information Processing Systems_, pages 5387-5397, 2017.
*  D. Russo. Simple Bayesian algorithms for best arm identification. _Operations Research_, 68(6):1625-1647, 2020.
*  I. O. Ryzhov, P. I. Frazier, and W. B. Powell. On the robustness of a one-period look-ahead policy in multi-armed bandit problems. _Procedia Computer Science_, 1(1):1635-1644, 2010.
*  Y. Li and S. Gao. On the finite-time performance of the knowledge gradient algorithm. In _International Conference on Machine Learning_, pages 12741-12764. PMLR, 2022.
*  C. H. Chen, J. Lin, E. Yucesan, and S. E. Chick. Simulation budget allocation for further enhancing the efficiency of ordinal optimization. _Discrete Event Dynamic Systems_, 10:251-270, 2000.
*  S. Gao, W. Chen, and L. Shi. A new budget allocation framework for the expected opportunity cost. _Operations Research_, 65(3):787-803, 2017.
*  Y. Li and S. Gao. Convergence rate analysis for optimal computing budget allocation algorithms. _Automatica_, 153:111042, 2023.
*  S. S. Gupta and K. J. Miescke. Bayesian look ahead one stage sampling allocations for selecting the largest normal mean. _Statistical Papers_, 35(1):169-177, 1994.
*  P. I. Frazier, W. B. Powell, and S. Dayanik. A knowledge-gradient policy for sequential information collection. _SIAM Journal on Control and Optimization_, 47(5):2410-2439, 2008.
*  P. Frazier, W. Powell, and S. Dayanik. The knowledge-gradient policy for correlated normal beliefs. _INFORMS Journal on Computing_, 21(4):599-613, 2009.
*  C. Schoppe. Wind and pumped-hydro power storage: Determining optimal commitment policies with knowledge gradient non-parametric estimation. _B.Sc. Thesis at Princeton University_, 2010.
*  D. M. Negoescu, P. I. Frazier, and W. B. Powell. The knowledge-gradient algorithm for sequencing experiments in drug discovery. _INFORMS Journal on Computing_, 23(3):346-363, 2011.

*  J. Galambos. Bonferroni inequalities. _The Annals of Probability_, pages 577-581, 1977.
*  Y.-C. Ho, S. Sreenivas, and P. Vakili. Ordinal optimization of deds. _Discrete Event Dynamic Systems_, 2(1):61-88, 1992.
*  Y.-C. Ho. An explanation of ordinal optimization: Soft computing for hard problems. _Information Sciences_, 113(3-4):169-192, 1999.
*  A. Locatelli, M. Gutzeit, and A. Carpentier. An optimal algorithm for the thresholding bandit problem. In _International Conference on Machine Learning_, pages 1690-1698. PMLR, 2016.
*  M. C. Genovese, P. Durez, H. B. Richards, J. Supronik, E. Dokoupilova, V. Mazurov, J. A. Aelion, S. H. Lee, C. E. Codding, H. Kellner, et al. Efficacy and safety of secukinumab in patients with rheumatoid arthritis: a phase ii, dose-finding, double-blind, randomised, placebo controlled study. _Annals of the Rheumatic Diseases_, 72(6):863-869, 2013.