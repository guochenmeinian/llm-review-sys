# Physics-informed generative model for drug-like molecule conformers

Anonymous Author(s)

Affiliation

Address

email

###### Abstract

Diffusion-based methods have been successfully applied to molecule conformer generation using implicit physical modeling. In contrast, conventional, rules-based approaches employ an explicit physical model such as a classical force field parameterization. In order to combine the advantages of both approaches, we present a diffusion-based, physics-informed denoising model (PIDM) for conformer generation that is constructed from molecule subgraph patterns borrowed from classical force fields. The result is a model that is resistant to overfitting and explainable. Using recent advances in denoising score matching, we naturally separate the task of training and generation while providing a smooth transition between deterministic and stochastic generative schemes that adapt to any number of denoising steps. We demonstrate conformer generation quality that outperforms the current state-of-the-art while employing a fraction of parameters.1

## 1 Introduction

Conformer generation is the process of identifying a valid and useful set of atomic coordinates for a given molecule. Because it plays a crucial role in structure-based drug-discovery , over four decades of effort has been invested in conventional rules-based approaches [2; 3; 4; 5; 6; 7; 8; 9]. Recent advances in generative techniques in deep learning, particularly in diffusion-based models of image generation [10; 11; 12; 13] and point-cloud generation [14; 15], suggest that generative techniques could lead to a renaissance in this field.

We describe in this work is a method of conformer generation using a physics-informed, denoising model (PIDM). By taking advantage of established methods employed in classical force fields, we have constructed a diffusion-based model that is explainable, transferable, and robust. Building upon recent theoretical advancements , we employ a flexible method of generation that smoothly adapts to either deterministic or stochastic modes and naturally scales to any number of denoising steps. This is the first time that a physics-informed approach has been applied in a denoising model of this type, the first that is explainable, and the first to feature deterministic generation. The result outperforms the current state-of-the-art while using ten times fewer steps. In addition, we demonstrate a proof-of-concept guided technique that permits targeted generation.

To build a useful tool, we need to generate molecule conformers that are physically meaningful. The naive approach is to directly train a generic, implicit model of physical viability. A drawback is that the number of possible drug-like compounds is too large (by some estimates, as large as \(10^{33}\)) to cover in a dataset. Another issue is that the number of viable conformations for each drug-like molecule is intractable in many cases . Therefore, we are forced to limit ourselves to a suitable approach that can readily transfer to molecules and conformations outside a training set.

The first step is to define what constitutes a viable conformer. We use physics as a guide. To appreciate what constitutes a local minima in molecular energy, consider classic force field parameterizations, an established methodology . Force fields are commonly formulated as the sum of "bonded" and "nonbonded" contributions [19; 20; 21]. The former include contributions associated with intramolecular bonds and the latter captures longer-distance interactions. The bonded contributions in a classical force field are conventionally divided into four terms: bonds, bends, proper torsions and improper torsions [19; 20; 21]. Each term is identified with a subgraph of a specific topology and one characteristic scalar parameter (Fig 1). These terms will become important in the construction of our model.

In the context of classical force fields, the set of viable molecule conformers are commonly defined in terms of fixed bond lengths, bond angles, and improper torsions. The constraint on proper torsions is cyclic in the angle \(\) such that energy is commonly parameterized as a function of \(n-_{0}\), where \(n\) is an integer and \(_{0}\) is a reference angle. The freedom to select one of \(n\) torsion angles is one way a molecule can exhibit multiple conformations. We will refer to such freedom as _torsional space_.

Nonbonded contributions to energies depend on external conditions, such as whether the molecule is solvated or bound to a protein . As such, in many applications, nonbonded energies are ignored or attenuated during the process of conformer generation, to avoid biases . We employ this strategy in this work. It can be considered adequate for tools that perform their own search in torsional space, such as flexible ligand docking [24; 25; 26; 27; 28].

In addition to locating energy minima, a useful conformer generator must respect stable stereochemistry, specifically chirality  and cis-trans isomerism .

### Related Works

Conventional approaches use a variety of schemes [4; 5; 6; 7; 8; 9; 24]. Balloon  is a conformer generator based on a multiobjective genetic algorithm. ETKDGv3  is a knowledge-based generator provided by RDKit  based on distance geometry. The OMEGA toolkit [7; 32] employs a fragment library combined with rules-based sampling. Although widely adopted, conventional methods rely on hand-tuned algorithms and are typically limited in accuracy due to an overdependence on classical force fields parameterization.

Several strategies have been employed for learned models, such as energy gradients [33; 34; 35], Gibbs sampling , and conditional variational encoders [37; 38]. The drawback of these approaches is that the energy of disordered molecule systems is difficult to characterize directly due to singularities and large energy barriers. GeoMol  learns local structure and applies incremental construction. Since incremental construction is poorly suited to cycles, it fails to reproduce all but the simplest ring systems. GeoDiff  is a state-of-the-art stochastic diffusion model. It follows conventions most closely related to "denoising diffusion probabilistic models" (DDPM) , employs 793,858 weights and uses 5,000 steps for generation. GeoDiff attempts to model nonbonded distances which requires it to sample torsional space during training. This is not only undesirable (since torsional space is physically ambiguous) but is also likely the reason for a high level of computational complexity.

Others have proposed methods that generate novel molecules in 3D space [41; 42; 43; 44; 45; 46], which is a related but different task than reported here.

Figure 1: Force fields typically include bonded terms associated with (a) bond lengths, (b) bend angles, (c) proper torsions, and (d) improper torsions.

Model Design

Our goal is to construct a model that can generate acceptable conformers for any drug-like molecule when provided with just the atom composition, connectivity, and stereochemistry. Recent work  has demonstrated that the design of diffusion-based models for images can be generalized around the concept of denoising score matching . We apply this approach to conformer generation by representing our model as a denoising function \(D\) that provides an estimate of the true coordinates \(\) of a molecule when provided with coordinates that have been smeared by a centered, uncorrelated Gaussian of width \(\)

\[ D((;0,^{2}),;)\,,\] (1)

where \(\) is a suitable embedding that represents the composition of the molecule (_i.e._ its atom types and connectivity).

The overall structure of the model is shown in Fig 2 and consists of two major components: a graph transformer network to build a useful atom embedding and a series of bonded subcomponents whose outputs are summed together for coordinate prediction.

The purpose of the graph transformer network is to place the atoms of each molecule into a suitably descriptive embedding space that can be employed by the bonded components. It starts with a embedding in which atoms are distinguished by their element, formal charge, and hybridization. The latter is taken from the algorithm built into the RDKit cheminformatics library . All hydrogens are treated as explicit. Atoms that are associated with explicit chirality or cis-trans isomerisms are flagged by the addition of a global vector reserved for this purpose.

The initial atom embedding is refined by multiple layers of a graph transformer network, based on GATv2 , and configured to use bonds as graph edges. No edge labeling (such as bond order) is employed, since connectivity along with atom identity is sufficient to describe relevant chemistry . To preserve a form of atom self-identity, rather than use self edges (a poor physical analog), the input to the graph attention network is concatenated to the output.

Each of the bonded components have a similar structure in which a multilayer perceptron (MLP) is used to calculate a correction to atom positions as a displacement along a vector. The details, outlined in the supplemental materials, are summarized here. For the bond component, the vector is the difference \(_{ij}\) of the two atom positions. The input to the MLP is the concatenation after a suitable normalization of \(\{|_{ij}|,,_{i},_{j}\}\), where \(\) are the atom embeddings.

For the bend component, the vector \(_{ik}\) is between the two outer atoms. The MLP is fed \(\{|_{ik}|,,_{i},_{j},_{k},_{ijk}\}\), where \(_{ijk}\) is a embedding capturing the size of the rings (if any) to which the bend belongs. The latter is important because the GATv2 graph network, like all message passing networks, is incapable of detecting cycles .

For the proper torsion component, the vector \(_{il}\) is between the two outer atoms. The MLP is fed \(\{|_{il}|,,_{i},_{j},_{k},_{l}, ,\}\). The torsional angle \(\) is needed to account for torsional space.

Figure 2: A schematic of the denoising model.

The chirality component is constructed out of the improper torsions associated with each chiral atom. The vector is the normal of the plane defined by three of the four atoms. The MLP is fed \(\{d_{},d_{},,_{i},_{j},_{k},_{l}\}\), where \(d_{}\) (\(d_{}\)) is the distance of the fourth atom out of (along) the plane. The cis-trans component is constructed out of the proper torsions associated with each constrained bond. The vector is the difference \(_{ijkl}\) between the average positions of the outer and inner atoms. The MLP is fed \(\{|_{ijkl}|,_{ijkl},,_{i},_{j},_{k},_{l}\}\), where \(_{ijkl}\) is the requested cis-trans state.

For the models reported here, an atom embedding of dimension 50 is used throughout. Four graph transformer layers are employed. The MLP for each component uses two hidden layers. The result is a model with a total of 135,080 weights, with 63,480 reserved for the molecule graph and 71,240 in the geometry components. Experiments in increasing the atom embedding dimension or adding additional transformer layers produced only marginal improvement in loss.

## 3 Datasets

We are interested in high-quality conformers of drug-like molecules. Two synthetic, publicly available datasets fit this role: QMugs  and GEOM-drugs . Each contain several hundred thousand drug-like molecules with conformers optimized (in vacuum) using the GFN2-xTB semiempirical quantum mechanical method [53; 54]. We discard about 2% of the GEOM-drugs molecules due to conformer inconsistency at the graph level. Otherwise, we accept all conformers in both data sets. Both are randomly divided into their own training (80%), validation (10%), and test (10%) subsets.

To measure molecule similarity, we use the Tanimoto measure applied to an ECFP6 fingerprint  folded to 1024 bits. At a threshold of 0.9 (0.8), we find 5.6% (6.4%) of the compounds in QMugs overlap with those in GEOM-drugs. Although the two datasets contain mostly different molecules, the underlying physics will be the same. To test dataset independence, we have chosen to train two versions of our model on the two corresponding training subsets, which we will label PIDM[Qmugs] and PIDM[GEOM-drugs]. Both models and others will be compared to a single benchmark dataset, whose preparation is described below.

For the benchmark dataset, we started from the QMugs test subset. To ensure independence and guard against data leakage, we filter each molecule against the contents of the QMugs training subset, the entire GEOM-drugs dataset, and internally using a Tanimoto threshold of 0.7. The annotated chirality and cis-trans isomerism are then validated against the public PubChem database . We also queried PubChem for a copy of the first ten of their generated conformers  for comparison. Molecules that could not be validated or did not have a PubChem conformer were discarded. The final result is 15,763 fully annotated, independent molecules reserved for benchmarks.

## 4 Training

In this work, we follow the modular scheme for diffusion-based models as proposed by Karras et al.  in which training and generation are separate tasks that need not share the same noising schedule. For the purposes of training, we chose to evenly sample from the set \(\{_{1}_{N}\}\):

\[_{i}=(_{}^{1/}+( _{}^{1/}-_{}^{1/}))^{}&1 i<N\\ 0&i=N\,.\] (2)

The total loss \(\) is calculated as the weighted sum of the contribution from each sample \(_{i}\)

\[=_{i=1}^{N}^{2}+^{2}}} (_{i})\] (3)

with

\[()=_{,( 0,^{2})}\|(+,)-\|_{2}^{2}\,.\] (4)

Standard parameter values are \(N=100\), \(_{}=8\)A, \(_{}=10^{-5}\)A, \(=10^{-5}\)A, and \(=6\).

PIDM[Qmugs] is trained using a fixed schedule of 100 epochs, taking approximately 50 hours on a single RTX 3090 (Fig. 3a). PIDM[GEOM-drugs] is trained using a fixed schedule of 25 epochs, taking approximately 170 hours (Fig. 3b).

Building the model with explicit components has the advantage of explainability. Once provided with an example molecule, each of the bonded compounds can be probed for specific atoms, a process that was invaluable during development. An example is shown in Fig 4. More examples are included in the supplemental materials.

## 5 Generation

We adopt a score-based, probability-flow framework  in order to generate conformers from our denoising model. As is typical in this approach, we consider a multidimensional Wiener process applied to molecule coordinates \(\) over a time interval \(t\):

\[p_{t}((t)|;(t))=((t);,(t)^{2} )\,,\] (5)

where \((t)\) are the resulting random coordinates and \((t)\) is a width schedule we are free to choose to suit our task, with the only requirement that \(_{t 0}(t)=0\). For generation, we start by sampling from a random Gaussian distribution \((0,(1)^{2})\) as an approximation for \((1)\) and solve for the corresponding reverse process (denoising) to obtain \((0)\) as a candidate solution for \(\).

To construct a solution for the reverse process, we identify the marginal distribution \(p(;)\) as

\[p(;)= p_{t}(|;)\;p()\;d\,,\] (6)

where the \(t\) dependence is implicit and \(p()\) represents the marginal distribution of the training data. We can use \(p(;)\) to express the time dependence of \(\) as a _probability-flow_ ODE :

\[d=-\;_{y} p(;)\;dt\,,\] (7)

Figure 4: Example bend correction from (a) PIDM[QMugs] and (b) PIDM[GEOM-drugs] for an atom involved in the ethanol group of adrenaline. Corrections for various values of \(\) are plotted. The vertical gray line is the expected atom distance, obtained from a separate GFN2-xTB optimization. As the distance deviates from expectations, the model applies larger corrections. As \(\) approaches zero, the correction vanishes once the correct geometry is achieved. Despite being trained on independent data sets, the two models learn a similar behavior.

Figure 3: Loss per conformer as calculated during model training for (a) QMugs and (b) GEOM-drugs. Plotted are losses calculated for the training set and for an independent validation set of \(1/8\) the size.

where \(_{y} p(;)\) is the _score function_ and \(\) is the time derivative. In a score-based framework, there is a direct relationship between the score function and our denoising model \(D\)[16; 47]:

\[_{y} p_{t}(;)}(D(, )-)\,.\] (8)

This important result connects our denoising model to the conformer generation process.

In our implementation, we have selected a linear function \((t)= t\), where \(\) is a scale parameter in units of A. Applying this selection to Eq. 7 and 8 results in a simple form for the probability-flow ODE:

\[}{dt}=(-D(; t))/t\,.\] (9)

Our conformer generation process is the numerical solution to this equation, calculated in steps of \(t\) in reverse, and using as initial conditions \((1)(0,^{2})\).

Inspired by work elsewhere , we solve Eq. 9 using Heun's 2nd-order method, augmented by a form of backtracking (Algorithm 1). The backtracking provides an option to add additional noise to the generation process. We begin by dividing the interval \(\) into a fixed partition \(\{t_{i}\}\) over which we iterate in order to calculate a set of intermediate solutions \(\{_{i}\}\). Instead of relying on solving on the partition \(\{t_{i}\}\), we substitute modified values for the upper bound \(t_{i}\) of each subinterval:

\[_{i}= t_{i}}_{i}(_{i};0, ^{2}^{2}t_{i}^{2}(^{2}-1))\,,\] (10)

where \( 1\) and \( 0\) are fixed parameters. This has the effect of introducing Gaussian noise at each step of the solution. For \(=1\), the amount of added noise compensates for the change in subinterval size.

```
1:procedureGenerate(\(D(,)\), \(\{t_{i}\}\), \(\), \(\), \(\))
2:\((0,^{2})\)\(\) Prepare random initial state
3:for\(i 1\) to \(|t|\)do
4:\( t_{i}\)\(\) Widen effective subinterval
5:\(}(;0,^{2}^{2}t_{i}^{2}( ^{2}-1))\)\(\) Add noise
6:\(_{1}(}-D(}, t))/\)\(\) Evaluate \(d/dt\)
7:\(}+(t_{i+1}-)_{1}\)\(\) Solve
8:if\(t_{i+1}>0\)then
9:\(_{2}(-D(, t_{i+1}))/t_{i+1}\)\(\) Apply 2nd-order correction
10:\(}_{i}+(t_{i+1}-)(_{1}+ _{2})\)\(\) Remove center of mass
11:\(-\)\(\) Remove center of mass
12:return\(\) ```

**Algorithm 1** Conformer generation.

For reasons of convenience, we remove an overall center-of-mass during each generation step. The correction is small and quality of output is not affected.

If we generate using \(=0\), no noise is added during the intermediate steps, resulting in deterministic generation. Combined with \(>0\), the algorithm is equivalent to pretending that each intermediate value \(_{i}\) belongs to a solution sampled from a larger value of \(\). This has the effect of overcorrecting, which improves accuracy in our case.

Alternatively, if we generate using \(>0\) and \(>0\), we inject noise during each step for stochastic generation. Both stochastic and deterministic approaches have been used for image generation, with impressive results [10; 11; 12; 13; 16; 57; 58; 59].

To apply our algorithm, we use the partition \(\{t_{1} t_{N}\}\) of a given size \(N\) and final step size \(t_{}\):

\[t_{i}=t_{}^{i/(N-1)}&1 i<N\\ 0&i=N\,.\] (11)

The quality of generated output is reasonably stable for a large range of parameter values. The results reported here use \(t_{}=0.0006\), \(=2.5\) A, and \(=5\). Quality improves marginally if the solution is calculated using more steps at a proportional cost in processing time. To quantify this trade off, we report on results for \(N=100\), 200, and 500. We also report results for both deterministic (\(=0\)) and stochastic (\(=1\)) generation.

Shown in Fig 5 are random examples of generated conformers, using PIDM[QMugs], deterministic generation, and 500 steps. More examples are available in the supplemental materials.

## 6 Experiments

Our objective is to generate molecules with valid bonded geometry. To demonstrate accuracy, ten random conformers were generated by PIDM[QMugs] and PIDM[GEOM-drugs] for each of the molecules in the benchmark set. Each result was compared against the ground truth represented by the corresponding conformers in QMugs. Overall errors in bond length \(d\) and bend angle \(\) were measured using the mean absolute deviation (MAD). Because proper torsions have multiple favored values, the MAD for \(\) was limited to values generated with \( 30^{}\) of the angle found in the reference conformer. Failures to reproduce the desired chirality or cis-trans isomerism were recorded as a fraction of total occurrence of associated improper or proper torsion.

Results are shown in Table 1. Also shown are results obtained from other conformer generation solutions. In all cases, ten conformers were requested, although some conformer solutions provide less than the requested number under certain circumstances. The conformers provided by PubChem are calculated under the PubChem3D scheme  based on the OMEGA toolkit . ETKDGv3 has known deficiencies and is often followed by gradient optimization based on the MMFF94 force field [6; 21]. We used the GeoMol checkpoint (GEOM-drugs) provided by the authors.

We tested the GeoDiff checkpoint trained on GEOM-drugs provided by the authors. This model performs well on \(d\) and \(\), but struggles with \(\). GeoDiff has no mechanism for enforcing chirality

Figure 5: Example conformer output for molecules randomly selected from the benchmark dataset. Shown in the second column from the left (grey background) is the first conformer from QMugs. Shown on the right are unfiltered output from PIDM[QMugs] using deterministic generation and 500 steps. All molecule renderings are oriented by principal component.

nor cis-trans isomerism, an omission that appears to be an oversight rather than a limitation of the approach.

## 7 Guided Generation

Our model makes no attempt to predict distances between nonbonded atoms. This suggests that there are degrees of freedom available during generation that are being ignored. Addressing this deficiency could provide a valuable measure of control over the torsional space.

Before experimenting, we require a control. The torsional space sampled in the synthetic QMugs and GEOM-drugs data sets were established by their authors based on explicit yet arbitrary criteria, which makes them uninteresting. Instead, we can refer to experimental data. The authors of the OMEGA toolkit selected two small experimental sets for this purpose : 480 molecules from the Cambridge Structural Database (CSD) and 197 ligands from the PDB. As shown in Table 2, RMSD performance of our model lags that obtained from OMEGA and RDKit+MMFF94.

Consider a modified, probability-flow ODE:

\[}{dt}=(-D(; t)-F())/t\,,\] (12)

where \(F()\) is introduced to guide generation in a desired fashion. Solving for Eq. 12 in place of Eq. 9 provides a mechanism for guided generation where \(F()\) serves as a form of conditional score .

As a simple proof-of-concept, consider \(F()=(b^{2}+^{2})^{-5}\), summed over all nonbonded atom pairs, where \(\) is the distance between atoms, \(b=0.7\)A, and \(\) is an overall magnitude. This term is analogous to a repulsive force similar to what is found in the van der Waals interaction. The result is a modest improvement in RMSD statistics on the CSD and PDB experimental data sets, as shown in Table 2. Statistics on bond parameters (Table 1) are largely unaffected, with the notable exception of an increase in chirality failure rates.

   & &  &  \\   & & \(d\) (Å) & \(\) (rad) & \(\) (rad) & chirality & cis-trans \\  PIDM[Qmugs] & & & & & & \\ Deterministic & 100 & \(0.0042\) & \(0.015\) & \(0.036\) & \(0.031\) & \(0.033\) \\ Deterministic & 200 & \(0.0038\) & \(0.013\) & \(0.027\) & \(0.022\) & \(0.009\) \\ Deterministic & 500 & \(0.0036\) & \(0.012\) & \(0.023\) & \(0.013\) & \(0.002\) \\ Deterministic & 500, \(=0.5\) & \(0.0035\) & \(0.012\) & \(0.025\) & \(0.028\) & \(0.001\) \\ Deterministic & 500, \(=1\) & \(0.0036\) & \(0.012\) & \(0.026\) & \(0.057\) & \(0.001\) \\ Stochastic & 100 & \(0.0051\) & \(0.021\) & \(0.079\) & \(0.112\) & \(0.027\) \\ Stochastic & 200 & \(0.0047\) & \(0.019\) & \(0.069\) & \(0.081\) & \(0.013\) \\ Stochastic & 500 & \(0.0045\) & \(0.018\) & \(0.062\) & \(0.057\) & \(0.004\) \\  PIDM[GEOM-drugs] & & & & & & \\ Deterministic & 100 & \(0.0044\) & \(0.015\) & \(0.034\) & \(0.031\) & \(0.034\) \\ Deterministic & 200 & \(0.0040\) & \(0.013\) & \(0.027\) & \(0.023\) & \(0.015\) \\ Deterministic & 500 & \(0.0037\) & \(0.012\) & \(0.023\) & \(0.015\) & \(0.005\) \\ Deterministic & 500, \(=0.5\) & \(0.0036\) & \(0.012\) & \(0.025\) & \(0.029\) & \(0.002\) \\ Deterministic & 500, \(=1\) & \(0.0036\) & \(0.012\) & \(0.025\) & \(0.048\) & \(0.003\) \\  Pubchem3D (OMEGA) & \(0.0075\) & \(0.020\) & \(0.020\) & \(0.020\) & \(0.014\) \\ ETKDGv3 & \(0.0183\) & \(0.039\) & \(0.019\) & \(0.049\) & \(0.017\) \\ ETKDGv3+MMFF94 & \(0.0081\) & \(0.017\) & \(0.021\) & \(0.049\) & \(0.017\) \\ Balloon & \(0.0082\) & \(0.018\) & \(0.032\) & \(0.002\) & \(0.011\) \\ GeoMol & \(0.0125\) & \(0.030\) & \(0.042\) & \(0.032\) & \(0.087\) \\ GeoDiff & \(0.0051\) & \(0.017\) & \(0.170\) & \(0.500\) & \(0.263\) \\  

Table 1: Performance data for PIDM[QMugs] and PIDM[GEOM-drugs] for 100, 200 and 500 steps, using both deterministic and stochastic schemes, and with optional guided generation (\(>0\), see section 7). Also shown are other methods. All statistics are measured against a single, independent benchmark dataset. Best values in each category are highlighted.

## 8 Discussion

The PIDM[QMugs] and PIDM[GEOM-drugs] models, despite being trained on datasets with little overlap, perform similarly on all benchmarks. Probes indicate that both models have learned similar solutions. We contend that this level of robustness could only have been achieved by capturing the important, underlying physics. Unlike conventional approaches to conformer generation, which either rely on curated template libraries or manually-tabulated force field parameterizations, the physics in our model is entirely learned.

PIDM is explainable. The advantage this provides cannot be overstated. The ability to probe the internal structure during development permitted a level of experimentation that would not have been possible in a black-box implementation.

For generation, we numerically solve for the probability-flow ODE, using a form of oversampling. By separating the training and generation tasks, we were free to explore multiple approaches without retraining. Using deterministic generation, we were able to produce conformers of reasonable quality in as little as 100 steps. This is in stark contrast with GeoDiff , the current state-of-the-art diffusion model, which employs stochastic generation in 5,000 steps.

For reproducing bonded parameters, PIDM with 500 steps has comparable performance on average to conventional methods (such as OMEGA and ETKDGv3). It outperforms GeoDiff with 1/6 the number of weights.

### Limitations

Conformer generation for molecules with chemical groups or atom types outside the training set may perform poorly or fail. Molecules with certain challenging topologies, such as a central ring with several large branches, may perform poorly (an example is given in the supplemental materials). Conformer quality is expected to degrade as molecules grow in size beyond \(\)200 heavy atoms.

The atom embedding used in our model was generated using GATv2 . We suspect that using a type of graph network that can capture the same quality of atom-type information while also recognizing cycles would improve performance.

## 9 Conclusion

Presented is PIDM, a diffusion-based model inspired by the bonded components of classical force fields. Parameters were trained on high-quality conformers from the QMugs and GEOM-drugs data sets. Learning appears robust, transferable, and explainable. Both deterministic and stochastic generation schemes are demonstrated. Average performance on the reproduction of bonded parameters is comparable to conventional conformer generation tools. A simple example of guided generation is successful at improving torsional sampling when compared to experimental data.

   & &  &  \\  Model & & N & Mean & Median & Mean & Median \\  PIDM[QMugs] & Undirected & 1000 & 0.74 & 0.84 & 0.90 & 0.98 \\ PIDM[QMugs] & \(=0.5\) & 1000 & 0.53 & 0.58 & 0.70 & 0.75 \\ PIDM[QMugs] & \(=1\) & 1000 & 0.51 & 0.55 & 0.67 & 0.73 \\  PIDM[GEOM-drugs] & Undirected & 1000 & 0.78 & 0.91 & 0.96 & 1.10 \\ PIDM[GEOM-drugs] & \(=0.5\) & 1000 & 0.54 & 0.59 & 0.81 & 0.81 \\ PIDM[GEOM-drugs] & \(=1\) & 1000 & 0.51 & 0.55 & 0.69 & 0.76 \\  OMEGAa & & — & 0.51 & 0.44 & 0.67 & 0.51 \\ RDKit+MMFF94 & & 1000 & 0.43 & 0.48 & 0.53 & 0.64 \\  

* Published statistics 

Table 2: RMSD statistics (Å, heavy atoms only) on conformers generated by PIDM (deterministic with 500 steps) and various other methods compared to experimental data from the CSD and PDB. Mean and median are calculated on the closest conformer out of \(N\) generated.