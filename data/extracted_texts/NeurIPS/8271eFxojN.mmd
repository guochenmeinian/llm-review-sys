# Identifiability Analysis of Linear ODE Systems with Hidden Confounders

Yuanyuan Wang

The University of Melbourne

yuanyuanw2@student.unimelb.edu.au

&Biwei Huang

University of California, San Diego

bih007@ucsd.edu

&Wei Huang

The University of Melbourne

wei.huang@unimelb.edu.au

&Xi Geng

The University of Melbourne

xi.geng@unimelb.edu.au

&Mingming Gong

The University of Melbourne

mingming.gong@unimelb.edu.au

Corresponding author.

###### Abstract

The identifiability analysis of linear Ordinary Differential Equation (ODE) systems is a necessary prerequisite for making reliable causal inferences about these systems. While identifiability has been well studied in scenarios where the system is fully observable, the conditions for identifiability remain unexplored when latent variables interact with the system. This paper aims to address this gap by presenting a systematic analysis of identifiability in linear ODE systems incorporating hidden confounders. Specifically, we investigate two cases of such systems. In the first case, latent confounders exhibit no causal relationships, yet their evolution adheres to specific functional forms, such as polynomial functions of time \(t\). Subsequently, we extend this analysis to encompass scenarios where hidden confounders exhibit causal dependencies, with the causal structure of latent variables described by a Directed Acyclic Graph (DAG). The second case represents a more intricate variation of the first case, prompting a more comprehensive identifiability analysis. Accordingly, we conduct detailed identifiability analyses of the second system under various observation conditions, including both continuous and discrete observations from single or multiple trajectories. To validate our theoretical results, we perform a series of simulations, which support and substantiate our findings.

## 1 Introduction

Understanding the dynamics of systems governed by Ordinary Differential Equations (ODEs) is fundamental in various scientific disciplines, from physics [9; 23; 24; 47], biology [16; 27; 29; 33; 36] to economics [13; 38; 39; 43]. These ODE systems provide a natural framework for modeling causal relationships among system variables, enabling us to make reliable interpretations and interventions [25; 30; 31]. Central to unraveling the causal mechanisms of such systems is the concept of identifiability analysis, which aims to uncover conditions under which system parameters can be uniquely determined from error-free observations. Identifiability is crucial for ensuring reliable parameter estimates, thereby guaranteeing reliable causal inferences about the system . The motivation for our research on the identifiability analysis of ODE systems arises from the necessity of making reliable causal inferences about these systems.

Our research focuses on the homogeneous linear ODE system, represented as:

\[}(t)=A(t)\,,(0)=_{0}\,,\] (1)

where \(t[0,)\) denotes time, \((t)^{d}\) represents the system's state at time \(t\), \(}(t)\) denotes the first derivative of \((t)\) w.r.t. time, and \(_{0}\) represents the initial condition of the system. The solution (trajectory) of the system, denoted as \((t;_{0},A)\) for \(t[0,)\), is a single \(d\)-dimensional trajectory initialized with \(_{0}\).

Existing literature has extensively examined the identifiability of linear ODE systems under the assumption of complete observability, where all state variables are directly observable [5; 14; 15; 17; 28; 34; 42]. Specifically, researchers have investigated identifiability of the ODE system (1) from a single whole trajectory [28; 34], and extended analysis to discrete observations sampled from the trajectory . However, practical scenarios often entail systems with latent variables, rendering them not entirely observable. In this paper, we explore the identifiability analysis of this ODE system under latent confounders, particularly examining cases where no causal relationships exist from observable variables to latent variables, a commonly assumed condition in causality analysis with hidden variables [10; 11; 20; 22; 44; 45].

In this paper, we focus on two scenarios:

1. **Independent latent confounders:** Latent variables exhibit no causal relationships among themselves, leading to the following linear ODE system: \[}(t)\\ }(t)=A&B\\ &(t)\\ (t)+\\ (t)\,,(0)\\ (0)=_{0}\\ _{0}\,.\] (2)
2. **Causally related latent confounders:** Latent variables exhibit causal relationships among themselves, specifically, they follow a DAG structure, represented as: \[}(t)\\ }(t)=A&B\\ &G(t)\\ (t)\,,(0)\\ (0)=_{0}\\ _{0}\,.\] (3)

In these two ODE systems, \((t)^{d}\) denotes the state of observable variables \(=(x_{1},x_{2},,x_{d})\), while \((t)^{p}\) denotes the state of latent variables \(=(z_{1},z_{2},,z_{p})\). Example causal structures of these two ODE systems are illustrated in Figure 1. It is noteworthy that the structure may include cycles and self-loops within the observable variables. Additionally, two real-world examples are provided in Appendix B.

This paper provides an identifiability analysis for the ODE system (2) under specific latent variable evolutions, such as polynomial functions of time \(t\). Additionally, we conduct a systematic identifiability analysis of the ODE system (3) when the causal structure of the latent variables can be described by a DAG.

## 2 Background

### Causal interpretation of the ODE system

When an ODE system describes the underlying causal mechanisms governing a dynamic system, it provides a natural framework for modeling causal relationships among system variables. The causal

Figure 1: Example causal structures of the ODE system (2) and (3).

structure inherent in such systems can be directly read off . For instance, in the ODE system (1), where the \(ij\)-th entry of the parameter matrix \(A\) is denoted as \(A_{ij}\), the presence of \(A_{ij} 0\) signifies that the derivative of \(x_{i}(t)\) is influenced by \(x_{j}(t)\), thus indicating a causal link from \(x_{j}\) to \(x_{i}\). Here, \(x_{i}\) denotes the \(i\)-th variable of the ODE system (1), and \(x_{i}(t)\) represents its state at time \(t\). Since the right hand side of the ODE system (1) does not explicitly depend on time \(t\), the causal structure of this ODE system is time-invariant.

An essential prerequisite for reliably inferring the causal structure and effects of an ODE system, for purposes of interpretation or intervention, is the identifiability analysis of such systems. To underscore this necessity, we provide an illustrative example. Consider the ODE system (3). Set

\[_{0}=1\\ 1\,,\ \ _{0}=1\\ 1\,,\ \ B=1&1\\ 1&1\,,\ \ G=0&1\\ 0&0\,,\]

\[A=1&0\\ 0&1\,,\ \ A^{}=0&1\\ 1&0\,,\ \ M=A&B\\ &G\,,\ \ M^{}=A^{}&B\\ &G\,.\]

Calculations reveal that the solutions (trajectory) of the ODE system (3) with parameter matrices \(M\) or \(M^{}\) are identical, i.e.,

\[(t)\\ (t)=e^{Mt}_{0}\\ _{0}=e^{M^{}t}_{0}\\ _{0}\,.\]

This indicates that using observations sampled from this trajectory to estimate parameter matrix \(M\) may end up yielding \(M^{}\), which exhibits a fundamentally distinct causal relationship between \(x_{1}\) and \(x_{2}\), see Figure 2.

This discrepancy in parameter estimation, wherein \(M^{}\) is obtained instead of the true underlying parameter matrix \(M\), may lead to misleading interpretations and causal inferences, potentially influencing decision-making, particularly regarding interventions. For instance, intervention with \(x_{1}(t)=1\), under the true underlying parameter matrix \(M\), yields the trajectory \(x_{2}(t)=4e^{t}-t-3\) (post-intervention), whereas under matrix \(M^{}\), the trajectory becomes \(x_{2}(t)=t^{2}/2+3t+1\) (post-intervention). Detailed calculations are provided in Appendix C.

### Identifiability analysis of the linear ODE system (1)

The identifiability analysis of the ODE system (1) has been well studied. Here, we present a fundamental definition and theorem essential for understanding identifiability in the ODE system (1). Denoting its solution as \((t;_{0},A)\), it is noteworthy that the system is fully observable, without latent variables interacting with it. We present the identifiability definition and theorem as follows.

**Definition 2.1**.: _For \(_{0}^{d},A^{d d}\), the ODE system (1) is said to be \((_{0},A)\)-identifiable, if for all \(^{}_{0}^{d}\) and all \(A^{}^{d d}\), with \((_{0},A)(^{}_{0},A^{})\), it holds that \((;_{0},A)\)\((;^{}_{0},A^{})\).2_

**Lemma 2.1**.: _For \(_{0}^{d},A^{d d}\), the ODE system (1) is \((_{0},A)\)-identifiable if and only if condition **A0** is satisfied._

**A0**: _the set of vectors \(\{_{0},A_{0},,A^{d-1}_{0}\}\) is linearly independent._

Figure 2: Causal structures of the ODE system (3) with parameter matrix \(M\) and \(M^{}\).

Definition 2.1 and Theorem 2.1 are adapted from [42, Definition 1] and [42, Lemma2]. We use \(_{0}^{}\) and \(A^{}\) to distinguish other system parameters from the true system parameters \(_{0}\) and \(A\); \(_{0}^{}\) and \(A^{}\) can represent any \(d\)-dimensional initial conditions and any \(d d\) parameter matrices, respectively. Here instead of describing a collective property of a set of systems, we describe an intrinsic property of a single system with parameters (\(_{0},A\)). In practice, the aim is to ascertain whether the true underlying system parameter (\(_{0},A\)) is uniquely determined by observations. Hence, (\(_{0},A\))-identifiability offers a more intuitive description of the identifiability of the ODE system from a practical perspective.

From a geometric perspective, condition **A0** stated in Lemma 2.1 indicates that the initial condition \(_{0}\) is not contained in an \(A\)-invariant **proper** subspace of \(^{d}\). Intuitively, this means the trajectory of this system started from \(_{0}\) spans the entire \(d\)-dimensional state space. That is, our observations cover information on all dimensions of the state space, thus rendering the identifiability of the system. Additionally, condition **A0** is generic, as noted in , meaning that the set of system parameters violating this condition has Lebesgue measure zero. Thus, condition **A0** is satisfied for almost all combinations of \(_{0}\) and \(A\).

## 3 Identifiability analysis of the linear ODE system (2)

In this section, we present the identifiability condition for the linear ODE system (2). We consider the function \((t)\) in (2) as a specific function of time \(t\). Here we first define \((t)\) as a \(r\)-degree polynomial function of time \(t\), expressed as follows:

\[(t)=_{k=0}^{r}_{k}t^{k}\,,\ \ _{k}^{p}\,.\] (4)

Simple calculations show that

\[(t)=_{k=0}^{r}_{k}}{k+1}t^{k+1}+_{0}\,.\]

Thus,

\[}(t)=A(t)+B(t)=A(t)+_{k=0}^{r}_ {k}}{k+1}t^{k+1}+B_{0}\,.\] (5)

We denote the unknown parameters of the ODE system (2) as \(\), specifically, \(:=(_{0},_{0},A,B,\{_{k}\}_{0}^{r})\), where \(\{_{k}\}_{0}^{r}\) denotes all the \(_{k}\)'s for \(k=0,,r\). Let \([^{T}(t;),^{T}(t;)]^{T}\) denote the solution of the ODE system (2). It is important to note that under our hidden variables setting, only \((t;)\) is observable. Based on Equation (5), we present the following identifiability definition.

**Definition 3.1**.: _For \(_{0}^{d},_{0}^{p},A^{d  d},B^{d p}\) and \(\{_{k}\}_{0}^{r}^{p}\), for all \(_{0}^{}^{d}\), all \(_{0}^{}^{p}\), all \(A^{}^{d d}\), all \(B^{}^{d p}\), and all \(\{_{k}^{}\}_{0}^{r}^{p}\), we denote \(^{}:=(_{0}^{},_{0}^{},A^{},B^{ },\{_{k}^{}\}_{1}^{r})\), we say the ODE system (2) is \(\)-identifiable: if \((_{0},A,B_{0},\{B_{k}\}_{0}^{r})(_{0}^{},A^{ },B^{}_{0}^{},\{B^{}_{k}^{}\}_{0}^{r})\), it holds that \((;)(;^{})\)._

In the ODE system (2), where only variables \(\) are observable, we will, with some terminological leniency, refer to \((;)\) as the trajectory of the ODE system (2) with parameters \(\). According to Definition 3.1, if the ODE system (2) with a polynomial \((t)\) is \(\)-identifiable, then the trajectory of the system can uniquely determine the values of \((_{0},A,B_{0},\{B_{k}\}_{0}^{r})\). This determination is sufficient to identify the causal relationships between observable variables \(\) as described by Equation (5). Consequently, one can safely intervene in the observable variables of the ODE system and make reliable causal inferences, despite the fact that matrix \(B\) cannot be identified under this definition.

**Theorem 3.1**.: _For \(_{0}^{d},_{0}^{p},A^{d d },B^{d p}\), \(\{_{k}\}_{0}^{r}^{p}\), the ODE system (2) is \(\)-identifiable if and only if assumption **A1** is satisfied._

* _the set of vectors_ \(\{,,,A^{d-1}\}\) _is linearly independent, where_ \(=A^{r+1}(A_{0}+B_{0})+_{j=0}^{r}j!A^{r-j}B_{j}\)_, and_ \(j!\) _denotes the factorial of_ \(j\)_._

The proof of Theorem 3.1 can be found in Appendix D.1. Condition **A1** is both sufficient and necessary, indicating, from a geometric perspective, that the vector \(\) is not contained in an \(A\)-invariant proper subspace of \(^{d}\)[34, Lemma 3.1].

The key point of the proof is the introduction of an augmented state \((t)=[^{T}(t),1,t,t^{2},,t^{r+1}]^{T}\) with a corresponding ODE system:

\[}(t)=A&B_{0}&B_{0}&&B _{r-1}/r&B_{r}/(r+1)\\ _{d}&0&0&&0&0\\ _{d}&1&0&&0&0\\ &&&&&\\ _{d}&0&0&&r+1&0}_{}(t)\,,\] (6)

\[(0)=[_{0}^{T},1,0,,0]^{T}:=_{0}\,,\]

where \(_{d}\) is a \(d\)-dimensional zero row vector, and matrix \(F^{(d+r+2)(d+r+2)}\). The ODE system (6) is a homogeneous linear ODE system analogous to (1) but with fully observable variables \(\). In other words, we transform our system of interest, (2), which includes hidden confounders, into a fully observable ODE system (6). This allows us to leverage existing identifiability results for homogeneous linear ODE systems, specifically Lemma 2.1, to derive the identifiability condition for the ODE system (2).

Based on this approach, if the state of the hidden variables \((t)\), as determined by the function \((t)\) in the ODE system (2), can be described by some linear combinations of observable functions of time \(t\), then the identifiability condition of the ODE system (2) can be derived. For an illustration, in the Appendix E, we provide identifiability conditions for the ODE system (2) when \((t)=e^{t}\) and \((t)=_{1}sin(t)+_{2}cos(t)\). While we do not enumerate all functions \((t)\) that meet this condition, our primary objective is to demonstrate a method for deriving the identifiability condition for the ODE (2) when the evolution of its hidden variables conforms to certain specific functions. Researchers can apply this approach to find appropriate functions \((t)\) according to their specific requirements.

## 4 Identifiability analysis of the linear ODE system (3)

In this section, we extend the identifiability analysis to linear ODE systems with causally related latent confounders. Specifically, we assume that the causal structure of latent variables satisfies the following latent DAG assumption.

_Latent DAG: the causal structure of latent variables can be described by a DAG._

The DAG assumption is commonly employed in causality studies [10; 11; 22; 26; 40; 44]. Under the latent DAG assumption, the matrix \(G\) can be permuted to be a strictly upper triangular matrix, i.e., an upper triangular matrix with zeros along the main diagonal [11; 19]. Without loss of generality, we set \(G\) as a strictly upper triangular matrix.

Since \(G\) is a strictly upper triangular matrix, by the Cayley-Hamilton theorem , \(G\) is a nilpotent matrix with an index \( p\). Consequently, \(G^{k}=0\) for all \(k p\).

Based on [34; 37], the solution of \((t)\) can be expressed as:

\[(t)=e^{Gt}_{0}=_{k=0}^{}_{0}}{k!}t^{k} =_{k=0}^{p-1}_{0}}{k!}t^{k}\,.\]

Thus,

\[}(t)=A(t)+B(t)=A(t)+_{k=0}^{p-1} _{0}}{k!}t^{k}\,.\] (7)

We observe that Equation (7) has the same function form as Equation (5), but with different coefficients (system parameters) for the polynomial of time \(t\). Therefore, the ODE system (3) under the latent DAG assumption can be considered a more complex version of the ODE system (2) when \((t)\) follows a polynomial function of time \(t\). Since the ODE system (3) incorporates causally related latent confounders, which is a more interesting and practical case, we will provide a more comprehensive identifiability analysis of the ODE system (3). The derived identifiability results can be easily generated to the case of the ODE system (2).

### Identifiability condition from a single whole trajectory

We denote the unknown parameters of the ODE system (3) as \(\), that is, \(:=(_{0},_{0},A,B,G)\). We further denote the solution of the ODE system (3) as \([^{T}(t;),^{T}(t;)]^{T}\); note that under our latent variables setting, only \((t;)\) is observable. Thus, based on Equation (7), we present the following identifiability definition.

**Definition 4.1**.: _For \(_{0}^{d},_{0}^{p},A^{d d },B^{d p}\) and \(G^{p p}\), under the latent DAG assumption, for all \(^{}_{0}^{d}\), all \(^{}_{0}^{p}\), all \(A^{}^{d d}\), all \(B^{}^{d p}\), and all \(G^{}^{p p}\), we denote \(^{}:=(^{}_{0},^{}_{0},A^{},B^{ },G^{})\), we say the ODE system (3) is \(\)-identifiable: if \((_{0},A,B_{0},BG_{0},,BG^{p-1}_{0})(^ {}_{0},A^{},B^{}^{}_{0},B^{}G^{}^{}_{0},,B^{}G^{ p-1}^{}_{0})\), it holds that \((;)\ (;^{})\)._

Similar to the case of the ODE system (2), we refer to \((;)\) as the trajectory of the ODE system (3) with parameters \(\). Definition 4.1 defines the identifiability of the ODE system (3) from a single whole trajectory \((;)\). Once the ODE system (3) is \(\)-identifiable, the causal relationships among the observable variables \(\) can be determined through Equation (7). We then establish the condition for the identifiability of the ODE system (3) based on Definition 4.1.

**Theorem 4.1**.: _For \(_{0}^{d},_{0}^{p},A^{d  d},B^{d p}\) and \(G^{p p}\), under the latent DAG assumption, the ODE system (3) is \(\)-identifiable if and only if assumption **B1** is satisfied._

* _the set of vectors_ \(\{,A,,A^{d-1}\}\) _is linearly independent, where_ \(=A^{p}_{0}+_{j=0}^{p-1}A^{p-1-j}BG^{j}_{0}\)_._

The proof of Theorem 4.1 can be found in Appendix D.2. Condition **B1** is both sufficient and necessary, and from a geometric perspective, it indicates that the vector \(\) is not contained in an \(A\)-invariant proper subspace of \(^{d}\)[34, Lemma 3.1].

### Identifiability condition from discrete observations sampled from a single trajectory

In practice, we often have access only to a sequence of discrete observations sampled from a trajectory rather than knowing the whole trajectory. Therefore, we also derive the identifiability conditions under the scenario where only discrete observations from a trajectory are available. Firstly, we extend the identifiability definition of the ODE system (3) as follows.

**Definition 4.2**.: _For \(_{0}^{d},_{0}^{p},A^{d  d},B^{d p}\) and \(G^{p p}\). For any \(n 1,\) let \(t_{j},j=1,,n\) be any \(n\) time points and \(_{j}:=(t_{j};)\) be the error-free observation of the trajectory \((;)\) at time \(t_{j}\). Under the latent DAG assumption, we say the ODE system (3) is \(\)-identifiable from \(_{1},,_{n}\), if for all \(^{}_{0}^{d}\), all \(^{}_{0}^{p}\), all \(A^{}^{d d}\), all \(B^{}^{d p}\), and all \(G^{}^{p p}\) with \((_{0},A,B_{0},BG_{0},,BG^{p-1}_{0})(^ {}_{0},A^{},B^{}^{}_{0},B^{}G^{} {z}^{}_{0},,B^{}G^{ p-1}^{}_{0})\), it holds that \( j\{1,,n\}\) such that \((t_{j};)(t_{j};^{})\)._

Definition 4.2 defines the identifiability of the ODE system (3) from \(n\) observations sampled from the trajectory \((;)\). Then we establish the condition for the identifiability of the ODE system (3) from discrete observations based on Definition 4.2.

**Theorem 4.2**.: _For \(_{0}^{d},_{0}^{p},A^{d  d},B^{d p}\) and \(G^{p p}\). We define new observation \(_{j}:=[^{T}_{j},1,t_{j},t_{j}^{2},,t_{j}^{p-1}]^{T}^{d+p}\), for \(j=1,,n\). Under the latent DAG assumption, the ODE system (3) is \(\)-identifiable from discrete observations \(_{1},,_{n}\), if and only if assumption **C1** is satisfied._

* _there exists_ \((d+p)\)__\(_{j}\)_'s with indices denoting as_ \(\{j_{1},j_{2},,j_{d+p}\}\{1,2,,n\}\)_, such that the set of vectors_ \(\{_{j_{1}},_{j_{2}},,_{j_{d+p}}\}\) _is linearly independent._

The proof of Theorem 4.2 can be found in Appendix D.3. Condition **C1** is both sufficient and necessary. This theorem states that as long as there are \(d+p\) observations \(_{j}\)'s such that the corresponding augmented new observations \(_{j}\)'s are linearly independent, the ODE system (3) is \(\)-identifiable from these discrete observations. Under the latent DAG assumption, we can transfer the ODE system (3), which includes hidden confounders, into a \((d+p)\)-dimensional fully observable ODE system (1) through the augmented state \((t)\). Condition **C1** indicates that our observations span the entire \((d+p)\)-dimensional state space, thus rendering the system identifiable.

Both Definition 4.1 and Definition 4.2 define the identifiability of the ODE system (3) to some extent of the unknown parameters. In other words, given the available observations, under Definition 4.1 and Definition 4.2, one can only identify the values of \((_{0},A,B_{0},B_{0},,BG^{p-1}_{0})\), but not the values of \((_{0},B,G)\). Based on Equation (7), this level of identifiability is sufficient to identify the causal relationships between observable variables \(\), enabling safe intervention on the observable variables with reliable causal inferences. However, in scenarios where practitioners can intervene in the latent variables and require inferring the causal effects of the intervened system, identifying the matrices \(B\) and \(G\) becomes essential for reliable causal references. For instance, in chemical kinetics, where the evolution of chemical concentrations over time can often be modeled by an ODE system [8; 12], some chemicals may not be measurable during the reaction, rendering them latent variables. Nonetheless, practitioners can intervene in these latent variables by setting specific initial concentrations. Therefore, we provide an identifiability analysis of the linear ODE system (3) when practitioners can control the initial condition of the latent variables: \(_{0}\).

### Identifiability condition from \(p\) controllable whole trajectories

Assuming the initial condition of the latent variables \(_{0}\) is controllable, which means that the values of \(_{0}\) can be treated as given values, we denote it as \(_{0}^{*}\). In the following, we provide the identifiability condition of the ODE system (3) when we are given \(p\) initial conditions \(_{0}^{*}\), denoting as \(_{0}^{*i}\). We first present the definition.

**Definition 4.3**.: _Given \(_{0}^{*i}^{p}\) for \(i=1,,p\), for \(_{0}^{d},A^{d d},B^{d p}\) and \(G^{p p}\), under the latent DAG assumption, for all \(_{0}^{}^{d}\), all \(A^{}^{d d}\), all \(B^{}^{d p}\), and all \(G^{}^{p p}\), we denote \(_{i}:=(_{0},_{0}^{*i},A,B,G)\) and \(_{i}^{}:=(_{0}^{},_{0}^{*i},A^{},B^{ },G^{})\), we say the ODE system (3) is \(\{_{i}\}_{1}^{p}\)-identifiable: if \((_{0},A,B,G)(^{},A^{},B^{},G^{})\), it holds that \( i\) such that \((;_{i})(;_{i}^{})\), \( i=1,,p\), and under this definition, matrix \(B\) and \(G\) are also identifiable. Based on this definition, we provide the identifiability condition.

**Theorem 4.3**.: _Given \(_{0}^{*i}^{p}\) for \(i=1,,p\), for \(_{0}^{d},A^{d d},B^{d p}\) and \(G^{p p}\), under the latent DAG assumption, the ODE system (3) is \(\{_{i}\}_{1}^{p}\)-identifiable if assumptions **B\({}_{2}\)**, **B\({}_{3}\)** and **B\({}_{4}\)** are all satisfied._

1. _each_ \(_{0}^{*i}\) _for_ \(i=1,,p\)_, satisfies assumption_ _B1_. That is, if we set_ \(_{i}=A^{p}_{0}+_{j=0}^{p-1}A^{p-1-j}BG^{j}_{0}^{*i}\)_, then the set of vectors_ \(\{_{i},A_{i},,A^{d-1}_{i}\}\) _is linearly independent for all_ \(i=1,,p\)_._
2. _the set of vectors_ \(\{_{0}^{*1},_{0}^{*2},,_{0}^{*p}\}\) _is linearly independent._
3. _the matrix composed by vertically stack the matrices_ \(\{B,BG,,BG^{p-1}\}\) _has rank_ \(p\)_._

The proof of Theorem 4.3 can be found in Appendix D.4. Assumption **B2** ensures that the ODE system (3) is \(_{i}\)-identifiable for all \(i=1,,p\). Consequently, \((_{0},A,B_{0}^{*i},BG_{0}^{*i},,BG^{p-1}_{0}^{*i})\) for all \(i=1,,p\) is identifiable. Then, under assumption **B3**, the identifiability of matrix \(B\) is established. To identify matrix \(G\), assumption **B4** is required. While the ability to control the initial condition of the latent variables may appear strict, it is a reasonable assumption in our context. This is because identifying matrices \(B\) and \(G\) is necessary only when practitioners can intervene in the latent variables, thereby allowing control over their initial conditions. An alternative approach to identifying \(B\) and \(G\) involves intervening in the initial condition of each latent variable \(z_{i}\) independently, rather than controlling the initial condition of all latent variables \(\) simultaneously. This method draws inspiration from the "genetic single-node intervention" proposed by , where one can intervene at each latent node individually. Further details of this method can be found in Appendix F.

### Identifiability condition from discrete observations sampled from \(p\) controllable trajectories

We also extend the identifiability analysis of the ODE system (3) to cases where only discrete observations from \(p\) controllable trajectories are available.

**Definition 4.4**.: _Given \(_{0}^{*i}^{p}\) for \(i=1,,p\), for \(_{0}^{d},A^{d d},B^{d p}\) and \(G^{p p}\). For any \(n 1\), let \(t_{j},j=1,,n\) be any \(n\) time points and \(_{ij}:=(t_{j};_{i})\) be the error-free observation of the trajectory \((;_{i})\) at time \(t_{j}\). Under the latent DAG assumption, we say the ODE system (3) is \(\{_{i}\}_{1}^{p}\)-identifiable from \(_{i1},,_{in}\), \(i=1,,p\), if for all \(_{0}^{}^{d}\), all \(A^{}^{d d}\), all \(B^{}^{d p}\), and all \(G^{}^{p p}\) with \((_{0},A,B,G)(_{0}^{},A^{},B^{},G^{})\), it holds that \( i\{1,,p\}\) and \(j\{1,,n\}\) such that \((t_{j};_{i})(t_{j};_{i}^{})\)._

Based on Definition 4.4 we present the identifiability condition.

**Theorem 4.4**.: _Given \(_{0}^{*i}^{p}\) for \(i=1,,p\), for \(_{0}^{d},A^{d d},B^{d p}\) and \(G^{p p}\). We define new observation \(_{ij}:=[_{ij}^{T},1,t_{j},t_{j}^{2},,t_{j}^{p-1}]^{T} ^{d+p}\), for \(i=1,,p\) and \(j=1,,n\). Under the latent DAG assumption, the ODE system (3) is \(\{_{i}\}_{1}^{p}\)-identifiable from discrete observations \(_{i1},,_{in}\), \(i=1,,p\), if assumptions **C2**, **B3** and **B4** are all satisfied._

* _for each_ \(i\{1,,p\}\) _there exists_ \((d+p)\)__\(_{ij}\)_'s with indexes denoting as_ \(\{j_{i1},j_{i2},,j_{i,d+p}\}\{1,2,,n\}\)_, such that the set of vectors_ \(\{_{ij_{i1}},_{ij_{i2}},,_{ij_{i,d+p}}\}\) _is linearly independent._

The proof of Theorem 4.4 can be found in Appendix D.5. Assumption **C2** ensures that the ODE system (3) is \(_{i}\)-identifiable from discrete observations \(_{i1},,_{in}\) for all \(i=1,,p\). As in Subsection 4.3, under assumptions **B3** and **B4**, the matrices \(B\) and \(G\) are also identifiable.

## 5 Simulations

To evaluate the validity of the identifiability conditions established in Section 3 and 4, we present the results of simulations. As previously indicated, the ODE system (3) can be treated as a more intricate version of the ODE system (2); hence, our simulation experiments are centered on the former.

**Simulation design.** We conduct four sets of simulations, which include one identifiable case and one unidentifiable case for both the \(\)-identifiable check and the \(\{_{i}\}_{1}^{p}\)-identifiable check. The dimensions of both observable variables, \(d\), and latent variables, \(p\), are set to 3. The true underlying parameters of the systems are provided below. Observations are simulated from the true ODE systems for each case, with \(n\) equally-spaced observations generated from the time interval \(\) for each trajectory, and we only keep the values of the observable variables \(\).

\[A=2&-2&1\\ 1&1&-1\\ 1&0&2,\;\;B=-2&-2&2\\ 0&-1&-2\\ -1&-1&-2\;,\;\;G=0&2&1\\ 0&0&-2\\ 0&0&0\,,\;\;A^{}=1&0&0\\ 0&1&0\\ 0&0&1\,,\]

\[_{0}=-1\\ 1\\ 1\,,\;\;\;_{0}=1\\ -2\\ -1\,,\;\;\;_{0}^{*1}=1\\ 0\\ 0\,,\;\;\;_{0}^{*2}=0\\ 1\\ 0\,,\;\;\;_{0}^{*3}=0\\ 0\\ 1\,.\]

\(\)-identifiable: \(=(_{0},_{0},A,B,G)\), unidentifiable: \(=(_{0},_{0},A^{},B,G)\).

\(\{_{i}\}_{1}^{p}\)-identifiable: \(_{i}=(_{0},_{0}^{*i},A,B,G),\) unidentifiable: \(_{i}=(_{0},_{0}^{*i},A^{},B,G),i=1,2,3\).

**Parameter estimation.** The Nonlinear Least Squares (NLS) method is employed for parameter estimation, a widely used technique for estimating parameters in nonlinear regression models, including ODEs . The _"least_squares"_ function from the _"scipy.optimize"_ Python module, with default hyperparameter settings, is utilized for implementation. Given that the NLS loss function for our simulation is non-convex, parameter initialization is performed near the true values to promote convergence to the global minimum. Specifically, for the \(\)-(un)identifiable cases, initial parameter values are set to the true parameters plus a random value drawn from a uniform distribution \(U(-0.1,0.1)\) for each replication. For \(\{_{i}\}_{1}^{p}\)-(un)identifiable cases, initial parameter values are set to the true values plus a random value from \(U(-0.3,0.3)\).

**Evaluation metric.** Mean Squared Error (MSE) is adopted as the metric to assess the accuracy of the parameter estimator. To ensure the reliability of the estimation results, 100 independent random replications are run for each configuration, and we report the mean and variance of the squared error.

**Results analysis.** Table 1 and Table 2 present the simulation results for the \(\)-(un)identifiable cases and the \(\{_{i}\}_{1}^{p}\)-(un)identifiable cases, respectively. According to Definition 4.1 and Definition 4.3, for the \(\)-(un)identifiable cases, the identifiability of \((_{0},A,B_{0},BG_{0},BG^{2}_{0})\) needs to be checked, while for the \(\{_{i}\}_{1}^{p}\)-(un)identifiable cases, we need to check the identifiability of \((_{0},A,B,G)\)Since \(_{0}\) is consistently identifiable (with MSE less than \(1.00\)E-\(10\)) across all (un)identifiable cases, its results are not presented.

In both Tables, for identifiable cases, as the number of samples \(n\) increases, the MSEs for all parameters of interest decrease and approach zero. However, in the unidenifiable cases, where the identifiability condition **B1/B2** stated in Theorem 4.1/4.3 is unmet, the MSEs for certain parameters remain high irrespective of sample size. These results offer strong empirical support for the validity of the identifiability conditions outlined in Theorem 4.1 and Theorem 4.3. It is noteworthy that in the \(\{_{i}\}_{1}^{p}\) case, where observations are sampled from \(p=3\) controllable trajectories, remarkably accurate parameter estimates can be obtained even with a limited number of samples.

For the \(\)-(un)identifiable cases, assumption **C1** stated in Theorem 4.2 holds true for all values of \(n\) in the identifiable cases, while it is violated across all \(n\) in the unidentifiable cases. In the \(\{_{i}\}_{1}^{p}\)-(un)identifiable cases, condition **C2** stated in Theorem 4.4 is satisfied for all values of \(n\) in the identifiable cases, but is found to be violated for all values of \(n\) in the unidentifiable cases. These findings provide strong empirical evidence supporting the validity of the identifiability conditions proposed in Theorem 4.2 and Theorem 4.4.

In Appendix G, we present additional simulation results for higher-dimensional cases, along with simulations that incorporate a variety of ground-truth parameter configurations. These results consistently affirm the validity of our proposed identifiability conditions. For further details, please refer to Appendix G.

## 6 Related work

**Identifiability analysis of linear ODE systems.** Within control theory, extensive research has been conducted on the identifiability analysis of linear dynamical systems governed by ODEs [5; 14; 15; 17]. In the applied mathematics area, Stanhope et al.  and Qiu et al.  have systematically investigated the identifiability of linear ODE systems based on a single trajectory. Furthermore, Wang et al.  have extended these findings to scenarios where only discrete observations sampled

   \)} &  &  \\   & \(A\) & \(B_{0}\) & \(BG_{0}\) & \(BG^{2}_{0}\) & \(A\) & \(B_{0}\) & \(BG_{0}\) & \(BG^{2}_{0}\) \\   & 6.00E-05 & 0.0004 & 0.0044 & 0.0007 & 0.0994 & 0.0494 & 0.9185 & 0.6482 \\  & (\(\)5.40E-08) & (\(\)3.45E-06) & (\(\)0.0004) & (\(\)3.91E-06) & (\(\)0.0157) & (\(\)0.1243) & (\(\)8.3148) & (\(\)1.4306) \\  & 4.15E-05 & 0.0003 & 0.0029 & 0.0005 & 0.0372 & 0.0174 & 0.3517 & 0.5767 \\  & (\(\)1.62E-08) & (\(\)8.52E-07) & (\(\)9.42E-05) & (\(\)2.90E-06) & (\(\)0.0032) & (\(\)0.0087) & (\(\)0.3460) & (\(\)1.4055) \\  & 2.65E-05 & 0.0002 & 0.0019 & 0.0002 & 0.0461 & 0.1071 & 0.5783 & 0.3648 \\  & (\(\)8.71E-09) & (\(\)4.38E-07) & (\(\)4.84E-05) & (\(\)8.38E-07) & (\(\)0.0099) & (\(\)0.1768) & (\(\)2.5747) & (\(\)0.4507) \\   

Table 1: MSEs of the \(\)-(un)identifiable cases of the ODE (3)

   \)} &  &  \\   & \(A\) & \(B\) & \(G\) & \(A\) & \(B\) & \(G\) \\   & 5.83E-22 & 2.85E-21 & 2.27E-21 & 0.6349 & 0.1913 & 0.0044 \\  & (\(\)7.41E-42) & (\(\)2.75E-40) & (\(\)5.69E-41) & (\(\)0.7464) & (\(\)0.0686) & (\(\)0.0011) \\  & 1.50E-22 & 7.80E-22 & 5.76E-22 & 0.6169 & 0.1850 & 0.0045 \\  & (\(\)3.23E-43) & (\(\)1.14E-41) & (\(\)5.28E-42) & (\(\)0.7194) & (\(\)0.0657) & (\(\)0.0007) \\  & 5.16E-23 & 3.01E-22 & 2.39E-22 & 0.5876 & 0.1761 & 0.0045 \\  & (\(\)6.20E-44) & (\(\)3.27E-42) & (\(\)8.46E-43) & (\(\)0.6895) & (\(\)0.0627) & (\(\)0.0008) \\   

Table 2: MSEs of the \(\{_{i}\}_{1}^{p}\)-(un)identifiable cases of the ODE (3)from a single trajectory are available. However, existing studies primarily concentrate on linear ODE systems with fully observable variables. To the best of our knowledge, our work represents the inaugural endeavor to systematically analyze the identifiability of linear ODE systems in the presence of hidden confounders.

**Connection between causality and differential equations.** Differential equations provide a natural framework for understanding causality within dynamic systems, particularly in the context of continuous-time processes [1; 31]. Consequently, significant efforts have been directed towards establishing a theoretical link between causality and differential equations. In the deterministic case, Mooij et al.  and Rubenstein et al.  have established a mathematical connection between ODEs and Structural Causal Models (SCMs). Wang et al.  have proposed a method for inferring the causal structure of linear ODEs. In the domain of neural ODEs, Aliee et al. [2; 3] have applied various regularization techniques to enhance the recovery of the causal relationships. Turning to the stochastic case, Hansen et al.  and Wang et al.  have proposed causal interpretations and identifiability analysis of Stochastic Differential Equations (SDEs). Additionally, Bellot et al.  have introduced a method for consistently discovering the causal structure of SDE systems using penalized neural ODEs. These works aim to establish a theoretical connection between causality and differential equations in various ways. Our contribution to this scholarly landscape lies in the systematic analysis of the identifiability of linear ODEs, particularly in the presence of hidden confounders.

## 7 Conclusion

This paper presents a systematic identifiability analysis of linear ODE systems incorporating hidden confounders. Specifically, we establish a sufficient and necessary identifiability condition for the linear ODE system with independent latent confounders. Additionally, we provide four identifiability conditions for the linear ODE system with causally related latent confounders, wherein the causal structure of the latent confounders adheres to a DAG.

A notable limitation of our work lies in the practical verification of these identifiability conditions, given that the true underlying system parameters are often unavailable in real-world scenarios. However, our study significantly contributes to the understanding of the intrinsic structure of linear ODE systems with hidden confounders. By providing insights into the identifiability aspects, our findings empower practitioners to utilize models that adhere to the proposed conditions (e.g., through constrained parameter estimation) for learning from real-world data while ensuring identifiability.