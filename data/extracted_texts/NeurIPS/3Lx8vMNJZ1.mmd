# Borda Regret Minimization for Generalized Linear Dueling Bandits

Anonymous Author(s)

Affiliation

Address

email

###### Abstract

Dueling bandits are widely used to model preferential feedback prevalent in many applications such as recommendation systems and ranking. In this paper, we study the Borda regret minimization problem for dueling bandits, which aims to identify the item with the highest Borda score while minimizing the cumulative regret. We propose a rich class of generalized linear dueling bandit models, which cover many existing models. We first prove a regret lower bound of order \((d^{2/3}T^{2/3})\) for the Borda regret minimization problem, where \(d\) is the dimension of contextual vectors and \(T\) is the time horizon. To attain this lower bound, we propose an explore-then-commit type algorithm for the stochastic setting, which has a nearly matching regret upper bound \((d^{2/3}T^{2/3})\). We also propose an EXP3-type algorithm for the adversarial setting, where the underlying model parameter can change at each round. Our algorithm achieves an \((d^{2/3}T^{2/3})\) regret, which is also optimal. Empirical evaluations on both synthetic data and a simulated real-world environment are conducted to corroborate our theoretical analysis.

## 1 Introduction

Multi-armed bandits (MAB) (Lattimore and Szepesvari, 2020) is an interactive game where at each round, an agent chooses an arm to pull and receives a noisy reward as feedback. In contrast to numerical feedback considered in classic MAB settings, preferential feedback is more natural in various online learning tasks including information retrieval Yue and Joachims (2009), recommendation systems Sui and Burdick (2014), ranking Minka et al. (2018), crowdsourcing Chen et al. (2013), etc. Moreover, numerical feedback is also more difficult to gauge and prone to errors in many real-world applications. For example, when provided with items to shop or movies to watch, it is more natural for a customer to pick a preferred one than scoring the options. This motivates _Dueling Bandits_(Yue and Joachims, 2009), where the agent repeatedly pulls two arms at a time and is provided with feedback being the binary outcome of "duels" between the two arms.

In dueling bandits problems, the outcome of duels is commonly modeled as Bernoulli random variables due to their binary nature. At each round, suppose the agent chooses to compare arm \(i\) and \(j\), then the binary feedback is assumed to be sampled independently from a Bernoulli distribution. For a dueling bandits instance with \(K\) arms, the probabilistic model of the instance can be fully characterized by a \(K K\) preference probability matrix with each entry being: \(p_{i,j}=(ij).\)

In a broader range of applications such as ranking, "arms" are often referred to as "items". We will use these two terms interchangeably in the rest of this paper. One central goal of dueling bandits is to devise a strategy to identify the "optimal" item as quickly as possible, measured by either sample complexity or cumulative regret. However, the notion of optimality for dueling bandits is way harder to define than for multi-armed bandits. The latter can simply define the arm with the highest numerical feedback as the optimal arm, while for dueling bandits there is no obvious definition solely dependent on \(\{p_{i,j}|i,j[K]\}\).

The first few works on dueling bandits imposed strong assumptions on \(p_{i,j}\). For example, Yue et al. (2012) assumed that there exists a true ranking that is coherent among all items, and the preference probabilities must satisfy both strong stochastic transitivity (SST) and stochastic triangle inequality (STI). While relaxations like weak stochastic transitivity (Falahagar et al., 2018) or relaxed stochastic transitivity (Yue and Joachims, 2011) exist, they typically still assume the true ranking exists and the preference probabilities are consistent, i.e., \(p_{i,j}>\) if and only if \(i\) is ranked higher than \(j\). In reality, the existence of such coherent ranking aligned with item preferences is rarely the case. For example, \(p_{i,j}\) may be interpreted as the probability of one basketball team \(i\) beating another team \(j\), and there can be a circle among the match advantage relations.

In this paper, we do not assume such coherent ranking exists and solely rely on the _Borda score_ based on preference probabilities. The Borda score \(B(i)\) of an item \(i\) is the probability that it is preferred when compared with another random item, namely \(B(i):=_{j i}p_{i,j}\). The item with the highest Borda score is called the _Borda winner_. The Borda winner is intuitively appealing and always well-defined for any set of preferential probabilities. The Borda score also does not require the problem instance to obey any consistency or transitivity, and it is considered one of the most general criteria.

To identify the Borda winner, estimations of the Borda scores are needed. Since estimating the Borda score for one item requires comparing it with every other items, the sample complexity is prohibitively high when there are numerous items. On the other hand, in many real-world applications, the agent has access to side information that can assist the evaluation of \(p_{i,j}\). For instance, an e-commerce item carries its category as well as many other attributes, and the user might have a preference for a certain category (Wang et al., 2018). For a movie, the genre and the plot as well as the directors and actors can also be taken into consideration when making choices (Liu et al., 2017).

Based on the above motivation, we consider _Generalized Linear Dueling Bandits_. At each round, the agent selects two items from a finite set of items and receives a comparison result of the preferred item. The comparisons depend on known intrinsic contexts/features associated with each pair of items. The contexts can be obtained from upstream tasks, such as topic modeling (Zhu et al., 2012) or embedding (Vasile et al., 2016). Our goal is to adaptively select items and minimize the regret with respect to the optimal item (i.e., Borda winner). Our main contributions are summarized as follows:

* We show a hardness result regarding the Borda regret minimization for the (generalized) linear model. We prove a worst-case regret lower bound \((d^{2/3}T^{2/3})\) for our dueling bandit model, showing that even in the stochastic setting, minimizing the Borda regret is difficult. The construction and proof of the lower bound are new and might be of independent interest.
* We propose an explore-then-commit type algorithm under the stochastic setting, which can achieve a nearly matching upper bound \((d^{2/3}T^{2/3})\). When the number of items \(K\) is small, the algorithm can also be configured to achieve a smaller regret \((d K)^{1/3}T^{2/3}\).
* We propose an EXP3 type algorithm for linear dueling bandits under the adversarial setting, which can achieve a nearly matching upper bound \((d K)^{1/3}T^{2/3}\).
* We conduct empirical studies to verify the correctness of our theoretical claims. Under both synthetic and real-world data settings, our algorithms can outperform all the baselines in terms of cumulative regret.

NotationIn this paper, we use normal letters to denote scalars, lowercase bold letters to denote vectors, and uppercase bold letters to denote matrices. For a vector \(\), \(\|\|\) denotes its \(_{2}\)-norm. The weighted \(_{2}\)-norm associated with a positive-definite matrix \(\) is defined as \(\|\|_{}=^{}}\). The minimum eigenvalue of a matrix \(\) is written as \(_{}()\). We use standard asymptotic notations including \(O(),(),()\), and \((),(),()\) will hide logarithmic factors. For a positive integer \(N\), \([N]:=\{1,2,,N\}\).

## 2 Related Work

Multi-armed and Contextual Bandits Multi-armed bandit is a problem of identifying the best choice in a sequential decision-making system. It has been studied in numerous ways with a wide range of applications (Even-Dar et al., 2002; Lai et al., 1985; Kuleshov and Precup, 2014). Contextual linear bandit is a special type of bandit problem where the agent is provided with side information, i.e., contexts, and rewards are assumed to have a linear structure. Various algorithms (Rusmevichientongand Tsitsiklis, 2010; Filippi et al., 2010; Abbasi-Yadkori et al., 2011; Li et al., 2017; Jun et al., 2017) have been proposed to utilize this contextual information.

**Dueling Bandits and Its Performance Metrics** Dueling bandits is a variant of MAB with preferential feedback (Yue et al., 2012; Zoghi et al., 2014, 2015). A comprehensive survey can be found at Bengs et al. (2021). As discussed previously, the probabilistic structure of a dueling bandits problem is governed by the preference probabilities, over which an optimal item needs to be defined. Optimality under the _Borda score_ criteria has been adopted by several previous works (Jamieson et al., 2015; Falahatgar et al., 2017; Heckel et al., 2018; Saha et al., 2021). The most relevant work to ours is Saha et al. (2021), where they studied the problem of regret minimization for adversarial dueling bandits and proved a \(T\)-round Borda regret upper bound \((K^{1/3}T^{2/3})\). They also provide an \((K^{1/3}T^{2/3})\) lower bound for stationary dueling bandits using Borda regret.

Apart from the Borda score, _Copeland score_ is also a widely used criteria (Urvoy et al., 2013; Zoghi et al., 2015, 2014; Wu and Liu, 2016; Komiyama et al., 2016). It is defined as \(C(i):=_{j i}\{p_{i,j}>1/2\}\). A Copeland winner is the item that beats the most number of other items. It can be viewed as a "thresholded" version of Borda winner. In addition to Borda and Copeland winners, optimality notions such as a von Neumann winner were also studied in Ramamohan et al. (2016); Dudik et al. (2015); Balsubramani et al. (2016).

Another line of work focuses on identifying the optimal item or the total ranking, assuming the preference probabilities are consistent. Common consistency conditions include Strong Stochastic Transitivity (Yue et al., 2012; Falahatgar et al., 2017, 2017, 2018), Weak Stochastic Transitivity (Falahatgar et al., 2018; Ren et al., 2019; Wu et al., 2022; Lou et al., 2022), Relaxed Stochastic Transitivity (Yue and Joachims, 2011) and Stochastic Triangle Inequality. Sometimes the aforementioned transitivity can also be implied by some structured models like the Bradley-Terry model. We emphasize that these consistency conditions are not assumed or implicitly implied in our setting.

**Contextual Dueling Bandits** In Dudik et al. (2015), contextual information is incorporated in the dueling bandits framework. Later, Saha (2021) studied a structured contextual dueling bandits setting where each item \(i\) has its own contextual vector \(_{i}\) (sometimes called Linear Stochastic Transitivity). Each item then has an intrinsic score \(v_{i}\) equal to the linear product of an unknown parameter vector \(^{*}\) and its contextual vector \(_{i}\). The preference probability between two items \(i\) and \(j\) is assumed to be \((v_{i}-v_{j})\) where \(()\) is the logistic function. These intrinsic scores of items naturally define a ranking over items. The regret is also computed as the gap between the scores of pulled items and the best item. While in this paper, we assume that the contextual vectors are associated with item pairs and define regret on the Borda score. In Section A.1, we provide a more detailed discussion showing that the setting considered in Saha (2021) can be viewed as a special case of our model.

## 3 Backgrounds and Preliminaries

### Problem Setting

We first consider the stochastic preferential feedback model with \(K\) items in the fixed time horizon setting. We denote the item set by \([K]\) and let \(T\) be the total number of rounds. At each round \(t\), the agent can pick any pair of items \((i_{t},j_{t})\) to compare and receive stochastic feedback about whether item \(i_{t}\) is preferred over item \(j_{t}\), (denoted by \(i_{t} j_{t}\)). We denote the probability of seeing the event \(i j\) as \(p_{i,j}\). Naturally, we assume \(p_{i,j}+p_{j,i}=1\), and \(p_{i,i}=1/2\).

In this paper, we are concerned with the generalized linear model (GLM), where there is assumed to exist an _unknown_ parameter \(^{*}^{d}\), and each pair of items \((i,j)\) has its own _known_ contextual/feature vector \(_{i,j}^{d}\) with \(\|_{i,j}\| 1\). There is also a fixed known link function (sometimes called comparison function) \(()\) that is monotonically increasing and satisfies \((x)+(-x)=1\), e.g. a linear function or the logistic function \((x)=1/(1+e^{-x})\). The preference probability is defined as \(p_{i,j}=(_{i,j}^{}^{*})\). At each round, denote \(r_{t}=\{i_{t} j_{t}\}\), then we have

\[[r_{t}|i_{t},j_{t}]=p_{i_{t},j_{t}}=(_{i_{t},j_{ t}}^{}^{*}).\]

Then our model can also be written as

\[r_{t}=(_{i_{t},j_{t}}^{}^{*})+ _{t},\]where the noises \(\{_{t}\}_{t[T]}\) are zero-mean, \(1\)-sub-Gaussian and assumed independent from each other. Note that, given the constraint \(p_{i,j}+p_{j,i}=1\), it is implied that \(_{i,j}=-_{j,i}\) for any \(i[K],j[K]\).

The agent's goal is to maximize the cumulative Borda score. The (slightly modified 1) Borda score of item \(i\) is defined as \(B(i)=_{j=1}^{K}p_{i,j}\), and the Borda winner is defined as \(i^{*}=*{argmax}_{i[K]}B(i)\). The problem of merely identifying the Borda winner was deemed trivial (Zoghi et al., 2014; Busa-Fekete et al., 2018) because for a fixed item \(i\), uniformly random sampling \(j\) and receiving feedback \(r_{i,j}=*{Bernoulli}(p_{i,j})\) yield a Bernoulli random variable with its expectation being the Borda score \(B(i)\). This so-called _Borda reduction_ trick makes identifying the Borda winner as easy as the best-arm identification for \(K\)-armed bandits. Moreover, if the regret is defined as \(*{Regret}(T)=_{t=1}^{T}(B(i^{*})-B(i_{t}))\), then any optimal algorithms for multi-arm bandits can achieve \(()\) regret.

However, the above definition of regret does not respect the fact that a pair of items are selected at each round. When the agent chooses two items to compare, it is natural to define the regret so that both items contribute equally. A commonly used regret, e.g., in Saha et al. (2021), has the following form:

\[*{Regret}(T)=_{t=1}^{T}2B(i^{*})-B(i_{t})-B(j_{t}) ,\] (1)

where the regret is defined as the sum of the sub-optimality of both selected arms. Sub-optimality is measured by the gap between the Borda scores of the compared items and the Borda winner. This form of regret deems any classical multi-arm bandit algorithm with Borda reduction vacuous because taking \(j_{t}\) into consideration will invoke \((T)\) regret.

Adversarial SettingSaha et al. (2021) considered an adversarial setting for the multi-armed case, where at each round \(t\), the comparison follows a potentially different probability model, denoted by \(\{p^{t}_{i,j}\}_{i,j[K]}\). In this paper, we consider its contextual counterpart. Formally, we assume there is an underlying parameter \(^{*}_{t}\), and at round \(t\), the preference probability is defined as \(p^{t}_{i,j}=(^{}_{i,j}^{*}_{t})\).

The Borda score of item \(i[K]\) at round \(t\) is defined as \(B_{t}(i)=_{j=1}^{K}p^{t}_{i,j}\), and the Borda winner at round \(T\) is defined as \(i^{*}=*{argmax}_{i[K]}_{t=1}^{T}B_{t}(i)\). The \(T\)-round regret is thus defined as \(*{Regret}(T)=_{t=1}^{T}2B_{t}(i^{*})-B_{t}(i_{t})-B_{ t}(j_{t})\).

### Assumptions

In this section, we present the assumptions required for establishing theoretical guarantees. Due to the fact that the analysis technique is largely extracted from Li et al. (2017), we follow them to make assumptions to enable regret minimization for generalized linear dueling bandits.

We make a regularity assumption about the distribution of the contextual vectors:

**Assumption 1**.: There exists a constant \(_{0}>0\) such that \(_{}}_{i=1}^{K}_{j=1}^{K}_{i,j }^{}_{i,j}_{0}\).

This assumption is only utilized to initialize the design matrix \(_{}=_{i=1}^{}_{i_{t},j_{t}}^{}_{i_{ t},j_{t}}\) so that the minimum eigenvalue is large enough. We follow Li et al. (2017) to deem \(_{0}\) as a constant.

We also need the following assumption regarding the link function \(()\):

**Assumption 2**.: Let \(\) be the first-order derivative of \(\). We have \(:=_{\|\| 1,\|-^{*}\| 1}(^{})>0\).

Assuming \(>0\) is necessary to ensure the maximum log-likelihood estimator can converge to the true parameter \(^{*}\)(Li et al., 2017, Section 3). This type of assumption is commonly made in previous works for generalized linear models (Filippi et al., 2010; Li et al., 2017; Faury et al., 2020).

Another common assumption is regarding the continuity and smoothness of the link function.

**Assumption 3**.: \(\) is twice differentiable. Its first and second-order derivatives are upper-bounded by constants \(L_{}\) and \(M_{}\) respectively.

This is a very mild assumption. For example, it is easy to verify that the logistic link function satisfies Assumption 3 with \(L_{}=M_{}=1/4\).

## 4 The Hardness Result

This section presents Theorem 4, a worst-case regret lower bound for the stochastic linear dueling bandits. The proof of Theorem 4 relies on a class of hard instances, as shown in Figure 1. We show that any algorithm will incur a certain amount of regret when applied to this hard instance class. The constructed hard instances follow a stochastic linear model, which is a sub-class of the generalized linear model. Saha et al. (2021b) first proposed a similar construction for finite many arms with no contexts. Our construction is for a contextual setting and the proof of the lower bound takes a rather different route.

For any \(d>0\), we construct the class of hard instances as follows. An instance is specified by a vector \(\{-,+\}^{d}\). The instance contains \(2^{d+1}\) items (indexed from 0 to \(2^{d+1}-1\)). The preference probability for an instance is defined by \(p^{}_{i,j}\) as:

\[p^{}_{i,j}=,\;\;i<2^{d},j <2^{d}\;\;i 2^{d},j 2^{d}\\ ,\;\;i<2^{d},j 2^{d}\\ ,\;\;i 2^{d},j<2^{d}+_{i,j},,\]

and the \(d\)-dimensional feature vectors \(_{i,j}\) are given by

\[_{i,j}=,\;\;i<2^{d},j<2^{d} \;\;i 2^{d},j 2^{d}\\ (i),\;\;i<2^{d},j 2^{d}\\ -(j),\;\;i 2^{d},j<2^{d},\]

where \(()\) is the (shifted) bit representation of non-negative integers, i.e., suppose \(x\) has the binary representation \(x=b_{0} 2^{0}+b_{1} 2^{1}++b_{d-1} 2^{d-1}\), then

\[(x)=(2b_{0}-1,2b_{1}-1,,2b_{d-1}-1)=2-1.\]

Note that \(()\{-1,+1\}^{d}\), and that \(_{i,j}=-_{j,i}\) is satisfied. The definition of \(p^{}_{i,j}\) can be slightly tweaked to fit exactly the model described in Section 3 (see Remark 11 in Appendix).

Some calculation shows that the Borda scores of the \(2^{d+1}\) items are:

\[B^{}(i)=+(i),,\;\;i<2^{d},\\ ,\;\;i 2^{d}.\]

Intuitively, the former half of items (those indexed from \(0\) to \(2^{d}-1\)) are "good" items (one among them is optimal, others are nearly optimal), while the latter half of items are "bad" items. Under such hard instances, every time one of the two pulled items is a "bad" item, then a one-step regret

Figure 1: Illustration of the hard-to-learn preference probability matrix \(\{p^{}_{i,j}\}_{i[K],j[K]}\). There are \(K=2^{d+1}\) items in total. The first \(2^{d}\) items are “good” items with higher Borda scores, and the last \(2^{d}\) items are “bad” items. The upper right block \(\{p_{i,j}\}_{i 2^{d},j 2^{d}}\) is defined as shown in the blue bubble. The lower left block satisfies \(p_{i,j}=1-p_{j,i}\). For any \(\), there exist one and only best item \(i\) such that \((i)=()\).

\(B^{}(i^{*})-B^{}(i) 1/4\) is incurred. To minimize regret, we should thus try to avoid pulling "bad" items. However, in order to identify the best item among all "good" items, comparisons between "good" and "bad" items are necessary. The reason is simply that comparisons between "good" items give no information about the Borda scores as the comparison probabilities are \(p^{}_{i,j}=\) for all \(i,j<2^{d}\). Hence, any algorithm that can decently distinguish among the "good" items has to pull "bad" ones for a fair amount of times, and large regret is thus incurred. A similar observation is also made by Saha et al. (2021a).

This specific construction emphasizes the intrinsic hardness of Borda regret minimization: to differentiate the best item from its close competitors, the algorithm must query the bad items to gain information.

Formally, this class of hard instances leads to the following regret lower bound for both stochastic and adversarial settings:

**Theorem 4**.: For any algorithm \(\), there exists a hard instance \(\{p^{}_{i,j}\}\) with \(T>4d^{2}\), such that \(\) will incur expected regret at least \((d^{2/3}T^{2/3})\).

The construction of this hard instance for linear dueling bandits is inspired by the worst-case lower bound for the stochastic linear bandit (Dani et al., 2008), which has the order \((d)\), while ours is \((d^{2/3}T^{2/3})\). The difference is that for the linear or multi-armed stochastic bandit, eliminating bad arms can make further exploration less expensive. But in our case, any amount of exploration will not reduce the cost of further exploration. This essentially means that exploration and exploitation must be separate, which is also supported by the fact that a simple explore-then-commit algorithm shown in Section 5 can be nearly optimal.

## 5 Stochastic Contextual Dueling Bandit

### Algorithm Description

```
1:Input: time horizon \(T\), number of items \(K\), feature dimension \(d\), feature vectors \(_{i,j}\) for \(i[K]\), \(j[K]\), exploration rounds \(\), error tolerance \(\), failure probability \(\).
2:for\(t=1,2,,\)do
3: sample \(i_{t}([K])\), \(j_{t}([K])\)
4: query pair \((i_{t},j_{t})\) and receive feedback \(r_{t}\)
5:endfor
6: Find the G-optimal design \((i,j)\) based on \(_{i,j}\) for \(i[K]\), \(j[K]\)
7: Let \(N(i,j)=}\) for any \((i,j)()\), denote \(N=_{i=1}^{K}_{j=1}^{K}N(i,j)\)
8:for\(i[K]\), \(j[K]\), \(s[N(i,j)]\)do
9: set \(t t+1\), set \((i_{t},j_{t})=(i,j)\)
10: query pair \((i_{t},j_{t})\) and receive feedback \(r_{t}\)
11:endfor
12: Calculate the empirical MLE estimator \(}_{+N}\) based on all \(+N\) samples via (2)
13: Estimate the Borda score for each item: \[(i)=_{j=1}^{K}(_{i,j}^{}}_{+N}),=*{argmax}_{i[K]} (i)\]
14: Keep querying \((,)\) for the rest of the time. ```

**Algorithm 1**BETC-GLM

We propose an algorithm named Borda Explore-Then-Commit for Generalized Linear Models (BETC-GLM), presented in Algorithm 1. Our algorithm is inspired by the algorithm for generalized linear models proposed by Li et al. (2017).

At the high level, Algorithm 1 can be divided into two phases: the exploration phase (Line 2-11) and the exploitation phase (Line 12-14). The exploration phase ensures that the MLE estimator \(}\) is accurate enough so that the estimated Borda score is within \(()\)-range of the true Borda score (ignoring other quantities). Then the exploitation phase simply chooses the empirical Borda winner to incur small regret.

During the exploration phase, the algorithm first performs "pure exploration" (Line 2-5), which can be seen as an initialization step for the algorithm. The purpose of this step is to ensure the design matrix \(_{+N}=_{t=1}^{+N}_{i_{t},j_{t}} {}_{i_{t},j_{t}}^{}\) is positive definite.

After that, the algorithm will perform the "designed exploration". Line 6 will find the G-optimal design, which minimizes the objective function \(g()=_{i,j}\|_{i,j}\|_{()^{-1}}^{2}\), where \(():=_{i,j}(i,j)_{i,j}_{i,j}^{}\). The G-optimal design \(^{*}()\) satisfies \(\|_{i,j}\|_{(^{*})^{-1}}^{2} d\), and can be efficiently approximated by the Frank-Wolfe algorithm (See Remark 8 for a detailed discussion). Then the algorithm will follow \(()\) found at Line 6 to determine how many samples (Line 7) are needed. At Line 8-11, there are in total \(N=_{i=1}^{K}_{j=1}^{K}N(i,j)\) samples queried, and the algorithm shall index them by \(t=+1,+2,,+N\).

At Line 12, the algorithm collects all the \(+N\) samples and performs the maximum likelihood estimation (MLE). For the generalized linear model, the MLE estimator \(}_{+N}\) satisfies:

\[_{t=1}^{+N}(_{i_{t},j_{t}}^{}}_{+N})_{i_{t},j_{t}}=_{t=1}^{ +N}r_{t}_{i_{t},j_{t}},\] (2)

or equivalently, it can be determined by solving a strongly concave optimization problem:

\[}_{+N}*{argmax}_{ }_{t=1}^{+N}r_{t}_{i_{t}, j_{t}}^{}-m(_{i_{t},j_{t}}^{} ),\]

where \(()=()\). For the logistic link function, \(m(x)=(1+e^{x})\). As a special case of our generalized linear model, the linear model has a closed-form solution for (2). For example, if \((x)=+x\), i.e. \(p_{i,j}=+_{i,j}^{}^{*}\), then (2) becomes:

\[}_{+N}=_{+N}^{-1}_{t=1}^{ +N}(r_{t}-1/2)_{i_{t},j_{t}},\]

where \(_{+N}=_{t=1}^{+N}_{i_{t},j_{t}} _{i_{t},j_{t}}^{}\).

After the MLE estimator is obtained, Line 13 will calculate the estimated Borda score \((i)\) for each item based on \(}_{+N}\), and pick the empirically best one.

### A Matching Regret Upper Bound

Algorithm 1 can be configured to tightly match the worst-case lower bound. The configuration and performance are described as follows:

**Theorem 5**.: Suppose Assumption 1-3 hold and \(T=(d^{2})\). For any \(>0\), if we set \(=C_{4}_{0}^{-2}(d+(1/))\) (\(C_{4}\) is a universal constant) and \(=d^{1/6}T^{-1/3}\), then with probability at least \(1-2\), Algorithm 1 will incur regret bounded by:

\[O^{-1}d^{2/3}T^{2/3}T/d}.\]

By setting \(=T^{-1}\), the expected regret is bounded as \((^{-1}d^{2/3}T^{2/3})\).

For linear bandit models, such as the hard-to-learn instances in Section 4, \(\) is a universal constant. Therefore, Theorem 5 tightly matches the lower bound in Theorem 4, up to logarithmic factors.

**Remark 6** (Regret for Fewer Arms).: In typical scenarios, the number of items \(K\) is not exponentially large in the dimension \(d\). In this case, we can choose a different parameter set of \(\) and \(\) such that Algorithm 1 can achieve a smaller regret bound \(^{-1}(d K)^{1/3}T^{2/3}\) with smaller dependence on the dimension \(d\). See Theorem 10 in Appendix A.2.

**Remark 7** (Regret for Infinitely Many Arms).: In most practical scenarios of dueling bandits, it is adequate to consider a finite number \(K\) of items (e.g., ranking items). Nonetheless, BETC-GLMcan be easily adapted to accommodate infinitely many arms in terms of regret. We can construct a covering over all \(_{i,j}\) and perform optimal design and exploration on the covering set. The resulting regret will be the same as our upper bound, i.e., \((d^{2/3}T^{2/3})\) up to some error caused by the epsilon net argument.

**Remark 8** (Approximate G-optimal Design).: Algorithm 1 assumes an exact G-optimal design \(\) is obtained. In the experiments, we use the Frank-Wolfe algorithm to solve the constraint optimization problem (See Algorithm 5, Appendix G.3). To find a policy \(\) such that \(g()(1+)g(^{*})\), roughly \(O(d/)\) optimization steps are needed. Such a near-optimal design will introduce a factor of \((1+)^{1/3}\) into the upper bounds.

## 6 Adversarial Contextual Dueling Bandit

This section addresses Borda regret minimization under the adversarial setting. As we introduced in Section 3.1, the unknown parameter \(_{t}\) can vary for each round \(t\), while the contextual vectors \(_{i,j}\) are fixed.

Our proposed algorithm, BEXP3, is designed for the contextual linear model. Formally, at round \(t\) and given pair \((i,j)\), we have \(p_{i,j}^{t}=+_{i,j},_{t}^{*}\).

### Algorithm Description

```
1:Input: time horizon \(T\), number of items \(K\), feature dimension \(d\), feature vectors \(_{i,j}\) for \(i[K]\), \(j[K]\), learning rate \(\), exploration parameter \(\).
2:Initialize:\(q_{1}(i)=\).
3:for\(t=1,,T\)do
4: Sample items \(i_{t} q_{t}\), \(j_{t} q_{t}\).
5: Query pair \((i_{t},j_{t})\) and receive feedback \(r_{t}\)
6: Calculate \(Q_{t}=_{i[K]}_{j[K]}q_{t}(i)q_{t}(j)_{i,j}_{i,j }^{}\), \(}_{t}=Q_{t}^{-1}_{i_{t},j_{t}}r_{t}\).
7: Calculate the (shifted) Borda score estimates \(_{t}(i)=_{j[K]}_{i,j},}_{t}\).
8: Update for all \(i[K]\), set \[_{t+1}(i)=^{t}_{l}(i))}{ _{j[K]}(_{l=1}^{t}_{l}(j))}; 28.452756ptq_{t+1 }(i)=(1-)_{t+1}(i)+.\]
9:endfor ```

**Algorithm 2** BEXP3

Algorithm 2 is adapted from the DEXP3 algorithm in Saha et al. (2021), which deals with the adversarial multi-armed dueling bandit. Algorithm 2 maintains a distribution \(q_{t}()\) over \([K]\), initialized as uniform distribution (Line 2). At every round \(t\), two items are chosen following \(q_{t}\) independently. Then Line 6 calculates the one-sample unbiased estimate \(}_{t}\) of the true underlying parameter \(_{t}^{*}\). Line 7 further calculates the unbiased estimate of the (shifted) Borda score. Note that the true Borda score at round \(t\) satisfies \(B_{t}(i)=+_{j[K]}_{i,j},_{t}^{*}\). \(_{t}\) instead only estimates the second term of the Borda score. This is a choice to simplify the proof. The cumulative estimated score \(_{l=1}^{t}_{l}(i)\) can be seen as the estimated cumulative reward of item \(i\) at round \(t\). In Line 8, \(q_{t+1}\) is defined by the classic exponential weight update, along with a uniform exploration policy controlled by \(\).

### Upper Bounds

Algorithm 2 can also be configured to tightly match the worst-case lower bound:

**Theorem 9**.: Suppose Assumption 1 holds. If we set \(=( K)^{2/3}d^{-1/3}T^{-2/3}\) and \(=}=( K)^{1/3}d^{1/3}T^{-1/3}_{0}^{-1/2}\), then the expected regret is upper-bounded by

\[O(d K)^{1/3}T^{2/3}.\]

Note that the lower bound construction is for the linear model and has \(K=O(2^{d})\), thus exactly matching the upper bound.

Experiments

This section compares the proposed algorithm BETC-GLM with existing ones that are capable of minimizing Borda regret. We use random responses (generated from fixed preferential matrices) to interact with all tested algorithms. Each algorithm is run for 50 times over a time horizon of \(T=10^{6}\). We report both the mean and the standard deviation of the cumulative Borda regret and supply some analysis. The following list summarizes all methods we studies in this section, a more complete description of the methods and parameters are available in Appendix E: BETC-GLM(-Match): Algorithm 1 proposed in this paper with different parameters.

UCB-Borda: The UCB algorithm (Auer et al., 2002) using _Borda reduction_. DEXP3: Dueling-Exp3 developed by Saha et al. (2021). ETC-Borda: A simple explore-then-commit algorithm that does not take any contextual information into account. BEXP3: The proposed method for adversarial Borda bandits displayed in Algorithm 2.

Generated Hard CaseWe first test the algorithms on the hard instances constructed in Section 4. We generate \(^{*}\) randomly from \(\{-,+\}^{d}\) with \(=\) so that the comparison probabilities \(p_{i,j}^{^{*}}\) for all \(i,j[K]\). We pick the dimension \(d=6\) and the number of arms is therefore \(K=2^{d+1}=128\). Note the dual usage of \(d\) in our construction and the model setup in Section 3.1. We refer readers to Remark 11 in Appendix B for more details.

As depicted in Figure 1(a), the proposed algorithms (BETC-GLM, BEXP3) outperform the baseline algorithms in terms of cumulative regret when reaching the end of time horizon \(T\). For UCB-Borda, since it is not tailored for the dueling regret definition, it suffers from a linear regret as its second arm is always sampled uniformly at random, leading to a constant regret per round. DEXP3 and ETC-Borda are two algorithms designed for \(K\)-armed dueling bandits. Both are unable to utilize contextual information and thus demand more exploration. As expected, their regrets are higher than BETC-GLM or BEXP3.

Real-world DatasetTo showcase the performance of the algorithms in a real-world setting, we use EventTime dataset (Zhang et al., 2016). In this dataset, \(K=100\) historical events are compared in a pairwise fashion by crowd-sourced workers. We first calculate the empirical preference probabilities \(_{i,j}\) from the collected responses, and construct a generalized linear model based on the empirical preference probabilities. The algorithms are tested under this generalized linear model. Due to space limitations, more details are deferred to Appendix F.

As depicted in Figure 1(b), the proposed algorithm BETC-GLM outperforms the baseline algorithms in terms of cumulative regret when reaching the end of time horizon \(T\). The other proposed algorithm BEXP3 performs equally well even when misspecified (the algorithm is designed for linear setting, while the comparison probability follows a logistic model).

## 8 Conclusion and Future Work

In this paper, we introduced Borda regret into the generalized linear dueling bandits setting, along with an explore-then-commit type algorithm BETC-GLM and an EXP3 type algorithm BEXP3. The algorithms can achieve a nearly optimal regret upper bound, which we corroborate with a matching lower bound. The theoretical performance of the algorithms is verified empirically. It demonstrates superior performance compared to other baseline methods.

For future works, due to the fact that our exploration scheme guarantees an accurate estimate in all directions, our work can be extended to solve the top-k recovery or ranking problem, as long as a proper notion of regret can be identified.

Figure 2: The regret of the proposed algorithms (BETC-GLM, BEXP3) and the baseline algorithms (UCB-Borda, DEXP3, ETC-Borda).