# GOMAA-Geo: GOal Modality Agnostic Active Geo-localization

Anindya Sarkar\({}^{1}\)1, Srikumar Sastry\({}^{1}\)1, Aleksis Pirinen\({}^{2,3}\),

**Chongjie Zhang\({}^{1}\), Nathan Jacobs\({}^{1}\), Yevgeniy Vorobeychik\({}^{1}\)**

\({}^{1}\)Department of Computer Science and Engineering, Washington University in St. Louis

\({}^{2}\)RISE Research Institutes of Sweden

\({}^{3}\)Swedish Centre for Impacts of Climate Extremes (climes)

Corresponding authors: {anindya, s.sastry}@wustl.edu

Equal contribution.

###### Abstract

We consider the task of _active geo-localization_ (AGL) in which an agent uses a sequence of visual cues observed during aerial navigation to find a target specified through multiple possible modalities. This could emulate a UAV involved in a search-and-rescue operation navigating through an area, observing a stream of aerial images as it goes. The AGL task is associated with two important challenges. Firstly, an agent must deal with a goal specification in one of multiple modalities (e.g., through a natural language description) while the search cues are provided in other modalities (aerial imagery). The second challenge is limited localization time (e.g., limited battery life, urgency) so that the goal must be localized as efficiently as possible, i.e. the agent must effectively leverage its sequentially observed aerial views when searching for the goal. To address these challenges, we propose _GOMAA-Geo_ - a goal modality agnostic active geo-localization agent - for zero-shot generalization between different goal modalities. Our approach combines cross-modality contrastive learning to align representations across modalities with supervised foundation model pretraining and reinforcement learning to obtain highly effective navigation and localization policies. Through extensive evaluations, we show that _GOMAA-Geo_ outperforms alternative learnable approaches and that it generalizes across datasets - e.g., to disaster-hit areas without seeing a single disaster scenario during training - and goal modalities - e.g., to ground-level imagery or textual descriptions, despite only being trained with goals specified as aerial views. Our code is available at: https://github.com/mvrl/GOMAA-Geo.

## 1 Introduction

A common objective among many search-and-rescue (SAR) operations is to locate missing individuals within a defined search area, such as a specific neighborhood. To this end, one may leverage indirect information about the location of these individuals that may come from natural language descriptions, photographs, etc, e.g. through social media or eyewitness accounts. However, such information may not allow us to precisely identify actual locations (for example, these may not be provided on social media), and potential GPS information may be unreliable. In such situations, deploying a UAV to explore the area from an aerial perspective can be effective for accurate localization and subsequent assistance to those who are missing. However, the field of view of a UAV is typically limited (at least in comparison with the area to be explored), and the inherent urgency of search-and-rescue tasks imposes an effective temporal budget constraint. We refer to this general task and modeling framework as _goal modality agnostic active geo-localization_. Pirinen et al.  recently introduced adeep reinforcement learning (DRL) approach for a significantly simpler version of this setup, where goals are always assumed to be specified as aerial images. This is severely limiting in practical scenarios, where goal contents are instead often available as ground-level imagery or natural language text (e.g., on social media following a disaster). Also, since no two geo-localization scenarios are alike, zero-shot generalizability is a crucial aspect to consider when developing methods for this task.

To this end, we introduce _GOMAA-Geo_, a novel framework for tackling the proposed _GOal_ Modality Agnostic Active Geo-localization task. Our framework allows for goals to be specified in several modalities, such as text or ground-level images, whereas search cues are provided as a sequence of aerial images (akin to a UAV with a downwards-facing camera). Furthermore, _GOMAA-Geo_ effectively leverages past search information in deciding where to search next. To address the potential misalignment between goal specification and observational modalities, as well as facilitating zero-shot transfer, we develop a cross-modality contrastive learning approach that aligns representation across modalities. We then combine this representation learning with foundation model pretraining and DRL to obtain policies that efficiently localize goals in a specification-agnostic way.

Given the scarcity of high-quality datasets that combine aerial imagery with other modalities like natural language text or ground-level imagery, evaluating _GOMAA-Geo_ becomes challenging. To address this limitation, we have created a novel dataset that allows for benchmarking of multi-modal geo-localization. We then demonstrate that our proposed _GOMAA-Geo_ framework is highly effective at performing active geo-localization tasks across diverse goal modalities, despite being _trained exclusively on data from a single goal modality_ (i.e., aerial views).

In summary, we make the following contributions:

* even when the policy is trained exclusively on data from a single goal modality
- and perform extensive experiments on two publicly available aerial image datasets, which demonstrate that _GOMAA-Geo_ significantly outperforms alternative approaches.
* We create a novel dataset to assess various approaches for active geo-localization across three different goal modalities: aerial images, ground-level images, and natural language text.
* We demonstrate the significance of each component within our proposed _GOMAA-Geo_ framework through a comprehensive series of quantitative and qualitative ablation analyses.
* We assess the zero-shot generalizability of _GOMAA-Geo_ by mimicking a real-world disaster scenario, where goals are presented as pre-disaster images and where policy training is done exclusively on such pre-disaster data, while the active geo-localization only has access to post-disaster aerial image glimpses during inference.

## 2 Related Work

**Geo-localization.** There is extensive prior work on one-shot _visual_ geo-localization [41; 38; 46; 43; 26; 40; 34; 6; 5; 47; 12]. Such works aim to infer relationships between images from different perspectives, typically predicting an aerial view corresponding to a ground-level image. This problem is commonly tackled by exhaustively comparing a query image with respect to a large reference dataset of aerial imagery. Alternatively, as in , a model is trained to directly predict the global geo-coordinates of a given query image. In contrast, our active geo-localization (AGL) setup aims to localize a target from its location description in one of several modalities by _navigating_ the geographical area containing it.

**LLMs for RL.** LLMs have been applied to RL and robotics for planning [35; 42; 15]. Our work instead focuses on learning goal-modality agnostic zero-shot generalizable agents and aims to leverage LLMs in order to learn goal-conditioned history-aware representations to guide RL agents for AGL.

**Embodied learning.** Our setup is also related to embodied goal navigation [2; 48; 19], where an agent should navigate (in a first-person perspective) in a 3d environment towards a goal specified e.g. as an image. This task may sometimes be more challenging than our setup since the agent needs to explore among obstacles (e.g. walls and furniture). On the other hand, the agent may often observe the goal from far away (e.g. from the opposite side of a recently entered room), while our task is more challenging in that the goal can never be partially observed prior to reaching it.

**Autonomous UAVs.** There are many prior works about autonomously controlling UAVs [36; 18; 10; 4; 30; 45; 25]. Many of these (e.g. [36; 30; 45]) revolve around exploring large environments efficiently,so that certain inferences can be accurately performed given only a sparse selection of high-resolution observations. There are also works that are closer to us in terms of task setup [4; 18; 10; 32; 24]. For example,  also considers the task of actively localizing a goal, assuming an agent with aerial view observations of a scene. However, this work only considers the idealized setting in which the goal is specified in terms of a top-view observation from the exact same scenario in which the agent operates. In contrast, we allow for flexibly specifying goals in an agnostic manner.

**Multi-modal representation learning in remote sensing.** Recent studies [17; 11] have shown that satellite image representations can be aligned with the shared embedding space learned by CLIP , by using co-located ground-level imagery as an intermediary to link satellite images and language. We utilize such aligned multi-modal embedding to represent goals in a modality-agnostic manner.

## 3 Active Geo-localization Setup

To formalize the active geo-localization (AGL) setup, we consider an agent (e.g. a UAV in a search-and-rescue scenario) that aims to localize a goal within a pre-defined search area. This area is discretized into a \(X Y\) grid superimposed on a given aerial landscape (larger image), with each grid corresponding to a position (location) and representing the limited field of view of the agent (UAV) - i.e., the agent can only observe the aerial content of a sub-image \(x_{t}\) corresponding to the grid cell in which it is located at time step \(t\). The agent can move between cells by taking actions \(a\) (up, down, left, right, in a canonical birds-eye-view orientation). The search goal is associated with one of the grid cells, including a description in one of several modalities, and the agent's task is to reach this goal - relying solely on visual cues in the form of sequentially observed aerial sub-images - within a fixed number of steps \(\). More precisely, let \(s_{g}\) be the semantic content and \(p_{g}\) the location (within the search area) of the goal. We use \(x_{g}\) to denote the provided _description_ of the goal, available to the agent in the form of either **(i)**_natural language text_, **(ii)**_ground-level image_, or **(iii)**_aerial image_ (sub-image within the top-view perspective search area). Notably, the true location \(p_{g}\) of the goal is _not_ provided to the agent, so it must be inferred by the agent during the search process. The AGL task is deemed accomplished when the agent's current position \(p_{t}\) aligns with the goal position \(p_{g}\), i.e., when \(p_{t}=p_{g}\). An overview is provided in Figure 1.

We model this problem as a _Goal-Conditioned Partially Observable Markov Decision Process (GC-POMDP)_ and consider a family of _GC-POMDP_ environments \(^{e}=\{(^{e},,^{e},^{e },^{e},)|e\}\) where \(e\) is the environment index. Each environment comprises a state space \(^{e}\), shared action space \(\), observation space \(^{e}\), transition dynamics \(^{e}\), goal space \(^{e}^{e}\), and discount factor \(\). The observation \(x^{e}^{e}\) is determined by state \(s^{e}^{e}\) and the unknown environmental factor \(b^{e}^{e}\), i.e., \(x^{e}(s^{e},b^{e})\), where \(^{e}\) encompasses variations related e.g. to disasters, diverse geospatial regions, varying seasons, and so on. We use \(x^{e}_{t}\) to denote the observation at state \(s^{e}\) and step \(t\), for domain \(e\).

The primary objective in a _GC-POMDP_ is to learn a history-aware goal conditioned policy \((a_{t}|x^{e}_{h_{t}},g^{e})\), where \(x^{e}_{h_{t}}=(x^{e}_{t},a_{t-1},x^{e}_{t-1},,a_{0},x^{e}_{0})\) combines all the previous observations and actions up to time \(t\), that maximizes the discounted state density function \(J()\) across all domains \(e\) as follows:

\[J()=_{e,g^{e}}^{e}, [(1-)_{t=0}^{}^{t}p^{e}_{}(s_{t}=g^{e}|\,g^{e})]\] (1)

Here \(p^{e}_{}(s_{t}=g^{e}|g^{e})\) represents the probability of reaching the goal \(g^{e}\) at step \(t\) within domain \(e\) under the policy \((.|x^{e}_{h_{t}},g^{e})\), and \(e\) and \(g^{e}\) refer to uniform samples from each set. Throughout the training process, the agent is exposed to a set of training environments \(\{e_{i}\}_{i=1}^{N}=_{train}\), each identified by its environment index. We also assume during training that the goal content is

Figure 1: **Active geo-localization across different goal modalities.** The agent must navigate to the goal (yellow dot) based on _partial aerial glimpses_, i.e. the full area is never observed in its entirety.

always available to the agent in the form of an _aerial image_. Our objective is to train a history-aware goal-conditioned RL agent capable of generalizing across goal modalities (such as natural language text, ground-level images, aerial images) and environmental variations, such as natural disasters.

## 4 Proposed Framework for Goal Modality Agnostic Active Geo-localization

In this section we introduce _GOMAA-Geo_, a novel learning framework designed to address the goal modality agnostic active geo-localization (AGL) problem. _GOMAA-Geo_ consists of three components: **(i)**_representation alignment across modalities_; **(ii)**_RL-aligned representation learning using goal aware supervised pretraining of LLM_; and **(iii)**_planning_. We next describe in detail each of these components within the proposed framework, and then we explain how these modules are integrated to train a goal-conditioned policy \(\), capable of generalizing to unseen test environments and unobserved goal modalities after training on \(_{train}\) (cf. Section 3).

**Aligning representations across modalities.** As we aspire to learn a goal modality agnostic policy \(\), it is essential to ensure that the embedding of the goal content - regardless of its modality (such as natural language text) - is aligned with the aerial image modality, as in the AGL setup we assume access only to aerial view glimpses during navigation. To this end, we take motivation from CLIP , which is designed to understand ground-level images and text jointly by aligning them in a shared embedding space through contrastive learning. Recent works [17; 11] have demonstrated that it is possible to align the representations of aerial images with the shared embedding space learned via CLIP. The key insight is to use co-located internet imagery taken on the ground as an intermediary for connecting aerial images and language. Following [17; 11], we proceed to train an image encoder tailored for aerial images, aiming to align it with CLIP's image encoder by utilizing a large-scale dataset comprising paired ground-level and aerial images. To align the embeddings of aerial images with those of ground-level images from CLIP, we employ contrastive learning on the aerial image encoder \(s_{}\) (parameterized by \(\)) using the InfoNCE loss  in the following manner:

\[^{}=_{i=0}^{i=N}-( {(s_{}^{i} f_{}^{i}/)}{_{j=0}^{j=N} (s_{}^{i} f_{}^{j}/)})\] (2)

Here we represent the CLIP image encoder as \(f_{}\) and \(\) denotes the temperature. We optimize the \(^{}\) loss (2) to reduce the gap between co-located aerial and ground-level images within the CLIP embedding space. It is important to highlight that the CLIP image encoder remains unchanged throughout training. Therefore, our training methodology essentially permits aerial images to approach images from their corresponding ground-level scenes and natural language text within the CLIP space. Combining the trained aerial image encoder \(s_{}\) with the CLIP model allows us to achieve embeddings within a unified embedding space for goal contents that span diverse modalities (in particular, aerial images, ground-level images, and natural language text). We refer to this combined model as a _CLIP-based Multi-Modal Feature Extractor (CLIP-MMFE)_.

**RL-aligned representation learning using goal aware supervised pretraining of LLM.** Large Language Models (LLMs) are in general not prof

Figure 2: _GASP_ strategy for pretraining LLMs for AGL.

In a GC-POMDP (cf. Section 3), we aim to learn a goal-conditioned latent representation that encompasses the complete history of observed state and action sequences, aiding the agent in decision-making within the partially observed environment. For this purpose, we leverage state-of-the-art LLMs, which excel in long-range autoregressive and sequence modeling tasks. However, employing such a model naively is not conducive to obtaining a latent representation that is advantageous for goal-conditioned active geo-localization (AGL). Therefore, we devise a _Goal-Aware Supervised Pretraining (GASP)_ strategy that enables learning a history-aware goal-conditioned latent representation, which assists in decision-making for the subsequent policy. An overview of the GASP strategy is depicted in Figure 2, and involves a two-step training process. First, we generate a random sequence of movement actions. Each random sequence of length \(t\) comprises all the previous observations and actions up to time \(t\). A \(t\)-length random sequence is denoted \(x_{h_{t}}=\{x_{0},a_{0},x_{1},a_{1},,x_{t}\}\). Second, we train the LLM on a sequence modeling task that involves predicting the optimal actions at time \(t\) that will bring the agent closer to the goal location, based on the observed trajectory data \(x_{h_{t}}\) and the goal content \(x_{g}\). Accordingly, we train an LLM using the binary cross entropy loss defined as:

\[_{}=_{i=1}^{N}-(y_{i}(p_{i})+(1-y_{i} )(1-p_{i}))\] \[p_{i}=((o|x_{h_{i-1}},g)),|p_{i}|=||\] (3)

Here \(N\) is the length of the random sequence, \(p_{i}\) is the predicted probability of actions at time step \(i\) when \(x_{h_{i-1}}\) and \(g\) are given as the input to LLM, and \(y_{i}\) encodes information regarding the set of actions \(_{i}^{}\) that are considered optimal at time step \(i\), implying that these actions will lead the agent closer to the goal location. Each element of \(y_{i}\) corresponds to an action in the set \(\), so that \(y_{i}=[y_{i}^{(1)},y_{i}^{(2)},,y_{i}^{(||)}]\), where \(y_{i}^{(j)}=1\) if \(j\)'th action \(_{i}^{}\), and otherwise \(y_{i}^{(j)}=0\). We perform extensive experiments to validate the efficacy of the GASP strategy (see Section 6), and refer to the appendix section K for details about the GASP architecture and training process.

**Planning.** So far we have focused on the learning of a history-aware, goal modality agnostic latent representation useful for the AGL task in partially observable environments. Now, we describe the approach for learning an effective policy that leverages the learned latent representation to address this GC-POMDP. We refer to the latent representation obtained from the LLM at time \(t\) as \(e_{t}^{}(x_{h_{t}},g)\). Formally, we aim to learn a policy \(\) that maximizes the expected discounted sum of rewards for any given goal \(g\). To this end, we use an actor-critic style PPO algorithm  that involves learning both an _actor_ (policy network, parameterized by \(\)) \(_{}:e_{t}^{}(x_{h_{t}},g) p()\) and a _critic_ (value function, parameterized by \(\)) \(V_{}:e_{t}^{}(x_{h_{t}},g)\) that approximates the true value \(V^{}(x_{t},g)=_{a_{}(.|e_{t}^{ }(x_{h_{t}},g))}[R(x_{t},a,g)+ V((x_{t},a), g)]\). We optimize both the actor and critic networks using the following loss function:

\[_{t}^{}(,)=_{t}[- ^{}()+^{}()-[_{}(.|e_{t}^{}(x_{h_{t}},g))]]\] (4)

Here \(\) and \(\) are hyperparameters, and \(\) denotes entropy, so minimizing the final term of (4) encourages the actor to exhibit more exploratory behavior. The \(^{}\) loss is used specifically to optimize the parameters of the critic network and is defined as a squared-error loss, i.e. \(^{}=(V_{}(e_{t}^{}(x_{h_{t }},g))-V^{}(x_{t},g))^{2}\). The clipped surrogate objective \(^{}\) is employed to optimize the parameters of the actor network while constraining the change to a small value \(\) relative to the old actor policy \(^{}\) and is defined as:

\[^{}()=\{(.|e_{t}^{}(x_{h_{t}},g))}{^{}(. |e_{t}^{}(x_{h_{t}},g))}A^{t},(1- ,1+,(.|e_{t}^{}(x_{h_{t}},g ))}{^{}(.|e_{t}^{}(x_{h_{t}},g))})A^{t} )\}\\ A^{t}=r_{t}+ r_{t+1}++^{T-t+1}r_{T-1}-V_{}(e_{t}^ {}(x_{h_{t}},g))\] (5)

After every fixed update step, we copy the parameters of the current policy network \(_{}\) onto the old policy network \(^{}\) to enhance training stability. All hyperparameter details for training the actor and critic network are in the appendix section K.

There are numerous options for crafting the reward function for the AGL task. One potential approach involves designing a sparse reward signal, where the agent only receives a positive reward upon reaching the goal location and receives either no or a negative reward otherwise. Nevertheless,incorporating a denser reward structure has been demonstrated to expedite learning and improve the efficacy of the learned policy (shown in section 6). Specifically, we formulate a dense reward function customized for the AGL task as follows:

\[R(x_{h_{t}},a_{t},x_{g},x_{t+1})=\{1,&\ \ ||p_{t+1}-p_{g} ||_{2}^{2}<||p_{t}-p_{g}||_{2}^{2}\\ -1,&\ \ ||p_{t+1}-p_{g}||_{2}^{2}>||p_{t}-p_{g}||_{2}^{2}\ \ x_{t+1}\{x_{h_{t}}\}\\ 2,&\ \ x_{t+1}=x_{g}\\ .\] (6)

In other words, our approach involves penalizing the agent when an action takes it away from the goal or when it revisits the same state. Conversely, the agent receives a positive reward when its current action brings it closer to the goal, with the highest reward granted when the action results in reaching the goal location.

**GOMAA-Geo.** Our full _GOMAA-Geo_ framework integrates all the previously introduced components (see Figure 3). Initially, the aerial image encoder \(s_{}\) is trained to align the aerial image and CLIP embeddings. Next, the LLM is trained using the GASP strategy while maintaining \(s_{}\) and the CLIP model frozen. Finally, the LLM is also frozen, and only the actor and critic are trained using RL.

## 5 Experiments and Results

**Baselines.** In this and the subsequent section 6, we evaluate and analyze _GOMAA-Geo_ and compare its performance against the following baseline approaches: **(i)**_Random policy_ selects an action uniformly at random from the action set \(\) at each time step; **(ii)**_AiRLoc_ is an RL-based model designed for uni-modal AGL tasks . The approach involves training the policy using DRL and encoding the history of state observations using an LSTM . Note that _AiRLoc_ is _not_ agnostic to the goal modality; **(iii)**_PPO policy_ selects actions based solely on the current observation; **(iv)**_Decision Transformer (DiT)_ is trained using a collection of offline optimal trajectories that span from randomly selected start to randomly selected goal grids.

**Evaluation metric.** We evaluate the proposed approaches based on the _success ratio_ (SR), which is measured as the ratio of the number of successful localizations of the goal within a predefined exploration budget \(\) to the total number of AGL tasks. We evaluate the SR of _GOMAA-Geo_ and the baselines across different distances \(\) from the start to the goal location. In the main paper, we analyze _GOMAA-Geo_ with a \(5 5\) grid structure, \(=10\), and varying start-to-goal distance \(\)\(\{4,5,6,7,8\}\). In the appendix section A, we conduct additional experiments across various grid configurations, each employing different values of \(\) with varying \(\).

**Datasets.** We primarily utilize the Massachusetts Buildings (Masa) dataset  for both the development and evaluation of _GOMAA-Geo_ in settings where the goal content is provided as aerial imagery. The dataset is split into \(70\%\) for training and \(15\%\) each for validation and testing.

Many existing datasets containing paired aerial and ground-level images lack precise coordinate locations, which are pivotal for the AGL task. Furthermore, the ground-level images typically contain

Figure 3: Our proposed _GOMAA-Geo_ framework for goal modality agnostic active geo-localization.

little to no meaningful information about the goal (e.g. images of roads, trees, and so on). In particular, to the best of our knowledge, no open-source dataset is currently available for evaluating the zero-shot generalizability of _GOMAA-Geo_ across diverse goal modalities, such as ground-level images and natural language text. To alleviate this, we have collected a dataset from different regions across the world, which allows for specifying the goal content as aerial imagery, ground-level imagery, or natural language text. This dataset allows us to conduct proof-of-concept AGL experiments in contexts where the goal modality may vary at test time. Note that the data is only used for evaluation - training is done on Masa using only aerial imagery as a goal modality. We refer to this dataset as _M_ulti-_M_odal _G_oal Dataset for _A_ctive _G_eolocalization (_MM-GAG_). It consists of 73 distinct search areas from different parts of the world. For each area, we select 5 pairs of start and goal locations corresponding to each start-to-goal distance \(\) (resulting in 365 evaluation scenarios for each \(\)). We provide more details about the dataset in the appendix section L.

Finally, to further evaluate the zero-shot generalization capability, we also compare the _GOMAA-Geo_ with baseline approaches using the xBD dataset introduced by Gupta et al. (2019). This dataset includes aerial images from different regions, both before (xBD-pre) and after (xBD-disaster) various natural disasters such as wildfires and floods. It is important to emphasize that all the results we present in this work - including the zero-shot generalization settings with the xBD-pre and xBD-post disaster datasets, as well as all across the three different goal modalities of the MM-GAG dataset - _are evaluated using a model trained exclusively on the Masa dataset_ (where goals are always specified from an aerial perspective).

**Implementation details.** We provide comprehensive details on network architectures and training hyperparameters for each training stage in the appendix section K.

**Evaluation of _GOMAA-Geo_.** We initiate our evaluation of the proposed methods using the Masa and MM-GAG datasets with _aerial image_ as goal modality. During the evaluation, for each AGL task, we randomly select 5 pairs of start and goal locations for each value of \(\). We report the result in Table 1 and observe a significant performance improvement compared to the baseline methods, with success ratio (SR) improvements ranging from \(129.00\%\) to \(232.67\%\) relative to the baselines across various evaluation settings, showcasing the efficacy of _GOMAA-GEO_ for active geo-localization (AGL) tasks where goals are provided in the form of aerial images.

**Zero-shot generalization capabilities of _GOMAA-Geo_.** For additional assessments of _GOMAA-Geo_'s zero-shot generalizability, we employ trained _GOMAA-Geo_ model exclusively trained on the Masa dataset and evaluate them on both non-disaster data from xBD-pre and disaster data from xBD-disaster. For fair evaluation, we ensure that the training data from Masa depicts geographical areas different from those in xBD. Moreover, in both pre-and post-disaster evaluation scenarios, the goal content is always presented to the agent as an aerial image captured _before_ the disaster. For

    &  \\  Method & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) \\  Random & 0.1412 & 0.0584 & 0.0640 & 0.0247 & 0.0236 & 0.1412 & 0.0584 & 0.0640 & 0.0247 & 0.0236 \\ PPO & 0.1427 & 0.1775 & 0.1921 & 0.2269 & 0.2595 & 0.1489 & 0.1854 & 0.1879 & 0.2176 & 0.2432 \\ DiT & 0.2011 & 0.2956 & 0.3567 & 0.4216 & 0.4559 & 0.2023 & 0.2856 & 0.3516 & 0.4190 & 0.4423 \\ AiRLoc & 0.1786 & 0.1561 & 0.2134 & 0.2415 & 0.2393 & 0.1745 & 0.1689 & 0.2019 & 0.2156 & 0.2290 \\ 
**GOMAA-Geo** & **0.4090** & **0.5056** & **0.7168** & **0.8034** & **0.7854** & **0.4085** & **0.5064** & **0.6638** & **0.7362** & **0.7021** \\   

Table 1: Evaluation with aerial image goals. _GOMAA-Geo_ obtains the highest success ratio (SR).

   Goal Modality & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) \\  Text & 0.4000 & 0.4978 & 0.6766 & 0.7702 & 0.6595 \\ Ground Image & 0.4383 & 0.5150 & 0.6608 & 0.7489 & 0.6893 \\ Aerial Image & 0.4085 & 0.5064 & 0.6638 & 0.7362 & 0.7021 \\   

Table 2: _GOMAA-Geo_ generalizes well across goal modalities.

the xBD-disaster setup, this thus depicts the challenging scenario of localizing a goal whose visual description is provided prior to a disaster, which may look drastically different when exploring the scene after said disaster. The evaluation dataset comprises 800 distinct search areas from both xBD-pre and xBD-disaster. These 800 search areas are identical in both xBD-pre and xBD-disaster. For each of these areas, we randomly select 5 pairs of start and goal locations corresponding to each value of \(\). We present the zero-shot generalization results using both xBD-pre and xBD-disaster in Table 3. The results show a substantial performance improvement _ranging between \(221.15\%\)_ to \(346.83\%\)_ compared to the baseline approaches and justify the effectiveness of _GOMAA-Geo_ in zero-shot generalization.

## 6 Further Analyses and Ablation Studies

**Effectiveness of the CLIP-MMFE module.** In addition to the quantitative results in Table 2, we here conduct a qualitative analysis to assess the effectiveness of the CLIP-MMFE module in learning a modality-agnostic goal representation. For this purpose, we employ the _GOMAA-Geo_ model trained on the Masa dataset. During the evaluation, we maintain a fixed search area with identical start and goal locations while varying the goal modality, and then compare the exploration behavior of _GOMAA-Geo_ in each scenario. Our observations (Figure 4) reveal that exploration behaviors are consistent across different goal modalities. This suggests that the learned representation of the goal token remains consistent regardless of the goal modality, given that the other components of the _GOMAA-Geo_ framework remain fixed in each scenario. Additional visualizations are in the section B.

**Importance of learning a goal conditioned policy.** To investigate the significance of goal information in the _GOMAA-Geo_ framework, we assess a _GOMAA-Geo_ variant - denoted _Mask-GOMAA_ - where we mask out the goal token and compare its performance against the full _GOMAA-Geo_. Results on the Masa dataset are presented in Table 4. We observe a substantial drop in performance ranging from \(40.40\%\) to \(54.50\%\) across different evaluation settings, underscoring the critical role of goal information in learning an effective policy for AGL.

   Method & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) \\  Mask-GOMAA & 0.2913 & 0.3566 & 0.4912 & 0.5200 & 0.5478 \\
**GOMAA-Geo** & **0.4090** & **0.5056** & **0.7168** & **0.0834** & **0.7854** \\   

Table 4: Providing goal information is crucial.

Figure 4: **Example exploration behavior of _GOMAA-Geo_ across different goal modalities.** The stochastic policy selects actions probabilistically, whereas the _argmax_ policy selects the action with the highest probability.

    &  &  \\  Method & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) \\  Random & 0.1412 & 0.0584 & 0.0640 & 0.0247 & 0.0236 & 0.1412 & 0.0584 & 0.0640 & 0.0247 & 0.0236 \\ PPO & 0.1237 & 0.1262 & 0.1425 & 0.1737 & 0.2075 & 0.1132 & 0.1146 & 0.1292 & 0.1665 & 0.1953 \\ DiT & 0.1132 & 0.2341 & 0.3198 & 0.3664 & 0.3772 & 0.1012 & 0.2389 & 0.3067 & 0.3390 & 0.3543 \\ AiRLoc & 0.1191 & 0.1254 & 0.1436 & 0.1676 & 0.2021 & 0.1201 & 0.1298 & 0.1507 & 0.1631 & 0.1989 \\ 
**GOMAA-Geo** & **0.3825** & **0.4737** & **0.6808** & **0.7489** & **0.7125** & **0.4002** & **0.4632** & **0.6553** & **0.7391** & **0.6942** \\   

Table 3: _GOMAA-Geo_ showcases superior zero-shot generalization than the alternatives in all settings.

**Importance of the planner module.** To evaluate the significance of the planner module, we conduct experiments when removing it from _GOMAA-Geo_ and compare the performance of this modified version, termed _LLM-Geo_, with the original _GOMAA-Geo_. The only distinction between _LLM-Geo_ and _GOMAA-Geo_ is the presence of the planner module in the latter. We compare their performances across various evaluation settings using the Masa dataset, with results presented in Table 5. We observe that the performance of _LLM-Geo_ is significantly inferior to _GOMAA-Geo_, with performance gaps ranging from \(75.46\%\) to \(129.66\%\) across various evaluation settings. The empirical results indicate that relying solely on the LLM is insufficient for solving tasks that involve planning, highlighting the importance of combining an LLM - which excels at capturing history - with a planning module that learns to make decisions while considering future outcomes.

**Visualizing the exploration behavior of GOMAA-Geo.** In Figure 5, we present a series of exploration trajectories generated using the trained stochastic policy for a specific start and goal pair. Alongside these trajectories, we include an additional exploration trajectory obtained using the deterministic (argmax) policy. Please refer to the appendix for several additional qualitative results.

**Efficacy of GASP pretraining.** We assess the effectiveness of GASP (cf. Section 4) by comparing the performance of the original _GOMAA-Geo_ with a version of _GOMAA-Geo_ that involves pre-training an LLM using a commonly used input token masking-based autoregressive modeling task tailored for AGL. We call the resulting _GOMAA-Geo_ model _R_elative _P_osition to _GO_al aware _GOMA_ (_RPG-GOMAA_). Details of the _RPG-GOMAA_ framework, along with the masking-based LLM pre-training strategy, are provided in the appendix section F. We compare the performance of _GOMAA-Geo_ with _RPG-GOMAA_ on the Masa dataset and present the results in Table 6. Our findings indicate that RPG-GOMAA _shows a significant decline in performance compared to_ GOMAA-Geo _as the distance between the start to the goal \(\) increases_, which highlights the efficacy of GASP in learning an effective history-aware policy for AGL. We also compare the zero-shot generalization capabilities of these methods using the xBD-disaster dataset and report the results in the appendix section E.

Furthermore, we qualitatively assess GASP's effectiveness in learning a history-aware representation for planning. To achieve this, we choose a task where _GOMAA-Geo_ successfully locates the goal. We then remove the context by masking out all previously visited states and actions except for the current state \(x_{t}\) and goal state \(x_{g}\), and observe the action selected by the policy. We compare this action to what the policy selects when the entire history is provided as input to the LLM (i.e., the default _GOMAA-Geo_). From Figure 6 we see that the policy takes optimal actions with context but suboptimal actions without it, which suggests that

   Method & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) \\  RPG-GOMAA & **0.4116** & **0.5167** & 0.6589 & 0.7643 & 0.7023 \\
**GOMAA-Geo** & 0.4090 & 0.5056 & **0.7168** & **0.8034** & **0.7854** \\   

Table 6: GASP (bottom) yields the best results overall.

Figure 5: Examples of successful exploration behaviors of _GOMAA-Geo_.

Figure 6: _GOMAA-Geo_ (red) vs. GOMAA-Geo w/o history (white).

   Method & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) \\  LLM-Geo & 0.2331 & 0.2591 & 0.3121 & 0.3967 & 0.4051 \\
**GOMAA-Geo** & **0.4090** & **0.5056** & **0.7168** & **0.8034** & **0.7854** \\   

Table 5: On the importance of the planner module.

the LLM trained via GASP effectively learns a history-aware representation suitable for planning. Additional visualizations are in the appendix section E.

**Failure cases of _GOMAA-Geo_.** Some failure cases are shown in Figure 7. In scenarios where the goal patch is very similar to many other patches in the search space, _GOMAA-Geo_ can become unsuccessful (such scenarios are very confusing even for humans).

**Effectiveness of proposed dense reward function.** Here we investigate the effectiveness of the proposed reward function (see Equation 6 in the main paper) for learning an efficient policy for active geo-localization tasks. We achieve this by training the planner module with a sparse reward function that assigns a positive reward of 1 exclusively upon reaching the desired goal location, and 0 otherwise. Throughout this analysis, we maintain all other components of the original _GOMAA-Geo_ framework and training hyperparameters unchanged. The resulting framework is referred to as _Sparse-GOMAA_. We proceed to compare the performance of _GOMAA-Geo_ and _Sparse-GOMAA_ under various evaluation settings using the Masa dataset. The findings of this evaluation are presented in Table 7 (left). We observe _a significant and consistent drop in performance in terms of SR across all evaluation settings, ranging from 10.71\(\%\) to 22.10\(\%\)_. The observed outcomes of the experiment suggest that dense reward is indeed helpful for learning an efficient policy for active geo-localization. Additionally, we assess the zero-shot generalizability of _Sparse-GOMAA_ using xBD-disaster data and compare its performance against _GOMAA-Geo_ (right part of Table 7). We notice that the performance gap widens further, which indicates that the policy learned with the sparse reward function exhibits limited generalization capability.

## 7 Conclusions

We have introduced _GOMAA-Geo_, a goal modality agnostic active geo-localization agent designed for zero-shot generalization across different goal modalities. Our method integrates cross-modality contrastive learning to align representations across modalities, supervised foundation model pretraining, and reinforcement learning to develop highly effective navigation and localization policies. Extensive evaluations demonstrate that _GOMAA-Geo_ outperforms other approaches and generalizes across datasets - such as disaster-hit areas without prior exposure during training - and goal modalities (ground-level imagery, as well as textual descriptions), despite being trained solely with aerial view goals. We hope our framework will find applications ranging from search-and-rescue to environmental monitoring.

   =10\) in 5 \(\) 5 setting using Masa} & =10\) in 5 \(\) 5 setting using xBD-disaster} \\  Method & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) & \(=4\) & \(=5\) & \(=6\) & \(=7\) & \(=8\) \\  Sparse-GOMAA & 0.3562 & 0.4312 & 0.6009 & 0.7318 & 0.6978 & 0.3615 & 0.3842 & 0.5367 & 0.6455 & 0.6290 \\ 
**GOMAA-Geo** & **0.4090** & **0.5056** & **0.7168** & **0.8034** & **0.7854** & **0.4002** & **0.4632** & **0.6553** & **0.7391** & **0.6942** \\   

Table 7: On the effects of using a dense reward. Left: Evaluations on Masa. Right: Zero-shot evaluation using xBD-disaster. Using the proposed dense reward (bottom row) yields significantly better results than if training based on a sparse reward (top row).

Figure 7: Examples of failure cases of _GOMAA-Geo_. Common for each example is that the goal patch is very similar to many of the surrounding patches, which makes the search problems particularly challenging.