# Detecting Any Human-Object Interaction Relationship: Universal HOI Detector with Spatial Prompt Learning on Foundation Models

Detecting Any Human-Object Interaction Relationship: Universal HOI Detector with Spatial Prompt Learning on Foundation Models

 Yichao Cao

Southeast University

Qingfei Tang

Nanjing Enbo Tech.

Xiu Su

University of Sydney

Chen Song

Nanjing Enbo Tech.

Shan You

SenseTime

Xiaobo Lu

Southeast University

Chang Xu

University of Sydney

###### Abstract

Human-object interaction (HOI) detection aims to comprehend the intricate relationships between humans and objects, predicting \(<human,action,object>\) triplets, and serving as the foundation for numerous computer vision tasks. The complexity and diversity of human-object interactions in the real world, however, pose significant challenges for both annotation and recognition, particularly in recognizing interactions within an open world context. This study explores the universal interaction recognition in an open-world setting through the use of Vision-Language (VL) foundation models and large language models (LLMs). The proposed method is dubbed as _UniHOI_. We conduct a deep analysis of the three hierarchical features inherent in visual HOI detectors and propose a method for high-level relation extraction aimed at VL foundation models, which we call HO prompt-based learning. Our design includes an HO Prompt-guided Decoder (HOPD), facilitates the association of high-level relation representations in the foundation model with various HO pairs within the image. Furthermore, we utilize a LLM (_i.e._ GPT) for interaction interpretation, generating a richer linguistic understanding for complex HOIs. For open-category interaction recognition, our method supports either of two input types: interaction phrase or interpretive sentence. Our efficient architecture design and learning methods effectively unleash the potential of the VL foundation models and LLMs, allowing UniHOI to surpass all existing methods with a substantial margin, under both supervised and zero-shot settings. The code and pre-trained weights are available at: https://github.com/Caoyichao/UniHOI.

## 1 Introduction

Human-object interaction (HOI) detection [15; 7] is a burgeoning field of research in recent years, which stems from object detection and makes higher demands on high-level visual understanding. It plays a crucial role in many vision tasks, e.g., visual question answering, human-centric understanding, image generation, and activity recognition, to name a few representative ones. An excellent HOI detector must accurately localize all the interacting Human-Object (HO) pairs and recognize their interaction, typically represented as an HOI triplet in the format of \(<human,action,object>\).

Despite the optimistic progress made by various HOI detectors [27; 12; 18; 49; 14; 29; 8] in recent years, numerous challenges still persist . Naively mapping diverse interactions to one-hot labels is an exceedingly labor-intensive and costly process, which is prone to the loss of semantic information.

As the number and complexity of interaction categories increase, model optimization becomes increasingly difficult, and the universality of the model is consequently restricted.

Recently, multi-modal learning, especially Vision-and-Language (VL) learning, has become remarkably popular, achieving far-reaching success across a variety of domains . Multi-modal learning is capable of portraying multidimensional information in a more comprehensive manner by describing the same entity or spatio-temporal event through different modalities. Recently, a number of studies have endeavored to employ VL models for the HOI task with the aim of constructing transferable HOI detectors [52; 19; 28; 43; 45; 5]. For instance, PhraseHOI  harnessed a pre-trained word embedding model to generate a fixed-length linguistic representation for the HOI task. Unfortunately, these methods harness cross-modal knowledge in an overly constrained manner, falling short of fully exploiting the potential of cross-modal knowledge and LLMs within the HOI detection domain.

Upon rigorous examination, we identify several intrinsic limitations in the existing methodologies: (1) Limited scalability: Model training is overly reliant on annotated data, which restricts them to a finite set of categories. (2) Suboptimal adaptability in zero-shot settings: Even HOI-VLM approaches can only harness a limited number of word embeddings to accommodate unseen categories, thereby curtailing their adaptability. (3) Inability to quickly comprehend complex interactive behaviors from succinct descriptions, as humans can, indicating a dearth of a more universal and flexible framework for HOI detection.

Considering the recent outstanding performance of VL foundation models and LLMs in various fundamental tasks, in this paper, we attempt to harness the capabilities of such large models to facilitate more general HOI detector, as shown in Figure 1. We conduct an in-depth analysis of the clear three-tier visual feature hierarchy in visual HOI detectors, effectively utilizing the foundation models to boost the understanding of high-level interactive semantics within images. The employment of large models bridges the gap between textual and visual modalities, making a knowledge-based universal HOI detector feasible. In summary, the contributions of this paper are as follows:

* We propose the first visual-textual foundation model-based framework for HOI detection (UniHOI), which significantly improves the accuracy and universality compared to previous HOI detectors that solely rely on training from specific datasets. Our UniHOI method is expected to guide the HOI detection field into a new research phase.
* We treat the visual HOI detector as a three-tier visual feature hierarchy and appropriately design an efficient human-object prompt learning method, enabling visual HOI detectors to effectively query interaction tokens associated with specific HO pairs in foundation models, and thus obtain a more universal HO relationship representations.
* We devise a knowledge-based zero-shot HOI recognition method that leverages large models such as GPT to generate descriptive knowledge for specific interaction categories, guiding visual detectors in zero-shot recognition of the corresponding categories. This approach

Figure 1: Comparison between HOI detection pipelines. Traditional HOI Detectors rely on manually annotated image datasets for training, which limits their generality and scalability. Previous HOI-VLM methods only achieved limited knowledge transfer from language models to visual HOI detectors, utilizing only a small amount of word embeddings for learning. The proposed UniHOI supports the input of any textual information (annotations or explanations) to detect any interaction relationship, fully unleashing the potential of foundation models and LLMs.

breaks free from the limitations of traditional zero-shot recognition methods, which can only learn from word embeddings, and offers insights for a more universal open-category HOI recognition system.

## 2 Related Work

**Generic HOI Detection.** Based on their architectural design, existing HOI (Human-Object Interaction) detection approaches can be broadly categorized into two groups: two-stage methods [49; 7; 12; 13; 27; 18], and one-stage methods [14; 20; 53; 29; 8]. One-stage methods typically adopt a multitask learning strategy to simultaneously execute instance detection and interaction relation modeling [29; 47; 30]. Conversely, two-stage methods initially conduct object detection, followed by interaction relation modeling for all candidate HO pairs. By fully exploiting the capabilities of each module, two-stage methods have showcased superior detection performance . While these methods have significantly propelled the progress of early HOI detection, they still grapple with the issue of limited generality.

**Language Semantics for Vision.** Driven by the notable success of large-scale models such as GPT-4 , the incorporation of language semantics to augment vision models has recently surfaced as a promising avenue in the realm of computer vision tasks [38; 41; 1; 50]. Among these, Vision-and-Language Pre-training (VLP) [34; 24] has evolved into a popular paradigm across numerous vision-and-language tasks, owing to its ability to learn generalizable multimodal representations from extensive image-text data [1; 9; 10]. These methods have recently found applications in multimodal retrieval , vision-and-language navigation , among others . Nevertheless, implementing effective prompt-based learning on base models, particularly extracting high-order relationships in intricate scenarios, remains crucial for the successful deployment of large models. Thus, investigating how to efficaciously extract specific information from large models is of utmost importance.

**HOI Vision-and-Language Modeling (HOI-VLM).** Despite the moderate success of previous HOI detectors [47; 49; 31], these often perceive interactions as discrete labels, overlooking the rich semantic text information encapsulated in triplet labels. Of late, a handful of researchers [52; 19; 28; 43; 45; 46] have delved into HOI Vision-and-Language Modeling in an effort to further enhance HOI detection performance. Among these, , , and  have primarily focused on incorporating language prior features into HOI recognition. Meanwhile, RLIP  and  have proposed the construction of a transferable HOI detector via the VLP approach. Serving as applications and extensions of Vision-and-Language learning within the HOI domain, these HOI-VLM methodologies strive to comprehend the content and relations between visual interaction features and their respective triplet texts. Nevertheless, these methodologies harness cross-modal knowledge in a markedly restricted manner, falling short of fully unleashing the potential of cross-modal knowledge and LLMs within the HOI domain.

## 3 Method

### Overview

In traditional HOI detection task, the objective is typically to optimize a detector \(_{_{}}\), such as the most commonly-used Transformer-based detectors in recent years. By inputting a query \(^{ho}\) related to the Human-Object (HO) pairs, the HOI detector learns the location of the HO pairs and corresponding interactions in images. This optimization objective can be formulated as follows:

\[\ _{()_{}}[( ,_{_{}}(,^{ho}))]\] (1)

where \(\) and \(\) are ground-truth labels and overall loss function respectively, \(_{}=\{(_{i})\}_{i=1}^{||}\) denotes the HOI image dataset, \(\) represents the input image, and \(\) indicates the weights in HOI detector \(_{_{}}\). Thus, traditional HOI detectors rely on purely visual detection tasks for optimization.

In this work, our aim is to utilize superior VL foundation models and additional interaction interpretation \(\) during the training and inference process. In this way, we can improve the optimization objective as follows:

\[\ _{(,)}[( ,_{_{}}(,^{ho}),_{ _{}}(,,^{ho}))]\] (2)where \(_{_{}}\) denotes the Vision-Language (VL) foundation models and \(^{ho}\) represents the HOI-specific prompts for \(_{_{}}\). \(=\{(_{i},_{i})\}_{i=1}^{||}\) is an image-text corpus, where \(_{i}\) denotes the \(i\)-th input image and \(_{i}\) represents the phrase annotations (_e.g._ "Human ride bicycle") in \(_{i}\). In zero-shot setting, we also use knowledge retrieval to enrich the texts \(\). Details will be described in Section 3.4.

In HOI detection, the detector not only needs to accurately locate the position of the interacting HO pair, but also needs to reliably model the interaction relationship occurring in the HO pair. But these two tasks have different requirements on the image feature level: the former focuses more on the edges and contours of instances, while the latter focuses more on high-level relational cues. To present and analyze this complicated process more clearly, we explicitly divide the feature learning in HOI detector into three stages: _basic visual feature extraction_, _instance-level feature learning_, and _high-level relationship modeling_, as shown in Figure 2. The basic visual feature extraction is usually performed by the backbone (_e.g._ CNN). For the instance-level feature learning, we follow previous methodologies and design prompts related to HO locations to carry and transfer the position information, then apply the Hungarian algorithm for matching with the \(\), and compute the loss of the bounding box. The third stage, which is the key focus of this study, involves using spatial location prompts related to the HO pairs to conduct targeted prompt learning from the visual model. The details of each component are explained in the following sections.

### HO Spatial Prompts Generation

We follow the Transformer-based detection architectures  to conduct basic visual feature extraction and instance detection. Fed with an input image \(^{H W C}\), the CNN generates a feature map \(^{v}^{h w c}\). Then, \(^{v}\) is compressed by a projection convolution layer with a kernel size \(1 1\). Next, a flatten operator is used to segment patch embeddings \(\{x_{1}^{v},x_{2}^{v},,x_{N^{v}}^{v}\}\), where \(N^{v}\) is the number of patch embeddings. The patch embeddings \(\{x_{1}^{v},x_{2}^{v},,x_{N^{v}}^{v}\}\) is then linearly projected through a linear transformation \(^{v}^{c D^{v}}\). Thus, the input for instance detection are calculated via summing up the projected embeddings and position embeddings \(^{v}_{pos}^{N^{v} D^{v}}\):

\[^{p}^{N^{v} D^{v}}=[x_{1}^{v}^{v};x_ {2}^{v}^{v};;x_{N^{v}}^{v}^{v}]+^{v}_{pos}\] (3)

After patching and sequencing the features extracted by CNN, we follow previous methods to perform self-attention on \(^{p}\): \(=_{_{}}(^{p})^{N^{v} D^{v}}\). This process is implemented by a Transformer encoder \(_{_{}}\), which is composed of \(N\) Transformer encoder layers.

For instance-level feature learning, we deploy an instance decoder \(_{_{}}\) to locate the positions of humans and objects. Based on the \(\), humans and objects are detected through the human query set

Figure 2: **Overview of the UniHOL** Its feature hierarchy is divided into three levels. After the first two levels achieve instance detection for humans and objects, we designed a HO spatial prompt learning method, which extracts more generic higher-level relationship representations associated with HO pairs from the VL foundation models. For open-category interaction detection, UniHOI supports annotations or retrieved texts input, and then determine whether the interaction described in the input text occurs between each HO pair through feature similarity measurement.

\(^{h}^{N^{q} D^{v}}\) and the object query set \(^{o}^{N^{q} D^{v}}\) individually. Additionally, a position guided embedding \(^{g}^{N^{q} D^{v}}\) is added to assign the human and object queries at the same position as a pair. The calculation process of instance decoder \(_{_{D}}\) can be formulated simply as follows:

\[^{ho}^{2N^{q} D^{v}}=[^{h}, ^{o}]=_{_{D}}(,[ ^{h}+^{g},^{o}+^{g}])\] (4)

where the \(^{ho}\) is the spatial tokens highly correlated with HO pair location information, the \(N^{q}\) is the number of queries. With instance detection head \(s\), we can calculate the human bounding boxs \(^{h}^{N^{q} 4}\) from \(^{h}\), object bounding boxs \(^{o}^{N^{q} 4}\) and object categories \(^{o}^{N^{q} N^{c}}\) from \(^{o}\):

\[[^{h};^{o};^{o}]=s( [^{h},^{o}])\] (5)

where the feature tokens \([^{h},^{o}]\) are excellent spatial position features for HO pairs. Driven by prompt learning methods, we explore using the HO position features here to perform prompt learning on the VL foundation models.

### Prompting Foundation Models for HOI Modeling

Considering the excellent performance of BLIP2  in cross-modal tasks and the fact that its Transformer architecture also integrates well with our HOI framework, in this work we use BLIP2 as the VL foundation model to support the recognition process of HOI. However, accurately extracting HOI related features from VL foundation model is the key to successfully applying VL to HOI tasks.

To reduce the computational cost of the VL foundation model, we first downsample the input image \(\) to \(^{}\) with dimension \(W^{} H^{}\), and then use an image encoder \(_{_{}}\) to convert downsampled image into a feature map \(^{f}^{w^{} h^{} c^{}}\). We then employ Q-Former \(_{_{}}\) in BLIP2  to learn higher-level content \(^{q}^{N^{f} D^{f}}\) in image:

\[^{q}=_{_{}}(^{})=_{ _{}}_{_{}}(,^ {f})\] (6)

where the \(^{f}\) denotes the query in \(_{_{}}\). These modules in \(_{_{}}\) are more capable of understanding content in images than regular visual detectors due to extensive training on a wider range of data.

Then, we consider how to extract the complex interaction representations between specific humans and objects in foundation model. To associate the higher-level information in foundation model with HO pairs, we design a HO Prompt-guided Decoder (HOPD) \(_{_{}}\) to correlate the position information of HO pairs with feature tokens in foundation model:

\[^{f}=_{_{}}((^{h}+^{o})/ 2,^{q})\] (7)

where the \(^{f}\) denotes the high-level information tokens corresponding to HO pairs. In this manner, the HOI-specific tokens is generated under the guidance of the guidance of the human-object query pairs. This spatial prompts act as query embeddings in HOPD, interact with each other through self-attention layers, and interact with frozen image features through cross-attention layers (inserted every other transformer block in HOPD). In this way, these spatial prompts are fed into HOPD, which in turn goes on to query information about the relationships between their respective corresponding HO pairs. In addition, interaction decoding is performed in the visual HOI detector:

\[^{i}=_{_{}}((^{h}+ ^{o})/2,)\] (8)

Finally, we concatenate \(^{f}\) and \(^{f}\) as the visual representations of the HO pairs and feed them to a FFN to predict the interaction category. For model training, we adhere to the precedent set by query-based methods , utilizing the Hungarian algorithm to assign a corresponding prediction for each ground-truth instance. The loss and hyperparameters used for model optimization in this paper follow those of previous work . More details are provided in the Appendix.

### Knowledge Retrieval for HOI Reasoning in Open World

In previous zero-shot HOI detectors, the recognition of unseen categories is usually achieved by directly using word embeddings and visual features for similarity measures. The problem with this approach is that it relies only on simple word embeddings, which may not be sufficiently detailed and rich in the representation of HOIs. The model may not recognize some special categories well enough. Inspired by the human understanding of interactions, we propose a method for HOI detection in an open world based on descriptive text.

The impressive performance of large-scale pretrained language models, as well as the potentially enormous amount of implicitly stored knowledge, raises extensive attention about using language models as an alternative to conventional structured knowledge bases (LMs-as-KBs). In particular, the rapid development of the chatGPT family of LLM models in the last two years inspired us to obtain richer and more comprehensive knowledge descriptions, called GPTs-as-KBs. Theoretically, the performance of the visual model can be improved theoretically by transferring a larger amount of knowledge that can be effectively integrated into the visual model. Given an input image \(^{i}\) and corresponding descriptions \(_{i}\) in \(=\{(_{i},_{i})\}_{i=1} ^{||}\), different phrase descriptions are linked with different HO pairs. We propose expanding the existing phrase descriptions \(^{i}\) to obtain richer and more comprehensive knowledge descriptions \(^{i}\). These descriptive knowledge facilitate more accurate interaction descriptions in zero-shot and open-vocabulary HOI recognition.

To obtain richer and more comprehensive knowledge descriptions, we design a knowledge retrieval process for LLM. We have designed a knowledge query statement for chatGPT, such as "Knowledge retrieve for \(verb\_object\), limited to \(N\) words", to guide LLMs in explaining the interaction categories we are interested in. In this way, the transferable textual knowledge will be richer and the interpretation of the interactions will be closer to the way humans understand them. As an illustration, let us consider the phrase "Human ride bicycle" and "Human throw frisbee". The knowledge retrieval process yields the following example result:

* _Riding a bicycle involves balance, coordination, and physical exertion. The rider mounts the bike, propels forward by pushing pedals with their feet. Steering is achieved by turning handlebars. Brakes slow or stop the bike. Helmets are worn for safety._
* _Throwing a frisbee involves grasping the disc, typically with a forehand grip, then swinging the arm and releasing the frisbee at the right moment for it to glide through the air. Direction and distance depend on the angle and speed of the throw. It's a common recreational activity._

These detailed text descriptions can better guide the learning of visual features in open-category recognition. A more detailed open-category inference process is provided in the Appendix.

## 4 Experiments

### Implementation Details

We evaluate our model on two public benchmarks, HICO-Det  and V-COCO . We adopt the BLIP2  model as the VL foundation model in our UniHOI. We map the 768-dimensional features output by Q-Former in BLIP2 to 256 dimensions to adapt to the feature dimension of the visual HOI detector. The number of layers in the HO Prompt-guided Decoder is identical to that in the Interaction Decoder. The output features of these two decoders are concatenated to generate the final category prediction. The model's optimization method, learning rate, training epochs, weight decay, and loss weights, among other hyperparameters, are set in accordance with previous methods to ensure fair comparison. Aside from the ablation studies in Section 4.6 where we employed knowledge retrieval to further enhance model performance, in all other experiments we continue to use annotated phrases for model learning and inference to ensure fair comparison with other methods. All the experiments conducted with a batchsize of 16 on 8 Tesla V100 GPUs. The details of datasets, evaluation metrics, model parameters, computational overhead, _etc_. will be introduced in Appendix.

### HOI Detection in the Closed World

We compare the performance of our UniHOI with the previous representative and state-of-the-art methods such as ViPLO , GEN-VLKT , and HOICLIP . The detailed results of HICO-DET  and V-COCO  are summarized in Table 1 and 3, respectively. Generally, there are several observations drawn from different aspects: (_i_) The overall performance of our method is significantly superior to the previous state-of-the-art methods. (_ii_) Whether the visual feature extractor adopts the ResNet-50 or ResNet-101, our method yields excellent performance, especially a stronger backbone that can bring further improvements. (_iii_) As shown in Tables 2, our approach also has a significant performance lead compared to those methods that rely on additional data sets (_i.e._, Human Pose , and Vision-and-Language ). Figure 3 shows the training process of UniHOI-s and GEN-VLKT-s on the V-COCO dataset. Figure 4 shows some prediction cases of UniHOI on HICO-DET.

### Comparisons with Methods that Utilize Extra Information

Table 2 presents several methods that utilize extra information (_i.e._, pose, and language) from additional datasets for HOI detection. Theoretically, the introduction of extra information can indeed further enhance visual models in specific domains. The results demonstrate that the proposed UniHOI still significantly outperforms previous methods.

   &  &  \\  Method & Backbone & Full & Rare & Non-rare & Full & Rare & Non-rare \\   Two-stage Methods: & & & & & & & \\ ATL  & ResNet-50 & 23.81 & 17.43 & 27.42 & 27.38 & 22.09 & 28.96 \\ VSGNet  & ResNet-152 & 19.80 & 16.05 & 20.91 & - & - & - \\ DJ-RN  & ResNet-50 & 21.34 & 18.53 & 22.18 & 23.69 & 20.64 & 24.60 \\ VCL  & ResNet-50 & 23.63 & 17.21 & 25.55 & 25.98 & 19.12 & 28.03 \\ DRG  & ResNet-50-FPN & 24.53 & 19.47 & 26.04 & 27.98 & 23.11 & 29.43 \\ IDN  & ResNet-50 & 24.58 & 20.33 & 25.86 & 27.89 & 23.64 & 29.16 \\ FCL  & ResNet-50 & 25.27 & 20.57 & 26.67 & 27.71 & 22.34 & 28.93 \\ SCG  & ResNet-50-FPN & 29.26 & 24.61 & 30.65 & 32.87 & 27.89 & 34.35 \\ UPT  & ResNet-50 & 31.66 & 25.90 & 33.36 & 35.05 & 29.27 & 36.77 \\ UPT  & ResNet-101 & 32.31 & 28.55 & 33.44 & 35.65 & 31.60 & 36.86 \\ ViPLO-s  & ViT-B/32 & 34.95 & 33.83 & 35.28 & 38.15 & 36.77 & 38.56 \\ ViPLO-1  & ViT-B/16 & 37.22 & 35.45 & 37.75 & 40.61 & 38.82 & 41.15 \\  One-stage Methods: & & & & & & & \\ PDDM  & Hourglass-104 & 21.94 & 13.97 & 24.32 & 24.81 & 17.09 & 27.12 \\ HOI-Trans  & ResNet-101 & 26.61 & 19.15 & 28.84 & 29.13 & 20.98 & 31.57 \\ AS-Net  & ResNet-50 & 28.87 & 24.25 & 30.25 & 31.74 & 27.07 & 33.14 \\ QPIC  & ResNet-101 & 29.90 & 23.92 & 31.69 & 32.38 & 26.06 & 34.27 \\ SSRT  & ResNet-101 & 31.34 & 24.31 & 33.32 & - & - & - \\ CDN-S  & ResNet-50 & 31.44 & 27.39 & 32.64 & 34.09 & 29.63 & 35.42 \\ CDN-L  & ResNet-101 & 32.07 & 27.19 & 33.53 & 34.79 & 29.48 & 36.38 \\ Liu _et al._ & ResNet-50 & 33.51 & 30.30 & 34.46 & 36.28 & 33.16 & 37.21 \\ MUREN  & ResNet-50 & 32.87 & 28.67 & 34.12 & 35.52 & 30.88 & 36.91 \\ GEN-VLKT-s  & ResNet-50 & 33.75 & 29.25 & 35.10 & 36.78 & 32.75 & 37.99 \\ GEN-VLKT-m  & ResNet-101 & 34.78 & 31.50 & 35.77 & 38.07 & 34.94 & 39.01 \\ GEN-VLKT-1  & ResNet-101 & 34.96 & 31.18 & 36.08 & 38.22 & 34.36 & 39.37 \\ HOICLIP  & ResNet-101 & 34.69 & 31.12 & 35.74 & 37.61 & 34.47 & 38.54 \\ Xie _et al._ (large)  & ResNet-101 & 36.03 & 33.16 & 36.89 & 38.82 & 35.51 & 39.81 \\  _UniHOI-s_ (w/ BLIP2) & ResNet-50 & 40.06 & 39.91 & 40.11 & 42.20 & 42.60 & 42.08 \\ _UniHOI-m_ (w/ BLIP2) & ResNet-101 & (+6.31) & (+10.66) & (+5.01) & (+5.42) & (+9.85) & (+4.09) \\ _UniHOI-m_ (w/ BLIP2) & ResNet-101 & 40.74 & 40.03 & 40.95 & 42.96 & 42.86 & 42.98 \\  & & (+5.96) & (+8.53) & (+5.18) & (+4.89) & (+7.92) & (+3.97) \\ _UniHOI-I_ (w/ BLIP2) & ResNet-101 & 40.95 & 40.27 & 41.32 & 43.26 & 43.12 & 43.25 \\  & & (+5.99) & (+9.09) & (+5.24) & (+5.04) & (+8.76) & (+3.88) \\  

Table 1: Experimental results on HICO-DET . GEN-VLKT  is regarded as baseline.

Figure 3: The training process of **UniHOI** and previous State-of-the-Art **GEN-VLKT** on V-COCO dataset.

### Effectiveness for Zero-Shot HOI Detection

**Unseen Composition (UC).** As shown in Table 4, we follow the  to conduct three kind of zero-shot experiments on HICO-DET. We first evaluate UniHOI-s with UC setting. Compared with GEN-VLKT , our UniHOI-s substantially outperforms previous state-of-the-art on both RF-UC and NF-UC. Among them, UniHOI are 7.32mAP higher than GEN-VLKT on Unseen of RF-UC, and 9.25mAP higher than GEN-VLKT on Seen of NF-UC. This improvement is mainly due to our efficient prompt learning method for the foundation model, so UniHOI can cope well with some unseen categories. In fact, GEN-VLKT also performs some knowledge transfer from CLIP, but it lags behind UniHOI in the effectiveness of knowledge transfer.

**Unseen Object (UO).** For UO setting, compared with GEN-VLKT, UniHOI improves Unseen, Seen, and Full by 9.21, 5.84, and 5.93, respectively. This result proves that our method can still understand the interaction between human and novel objects well.

**Unseen Verb (UV).** On the challenging UV setting, compared to GEN-VLKT, UniHOI improves by 9.21, 5.84 and 5.93 on Unseen, Seen, and Full, respectively. In fact, on the three zero-shot settings mentioned above, the HOI recognition capability of UniHOI have almost surpassed some supervised

  Method & Type & Unseen & _Seen_ & Full \\   Shen _et al._ & UC & 5.62 & - & 6.26 \\ FG  & UC & 10.93 & 12.60 & 12.26 \\ ATL  & UC & 16.99 & 20.51 & 19.81 \\  VCL  & RF-UC & 10.06 & 24.28 & 21.43 \\ ATL  & RF-UC & 9.18 & 24.67 & 21.57 \\ FCL  & RF-UC & 13.16 & 24.23 & 22.01 \\ GEN-VLKT  & RF-UC & 21.36 & 32.91 & 30.56 \\ _(**_Unillon+_**w (BLIP2)) for NE & **26.86\(\)**(732).33\(\)**(16.02\(\)0.25) & **32.27\(\)**(71.71) \\   & UCI & IN-UC & 16.22 & 18.52 & 18.06 \\ ATL  & NF-UC & 18.25 & 18.78 & 18.67 \\ FCL  & NF-UC & 18.66 & 19.55 & 19.37 \\ GEN-VLKT  & NF-UC & 25.05 & 23.38 & 23.71 \\
**_Unillon+_**w (BLIP2)) for NE & **28.45\(\)**(53.43\(\)**).23 & **26.63\(\)**(925) & **31.79\(\)**(0.08) \\   & GEN-VLKT  & UC & 10.51 & 28.92 & 25.63 \\ FCL  & **NF-UC** & **19.72\(\)**(921) & **34.76\(\)**(5.84) & **31.56\(\)**(5.93) \\  GEN-VLKT  & UV & 20.96 & 30.23 & 28.74 \\
**_Unillon+_**w (BLIP2)) & UV & **26.05\(\)**(5.09) & **36.78\(\)**(65.55) & **34.68\(\)**(5.94) \\  

Table 4: Zero-shot results on HICO-DET .

Figure 4: Detection results of our UniHOI in HICO-DET .

    & &  &  \\   & &  &  & \\  Method & Extras & Full & Rare & Non-rare & Full & Rare & Non-rare & \(AP_{role}^{\#1}\) & \(AP_{role}^{\#2}\) \\   FCMNet  & P+L & 20.41 & 17.34 & 21.56 & 22.04 & 18.97 & 23.12 & 53.1 & - \\ PD-Net  & L & 20.76 & 15.68 & 22.28 & 25.59 & 19.93 & 27.28 & - & - \\ DRG  & P & 24.53 & 19.47 & 26.04 & 27.98 & 23.11 & 29.43 & 51.0 & - \\ ConseNet-F  & P & 24.39 & 17.10 & 26.56 & - & - & - & 53.2 & - \\ RLIP-ParSeD  & L & 30.70 & 24.67 & 32.50 & - & - & - & - & \\ RLIP-ParSe  & L & 32.84 & 26.85 & 34.63 & - & - & - & 61.9 & 64.2 \\ PhraseHOI  & L & 30.03 & 23.48 & 31.99 & 33.74 & 27.35 & 35.64 & - & - \\ OCN (large)  & L & 31.43 & 25.80 & 33.11 & - & - & - & - & - \\ HOICLPIP  & L & 34.69 & 31.12 & 35.74 & 37.61 & 34.47 & 38.54 & 63.5 & 64.8 \\ 
**_UniHOI-s_** (w/ BLIP2) & L & 40.06 & 39.91 & 40.11 & 42.20 & 42.60 & 42.08 & 65.58 & 68.27 \\
**_UniHOI-m_** (w/ BLIP2) & L & 40.74 & 40.03 & 40.95 & 42.96 & 42.86 & 42.98 & 67.95 & 70.61 \\
**_UniHOI-l_** (w/ BLIP2) & L & 40.95 & 40.27 & 41.32 & 43.26 & 43.12 & 43.25 & 68.05 & 70.82 \\   

Table 2: Comparison results with the methods using extra datasets on HICO-DET dataset . For extra datasets, “P” indicates human pose and “L” indicates linguistic knowledge.

methods in Table 1. This once again attests to the superiority of our UniHOI for open-category HOI detection and its powerful capability to understand interactions.

### HOI Detection in the Wild

In addition to the zero-shot experiments on the HICO dataset, we also conducted open-category testing on open-world. Our UniHOI method supports flexible text input for detecting corresponding interactions. UniHOI can not only recognize category texts directly (e.g., "Juggle orange") but also take a descriptive text input (which could be human-written or knowledge retrieved from GPT). Consequently, interactions in images are identified through text representation. We present these detection results, along with some GPT-generated description texts, in Figure 5. Our test results indicate that open-vocabulary recognition based on interaction description texts is more reliable, and this phenomenon is also in line with our basic intuition. In the future, we will release our pretrained model and code to enable more extensive testing in the open world.

### Ablation Studies

**Effect of Foundation Model.** We conduct ablation studies on the new components within UniHOI (as shown in Tables 5 and 6). The GEN-VLKT-s is regarded as the baseline, and then incorporated various components for testing on the fully supervised V-COCO dataset, as well as the HICO-DET dataset under a zero-shot setting. Initially, we simply integrated the BLIP2 into our method in a sequential manner. We then used learnable queries to extract interaction features from Q-Former and concatenate them with \(^{i}\). However, the results did not yield a significant performance improvement.

**Impact of HO Spatial Prompting.** After realizing the alignment issue with the features of HO-pairs in the previous methods, we introduced the HO Prompt-guided Decoder, as presented in Section 3.3. The results clearly illustrate that the introduction of this component significantly improved all performance metrics, thereby validating the effectiveness of our prompting learning strategy.

**Effect of Knowledge Retrieval.** To substantiate the importance of utilizing LLM for knowledge retrieval in creating a more universal HOI detector, we also conduct supplementary experiments in this strategy. The results showed that the UniHOI model, when applying knowledge retrieval, achieved further performance improvements. We believe this approach opens new avenues for enhancement in the field of zero-shot HOI detection.

Figure 5: HOI Detection in the Wild. UniHOI is capable of conducting open-category detection based on triplet phrases and also supports the input of descriptive texts retrieved by GPT .

  Method & \(AP_{role}^{\#1}\) & \(AP_{role}^{\#2}\) & Method & Unseen & Seen & Full \\  baseline & 62.41 & 64.46 & baseline & 20.96 & 30.23 & 28.74 \\ + VL Foundation Model & 62.91 & 64.83 & + VL Foundation Model & 21.57 & 31.62 & 29.85 \\ + HOPD & 65.58 & 68.27 & + HOPD & 26.05 & 36.78 & 34.68 \\ + Knowledge Retrieval & **66.74** & **69.31** & + Knowledge Retrieval & **27.41** & **37.82** & **35.89** \\  

Table 6: Ablation Studies on HICO-DET (UV).

**Effect of Different Foundation Model.** To assess the impact of different Foundation Models on the performance of UniHOI, we also provide a comparative analysis between UniHOI equipped with CLIP and BLIP2. For CLIP, we feed its visual output representation into HOPD. However, given that CLIP's cross-modal contrastive training strategy leans more towards image-level representations , its output dimensionality is considerably lower than that of BLIP2, resulting in a less detailed feature representation. Experimental results indicate that both the UniHOI versions with CLIP and BLIP2 as the foundational models showed performance enhancements, with the latter exhibiting a more pronounced improvement. These findings underscore the efficacy and generalization of our approach.

## 5 Conclusion

In this work, we propose UniHOI, a universal HOI detection framework. By utilizing large foundation model, spatially prompting the large model, and generalizing the HOI detector to the open world. UniHOI supports open-category interaction relationship recognition from annotation texts or descriptions, which can be flexibly extended to applications in the open world. Extensive experiments on public datasets and diverse settings demonstrate its strong universality - it behaves the strongest open category interaction recognition ability so far. We believe our research will stimulate following research along the universal high-level relationship modeling direction in the future.