# Adaptive Algorithms for Relaxed

Pareto Set Identification

 Cyrille Kone\({}^{1}\)

cyrille.kone@inria.fr

&Emilie Kaufmann\({}^{1}\)

emilie.kaufmann@univ-lille.fr

Laura Richert\({}^{2}\)

laura.richert@u-bordeaux.fr

\({}^{1}\) Univ. Lille, Inria, CNRS, Centrale Lille, UMR 9198-CRIStAL, F-59000 Lille, France

\({}^{2}\) Univ. Bordeaux, Inserm, Inria, BPH, U1219, Sistm, F-33000 Bordeaux, France

###### Abstract

In this paper we revisit the fixed-confidence identification of the Pareto optimal set in a multi-objective multi-armed bandit model. As the sample complexity to identify the exact Pareto set can be very large, a relaxation allowing to output some additional near-optimal arms has been studied. In this work we also tackle alternative relaxations that allow instead to identify a relevant _subset_ of the Pareto set. Notably, we propose a single sampling strategy, called Adaptive Pareto Exploration, that can be used in conjunction with different stopping rules to take into account different relaxations of the Pareto Set Identification problem. We analyze the sample complexity of these different combinations, quantifying in particular the reduction in sample complexity that occurs when one seeks to identify at most \(k\) Pareto optimal arms. We showcase the good practical performance of Adaptive Pareto Exploration on a real-world scenario, in which we adaptively explore several vaccination strategies against Covid-19 in order to find the optimal ones when multiple immunogenicity criteria are taken into account.

## 1 Introduction

In a multi-armed bandit model, an agent sequentially collects samples from several unknown distributions, called arms, in order to learn about these distributions (pure exploration), possibly under the constraint to maximize the samples collected, viewed as rewards (regret minimization). These objectives have been extensively studied for different types of univariate arms distributions . In this paper, we consider the less common setting in which arms are multi-variate distributions. We are interested in the _Pareto Set Identification_ (PSI) problem. In this pure exploration problem, the agent seeks to identify the arms that are _(Pareto) optimal_, i.e. such that their expected values for all objectives are not uniformly worse than those of another arm.

We formalize this as a fixed-confidence identification problem: in each round \(t\) the agent selects an arm \(A_{t}\) using an adaptive _sampling rule_ and observes a sample \(_{t}^{D}\) from the associated distribution. It further uses an adaptive stopping rule \(\) to decide when to stop sampling and output a set of arms \(_{}\) which is her guess for (an approximation of) the true Pareto set \(^{}\). Given a risk parameter \((0,1)\), this guess should be correct with high probability, e.g. satisfy \((_{}=^{}) 1-\) for exact Pareto set identification, while requiring a small _sample complexity_\(\). This generalizes the well-studied fixed-confidence Best Arm Identification (BAI) problem [8; 15; 10] to multiple objectives.

Our motivation to study multi-objective adaptive identification stems from the design of adaptive early-phase clinical trials. In phase I/II trials, the effects of a molecule in humans are explored, and several biological endpoints may be assessed at the same time as indicative markers of efficacy. In particular, in the context of vaccine development, early-phase trials usually assess multiple immunogenicity endpoints (i.e. various markers of the effects of the vaccine on the immune system, such as different facets of antibody responses or other immune parameters). In the absence of a known correlate of protection during early clinical development, these endpoints may not have a clear _a priori_ hierarchy, may not all be correlated, which makes an examination of the Pareto set of different vaccinal strategies particularly relevant. In addition, given the availability of various vaccine platforms (such as mRNA vaccines, viral-vector vaccines, protein vaccines), as exemplified by Covid-19 vaccines, there may be a need to adaptively screen the various resulting vaccine strategies to select the most promising ones. Apart from clinical trials, active Pareto Set Identification can be meaningful in many real-word contexts, and we refer the reader to the various examples given by , such as in hardware or software design. Other applications include A/B/n testing for marketing or online recommender systems in which it is common to jointly optimize multiple (possibly conflicting) objectives such as user behavioral metrics (e.g. clicks, streams, dwell time, etc), supplier exposure objectives (e.g. diversity) and platform centric objectives (e.g. promotions) .

For many applications, the sample complexity of exact PSI can be prohibitive, either when there are many close to optimal arms or when the Pareto set is very large, and different relaxations have been considered in the literature . Going back to our motivation, in an adaptive trial that aims at pre-selecting a certain number of treatments or vaccine strategies for further investigations in clinical trials, practical constraints (the cost and feasibility of the trials) impose a constraint on the maximal number of interesting arms that can be identified. This motivates the introduction of a new setting where the agent is asked to identify _at most_\(k\) Pareto optimal arms. Interestingly the sampling rule that we propose for this setting can be used to solve (some generalizations of) other relaxations considered in the literature.

Related workThe work most closely related to ours is that of Auer et al. , who propose a relaxation, which we refer to as \(_{1}\)-PSI: their algorithm returns a set \(\) that contains w.h.p. all the Pareto optimal arms and possibly some sub-optimal arms, which when increased by \(_{1}\) coordinate-wise become Pareto optimal. For arms that have sub-Gaussian marginals, they provide an instance-dependent sample complexity bound scaling with some notion of sub-optimality gap for each arm. The work of Zaluaga et al.  studies a structured variant of fixed-confidence PSI in which the means are regular functions of arms' descriptors. They use Gaussian process modeling and obtain worse-case sample complexity bounds. In particular  considers the identification of an \(\)-cover of the Pareto set, which is a representative subset of the \(()\)-Pareto set that will be related to our \((_{1},_{2})\)-PSI criterion. The algorithms of  and those of  in the unstructured setting1 have the same flavor: they sample uniformly from a set of active arms and remove arms that have been found sub-optimal (or not representative). Auer et al. further adds an acceptation mechanism to stop sampling some of the arms that have been found (nearly-)optimal and are guaranteed not to dominate an arm of the active set. In this paper, we propose instead a more adaptive exploration strategy, which departs from such accept/reject mechanisms and is suited for different types of relaxation, including our novel \(k\)-relaxation.

Adaptive Pareto Exploration (APE) leverages confidence intervals on the differences of arms' coordinates in order to identify a single arm to explore, in the spirit of the LUCB  or UGapEc  algorithms for Top-\(m\) identification in (one-dimensional) bandit models. These algorithms have been found out to be preferable in practice to their competitors based on uniform sampling and eliminations , an observation that will carry over to APE. Besides the multi-dimensional observations, we emphasize that a major challenge of the PSI problem with respect to e.g. Top \(m\) identification is that the number of arms to identify is not known in advance. Moreover, when relaxations are considered, there are multiple correct answers. In the one-dimensional settings, finding optimal algorithms in the presence of multiple correct answers is notoriously hard as discussed by the authors of , and their lower-bound based approach becomes impractical in our multi-dimensional setting. Finally, we remark that the \(k\)-relaxation can be viewed as an extension of the problem of identifying any \(k\)-sized subset out of the best \(m\) arms in a standard bandit .

Beyond Pareto set identification, other interesting multi-objective bandit identification problems have been studied in the literature. For example  propose an algorithm to identify some particular arms in the Pareto set through a scalarization technique . The idea is to turn the multi-objective pure-exploration problem into a single-objective one (unique optimal arm) by using a real-valued preference function which is only maximized by Pareto optimal arms (see e.g  for some examples of these functions). In practice, a family of those functions can be used to identify many arms of the Pareto set but it is not always possible to identify the entire Pareto set using this technique (see e.g  for _weighted sum_ with a family of weights vectors). In a different direction, the authors of  introduce the feasible arm identification problem, in which the goal is to identify the set of arms whose mean vectors belong to a known polyhedron \(P^{D}\). In a follow up work , they propose a fixed-confidence algorithm for finding feasible arms that further maximize a given weighted sum of the objectives. In clinical trials, this could be used to find treatments maximizing efficacy (or a weighted sum of different efficacy indicators), under the constraint that the toxicity remains below a threshold. However, in the presence of multiple indicators of biological efficacy, choosing the weights may be difficult, and an examination of the Pareto set could be more suitable. Finally, some papers consider extensions of the Pareto optimality condition. The authors of  tackle the identification of the set of non-dominated arms of any partial order defined by an \(^{D}\) polyhedral ordering cone (the usual Pareto dominance corresponds to using the cone defined by the positive orthant \(^{D}_{+}\)), and they provide worst-case sample complexity in the PAC setting. The work of  studies the identification of the set of non-dominated elements in a _partially ordered set_ under the dueling bandit setting, in which the observations consists in pairwise comparison between arms.

Outline and contributionsFirst, we formalize in Section 2 different relaxations of the PSI problem: \(_{1}\)-PSI, as introduced by , \(_{1},_{2}\)-PSI, of which a particular case was studied by  and \(_{1}\)-PSI-\(k\), a novel relaxation that takes as input an upper bound \(k\) on the maximum number of \(_{1}\)-optimal arms that can be returned. Then, we introduce in Section 3 Adaptive Pareto Exploration, a simple, adaptive sampling rule which can simultaneously tackle all three relaxations, when coupled with an appropriate stopping rule that we define for each of them. In Section 4, we prove high-probability upper bounds on the sample complexity of APE under different stopping rules. For \(_{1}\)-PSI, our bound slightly improves upon the state-of-the-art. Our strongest result is the bound for \(_{1}\)-PSI-\(k\), which leads to a new notion of sub-optimality gap, quantifying the reduction in sample complexity that is obtained. Then, Section 5 presents the result of a numerical study on synthetic datasets, one of them being inspired by a Covid-19 vaccine clinical trial. It showcases the good empirical performance of APE compared to existing algorithms, and illustrates the impact of the different relaxations.

## 2 Problem Setting

In this section, we introduce the _Pareto Set Identification_ (PSI) problem and its relaxations. Fix \(K,D^{}\). Let \(_{1},,_{K}\) be distributions over \(^{D}\) with means \(_{1},,_{K}^{D}\). Let \(:=[K]:=\{1,,K\}\) denote the set of arms. Let \(:=(_{1},,_{K})\) and \(:=(_{1},,_{K})\). We use boldfaced symbols for \(^{D}\) elements. Letting \(^{D},u\), for any \(d\{1,,D\}\), \(^{d}\) denotes the \(d\)-th coordinate of \(\) and \(+u:=(X^{+}+u,,X^{D}+u)\). In the sequel, we will assume that \(_{1},,_{K}\) have \(1\)-subgaussian marginals 2.

**Definition 1**.: _Given two arms \(i,j\), \(i\) is weakly (Pareto) dominated by \(j\) (denoted by \(_{i}_{j}\)) if for any \(d\{1,,D\}\), \(_{i}^{d}_{j}^{d}\). The arm \(i\) is (Pareto) dominated by \(j\) (\(_{i}_{j}\) or \(i j\)) if \(i\) is weakly dominated by \(j\) and there exists \(d\{1,,D\}\) such that \(_{i}^{d}<_{j}^{d}\). The arm \(i\) is strictly (Pareto) dominated by \(j\) (\(_{i}_{j}\) or \(i j\)) if for any \(d\{1,,D\}\), \(_{i}^{d}<_{j}^{d}\)._

For \(^{D}_{+}\), the \(\)_-Pareto set_\(^{}_{}()\) is the set of \(\)-Pareto optimal arms, that is:

\[^{}_{}():=\{i  j:_{i}+ _{j}\}.\]

In particular, \(^{}_{}()\) is called the _Pareto set_ and we will simply write \(^{}()\) to denote \(^{}_{}()\). When it is clear from the context, we write \(^{}\) (or \(^{}_{}\)) to denote \(^{}()\) (or \(^{}_{}()\)). By abuse of notation we write \(^{}_{}\) when \(^{+}\) to denote \(^{}_{}\), with \(:=(,,)\).

In each round \(t=1,2,\), the agent chooses an arm \(A_{t}\) and observes an independent draw \(_{t}_{A_{t}}\) with \((_{A_{t}})=_{A_{t}}\). We denote by \(_{}\) the law of the stochastic process \((_{t})_{t 1}\) and by \(_{}\), the expectation under \(_{}\). Let \(_{t}:=(A_{1},_{1},,A_{t},_{t})\) the \(\)-algebra representing the history of the process. An algorithm for PSI consists in : i) a _sampling rule_ which determines which arm to sample at time \(t\) based on history up to time \(t-1\), ii) a _stopping rule_\(\) which is a stopping time w.r.t the filtration \((_{t})_{t 1}\) and iii) a _recommendation rule_ which is a \(_{}\)-measurable random set \(_{}\) representing the guess of the learner. The goal of the learner is to make a correct guess with high probability, using as few samples \(\) as possible. Before formalizing this, we introduce the different notion of correctness considered in this work, depending on parameters \(_{1},_{2} 0\) and \(k[K]\). Our first criterion is the one considered by .

**Definition 2**.: \(\) _is correct for \(_{1}\)-PSI if \(^{}^{}_{_ {1}}\)._

To introduce our second criterion, we need the following definition.

**Definition 3**.: _Let \(_{1},_{2} 0\). A subset \(S\) is an \((_{1},_{2})\)-cover of the Pareto set if : \(S^{}_{_{1}}\) and for any \(i S\) either \(i^{}\) or \( j S\) such that \(_{i}_{j}+_{2}\)._

The \(\)-accurate set of  is a particular case of \((_{1},_{2})\)-cover for which \(_{1}=_{2}=\). Allowing \(_{1}_{2}\) generalizes the notion of \(\)-correct set and can be useful, e.g., in scenarios when we want to identify the exact Pareto set (setting \(_{1}=0\)) but allow some optimal arms to be discarded if they are too close (parameterized by \(_{2}\)) to another optimal arm already returned. We note however that the _sparse cover_ of  is an \((,)\)-cover with and additional condition that the arms in the returned set should not be too close to each over. Identifying a sparse cover from samples requires in particular to identify \(^{}_{_{1}}\) hence it can not be seen as a relaxation of \(_{1}\)-PSI.

**Definition 4**.: \(\) _is correct for \((_{1},_{2})\)-PSI if it is an \((_{1},_{2})\)-cover of the Pareto set._

**Definition 5**.: \(\) _is correct for \(_{1}\)-PSI-\(k\) if either_ i)_\(||=k\) and \(^{}_{_{1}}\) or_ ii)_\(||<k\) and \(^{}^{}_{_ {1}}\) holds._

Given a specified objective (\(_{1}\)-PSI, \((_{1},_{2})\)-PSI or \(_{1}\)-PSI-\(k\)), and a target risk parameter \((0,1)\), the goal of the agent is to build a \(\)-correct algorithm, that is to guarantee that with probability larger than \(1-\), her guess \(_{}\) is correct for the given objective, while minimizing the number of samples \(\) needed to make the guess, called the _sample complexity_.

We now introduce two important quantities to characterize the (Pareto) optimality or sub-optimality of the arms. For any two arms \(i,j\), we let

\[(i,j) := _{1 d D}(_{j}^{d}-_{i}^{d}),(i,j):=_{1 d D}(_{i}^{d}-_{j}^{d}),\]

which have the following interpretation. If \(i j\), \((i,j)\) is the minimal quantity \( 0\) that should be added component-wise to \(_{i}\) so that \(_{i}+_{j}\), \(:=(,,)\). Moreover, \((i,j)>0\) if and only if \(i j\). Then, for any arms \(i,j\), if \(i j\), \((i,j)\) is the minimum quantity \(^{}\) such \(_{i}_{j}+^{}\), \(^{}:=(^{},,^{})\). We remark that \((i,j)<0\) if and only if \(i j\). Our algorithms, presented in the next section, rely on confidence intervals on these quantities.

## 3 Adaptive Pareto Exploration

We describe in this section our sampling rule, Adaptive Pareto Exploration, and present three stopping and recommendation rules to which it can be combined to solve each of the proposed relaxation. Let \(T_{k}(t):=_{s=1}^{t-1}(A_{s}=k)\) be the number of times arm \(k\) has been pulled up to round \(t\) and \(}_{k}(t):=T_{k}(t)^{-1}_{s=1}^{T_{k}(t)}_{k,s}\) the empirical mean of this arm at time \(t\), where \(_{k,s}\) denotes the \(s\)-th observation drawn _i.i.d_ from \(_{k}\). For any arms \(i,j\), we let

\[(i,j,t):=_{d}(_{j}^{d}(t)-_{i}^{d}(t)) (i,j,t):=_{d}(_{i}^{d}(t)-_{j}^{d}(t)).\]

The empirical Pareto set is defined as

\[S(t) := \{i: j:}_{i}(t)}_{j}(t)\},\] \[= \{i: j\{i\},(i, j,t)>0\}\;.\]

### Generic algorithm(s)

Adaptive Pareto Exploration relies on a _lower/upper confidence bound_ approach, similar to single-objective BAI algorithms like UGapEc , LUCB and LUCB++ . These three algorithms identify in each round two contentious arms: \(b_{t}\): a current guess for the optimal arm (defined as the empirical best arm or the arm with the smallest upper bound on its sub-optimality gap), \(c_{t}\): a contender of this arm; the arm which is the most likely to outperform \(b_{t}\) (in all three algorithms, it is the arm with the largest upper confidence bound in \([K]\{b_{t}\}\)). Then, either both arms are pulled (LUCB, LUCB++) or the least explored among \(b_{t}\) and \(c_{t}\) is pulled (UGapEc). The originality of our sampling rule lies in how to appropriately define \(b_{t}\) and \(c_{t}\) for the multi-objective setting. To define those, we suppose that there exists confidence intervals \([L^{d}_{i,j}(t,),U^{d}_{i,j}(t,)]\) on the difference of expected values for each pair of arms \((i,j)\) and each objective \(d D\), such that introducing

\[_{t}:=_{i=1}^{K}_{j i}_{d=1}^{D}L^ {d}_{i,j}(t,)^{d}_{i}-^{d}_{j} U^{d}_{i,j}(t,)} \ \ \ \ =_{t=1}^{}_{t},\] (1)

we have \(() 1-\). Concrete choices of these confidence intervals will be discussed in Section 3.2. To ease the notation, we drop the dependency in \(\) in the confidence intervals and further define

\[^{-}(i,j,t) := _{d}L^{d}_{i,j}(t)\ \ \ \ \ \ \ ^{+}(i,j,t):=_{d}U^{d}_{i,j}(t)\] (2) \[^{-}(i,j,t) := -\,^{+}(i,j,t)\ \ \ \ \ \ ^{+}(i,j,t):=-\,^{-}(i,j,t).\] (3)

**Lemma 1**.: _For any round \(t 1\), if \(_{t}\) holds, then for any \(i,j\), \(^{-}(i,j,t)(i,j)^{+}(i,j,t)\) and \(^{-}(i,j,t)(i,j)^{+}(i,j,t)\)._

Noting that \(^{}_{_{1}}=\{i: j i, (i,j)+_{1}>0\}\), we define the following set of arms that are likely to be \(_{1}\)-Pareto optimal:

\[^{_{1}}(t):=\{i: j \{i\},^{-}(i,j,t)+_{1}>0\}.\]

Sampling ruleIn round \(t\), Adaptive Pareto Exploration samples \(a_{t}\), the least pulled arm among two candidate arms \(b_{t}\) and \(c_{t}\) given by

\[b_{t} := *{argmax}_{i^{ _{1}}(t)}_{j i}^{+}(i,j,t),\] \[c_{t} := *{argmin}_{j b_{t}}^{-}(b_{t},j,t)\]

The intuition for their definition is the following. Letting \(i\) be a fixed arm, note that \((i,j)>0\) for some \(j\), if and only if there exists a component \(d\) such that \(^{d}_{i}>^{d}_{j}\) i.e \(i\) is not dominated by \(j\). Moreover, the larger \((i,j)\), the more \(i\) is non-dominated by \(j\) in the sense that there exists \(d\) such that \(^{d}_{i}^{d}_{j}\). Therefore, \(i\) is strictly optimal if and only if for all \(j i\), \((i,j)>0\) i.e \(_{i}:=_{j i}(i,j)>0\). And the larger \(_{i}\), the more \(i\) looks optimal in the sense that for each arm \(j i\), there exists a component \(d_{j}\) for which \(i\) is way better than \(j\). As the \(_{i}\) are unknown, we define \(b_{t}\) as the maximizer of an optimistic estimate of the \(_{i}\)'s. We further restrict the maximization to arms for which we are not already convinced that they are optimal (by Lemma 1, the arms in \(^{_{1}}(t)\) are (nearly) Pareto optimal on the event \(\)). Then, we note that for a fixed arm \(i\), \((i,j)<0\) if and only if \(i\) is strictly dominated by \(j\). And the smaller \((i,j)\), the more \(j\) is close to dominate \(i\) (or largely dominates it): for any component \(d\), \(^{d}_{i}-^{d}_{j}\) is small (or negative). Thus, for a fixed arm \(i\), \(*{argmin}_{j i}(i,j)\) can be seen as the arm which is the closest to dominate \(i\) (or which dominates it by the largest margin). By minimizing a lower confidence bound on the unknown quantity \((b_{t},j)\), our contender \(c_{t}\) can be interpreted as the arm which is the most likely to be (close to) dominating \(b_{t}\). Gathering information on both \(b_{t}\) and \(c_{t}\) can be useful to check whether \(b_{t}\) can indeed be optimal.

Interestingly, we show in Appendix E that for \(D=1\), our sampling rule is close but not identical to the sampling rules used by existing confidence-based best arm identification algorithms.

Stopping and recommendation rule(s)Depending on the objective, Adaptive Pareto Exploration can be plugged in with different stopping rules, that are summarized in Table 1 with their associated recommendations. To define those, we define for all \(i\), \(_{1},_{2} 0\),

\[g_{i}^{_{2}}(t):=_{j i}^{-}(i,j,t)+_{2} \{j^{_{1}}(t)\} h_{i} ^{_{1}}(t):=_{j i}^{-}(i,j,t)+_{1}.\]

and let \(g_{i}(t):=g_{i}^{0}(t)\). Introducing

\[Z_{1}^{_{1}}(t):=_{i S(t)}h_{i}^{_{1}}(t),\;\; \;\;Z_{2}^{_{1}}(t):=_{i S(t)^{}}( g_{i}(t),h_{i}^{_{1}}(t)),\]

for \(_{1}\)-PSI, our stopping rule is \(_{_{1}}:=\{t K:Z_{1}^{_{1}}(t)>0 Z_{2 }^{_{1}}(t)>0\}\) and the associated recommendation is \((_{_{1}})\) where

\[(t):=S(t)\{i S(t)^{}: j i:^{-}(i,j,t)>0\}\]

consists of the current empirical Pareto set plus some additional arms that have not yet been formally identified as sub-optimal. Those arms should be \((_{1})\)-Pareto optimal.

For \((_{1},_{2})\)-PSI we define a similar stopping rule \(_{_{1},_{2}}\) where the stopping statistics are respectively replaced with

\[Z_{1}^{_{1},_{2}}(t):=_{i S(t)}(g_{i}^{ _{2}}(t),h_{i}^{_{1}}(t))\;\;\;Z_{2}^{ _{1},_{2}}(t):=_{i S(t)^{}}(g_{i }^{_{2}}(t),h_{i}^{_{1}}(t))\]

with the convention \(_{}=+\), and the recommendation is \(^{_{1}}(_{_{1},_{2}})\).

To tackle the \(_{1}\)-PSI-\(k\) relaxation, we propose to couple \(_{_{1}}\) with an additional stopping condition checking whether \(^{_{1}}(t)\) already contains \(k\) arms. That is, we stop at \(_{_{1}}^{k}:=(_{_{1}},^{k})\) where \(^{k}:=\{t K:|\,^{_{1}}(t)| k\}\) with associated recommendation \(^{_{1}}(^{k})\). Depending of the reason for stopping (\(_{_{1}}\) or \(^{k}\)), we follow the corresponding recommendation.

**Lemma 2**.: _Assume \(\) holds. For \(_{1}\)-PSI (resp. \((_{1},_{2})\)-PSI, \(_{1}\)-PSI-\(k\)), Adaptive Pareto Exploration combined with the stopping rule \(_{_{1}}\) (resp. \(_{_{1},_{2}}\), resp. \(_{_{1}}^{k}\)) outputs a correct subset._

**Remark 1**.: _We decoupled the presentation of the sampling rule to that of the "sequential testing" aspect (stopping and recommendation). We could even go further and observe that multiple tests could actually be run in parallel, for free. If we collect samples with APE (which only depends on \(_{1}\)), whenever one of the three stopping conditions given in Table 1 triggers,_ for any values of \(_{2}\) or \(k\), _we can decide to stop and make the corresponding recommendation or continue and wait for another "more interesting" stopping condition to be satisfied. If \(\) holds, a recommendation made at any such time will be correct for the objective associated to the stopping criterion (third column in Table 1)._

### Our instantiation

We propose to instantiate the algorithms with confidence interval on the difference of pair of arms. For any pair \(i,j\), we define a function \(_{i,j}\) such that for any \(d[D]\), \(U_{i,j}^{d}(t)=_{i}^{d}(t)-_{j}^{d}(t)+_{i,j}(t)\) and \(L_{i,j}^{d}(t)=_{i}^{d}(t)-_{j}^{d}(t)-_{i,j}(t)\). We take from  the following confidence bonus for time-uniform concentration:

\[_{i,j}(t):=2(}{} )}{2})+_{a\{i,j\}}(4+(T_{a}(t))))(_ {a\{i,j\}}(t)})},\] (4)

where \(K_{1}:=K(K-1)D/2\) and \(C^{g} x+(x)\) is a calibration function. They result in the simple expressions \(^{}(i,j,t)=(i,j,t)_{i,j}(t)\) and \(^{}(i,j,t)=(i,j,t)_{i,j}(t)\). As an

   & Stopping condition & Recommendation & Objective \\  \(_{_{1}}\) & \(Z_{1}^{_{1}}(t)>0\; Z_{2}^{_{1}}(t)>0\) & \((_{_{1}})\) & \(_{1}\)-PSI \\  \(_{_{1},_{2}}\) & \(Z_{1}^{_{1},_{2}}(t)>0\; Z_{2}^{_{1}, _{2}}(t)>0\) & \(^{_{1}}(_{_{1},_{2}})\) & \((_{1},_{2})\)-PSI \\  \(^{k}\) & \(|^{_{1}}(t)| k\) & \(^{_{1}}(^{k})\) & \(_{1}\)-PSI-\(k\) \\  

Table 1: Stopping conditions and associated recommendation example, we state in Algorithm 1 the pseudo-code of APE combined the stopping rule suited for the \(k\)-relaxation of \(_{1}\)-PSI, which we refer to as \(_{1}\)-APE-\(k\).

``` Data: parameter \(_{1} 0\), \(k[K]\) initialize : sample each arm once, set \(t=K\), \(T_{i}(K)=1\) for any \(i\) for\(t=K+1,\), do \(S(t)=\{i: j\{i\},(i,j,t)>0\}\); \(^{_{1}}(t)=\{i: j \{i\},(i,j,t)-_{i,j}(t)+_{1}>0\}\); if\(|^{_{1}}(t)|\! k\)then break and output \(^{_{1}}(t)\) if\(Z_{1}^{_{1}}(t)>0\  Z_{2}^{_{2}}(t)>0\)then break and output \((t)=S(t)\{i S(t)^{}: j i:(i,j,t)-_{i,j}(t)>0\}\) \(b_{t}:=_{i^{_{ 1}}(t)}_{j i}[(i,j,t)+_{i,j}(t)]\); \(c_{t}:=_{i b_{t}}[(b_{t},j,t)-_{b_{t },j}(t)]\); sample\(a_{t}:=_{i\{b_{t},_{t}\}}\,T_{i}(t)\); ```

**Algorithm 1**\(_{1}\)-APE-\(k\): Adaptive Pareto Exploration for \(_{1}\)-PSI-\(k\)

In Appendix F, we also study a different instantiation based on confidence bounds of the form \(U_{i,j}(t)=U_{i}(t)-L_{j}(t)\) where \([L_{i}(t),U_{i}(t)]\) is a confidence interval on \(_{i}\). This is the approach followed by LUCB for \(D=1\) and prior work on Pareto identification . In practice we advocate the use of the pairwise confidence intervals defined above, even if our current analysis does not allow to quantify their improvement. For the LUCB-like instantiation, we further derive in Appendix F an upper bound on the expected stopping time of APE for the different stopping rules.

## 4 Theoretical analysis

In this section, we state our main theorem on the sample complexity of our algorithms and give a sketch of its proof.

First let us introduce some quantities that are needed to state the theorem. The sample complexity of the algorithm proposed by  for \((_{1})\)-Pareto set identification scales as a sum over the arms \(i\) of \(1/(_{i}_{1})^{2}\) where \(_{i}\) is called the sub-optimality gap of arm \(i\) and is defined as follows. For a sub-optimal arm \(i^{}()\),

\[_{i}:=_{j^{}}(i,j),\]

which is the smallest quantity that should be added component-wise to \(_{i}\) to make \(i\) appear Pareto optimal w.r.t \(\{_{i}:i\}\). For a Pareto optimal arm \(i^{}()\), the definition is more involved:

\[_{i}:=_{j\{i\}}_{j}&^{}:=\{i\}\\ (_{i}^{+},_{i}^{-})&\]

where

\[_{i}^{+}:=_{j^{}\{i\}}( (i,j),(j,i))\ _{i}^{-}:=_{j^{}}\{((j,i))^{+}+_{j}\}.\]

For \(x,(x)^{+}:=(x,0)\). We also introduce some additional notion needed to express the contribution of the \(k\)-relaxation. Let \(1 k K\). For any arm \(i\), let \(_{i}=_{j i}(i,j)\) and define

\[^{k}:=_{i}^{k}\,_{i},^{,k}: =*{argmax}_{i}^{1,k}\,_{i},\]

with the \(k\)-th max and first to \(k\)-th argmax operators. Observe that \(^{k}>0\) if and only if \(|^{}()| k\).

**Theorem 1**.: _Fix a risk parameter \((0,1)\), \(_{1} 0\), let \(k K\) and \(\) a bandit with \(1\)-subgaussian marginals. With probability at least \(1-\), \(_{1}\)-APE-\(k\) recommends a correct set for the \(_{1}\)-PSI-\(k\) objective and stops after at most_

\[_{a}_{a}^{2}}((_{a}})),\]

_samples, where for each \(a\), \(_{a}:=(_{a},_{1},^{k})\)._First, when \(k=K\), observing that \(_{1}\)-APE-\(K\) provides a \(\)-correct algorithm for \(_{1}\)-PSI, our bound improves the result of  for the \(_{1}\)-PSI problem in terms of constant multiplicative factors and \(^{-1}\) terms instead of \(^{-2}\). It nearly matches the lower bound of Auer et al. for the \(_{1}\)-PSI problem (Theorem 17 therein). It also shows the impact of the \(k\)-relaxation on the sample complexity. In particular, we can remark that for any arm \(i^{}^{,k}\), \((_{i},_{k})=_{k}\). Intuitively, it says that we shouldn't pay more than the cost of identifying the \(k\)-th optimal arm, ordered by the \(_{i}^{}\)s. A similar result has been obtained for the _any \(k-\)sized subset of the best \(m\)_ problem . But the authors have shown the relaxation only for the best \(m\) arms while our result shows that even the sub-optimal arms should be sampled less.

In Appendix D, we prove the following lower bound showing that in some scenarios, \(_{1}\)-APE-\(k\) is optimal for \(_{1}\)-PSI-\(k\), up to \(D(K)\) and constant multiplicative terms. We note that for \(_{1}\)-PSI a lower bound featuring the gaps \(_{a}\) and \(_{1}\) was already derived by Auer et al. .

**Theorem 2**.: _There exists a bandit instance \(\) with \(|^{}|=p 3\) such that for \(k\{p,p-1,p-2\}\) any \(\)-correct algorithm for \(0\)-PSI-\(k\) verifies_

\[_{}(_{})( )_{a=1}^{K}^{k})^{2}},\]

_where \(_{a}^{k}:=_{a}+^{k}\) and \(_{}\) is the stopping time of the algorithm._

In Appendix C, we prove that Theorem 1 without the \(^{k}\) terms also holds for \((_{1},_{2})\)-APE. This does not justifies the reduction in sample complexity when setting \(_{2}>0\) in \((_{1},_{2})\)-PSI observed in our experiments but it at least guarantees that the \(_{2}\)-relaxation doesn't make things worse.

Furthermore, since our algorithm allows \(_{1}=0\), it is also an algorithm for BAI when \(D=1,_{1}=0\). We prove in Appendix E that in this case, the gaps \(_{i}^{}s\) matches the classical gaps in BAI  and we derive its sample complexity from Theorem 1 showing that it is similar in theory to UGap , LUCB and LUCB++  but have better empirical performance.

Sketch of proof of Theorem 1Using Proposition 24 of  we first prove that the choice of \(_{i,j}\) in (4) yields \(() 1-\) for the good event \(\) defined in (1). Combining this result with Lemma 2, yields that \(_{1}\)-APE-\(k\) is correct with probability at least \(1-\).

The idea of the remaining proof is to show that under the event \(\), if APE has not stopped at the end of round \(t\), then the selected arm \(a_{t}\) has not been explored enough. The first lemma showing this is specific to the stopping rule \(_{_{1}}^{k}\) used for \(_{1}\)-PSI-\(k\).

**Lemma 3**.: _Let \(_{1}\) and \(k[K]\). If \(_{t}\) holds and \(t<_{_{1}}^{k}\) then \(^{k} 2_{a_{t},a_{t}}(t)\)._

The next two lemmas are more general as they apply to different stopping rules.

**Lemma 4**.: _Let \(_{1} 0\). Let \(=_{_{1}}^{k}\) for some \(k[K]\) or \(=_{_{1},_{2}}\) for some \(_{2} 0\). If \(_{t}\) holds and \(t<\) then \(_{a_{t}} 2_{a_{t},a_{t}}(t)\)._

**Lemma 5**.: _Let \(_{1} 0\) and \(\) be as in Lemma 4. If \(_{t}\) holds and \(t<\) then \(_{1} 2_{a_{t},a_{t}}(t)\)._

As can be seen in Appendix B, the proofs of these three lemmas heavily rely on the specific definition of \(b_{t}\) and \(c_{t}\). In particular, to prove Lemma 4 and 5, we first establish that when \(t<\), any arm \(j\) satisfies \((b_{t},j,t)_{b_{t},j}(t)\). The most sophisticated proof is then that of Lemma 4, which relies on a case distinction based on whether \(b_{t}\) or \(c_{t}\) belongs to the set of optimal arms.

These lemmas permit to show that, on \(_{t}\) if \(t<_{_{1}}^{k}\) then \(_{a_{t}}<2_{a_{t},a_{t}}(t) 2^{T_{a_{t}}(t)}\), where we define \(^{n}\) to be the expression of \(_{i,j}(t)\) when \(T_{i}(t)=T_{j}(t)=n\). Then we have

\[_{_{1}}^{k}\{\}  _{t=1}^{}_{a}a _{t}=a}_{a} 2_{a}^{T_{a}(t)}}}\] (5) \[ _{a}\{n 2:_{a}>2 ^{n}\}\;.\]

A careful upper-bounding of the RHS of (5) completes the proof of Theorem 1.

Experiments

We evaluate the performance of Adaptive Pareto Exploration on a real-world scenario and on synthetic random Bernoulli instances. For a fair comparison, Algorithm 1 of , referred to as PSI-Unif-Elim and APE are both run with our confidence bonuses \(_{i,j}(t)\) on pairs of arms, which considerably improve single-arm confidence bonuses3. As anytime confidence bounds are known to be conservative, we use \(K_{1}=1\) in (4) instead of its theoretical value coming from a union bound. Still, in all our experiments, the empirical error probability was (significantly) smaller than the target \(=0.1\).

Real-world datasetCOV-BOOST  is phase 2 trial which was conducted on 2883 participants to measure the immunogenicity of different Covid-19 vaccines as third dose (booster) in various combinations of initially received vaccines (first two doses). This resulted in a total of 20 vaccination strategies being assessed, each of them defined by the vaccines received as first, second and third dose. The authors have reported the average responses induced by each candidate strategy on cohorts of participants, measuring several immunogenicity markers. From this study, we extract and process the average response of each strategy to 3 specific immunogenicity indicators: two markers of antibody response and one of the cellular response. The outcomes are assumed to have a log-normal distribution . We use the average (log) outcomes and their variances to simulate a multivariate Gaussian bandit with \(K=20,D=3\). We give in Appendix H.2 some additional details about the processing of the data, and report the means and variances of each arm. In Appendix H.1 we further explain how APE can be simply adapted when the marginals distributions of the arms have different variances. In this experiment, we set \(_{1}=0,=0.1\) and compare PSI-Unif-Elim to 0-APE-\(k\) (called APE-\(k\) in the sequel) for different values of \(k\). The empirical distribution of the sample complexity of the algorithms, averaged over 2000 independent runs, are reported in Figure 1. The results are shown in log-scale (y-axis is the log of the sample complexity) to fit in the same figure. As \(|^{}|=2\), we first observe that, without the relaxation (i.e. for \(k>3\)), APE outperforms its state-of-the-art competitor PSI-Unif-Elim. Moreover for \(k=1\) or \(k=2\), the sample complexity of APE-\(k\) is significantly reduced. For \(k=2\) when the stopping time \(^{k}\) is reached some sub-optimal arms have possibly not yet been identified as such, while for \(k=3\), even if the optimal arms have been identified, the remaining arms have to be sampled enough to ensure that they are sub-optimal before stopping. This explains the gap in sample complexity between \(k=2\) and \(k=3\). In Appendix H.3, we compare APE to an adaptation of PSI-Unif-Elim for the \(k\)-relaxation, showing that APE is always preferable.

Experiments on random instancesTo further illustrate the impact of the \(k\)-relaxation and to strengthen the comparison with PSI-Unif-Elim, we ran the previous algorithms on 2000 randomly generated multi-variate Bernoulli instances, with \(K=5\) arms and different values of the dimension \(D\). We set \(=0.1\) and \(_{1}=0.005\) (to have reasonable running time). The averaged sample complexities are reported in Table 2. We observe that APE (with \(k=K\)) uses \(20\) to \(25\%\) less samples

Figure 1: On the left is the log of the empirical sample complexity of PSI-Unif-Elim and APE on the real-world scenario plot (right) for 2 out of the 3 immunogenicity indicators.

than PSI-Unif-Elim and tends to be more efficient as the dimension increases (and likely the size of the Pareto set, since the instances are randomly generated). We also note that identifying a \(k\)-sized subset of the Pareto set requires considerably less samples than exact PSI. In Appendix H.3 we also provide examples of instances for which APE takes up to 3 times less samples than PSI-Unif-Elim.

To illustrate the impact of the \(_{2}\) relaxation, setting \(_{1}=0\) we report the sample complexity of APE associated with the stopping time \(_{0,_{2}}\) for 20 equally spaced values of \(_{2}[0.01,0.05]\), averaged over 2000 random Bernoulli instances. Figure 2 shows the decrease of the average sample complexity when \(_{2}\) increases (left) and the average ratio of the size of the returned set to the size of the Pareto set (right). Note that for \(_{1}=0\), we have \((_{0,_{2}})^{}\). The average sample complexity reported decreases up to \(86\%\) for the instance with \(K=5,D=2\) while the returned set contains more than \(90\%\) of the Pareto optimal arms. In Appendix H.3, we further illustrate the behavior of APE with the \(_{2}\) relaxation on a fixed instance in dimension 2.

## 6 Conclusion and perspective

We proposed and analyzed APE, an adaptive sampling rule in multi-variate bandits models that when coupled with different stopping rules can tackle different relaxations of the fixed-confidence Pareto Set Identification problem. Our experiments revealed the good performance of the resulting algorithms compared to the state-of-the-art PSI algorithm as well as the great reductions in sample complexity brought by the relaxations. In future work, we intend to make our algorithms more practical for possible applications to clinical trials. For this purpose, as measuring efficacy takes time, we will investigate its adaptation to a batch setting, following, e.g. the work of  for BAI. We will also investigate the use of APE beyond the fixed-confidence setting, to the possibly more realistic fixed-budget  or anytime exploration  settings. To the best of our knowledge, no algorithm exists in the literature for PSI in such settings. Finally, following the works of , we defined the \(_{1},_{2}\) relaxations with scalar values, so that the same slack applies to all components. Although we could easily modify our algorithms to tackle vectorial values \(_{1},_{2}\), so far we could only prove a dependence on \(_{d}_{1}^{d}\) in the sample complexity. We intend to study the right quantification in the sample complexity when \(_{1}\) and \(_{2}\) are vectorial.

   & \(_{1}\)-APE-1 & \(_{1}\)-APE-2 & \(_{1}\)-APE-3 & \(_{1}\)-APE-4 & \(_{1}\)-APE-5 & \(_{1}\)-PSI-Unif-Elim \\  \(D=2\) & 811 & 39530 & 109020 & 145777 & 150844 & 190625 \\ \(D=4\) & 214 & 6410 & 19908 & 68061 & 124001 & 157584 \\ \(D=8\) & 119 & 204 & 405 & 1448 & 20336 & 27270 \\  

Table 2: Average sample complexity over 2000 random Bernoulli instances with \(K=5\) arms. On average the size of the Pareto set was \((2.295,4.0625,4.931)\) respectively for the dimensions \(2,4,8\).