# HyperPrism: An Adaptive Non-linear Aggregation Framework for Distributed Machine Learning over non-IID Data and Time-varying Communication Links

HyperPrism: An Adaptive Non-linear Aggregation Framework for Distributed Machine Learning over non-IID Data and Time-varying Communication Links

 Haizhou Du

Shanghai University

of Electric Power

Shanghai, China

&Yijian Chen

Shanghai University

of Electric Power

Shanghai, China

&Ryan Yang

Massachusetts Institute

of Technology

MA, USA

&Yuchen Li

Shanghai Jiao Tong

University

Shanghai, China

&Linghe Kong

Shanghai Jiao Tong

University

Shanghai, China

Email: duhaizhou@shiep.edu.cn

\(\) These authors are the same contribution.

###### Abstract

While Distributed Machine Learning (DML) has been widely used to achieve decent performance, it is still challenging to take full advantage of data and devices distributed at multiple vantage points to adapt and learn; this is because the current linear aggregation paradigm cannot solve inter-model divergence caused by (1) heterogeneous learning data at different devices (_i.e._, non-IID data) and (2) in the case of time-varying communication links, the limited ability for devices to reconcile model divergence. In this paper, we present a non-linear class aggregation framework _HyperPrism_ that leverages Kolmogorov Means to conduct distributed mirror descent with the averaging occurring within the mirror descent dual space; HyperPrism selects the degree for a Weighted Power Mean (WPM), a subset of the Kolmogorov Means, each round. Moreover, HyperPrism can adaptively choose different mapping for different layers of the local model with a dedicated hyper-network per device, achieving automatic optimization of DML in high divergence settings. We perform rigorous analysis and experimental evaluations to demonstrate the effectiveness of adaptive, mirror-mapping DML. In particular, we extend the generalizability of existing related works and position them as special cases within HyperPrism. For practitioners, the strength of HyperPrism is in making feasible the possibility of distributed asynchronous training with minimal communication. Our experimental results show HyperPrism can improve the convergence speed up to 98.63% and scale well to more devices compared with the state-of-the-art, all with little additional computation overhead compared to traditional linear aggregation.

## 1 Introduction

The proliferation of edge devices, such as mobile phones, wearable devices and unmanned aerial vehicles, has resulted in an exponential growth in diverse data types (e.g., images, sound and text). Addressing this surge necessitates advanced techniques capable of accurately, quickly, and practically processing vast amounts of data through efficient and scalable algorithms. Distributed Machine Learning (DML) has gained significant traction in recent years as a strategy to minimize data transfer and computational costs by bringing computation closer to the data sources. It has become a natural solution for scaling up machine learning while preserving data privacy in various domains (_e.g._, large language model training [39; 33], autonomous driving [60; 37], military applications , web search [29; 30; 28] and recommendation [32; 27; 31]).

While existing DML attempts have made significant progress, two technical barriers remain in realistic scenarios. **First**, _data heterogeneity_ is one of the most critical concerns. Specifically, in a DML system where mobile devices serve as computing nodes, the data generated is typically non-independent and identically distributed (non-IID), which means the data distribution may be unbalanced across different classes or categories. Consequently, the model may exhibit bias toward the majority class or dominant data patterns, leading to suboptimal performance on the minority class or rare patterns. **Second**, traditional DML methods usually deliver poorer performance under the _time-varying communication_ condition. Specifically, devices holding critical data may unexpectedly go offline or become out of range during the training, causing changes in the communication links. These interruptions can cause information loss in the aggregation, making local models no longer interchangeable and drifting away from the global model. We can summarize these powers of deviation and drift as "_divergence forces_", which drastically slows down the convergence and significantly impacts the efficiency and effectiveness of the training process in DML.

In order to tackle the above issues, we present a novel decentralized DML framework _HyperPrism_, which utilizes mirror descent  and employs adaptive mapping functions to project models into a mirror space, with both aggregation and gradient steps then carried out in the mapped space. Moreover, HyperPrism leverages the concept of "weighted power means" (WPM) as the aggregation function, raising the model parameters to the power of \(p\), and uses HyperNetworks  to adaptively adjust the power degree \(p\). In summary, the main contributions are summarized as follows:

* We study the problem of _divergence forces_ in decentralized DML, where we particularly focus on two technical barriers due to _data heterogeneity_ (i.e., non-IID data) and _time-varying communication links_. To the best of our knowledge, it is the first work to simultaneously address the challenges of non-IID data and time-varying communication links in realistic DML scenarios.
* We propose a non-linear class aggregation DML framework HyperPrism based on Kolmogorov Means, which can also be seen as mapping models to mirror space for aggregation, and we instantiate the means with an adaptive \(p\) power function to enhance the convergence speed and scalability. HyperPrism achieves superior performance in its dependence on the number of devices \(m\) and the power degree \(p\), upgrading from \(m\) to \(m[p]{m}\). This achievement also reduces the optimality gap  from \(\) to \([p]{m}\).
* We conduct rigorous analysis and prove that the loss bound of HyperPrism is \(O((}{T})^{})\). In cases where few communication epochs can occur (_i.e._, \(T m\)), employing a larger value of \(p\) yields improvements over traditional linear aggregation. Our theoretical results are consistent with state-of-the-art bounds in distributed gradient/mirror descent and single-device mirror descent.
* We carry out comprehensive experiments to assess the performance of HyperPrism framework. The experimental results demonstrate that HyperPrism achieves a remarkable acceleration in convergence speed with improvements of up to 98.63%. Moreover, HyperPrism also shows increased scalability in settings characterized by time-varying communication.

## 2 Related Work

**Decentralized DML with Data Heterogeneous.** Numerous studies have addressed non-IID data using linear solutions, such as local fine-tuning of a global model [4; 9; 8; 10], personalization in Federated Learning (FL) as a meta-learning objective , knowledge distillation, and prototype aggregation . Furthermore, Li _et al._ analytically demonstrate the limitations of FedAvg on non-IID data . Li _et al._ propose a variant of FedAvg by incorporating a penalty term in the local objective function . Liu _et al._ propose an algorithm that capture similarities between clients to compute personalized aggregation weights for personalized FL . Recently, Aketi _et al._ propose a tracking-based method to mitigate the impact of heterogeneous data distribution in DML without introducing communication overhead. However, these methods, less explored in decentralized DML, are confined by the boundaries of linear aggregation.

**DML with Time-varying Communication setting.** Many DML models and their variants have been proposed to process huge amounts of data locally over time-varying communication settings. Kovalev _et al._ propose the ADOM and ADOM+ method for decentralized optimization over time-varying networks with projected Nesterov gradient descent, respectively [18; 20]. Koloskova _et al._ introduce a framework covering local SGD updates and synchronous and pairwise gossip updates on adaptive network topology . De Vos _et al._ introduce Epidemic Learning in decentralized learning, leading to faster convergence and improved performance by randomly changing topologies. Nedic _et al._[44; 42] tackle the DML with topology dynamicity from the consensus perspective. They propose a model aggregation method for agents in a time-varying network topology to collaboratively solve a convex objective function, with a convergence guarantee. Moreover, future generation DML systems [20; 19; 7] also consider these time-varying communication settings as an important research area, where the naturally time-varying connectivity among pairs of mobile devices or mobile devices and edge servers will be dictated by their physical proximity.

_In this work, we focus on solving two barriers due to data heterogeneity (i.e., non-IID data) and time-varying communication links and conduct rigorous analysis to show that prior methods suffer from lower accuracy, higher loss, and slower convergence speed over time-varying networks than under a fixed topology. Additionally, their methods use linear averages for aggregation, which our framework encompasses as a particular case._

## 3 Problem Formulation and Preliminaries

### Problem Formulation

We consider decentralized DML with \(m\) devices over time-varying communication links represented by a directed graph \(G(t)=(V,(A^{(t)}))\), where \(V\) denote vertices and \(A^{(t)}=[a_{11}^{(t)},a_{12}^{(t)},...,a_{mm}^{(t)}]\) is the weight matrix of the topology graph. Then the \((A^{(t)})\) denotes the set of directed time-changing edges between vertexes. In each time interval, we assume that the communication links between devices are symmetrical and restricted, causing random disconnections and reconnections. Each device \(i\) has its own private dataset, denoted by \(D_{i}\). Let \(=(w_{1},w_{2},,w_{m})\) denote the collection of all local models, where \(w_{i}\) is the model held at device \(i\). Then, Device \(i\) constructs its local loss function as \(f_{i}(w)=_{_{i} D_{i}}[(w_{i};_{i},G(t))]\). Then, devices aim to solve the following optimization problem collaboratively:

\[_{^{d}}F()=_{i=1}^{m}f_{i}(),\] (1)

without sharing local data (_i.e._, without revealing \(f_{i}\)).

### Motivation

In recent years, model merging has developed non-linear aggregation methods. One motivation for non-linear aggregation is the decreased variance in the original parameter space. HyperPrism is designed to combat stale gradients from diverged models with synchronization.

In existing work, synchronization is achieved with an aggregation mechanism, usually a mean or median, with clipping. Inspired by similarities between Mirror Descent  and Quasi-Arithmetic Means , also known as Kolmogorov Means, of the form \(f^{-1}(_{k=1}^{n}f(x_{k}))\), HyperPrism maps models to the dual domain before averaging to better align with the geometry of the objective function. In implementation, we focus on the special case of \((w)=\|w\|^{p+1}\), transforming models as \(w w^{p}\), where HyperPrism therefore replaces linear means with the following weighted power mean:

\[_{i}^{(t)}=(_{j=1}^{m}a_{ij}^{(t)}(w_{j}^{(t)})^{p})^{},\] (2)

where \(a_{ij}^{(t)}\) is the aggregation weights of device \(j\) in device \(i\) at \(t\) round. The WPM is a special case of the general strategy of averaging in a mirror descent dual space, but it is particularly useful due to itsease of computation and convexity guarantees. In general, the aggregation step of HyperPrism is the following Equation (3):

\[_{i}^{(t)}=[]^{-1}(_{j=1}^{m}a_{ij}^{(t)}(w_{ j}^{(t)})).\] (3)

But we choose to focus on \((w)=\|w\|^{p+1}\) which gives \((w)=w^{p}\) (termwise exponentiation). This allows for simple run-time computation. For more intuition, in the \(p=\) limit the distributed averaging consensus problem  turns into an easier "distributed maximum problem", which is what allows for HyperPrism's tighter synchronization.

### Distributed Mirror Descent

The phrase "distributed mirror descent" can have multiple interpretations. In the existing literature, it typically refers to the process of taking local mirror descent steps and then linearly aggregating [23; 48; 6; 59] In the case of HyperPrism, mirror descent is transformed into the distributed algorithm in a different manner. It still takes local mirror descent steps but also uses the aggregation function in Equation (3). This approach proves to be more effective because, under the optimal model \(^{*}\), distributed mirror descent with Equation (3) remains stable, while the linear aggregation functions do not. In other papers' analysis (_e.g._, , ), this inaccuracy is not obvious since the dominant terms are often related to communication costs, but in the perfect communication case, using a generalized mean is necessary for exact theoretical convergence.

### HyperNetworks

Hypernetworks (HNs) are deep neural networks used to generate weights of other target networks . HNs can learn the mapping relationship between the embedding vector and the target network, and adaptively generate the target network based on the input. Shamsian _et al._ apply HNs in federated learning to generate personalized model parameters . Ma _et al._ present pFedLA  using HNs to generate aggregation weights of each model layer in personalized federated learning. Previous works [53; 55] found the different layer parameters of the local model have different impacts on model aggregation. For example, the locally learned feature representations are prone to over-fitting and thus cannot generalize well when each device only has insufficient data. In HyperPrism, the mapping function chosen is a form of the Bregman divergence, specifically \((w)=w^{p}\), where \(p\) represents the degree of WPM. Our experiments indicate that different functional layers of the model respond differently to the degree of \(p\). Increasing \(p\) has a more significant impact on accelerating convergence in linear or fully-connected layers. This observation inspires us to select the appropriate \(p\) for different functional layers adaptively. Through the chain rule , we demonstrate that HN can effectively correlate the mirror mapping with the objective function, enabling it to discover the optimal \(p\) for each device's model parameters in each round.

## 4 The Design of HyperPrism Framework

### Overview

With the above preliminaries and motivation presented, we now give the design of HyperPrism framework. The framework assumes that each device \(i\) maintains its local model denoted by \(w_{i}\); for simplicity of specification, we use a round-based specification, in which the model holds by device \(i\) after \(t\) communication rounds is denoted as \(w_{i}^{(t)}\).

The framework first chooses the aggregation weights \(a\). Each \(a_{ij}^{(t)}\), defined by

\[a_{ij}^{(t)} =\{e_{ij}^{(t)},e_{ji}^{(t)}\},\] (4) \[a_{ii}^{(t)} =1-_{j i}a_{ij}^{(t)},\] (5)

where \(e_{ij}^{(t)}=^{(t)}+1}\) when \(i,j\) are connected, otherwise \(e_{ij}^{(t)}=0\). \(N_{i}^{(t)}\) is the number of neighboring devices \(i\) at \(t\)-th round. \(a_{ij}^{(t)}\) generated in this way satisfy Assumption 5.1. Note that the connectivity \(e_{ij}^{(t)}\) is determined by underlying communication systems, which consider both feasibility and security requirements (_e.g._, low probability of detection). HyperPrism applies to generic DML, the parameter server and all-reduce frameworks can be seen as special cases (where all \(a_{ij}^{(t)}\) values equal \(\)).

In summary, the core of HyperPrism is that at every round \(t\), device \(i\) computes its local model for the next round \(t+1\) as:

\[w_{i}^{(t+1)}=[]^{-1}(_{j=1}^{m}a_{ij}^{(t)}(w_{j}^{(t )})- f_{i}(w_{i}^{(t)})),\] (6)

where \(\) is the mapping function with a selected degree of \(p\) for each round.

### Adaptive Degree of Power \(p\) Mapping

To determine the \(p\) of various layers at each round, HyperPrism establishes a relationship between the optimization problem and the degree of \(p\) by utilizing hypernetworks, which adaptively choose the optimal \(p\) for different layers to achieve the best performance.

Without loss of generality, HyperPrism also decouples the local model into the representation and decision parts. The representation part \(\) includes components like convolutional and embedding layers. The decision part \(\) includes components like fully-connected layers. Thus, for device \(i\), we have \(w_{i}=\{w_{,i},w_{,i}\}\). Each device \(i\) holds a local hypernetwork \(HN_{i}\) and a randomly generated embedding vector \(v_{i}\). Every hypernetwork consists of several fully-connected layers and employs the softmax for the output layer. \(HN_{i}\) takes \(v_{i}\) and gradient of the local model as input, then output \(p_{i}=\{p_{,i},p_{,i}\}\) for \(w_{,i}\) and \(w_{,i}\) parts, respectively. Then the mapping function evolves to \((w_{i})=\{(w_{,i})^{p_{,i}},(w_{,i})^{p_{, i}}\}\). The hypernetwork on device \(i\) can be defined as

\[p_{i}=HN_{i}(v_{i};_{i}),\] (7)

where \(_{i}\) denotes the parameters of \(HN_{i}\). Hence, a new objective function can be derived from the original problem as

\[ F()=_{i=1}^{m}f_{i}((w_{i})^{HN_{i}(v_{i};_{i})}).\] (8)

HyperPrism can transform the optimization problem for model parameters \(w_{i}\) into the HN's \(v_{i}\) and \(_{i}\). HNs adaptively output \(p_{,i}\) and \(p_{,i}\) based on the input, and simultaneously update both \(v\) and \(\) by gradient descent at each round. Specifically, the gradient of \(v_{i}\) and \(_{i}\) can be computed based on the chain rule  as

\[_{v_{i}}f_{i} =(_{v_{i}}})^{T}_{}}f_ {i},\] (9) \[_{_{i}}f_{i} =(_{_{i}}})^{T}_{}} f_{i}.\] (10)

Figure 1: The Overview of HyperPrism Framework. \(\) Device \(i\) executes local update on its own dataset. \(\) Device \(i\) adaptively generates degrees of \(p_{}\) and \(p_{}\) for the representation and decision parts by hypernetworks. \(\) Device \(i\) maps the model to the mirror space by raising the parameters with the degree of power \(p_{}\) and \(p_{}\), respectively. \(\) Device \(i\) communicates with its neighbors exchanging local models. \(\) Device \(i\) aggregates received models in mirror space with WPM. \(\) Device \(i\) inverses the model to primal space by the degree of power \(p_{}\) and \(p_{}\), then finishes the round.

Then, \(v_{i}\) and \(_{i}\) can be represented as

\[v_{i}^{(t+1)} =v_{i}^{(t)}-_{v_{i}}^{(t)}f_{i}^{(t)},\] (11) \[_{i}^{(t+1)} =_{i}^{(t)}-_{_{i}}^{(t)}f_{i}^{(t)}.\] (12)

Algorithm 1 demonstrates the full procedure of HyperPrism. In our real deployment, we adopt the asynchronous protocol.

## 5 Analytical Results

We rigorously analyze the properties of HyperPrism. We fully introduce all assumptions, analyze the convergence behavior of HyperPrism, and finally compare HyperPrism to previous works.

### Assumptions

**Assumption 5.1** (Connectivity).: The network graph \(G(t)=(V,(A^{(t)}))\) and the connectivity weight matrix \(A^{(t)}\) satisfy the following:

* \(A^{(t)}\) is doubly stochastic for all \(t 1\); that is \(_{j=1}^{m}a_{ij}^{(t)}=1\) and \(_{i=1}^{m}a_{ij}^{(t)}=1\).
* There exists a scale \(>0\), such that \(a_{ij}^{(t)}\) for all \(i\) and \(t 1\), if \(\{i,j\} E_{t}\).
* There exists an integer \(B 1\) such that the graph \((V,E_{kB+1} E_{(k+1)B})\) is strongly connected for all \(k 0\).

**Definition 5.2** (Bregman Divergence).: The Bregman Divergence of a function \(\) is defined as

\[D_{}(x,y)=(x)-(y)-(y),x-y.\] (13)

Note that for \((x)=\|x\|^{2}\), \(D_{}(x,y)=\|x-y\|^{2}\).

**Definition 5.3** (Uniform Convexity).: Consider a differentiable convex function \(:^{d}\), an exponent \(r 2\), and a constant \(>0\). Then, \(\) is \((,r)\)-uniformly convex with respect to a \(\|\|\) norm if for any \(x,y^{d}\),

\[(x)(y)+(y),x-y+\|x-y\|^{r}.\] (14)Note that for \(r=2\), this is known as _strong convexity_. This assumption also implies that \(D_{}(x,y)\|x-y\|^{r}\).

**Assumption 5.4** (Smooth Gradient).: Assume that the functions \(f_{i}\) are convex with its gradients \( f_{i}()\) satisfying \(L\)-Lipschitz continuity , namely:

\[\| f_{i}(x)- f_{i}(y)\| L\|x-y\|,\] (15)

for all \(x,y\) pairs.

This final assumption is used in nearly every mathematical analysis of DML, including . In our analysis, it is used to bound the distance between local models.

### Weighted Power Mean

In our experiments, we focused on the weighted power mean, generated by using \((x)=\|x\|^{p+1}\) which gives \((x)=x^{p}\). Such \(\) is uniformly convex as seen in Proposition 5.5, and the rest of the analysis will be generalized to all uniformly convex \(\).

**Proposition 5.5** (Uniform Convexity of Power Functions).: _For \(p 1\), the function \(_{p}(x)=\|x\|^{p+1}\) is uniformly convex with degree \(p+1\). This is because \(\|_{p}(x)-_{p}(y)\|=\|x^{p}-y^{p}\|}\|x-y\|\), and as a corollary we have_

\[D_{_{p}}(x,y)}\|x-y\|^{p+1}= {1}{2^{p-1}}_{p}(x-y).\] (16)

Given the function \(\), HyperPrism instructs local models to take a WPM of received models. Using the Connectivity Assumption (Assumption 5.1), we can bound the distance between local models.

**Lemma 5.6** (Consensus).: _Under Assumption 5.1, for each device \(i\), after \(t\) rounds:_

\[&\|(w_{i}^{(t)})-(})\|\\ &(^{t-1}_{j=1}^{m}\|(w_{j}^{(0)}) \|+}{1-}+2 G_{l}),\] (17)

_where \(=(1-})^{-2}\), \(=(1-})^{},G_{l}=2L( f( w_{i}^{(t)})-f^{*})\) and \(\) is a constant related to the graph connectivity._

**Theorem 5.7** (Convergence Behavior).: _Consider a \((},p+1)\) uniformly convex \(\) and the sequence \(w_{i}^{(t)}\) under Algorithm 1 with constant step size \(\). Then, under Assumptions 5.1, and 5.4, if \(x^{*}\) is the value that minimizes \(F()=_{i=1}^{m}f_{i}(w)\), then_

\[&_{t}[F(^{(t)})-F(x^{*})]\\ &}{T}_{t=0}^{T-1}[p]{(^{t-1}_{j=1}^{m}\|(w_{j}^{(t)})\|+}{1 -}+2 G_{l})}\\ &+m[p]{2^{r} G_{l}^{p+1}}+ (x^{*},^{(0)})}{ T}.\] (18)

In this Theorem 5.7, the first term uses Lemma 5.6, and is caused by the differences between local models held at different devices. This is the effect of the _diverging forces_ mentioned in earlier sections. Note that \(\) and \(\) are constants related to the graph connectivity, reflecting the influence of time-varying communication links. The second term represents the error caused by a non-zero learning rate in the Distributed Mirror Descent process, and the third term represents the lingering effects of the initialization. For more proof details, please refer to the Appendix.

**Corollary 5.8**.: _The bound on HyperPrism's (Algorithm 1) loss is \(O(m[p]{ m}+)\)._

The first term becomes \(O(m[p]{m})\) because since \(<1\), the \(^{t}\) term goes to 0 as \(t\) gets large. The second term is \(O(m[p]{})\) is smaller than the first term, so we drop it. The final term is clearly \(O()\).

**Corollary 5.9**.: _For \(=O([p+1]{})\), the upper bound becomes \(O(m[p]{ m}+)=O([p+1]{})\)._

### Comparison to Previous Work

Table 1 summarizes the big \(O\) notation convergence rates of \(f(^{(t)})-f^{*}\). Previous works also assume bounded gradients. Our analysis recovers the same bounds as the state-of-the-art in DML and single-device mirror descent with generic uniform convexity assumptions. Nedic  is standard gradient descent, and thus has \((x)=\|x\|^{2}\), which is \((1,2)\)-uniformly convex, corresponding to \(p=1\). Yuan  considers distributed mirror descent under strong convexity \((r=2)\) equivalent to \(p=1\), and based on their analysis, the bound should be \(O( m^{2}+)\).

## 6 Evaluation

### Experimental Setup

The experimental platform consists of 8 Nvidia Tesla T4 GPUs, 4 Intel XEON CPUs, and 256GB of memory. All the models and training scripts are implemented in RAY  and PyTorch .

**HyperNetworks Setup.** We construct a hypernetwork model comprising three fully-connected layers and two additional output layers activated using softmax. The outputs of the fully-connected layers are fed into each of the two output layers to generate the degree of \(P\) for various parts.

**Time-varying Communication Links Setup.** We employ the NS3 platform  to simulate realistic time-varying communication environments consisting of multiple distributed devices. Each device is configured with the WiFi 802.11a protocol and communication among themselves in Ad-Hoc mode. To quantify the degree of connectivity of the communication links, we define the _topology density_ as the ratio of available tunnels to the total tunnels.

**Models and Dataset.** We use MNIST  and CIFAR-10  datasets distributed among devices in non-IID settings. We construct two models based on layer functionalities. The Logistic Regression (LR)  model consists solely of linear layers used for the MNIST dataset. On the other hand, the CNN model consists of both convolutional and fully-connected layers used for CIFAR-10.

**Non-IID Data Partitioning.** To distribute datasets in a non-IID fashion, we employ Dirichlet distribution  to allocate all samples among devices. The Dirichlet Degree \(\) is used to control the non-IID degree. The \(=0.1\) represents the extreme scenario where each device possesses samples from only one class, while \(=10\) equals the IID scenario. These distributions reflect a challenging and realistic training environment.

**Metrics.** We consider two metrics to measure the performance of HyperPrism.

* **Average Accuracy.** We evaluate the performance of the local model per device using a global test set that contains samples with all categories. The average Top-1 accuracy of all devices is calculated in each round to measure overall performance and convergence rate.
* **Convergence Speed.** We track the loss of each round and the number of rounds to investigate the rounds needed to reach the convergence point for specific accuracy and loss.

**Baselines.** We conduct a comparative analysis of HyperPrism with state-of-the-art methods for DML in non-IID data and time-varying communication links, including \(p=1\) methods, which is one of the most influential and widely applied works in DML studies. SwarmSGD , Mudag  and ADOM . To ensure a fair comparison, we made minor adjustments to each baseline method.

* _p=1_. We define it as a class of methods using a linear aggregation function, including DPSGD , and its variants [43; 45]. These methods can be seen as special cases of HyperPrism without the mirror mapping process.

  Framework & \(f\) error & with optimal \(\) & Recovered \\  HyperPrism & \(O(m[t]{ m}+)\) & \(O(}}{T})\) & NA \\ Bubeck  (\(m=1,r=2\)) & \(O(+)\) & \(O(})\) & Yes \\ Srebro  (\(m=1\)) & \(O(^{}+)\) & \(O(})\) & Yes \\ Nedic  (\(GD r=2\)) & \(O( m^{2}+)\) & \(O(})\) & Yes \\ Yuan  (\(r=2\) MD) & \(O( m^{2}+)\) & \(O(})\) & Yes \\  

Table 1: Convergence Rates in terms of \(\), \(p\), \(m\), and \(T\)* _SwarmSGD_. We set the number of local SGD updates equal to 1, where the selected pair of devices performs only a single local SGD update before aggregation. It can also be viewed as a special case of HyperPrism where the topology density is very low.
* _ADOM and Mudag_. We set the condition number \(k\) to 10, and the number of features \(d\) equals the number of classes. The gossip matrix \(W(t)\) at round \(t\) is chosen to be the Laplacian of time-varying communication links divided by its largest eigenvalue.

Hyperparameters.For all experiments, the learning rate and batch size are both fixed at \(0.01\) and \(128\). We generate time-varying communication graphs with different sizes and densities and evaluate 100 rounds total. The graph changes every round.

### Experimental Results

Impact of different degrees of \(p\).We present the impact of varying degrees of \(p\) in HyperPrism on model performance in Figure 2. In Figure 2(a), it is evident that the model converges more swiftly and attains greater accuracy as \(p\) grows larger. Figure 2 (b) demonstrates that accuracy exhibits a significant fluctuation with different \(p\). This underscores the substantial impact of the \(p\) value selection on the performance of HyperPrism. These findings highlight the importance of choosing an appropriate value for \(p\) in HyperPrism to achieve optimal performance.

Comparison of time cost.In HyperPrism, each hypernetwork contains only 3 linear layers with 64 nodes per layer to ensure a minimal extra computational resource cost. We record the time cost in Figure 2(c). Although HyperPrism does result in a higher time cost per iteration, it notably decreases the total number of rounds required for convergence, thereby reducing the overall time needed to achieve a specific accuracy.

Performance of HyperPrism.To showcase the practicality of HyperPrism, we consider the basic configuration with \(Dirichlet=0.1\), \(density=0.5\), and \(m=50\) devices. The accuracy results for all benchmarks and HyperPrism are presented in Figure 3. The convergence speed is summarized in Table 2, 3, 4. Notably, HyperPrism outperforms all benchmarks across all models. It demonstrated a remarkable superior performance over state-of-the-art baselines with convergence accuracy and convergence speed improvements of up to 4.87% and 98.63%, respectively.

Impact of non-IID.To investigate the impact of the non-IID Dirichlet degree on HyperPrism, we experiment with various \(=0.1,1,10\). The corresponding results are presented in Figure 3, and Table 2. All methods exhibit poorer performance as the non-IID degree becomes more extreme, which aligns with common intuition. However, HyperPrism demonstrates enhanced stability and faster convergence speed, especially at highly non-IID degrees.

Figure 3: The Impact of non-IID Degrees

Figure 2: The impact of different \(p\) and time cost.

**Scalability.** We further evaluate the performance of HyperPrism with varying scales \(m\{20,50,100\}\). The results are summarized in Table 4. It can be noticed that most of the baseline methods exhibit deteriorating performance as the number of devices increases. The ADOM even barely converges under 100 devices. In contrast, HyperPrism is minimally affected by the scale and maintains superior acceleration and model performance.

**Communication Graph Densities.** To further analyze the impact of connected densities on model performance, we present the performance and convergence speed of HyperPrism with various \(density\{0.2,0.5,0.8\}\) in Table 3. In the extreme non-IID case, the performance of baselines deteriorates as the communication becomes denser. Particularly, ADOM exhibits significant fluctuations at a density of 0.8. However, HyperPrism maintains better performance across different densities. This can be attributed to the fact that as communication becomes denser, the information exchanged between devices becomes more complex. Given HyperPrism's resilience to non-IID scenarios, it maintains good performance in such cases.

## 7 Conclusion

In this work, we studied the important problem of _divergence forces_ in decentralized DML, due to _data heterogeneity_ (i.e., non-IID data) and _time-varying communication links_. We propose a non-linear class aggregation DML framework with adaptive Kolmogorov Means for aggregation to enhance the convergence speed and scalability. HyperPrism achieves superior performance in its dependence on the number of devices \(m\), improving from \(m\) to \(m[]{m}\), and achieving optimality in the limit \(p\). We also conduct rigorous analysis and demonstrate that the loss bound of HyperPrism is \(O((}{T})^{})\). In cases with few communication epochs (_i.e._, \(T m\)), employing a larger value of \(p\) yields improvements over traditional linear aggregation. Our theoretical results are consistent with state-of-the-art bounds in distributed gradient/mirror descent and single-device mirror descent, all under a general uniform convexity assumption. To verify the effectiveness of HyperPrism, we carry out extensive experiments that demonstrate that HyperPrism achieves a remarkable acceleration in convergence speed with improvements of up to 98.63%. Moreover, HyperPrism shows increased scalability.

   &  &  \\   &  &  &  &  &  &  \\   & Max ACC & Conv. Rds & Max ACC & Conv. Rds & Max ACC & Conv. Rds & Max ACC & Conv. Rds & Max ACC & Conv. Rds & Max ACC & Conv. Rds \\  SwarmSGD & 84.74 & 93 & 83.75 & 104 & 81.54 & 116 & 22.58 & 132 & 182 & 198 & 14.66 & 201 \\ DFSGD & 80.75 & 137 & 17.51 & 246 & 17.57 & 372 & 22.56 & 160 & 180 & 187 & 17.78 & 221 \\ Mugg & 88.68 & 10 & 86.4 & **44** & 81.13 & 81 & 30.68 & **31** & 20.16 & 86 & 11.46 & _inf_ \\ ADOM & 80.01 & 20 & 90.55 & 11 & 90.73 & **42** & 11.26 & _inf_ & 10.11 & _inf_ & 917 & _inf_ \\  Ours & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & **151** \\  & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) \\  

Table 4: Comparison on Different Device Numbers

   &  &  \\   &  &  &  &  &  &  \\   & Max Acc & Conv. Rds & Max ACC & Conv. Rds & Max Acc & Conv. Rds & Max Acc & Conv. Rds & Max Acc & Conv. Rds & Max Acc & Conv. Rds \\  SwarmSGD & 83.75 & 104 & 87.01 & 47 & 83.74 & 18 & 18.24 & 198 & 51.21 & **150** & 72.22 & 14 \\ DFSGD & 71.51 & 186 & 77.00 & 173 & 71.50 & 131 & 18.01 & 187 & 43.32 & 282 & 09.2 & 92 \\ Madag & 86.4 & 44 & 85.51 & 14 & 86.41 & **7** & 20.16 & **83** & 41.76 & _inf_ & 29.79 & 18 \\ ADOM & \(90.58\) & \(11\) & \(\) & \(10\) & \(90.58\) & \(23\) & \(10.57\) & _inf_ & 11.46 & _inf_ & 12.32 & _inf_ \\  Ours & \(\) & \(\) & \(90.30\) & \(\) & \(\) & \(8\) & \(\) & \(86\) & \(\) & \(109\) & \(\) & **13** \\  & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) & \(()\) \\  

Table 2: Comparison on Different non-IID Degree

   &  &  \\   &  &  &  &  &  &  \\   & Max Acc & Conv. Rds & Max ACC & Conv. Rds & Max Acc & Conv. Rds & Max Acc & Conv. Rds & Max Acc & Conv. Rds & Max Acc & Conv. Rds \\  SwarmSGD & 82.58 & 102 & 83.75 & 104 & 82.79 & 114 & 17.57 & 212 & 18.24 & 198 & 17.15 & 201 \\ DFSGD & 71.37 & 229 & 71.51 & 246 & 71.65 & 242 & 16.22 & 362 & 364 & 18.01 & 187 & 19.96 & 110 \\ Mugg & 86.39 & 48 & 86.4 & 45 & 86.36 & 45 & 20.16 & **69** & 20.16 & 86 & 20.17 & 66 \\ ADOM & \(90.1\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(
   Symbol & Description \\  \(m\) & The size of edge devices \\ \(T\) & The total round \\ \(t\) & The number of round \\ \(\) & The learning rate \\ \(G(t)\) & The time-varying network topology graph consisting of \(V\) and \(\) \\ \(V\) & The set of vertexes (_i.e._, edge devices) \\ \((A^{(t)})\) & The set of directed time-changing edges between vertexes \\ \(A^{t}\) & The weight matrix of the topology \\ \(a_{j}^{(t)}\) & The aggregation weights of device \(j\) in device \(i\) at \(t\) round \\ \(D_{i}\) & The private dataset of device \(i\) \\ \(\) & The set of all local models \\ \(w_{i}\) & The model held at device \(i\) \\ \(f_{i}(w)\) & Device \(i\)’s local loss function \\ \(F()\) & \(F()=_{i=1}^{m}f_{i}(w)\) \\ \(_{i}^{(t)}\) & The aggregation step of device \(i\):\(_{i}^{(t)}=[]^{-1}(_{j=1}^{m}a_{ij}^{(t)}(w_{j }^{(t)}))\) \\ \((w)\) & Define the function \((w)=}\|w\|^{p+1}\) \\ \((w)\) & The mapping function \((w)=w^{p}\) \\ \(p\) & The adaptive degree of the WPM \\ \(e_{ij}^{(t)}\) & \(e_{ij}^{(t)}=^{(t)}+1}\) when \(i,j\) are connected, otherwise \\ \(N_{i}^{(t)}\) & The number of devices neighboring device \(i\) at \(t\)-th round \\ \(_{i}^{(t)}\) & \((w_{i})=\{(w_{_{i}})^{p_{_{i}}},(w_{_{i}})^{ p_{_{i}}}\}\) \\ \(HN_{i}(v_{i};_{i})\) & The Hypernetwork on device \(i\) \\ \(_{i}\) & The parameter of HN\({}_{i}\) \\ \(\) & A scale related to connectivity \\ \(L\) & Smoothness of gradient \( f\) \\ \(G_{l}\) & Upper bound on gradient derived from \(L\) \\ \(D_{}(x,y)\) & The Bregman Divergence of a function \(\) \\ \(_{,}r\) & \((_{,}r)\)-uniformity convex \\ \(_{i}^{(t)}\) & \((_{i}^{(t)})=_{j=1}^{m}a_{ij}^{(t)}(w_{i}^{ (t)})\) \\ \(^{(t)}\) & \(^{(t)}=[]^{-1}(_{i=1}^{m}(w_{i} ^{(t)}))\) \\ \(_{,}\) & Constants related to graph connectivity, containing \(\) \\ \((t,s)\) & A transition matrix \((t,s)=A(t)A(t-1) A(s+1)A(s)\) \\ \(,k\) & round number \\   

Table 5: Summary of Main Notations

### Proof under Uniform Convexity

To aid analysis, introduce the sequence \(_{i}^{(t)}\). Note that the \(w_{i}^{(t)}\) and \(_{i}^{(t)}\) sequences satisfy

\[(_{i}^{(t)})=_{j=1}^{m}a_{i,j}^{(t)}(w_{j}^{(t )}),\] (19)

\[(w_{i}^{(t+1)})=(_{i}^{(t)})- f_{i}(w_ {i}^{(t)}).\] (20)

Additionally, we can define

\[^{(t)}=[]^{-1}(_{i=1}^{m}(w_{i} ^{(t)}))=[]^{-1}(_{i=1}^{m}(_{i}^ {(t)})).\] (21)

### Proof of Lemma 5.6

Proof.: Define a transition matrix \((t,s)=A(t)A(t-1) A(s+1)A(s)\). Then, under Assumption 5.1, Corollary 1 in  states that

\[|[(t,)]_{ij}-|^{t-},\] (22)

where \(\) and \(\) are defined in the lemma statement. 

We are able to write out a general formula for \((w_{i}^{(t+1)})\):

\[&(w_{i}^{(t+1)})=_{j=1}^{m}[(t,k )]_{ij}(w_{j}^{(k)})\\ &-_{=k+1}^{t}_{j=1}^{m}[(t,k)]_{ij}  f_{j}(w_{j}^{(-1)})- f_{i}(w_{i}^{(t)}).\] (23)

as well as \((^{(t)})\):

\[&(^{(t)})=_{i=1}^ {m}(w_{i}^{(t)})=_{j=1}^{m}(w_{j}^{(k)})\\ &-_{=k+1}^{t}_{j=1}^{m} f_ {j}(w_{j}^{(-1)})-_{i=1}^{m} f_{i}(w_{i}^{(t)}). \] (24)

Figure 4: WPM’s impact on parameter distribution.

It is known that for a \(L\)-Lipschitz continuous function \(f\), if \(x^{*}\) is the optimum of \(f\), then:

\[\| f(x)- f(x^{*})\| 2L(f(x)-f^{*})\]

Then, \((w_{i}^{(t)})-(^{(t)})\) can be bounded by applying the Triangle Inequality and Equation (22):

\[&\|(w_{i}^{(t+1)})-( ^{(t+1)})\|_{j=1}^{m}^{(t-k)}\|( w_{j}^{(k)})\|\\ &+_{=k+1}^{t}_{j=1}^{m}^{(t-)}\|  f_{j}(w_{j}^{(-1)})\|+2 G_{l}.\] (25)

Then, plugging in \(k=0\) gives

\[&(^{(t)}_{j=1}^{m}\| (w_{j}^{(0)})\|+m G_{l}_{=1}^{t}^{(t-)}+2 G_{l}) \\ &(^{(t)}_{j=1}^{m}\|(w_{j}^{(0) })\|+m G_{l}+2 G_{l}).\] (26)

Finally, shifting \(t\) down by 1 gives the desired bound.

### Proof of Theorem 5.7

Firstly, note that under Algorithm 1 and Assumption 5.4, Weighted AM-GM gives:

\[&(r-1)[r-1]{m} (m G_{l})^{r}}+m\|^{(t)}- {y}^{(t+1)}\|^{r}\\ & r(([r-1]{m}(m  G_{l})^{r}})^{r-1}(m\|^{(t)}- ^{(t+1)}\|^{r})^{1})^{}\\ &=r(}(m G_{l})^{r}\| ^{(t)}-^{(t+1)}\|^{r})^{}\\ &=(m G_{l})\|^{(t)}-^{(t+1)}\|. \]

We may follow the main line of reasoning that proves Theorem 5.7.

### Main Line of Reasoning

Proof.: We prove bounds for generic \(x\). Note that \(^{(t)}=h^{-1}(_{i=1}^{m}h(w_{i}^{(t)}))\). Then, we get:

\[&_{i=1}^{m}[f_{i}(w_{i}^{(t)})-f_{i}(x)] _{i=1}^{m} f_{i}(w_{i}^{(t)}),w_{i}^{(t)}-x \\ &=_{i=1}^{m} f_{i}(w_{i}^{(t)}),w_{i}^{(t)}- ^{(t)}\\ &+_{i=1}^{m} f_{i}(w_{i}^{(t)}),^{(t)}-^{(t+1)}+_{i=1}^{m} f_{i}(w_{ i}^{(t)}),^{(t+1)}-x.\] (27)Cauchy's inequality can bound the first term. The third term can be manipulated using Equation (20). Then, combined with \(f_{i}(^{(t)}) f_{i}(w_{i}^{(t)})+G_{l}\|^{(t)}-w_{i}^ {(t)}\|\), we get

\[ (F(^{(t)})-F(x))(2_{i=1}^{m} G_{l }\|w_{i}^{(t)}-^{(t)}\|)\] \[+m G_{l}\|^{(t)}-^{(t+1)}\|\] \[+_{i=1}^{m}(y_{i}^{(t)})-(w_{i}^{( t+1)}),^{(t+1)}-x.\]

The factor of 2 comes from the 2nd term of Equation (27) added to the error from \(f_{i}(^{(t)}) f_{i}(w_{i}^{(t)})+G_{l}\|^{(t)}-w_{ i}^{(t)}\|\). Note that the last term is equal to \(m^{(t)}-^{(t+1)},^{(t+1)}-x\). This is also equal to \(m(D_{}(x,^{(t)})-D_{}(x,^{(t+1)})-D_{}( ^{(t+1)},^{(t)}))\) by the Triangle Inequality for Bregman Divergences. We also substitute Claim 1 to replace the second term, so the value is

\[(2_{i=1}^{m} G_{l}\|w_{i}^{(t)}- ^{(t)}\|)\] (28) \[+[r-1]{(m G_{l})^{r} }+m\|^{(t)}-^{(t+1)}\|^{r}\] \[+m(D_{}(x,^{(t)})-D_{}(x,^{(t+1)} )-D_{}(^{(t+1)},^{(t)})).\]

But, by uniform convexity, \(D_{}(^{(t+1)},^{(t)})\|^{(t +1)}-^{(t)}\|^{r}\), and thus this is also

\[(2_{i=1}^{m} G_{l}\|w_{i}^{(t)}-^{(t)}\|)+[r-1]{(m G_{l})^{r}}\] (29) \[+m(D_{}(x,^{(t)})-D_{}(x,^{(t+1)} )).\]

Then, taking the sum over \(T\) gives

\[ _{t=0}^{T-1}[F(^{(t)})-F(x)]_{t=0}^{T-1}2 (_{i=1}^{m} G_{l}\|w_{i}^{(t)}-^{(t)}\|)\] (30) \[+T[r-1]{(m G_{l })^{r}}\] \[+m(D_{}(x,^{(0)})-D_{}(x,^{(t)}))\] \[ 2m G_{l}_{t=0}^{T-1}[r-1]{( G_{l})^{r}}+m D_{}(x,^{(0)}).\]

Dividing through by \( T\), substituting \(=}\) and \(r=p+1\), and substituting \(x=x^{*}\) and Lemma 5.6 gives the desired result. 

### Weighted Power Mean Skew Correction

**Theorem 8.1**.: _Consider positive \(x_{i}\) and \(_{i}\) close to \(\). Then,_

\[(_{i=1}^{m}_{i}x_{i})^{}(_{i=1 }^{m}x_{i})^{}+O(-|}{p}).\] (31)

_This allows us to see the weighted power mean as a way to decrease skew; this theorem is relevant in the setting of Lemma 5.6._Write \(_{i}=+ e_{i}\) where all \(e_{i}\). Hold \(e_{i}\) constant. Then, for \(_{i} m\), it is true that \( 0\). The derivative of the average with respect to \(\) is

\[x_{i}^{p}}{p(x_{i}^{p}+ ( e_{i}x_{i}^{p}))^{}}\]

and the derivative at \(=0\) is \(x_{i}^{p}}{p(x_{i}^{p})^{}}\). Thus, we have the following first-order approximation:

\[(_{i=1}^{m}_{i}x_{i})^{}(_{i= 1}^{m}x_{i})^{}+x_{i} ^{p}}{p(x_{i}^{p})^{}}\] (32)

But we have \( e_{i}x_{i}^{p}x_{i}^{p}\), so

\[(_{i=1}^{m}_{i}x_{i})^{}(_{i= 1}^{m}x_{i})^{}+( x_{i}^{p})^{}\] (33)

The \((x_{i}^{p})^{}\) term is bounded, so the error is proportional to \(O()\).

### Linear Bound on Power Mean

As a starter, we first prove a useful lemma on two real numbers with different signs. Note that all variables used in this subsection are generic ones not tied to the HyperPrism-based mechanism.

**Lemma 8.2** (Two Numbers with Different Signs).: _Given any two real numbers \(x>0,y<0\), an odd integer \(p 1\), and \(0 1\), we have_

\[( x^{p}+(1-)y^{p})^{1/p}x+(1- )y.\] (34)

Proof.: Denote \(C=\) and rewrite the right-hand side (RHS) of Equation (34) as \(C( x+(1-)y)+(1-C)y\). We first note that we can scale both \(x,y\) by \(\) such that \(y=-1\). As such, we can simplify our proof to only focus on the case of \(y=-1\). We will use shorthand \(\), and rewrite as

\[&(C( x+(1-)y)+(1-C) y )^{p}\\ =&(C(x+1)-1)^{p}=-(1-C(x +1))^{p}^{p}.\] (35)

We then consider two cases.

**Case 1:**\(x 2p-1\)**. Since \(-C(x+1)-C(2p)=--1\), by Bernoulli's inequality, we have

\[^{p}-(1+p(-C(x+1)))=-1+pC(x+1).\] (36)

Since \( x^{p}+1\), which can be verified by casework on \(x 1\) or \(x 1\), then

\[^{p}-1+(x^{p}+1)= x^{p}+(1-)(-1)^{p}.\] (37)

We then finish this case by taking the power of \(1/p\) on both sides.

**Case 2:**\(x 2p-1\). We will denote the expression on the left-hand side and right-hand side of Equation (34) with LHS and RHS, respectively. First note that both sides of the inequality in Equation (34) are \(-1\) when \(=0\) and \(y=-1\). Next, we will show that the derivative with respect to \(\) is always larger for the LHS of Equation (34) when \(x 2p-1\).

\[LHS=x^{p}+1.\] (38)

\[RHS&=pC(x+1) (C(x+1)-1)^{p-1}\\ &=(x+1)(C(x+1)-1)^{p-1}.\] (39)The LHS's derivative w.r.t \(\) is clearly constant. Also, the \(RHS\) clearly has local maxima at \(=0,1\). At \(=0\), we clearly have that since \(x 2p-1\), we have

\[LHS|_{=0}=x^{p}+1\\ (x+1)(0-1)^{p-1}=RHS|_{ =0}.\] (40)

For \(=1\), since \(x(x+1)-1 0\), we have

\[LHS|_{=1}&=x^{p} +1 x(x)^{p-1}\\ ((x+1))((x+1)-1) ^{p-1}\\ &=RHS|_{=1}.\] (41)

Thus, for all \(0 1\), \(LHSRHS\), and they are equal at \(=0\), so we always have \(LHS RHS\) for all \(0 1\) when \(x 2p-1\), and we are done. 

Next, consider a list of real numbers \(x_{i}\), \(i=1,,m\). We let \(M= x_{i}\) and \(U= x_{i}\). We then prove the following lemma.

**Lemma 8.3**.: _Assume a list of non-negative real numbers \(x_{i}\), \(i=1,,m\) and \(p 1\). Given \(_{i}\), \(i=1,,m\) such that \(_{k=1}^{m}_{k}=1\) and \(_{i} 0\), we have_

\[_{i=1}^{m}_{i}x_{i}(_{i=1}^{m}_{i}x_{i}^{p} )^{1/p}_{i=1}^{m}_{i}x_{i}+U.\] (42)

Proof.: The lower bound in Equation (42) is a direct result from the power mean inequality. As for the upper bound, we have

\[(_{i=1}^{m}_{i}x_{i}^{p})^{1/p }&(_{i=1}^{m}_{i}U^{p-1}x_{i})^{1/p}\\ =(U^{p-1}_{i=1}^{m}_{i}x_{i})^{1/p}& _{i=1}^{m}_{i}x_{i}+U,\] (43)

where the last step uses the generalized AM-GM inequality. 

We now tie these two Lemmas together to prove Theorem 8.4, which to the best of our knowledge is a novel inequality on weighted power mean.

**Theorem 8.4** (Linear Bound on Weighted Power Mean).: _Assume a list of real numbers \(x_{i}\), \(i=1,,m\) and \(_{i}\), \(i=1,,m\) such that \(_{k=1}^{m}_{k}=1\) and \(_{i} 0\). For any odd integer \(p 1\), we have:_

\[(_{i=1}^{m}_{i}x_{i}^{p})^{} _{i=1}^{m}_{i}x_{i}+(1-)M.\] (44)

Proof.: First, note that if all \(x_{i}\)s are positive, Equation (44) holds from the lower bound of Lemma 8.2. Second, if all \(x_{i}\)s are \( 0\), Equation (44) holds from the upper bound of Lemma 8.3 after flipping all the signs.

For the case where \(x_{i}\)s have mixed signs, let \(_{pos},_{neg}\) be the sum of the corresponding \(\)s for the negative and positive elements in \(\), respectively. We have,\[(_{i=1}^{n}_{i}x_{i}^{p})^{}=(_{pos}_{i}x_{i}^{p }+_{neg}_{i}x_{i}^{p})^{}\] \[ (_{pos}(_{pos}}{_{pos}}x_{i})^{p}+ _{neg}(_{neg}}{_{neg}}x_{i}+M)^{p})^{}\] \[ }{2p}(_{pos}}{_{pos}}x _{i})+(1-}{2p})(_{neg}}{ _{neg}}x_{i}+M)\] (45) \[= _{pos}()_{i}x_{i}+_{neg}(}+_{neg}})_{i}x_{i}\] \[+(}_{neg}+})M,\]

where the first inequality comes from the \(n\)-variable same sign case in Lemma 8.3, and the second inequality comes from the 2-variable case in Lemma 8.2. Here, each positive \(x_{i}\) is weighted with at least \(_{i}\) and each negative \(x_{i}\) is weighted with at least \((}+})_{i}\), which equals to \(_{i}_{i}\), since \(_{neg} 1\).

Since \(_{i} M\) (\(M<0\) when \(x_{i}\)s have different signs), we can turn the extra \(_{i}\) terms into \(M\):

\[(_{i=1}^{m}_{i}x_{i}^{p})^{} _{i=1}^{n}_{i}x_{i}+M,\] (46)

which completes our proof. 

In addition to a new lower bound of HyperPrism, we can also prove an upper bound of the HyperPrism at \(_{i=1}^{m}_{i}x_{i}+U\) following similar steps. Note that these bounds are generic and can be applied outside of DML. These bounds are necessary for analyzing the benefits of using a HyperPrism aggregation function in DML because they guarantee that the HyperPrism takes at least some minimum consideration of each \(x_{i}\) term. This consideration is crucial because each device's local objective function is unique, and they must all be considered to optimize the overall objective function.

Checklist

1. **Claims** Question: Do the main claims made in the abstract and introduction accurately reflect the paper's contributions and scope? Answer: [Yes] Justification: The abstract provides a concise summary of the paper's key findings and contributions, allowing viewers to quickly grasp the main points.
2. **Limitations** Question: Does the paper discuss the limitations of the work performed by the authors? Answer: [Yes] Justification: We discussed the additional computational overhead that Hypernetworks may introduce, and we provided some time consumption comparisons. However, further research is needed to investigate whether the computational resource consumption will limit the performance.
3. **Theory Assumptions and Proofs** Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof? Answer: [Yes] Justification: We provide comprehensive definitions of all theories and assumptions and presented complete proofs in the appendix.
4. **Experimental Result Reproducibility** Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)? Answer: [Yes] Justification: We provide detailed explanations of all experimental settings in the experimental section and uploaded the source code and data for reference.
5. **Open access to data and code** Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material? Answer: [Yes] Justification: We utilized an open-source dataset and provided the complete source code for reference.
6. **Experimental Setting/Details** Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results? Answer: [Yes] Justification: We provide detailed description of the experimental setup in the evaluation section.
7. **Experiment Statistical Significance** Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments? Answer: [Yes] Justification: We provide comprehensive experimental result and detailed explanations in the evaluation section.
8. **Experiments Compute Resources**Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments? Answer: [Yes] Justification: We provide sufficient experimental information to reproduce the experiments, some detailed information are present in appendix due to space limitation.
9. **Code Of Ethics** Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines? Answer: [Yes] Justification: Yes, the research in this paper satisfies all of the NeurIPS Code of Ethics.
10. **Broader Impacts** Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed? Answer: [NA] Justification: The research in this paper focuses on foundational research and does not have potential negative societal impacts.
11. **Safeguards** Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)? Answer: [NA] Justification: There is no such risk with this paper.
12. **Licensees for existing assets** Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected? Answer: [Yes] Justification: All existing assets used in the paper are properly credited, and the licenses and terms of use are explicitly mentioned and properly respected.
13. **New Assets** Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets? Answer: [Yes] Justification: The new assets introduced in the paper are well documented and provided alongside the assets.
14. **Crowdsourcing and Research with Human Subjects** Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)? Answer: [NA] Justification: The paper does not involve crowdsourcing nor research with human subjects.
15. **Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects** Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained? Answer: [NA] Justification: The paper does not involve crowdsourcing nor research with human subjects.