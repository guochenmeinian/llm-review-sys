# A Single-Loop Accelerated Extra-Gradient Difference Algorithm with Improved Complexity Bounds for Constrained Minimax Optimization

A Single-Loop Accelerated Extra-Gradient Difference Algorithm with Improved Complexity Bounds for Constrained Minimax Optimization

 Yuanyuan Liu1, Fanhua Shang2, Weixin An1, Junhao Liu1, Hongying Liu3,2, Zhouchen Lin4,5,6

[MISSING_PAGE_POST]

###### Abstract

In this paper, we propose a novel extra-gradient difference acceleration algorithm for solving constrained nonconvex-nonconcave (NC-NC) minimax problems. In particular, we design a new extra-gradient difference step to obtain an important quasi-cocoercivity property, which plays a key role to significantly improve the convergence rate in the constrained NC-NC setting without additional structural assumption. Then momentum acceleration is also introduced into our dual accelerating update step. Moreover, we prove that, to find an \(\)-stationary point of the function \(f\), the proposed algorithm attains the complexity \((^{-2})\) in the constrained NC-NC setting, while the best-known complexity bound is \(}(^{-4})\), where \(}()\) hides logarithmic factors compared to \(()\). As the special cases of the constrained NC-NC setting, the proposed algorithm can also obtain the same complexity \((^{-2})\) for both the nonconvex-concave (NC-C) and convex-nonconcave (C-NC) cases, while the best-known complexity bounds are \(}(^{-2.5})\) for the NC-C case and \(}(^{-4})\) for the C-NC case. For fair comparison with existing algorithms, we also analyze the complexity bound to find \(\)-stationary point of the primal function \(\) for the constrained NC-C problem, which shows that our algorithm can improve the complexity bound from \(}(^{-3})\) to \((^{-2})\). To the best of our knowledge, this is the first time that the proposed algorithm improves the best-known complexity bounds from \(}(^{-4})\) and \(}(^{-3})\) to \((^{-2})\) in both the NC-NC and NC-C settings.

## 1 Introduction

This paper considers the following smooth minimax optimization problem,

\[_{x}_{y}\,f(x,y),\] (1)where \(^{m}\) and \(^{n}\) are nonempty closed and convex feasible sets, and \(f:^{m}^{n}\) is a smooth function. In recent years, this problem has drawn considerable interest from machine learning and other engineering communities such as generative adversarial networks , adversarial machine learning [15; 28], game theory , reinforcement learning [12; 41], empirical risk minimization [54; 39], and robust optimization [36; 13; 5]. While there is an extensive body of literature on minimax optimization, most prior works such as [54; 39; 42; 33; 50] focus on the convex-concave setting, where \(f(x,y)\) is convex in \(x\) and concave in \(y\). However, in many nonconvex minimax machine learning problems as in [35; 6], \(f(x,y)\) is nonconvex in \(x\) and (strongly) concave in \(y\), or \(f(x,y)\) is (strongly) convex in \(x\) and nonconcave in \(y\). For _nonconvex-strongly-concave_ (NC-SC) minimax problems, a number of efficient algorithms such as [34; 25; 27] were proposed, and their complexity can be \(}(_{y}^{2}^{-2})\) for achieving an \(\)-stationary point \(\) (e.g., \(\|()\|\)) of the primal function \(():=_{y}f(,y)\), where \(_{y}\) is the condition number for \(f(x,)\), and \(}\) hides logarithmic factors. More recently,  proposed an accelerated algorithm, which improves the gradient complexity to \(}(}^{-2})\), which exactly matches the lower complexity bound in [52; 23]. Therefore, we mainly consider the problem (1) in nonconvex-nonconcave (NC-NC), nonconvex-concave (NC-C) and convex-nonconcave (C-NC) settings.

### Algorithms in NC-C and C-NC Settings

For _nonconvex-concave_ (NC-C, but not strongly concave) and _convex-nonconcave_ (C-NC) problems, there are two types of algorithms (i.e., multi-loop (including double-loop and triple-loop) and single-loop algorithms), and most of them are multi-loop algorithms such as [18; 31; 40; 24].  proposed a multi-step framework that finds an \(\)-first order Nash equilibrium of \(f(x,y)\) with the complexity \(}(^{-3.5})\).  designed a proximal dual implicit accelerated algorithm and proved that their algorithm finds an \(\)-stationary point of \(\) with the complexity \(}(^{-3})\). More recently,  proposed an accelerated algorithm, which achieves the complexity \(}(^{-2.5})\) to find an \(\)-stationary point of \(f\). These multi-loop algorithms require at least \((^{-2})\) outer iterations, and thus their complexities are more than \((^{-2})\). Even though single-loop methods are more popular in practice due to their simplicity, few single-loop algorithms have been proposed for NC-C setting. The most natural approach is the gradient descent-ascent (GDA) method, which performs a gradient descent step on \(x\) and a gradient ascent step on \(y\) at each iteration. However, GDA fails to converge even for simple bilinear zero-sum games . Subsequently, several improved GDA algorithms such as [8; 25; 27; 44] were proposed. For instance,  proved that the complexity of their two-time-scale GDA to find an \(\)-stationary point of \(\) is \((^{-6})\) for NC-C problems. Moreover,  presented an efficient algorithm, which obtains an \(\)-stationary point of \(f\) with the complexity \((^{-4})\). In fact, the complexity only counts the number of times the maximization subproblem is solved, and does not consider the complexity of solving this subproblem.  proposed a unified algorithm, and proved that the complexity of their algorithm to find an \(\)-stationary point of \(f\) is \((^{-4})\) for both NC-C and C-NC problems. More recently,  presented a smoothed-GDA algorithm and proved that the complexity can be improved to \((^{-2})\) for optimizing a special case of NC-C problems (i.e., minimizing the pointwise maximum of a finite collection of nonconvex functions). However, its complexity is still \((^{-4})\) for both NC-C and C-NC problems. One natural question is: can we design a single-loop accelerated algorithm with the optimal complexity bound \((^{-2})\) for _both NC-C and C-NC problems_?

### Algorithms in NC-NC Settings

This paper mainly considers constrained NC-NC minimax problems, i.e., \(f(x,y)\) is nonconvex in \(x\) and nonconcave in \(y\) in the constrained setting (called constrained NC-NC). In recent years, some works such as [7; 31; 46; 38; 20] focus on structured NC-NC problems. That is, the saddle gradient operator of such minimax problems or their objectives must satisfy one of the structured assumptions: the minty variational inequality (MVI) condition, the weak MVI condition, or negative comonotone condition and the Polyak-Lojasiewicz condition. However, structured NC-NC problems have limited practical applications because they are required to satisfy strong structural assumptions. For more practical constrained NC-NC problems or more general NC-NC problems, the convergence guarantee of the algorithms is still a challenge. In this paper, we also focus on convergence analysis for solving more practical constrained NC-NC problems. _Another natural question is: can we design a single-loop accelerated algorithm to further improve the bound in the constrained NC-NC setting?_

### Motivations and Our Contributions

**Motivations:** For NC-C minimax problems, can we design a single-loop directly accelerated algorithm with the gradient complexity lower than the best-known result \(}(^{-2.5})\)? Though Smoothed-GDA  can obtain the complexity \((^{-2})\) for a special case of Problem (1), it only attains the complexity \((^{-4})\) for NC-C minimax problems. For C-NC minimax problems, for any given \(x\), to solve the nonconcave maximization subproblem with respect to \(y\) is NP-hard. As a result, all existing multi-loop algorithms will lose their theoretical guarantees as discussed in . Can we propose a single-loop directly accelerated algorithm with the complexity lower than the best-known result \((^{-4})\) for C-NC and NC-NC minimax problems?

**Our Contributions:** This paper proposes a novel single-loop extra-gradient difference acceleration algorithm to push towards optimal gradient complexities for constrained NC-NC minimax problems (1), and answer the above-mentioned problems.

We summarize the major contributions of this paper.

\(\) We design a new single-loop accelerating algorithm for solving _constrained NC-NC_ problems. In the proposed algorithm, we design a new extra-gradient difference scheme, and combine the gradient ascent and momentum acceleration steps for the dual variable update. In our algorithm, we present an important quasi-cocoercivity property. By leveraging the quasi-cocoercivity property, we can improve the complexity bound in our theoretical analysis.

\(\) We analyze the convergence properties of the proposed algorithm for _constrained NC-NC_ problems. Theorem 1 shows that to find an \(\)-stationary point of \(f\), the proposed algorithm can obtain the gradient complexity \((^{-2})\), which is the first time to attains the complexity bound in constrained NC-NC setting. The _constrained NC-C and C-NC_ problems can be viewed as two special cases of the _constrained NC-NC_ problem, and the proposed algorithm is also applicable to these two special problems. And its complexity is still \((^{-2})\) for both NC-C and C-NC problems, which significantly improves the gradient complexity from \((^{-4})\) of existing single-loop algorithms or \(}(^{-2.5})\) of existing multi-loop algorithms to \((^{-2})\). The complexities of some recently proposed algorithms are listed in Table 1.

  Optimality Criteria & References & NC-C & C-NC & NC-NC & Simplicity \\    & Lu et al.  & \(}(^{-4})\) & - & - & Single-Loop \\  & Nouiehed et al.  & \(}(^{-3.5})\) & - & - & Multi-Loop \\  & Lin et al.  & \(}(^{-2.5})\) & - & - & Multi-Loop \\  & Zhang et al.  & \((^{-4})\) & - & - & Single-Loop \\  & Xu et al.  & \((^{-4})\) & \((^{-4})\) & - & Single-Loop \\  & **This work** (Theorem 1) & \((^{-2})\) & \((^{-2})\) & \((^{-2})\) & Single-Loop \\  

Table 1: Comparison of complexities of the minimax algorithms to find an \(\)-stationary point of \(f(,)\) in the NC-C, C-NC and NC-NC settings. Note that Smoothed-GDA  can find an \(\)-stationary point for a special problem of (1) with \((^{-2})\), and \(}\) hides logarithmic factors compared to \(()\).

  NC-C Settings & References & Compact set & Complexity & Simplicity \\    (Stationarity of \(\)) \\  } & Rafique et al. , Jin et al.  & \(,\) & \(}(^{-6})\) & Multi-Loop \\  & Lin et al.  & \(,\) & \(}(^{-6})\) & Single-Loop \\   & Thekumprampil et al.  & \(,\) & \(}(^{-3})\) & Multi-Loop \\  & Zhao , Lin et al.  & \(,\) & \(}(^{-3})\) & Multi-Loop \\  & **This work** (Theorem 2) & \(\) & \((^{-2})\) & Single-Loop \\  

Table 2: Comparison of complexities of existing minimax algorithms and the proposed algorithm to find an \(():=_{y}f(,y)\) in the nonconvex-concave (NC-C) setting. This table only highlights the dependence of \(\), and compared with \(()\), \(}()\) hides logarithmic factors.

\(\) In order to make a comprehensive comparison with existing algorithms, we also provide the theoretical analysis of our algorithm in terms of another convergence criteria (i.e., an \(\)-stationary point of \(\)) for constrained NC-C problems. The result shows that our algorithm improves the best-known result as in [40; 24; 55] from \(}(^{-3})\) to \((^{-2})\), as shown in Table 2.

## 2 Preliminaries and Related Works

**Notation:** Throughout this paper, we use lower-case letters to denote vectors such as \(x,y\), and calligraphic upper-case letters to denote sets such as \(,\). For a differentiable function \(f\), \(\!f(x)\) is the gradient of \(f\) at \(x\). For a function \(f(,)\) of two variables, \(_{x}f(x,y)\) (or \(_{y}f(x,y)\)) is the partial gradient of \(f\) with respect to the first variable (or the second variable) at \((x,y)\). For a vector \(x\), \(\|x\|\) denotes its \(_{2}\)-norm. We use \(_{}\) and \(_{}\) to denote projections onto the sets \(\) and \(\).

**Assumption 1** (Smoothness).: \(f(,)\) _is continuously differentiable, and there exists a positive constant \(L\) such that_

\[\|_{x}f(x_{1},y_{1})\!-\!_{x}f(x_{2},y_{2})\| L\|x_{1}\!-\!x_ {2}\|,\ \|_{y}f(x_{1},y_{1})\!-\!_{y}f(x_{2},y_{2})\| L\|y_{1}\!-\!y_ {2}\|\]

_holds for all \(x_{1},x_{2}^{m}\), \(y_{1},y_{2}^{n}\)._

**Definitions of the monotone operators:** A operator \(F():^{n}^{n}\) is monotone, if \([F(s)-F(t)]^{T}(s-t) 0,\, s,t^{n}\). If \([F(s)-F(t)]^{T}(s-t) 0\), \(F\) is negative monotone.

A mapping \(F()\) is co-coercive if there is a positive constant \(\), such that

\[[F(s)-F(t)]^{T}(s-t)\|F(s)-F(t)\|^{2},\, s,t^{n}.\]

**Nonconvex-Concave Minimax Optimization:** Due to the nonconvex nature of these minimax problems, finding the global solution is NP-hard in general. The recently proposed algorithms aim to find stationary solutions to such problems. For instance, the first-order Nash equilibrium condition (called game stationary) is used as an optimality condition in . Besides game stationary, there are two main optimality criteria (i.e., an \(\)-stationary point of \(f(,)\) or \(():=_{y}f(,y)\)) for the convergence analysis of the algorithms such as [4; 44; 24].

For solving NC-C minimax problems, there exist a number of efficient multi-loop and single-loop algorithms such as [31; 25; 4; 44; 24]. Most of them are multi-loop algorithms, which either employ an accelerated update rule of \(x\) by adding regularization terms to its subproblem, or use multiple gradient ascent steps for the update of \(y\) to solve the subproblem exactly or inexactly. Compared with multi-loop algorithms, single-loop algorithms are easier to implement. One of the most popular single-loop algorithms is GDA. However, GDA with a constant stepsize can fail to converge even for a simple bilinear minimax problem .

To address this issue, only a few single-loop algorithms such as [25; 27; 44] were proposed, and most of them employed a smoothing or proximal point technique. For instance, Smoothed-GDA  introduces a smooth function \((x,y,z)\!=\!f(x,y)+\|x\!-\!z\|^{2}\) for the update of the primal variable \(x\), where \(z\) is an auxiliary variable and \(a\) is a constant, and its main update steps are

\[x_{t+1}\!=\!_{}(x_{t}\!-\!_{x}_{x}(x_{ t},z_{t},y_{t}))\,,\,y_{t+1}\!=\!_{}(y_{t}\!+\!_{y} _{y}f(x_{t+1},y_{t}))\,,\,z_{t+1}\!=\!z_{t}\!+\!(x_{t+1}\!-\!z_{t}),\]

where \(_{x},_{y}\!>\!0\) are two stepsizes, and \(0\!<\!\!\!1\). Smoothed-GDA can obtain the gradient complexity, \((^{-4})\), for nonconvex-concave minimax problems.

**Extra-Gradient Methods:** There are some extra-gradient methods such as  for solving minimax problems. Let \(_{0}>0\) and \(u_{t}\) be the \(t\)-th iterate, the extra-gradient method  has the following projection-type prediction-correction step:

\[:u_{t+1/2}=_{}(u_{t}-_{t}F(u_{t}) ),\,:u_{t+1}=_{}(u_{t}-_{t}F( u_{t+1/2})).\]

In this paper, we call \(u_{t+1/2}\) as the prediction point at the \(t\)-iteration.

## 3 Single-Loop Extra-Gradient Difference Acceleration Algorithm

In this section, we propose a single-loop Extra-Gradient Difference Acceleration algorithm (EGDA) for solving constrained NC-NC minimax problems.

### Extra-Gradient Difference Acceleration

In recent years, many algorithms such as [27; 31; 32; 24; 51; 44] have been proposed for solving NC-C minimax problems. In essence, most of them are "indirect" acceleration algorithms, which are used to optimize the surrogate functions with a smoothing or proximal point term instead of the original function. However, this may hurt the performance of these algorithms both in theory and in practice [2; 1]. To address this issue, we propose a single-loop directly accelerating algorithm to find an \(\)-stationary points of \(f\) and \(\) with a significantly improved complexity \((^{-2})\). The main update steps of our EGDA algorithm are designed as follows.

\(\) Gradient descent:

\[x_{t+1}=_{x}\{_{\!x}f(x_{t},y_{t}),\,x +\|x\!-\!x_{t}\|^{2}/_{x}\}.\] (2)

\(\) Extra-gradient difference prediction:

\[u_{t+1/2}=y_{t}+[_{\!y}f(x_{t},u_{t-1/2})\!-\!_{\!y}f(x_{t},y _{t-1})].\] (3)

\(\) Gradient ascent correction:

\[u_{t+1}\!=\!_{u}\{_{\!y}f(x_{t},u_{t-1/2}), \,u-\|u\!-\!y_{t}\|^{2}/_{y}^{t}\}.\] (4)

\(\) Momentum acceleration:

\[y_{t+1}= y_{t}+(1-)u_{t+1}.\] (5)

Here, \(0<<\), \(_{x},_{y}^{t}>0\) are two stepsizes, \(u_{t+1/2},u_{t+1}\) are auxiliary variables, \(u_{t+1/2}\) is a prediction point, and \(1/2< 1\) is a momentum parameter. Our EGDA algorithm is formally presented in Algorithm 1. Our EGDA algorithm first performs one proximal gradient descent step on the primal variable \(x\), and then we design a new dual-accelerating scheme in (3), (4) and (5) for the dual variable \(y\).

```
1:Initialize:\(x_{0},y_{0},u_{0},u_{-1/2}\),\(>0.5\), \(_{x}\), \(_{y}^{t}\), \(\).
2:for\(t=0,1,,T-1\)do
3:\(x_{t+1}=_{\!}x_{t}\!-\!_{x}_{\!x}f(x_ {t},y_{t})\); \(u_{t+1/2}\!=\!y_{t}\!+\![_{\!y}f(x_{t},u_{t-1/2})\!-\!_{\!y }f(x_{t},y_{t-1})]\);
4:\(u_{t+1}\!=\!_{\!}[y_{t}\!+\!_{y}^{t}_{\!y }f(x_{t},u_{t\!-\!1/2})]\); \(y_{t+1}= y_{t}+(1-)u_{t+1}\);
5:endfor
6:Output:\((x_{T},y_{T})\). ```

**Algorithm 1** EGDA for NC-NC minimax problems

### Advantages of Our Algorithm and Comparison to Related Work

We first design a new prediction point \(u_{t+1/2}\) in Eq. (3). Compared with extra-gradient-type methods such as [7; 16; 20], one of the main differences is that the proposed prediction point \(u_{t+1/2}\) in (3) is updated by the gradient difference (i.e., \(_{\!y}f(x_{t},u_{t-1/2})-_{\!y}f(x_{t},y_{t-1})\)), while the prediction point in other extra-gradient-type algorithms is updated only by using the gradient information at the correction point \(u_{t}\). Then the gradient at the new prediction point \(u_{t+1/2}\) is used in the gradient ascent step (4). And the dual variable \(y\) is update by the momentum acceleration step in (5).

\(\)**Prediction Point:** The monotonicity and co-coercivity properties of gradient operators play a crucial role for convergence analysis. However, these important properties do not always hold for nonconvex problems. Some researchers have made great progress in some special nonconvex settings, such as structured nonconvex and weakly convex settings, which require a weaker condition such as weakly monotone , pseudo-monotone , and MVI . However, such conditions seriously limit the application scope of Problem (1).

To address this challenge, we design a new prediction point scheme in (3), which can help us obtain a useful quasi-cocoercivity property. As a result, it does not require any monotone or structural assumption. Specifically, we find that we only require a weaker property in our theoretical analysis, that is, the co-coercivity is required at some special points \(\{u_{t+1/2},y_{t}\}\) (\(_{\!y}f(x_{t},u_{t+1/2})-_{\!y}f(x_{t},y_{t}),u_{t+1/2}-y_{ t}\|_{\!y}f(x_{t},u_{t+1/2})-_{\!y}f(x_{t},y_{t})\|^{2}\) with \(>0\)). Thus, we develop adecoupling idea to construct the prediction point \(u_{t+1/2}\). That is, we use the gradients with respect to \(y\) at \(u_{t-1/2},y_{t-1}\) instead of those at the points \(u_{t+1/2},y_{t}\). We can obtain a property (called the quasi-co-coercivity) in Section 4.2, which plays a key role in our theoretical analysis.

\(\)**Gradient Difference:** We also briefly discuss the underlying intuition of the proposed gradient difference in (3). We find that the proposed update in (3) is similar to the forms in  (see Eqs. (12) and (14) in ).  proposed a first-order procedure (i.e., difference of gradients) to achieve the negative curvature of a Hessian matrix. Therefore, our algorithm has a similar procedure, which contains second-order information. Moreover, we use the difference of gradients in the gradient ascent procedure for the dual update. But our EGDA algorithm only requires the Lipschitz gradient assumption for minimax problems to find first-order stationary points, while  requires both the Lipschitz gradient and Lipschitz Hessian assumptions for solving second-order stationary points of nonconvex minimization problems.

\(\)**Momentum Acceleration:** We design a dual-accelerating update rule in (4) for the dual variable \(y\) in our EGDA algorithm, which is different from standard momentum acceleration schemes as in [31; 40; 24]. That is, the accelerated rules of existing algorithms are for the primal variable \(x\), while our accelerated rule is designed for the dual variable \(y\).

Therefore, the proposed new dual-accelerating step (including the gradient different prediction step in (3), the gradient ascent correction in (4) and momentum acceleration in (5)) is a key accelerated technique for our EGDA algorithm, and can help to improve the complexity bound from \((^{-4})\) to \((^{-2})\). In particular, our EGDA algorithm performs both gradient descent and ascent steps to the original function \(f\). In contrast, many existing algorithms such as [51; 47; 44; 18] optimize their surrogate functions with smoothing terms instead of the original function. In particular, their smoothing parameters need to tune by repeatedly executing the algorithms, which may make them impractical . As in our theoretical guarantees below, the proposed single-loop algorithm is able to significantly improve the best-known gradient complexity, \((^{-4})\), of existing single-loop algorithms such as [27; 51; 44] to \((^{-2})\).

## 4 Convergence Guarantees

In this section, we provide the convergence guarantees of our EGDA algorithm (i.e., Algorithm 1) for solving constrained NC-NC and NC-C problems. We first present the definitions of the two optimality criteria (i.e., an \(\)-stationary point of \(f\) or \(\)). All the proofs of the lemmas, properties and theorems below are included in the Supplementary Material.

### Optimality Criteria and Key Property

Since finding a global minimum of a nonconvex optimization problem is NP-hard, finding a global saddle point (or Nash equilibrium) of a NC-NC function \(f\) is intractable . As in the literature in the _NC-NC_ setting, we introduce the local surrogates (i.e., the stationary point of \(f\)) and in the _NC-C setting_, we introduce the local surrogates (i.e., the stationary point of \(f\) or \(\)), whose gradient mappings are equal to zero. Below we define the following two optimality measures (i.e., an \(\)-stationary points of \(f\) or \(\)) for our theoretical analysis.

**Definition 1** (An \(\)-stationary point of \(f\)).: _A point \((,)\) is an \(\)-stationary point of \(f(,)\) if \(\|(,)\|\), where \(_{x}\) and \(_{y}\) are two constants, and_

\[(,):=(1/_{x})(- _{}(-_{x}_{x}f(, )))\\ (1/_{y})(-_{}(+_{y} _{y}f(,))).\] (6)

_If \(=0\), then \((,)\) is a stationary point of \(f\)._

For the _NC-C_ setting, we also present another convergence criterion used in [40; 24]. Let \((x):=_{y}f(x,y)\), \(\) is called an \(\)-stationary point of a smooth primal function \(:^{m}\), if \(\|()\|\). However, the function \(\) is not necessarily differentiable for minimax problems. Following [9; 40; 24], we introduce the Moreau envelope of \(\) for the optimality criterion, especially when \(\) is a weakly convex function, i.e., \(\) is \(L\)-weakly convex if the function \(()+\|\|^{2}\) is convex. We refer readers to [9; 24] for the comparison of these two criteria.

**Definition 2** (An \(\)-stationary point of \(L\)-weakly convex function \(\)).: \(\) _is an \(\)-stationary point of an \(L\)-weakly convex function \(:^{m}\!\!\), if \(\|_{1/(2L)}()\|\!\!\), where \(_{1/(2L)}\) is the Moreau envelope of \(\) and is defined as: \(_{}(x)\!:=\!_{z}(z)\!+\!(1/2)\|z\!-\!x\|^{2}\). If \(=0\), then \(\) is a stationary point._

Then we give the following important property for the analysis of the proposed algorithm. By leveraging the property, we can obtain the complexity bound of the proposed algorithm.

**Property 1** (**Quasi-Cocoercivity**).: _Let \(u_{t+1/2}\) be updated in Eq. (3), then_

\[_{y}f(x_{t},u_{t-1/2})-_{y}f(x_{t},y_{t-1}),\ u_{t+1/ 2}-y_{t}=\|_{y}f(x_{t},u_{t-1/2})-_{y}f(x_{t},y_ {t-1})\|^{2}.\]

### Core Lemma

Our theoretical results mainly rely on Lemma 1 below, which plays a key role in the proofs of Theorems 1 and 2. Let \(\{(x_{t},y_{t},u_{t},u_{t-1/2})\}\) be a sequence generated by Algorithm 1, and we define the potential function

\[G_{t}:=f(x_{t},y_{t})\!+\!9L\|u_{t}\!-\!y_{t\!-\!1}\|^{2}\!+\!8L^{2}\| _{y}f(x_{t-1},u_{t-3/2})\!-\!_{y}f(x_{t-1},y_{t-2})\|^{2}.\]

Next, we need to prove that our defined potential function can make sufficient decrease at each iteration, i.e., \(G_{t}-G_{t+1}\!>\!0\) as in Lemma 1 below. To prove Lemma 1, we will provide and prove the following upper bounds.

**Proposition 1** (Upper bound of primal-dual updates).: _Suppose Assumption 1 holds. Let \(\{(x_{t},y_{t},u_{t})\}\) be a sequence generated by Algorithm 1 with \(_{y}^{t}\!\!=\!\!\{f(x_{t}\,u_{t-1/2})-_ {y}f(x_{t},y_{t-1})\|^{2}}{2\|_{y}f(x_{t},u_{t-1/2})\|^{2}},,_{x}\}\)._

\[f(x_{t+1},u_{t+1/2})\!-\!f(x_{t},y_{t})\] \[\!\!-(}-)\|x_{t+1}\!- \!x_{t}\|^{2}\!+\!L\|u_{t+1/2}-y_{t}\|^{2}+L\|y_{t}-y_{t-1}\|^{2}\!+\! {_{y}f(x_{t},y_{t-1}),u_{t+1/2}\!-\!y_{t}}_{A _{1}}.\]

**Proposition 2** (Upper bound of dual updates).: _Suppose Assumption 1 holds. Let \(\{(x_{t},y_{t},u_{t})\}\) be a sequence generated by Algorithm 1, then_

\[f(x_{t\!+\!1},y_{t\!+\!1})\!-\!f(x_{t+1},u_{t+1/2})\] \[\!_{y}f(x_{t}\,u_{t-1/2}), y_{t}\!-\!u_{t+1}}_{A_{2}}\!+\!_{y}f(x_{t},\!u_{t-1/2}),\!u_{t+1}\!-\!u_{t+1/2}}_{A_{3}}+\!a_{t},\]

_where \(a_{t}:=2L\|x_{t+1}\!-\!x_{t}\|^{2}\!+\!6L^{2}\|_{y}f(x_{t},u_{t-1/ 2})\!-\!_{y}f(x_{t},y_{t-1})\|^{2}\!+\!8L(1-)^{2}\|u_{t}\!-\!y_{t\!- \!1}\|^{2}+8L^{2}\|_{y}f(x_{t-1},u_{t-3/2})\!-\!_{y}f(x_{t-1}, y_{t-2})\|^{2}+3L\|u_{t+1}\!-\!y_{t}\|^{2}\)._

Using the optimal condition of Problem (4) and our quasi-cocoercivity in Property 1, we can further bound \(A_{1}+A_{2}+A_{3}\). The proof sketch of Lemma 1 is listed as follows:

\[G_{t+1}\!\!-\!G_{t} :=\!,y_{t\!+\!1})\!-\!f(x_{t\!+\!1},u_{t \!+\!1/2})}_{}\!+\!,u_{t\!+\!1/2})\!-\!f(x_{t},y_{t })}_{}+\!\] \[=+A_{2}+A_{3}}_{}+.\]

Combining the above results and the definition of \(G_{t}\), we can get the descent estimate of the potential function in Lemma 1, which is a main lemma for Theorems 1 and 2 below.

**Lemma 1** (Descent estimate of \(G\)).: _Suppose Assumption 1 holds. Let \(\{(x_{t},y_{t},u_{t})\}\) be a sequence generated by Algorithm 1, then_

\[G_{0}-G_{T}\] \[=_{t=0}^{T-1}(G_{t}-G_{t+1})\] \[_{t=0}^{T-1}(\!^{t}}\|u_{t+1}-y_{t }\|^{2}\!+\!}{2}\|_{y}f(x_{t},u_{t-1/2})\!- \!_{y}f(x_{t},y_{t-1})\|^{2}\!+\!}\|x_{t\!+\!1}\!-\!x_{t }\|^{2}\!).\]

### Convergence Results

In this subsection, by using the optimality measure in Definitions 1 and 2, we present the following theoretical results in Theorem 1 and Theorem 2 for the constrained NC-NC setting and NC-C setting, respectively.

**Assumption 2**.: \(\) _is a closed, convex and compact set with a diameter \(D_{}>0\), and \(\) is a closed and convex set._

Furthermore, using Lemma 1 and the optimality measure in Definition 1, we will study the relation between \((x_{t},u_{t})\) and the difference (i.e., \(G_{t}-G_{t+1}\)) to obtain the gradient complexity in Theorem 1 by computing the number of iterations to achieve an \(\)-stationary point of \(f\).

**Theorem 1** (Stationarity of \(f\) in constrained NC-NC settings).: _Suppose Assumptions 1 and 2 hold. Let the two stepsizes \(_{x}\), \(_{y}^{t}=\{f(x_{t},u_{t-1/2})-_{y}f(x_{t},y_{t-1})\|^{2}}{2\|_{y}f(x_{t},u_{t-1/2})\|^{2}},, _{x}\}\), \(\) and \( 1/2\), then the complexity of Algorithm 1 to find an \(\)-stationary point of \(f\) is bounded by_

\[-+2LD_{}^{2}}{^{ 2}},\]

_where \(G_{0}:=G(x_{0},y_{0})\), and \(:=_{x}(x)\)._

**Remark 1**.: _For constrained NC-NC problems, the gradient complexity of our EgDA algorithm to find an \(\)-stationary point of \(f\) is \((^{-2})\). That is, our EgDA algorithm is first to obtain the gradient complexity in constrained NC-NC setting. In addition, our method can achieve the same complexity, \((^{-2})\), as the algorithm with an additional structured assumption for NC-NC problems. However, different from existing algorithms, our algorithm is more practical. That is, it only requires that \(\) is a compact set, while existing algorithms need some stronger structured assumptions in the structured NC-NC setting. The detailed comparison is shown in Table 1. As two special cases of the constrained NC-NC problem, this theoretical result in Theorem 1 can be extended to the constrained NC-C and C-NC settings. For NC-C problems, the gradient complexity of our EgDA algorithm to find an \(\)-stationary point of \(f\) is \((^{-2})\), while the best-known result of single-loop algorithms such as [27; 51; 44] is \((^{-4})\), and the best-known result of multi-loop algorithms such as  is \(}(^{-2.5})\). That is, our EgDA algorithm improves the best-known gradient complexity from \(}(^{-2.5})\) to \((^{-2})\). Smoothed-GDA  can also obtain the complexity \((^{-2})\) for a special case of Problem (1) and \((^{-4})\) for general NC-C minimax problems, while our algorithm attains the optimal result \((^{-2})\) for all NC-C minimax problems. Existing algorithms such as HiBSA  and AGP  require the compactness of the domain \(\) in the NC-C setting, while our EgDA algorithm does not, which significantly extends its applicability. For C-NC minimax problems, the proposed algorithm can obtain the complexity, \((^{-2})\), while the best-known complexity as in  is \((^{-4})\). In other words, the proposed algorithm can improve the best-known result from \((^{-4})\) to \((^{-2})\)._

By using the criterion in Definition 2 as the optimality measure, we use the definition of \(_{1/2L}\) and introduce the property of \(_{1/2L}\) as in . With a similar setting for varying stepsizes as in , we study the relation between \(_{1/2L}\) and the basic descent estimation of the potential function in Lemma 1 by using the property of \(_{1/2L}\), and compute the number of iterations to achieve an \(\)-stationary point of \(\). We provide the following theoretical result and its detailed proof in the Supplementary Material.

**Theorem 2** (Stationarity of \(\) for constrained NC-C settings).: _Using the same notation as in Theorem 1, and \(f\) is concave with respect to \(y\). Let \(\{(x_{t},y_{t},u_{t})\}\) be a sequence generated by Algorithm 1 with the stepsizes \(_{y}^{t}\!=\!\{^{2}}{2b_{t}^{2}},, ^{2}}{2b_{t}^{2}},^{2}}{2d_{t}}\}\), where \(a_{t}\!:=\!\|_{y}f(x_{t},\!u_{t\!-\!1/2})\!-\!_{y}f(x_{t},y_{t\!- \!1})\|\!,b_{t}\!:=\!\|_{y}f(x_{t},u_{t\!-\!1/2})\|\!,c_{t}\!:=\!\|_ {y}f(x_{t},u_{t\!-\!1/2})\|\!,d_{t}\!:=\!\|_{y}f(x_{t},u_{t\!-\!1/2})\!- \!_{y}f(x_{t},u_{t\!-\!1/2})\|\). Then the gradient complexity of Algorithm 1 to find an \(\)-stationary point of \(\) is bounded by_

\[}(G_{0}-+2LD_{}^{ 2})}{^{2}}.\]

**Remark 2**.: _From Theorem 2, it is clear that the gradient complexity of the proposed algorithm is \((^{-2})\). That is, Algorithm 1 can improve the best-known gradient complexity from \(}(^{-3})\) as in  to \((^{-2})\). Therefore, Algorithm 1 is the first algorithm, which attains the gradient complexity \((^{-2})\) to find an \(\)-stationary point of \(\) for NC-C minimax problems._

## 5 Numerical Results

We conduct many experiments to illustrate the performance of the proposed algorithm for solving NC-NC, NC-C and convex-concave problems.

**NC-NC Problems.** We conduct some experiments to illustrate the performance of the proposed algorithm, EGDA, for solving NC-NC problems. Moreover, we compare it against existing methods such as GDA , EG , EAG  and FEG . Detailed setup is provided in the Supplementary Material.

We compare EGDA with GDA, EG and FEG for solving a simple NC-NC minimax problem (i.e., \(f(x,y)\!=\!x^{2}+3^{2}\!x^{2}\!y\!-\!4y^{2}\!-\!4y^{2}\!-\!10^{2}\!y\)), which satisfies the Polyak-Lojasiewicz condition, as shown in Fig. 1. All the results show that EGDA indeed converges to the global saddle point and is significantly faster than other methods including GDA and FEG in terms of both \(\|x_{t}-x^{*}\|^{2}+\|y_{t}-y^{*}\|^{2}\) and \(\|_{\!x}f\|^{2}+\|_{\!y}f\|^{2}\). Although FEG has a fast theoretical rate, \((1/t^{2})\), with a negative monotone assumption, it converges much slower than EGDA in practice.

**Convex-Concave Problems.** Fig. 2 shows the convergence results of the methods including GDA, EAG  and EGDA for solving the convex-concave problem, \(f(x,y)=(1+e^{x})+3xy-(1+e^{y})\). It is clear that EGDA converges much faster than other methods such as EAG. We also observe empirically when the same step-size is used, even if small, GDA may not converge to stationary points, and it is proven to always have bounded iterates.

**NC-C Problems.** We also apply our EGDA algorithm to train robust neural networks against adversarial attacks on Fashion MNIST and MNIST, and verify our theoretical results. In [15; 28; 31],

Figure 1: Comparison of all the methods for solving the NC-NC problem, \(f(x,y)=x^{2}+3^{2}\!x^{2}\!y-4y^{2}-10^{2}\!y\). Left: Convergence in terms of \(\|x_{t}-x^{*}\|^{2}+\|y_{t}-y^{*}\|^{2}\), where \((x^{*},y^{*})\) is the global saddle point; Right: Convergence in terms of \(\|_{\!x}f\|^{2}+\|_{\!y}f\|^{2}\).

Figure 2: Comparison of all the methods for solving the convex-concave problem, \(f(x,y)=(1+e^{x})+3xy-(1+e^{y})\). Left: Trajectories of the three algorithms; Right: Convergence in terms of \(\|x_{t}-x^{*}\|^{2}+\|y_{t}-y^{*}\|^{2}\).

the robust training procedure can be formulated into a NC-C minimax optimization problem. It is clear that the minimax problem is nonconvex in \(x\), but concave in \(y\).

FGSM  and PGD  are two popular methods for generating adversarial examples. To obtain the targeted attack \(_{ij}\), we use the same procedure as in [31; 51] as follows. The perturbation level \(\) is chosen from \(\{0.0,0.1,0.2,0.3,0.4\}\), and the stepsize is \(0.01\). Note that the number of iterations is set to \(40\) for FGSM and \(10\) for PGD, respectively. The details of the network are included in the Supplementary Material. We compare our EGDA method with GDA , MGDA  and Smoothed-GDA , and illustrate the convergence of all the algorithms on the loss function in Fig. 3. The results show that Smoothed-GDA and EGDA converge significantly faster than other algorithms. This verifies that they have a faster convergence rate, \(}(^{-})\). Moreover, EGDA converges much faster than Smoothed-GDA.

## 6 Conclusions and Future Work

In this paper, we proposed a new single-loop accelerated algorithm for solving various constrained NC-NC minimax problems. In the proposed algorithm, we designed a novel extra-gradient difference scheme for dual updates. Moreover, we provided the convergence guarantees for the proposed algorithm, and the theoretical results show that to find an \(\)-stationary point of \(f\), the proposed algorithm obtains the complexity bound \((^{-2})\) for constrained NC-NC problems. That is, this is the first time that the proposed algorithm attains the complexity bound \((^{-2})\) in constrained NC-NC settings (including constrained NC-C and C-NC). For NC-C problems, we provided the theoretical guarantees of the proposed algorithm under the stationarity of \(\), which show that our algorithm improves the complexity bound from \(}(^{-3})\) to \((^{-2})\). Experimental results also verified the theoretical results of the proposed algorithm, which have the factors of \(^{-1}\) and \(^{-2}\) faster than existing algorithms, respectively. For further work, we will extend our directly accelerating algorithm to stochastic, non-smooth, nonconvex-nonconcave and federated learning settings as in [47; 11; 4; 55; 45; 21; 37].