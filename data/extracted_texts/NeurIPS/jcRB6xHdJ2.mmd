# Interaction Measures, Partition Lattices and Kernel Tests for High-Order Interactions

Zhaolu Liu\({}^{1}\)  Robert L. Peach\({}^{2,3}\)  Pedro A.M. Mediano\({}^{4}\)  Mauricio Barahona\({}^{1}\)

\({}^{1}\)Department of Mathematics, Imperial College London, United Kingdom

\({}^{2}\)Department of Neurology, University Hospital Wurzburg, Germany

\({}^{3}\)Department of Brain Sciences, Imperial College London, United Kingdom

\({}^{4}\)Department of Computing, Imperial College London, United Kingdom

Corresponding author: m.barahona@imperial.ac.uk

###### Abstract

Models that rely solely on pairwise relationships often fail to capture the complete statistical structure of the complex multivariate data found in diverse domains, such as socio-economic, ecological, or biomedical systems. Non-trivial dependencies between groups of more than two variables can play a significant role in the analysis and modelling of such systems, yet extracting such high-order interactions from data remains challenging. Here, we introduce a hierarchy of \(d\)-order interaction measures, increasingly inclusive of possible factorisations of the joint probability distribution, and define non-parametric, kernel-based tests to establish systematically the statistical significance of \(d\)-order interactions. We also establish mathematical links with lattice theory, which elucidate the derivation of the interaction measures and their composite permutation tests; clarify the connection of simplicial complexes with kernel matrix centring; and provide a means to enhance computational efficiency. We illustrate our results numerically with validations on synthetic data, and through an application to neuroimaging data.

## 1 Introduction

There is increasing evidence that pairwise relationships are insufficient to model many real world systems [1; 2; 3]. The relevance of high-order interactions has been emphasised in many contexts, as relationships within social , ecological [5; 6], and biological systems [7; 8] frequently involve groups of three or more agents, beyond pairwise associations. Such high-order interactions can be neither trivially represented by a linear combination of dyadic relationships, as the presence of high-order interactions can significantly impact the dynamics on networked systems [9; 10; 11; 12; 13; 14; 15], nor can they be simply detected by joint independence tests which inherently ignore other possible factorisations of the joint distribution.

Direct measurements of group interactions are seldom available, leading to their omission, partial representation as projected pairwise interactions [16; 17; 18], or limited recovery through inference methods [19; 20]. Often, only indirect measurements of underlying interactions in real-world complex systems are available, in the form of \(iid\) or time-series data. Methods that learn high-order interactions from time-series data have been developed [11; 21], however, their reliance on heuristic measures makes their interpretation difficult. Alternative methods have been developed with strong foundations in statistics  and information theory[23; 24; 25], however, as we show later, these are often basedon an incomplete set of interactions and thus fail to capture all possible factorisations of the joint probability distribution [26; 27].

Kernel-based hypothesis tests provide a non-parametric, statistically robust framework for detecting relationships between variables from observational data. Such tests have been implemented for pairwise [28; 29; 30; 31] and \(d\)-variate joint independence [32; 33], and proven to be effective for non-trivial dependencies such as in the 3-way Lancaster test [34; 35]. However, to the best of our knowledge, cases where the number of variables exceeds 3 are still unexplored.

Here, we extend the capability for detection of high-order interactions by introducing a family of tests based on factorisations of the joint probability distribution that generalise systematically to any order \(d\). At the head of this family, we introduce the Streitberg interaction test, which captures all factorisations of the joint distribution of order \(d\). We further show that, despite the fact that the naive extension to \(d 4\) of the Lancaster interaction excludes some of the factorisations of the joint distribution, not all is lost, and we detail the conclusions that can be drawn from rejecting the \(d\)-order Lancaster interaction. Furthermore, we show that: (_i_) lattice theory provides a coherent theoretical foundation for detecting high-order interactions; (_ii_) interaction measures can be systemically derived from partition lattices; (_iii_) the corresponding Hilbert-Schmidt norm for kernel embeddings can naturally be extracted from the product lattice; (_iv_) the composite permutation tests can be performed with regard to the second level of the lattice; and (_v_) the lattice formulation allows us to propose a generalised interaction measure that can be used to test whether a given factorisation can be factorised further. Despite the inescapable combinatorial nature of testing high-order interactions, we offer approaches to reduce the computational complexity of our \(d\)-order interaction tests informed by our links with lattice theory. Finally, we present numerical validations of our tests on synthetic data before applying them to real-world neuroimaging data.

## 2 Interaction Measures

The most basic form of interaction between variables occurs between two variables, \(X^{1}\) and \(X^{2}\), and is often characterized by the lack of pairwise independence, i.e., the difference between the joint distribution \(_{X^{1},X^{2}}\) and the product of the marginal distributions \(_{X^{1}}\) and \(_{X^{2}}\) (see Fig. 1, \(d=2\)). Let us consider \(d\) random variables \(\{X^{1},X^{2},,X^{d}\}\) with joint distribution \(_{X^{1},,X^{d}}=:_{1 d}\) (for readability, hereafter we use this subscript notation). The \(d\) variables are jointly independent if and only if \(_{1 d}\) can be factorised as the product of the univariate marginal distributions. Hence we can introduce an interaction measure that vanishes only when the variables are jointly independent:

\[_{I}^{d}=_{1 d}-_{i=1}^{d}_{i}.\] (1)

When \(d>2\), however, the criterion for joint independence fails to capture high-order interactions, since additional factorisations must be considered. For instance, if \(_{123}\) could be factorised as

Figure 1: **Factorisations of joint distributions \(_{1 d}\) for \(d=2,3,4\). The black dots indicate the marginal distributions of the singletons. The line, triangular and square shapes represent the joint distribution of two, three and four variables respectively. Different factorisations are presented as partitions of the \(d\) variables ordered by increasing cardinality from top to bottom, so that all the factorisations with the same number of independent blocks appear at the same level. Joint independence considers only the top and bottom levels for each \(d\), whilst the Lancaster interaction considers all terms except those in the shaded region. The Streitberg interaction considers all partitions. Hence, for \(d=2\), we have \(_{I}^{2}=_{I}^{2}=_{S}^{2}\); whereas for \(d=3\), we have \(_{I}^{3}_{L}^{3}=_{S}^{3}\), and for \(d 4\), we have \(_{I}^{d}_{L}^{d}_{S}^{d}\).**

\(_{1}_{23}\) (see Fig. 1, \(d=3\)), joint independence would be rejected, yet there is no \(3\)-way interaction. Instead, we seek a way of identifying high-order interactions for \(d\) variables where all lower order independencies can be rejected.

One approach to address the shortcomings of joint independence in identifying high-order interactions for \(d>2\) variables is to use a signed measure called the Lancaster interaction . The Lancaster interaction for \(d=3\) is defined as \(_{L}^{3}=_{123}-_{1}_{23}- _{2}_{13}-_{3}_{12}+2_{1} _{2}_{3}\). \(_{L}^{3}\) vanishes if \(_{123}\) can be factorised in any way, and has been implemented as a kernel-based test statistic to identify non-factorisable joint distributions [34; 35]. Lancaster also generalised this measure to the multivariate case with \(d\) variables:

\[_{L}^{d}=_{i=1}^{d}(_{i}^{*}-_{ i}),\] (2)

where \(_{i}^{*}_{j}^{*}_{k}^{*}=_{ij  k}\). The Lancaster interaction (2) vanishes when the joint distribution can be factorised into jointly independent subvectors for \(d=3\), but it fails when \(d 4\). Specifically, \(_{L}^{4}P\) does not vanish if \(_{1234}\) factorises into \(_{12}_{34}\), \(_{13}_{24}\), or \(_{14}_{23}\). Despite this, the Lancaster interaction is not entirely uninformative for \(d 4\), and in Section 4.1 we examine the necessary conditions for it to vanish.

The desired vanishing property can be achieved by using the Streitberg interaction , a more general interaction measure defined using partitions. Let \(D\) be the set of random variables \(\{X^{1},X^{2},,X^{d}\}\), and let \((D)\) denote the set of all partitions of \(D\), where a partition \(\) is a collection of nonempty, pairwise disjoint subsets (blocks) \(b_{j} D\) that cover \(D\). Then, the Streitberg interaction measure is defined as

\[_{S}^{d}=_{(D)}(||-1)!(-1 )^{||-1}_{}.\] (3)

Here, \(||\) denotes the cardinality of the partition \(\), and \(_{}=_{j=1}^{r}_{b_{j}}\) is the corresponding factorisation with respect to \(=b_{1}|b_{2}||b_{r}\). It has been proven that \(_{S}^{d}=0\) if the joint distribution can be factorised in any way, although the converse is not true in general .

## 3 Partition Lattices

The expressions of the interaction measures outlined in the previous section can be systematically generated from partition lattices. Interestingly, this formulation also allows us to establish further theoretical links with simplicial complexes.

Notation.A partially ordered set defined on a set \(S\) with a binary relation \(\) is a lattice \(\) if for any \(,\) there exists a greatest lower bound (meet) \(\) and least upper bound (join) \(\). We denote the maximum and minimum element of a lattice as \(\) and \(\). Let \(()\) denote a real-valued function defined on \(S\), then the sum function \(f()\) is analogous to the integration of \(()\) over the interval \([,]\), where \(\). Then \(()\) can be expressed as the inverse operation of \(f()\):

\[f()=(,)\,(),()=_{ }(,)\,f(),\] (4)

where the partial order is encoded by the Zeta matrix, with \((,)=1\) if \(\) and 0 otherwise. Its inverse is the Mobius matrix with elements \((,)\) (for details see Section D), which can be obtained explicitly .

Lattices and Interaction Measures.The construction of the interaction measures in Section 2 is closely related to the partition lattice [26; 37]. The partition lattice is defined on the set \((D)\) with ordering given by the notion of partition refinement. A partition \(\) is said to refine another partition \(\), denoted as \(\), if every block of \(\) is fully contained within a block of \(\). The lattice structure thus allows us to define the least upper bound \(\) and the greatest lower bound \(\) between any two partitions \(\) and \(\). Clearly, the maximum element of the partition lattice, \(\), corresponds to the joint distribution, whereas the minimum element, \(\), corresponds to the complete factorisation (Fig. 1).

Within this formalism, the interaction measures are obtained when the sum function \(f()\) in (4) is the probability distribution function. It then follows that the interaction measures are obtainedfrom the inverse operation. Indeed, the Streitberg interaction (3) is given by the Mobius inversion defined over the complete partition lattice. In contrast, the Lancaster interaction is obtained when the inversion is defined over the subset of partitions that have at most one non-singleton block, which we denote as the _Lancaster sublattice_. In other words, the sum function associated with the Lancaster interaction considers fewer interactions than the Streitberg interaction and its Mobius inversion has correspondingly fewer terms, as seen in (2). Note that for \(d=3\), the full (Streitberg) lattice and the Lancaster sublattice are the same, hence the interaction measures coincide. For \(d 4\), however, the Streitberg and Lancaster lattices, and consequently the corresponding interaction measures, are different, as shown by the extra partitions with two non-singleton blocks (shaded region) in Figure 1. Note also that joint independence considers a trivial sublattice with only two elements: \(\) and \(\) (for any \(d\)). The Mobius inversion on this sublattice leads to (1), which only vanishes for complete factorisations.

Links to Simplicial Complexes.A popular representation of high-order systems in the literature is through simplicial complexes . Importantly, the simplicial complex construction can also be understood in terms of partition lattices. In particular, the elements in a (\(d-1\))-simplex have inclusion ordering and thus form a subset lattice, e.g., \(\{X^{1},X^{2}\}\) is a subset of \(\{X^{1},X^{2},X^{3}\}\). The subset lattice has been utilised in the understanding of information geometry  and solving tensor balancing . It can be shown that the deatomised sublattice (with removal of singletons) is isomorphic to the Lancaster lattice . Furthermore, the boundary matrices of a (\(d-1\))-simplex appear as block matrices both in the Zeta matrix and the (inverse) Mobius matrix of the \(d\)-order partition lattice. These are explored further in Section E in the SI.

Note that the non-singleton partitions, i.e., those that do not belong to the Lancaster sublattice, are not in the set of simplicial complexes. Hence these blocks and their respective refinements _cannot_ be expressed in terms of boundary matrices. Therefore the full partition lattice and its resulting Streitberg interaction provides more information compared with measures originating from sublattices, and in particular the Lancaster lattice and its related simplicial complex construction [23; 24]. Whilst simplicial complexes, and similarly the Lancaster interaction, can be recursively constructed from lower order elements, this is not possible for the Streitberg interaction due to the partitions without singletons, which has implications on computational efficiency (Section 5).

## 4 Kernel Interaction Tests

The interaction measures in Section 2 can be utilised as statistics in non-parametric tests when embedded into reproducing kernel Hilbert spaces (RKHS). Given a symmetric, positive definite function \(k^{i}:^{i}^{i}\), there is an associative RKHS \(^{i}\) with the reproducing kernel property. For \(X^{i}^{i}\), we denote \(^{i}()\) as the canonical map of \(k^{i}(X^{i},)\). The kernel mean embedding of \(_{X^{i}},_{_{X^{i}}}\), satisfies \(_{X^{i}}f(X^{i})=<f,_{_{X^{i}}}>_{}\), where HS stands for Hilbert-Schmidt. If the kernel is characteristic, the mean embedding is injective and the norm of the signed measure is zero if and only if the measure is zero itself [28; 34; 42]. These properties enable us to create meaningful non-parametric tests by computing the kernel mean embedding of desired interaction measures.

In this section, we extend interaction measures for random variables to the \(d\)-variate case, and formulate a family of interaction tests including the Streitberg interaction, the Lancaster interaction, joint independence and a generalised interaction.

For proofs of the propositions, please see Appendix A.

### Lancaster Interaction

Let us first consider the Lancaster interaction. Although it does not necessarily vanish when \(d 4\) for all types of factorisations due to the lack of certain partitions, here we find the necessary conditions for the Lancaster interaction to vanish.

**Proposition 1**.: _If the joint distribution \(_{1 d}\) can be factorised into \(_{_{v}}\) where \(_{v}\) are partitions with at least one singleton, then \(_{L}^{d}=0\)._

_Remark:_ Note that \(_{_{v}}\) is a broader set of partitions compared to the set of partitions in the Lancaster lattice, e.g., for \(d=5\), \(_{12}_{34}_{5}\) satisfies Proposition 1, yet it is not a constituent of the Lancaster lattice, which only consists of partitions with at most one non-singleton.

We now define the Mixed Central Moment Operator as the kernel embedding of the Lancaster interaction, which follows immediately from the expansion of (2) :

**Definition 1** (Mixed Central Moment Operator).: \[_{d}=(-1)^{n-1}(n-1)\,[_{i=1}^{d}^{i}]+ _{_{}}(-1)^{|_{}|-1}\,[_{s} ^{s}]_{j}[^{j}],\] (5)

_where \(_{}\) are the set of partitions with at most one non-singleton (i.e., those that belong to the Lancaster lattice), \(s\) are the singletons, and \(j\) runs over variables in the non-singleton block._

**Proposition 2**.: _By rearranging, the Mixed Central Moment Operator can be simplified to:_

\[_{d}=\{_{i=1}^{d}[^{i}-[ ^{i}]]\}.\] (6)

_Remark:_ This simplification transparently re-expresses the operator as a central moment, instead of the complex sum of moments in (5). The simplification eliminates all partitions except \(\).

We now define the entries in matrix \(K^{i}_{ab}=k^{i}(x^{i}_{a},x^{i}_{b})\) for \(iid\) samples \(x^{i}_{a}\) and \(x^{i}_{b}\) where \(1 a,b n\) and \(^{i}=HK^{i}H\) where \(H=I-11^{}\) is the centring matrix. The norm of the embedding above can serve as a test statistic. The estimator of the test statistic is derived as the V-statistic:

**Proposition 3** (Lancaster interaction estimator.).: \[||}_{d}||^{2}_{}=}_{a=1}^{n} _{b=1}^{n}_{i=1}^{d}^{i}_{ab},\] (7)

### Streitberg Interaction

Similarly we define the Mixed Cumulant operator in terms of kernel embeddings from the Streitberg interaction as:

**Definition 2** (Mixed Cumulant operator).: \[_{d}=_{(D)}(||-1)!(-1)^{||-1}_{b} \{_{i b}^{i}\},\] (8)

_where \(i\) is an element in block \(b\) of partition \(\) in partition lattice \((D)\)._

This operator can be simplified in a similar way:

**Proposition 4**.: \[_{d}=_{_{s}(D)}(|_{s}|-1)!(-1)^{|_{s}|-1}_{ b_{s}}\{_{i b}[^{i}-[^{i}] ]\},\] (9)

_where \(_{s}\) are the partitions with no singletons in partition lattice \((D)\)._

_Remark:_ Note that partitions with singletons are eliminated after centring, and the remaining partitions without singletons form an upper semi-lattice. The relationship between the Mixed Cumulant operator and the Mixed Central Moment operator is given by:

**Lemma 1**.: _The Mixed Cumulant operator is equal to the sum of Mixed Central Moment Operator products associated with partitions with no singletons denoted as \(_{s}\):_

\[_{d}=_{_{s}(D)}(|_{s}|-1)!(-1)^{|_{s}|-1}_ {b_{s}}_{b}.\] (10)

_Remark:_ When \(d=2,3\), \(_{d}\) and \(_{d}\) are identical, which further confirms the moment-cumulant relationship.

_Remark:_ From the partition lattice, \(\{,\}_{}\), where \(_{}\) is the set of partitions in the Lancaster lattice, and \(\) is the full set in the Streitberg interaction. When \(d=2\), we have \(\{,\}=_{}=\), and when \(d=3\), we have \(\{,\}_{}=\).

The estimation using a V-statistic for the norm of the Streitberg interaction is given by:

**Proposition 5** (Streitberg interaction estimator).: \[||}_{d}||^{2}_{}=_{_{s},^{}_{s} (D)}(|_{s}|-1)!(|^{}_{s}|-1)!(-1)^{|_{s}|+|^{}_{s}|} |+|^{}_{s}|}}_{\{b_{i}\}}_{\{b^{}_{i }\}}_{i=1}^{d}^{i}_{b_{i},b^{}_{i}},\] (11)

_where \(1 b_{i},b^{}_{i} n\) and \(|\{b_{i}\}|=|_{s}|\), \(|\{b^{}_{i}\}|=|^{}_{s}|\). i.e. indices \(b_{i}=b_{j}\) if \(i,j\) are in the same block in \(_{s}\) similarly for \(b^{}_{i}\). The sets of indices \(\{b_{i}\},\{b^{}_{i}\}\) are disjoint. An example for \(d=4\) is given in the SI._

Norms and the Product Lattice.The test statistics of the interaction measures, i.e., the norm of the interaction operators, can also be directly obtained from the Mobius inversion of the Cartesian product of the upper semilattice, thus avoiding the need to compute the square of the operator. The Cartesian product of two lattices with product ordering is also a lattice . The elements in the Cartesian product are analogous to the inner products of kernel embeddings in the estimators. Therefore, the coefficients can be computed directly from the product lattice, as shown in Appendix B.

### Description of the Statistical Tests

The Streitberg interaction test involves rejecting the null hypothesis that the joint distribution can be factorised in some way, which occurs when \(^{d}_{S} 0\). Similarly, for the Lancaster interaction test, we reject the null hypothesis that the joint distribution can be factorised into partitions with at least one singleton by checking \(^{d}_{L} 0\). Both null hypotheses consist of multiple sub-hypotheses, and an example for \(d=3\) is discussed in Ref. [34; 35]. Importantly, the number of sub-hypotheses to be tested is related to factorisations with only two blocks, i.e., those that form the second level from the top in the partition lattice (see Figure 1). In the case of rejecting some but not all the sub-hypotheses, please see Appendix C for the discussion.

To test each sub-hypothesis \(_{1 d}=_{b}_{b^{}}\), for efficiency we fix the observations of the variables in the largest block, and permute the observations of the remaining variables in the other block to induce the independence structure in the null distribution. We then use the Monte-Carlo approximation to compute the p-value , and apply a simple correction generalised to \(d\) variables to correct for multiple hypothesis testing. Finally, we reject the composite null hypothesis if all corresponding sub-hypotheses are rejected. To achieve this, we employ the permutation test outlined in Algorithm 1.

``` test-statistic \(\)\(||}^{d}||^{2}_{(^{1}_{1},,^{d})}\) for\(i\{\}\) (here \(=b|b^{}\)) do  initialize empty \(P\)-dimensional vector \(\) for\(p=1:P\)do for\(j=1:d\)do if\(j*{argmin}_{x\{b,b^{}\}}(|x|)\)then \(^{j}^{j}_{(s)}\) {kernel matrices after random permutations on the observations of \(X^{j}\)} \(T[p]||}^{d}||^{2}_{(^{1},,^{ d})}\) tmp \(\#\{p\{1,,P\}|[p]\}\) \((+1)/(P+1)\){Monte-Carlo approximation } if\(>\)then  reject \( 0\) {'simple correction' } break  reject \( 1\) return reject ```

**Algorithm 1** Permutation test for the interaction measures

By rejecting the null hypothesis of the Streitberg interaction test, it follows that we reject the null hypothesis of the Lancaster interaction test, as well as the null hypothesis of joint independence. The set of sub-hypotheses in joint independence is a subset of the set in the Lancaster interaction test, which is in turn a subset of the set in the Streitberg interaction test. The number of sub-hypotheses for an interaction measure is equal to the number of elements on the second level of the respective lattice.

For Streitberg interaction, this number is \((2^{d-1}-1)\) as follows from the full partition lattice; for Lancaster interaction, this number is \(d\) due to the reduced Lancaster lattice; for joint independence the number of sub-hypotheses stays fixed as the corresponding 2-element lattice always contains precisely one element, i.e., \(\) corresponding to \(_{1}_{d}\).

_Remark:_ Although our focus is on composite interaction tests to unveil high-order interactions by leveraging the vanishing of Streitberg and/or Lancaster interactions, these measures are also valuable to test other lower-order independence hypotheses wherein factorisations can also lead to vanishing interaction measures. For example, both Lancaster and Streitberg statistics can be implemented to test for joint independence (as shown in Section 6), and for marginal independence.

### Generalised Interaction Measure

The measures described so far are only able to handle interactions within one group of variables. But what if we are interested in knowing whether a factorisation (e.g., \(_{12}_{34}\)) factorises further? To answer this, we can simply formulate an interaction measure based on a partition . Because an interval of a lattice \(\) is a subset of the form \([,]=\{x x\}\) and is also a lattice , the interval lattice can be used to produce generalised interactions for multiple groups of variables:

**Definition 3** (General interaction operator).: \[_{S}^{_{*}}=_{_{s}}m(,_{s}) _{}=_{b_{s}}_{S}^{b},\] (12)

_where \(_{s}\) are the partitions with no singletons, \(m\) are the Mobius coefficients, and \(b\) are the blocks in the partition \(_{s}\)._

Here, we only consider blocks of size at least 2, since a factorisation cannot not be defined for singletons. It is then clear that \(_{S}^{_{*}}=0\) if any \(_{S}^{b}\) is zero, and the rejection statement on each group will be dependent on their own vanishing conditions. This provides a general framework to detect interactions within blocks of variables. The corresponding kernel-based tests can be constructed by estimating the norm of \(_{S}^{_{*}}\). In fact, the generalised Streitberg interaction measure can be expressed in terms of ordinary Streitberg interaction measures defined in Section 4.2:

\[_{S}^{_{*}}=_{_{s}=1}_{b} _{S}^{b}.\] (13)

## 5 Computational Considerations

The time complexity of computing the Lancaster interaction estimator is \((dn^{2})\), where \(d\) is the order of interaction and \(n\) is the number of samples. This follows immediately after centring the kernel matrices, since \(\) is the only partition with no singletons. In contrast, the Streitberg interaction has a larger number of partitions, given by the Bell number, \(B_{d}\). However, by simplifying the computation through centring, we can reduce this to the number of partitions with no singletons, given by \(F_{d}\). While this number is still combinatorial, it is significantly smaller compared to \(B_{d}\) (see Table 1 in Appendix G).

The resulting estimator of the Streitberg interaction criterion then consists of \(F_{d}\) inner products. The summation indices of the inner products come from both partitions and are at most \(d\) (when \(d\) is even) or \(d-1\) (when \(d\) is odd). Whilst the summations can be contracted, the choice of contraction ordering plays a crucial role in the time complexity [47; 48; 49]. By computing the summations related to one partition in parallel, since the index sets from \(_{s}\) and \(_{s}^{}\) are disjoint, the overall complexity can be reduced to \((n^{min(|_{s}|,|_{s}^{}|)+1)}\) (see Table 2 in Appendix S). For example, the inner product between the kernel embeddings for \(_{1234}\) and \(_{12}_{34}\) is \(}_{j}_{k}K_{ij}^{1}K_{ij}^{2}K_{ik}^{3}K_{ik}^{4}\), but an improved contraction ordering is \(}_{i}[_{j}K_{ij}^{1}K_{ij}^{2}][_{k}K_{ik}^{3}K_{ik} ^{4}]\).

The time complexity of the Streitberg interaction estimator can be further reduced in a recursive setting. Specifically, if \(_{s}_{s}^{}\), then the associative inner product can be expressed as a product of independent sums that can be found in lower order interactions. For example, \(_{_{12}_{34}},_{_{12}_{34}}\) can be decomposed as \(_{_{12}},_{_{12}}\)\(_{_{34}},_{_{34}}\) which would have already been computed for the pairwise interactions of \(\{X^{1},X^{2}\}\) and \(\{X^{3},X^{4}\}\). This means that if one has already computedthe inner products of \(d-2\) variables (incremental by 2 since the smallest block is at least size 2), then the only remaining inner products to compute are between those embeddings associated with partitions \(_{s}\) and \(^{}_{s}\) such that \(_{s}^{}_{s}=\). In other words, the computation of inner products for high-order interactions can be reduced to the computation of lower order interactions, as long as the corresponding partitions can be joined to form a partition of all \(d\) variables. For further discussions on computational complexity, see Appendix G.

## 6 Experiments

We first validate our family of \(d\)-order interaction tests (in particular, \(d=5\)) on synthetic datasets with ground truth interactions, and then investigate their application to a neuroimaging dataset. Unless stated otherwise, the significance level is set to \(\) = 0.05, sample size to \(n=80\), and we use Gaussian kernels with the median heuristic as the bandwidth.

Synthetic Experiments: Multivariate Gaussians.We first compare results from applying the dHSIC test (developed solely to detect joint independence) , and the Lancaster and Streitberg interaction tests to five-variable multivariate Gaussian distributions \((,)\) with mean \(\) and covariance \(\). For the first example, \(=\) and \(_{1}=[,[0,1,,,],[0,,1,,],[0, ,,1,],[0,,,,1]]\) where \(0 1\) defines the interaction strength between variables and consequently \(_{12345}=_{1}_{2345}\). For the second example, we have the same \(\) and \(_{2}=[[1,,0,0,0],[,1,0,0,0],[0,0,1,,],[0,0,,1, ],[0,0,,,1]]\) and hence \(_{12345}=_{12}_{345}\).

Figure 2(a-b) shows that dHSIC fails to capture the partial factorisation of the joint distribution in both cases. Whilst the Lancaster interaction test is able to detect the factorisation in the first experiment (Figure 2(a)), it fails on the second experiment where the factorisation contains no singletons (Figure 2(b)). The Streitberg interaction test is the only one that detects both factorisations.

Synthetic Experiments: 5-Way XOR Gate.Next, we investigate the power of the tests using a data set constructed using an XOR gate. We generate \(n\) samples of \(V,W,X,Y,Z}{{}}(0,4)\), \(Z_{:i}=(V_{:i}+W_{:i}+X_{:i}+Y_{i}) 4\) and \(Z_{i+1:n}(0,4))\) (where the samples \([i+1:n]\) act as noise). We then gradually increase the interaction proportion, \(0 i/n 1\). By construction, this dataset does not contain pairwise, 3-way or 4-way interactions, and the 5-way interaction becomes increasingly easier to detect as \(i/n\) approaches 1.

Given that the joint distribution in this example cannot be factorised, all tests should reject joint independence. We show in Figure 2(c), that the rejection rates of joint independence for Streitberg and Lancaster approach one as the interaction level increases for a small number of samples (\(n=80\)), whereas dHSIC displays low power for the same number of samples. Only by increasing the number

Figure 2: **High-order tests on synthetic data.** (a) dHSIC is unable to detect the marginal \(_{1}_{2345}\) factorisation. (b) Only the Streitberg test is able to capture the factorisation without singletons \(_{12}_{345}\). (c) Testing joint independence of a 5-way XOR example, Lancaster and Streitberg tests achieve higher power than dHSIC for the same number of samples (\(n\)=80). Only by increasing the number of samples to \(n\)=1000 does dHSIC display comparable power. (d) The modified dHSIC test requires substantially more samples than the Streitberg test to display comparable power when testing all sub-hypotheses of the interaction in the XOR example.

of samples to \(n=1000\) do we observe comparable performance for dHSIC. To test for 5-way interactions in the XOR data set, we omit the Lancaster test which cannot detect factorisations into non-singletons. We thus compare the Streitberg interaction test with a modified dHSIC  that tests each individual sub-hypothesis (e.g., when testing \((X,Y)\!\!\!(Z,W)\) it is sufficient to treat \((X,Y)\) and \((Z,W)\) as single variables and perform joint independence tests for two variables). We find again that the modified dHSIC requires a much larger sample size to achieve comparable performance to that of the Streitberg interaction test (Fig. 2(d)).

To investigate how the test power degrades when the sample size is decreased, we performed further experiments in Fig 8 in Appendix F. In all cases, we find that the performance of dHSIC degrades faster than that of Lancaster and Streitberg, i.e., the dHSIC null rejection rate decays substantially faster than that of Lancaster and Streitberg as the sample size decreases.

Neuroimaging Dataset.As a proof of concept of applications to real data, we apply the Streitberg interaction test to detect high-order interactions in brain activity data. The dataset consists of resting-state fMRI data from 50 unrelated subjects part of the Human Connectome Project . For each subject, the data consists of 100 time series capturing the activity of each of the regions in the Schaefer brain atlas . Importantly, these 100 regions can be divided in 7 groups called 'Resting State Networks' (RSN) . Experimental evidence has shown that regions within the same RSN perform similar functions , so we hypothesised that high-order interactions would be more probable within RSNs.

To avoid dealing with issues of non-stationarity in the time-series data, we first take temporal averages to obtain the mean activity per region and subject (see Appendix H for preprocessing steps). We then perform the Streitberg interaction test to sets of brain regions that are either taken from within the same RSN or sampled at random from the whole brain. In each case, we sample 500 sets of regions or take all possible combinations, whichever is lowest.

The results in Figure 3 align with our general hypothesis: 2-, 3-, 4- and 5-way interactions are significantly more common among regions belonging to the same RSN as compared to random sets of regions, confirming that our interaction test can successfully detect high-order interactions in real-world data. Notably, our results show a larger percentage of 2-way interactions in the SOM and VIS compared to regions such as the FPN or DAN, suggesting that there is increased redundancy in the system relative to these other regions. The SOM and VIS are structurally coupled, modular sensorimotor processing regions, that benefit from information redundancy to increase robustness. Moreover, the proportion of high-order interactions (3-, 4- and 5-way) to 2-way interactions is larger in SOM and VIS compared to FPN or DAN, potentially reflecting the differing balance of redundancy and synergy in these brain regions . Additional analyses are shown in Appendix H, but the

Figure 3: **Concentration of high-order interactions in brain resting state networks.** The percentage of rejected null hypotheses for \(d\)-order (\(d=2,3,4,5\)) interaction tests, when the \(d\) regions are selected within each of seven brain resting state networks (RSNs) or drawn at random across the brain. For each order \(d\), we carry out Fisher-exact tests for over-representation for each RSN _vs._ random. All Fisher tests are significant (\(p\)-value\(<0.05\)) except where shown as (n.s.) Abbreviations for RSNs: DMN: default mode network, SOM: somatomotor, VIS: visual, SAL: salience, DAN: dorsal attention network, FPN: frontoparietal network, LIM: limbic.

neuroscience implications of these results, including observed variation across regions, will be the object of future work.

## 7 Discussion

In this work, we have established formal connections between lattice theory and a family of high-order interaction measures based on factorisations of the joint probability distribution. The link to lattice theory facilitates the derivation and interpretation of the measures; highlights the connection to simplicial complexes and other sublattices; and helps formulate the associated permutation tests more efficiently. We have shown empirically that the Lancaster test statistic is a good substitute for dHSIC to test for joint and marginal independence, whilst the Stretheberg test statistic is able to better capture all factorisations of the joint distribution. Our work offers a rigorous and systematic approach for the reconstruction of high-order systems, but has some limitations. The computation of the Streitberg interaction estimator can be expensive and although we have proposed strategies to bring down the time complexity, the number of terms remains combinatorial (see Appendix G for discussions on practical limitations). In addition, our theoretical results rely on \(iid\) data, a strong assumption in many real-world applications. This leaves several open directions. In particular, future work will investigate whether the null distribution of \(_{S}^{d}P\) can be jointly approximated without the need for sub-hypotheses, thus reducing computational cost; how it can be accurately approximated when the data has temporal dependence; and what role high-order interactions may play in causal discovery.