# Road Network Representation Learning with the

Third Law of Geography

Haicang Zhou\({}^{1}\) Weiming Huang\({}^{1}\) Yile Chen\({}^{1}\) Tiantian He\({}^{2,3}\) Gao Cong\({}^{1}\) Yew-Soon Ong\({}^{1,2,3}\)

\({}^{1}\) College of Computing and Data Science, Nanyang Technological University, Singapore

\({}^{2}\) Institute of High-Performance Computing, Agency for Science, Technology and Research, Singapore

\({}^{3}\) Centre for Frontier Al Research, Agency for Science, Technology and Research, Singapore

haicang001@e.ntu.edu.sg, weiming.huang@nateko.lu.se

he_tiantian@ihpc.a-star.edu.sg, {yile.chen, gaocong, ASYSOng}@ntu.edu.sg

###### Abstract

Road network representation learning aims to learn compressed and effective vectorized representations for road segments that are applicable to numerous tasks. In this paper, we identify the limitations of existing methods, particularly their overemphasis on the distance effect as outlined in the First Law of Geography. In response, we propose to endow road network representation with the principles of the recent Third Law of Geography. To this end, we propose a novel graph contrastive learning framework that employs geographic configuration-aware graph augmentation and spectral negative sampling, ensuring that road segments with similar geographic configurations yield similar representations, and vice versa, aligning with the principles stated in the Third Law. The framework further fuses the Third Law with the First Law through a dual contrastive learning objective to effectively balance the implications of both laws. We evaluate our framework on two real-world datasets across three downstream tasks. The results show that the integration of the Third Law significantly improves the performance of road segment representations in downstream tasks. Our code is available at [https://github.com/Haicang/Garner](https://github.com/Haicang/Garner).

## 1 Introduction

Road networks, which form a fundamental infrastructure within urban spaces, describe the geometries and connectivity among road segments in transportation systems. Correspondingly, road networks serve as indispensable components to support numerous smart city applications, such as traffic forecasting , route inference , and travel time estimation . Motivated by the advancements of graph representation learning , the versatile utility of road networks has spurred research into developing effective and expressive representation learning methods for road networks. The objective is to derive functional and easily integrable representations of road segments that can align with the paradigm of neural network models.

Road networks are inherently regarded as graphs, which allow existing methods for road network representation learning to build upon graph representation learning techniques. In particular, apart from encoding the topological information of road networks, these methods further integrate additional spatial characteristics, such as geographical distance , which are unique to road networks. In these methods, the inductive bias induced by spatial characteristics is primarily based on the First Law of Geography , which states that _"everything is related to everything else, but near things are more related than distant things."_ This principle implies that spatially close road segments tend to have similar representations. For example, skip-gram based methods  define the context window based on hops among graph neighbors or spatial distance and derive road segmentrepresentations similar to word2vec . Besides, graph neural networks  based methods  employ message passing  and aggregation among road segments. Both types of methods result in similar representations for connected or proximal road segments .

While generally true and applicable, the First Law of Geography does not adequately capture the complexity of urban environments , particularly in terms of long-range relationships. Consequently, this limitation compromises the effectiveness of road segment representations in existing methods. This law predominantly emphasizes the distance decay effect, neglecting the influence of semantic factors of different areas on target variables . To mitigate the limitation, the Third Law of Geography  was proposed to further consider geographic configurations, stating that "_The more similar geographic configurations of two points (areas), the more similar the values (processes) of the target variable at these two points (areas)._" The term _geographic configuration_ refers to the description of spatial neighborhood (or context) around a point (area), and the term _target variable_ is the road representation in our context. As a result, two road segments with similar geographic configurations should have similar representations, even if they are disconnected and distant.

Recognizing the potential advantages of integrating the Third Law of Geography, we initiate pioneering research that combines the principles of both the First Law and the Third Law in road network representation learning for the first time. To facilitate this integration, it is essential to leverage data sources that provide comprehensive insights into geographic configurations for road segments. Existing approaches commonly utilize data from OpenStreetMap , which includes relatively basic features such as coarse-grained road attributes (location, length, type, etc.). While these data support the condition required in the First Law of Geography and are subsequently processed through specialized model designs, they are insufficient to address the application of the Third Law. To enhance the understanding of geographic configurations, we propose to utilize street view images (SVIs)  as an additional data source. Street view images capture the visual context of roads and their surroundings, offering a more nuanced representation of geographic configurations. However, it is still non-trivial to tackle these two principles simultaneously.

First, it is important to effectively enable the integration of the Third Law of Geography within the context of road networks. This law posits that similar representations are expected to be derived for road segments with similar geographic configurations. To this end, the module should capture and reflect the similarity relationships among geographic configurations in the resulting road segment representations, ensuring that road representations faithfully preserve the similarity relationships. Second, it is critical to harmonize the implications of applying both the First and Third Law of Geography in road network representation learning. The First Law emphasizes the importance of spatial proximity, while the Third Law focuses on the significance of similarity in geographic configurations, irrespective of spatial proximity. In real-world scenarios, two distant road segments might exhibit very similar geographic configurations due to similar surrounding buildings and environments. Conversely, two directly connected and proximally close road segments might present vastly different geographic configurations - for example, one adjacent to a commercial area and the other near a park. Given these two conditions, a framework is required to synthesize road segment representations that align with both principles while mitigating potential discrepancies as highlighted.

To resolve these challenges, we propose a new framework, namely **G**eographic **L**aw aware **r**oad **n**etwork **r**epresentation learning (Garner). First, to effectively enable the integration of the Third Law, we devise a graph contrastive learning framework  tailored for road networks. This enhances conventional contrastive learning by incorporating geographic configuration-aware graph augmentation and spectral negative sampling. Specifically, we utilize SVIs to construct a geographic configuration view for road networks, which facilitates the augmentation of edge connections between road segments sharing similar geographic configurations, even if they are geospatially distant. Then, we employ a Simple Graph Convolution (SGC)  encoder, which has the property of implicitly reducing the differences between the representations of connected road segments , thereby mapping the similarity relationships between geographic configurations to road segment representations in the contrastive learning process. To further align with the Third Law, the proposed contrastive learning framework is equipped with a novel spectral negative sampling technique. This sampling strategy can be mathematically demonstrated to support the principle of the Third Law in a reverse way, ensuring that road segments with dissimilar geographic configurations are represented distinctly. Second, to harmonize the effects of both the First Law and Third Law, we propose a dual contrastive learning objective, which contrasts the topological structure view with the geographic configuration graph view and the spatial proximity graph view. We maintain shared parameters in the SGC encoderand jointly train the contrastive losses, thus simultaneously learning the consensus and discrepancies of these two laws in a self-supervised manner by minimizing the dual contrastive objective.

Our contributions can be summarized as follows.

* We identify the limitations of existing methods in road network representation learning, and propose the integration of the Third Law of Geography to overcome the shortcomings. To the best of our knowledge, this is the pioneering attempt to integrate the Third Law of Geography in this area.
* We develop a novel graph contrastive learning framework to model the Third Law through geographic configuration-aware graph augmentation and spectral negative sampling. Besides, we balance the influences of two geographic laws via a dual contrastive learning objective.
* We conduct extensive experiments on two real-world road network datasets (i.e., Singapore and New York City), and evaluate our model on three downstream tasks. The experiments demonstrate that the integration of the Third Law significantly enhances the performance of road network representation learning.

## 2 Related work

**Road network representation learning** These works aim to learn representations for road segments or intersections, for various downstream tasks [4; 8; 14; 20]. Recent studies model a road network as a graph and build their method upon graph representation techniques by including geospatial information, and can be classified into two groups. Some [3; 23; 39; 40] adopt random walks to generate paths and train a skip-gram model , incorporating geospatial information based on distance  or spatial constraints. Others [2; 15; 44; 48] use graph neural networks [17; 36] to ensure proximal or connected roads have similar representations. Some also include traffic data (e.g., GPS trajectories of vehicles [3; 32]) to enhance the representation. The theoretical support behind these methods is the First Law of Geography . However, this principle has overemphasized spatial proximity and thus  proposes the Third Law of Geography, which argues that geographic configurations play critical roles in geospatial data analytics. This paper pioneers research on modeling the geographic configurations and the Third Law for road network representation learning.

**Unsupervised graph representation learning** Graph representation learning aims to learn representations for graph components like nodes, edges, or entire graphs, where unsupervised node representation learning is most relevant to ours. Despite [12; 13] on masked auto-encoding , the majority relies on contrastive learning  or its variants, which usually comprises several components: graph augmentation, contrastive strategy, negative sampling, and a loss function (e.g., mutual information (MI) estimator). Graph augmentation [21; 45] is to generate positive  or negative  samples, though some recent studies try to remove it [26; 49]. Contrastive strategy chooses which two components to contrast, such as node-node contrast [30; 56] or node-graph contrast [9; 21]. Negative sampling is required by the loss. The loss is usually to maximize the MI [9; 37; 50] between an entity with its positive samples and minimize the MI with its negative samples. Several recent studies have also tried to develop new objectives for graphs [26; 47]. Unlike existing studies our method further encodes geographic laws and more data sources to feed the contrastive loss.

## 3 Preliminaries and problem definition

**Definition 1** (Graph).: A graph is denoted as \(=(,,)\), where \(\) and \(\) denote the set of nodes and edges respectively. Let \(n=||\) denote the number of nodes and \(m=||\) denote the number of edges. \(^{n f^{}}\) is the feature matrix, with each row \(_{i}\) representing the features on node \(i\). Let \(^{n n}\) denote the adjacency matrix of \(\), describing the connections in \(\). If node \(i\) and node \(j\) are disconnected, then \(_{i,j}=0\); otherwise \(_{i,j} 0\). By adding self-loops, we define \(}=+\).

**Definition 2** (Graph Laplacian matrix).: The Laplacian matrix of a graph \(\) is defined as \(:=-\), where \(\) is the diagonal degree matrix with \(_{i,i}\) as the degree of node \(i\) and \(_{i,j}=0 i j\).

**Definition 3** (Road Network).: Road networks are composed of road segments and intersections (junctions) of road segments. We use the term "road" to denote road segment in later sections for brevity. Road networks can be regarded as a graph, which is denoted as \(=(,,,})\). Each road segment is modeled as a node, and connected roads are linked by edges. \(_{i}\) represents the feature vector of road \(i\). Besides, road networks contain \(}\), which stores the geospatial locations of nodes.

**Problem Definition** (Road network representation learning).: Given road networks \(=(,,,,})\), where \(\) denotes the geographic configurations, our objective is to learn a function \((,,,})^{n  f}\), where the \(i\)-th row \(_{i}\) of \(\) denotes the representation of road \(i\).

We defer the definitions and discussions of geographic laws in Appendix A.1.

## 4 Method

In this section, we present the details of Garner, which enables the integration of the Third Law of geography for learning road representations: roads with similar geographic configurations should exhibit similar representations, and vice versa. The proposed Garner is built on the recent advances in contrastive learning and spectral graph theory. Fig. 1 illustrates the framework of Garner, which consists of the following components: (1) Data preprocessing: it produces initial road features that encode the geographic configuration. (2) Graph augmentation: it generates a graph adhering to the Third Law of Geography, where roads with similar geographic configurations are connected. (3) GNN encoder: it serves as the backbone for deriving road representations from both the original graph (the topology of the road network) and the augmented graphs. (4) Graph contrastive loss: enhanced with a spectral negative sampling strategy, it effectively integrates the Third Law (the upper part in Fig. 1). (5) Dual contrastive learning objective: it aims to harmonize the effect of the First Law with the Third Law (lower part in Fig. 1).

Garner is inspired by recent studies on contrastive learning [1; 22] showing that by maximizing the mutual information (MI) between different views, the information from these views can be fused properly, and by contrasting different views of the graph the quality of the representation can be improved . By applying a contrastive loss on the augmented and original graph, Garner can effectively learn the road representation according to both the third law and the original road network, and fuse their information properly. The cross-contrast strategy also allows Garner to fuse the Third Law and the First Law with a proxy, instead of directly contrasting the laws. This allows \(^{}\) to learn their consensus, while \(^{}\) and \(^{}\) can learn the discrepancies of the two laws.

### Representation of geographic configuration and data preprocessing

As mentioned in Section 1, we utilize street view images (SVIs) as proxies to represent geographic configurations for road segments. Specifically, each street view image is encoded into a vectorized representation with a pre-trained image encoder (e.g., CLIP ). Then, we match these SVIs to roads according to their geospatial locations. As multiple SVIs can correspond to a single road in our datasets, we aggregate the representation of these matched SVIs with average pooling in such cases. After that, the geographic configuration (GC) for road segments can be described as matrix \(^{n c}\). We note that a small portion of roads do not align with any SVIs. For these roads, we set their GC to be the average representation of other roads. Moreover, road segments may possess other

Figure 1: Architecture of Geographic law aware road network representation learning (Garner).

basic attributes available from OpenStreetMap, such as the road type and length. We follow previous literature [2; 3] to encode the features into a matrix \(\). Finally, the GC and additional road features are projected and concatenated to form \(^{(0)}=([_{c},_{x}])\), which serves as input to our proposed framework.

### Geographic configuration aware graph augmentation

We propose a graph augmentation technique according to the similarity of the geographic configuration. We first define a similarity measure for geographic configuration as \((_{i},_{j})\). Here, we use norm-based measure \((_{i},_{j})=1/(1+\|_{i}-_{j}\|)\), while cosine similarity and Gaussian kernel could also be possible choices. Then, we build an augmented similarity graph based on the similarity \((_{i},_{j})\). In a similarity graph, similar node pairs (i.e., node pairs with large similarity scores) will be connected by edges. Popular choices for building the similarity graph include kNN graphs and threshold graphs . We empirically find that the two choices produce very close results, and we therefore choose kNN graph because of their high efficiency. In a kNN graph, each node is connected with k nodes, which have the highest similarity with it, and k is a small number, so the kNN graph is very sparse. We name this process as geographic configuration aware graph augmentation and use matrix \(\{0,1\}^{n n}\) to denote the adjacency matrix of the augmented similarity graph \(^{}\).

### Graph encoder

To facilitate the integration of the Third Law, we employ Simple Graph Convolution (SGC)  as the backbone of our graph encoder to tackle the augmented similarity graph, described as follows:

\[=g_{_{1}}(,^{(0)})=}^{K}^{(0)}, \]

where \(}=}_{}}^{-1/2}} }_{}^{-1/2}\), \(}_{}\) is the degree matrix of \(}:=+\), \(\) is the learnable parameter, and \(^{n f}\) is the output representation. As discussed in [43; 56], the simple graph convolutional operation acts as a low pass filter, making the representation \(\) of connected nodes similar. Specifically, according to , the SGC encoder in equation 1 is designed to minimize \((^{T}_{})\), which is equivalent to the following equation:

\[(^{T}_{})=_{i,j}_{i,j} \|_{i}-_{j}\|^{2}. \]

The details of the calculation can be found in Appendix B.1. In this equation, \(_{i,j}\) is non-zero if and only if node \(i\) and \(j\) are connected in the augmented graph \(^{}\). Therefore, by minimizing \((^{T}_{})\), the difference between \(_{i}\) and \(_{j}\) is reduced for every connected node pair, thus aligning with the objective of the Third Law, where the representations of nodes (i.e., road segments) with similar geographic configuration are minimized. In addition, another SGC encoder with different learnable parameters is used to encode the nodes in the original graph \(^{}\), which represents the topological structure of road networks. As a result, we obtain two outputs, \(^{}\) from the original graph \(^{}\), and \(^{}\) from the augmented graph \(^{}\). Given the large number of road segments in a city, we adopt a sub-sampling technique to enhance the efficiency and scalability. In particular, in each iteration in training, we maintain the same set of nodes for each graph view, and only edges connecting sampled nodes are retained. The subgraphs are then processed through the graph encoders.

### Contrastive loss

Previous studies show that information from different views can be fused properly by maximizing their mutual information (MI) , which can also improve the quality of representations . Inspired by these, we maximize the MI between the original graph \(^{}\) and the augmented graph \(^{}\),

\[_{1}=-|}_{i=1}^{||}\{ (_{i}^{},_{g}^{})+(_{i}^{}, {Z}_{g}^{})\}. \]

Here \(||\) denotes the number of nodes in the graph. \(_{g}^{}^{f}\) is the representation of the whole graph by applying a graph pooling operation on \(^{}\). In our implementation, we choose the mean pooling. The MI estimator \((,)\) is a widely used one based on Jensen-Shannon divergence .

\[(_{i}^{},_{g}^{}) =_{(^{},^{})}[ (_{i}^{},_{g}^{})]+_{( ^{},^{})}[(1-(}_{i}^{},_{g}^{}))], \] \[(_{i}^{},_{g}^{}) =_{(^{},^{})}[ (_{i}^{},_{g}^{})]+_{( ^{},^{})}[(1-(}_{i}^{},_{g}^{}))]. \]

where the discriminator \(\) is achieved by a bilinear layer (i.e., \((,)=^{T}\) ) . \(^{}\) and \(^{}\) are negative samples required by the mutual information estimator. Specifically, \(^{}\) is the negative sample generated by shuffling the rows of inputs \(^{(0)}\), following , and then \(}^{}\) is produced through the graph encoder \(g_{_{0}}\). We then explain how to generate \(^{}\).

### Spectral negative sampling

In graph contrastive learning, negative sampling is usually implemented by graph corruption such as feature shuffling  and edge modification . In the road network context, we extend beyond these conventional methods by introducing a novel spectral negative sampling technique to integrate the Third Law of Geography. To be specific, the Third Law not only posits that "roads with similar geographic configurations should have similar representations," but also implies that "roads with dissimilar geographic configurations should have dissimilar representations." Our proposed strategy elegantly refines the objective in Equation 2 in the contrastive learning process, thereby implicitly addressing the reverse implication of the Third Law. 1

To achieve this, we recall that equation 2 relates closely to the objective of the sparsest cut problem (Chapter 10 of  and ), which seeks to find cuts that minimize the number of edges between subsets of nodes. Correspondingly, nodes are densely connected within each subset, while between different subsets, nodes are sparsely connected.

\[usc_{}:=_{S}(S,-S)}{|S|| -S|}, \]

where the numerator denotes the number of edges across node sets \(S\) and \(-S\), and the denominator is the multiplication of number of nodes in the two sets. \(usc_{}\) can be computed as

\[usc_{}=_{\{0,1\}^{n}-\{,\}}}(_{i}-_{j})^{2}}{_{(i,j)}(_{i}-_ {j})^{2}}=_{\{0,1\}^{n}-\{,\}}^{T} _{}}{^{T}_{}}, \]

where \(_{i}\) is the \(i\)-th element of vector \(\), and \(\) is a complete graph, which has the same nodes as \(\). Following , we apply a continuous relaxation in this formula and extend it to the matrix form:

\[_{^{n f}}(^{T} _{})}{(^{T}_{})}, \]

where \(_{}\) is the graph Laplacian matrix by regarding \(\) as the adjacency matrix, and \(_{}\) is the graph Laplacian matrix of the complete graph \(\). Minimizing equation 8 is equivalent to minimizing the numerator and meanwhile maximizing the denominator, with the same \(\). Recall that the SGC encoder (equation 1) has the effect of minimizing the numerator \((^{T}_{})\). Subsequently, we design the _negative_ sample based on \(\) and \(\). The negative sample can achieve that by discriminating positive samples from negatives, the model has the effect of maximizing the denominator \((^{T}_{})\). This can be achieved by another SGC with the same parameter as in equation 1:

\[}=g_{_{1}}(}_{},^{(0)})=}_{}^{K^{}}=}_{}^{K^{}} }^{K}^{(0)}=}_{}^{(0)} , \]

where \(_{}\) is the adjacency matrix of \(\), \(}_{}=_{}^{-0.5}_{}_{}^{-0.5}=_{}/n\). \(}=g_{_{1}}(}_{},^{(0)})\) achieves minimizing the denominator. (See the details of the computation in Appendix B.2.) Finally, regarding \(\) (with \(}\) as its output) as the negative sample and discriminating positive samples from it in the MI estimator (equation 4 & 5) achieve maximizing the denominator \((^{T}_{})\) in equation 8.

However, performing SGC on the complete graph \(\) entails a time and space complexity of \(O(n^{2})\), which is computationally infeasible for large graphs. To tackle this, we further conduct an efficient approximation for the complete graph \(\) according to spectral graph sparsification .

\[(1-}{d})(^{T}_{}})(^{T}_{}) (1+}{d})(^{T}_{}}), \]where \(}\) is a d-regular graph (i.e., each node has d edges connected to it) with "all of whose non-zero Laplacian eigenvalues lie between \(d-2\) and \(d+2\)" and each edge weight as \(n/d\). 2 Consequently, we can optimize \((^{T}_{})\) by optimizing \((^{T}_{}})\). Then we simply replace \(}_{}\) in the right hand side of equation 9 with \(}_{}}\) and get the outputs of the negative sample as

\[}=}_{}}^{(0)}, \]

which works well in our experiments.

To summarize, we generate the negative sample \(}^{}\) as a d-regular graph \(}\) with the same node set \(\), with the same node feature as \(^{}\). Then we perform SGC on the negative sample, and finally use the output representation \(}\) to compute mutual information in 5. The negative sampling strategy is inspired by the sparest cut and can maximize \((^{T}_{})=0.5_{i=1}^{n} _{j=1}^{n}\|_{i}-}_{j}\|^{2}\), where the majority node pairs \((i,j)\) have dissimilar geographic configuration, because of the sparsity of the positive sample \(^{}\). Therefore, we can achieve the reverse implication of the Third Law - roads with dissimilar geographic configuration have dissimilar representations.

### Fusing the Third Law and the First Law

While the integration of the Third Law has been effectively achieved through our module designs, the First Law remains beneficial, especially in regions that manifest identical functionality, thus encouraging representations of nearby roads within the regions to be similar. Therefore, it is important to further incorporate the inductive bias introduced by this law into the contrastive learning process. To achieve this, we adopt another graph augmentation technique based on graph diffusion , which generates another graph view \(^{}\) with the following adjacency matrix:

\[=(-(1-)}^{-1/2}}^{-1/2})^{ -1}, \]

which can be fast approximated by . Then the SGC encoder \(g_{_{2}}\) is employed to produce the output \(^{}\) from \(^{}\). The graph diffusion process connects near roads, and the SGC encoder can pull the near roads to have similar representation due to the property of SGC (as in section 4.3). Then we use the same loss for \(^{}\) and the augmented graph \(^{}\).

\[_{2}=-|}_{i=1}^{||}\{ (_{i}^{},_{g}^{})+( _{i}^{},_{g}^{})\} \]

By introducing this component, our Garner is endowed with a dual contrastive objective that maximizes the mutual information between the topological structure with the geographic configuration view, as well as the spatial proximity view, in alignment with the principles of these two laws. Then we train the model (Fig. 1) by combining \(_{1}\) and \(_{2}\):

\[=_{1}+_{2}. \]

We find that the model adeptly learns to balance these considerations through parameter sharing in the SGC encoder (\(g_{_{0}}\)), performing well without the need for manual tuning the weights of the two loss functions. Therefore, we do not introduce additional hyper-parameters to adjust their weights. During inference, we aggregate the outputs from the three graph encoders as the road segment representations for downstream tasks: \(=(^{}+^{}+^{})/3\).

## 5 Experiments

In this section, we evaluate the proposed method and the output road representation following previous literature . The road representation is evaluated on three downstream tasks. We also perform a case study to show the impact of the Third Law, and ablation studies and hyper-parameter sensitivity tests to analyze the proposed method.
DatasetsWe use data from two cities, i.e. _Singapore_ and _New York City_ (_NYC_). The datasets include road networks from OpenStreetMap (OSM, ) and street view images (SVIs) from Google Map (). The statistics can be found in Table 1.

Downstream tasksThe road representation is evaluated on three downstream tasks: _road function prediction_, _road traffic inference_, and _visual road retrieval_. Road function prediction is a classification task to determine the functionality of a road. Road traffic inference is a regression task predicting the average speed of vehicles on each road. Visual road retrieval involves finding the roads where the road image should be located. While road traffic inference is widely used in previous literature [2; 3; 23], we introduce road function prediction and visual road retrieval as two new but meaningful evaluation tasks for road representations. More details for downstream tasks can be found in Appendix C.1.

Evaluation metricsFor road function prediction, we use Micro-F1, Macro-F1, and AUROC (the area under the ROC curve) as the evaluation metrics. For road traffic inference, we use MAE (mean absolute error), RMSE (root mean square error), and MAPE (mean absolute percentage error) as the evaluation metrics. For visual road retrieval, we use recall@10 and MRR (mean reciprocal rank).

BaselinesThe proposed Garner is compared with seven strong baselines, including Deepwalk , MVGRL , CCA-SSG , GGD , RFN , SRN2Vec  and SARN . Some other recent methods [3; 23; 32; 44] include other data types (e.g., GPS trajectory data of vehicles) as inputs. However, GPS trajectory data are only available in very few cities, and we did not find them for one of our datasets (NYC). Thus, we cannot run these methods for comparison in our experiments. More details of the baselines can be found in Appendix C.2.

Hyper-parameter settingsWe use the same hyper-parameters on all the datasets. The road features, and image embeddings are projected into 256 dimensions. The \(k=6\) in kNN graph for geographic configuration aware graph augmentation, and \(d=22\) for spectral negative sampling. The hyper-parameters for graph diffusion is \(=0.2\), as suggested by . The hidden dimension and the dimension of the representation are set as 512. Other detailed settings can be found in Appendix C.3.

### Experimental results

   City & \# Roads & \# Edges & \# SVIs \\  Singapore & 45,243 & 138,843 & 136,399 \\ NYC & 139,320 & 524,565 & 254,239 \\   

Table 1: Dataset Statistics

    &  &  \\  & Micro-F1 (\%) \(\) & Macro-F1 (\%) \(\) & AUROC (\%) \(\) & Micro-F1 (\%) \(\) & Macro-F1 (\%) \(\) & AUROC (\%) \(\) \\  Deepwalk & 62.76 \(\) 0.49 & 13.30 \(\) 0.10 & 63.23 \(\) 0.47 & 78.09 \(\) 0.18 & 14.62 \(\) 0.02 & 58.49 \(\) 0.33 \\ MVGRL & 66.61 \(\) 0.50 & 30.67 \(\) 0.66 & 74.34 \(\) 0.46 & 78.23 \(\) 0.23 & 17.39 \(\) 0.23 & 69.96 \(\) 0.35 \\ CCA-SSG & 64.28 \(\) 0.37 & 22.55 \(\) 0.49 & 70.26 \(\) 0.37 & 78.20 \(\) 0.24 & 15.97 \(\) 0.15 & 68.15 \(\) 0.24 \\ GGD & 64.21 \(\) 0.39 & 20.58 \(\) 0.40 & 68.97 \(\) 0.40 & 78.14 \(\) 0.25 & 15.75 \(\) 0.16 & 66.11 \(\) 0.33 \\ RFN & 62.75 \(\) 0.44 & 12.85 \(\) 0.06 & 54.64 \(\) 0.44 & oom & oom & oom \\ SRN2Vec & 64.02 \(\) 0.45 & 22.47 \(\) 0.37 & 71.18 \(\) 0.40 & oom & oom & oom \\ SARN & 66.49 \(\) 0.47 & 22.59 \(\) 0.51 & 72.74 \(\) 0.50 & 78.14 \(\) 0.21 & 14.62 \(\) 0.02 & 68.54 \(\) 0.30 \\  Garner & **81.40** \(\) 0.30 & **62.45** \(\) 0.64 & **93.27** \(\) 0.22 & **82.97** \(\) 0.16 & **47.22** \(\) 0.42 & **89.30** \(\) 0.21 \\   

Table 2: Results in Road Function Prediction, with the best in **bold** and the second best underlined

    &  &  \\  & MAE \(\) & RMSE \(\) & MAPE \(\) & MAE \(\) & RMSE \(\) & MAPE \(\) \\  Deepwalk & 3.43 \(\) 0.03 & 4.31 \(\) 0.05 & 0.721 \(\) 0.038 & 4.31 \(\) 0.03 & 5.92 \(\) 0.05 & 0.267 \(\) 0.002 \\ MVGRL & 3.04 \(\) 0.04 & 3.82 \(\) 0.04 & 0.629 \(\) 0.041 & 3.91 \(\) 0.02 & 5.16 \(\) 0.03 & 0.243 \(\) 0.001 \\ CCA-SSG & 3.31 \(\) 0.03 & 4.15 \(\) 0.04 & 0.674 \(\) 0.037 & 4.03 \(\) 0.03 & 5.34 \(\) 0.04 & 0.253 \(\) 0.003 \\ GGD & 3.37 \(\) 0.03 & 4.27 \(\) 0.04 & 0.684 \(\) 0.039 & 4.80 \(\) 0.03 & 6.63 \(\) 0.06 & 0.267 \(\) 0.002 \\ RFN & 3.54 \(\) 0.03 & 4.48 \(\) 0.04 & 0.717 \(\) 0.046 & oom & oom & oom \\ SRN2Vec & 3.44 \(\) 0.04 & 4.47 \(\) 0.05 & 0.569 \(\) 0.025 & oom & oom & oom \\ SARN & 3.40 \(\) 0.03 & 4.32 \(\) 0.05 & 0.697 \(\) 0.038 & 4.66 \(\) 0.04 & 6.39 \(\) 0.07 & 0.262 \(\) 0.002 \\  Garner & **2.80** \(\) 0.03 & **3.52** \(\) 0.04 & **0.579** \(\) 0.030 & **3.30** \(\) 0.02 & **4.40** \(\) 0.03 & **0.207** \(\) 0.002 \\    _“oom” means out-of-memory._

Table 3: Results in Road Traffic Inference, with the best in **bold** and the second best underlinedWe compare the proposed Garner with baselines in three downstream tasks, and the experimental results can be found in Table 2, 3 and 4. In road function prediction and road traffic inference, we report the mean results and standard deviation of 30 runs for each model. Among all the tasks, Garner performs significantly better than all the baselines. Specifically, in road function prediction, Garner outperforms the best baseline by up to 22% in Micro-F1, 171% in Macro-F1, and 25% in AUROC. In road traffic inference tasks, Garner outperforms the best baselines by up to 18.5% in MAE, 17% in RMSE, and 17.4% in MAPE. This is because the geographic configuration can provide more details about the roads. For example, the geographic configurations of roads in living apartments and business regions are very different. Thus, the functions of these two roads can be more easily discriminated according to geographic configuration aware road representation. As for road traffic inference, the geographic configuration provides more details about the conditions of roads. Thus, it is beneficial for traffic systems. On visual road retrieval, all the baselines give results similar to random guesses, while Garner gives decent results. The results show that the street view images and geographic configurations provide very different information, which is not presented in road network data. But that information can be well captured by our proposed Garner. We also find that some baselines use up GPU memory and cannot run on Tesla GPUs. We discuss the scalability issue in Appendix C.4.

### Model analysis

Case studyWe conduct a case study comparing the First and Third Laws of Geography. The case study will show the distinctive effect of the Third Law. We randomly select an anchor road, compute its representation similarity with other roads (according to cosine similarity), and display the top 10 most similar roads. The anchor road is in red, the top 10 similar roads by the First Law are shown in blue, and those by both laws are in orange. The results can be found in Fig. 2. With only the First Law, similar roads are much closer to the anchor. With both laws, similar roads are further but have similar geographic configurations, as shown by comparing street view images. This demonstrates that the Third Law ensures similar representations for roads with similar configurations, regardless of distance.

    &  &  \\  & Recall@10 \(\) & MRR \(\) & Recall@10 \(\) & MRR \(\) \\  Deepwalk & 0.0083 & 0.0913 & 0.0013 & 0.0709 \\ MVGRL & 0.0088 & 0.0818 & 0.0324 & 0.1071 \\ CCA-SSG & 0.0112 & 0.0755 & 0.0036 & 0.0807 \\ GGD & 0.0095 & 0.0920 & 0.0019 & 0.0695 \\ RFN & 0.0030 & 0.0766 &  &  \\ SRN2Vec & 0.0123 & 0.0725 &  &  \\ SARN & 0.0143 & 0.1019 & 0.0036 & 0.0766 \\  Garner & **0.4600** & **0.3387** & **0.5531** & **0.2985** \\   \\ 

Table 4: Results on Visual Road Retrieval, with the best in **bold** and the second best underlined

Figure 2: Case study: the top 10 most similar roads found by the First Law only and both laws.

Ablation studiesWe conduct ablation studies by: (1) gradually removing the components in Garner; (2) using different similarity measure to build the augmented graph. The ablation results on road function predictions are listed in Table 5 and 6, while results on other tasks can be found in Appendix C.5. We show that the street view images, utilized to describe the geographic configurations, provide significant improvements in the quality of the road representation by comparing "Garner - sns - aug" and "Garner - sns - aug - SVI". We also find that explicitly modeling the Third Law of geography provides significant improvements by comparing "Garner" and "Garner - sns - aug". Spectral negative sampling also provides obvious improvements in the Macro-F1 score and visual road retrieval. As for the choice of similarity measure, kNN similarity graphs are better than threshold similarity graphs on Road Function prediction, while slightly worse on Road Traffic Inference. Meanwhile using euclidean distance generate similar results as using cosine similarity. As building kNN graphs is much faster than threshold graphs, we choose kNN graphs as the default setting.

Parameter sensitivity analysisWe conduct sensitivity analysis on two hyper-parameters introduced by our method. They are the degree (\(k\)) of the augmented kNN similarity graph and the degree (\(d\)) of the negative graph. The results are visualized in Fig. 3, and more results are listed in Appendix C.6. In these figures, the shadows show the standard deviation. In our experiments, we find that the results are not sensitive to the hyper-parameters.

## 6 Conclusion

In this paper, we embark on pioneering research investigating the _Third Law of geography_ for road network representation learning. To model the Third Law, we introduce street view images to capture the geographic configuration and design a new contrastive learning framework with geographic configuration aware graph augmentation and spectral negative sampling. The experiments show that the proposed method brings significant improvements in road network representation and downstream tasks. There are certainly many future directions, such as modeling more geographic laws, designing new evaluations, and using other kinds of real-world data.

    &  &  \\  & Micro-F1 (\%) \(\) & Macro-F1 (\%) \(\) & AUROC (\%) \(\) & Micro-F1 (\%) \(\) & Macro-F1 (\%) \(\) & AUROC (\%) \(\) \\  knn-dist & 81.40 \(\) 0.30 & 62.45 \(\) 0.64 & 93.27 \(\) 0.22 & 82.97 \(\) 0.16 & 47.22 \(\) 0.42 & 89.30 \(\) 0.21 \\ knn-cos & 81.30 \(\) 0.34 & 62.26 \(\) 0.56 & 92.94 \(\) 0.21 & 82.95 \(\) 0.18 & 46.98 \(\) 0.56 & 89.13 \(\) 0.18 \\ threshold-dist & 79.01 \(\) 0.56 & 56.71 \(\) 0.93 & 91.15 \(\) 0.26 & 81.39 \(\) 0.23 & 40.16 \(\) 0.50 & 86.32 \(\) 0.23 \\ threshold-cos & 79.45 \(\) 0.32 & 57.76 \(\) 0.53 & 91.71 \(\) 0.23 & 82.51 \(\) 0.20 & 45.07 \(\) 0.59 & 88.73 \(\) 0.19 \\   

Table 6: Ablation studies of similarity measures on Road Function Prediction

Figure 3: Sensitivity analysis of hyper-parameter \(k\) and \(d\).

    &  &  \\  & Micro-F1 (\%) \(\) & Macro-F1 (\%) \(\) & AUROC (\%) \(\) & Micro-F1 (\%) \(\) & Macro-F1 (\%) \(\) & AUROC (\%) \(\) \\  Garner - sns - aug - SVI & 66.61 \(\) 0.50 & 30.67 \(\) 0.66 & 74.34 \(\) 0.46 & 78.23 \(\) 0.23 & 17.39 \(\) 0.23 & 69.96 \(\) 0.35 \\ Garner - sns - aug & 74.78 \(\) 0.32 & 50.21 \(\) 0.60 & 88.21 \(\) 0.30 & 80.64 \(\) 0.22 & 37.14 \(\) 0.44 & 85.30 \(\) 0.25 \\ Garner - sns & 80.65 \(\) 0.31 & 60.57 \(\) 0.68 & 92.46 \(\) 0.23 & 82.62 \(\) 0.19 & 45.78 \(\) 0.52 & 88.61 \(\) 0.18 \\ Garner & 81.40 \(\) 0.30 & 62.45 \(\) 0.64 & 93.27 \(\) 0.22 & 82.97 \(\) 0.16 & 47.