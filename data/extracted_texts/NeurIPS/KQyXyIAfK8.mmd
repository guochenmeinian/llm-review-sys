# SOC: Semantic-Assisted Object Cluster for

Referring Video Object Segmentation

 Zhuoyan Luo\({}^{1}\)

Equal contribution. \(\) Corresponding author.

Yicheng Xiao\({}^{1}\)

Equal contribution. \(\) Corresponding author.

Yong Liu\({}^{1}\)1

Shuyan Li\({}^{3}\)

Finghua Shenzhen International Graduate School, Tsinghua University

\({}^{2}\)ByteDance Inc.

\({}^{3}\)Engineering Department, University of Cambridge

{luozy23, xiaoyc23, liu-yong20}@mails.tsinghua.edu.cn

sl2141@cam.ac.uk wangjingshen@bytedance.com

{tang.yansong, li.xiu, yang.yujiu}@sz.tsinghua.edu.cn

Yitong Wang\({}^{2}\)

Finghua Shenzhen International Graduate School, Tsinghua University

\({}^{2}\)ByteDance Inc.

\({}^{3}\)Engineering Department, University of Cambridge

{luozy23, xiaoyc23, liu-yong20}@mails.tsinghua.edu.cn

sl2141@cam.ac.uk wangjingshen@bytedance.com

{tang.yansong, li.xiu, yang.yujiu}@sz.tsinghua.edu.cn

Yansong Tang\({}^{1}\)

Equal contribution. \(\) Corresponding author.

Xiu Li\({}^{1}\)

Finghua Shenzhen International Graduate School, Tsinghua University

\({}^{2}\)ByteDance Inc.

\({}^{3}\)Engineering Department, University of Cambridge

{luozy23, xiaoyc23, liu-yong20}@mails.tsinghua.edu.cn

sl2141@cam.ac.uk wangjingshen@bytedance.com

{tang.yansong, li.xiu, yang.yujiu}@sz.tsinghua.edu.cn

Yuju Yang\({}^{1}\)

###### Abstract

This paper studies referring video object segmentation (RVOS) by boosting video-level visual-linguistic alignment. Recent approaches model the RVOS task as a sequence prediction problem and perform multi-modal interaction as well as segmentation for each frame separately. However, the lack of a global view of video content leads to difficulties in effectively utilizing inter-frame relationships and understanding textual descriptions of object temporal variations. To address this issue, we propose **S**emantic-assisted **O**bject **C**luster (SOC), which aggregates video content and textual guidance for unified temporal modeling and cross-modal alignment. By associating a group of frame-level object embeddings with language tokens, SOC facilitates joint space learning across modalities and time steps. Moreover, we present multi-modal contrastive supervision to help construct well-aligned joint space at the video level. We conduct extensive experiments on popular RVOS benchmarks, and our method outperforms state-of-the-art competitors on all benchmarks by a remarkable margin. Besides, the emphasis on temporal coherence enhances the segmentation stability and adaptability of our method in processing text expressions with temporal variations. Code is available at https://github.com/RobertLuo1/NeurIPS2023_SOC.

## 1 Introduction

Referring Video Object Segmentation (RVOS)  aims to segment the target object referred by the given text description in a video. Unlike conventional single-modal segmentation tasks according to pre-defined categories  or visual guidance , referring segmentation requires comprehensive understanding of the content across different modalities to identify and segment the target object accurately. Compared to referring image segmentation, RVOS is even more challenging since the algorithms must also model the temporal relationships of different objects and locations. This emerging topic has attracted great attention and has many potential applications, such as video editing and human-robot interaction.

Due to the varieties of video content as well as the unrestricted language expression, the critical problem of RVOS lies in how to perform pixel-level alignment between different modalities and time steps. To accomplish this challenging task, previous methods have tried various alignment workflows.

Early approaches [5; 9; 14; 20; 28; 44; 48] take the bottom-up or top-down paradigms to segment each frame separately, while recent works [1; 42] propose to unify cross-modal interaction with pixel-level understanding into transformer structure. Although the above-mentioned approaches have facilitated the alignment between different modalities and achieved excellent performance, they model the RVOS task as a sequence prediction problem and pay little attention to the temporal relationships between different frames. Specifically, they perform cross-modal interaction and segmentation for each frame individually, as illustrated in Fig. 1 (a). The exploitation of temporal guidance relies on the spatial-temporal backbone and manually designed hard assignment strategies [1; 42]. Such paradigms convert the referring video segmentation into stacks of referring image segmentation. While it may be acceptable for such conversion to handle the descriptions of static properties such as the appearance and color of the objects, this approach may lose the perception of target objects for language descriptions expressing temporal variations of objects due to the lack of video-level multi-modal understanding.

To alleviate the above problems and align video with text effectively, we propose Semantic-assisted Object Cluster (SOC) to perform object aggregation and promote visual-linguistic alignment at the video level, as depicted in Fig. 1 (b). Specifically, we design a Semantic Integration Module (SIM) to efficiently aggregate intra-frame and inter-frame information. With a global view of the video content, SIM can facilitate the understanding of temporal variations as well as alignment across different modalities and granularity. Furthermore, we introduce visual-linguistic contrastive learning to provide semantic supervision and guide the establishment of video-level multi-modal joint space. In addition to the remarkable improvements in generic scenarios, these efforts also allow our method to effectively handle text descriptions expressing temporal variations.

We conduct experiments on popular RVOS benchmarks, _i.e._, Ref-YouTube-VOS , Ref-DAVIS , A2D-Sentences and JHMDB-Sentences , to validate the effectiveness of our method. Results show that SOC notably outperforms existing methods for all benchmarks with faster inference speed. In addition, we provide detailed ablations and analysis on components of our method.

Overall, our contributions are summarized as follows:

* We present a framework called SOC for RVOS to unify temporal modeling and cross-modal alignment. In SOC, a Semantic Integration Module (SIM) is designed to efficiently aggregate inter and intra-frame information, which achieves video-level multi-modal understanding.
* We introduce a visual-linguistic contrastive loss to apply semantic supervision on video-level object representations, resulting in well-aligned multi-modal joint space.
* Without bells and whistles, our method outperforms existing state-of-the-art method ReferFormer  by a remarkable margin, _e.g._, +3.0% \(\&\) on Ref-YouTube-VOS and +3.8% \(\&\) on Ref-DAVIS under fair comparison. Besides, our method runs at 32.3 FPS on single 3090 GPU, which is significantly faster than the 21.4 FPS of ReferFormer.

## 2 Related Work

Referring Image SegmentationReferring Image Segmentation (RIS) aims to localize the corresponding object referred by a text description within a static image. It is first introduced by Hu _et

Figure 1: Illustration of different paradigms. Frame-based methods perform cross-modal interaction and segmentation for each frame individually. In contrast, our method unifies temporal modeling and cross-modal alignment to achieve video-level understanding.

al._, who developes a simple framework that utilizes Fully Convolution Network (FCN)  to generate segmentation masks from concatenated visual and linguistic features. To deeply explore the intrinsic correlations among different modal features, several studies  design various attention modules for modality interaction. Additionally, VLT  proposes a transformer-based architecture for the RIS task, which has gained more popularity than FCN-based approaches. LAVT  incorporates early alignment of visual and linguistic features at the intermediate layers of encoders. PolyFormer  further uses transformer to generate polygon vertices as the prior information to refine segmentation masks, leading to better results.

Referring Video Object SegmentationCompared to RIS, RVOS is more challenging since both the action and appearance of the referred object are required to be segmented in a dynamic video. Gavrilyuk _et al._ first proposes the Referring Video Object Segmentation (RVOS) task. URVOS  introduces a large-scale RVOS benchmark and a unified framework that leverages attention mechanisms and mask propagation to increase the task's complexity and scope. ACAN  designs an asymmetric cross-guided attention network to establish complex visual-linguistic relationships. To improve positional relation representations in the text, PRPE  explores a positional encoding mechanism based on the polar coordinate system. In addition, most previous approaches  rely on complicated pipelines. To simplify the workflow, MTTR  and ReferFormer  adopt query-based end-to-end frameworks for decoding objects from multi-modal features, achieving excellent performance. However, during the decoding phase, previous methods only concentrate on intra-frame object information, disregarding the valuable temporal context of objects across frames. To address this issue, we propose to associate object temporal context with language tokens and achieve video-level multi-modal understanding.

## 3 Method

Given \(T\) frames of video clip \(=\{I_{t}\}_{t=1}^{T}\), where \(I_{t}^{3 H_{0} W_{0}}\) and a referring text expression \(=\{e_{i}\}_{i=1}^{L}\), where \(e_{i}\) denotes the i-th word in the text. Our goal is to generate a series of binary

Figure 2: Overview of SOC. The model takes a video clip with corresponding language descriptions as input. After the encoding process, the multi-modal fusion (MMF) module performs bidirectional fusion to build the intrinsic feature relations. Then we design a Semantic Integration Module to efficiently aggregate intra-frame and inter-frame information. Meanwhile, we introduce a visual-linguistic contrastive loss to benefit the establishment of video-level multi-modal space. Finally, the prediction heads decode the condensed embeddings and output segmentation masks. The transparent arrows illustrates the pipeline of our model and label the input and output.

segmentation masks \(=\{s_{t}\}_{t=1}^{T}\), \(s_{t}^{1 H_{0} W_{0}}\) of the referred object. To this end, we propose a video-centric framework called Semantic-assisted Object Cluster (SOC). We will elaborate on it in the following sections.

### Visual and Linguistic Encoding

Visual EncoderTaking a video clip \(\) as input, we utilize a spatial-temporal backbone such as Video Swin Transformer  to extract hierarchical vision features. Consequently, the video clip is encoded into a set of feature maps \(_{i}^{v}^{C_{i} H_{i} W_{i}}\), \(i\{1,2,3,4\}\). Here \(H_{i}\) and \(W_{i}\) denote the height and width of each scale feature map, respectively. \(C\) denotes the channel dimension.

Language EncoderSimultaneously, a transformer-based  language encoder encodes the given textual expression \(\) to a word-level embedding \(^{w}^{L C_{t}}\) and a sentence-level embedding \(^{s}^{1 C_{t}}\). The word embedding \(^{w}\) contains fine-grained description information. On the other hand, the sentence embedding \(^{s}\) expresses the general characteristics of the referred target object.

### Two Stream Multi-Modal Fusion

Having the separate visual and linguistic embedding encoded from the video clip and text expression, we design a Multi-Modal Fusion module called MMF to perform preliminary cross-modal alignment. As shown in Fig. 3, MMF is a two-stream structure. The language-to-vision (L2V) stream aims to highlight the corresponding regions of the referred object in each frame and mitigate the effect of background noise. It leverages linguistic information as guidance and addresses the potential similar visual areas. Meanwhile, a vision-to-language (V2L) stream is designed to update the textual embedding with image content, which helps to relieve the potential ambiguity of unconstrained descriptions. Specifically, we measure the relevance of all visual areas to the text query and assign weights to the useful information extracted from the visual features so as to reorganize the text embedding. The above L2V and V2L fusion process are based on the multi-head cross-attention mechanism, which can be formulated as:

\[(,)= (head_{1}(,),, head_{h}(,))W,\\ head_{j}(,)=(W_{j}^{Q})^{T}W_{j}^{K}}{ })W_{j}^{V},\] (1)

where \(()\) stands for multi-head attention. \(W,W_{j}^{Q},W_{j}^{K},W_{j}^{V}\) are learnable weights used to map the input to the attention space.

Since visual features of different scales contain diverse content information, MMF is designed to produce a series of coarse-to-fine visual and textual feature maps \(\{_{i}^{vf}\}\) and \(\{_{i}^{ef}\},i\{2,3,4\}\). Specifically, we leverage shared parameters to perform multi-head cross-attention operations on \(\{_{i}^{v}\},i\{2,3,4\}\) and \(^{w}\). Take \(_{2}^{v}\) as an example. Firstly, we utilize \(1 1\) convolution and fully connected layers to transform the visual and linguistic embeddings into joint space, respectively. Then the bidirectional multi-modal fusion is applied to align information from different modalities as well as enhance the feature representation. The fusion process is:

\[_{2}^{vf} =(_{2}^{v},^{w}) _{2}^{v},\] (2) \[_{2}^{ef} =(^{w},_{2}^{v}) ^{w},\] (3)

where \(_{2}^{v}^{TH_{2}W_{2} D}\) and \(^{w}^{L D}\) are embeddings projected by convolution and fully connected layers. Similar to Eq. (2) and Eq. (3), the coarse-to-fine aligned visual features \(\{_{i}^{vf}\}\) and textual embeddings \(\{_{i}^{ef}\}\), \(i\{2,3,4\}\) are produced.

### Semantic Integration Module

After aligning cross-modal information and activating the potential target region in MMF, we design a Semantic Integration Module (SIM) to incorporate visual content and generate compact target representations. Specifically, we first leverage frame-level content aggregation to locate objects separately for each frame. Then we associate inter-frame dependency and model the temporal relationship of objects via video-level object cluster.

Frame-Level Content AggregationHaving the activated visual features \(\{_{i}^{vf}\}\) from MMF, we utilize a transformer-based structure to locate objects in each frame. Firstly, \(K\) stacks of deformable transformer encoder layer  are leveraged to capture intra-frame relationships and further excavate multi-modal interactions inside \(\{_{i}^{vf}\}\). This process can be formulated as:

\[_{i}^{vf}=\{_{k}(f_{t}^{vf}) \}_{t=1}^{T},\] (4)

where \(f_{t}^{vf}\) denotes the activated visual features of the t-th frame. Then, a set of learnable object queries  is introduced to aggregate image content and highlight potential target objects. Following , these object queries fully interact with \(_{i}^{vf}\) in deformable transformer decoder through cross-attention mechanism. After extracting different object representations, these object queries are turned into instance embeddings \(^{f}^{ N_{q} D}\). Note that we set up \(N_{q}\) object queries to represent instances of each frame in a video clip so there are \(N_{q}T\) output object queries in total.

Video-Level Object ClusterInstances typically vary in pose and location between frames and even being obscured. Previous methods  only model instances separately for each frame, disregarding the temporal relationship and continuous motion of instances. Although such an approach can cover simple scenarios such as descriptions of target appearance, the lack of inter-frame interaction makes existing methods inefficient for the description of temporal relationships. To address the aforementioned weakness, inspired by , we design a video-level object cluster to capture the temporal information of instances between frames.

As shown in Fig. 3, after instances embedding \(^{f}\) are formulated by the frame-level content aggregation, we flatten it into \(^{f^{}}^{TN_{q} D}\) and employ self-attention mechanism along the temporal axis to introduce inter-frame interaction. Furthermore, we find that only introducing temporal self-attention is inferior. Simply sharing temporal object context may create redundancy due to the similarity of the representation referring to the same object in different frames, which potentially affects the model's precise understanding of objects in the video clip. To this end, we employ an object grouping decoder to perform object clustering and group the same object into video-level compact representations across frames. Specifically, we introduce \(N_{v}\) video-level object queries \(^{v}^{N_{v} D}\) and they are initialized by linguistic sentence-level feature \(^{s}\), which helps to promote the understanding of object descriptions and build the visual-linguistic joint space. By performing interaction between linguistic-aware video queries and condensed instance information of each frame, the object grouping decoder can effectively capture temporal object contexts and group the referred object queries across frames to output the clustered video-level object queries \(^{v}\). While temporal connections can provide a lot of valuable information, the segmentation of each frame is dependent on the specific image content. Thus, we incorporate the high-level video instance information into each frame to integrate the advantages of both. In detail, as illustrated in Fig. 2, we repeat the video-level object queries \(T\) times \(^{fv}^{T N_{v} D}\) and enhance the representation of frame-level object queries

Figure 3: The structure of proposed Multi-Modal Fusion module (MMF) and Video-level Object Cluster module (VOC).

[MISSING_PAGE_FAIL:6]

loss is focal loss and supervises the predicted object category. (4) \(_{con}(y_{},_{sim})\): visual-linguistic contrastive loss. The total loss can be formulated as:

\[_{total}=_{mask}_{mask}+_{box}_ {box}+_{cls}_{cls}+_{con}_{con},\] (9)

where \(\) is the scale factor to balance each loss.

## 4 Experiment

### Datasets and Metrics

**Datasets.** We evaluate our model on four prevalent RVOS benchmarks: Ref-YouTube-VOS , Ref-DAVIS17 , A2D-Sentences, and JHMDB-Sentences . For detailed descriptions of the datasets please see the supplementary material.

**Metrics.** Following [1; 42], we measure the effectiveness of our model by criteria of Precision@K, Overall IoU, MeanIoU and MAP over 0.50:0.05:0.95 for A2D-Sentences and JHMDB-Sentences. Meanwhile, we adopt standard evaluation metrics: region similarity(\(\)), contour accuracy (\(\)) and their average value (\(\&\)) on Ref-YouTube-VOS and Ref-DAVIS17.

### Implementation Details

We take the pretrained Video Swin Transformer  and RoBERTa  as our encoder in default. Both the frame aggregation and object cluster parts of SIM consist of three encoder and decoder layers. The number of frame-level queries \(^{f}\) and video-level queries \(^{v}\) are set as 20 in default. We feed the model windows of \(w=8\) frames during training. The models are trained with eight 32GB V100 GPUs in default. The coefficients for losses are set as \(_{cls}=2\), \(_{L1}=2\), \(_{giou}=2\), \(_{dice}=2\), \(_{focal}=5\), \(_{con}=1\). Due to space limitations, please see the supplementary materials for more training details.

### Main Results

**Ref-YouTube-VOS & Ref-DAVIS17.** We compare our method to previous models on Ref-YouTube-VOS and Ref-DAVIS17 in Table 1. With video-level multi-modal understanding, our SOC achieves new state-of-the-art performance among different training settings: train from scratch, with image pretrain, and joint train. Without bells and whistles, our approach outperforms existing SOTA by about 3% \(\&\) under fair comparison. On Ref-DAVIS17, we directly report the results using the model trained on Ref-YouTube-VOS without finetune.

    &  &  &  \\   & & \(\&\) & \(\) & \(\) & \(\&\) & \(\) \\  URVOS  & ResNet-50 & 47.2 & 45.3 & 49.2 & 51.5 & 47.3 & 56.0 \\ LBDT-4  & ResNet-50 & 49.4 & 48.2 & 50.6 & - & - & - \\ MITTR  & Video-Swin-T & 55.3 & 54.0 & 56.6 & - & - & - \\ Referformer  & Video-Swin-T & 56.0 & 54.8 & 57.3 & - & - & - \\ SOC (Ours) & Video-Swin-T & **59.2** & **57.8** & **60.5** & **59.0** & **55.4** & **62.6** \\   \\  ReferFormer  & Video-Swin-T & 59.4 & 58.0 & 60.9 & 59.7 & 56.6 & 62.8 \\ ReferFormer  & Video-Swin-B & 62.9 & 61.3 & 64.6 & 61.1 & 58.1 & 64.1 \\ VLT  & Video-Swin-B & 63.8 & 61.9 & 65.6 & 61.6 & 58.9 & 64.3 \\ SOC (Ours) & Video-Swin-T & **62.4** & **61.1** & **63.7** & **63.5** & **60.2** & **66.7** \\ SOC (Ours) & Video-Swin-B & **66.0** & **64.1** & **67.9** & **64.2** & **61.0** & **67.4** \\   \\  ReferFormer & Video-Swin-T & 62.6 & 59.9 & 63.3 & - & - & - \\ ReferFormer & Video-Swin-B & 64.9 & 62.8 & 67.0 & - & - \\ SOC (Ours) & Video-Swin-T & **65.0** & **63.3** & **66.7** & **64.2** & **60.9** & **67.5** \\ SOC (Ours) & Video-Swin-B & **67.3** & **65.3** & **69.3** & **65.8** & **62.5** & **69.1** \\   

Table 1: Comparison with the state-of-the-art methods on Ref-YouTube-VOS and Ref-DAVIS17 datasets. _With Image Pretrain_ denotes the models are first pretrained on RefCOCO , Ref-COCO+ , and RefCOCOg  datasets. _Joint Train_ indicates the models are trained with the combination of image datasets and video datasets.

[MISSING_PAGE_FAIL:8]

shown in Table 5, the transformer architecture has a better perception as well as selection of global information, which helps to associate object features across frames. ii) Sufficient inter-frame interactions. Although other methods can also yield video-level representations, they lack the perception of temporal variations and the alignment of inter-frame information. As a contrast, our VOC performs adequate inter-frame interaction while clustering.

Object Query NumberAlthough only one referred object is involved in a video, focusing on more potential regions is helpful due to the various video content. Table 6 shows that an increased number of object queries allows the model to effectively group the relevant objects from the pool of candidate regions. The performance saturates when the query number is increased to a certain extent. We believe that excessive queries may cause misunderstandings when grouping objects across frames.

Segmentation StabilityBenefiting from video-level multi-modal understanding, our method yields more robust segmentation results compared to existing approaches. To quantify the temporal segmentation stability, we calculate the IoU and \(\&\) variance between each frame in a video and count the average value on Ref-YouTube-VOS  dataset. Results are shown in Fig. 4 (_the lower is better_). It can be seen that with video object cluster module and visual-linguistic contrastive loss building the video-level multi-modal aligned space, our SOC can understand the overall video content better and output temporally stable segmentation results. More qualitative analysis of temporal consistency is shown in the supplementary material.

Frame NumberTable 7 shows results with different training clip frame numbers. As expected, widening temporal context leads to performance gains yet causes expensive computation cost. For a fair comparison with existing methods, we take the frame number of 8 by default.

Variants of VOC StructureResults in Table 8 illustrate the rationality of the structure of the VOC module. Without sufficient inter-frame interaction by the encoder or aggregation of target object information by the decoder, the segmentation performance will be degraded.

Inference SpeedIn addition to superior segmentation performance, our method also achieves real-time inference. Specifically, our SOC runs at 32.3 FPS on single 3090 GPU, which significantly exceeds the existing SOTA method ReferFormer  (21.4 FPS).

Figure 4: IoU and \(\&\) variance.

Figure 5: Segmentation results of our SOC. Best viewed in color.

Figure 6: Visualization comparison using text expressions about temporal actions. (a) and (b) are segmentation results of our SOC and ReferFormer , respectively.

### Qualitative Results

Fig. 5 demonstrates the effectiveness of SOC for complex scenarios segmentation, _i.e._, similar appearance, occlusion, and large variations. To further prove the _adaptability_ of our SOC for understanding text expressions about temporal action and variations, we design corresponding text descriptions that depict changed states of the object in temporal. As shown in Fig. 6, the global view enables SOC to understand such text and segment the target object accurately. In contrast, ReferFormer  only recognizes the object in specific frames mentioned in the text descriptions and fails to comprehend the content. More comparisons can be seen in the supplementary material. Fig. 7 indicates that due to the temporal modeling and inter-frame interaction in VOC, the full model comprehends text descriptions of temporal variations and tracks the target in coherence. In contrast, without VOC, the model struggles to understand the temporal relationship and fails to segment the object.

## 5 Conclusion

In this paper, we propose a framework called SOC for RVOS to achieve video-level multi-modal understanding. By associating frame-level object embeddings with language tokens, we unify temporal modeling and cross-modal alignment into a simple architecture. Moreover, visual-linguistic contrastive learning is introduced to build the video-level multi-modal space. Extensive experiments show that our SOC remarkably outperforms existing state-of-the-art methods. Besides, video-level understanding also allows our SOC to handle text descriptions expressing temporal variations better.

**Limitations.** The proposed framework, SOC, has achieved video-level multi-modal understanding and excellent performance. However, there are some potential limitations, _e.g._, the current architecture cannot handle infinitely long videos. We think that devising explicit designs for long videos with complex scenarios is an interesting future direction.