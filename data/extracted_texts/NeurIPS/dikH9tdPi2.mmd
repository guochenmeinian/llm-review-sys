# Improving Adversarial Transferability via Intermediate-level Perturbation Decay

Qizhang Li\({}^{1,2}\), Yiwen Guo\({}^{3}\), Wangmeng Zuo\({}^{1}\), Hao Chen\({}^{4}\)

\({}^{1}\)Harbin Institute of Technology, \({}^{2}\)Tencent Security Big Data Lab, \({}^{3}\)Independent Researcher, \({}^{4}\)UC Davis

{liqizhang95,guoyiwen89}@gmail.com wmzuo@hit.edu.cn chen@ucdavis.edu

Yiwen Guo and Wangmeng Zuo lead the project. Correspondence to: Wangmeng Zuo (wmzuo@hit.edu.cn).

 Wangmeng Zuo (wmzuo@hit.edu.cn).

 Hao Chen\({}^{4}\)

\({}^{1}\)Harbin Institute of Technology, \({}^{2}\)Tencent Security Big Data Lab, \({}^{3}\)Independent Researcher, \({}^{4}\)UC Davis

{liqizhang95,guoyiwen89}@gmail.com wmzuo@hit.edu.cn chen@ucdavis.edu

###### Abstract

Intermediate-level attacks that attempt to perturb feature representations following an adversarial direction drastically have shown favorable performance in crafting transferable adversarial examples. Existing methods in this category are normally formulated with two separate stages, where a directional guide is required to be determined at first and the scalar projection of the intermediate-level perturbation onto the directional guide is enlarged thereafter. The obtained perturbation deviates from the guide inevitably in the feature space, and it is revealed in this paper that such a deviation may lead to sub-optimal attack. To address this issue, we develop a novel intermediate-level method that crafts adversarial examples within a single stage of optimization. In particular, the proposed method, named _intermediate-level perturbation decay (ILPD)_, encourages the intermediate-level perturbation to be in an effective adversarial direction and to possess a great magnitude simultaneously. In-depth discussion verifies the effectiveness of our method. Experimental results show that it outperforms state-of-the-arts by large margins in attacking various victim models on ImageNet (**+10.07%** on average) and CIFAR-10 (**+3.88%** on average). Our code is at [https://github.com/qizhangli/ILPD-attack](https://github.com/qizhangli/ILPD-attack).

## 1 Introduction

Adversarial examples can be crafted without getting access to essential information (_e.g._, architecture and parameters) of the victim models . Due to their applicability of assessing AI safety in many real-world deployment environments, recent years have witnessed a steady increase in the study of black-box adversarial examples . A considerable proportion of black-box attacks rely on transferability of adversarial examples, _i.e._, a phenomenon where adversarial examples crafted targeting a white-box substitute model can also fool unknown victims with a moderate success rate.

Despite being crucial to many attacks, the adversarial transferability has not been fathomed out. Some work attempts to regulate the intermediate-level perturbation (discrepancy between the intermediate-level representation of adversarial examples and that of benign examples) to show a large magnitude and align with an directional guided that can effectively maximize the prediction loss of a model . To achieve this, they choose to maximize the scalar projection of the intermediate-level perturbation onto a directional guide. The determination of the directional guide of such methods are various, and each was well-motivated. Though effective, such an objective inevitably deviates the intermediate-level perturbation from the well-motivated directional guide (as will be discussed in Section 3.1), and it may deteriorate the attack performance on the substitute model and lead to sub-optimal transferability despite showing a large perturbation magnitude in the middle layer.

In this paper, we propose a method that encourages the intermediate-level perturbation to possess a greater magnitude than a directional guide by its nature and to be in the same adversarial direction as that of the guide. This is achieved by introducing _intermediate-level perturbation decay (ILPD)_in a single stage of optimization. Extensive experiments were conducted to show that our ILPD outperforms existing state-of-the-arts by large margins in attacking various victim models on CIFAR-10 and ImageNet. Moreover, such a method can further be readily integrated into a variety of existing transfer-based attacks.

## 2 Background and Related Work

Adversarial examples can be generated in white-box and black-box settings.

White-box attacks.In white-box settings, the architecture and parameters of the victim model are known to the adversary, and the gradient of the victim models can therefore be directly utilized to generate adversarial examples. Given a victim model \(f:^{n}^{c}\) which has been trained to classify any input, a typical way of generating adversarial examples is to maximize the prediction loss \(L(f(+),y)\) of \(f\) while constraining the \(_{p}\) norm of the perturbation \(\) to a benign input \(\), _i.e._, \(_{\|\|_{p}}L(f(+),y)\), where \(\) is the perturbation budget and \(y\) is the ground-truth. FGSM  derives a single gradient step to obtain the perturbation \(=(_{}L(f( ),y))\) in an \(_{}\) setting. If not otherwise mentioned, we denote \(L(f(),)\) as \(L_{f}(,)\) for simplicity of notation. For performing stronger attacks, iterative methods have also been proposed, _e.g._, I-FGSM  and PGD  which update the perturbation at the \(j\)-th iteration as

\[_{j}=^{}_{}( _{j-1}+(_{}L_{f }(+_{j-1},y))), \]

where \(\) is the update step size and the \(^{}_{}\) operation ensures that the norm of perturbation does not exceed \(\).

Black-box attacks.Issuing attacks in black-box settings is much more challenging than in white-box settings due to the lack of information of the victim model. In general, neither the architecture nor the parameter of the victim model is accessible in the black-box settings, and the attacker can only obtain the prediction confidence or even only the predicted label, providing any input. Two lines of methods have been developed for crafting adversarial examples under such circumstances, _i.e._, query-based methods and transfer-based methods. Query-based methods advocate searching along promising directions  or estimating the gradient of victim models via zeroth-order optimization , while transfer-based methods train substitute models to craft adversarial examples and can be query-free.

Adversarial transferability.As the core of transfer-based attacks, the transferability of adversarial examples from substitute models to unknown victim models has been studied widely over recent years, and a variety of methods have been proposed to enhance it. Related to our work, some previous work also achieves improved transferability by modifying the gradient computation on substitute models. For instance, Guo _et al._ advocated removing non-linear activations during back-propagation, especially in later layers of DNNs. Wu _et al._ suggested to take gradients more through skip connections, if exist, on the substitute models. In particular, intermediate-level representations were taken special care of in some prior arts .

## 3 Perturbation Decay in the Feature Space

We revisit some existing attacks that operate on intermediate-level representations and identify their possible limitations in Section 3.1 and propose a novel method to improve them in Section 3.2.

### Revisiting Intermediate-level Attacks

As transfer-based attacks, intermediate-level attacks are performed with at least a substitute model. Given a model input \(\), the output of an \(\)-layer substitute model can be simplified as \(f()=W_{}^{T}_{-1}(W_{-1}^{T}_{1}(W_{ 1}^{T}))\), where, for \(i\{1,,\}\), \(_{i}\) is an activation function, and \(W_{i}^{n_{i-1} n_{i}}\) parameterizes a layer in the model. Assume that the input is of \(n\) dimensions and there are \(c\) classes for prediction, then we have \(n_{0}=n\), and \(n_{}=c\). Existing intermediate-level attacks decompose the model into a \(\)-layer feature extractor \(h\) and an \((-)\)-layer classifier \(g\), _i.e._, we can formulate the model as \(f()=g(h())\) for any \(\). A motivation of intermediate-level attacks is that different models might share the same low-level representations in \(h\) and it suffices to operate on the output layer of \(h\).

A typical work of intermediate-level attack is ILA . It attempts to regulate the intermediate-level perturbation (_i.e._, discrepancy between the intermediate-level representation of adversarial examples and that of benign examples) to show a large norm and to be close to a directional guide. The directional guide in ILA is chosen as the discrepancy from benign representations that could be reached in the output space of \(h\) and leads to maximum prediction loss of \(f\), given the perturbation budget. Since white-box attacks all devote to achieving maximal prediction loss, ILA can be performed with simply a \(u\)-step baseline attack (_e.g._, I-FGSM) and the intermediate-level perturbation achieved by the baseline attack as the directional guide.

Let \(+_{j}\) be the adversarial input achieved at the \(j\)-th step of the baseline attack, we denote \(_{h}^{(j)}:=h(+_{j})\) as the intermediate-level representation of \(+_{j}\). Further, denote by \(\) the directional guide, then we can formulate it as \(=(_{h}^{(u)}-_{h}^{(0)})\).

ILA maximizes the scalar projection, which is

\[_{\|\|_{p}}^{T}(h(+ )-h()), \]

where \(1/\|\|_{2}\) is omitted as it does not affect the optimal solution. With such a learning objective, the norm of the vector projection is maximized if \(\) and \(h(+)-h()\) form an acute angle. Since the direction of intermediate-level perturbation is not restricted to be in exactly the same direction as that of the directional guide, the obtained intermediate-level perturbation often deviates from the directional guide in practice. Yet, the adversarial perturbations are generally not robust enough , and such directional deviations normally leads to decrease in the prediction loss of the substitute model, even with large perturbation magnitude in the middle layer.

A quick experiment was conducted to examine the impact of such directional deviations. The experiment was conducted on CIFAR-10  using a VGG-19  as the substitute model and another VGG-19 with the same \(h\) as the victim model, just to simplify the analyses. The directional guide \(\) of ILA was obtained by 10-steps I-FGSM following prior work [26; 16; 27]. We evaluated the cross-entropy prediction loss of the models with various intermediate-level perturbations to demonstrate how the attack performance can be affected by the scalar projection (onto \(\)) and the directional deviation (from \(\)). Somewhat unsurprisingly, as depicted in Figure 1, when fixing the direction of intermediate-level perturbations, the perturbations with larger magnitude leads to more significant attack performance on both the substitute model and the victim model. More enticingly, with intermediate-level perturbations showing similar scalar projection, those deviating more from the directional guide leads to lower prediction loss on the victim model and hence worse black-box attack performance. As illustrated in the figure, the ILA perturbation only slightly deviates from the directional guide \(\) (with a cosine similarity of roughly 0.90), yet its attack performance is already inferior to that of the intermediate-level perturbations along the direction of \(\)**with even smaller magnitude**. Follow-up work of ILA, _e.g._, [26; 16], mostly focuses on developing more powerful directional guides, yet the deviation remains and the same problem persists.

### Our Solution

Given Figure 1, one may consider that a straightforward improvement of the intermediate-level attacks is to instead maximize the magnitude of (intermediate-level) perturbation only along the direction of \(\). Nevertheless, most existing intermediate-level attacks consists of two separate stages which sequentially seeks \(\) and maximizes perturbation magnitude, and they fail to take into account whether there exists a larger intermediate-level perturbation along the direction of \(\), given the perturbation budget in the input space of \(f\).

Figure 1: How the prediction loss of (a) the substitute model and (b) the victim model vary with the scalar projection onto \(\) and the direction deviation from \(\) (_i.e._, the cosine similarity between \(\) and \(h(+)-h()\)). The purple box represents the results achieved by ILA.

In this context, we aim to develop a novel method that seeks intermediate-level perturbations to be in an adversarial direction and to possess larger norms (or say larger magnitudes) **compared to a directional guide in the same direction** simultaneously. As with previous methods, we consider a direction to be adversarial if a guide along this direction achieves large prediction loss by itself when being fed to the substitute classifier \(g\). The intermediate-level perturbation with a relatively larger magnitude can simply be obtained by amplifying the directional guide by \(\) in the middle layer. However, such an intermediate-level perturbation may not be reachable with a limited perturbation budget, _i.e._, \(\|\|_{p}\), in the input space.

In light of all these considerations, we turn to the "dual" optimization problem and opt to maximize the prediction loss of \(g\) with a \(\) "decayed" intermediate-level perturbation (_i.e._, \((h(+)-h())/\) which is regarded as the directional guide \(\)). That is,

\[_{\|\|_{p}}L(g(h()+(h(+)-h())),y)=_{\|\|_{p}}L(g(h(+)+(1-)h()),y). \]

Since the method seems decays the intermediate-level perturbation from the benign features, we call it _intermediate-level perturbation decay (ILPD)_. Apparently, setting \(=1\) means attack without the perturbation modification and it makes the method equivalent to the baseline multi-step attack. While, enforcing \(>1\) leads to decayed perturbation as desired. The operation of \(h(+)/+(-1)h()/\) resembles the mixup augmentation , except there is no randomness for \(\) and \(\) is suggested to be relatively large to encourage larger perturbation magnitude and larger loss.

Figure 2 demonstrates the performance of our ILPD, together with that of ILA. Solid dots \(,,,\) represent achievable performance of our ILPD with \(1/\{1.0,0.9,,0.1\}\), while the blue cross mark \(\) represents the performance of ILA in the figure. From the vertical axis, it can be seen that the ILPD adversarial examples are capable of tricking the victim model into showing significantly larger prediction loss (\(4.08\)-\( 4.54\)), despite possessing lower perturbation magnitude in the feature space, comparing with ILA examples. Given \(\) in the concerned range, ILPD-obtained perturbation directions are very effective in the sense of being adversarial. See the shaded area which illustrates how the attack performance varies with the perturbation magnitude along with these directions in the middle layer.

It is worth noting that we normally suggest a relatively large \(\) with \( 2\) (_i.e._, \(1/ 0.5\)). The formulation of ILPD leads to a \(\) larger perturbation magnitude anyway, than that of \((h(+)-h())/\) which is regarded as the directional guide \(\). However, given \(g\) being non-linear in practice, a \(\) amplified intermediate-level perturbation does not truly lead to \(\) larger prediction loss of \(g\). In particular, the obtained loss is more difficult to be guaranteed especially when \(\) is extremely large, _e.g._, \( 10\) or, equivalently, \(1/ 0.1\). Therefore, we simply apply with \(0.1 1/ 0.5\) in our main experiments in Section 5. Comprehensive ablation studies are deferred to Section 5.4.

## 4 Analysis from the Gradient Alignment Perspective

Recall that the diversity in input gradients across models is the main obstacle to adversarial transferability, thus, in this section, we analyze ILPD from the perspective of gradient alignment between the substitute and victim models, in order to shed more light on its effectiveness.

### Impacting Factors of Gradient Alignment

Aiming at compromising an unknown victim model \(f_{}\), a baseline transfer-based attack (_e.g._, I-FGSM) can generate adversarial example on a white-box substitute model \(f\). In fact, if

Figure 2: Comparing the achieved attack performance and the intermediate-level perturbation magnitude of ILA and our ILPD. Darker colors of the solid dots indicate larger values of \(\). Best viewed in color.

\(_{}L_{f_{t}}(+_{j},y)\), then the obtained adversarial examples will be as powerful on the victim model. Yet, the input gradients are often not well-aligned, and, as depicted in Figure 3(a), after some initial iterations, the input gradient of \(L_{f}(+_{j},y)\) and that of \(L_{f_{t}}(+_{j},y)\) may be increasingly different as \(j\) increases, which is probably a major obstacle to the adversarial transferability of multi-step attacks.

Let us delve deep into this. For simplicity of notations, the activation functions \(_{i}\) is restricted to ReLU. Then, the input gradient \(_{}L_{f}(+_{j},y)\) can be written as the product of three terms:

\[_{}L_{f}(+_{j},y) =_{}h(+_{j}) _{_{h}^{(j)}}L(g(_{h}^{(j)}),y) \] \[=_{}h(+_{j}) \!\!(\!\!W_{+1}\!\!\!_{i=+1}^{-1}\!\!\!\!D_{i}( _{h}^{(j)})W_{i+1}\!\!)\!\!_{_{g}^{(j)}}L( _{g}^{(j)},y),\]

following the chain rule, where \(D_{i}(_{h}^{(j)})\) provides a binary matrix whose diagonal entry is set to \(1\) if it corresponds to a nonzero activation within the \(i\)-th layer, and it is set to \(0\) if otherwise. If there exist max pooling layers, they can be similarly formulated, and the gradient through these layers can also be given as a binary matrix in \(\{D_{i}\}\).

The input gradient of a victim model \(f_{t}\) (_i.e._, \(_{}L_{f_{t}}(+_{j},y)\)) can be similarly formulated as in Eq. (4). The diversity between \(_{}L_{f}(+_{j},y)\) and \(_{}L_{f_{t}}(+_{j},y)\) probably comes from some difference in the activation masks in \(\{D_{i}\}\) and/or diversity in the gradients of \(L\)_w.r.t._ the logits (_i.e._, \(_{_{g}}L(_{g},y)\) where \(j\) is dropped for simplicity of notation). Note that the gradients of \(h\) are not concerned as it has been assumed in prior work that different models might share a similar \(h\).

By replacing 1) activation masks in \(\{D_{i}\}\) and/or 2) the gradient of \(L\)_w.r.t._ the logits (_i.e._, \(_{_{g}}L(_{g},y)\)) with those obtained on the victim model, we are capable of analyzing how much impact they actually make. An experiment is thus conducted, using ten pairs of substitute and victim models with the VGG-19 architecture. Figure 3 shows that the transferability can be remarkably improved by replacing any of them. Replacing \(_{_{g}}L(_{g},y)\) seems more effective at initial iterations while replacing the activation masks leads to slightly more improvement at the end. Given the cross-entropy loss which evaluates the discrepancy between the prediction probabilities and the one-hot ground-truth vector \(\), we have \(_{_{g}}L(_{g},y)=-\) where \(=s(_{g})\) is a vector containing all prediction probabilities and \(s\) is the softmax function. That said, at initial iterations, the difference in \(\) between the models is a more influential factor, and, at later iterations, the difference in \(\{D_{i}\}\) becomes dominant.

As the adversarial example is optimized on the substitute model, the prediction of a I-FGSM example is very likely to be less incorrect on the victim model even at the first iteration. Difference in \(\) across models leads to difference in the input gradient, and it is possible that the difference become more and more severe, forming a vicious circle in some sense.

### Analysis of ILPD and Some Other Attacks

Recall that the input gradient obtained by ILPD at the \(j\)-th iteration is

\[_{}h(+_{j})_{}_{h}^{(j)}}L(g(}_{h}^{(j)}),y) \]

Figure 3: How (a) the cosine similarity of input gradients and (b) success rate vary with I-FGSM iterations, using tens pairs of substitute and victim models. The shaded areas indicate the standard deviation of the pairs. Best viewed in color.

in which \(}_{h}^{(j)}=_{h}^{(j)}+(1-)_{h}^{(0)}\). It can be regarded as replacing \(_{_{h}^{(j)}}L(g(_{h}^{(j)}),y)\) in Eq. (4) with the gradient of \(L\)_w.r.t._ to some less adversarial intermediate-level perturbation \(}_{h}^{(j)}\). Less adversarial intermediate-level perturbations leads to less incorrect predictions, which probably aligns better with that of the victim model.

Figure 4 shows that ILPD leads to more aligned input gradient across models, especially after the first 20 iterations. The attack success rates are compared in Figure 4(b), and it can be seen that, thanks to the improved gradient alignment, ILPD is capable of generating more transferable adversarial examples in comparison to I-FGSM, achieving \(+4.00\%\) absolute gains at the \(100\)-th iteration. More detailed analyses show that the ILPD examples lead to activation masks and prediction probabilities better aligned with those of the victim model.

In addition to our ILPD, some other intermediate-level methods can also be seen as beneficial to gradient alignment. In particular, for ILA , we have

\[\!=\!_{h}^{(u)}-_{h}^{(0)}\!\!_{h}^{(u)}-_{h}^{(0)}\|_{2}}{L(g(_{h}^{(u)}),y )-L(g(_{h}^{(0)}),y)}_{_{h}^{(0)}}L(g(_{h }^{(0)}),y), \]

where the Taylor series is adopted to obtain the approximation. Therefore, optimizing Eq. (2) at the \(j\)-th step of an iterative optimizer can be considered as adopting the gradient _w.r.t._\(_{h}^{(0)}\) as a replacement of the gradient _w.r.t._\(_{h}^{(j)}\). Without injecting noise or augmenting data at each iteration, ILA++ [26; 16] and NAA  can also be approximately regarded as replacing the gradient _w.r.t._\(_{h}^{(j)}\) with the gradient _w.r.t._\(_{h}^{(0)}\).

In addition to these efforts, Guo _et al._ proposed LinBP  which back-propagates linearly in later layers. It can be regarded as replacing each \(D_{i}\) with an identity matrix for computing input gradients. Though effective, it mainly takes care of \(\{D_{i}\}\) and somehow ignores the difference of \(_{_{g}}L(_{g},y)\) across models.

## 5 Experiments

Experimental settings will be introduced in Section 5.1. We will compare our solution with a variety of state-of-the-arts to evaluate its effectiveness in Section 5.2. We combine our solution with some existing methods to further improve the adversarial transferability in Section 5.3, and we perform some ablation studies in Section 5.4.

### Experimental Settings

Our experiments were conducted on CIFAR-10  and ImageNet  under \(_{}\) constraint in the black-box setting. We focus on untargeted attacks and use I-FGSM attack as the back-end method, just like in previous work [46; 11; 28; 42]. We set the perturbation budget to \(=4/255\) and \(8/255\) for attacks on CIFAR-10 and ImageNet, respectively. Further, on CIFAR-10, we used a VGG-19 with batch normalization  as the substitute model, and a _different_ VGG-19 with batch normalization,

Figure 4: How (a) the cosine similarity of input gradients and (b) success rate change along with I-FGSM and ILPD iterations, using ten pairs of substitute and victim models. Shaded areas indicate the standard deviation. Best viewed in color.

a ResNet-18 , a PyramidNet , GDAS , a WRN-28-10 , a ResNeXt-29 , and a DenseNet-BC 2 as the victim models, following some prior work . All victim models (except for the VGG-19 which was trained by ourselves) were pre-trained by others and directly collected for experiments. On ImageNet, we used a ResNet-50  model as the substitute model, and collect 13 victim models, including a _different_ ResNet-50 , a VGG-19 , a ResNet-152 , a Inception v3 , a DenseNet-121 , a WRN-101 , a RepVGG-B1 , a MLP Mixer-B , a ConvNeXt-B , a ViT-B , a DeiT-B , a Swin-B , and a BEiT-B 3.

The image size of adversarial examples was \(224 224\) on ImageNet and \(32 32\) on CIFAR-10, without crop, following prior work . We performed adversarial attacks on all test data in CIFAR-10 and \(5000\) randomly sampled examples from the ImageNet validation data. The adversarial examples obtained at each iteration of the attack should be clipped to , in order to ensure that only valid images are fed to DNNs. We run \(100\) iterations with a step size of \(1/255\) for all attack methods on both CIFAR-10 and ImageNet in this section, and we set a smaller step size of \(/100\) for Section 4 as we care more about the trend of overfitting before exhausting the perturbation budget. ILPD was performed at the output of the fourth VGG block for VGG-19 on CIFAR-10 and the output of the last building block of the second ResNet meta layer for ResNet-50 on ImageNet, with \(\) tuned in the range satisfying \(0.1 1/ 0.5\). The advanced version of ILA++  and NAA  are adopted as competitors. Since both methods inject some random transformations to the benign examples, when computing gradients, we also add Gaussian noise with a standard deviation of 0.05 to the benign examples at each iteration, for fair comparison. For competitors, we directly adopt their official implementations and hyper-parameters, and we attack on the same CIFAR-10 and ImageNet images for all methods. All experiments are performed on an NVIDIA V100 GPU.

### Comparison with State-of-the-arts

The comparison results are summarized in Table 1 and 2. For ImageNet, 13 victim models, including four vision transformers, one multi-layer perceptron model, and a model that has the same architecture of the substitute model, are adopted. For CIFAR-10, 7 victim models are adopted. We compare our method with a gradient stabilization method (_i.e._, MI-FGSM ), some input augmentation methods (_i.e._, DI\({}^{2}\)-FGSM , TI-FGSM , SI-FGSM , and the recent Admix ), compelling intermediate-level attacks (_i.e._, ILA++  and NAA ), some back-propagation modification methods (_i.e._, SGM  and LinBP ), and a very recent method called TAIG .

Experiment results in the tables show that our method outperforms all these competitors by large margins. Specifically, it can be seen that with the assistance of our ILPD, it is possible to achieve an average success rate of **57.06%** on ImageNet, which outperforms the second best (_i.e._, ILA++) by **+10.07%**. On CIFAR-10, we achieve **62.82%**, which outperforms the second best by **+3.88%**.

Attacking some newly designed models is challenging when using ResNet as the substitute model. The I-FGSM baseline can only achieve a success rate of less than \(10\%\) against these models (see the right half of Table 1) and even \(<5\%\) against some vision transformers. However, our method

   Method & ResNet & ResNet & DenseNet & WRN & Inception & RepVGG & VGG & Mixer & ConvNeXt & ViT & DeiT & Swin & BEiT & Average \\ -50 & -152 & -121 & -101 & v3 & -B1 & -19 & -B & -B & -B & -B & B & B & -B & Average \\  I-FGSM & 38.20\% & 18.88\% & 49.24\% & 47.62\% & 22.14\% & 33.54\% & 44.98\% & 9.00\% & 9.68\% & 4.42\% & 3.96\% & 5.16\% & 3.84\% & 22.36\% \\ MI-FGSM & 47.88\% & 25.99\% & 59.96\% & 56.26\% & 30.42\% & 43.22\% & 54.28\% & 13.36\% & 13.18\% & 6.74\% & 5.80\% & 7.68\% & 6.62\% & 28.57\% \\ DI\({}^{2}\)-FGSM & 42.4\% & 27.09\% & 20.28\% & 84.76\% & 58.94\% & 7.47\% & 83.50\% & 81.62\% & 29.76\% & 12.82\% & 1.196\% & 13.92\% & 41.12\% & 46.88\% \\ TI-FGSM & 38.72\% & 19.72\% & 49.60\% & 49.00\% & 22.72\% & 33.90\% & 45.86\% & 9.36\% & 9.20\% & 4.70\% & 3.94\% & 5.12\% & 4.08\% & 22.76\% \\ SI-FGSM & 51.46\% & 28.62\% & 71.42\% & 65.82\% & 36.50\% & 47.60\% & 59.18\% & 12.42\% & 12.22\% & 6.34\% & 5.66\% & 6.28\% & 6.48\% & 31.54\% \\ SGM & 71.46\% & 48.72\% & 73.28\% & 74.26\% & 35.86\% & 65.76\% & 75.10\% & 19.08\% & 22.84\% & 16.66\% & 8.44\% & 12.26\% & 9.96\% & 40.59\% \\ LinBP & 73.00\% & 52.86\% & 81.56\% & 78.18\% & 39.40\% & 68.28\% & 51.54\% & 13.90\% & 15.80\% & 17.0\% & 5.82\% & 8.90\% & 7.98\% & 41.15\% \\ Admix & 63.52\% & 37.64\% & 71.94\% & 73.68\% & 31.84\% & 60.50\% & 70.92\% & 11.90\% & 15.14\% & 6.62\% & 5.10\% & 7.62\% & 6.24\% & 35.59\% \\ TAIG-R & 66.26\% & 24.82\% & 87.50\% & 84.46\% & 59.40\% & 72.36\% & 80.94\% & 18.86\% & 14.54\% & 10.96\% & 8.00\% & 9.56\% & 13.46\% & 43.38\% \\ NAA & 74.14\% & 88.84\% & 86.16\% & 84.34\% & 57.04\% & 76.30\% & 82.96\% & 20.96\% & 19.86\% & 9.29\% & 8.42\% & 11.56\% & 11.36\% & 46.36\% \\ ILA++ & 75.28\% & 55.56\% & 84.78\% & 83.46\% & 50.98\% & 72.48\% & 74.88\% & 22.23\% & 30.28\% & 13.76\% & 12.18\% & 16.50\% & 14.94\% & 46.99\% \\ ILPD & **83.96\%** & **69.86\%** & **90.86\%** & **90.28\%** & **64.70\%** & **85.90\%** & **88.10\%** & **29.82\%** & **44.54\%** & **20.42\%** & **21.52\%** & **26.88\%** & **25.12\%** & **57.06\%** \\   

Table 1: Transfer-based attack performance on ImageNet. The attacks are performed under the \(_{}\) constraint with \(=8/255\) in the untargeted setting.

achieves impressive improvements in attacking these models. For instance, compared with the I-FGSM baseline, when attacking the MLP-Mixer and ConvNeXt models, our ILPD obtains \(+20.82\%\) and \(+34.86\%\) absolute gains, respectively, and when attacking the vision transformers, our ILPD obtains an absolute gain of \(+19.14\%\).

**Attack robust models.** We also tested our method on the task of attacking robust models. We collected a robust Inception v3 and a robust EfficientNet-B0 from the timm  repository, and obtain a robust ResNet-50 and a robust DeiT-S  from Bai _et al._1 open-source repository 4 as the victim models. Adversarial examples generated on the ResNet-50 substitute model were applied for this experiment. Our ILPD is compared with DI\({}^{2}\)-FGSM, NAA, and ILA++, which are the most competitive methods in Table 3. It shows that our method outperforms competitors in attacking these robust models and getting \(+4.13\%\) improvement, compared with NAA, which is the second best method. In addition to the robust models, we also test our method on two advanced defense methods, _i.e._, random smoothing  and NRP . Specifically, our ILPD achieves a success rate of \(12.90\%\) in attacking a smoothed ResNet-50 on ImageNet, while the second best method (NAA) and the baseline show \(11.84\%\) and \(7.20\%\), respectively. For NRP, the adversarial examples generated by our method can achieve an average success rate of \(20.03\%\) after purification. Meanwhile, the second best method (DI\({}^{2}\)-FGSM) achieves \(14.54\%\), and the baseline achieves \(9.39\%\).

### Combination with Existing Methods

Our method can be readily combined with other attacks. In this section, we evaluate the combination performance. We tried combining our method with different sorts of attacks, including a gradient stabilization method, _i.e._, MI-FGSM  and two input augmentation methods, _i.e._, DI\({}^{2}\)-FGSM  and Admix . The results are reported in Table 4. It shows that the adversarial transferability can indeed be further improved by combining our method with these prior arts. Specifically, when combining with DI\({}^{2}\)-FGSM, the best average success rate, _i.e._, **63.23%**, is obtained.

   Method &  ResNet \\ -50 \\  &  ResNet \\ -152 \\  &  ResNet \\ -121 \\  &  WRN \\ -101 \\  &  Inception \\ v3 \\  &  RepVGG \\ -19 \\  &  VGG \\ -19 \\  &  Mixer ConvNeXt \\ -19 \\  &  ViT \\ -B \\  &  DeiT \\ -B \\  &  Swin \\ -B \\  &  BEiT \\ -B \\  & 
 Average \\  \\  MI-FGSM & 47.88\% & 25.98\% & 59.96\% & 56.26\% & 30.42\% & 43.22\% & 54.28\% & 13.36\% & 13.18\% & 6.74\% & 5.80\% & 7.68\% & 6.62\% & 28.57\% \\ +LPD & **84.90\%** & **72.22\%** & **91.74\%** & **91.42\%** & **69.44\%** & **87.66\%** & **89.12\%** & **34.62\%** & **48.00\%** & **24.20\%** & **25.36\%** & **29.16\%** & **30.02\%** & **59.84\%** \\  DI\({}^{2}\)-FGSM & 74.24\% & 47.20\% & 90.28\% & 84.76\% & 50.84\% & 77.44\% & 83.50\% & 18.62\% & 29.76\% & 12.82\% & 11.96\% & 13.92\% & 14.12\% & 46.88\% \\ +LPD & **85.26\%** & **74.62\%** & **92.40\%** & **91.36\%** & **74.42\%** & **88.74\%** & **90.10\%** & **37.98\%** & **53.42\%** & **29.50\%** & **31.22\%** & **35.32\%** & **37.70\%** & **63.23\%** \\  Admix & 63.52\% & 37.64\% & 71.94\% & 73.68\% & 31.84\% & 60.50\% & 70.92\% & 11.90\% & 15.14\% & 6.62\% & 5.10\% & 7.62\% & 6.24\% & 35.59\% \\ +LPD & **86.08\%** & **75.48\%** & **92.48\%** & **91.66\%** & **70.44\%** & **88.84\%** & **90.52\%** & **33.42\%** & **47.94\%** & **23.24\%** & **24.12\%** & **29.66\%** & **29.78\%** & **60.28\%** \\   

Table 4: Combination of our ILPD with MI-FGSM, DI\({}^{2}\)-FGSM, and Admix on ImageNet. The attacks use I-FGSM as the back-end attack and are performed under the \(_{}\) constraint with \(=8/255\) in the untargeted setting.

   Method &  Inception v3 \\ (robust) \\  &  EfficientNet \\ (robust) \\  &  ResNet-50 \\ (robust) \\  &  DeiT-S \\ (robust) \\  & 
 Average \\  \\  I-FGSM & 11.68\% & 10.88\% & 9.10\% & 10.56\% & 10.56\% \\ DI\({}^{2}\)-FGSM & 15.84\% & 34.04\% & 9.66\% & 11.02\% & 17.64\% \\ NAA & 22.86\% & 37.02\% & 10.80\% & 11.42\% & 20.53\% \\ ILA++ & 18.22\% & 34.62\% & 10.46\% & 11.40\% & 18.68\% \\ ILPD & **25.30\%** & **50.02\%** & **11.42\%** & **11.90\%** & **24.66\%** \\   

Table 3: Performance in attacking robust ImageNet models. The attacks are performed under the \(_{}\) constraint with \(=8/255\) in the untargeted setting.

### Ablation Study

**The effect of position.** As an intermediate-level attack, our method needs to choose a position to split \(f\) in \(h\) and \(g\). Such a position selection affects the performance of all intermediate-level attacks. We vary the position and compare our method with ILA++ , NAA , and LinBP  in Figure 5. The performance on ImageNet and CIFAR-10 are both tested, using ResNet-50 and VGG-19 as the substitute models, respectively. Apparently, our ILPD demonstrates consistently higher adversarial transferability on all choices of the position. In particular, our method significantly outperforms ILA++, NAA, and LinBP when choosing a lower layer to split \(f\) into \(h\) and \(g\). When using ResNet-50 as the substitute model, choosing any of the first eleven layers (_i.e._, from "0" to "3-3") can achieve an average success rate of more than \(53\%\) on ImageNet, even simply choosing the first layer will lead to an average success rate of \(53.12\%\), which is already superior to all competitors in Table 1.

**The effect of \(\).** We evaluate ILPD with varying \(\) on ImageNet and CIFAR-10 in Figure 6. The victim models are the same as the ones in Table 1 and Table 2. It can be seen that using \(1/<1\) always leads to improved performance compared with the baseline (which is equivalent to adopting \(1/=1\)). On ImageNet, the optimal performance is obtained with \(1/=0.1\) (_i.e._, \(=10\)) and ResNet-50, while, for CIFAR-10, \(1/=0.3\) (_i.e._, \(=10/3\)) is more effective. That is, on ImageNet, we aim to maximize the prediction loss of a perturbation which is cut by \(10\) in the middle layer. It is possible that employing \(>10\) leads to even better performance on ImageNet, yet we do not aim to carefully tune \(\) and would like to leave it to future work.

## 6 Conclusion

In this paper, we have revisited some intermediate-level attacks and shown that, limited by their two-stage training scheme, the obtained intermediate-level perturbations will deviate from the directional guides and such a deviation largely impairs the attack performance of the crafted adversarial examples. In order to overcome this limitation, we have developed a method that performs attacks through a single stage of optimization and guarantees the obtained intermediate-level perturbation possess a larger magnitude when compared with a directional guide and exactly follows its direction that can effectively increase the prediction loss of the model. The developed method is formed as adopting intermediate-level perturbation decay when computing gradients. Extensive experimental results on ImageNet and CIFAR-10 have shown that our method outperforms state-of-the-arts by large margins in attacking various victim models, including convolutional models, multi-layer perceptron model, vision transformers, and robust models. Moreover, we have shown that our method can be easily combined with prior methods to craft more transferable adversarial examples.

Figure 5: How the average success rate change with different choices of position on (a) ImageNet trained ResNet-50 and (b) CIFAR-10 trained VGG-19. For the ResNet-50 model, “0” represent the stem layer and “1-1” represent the first building block of the first ResNet meta layer.

Figure 6: How the average success rate changes with \(\) using (a) ImageNet trained ResNet-50 and (b) CIFAR-10 trained VGG-19 as the substitute models.

Acknowledgment

This material is based upon work supported by the National Science Foundation under Grant No. 1801751 and 1956364.