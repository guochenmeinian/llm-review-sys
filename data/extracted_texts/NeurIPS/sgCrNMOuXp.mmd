# Data Market Design through Deep Learning

Sai Srivatsa Ravindranath\({}^{*}\)   Yanchen Jiang\({}^{*}\)   David C. Parkes

Harvard John A. Paulson School of Engineering and Applied Sciences

{saisr, yanchen_jiang, parkes} @g.harvard.edu

Equal Contribution.

###### Abstract

The _data market design_ problem is a problem in economic theory to find a set of signaling schemes (statistical experiments) to maximize expected revenue to the information seller, where each experiment reveals some of the information known to a seller and has a corresponding price . Each buyer has their own decision to make in a world environment, and their subjective expected value for the information associated with a particular experiment comes from the improvement in this decision and depends on their prior and value for different outcomes. In a setting with multiple buyers, a buyer's expected value for an experiment may also depend on the information sold to others . We introduce the application of deep learning for the design of revenue-optimal data markets, looking to expand the frontiers of what can be understood and achieved. Relative to earlier work on deep learning for auction design , we must learn signaling schemes rather than allocation rules and handle _obedience constraints_--these arising from modeling the downstream actions of buyers--in addition to incentive constraints on bids. Our experiments demonstrate that this new deep learning framework can almost precisely replicate all known solutions from theory, expand to more complex settings, and be used to establish the optimality of new designs for data markets and make conjectures in regard to the structure of optimal designs.

## 1 Introduction

Many characterize the current era as the Information Age. Companies such as Google and Meta (search and social media), Experian and TransUnion (credit agencies), and Amazon and American Express (commerce) hold vast quantities of data about individuals. In turn, this has led to data markets, where information about an individual can be purchased in real-time to guide decision-making (e.g., LiveRamp, Segment, Bloomreach). In this paper, we advance the design of market rules that govern the structuring and sale of this kind of information. Using machine learning, we leverage existing theoretical frameworks  to replicate all known solutions from theory, expand to more complex settings, establish the optimality of new designs, and make conjectures in regard to the structure of optimal designs. Although this is not our focus, there are also important ethical questions in regard to data markets, in regard to privacy, ownership, informed consent, and the use of data .

In settings with a single buyer, Bergemann et al.  introduce a framework in which there is a _data buyer_ who faces a decision problem under uncertainty, and has a payoff depending on their choice of action and the underlying state of the world. There is a _data seller_ who knows the world state, and can disclose information through a menu of statistical experiments, each experiment offering a stochastic signal that reveals some (or all) of the seller's information and each of which is associated with a price. The buyer's willingness to pay for information is determined by their _type_, which defines their prior belief and their value for different outcomes in the world (these arising from the action that the buyer will choose to take).

The _optimal data market design problem_ is to find a set of experiments and associated prices with which to maximize expected revenue, given a distribution over the buyer's type. Bergemann et al.  characterize the optimal design when there is a binary world state and a buyer with a binary action. In some settings there may be multiple buyers and buyers may compete downstream, and the more informed one buyer is, the lower the payoff may become for others. Bonatti et al.  take up this problem, and characterize the optimal design for multiple buyers in the binary state/binary action setting, and further limited to buyers who each have a common prior on the world state. It remains an open problem to obtain theoretical results for richer, multi-buyer settings, and this motivates the need for gaining new understanding and making progress through computational approaches.

Contributions.Inspired by the recent advances in _differential economics_ ( etc.), we initiate the use of deep learning for the automated design of data markets. This market sells information rather than allocates resources, and the value of information depends on the way in which a buyer will use the information--and this downstream action by a buyer needs to be modeled. Following the _revelation principle for dynamic games_ (, Section 6.3), it is without loss of generality to model an experiment as generating a recommended action and insisting on designs in which the buyer will prefer to follow this action. This brings about new challenges, most notably to extend this framework to handle _obedience_. While the other aspect of incentive compatibility that we need to handle is more typical, i.e., that of achieving incentive alignment so that a buyer will choose to truthfully report their prior beliefs and values for different outcomes, we also need to ensure there are no useful _double deviations_, where a buyer simultaneously misreports their type and acts contrary to the seller's recommended action.

In settings with a single buyer, we learn an explicit, parameterized representation of a menu of priced experiments to offer the buyer and with which to model the action choices available to the buyer. In this way, we extend the _RochetNet architecture_ that has been used successfully for optimal auction design with a single buyer. This enables us to obtain exact incentive compatibility for the single buyer setting: a buyer has no useful deviation from a recommended action, no useful deviation in reporting their type, and no useful double deviation. In settings with multiple buyers, we seek to learn revenue-maximizing designs while also minimizing deviations in disobeying action recommendations and misreporting types and including double deviations. This extends the _RegretNet framework_ that has been used successfully for optimal auction design with multiple buyers and gives approximate incentive alignment.

Our first experimental result is to show through extensive experiments that these new neural network architectures and learning frameworks are able to almost exactly recover all known optimal solutions from Bergemann et al.  and Bonatti et al. . Following the economic theory literature on data market design, we consider the notion of Bayesian incentive compatibility (BIC). To handle this, we use samples of a buyer's type to compute an _interim_ experiment and _interim_ payment, averaging over samples drawn from the type distribution (this builds on the BIC methods for deep learning for auctions that were used in the context of differentiable economics for budget-constrained auctions ). We give a training method that enables the efficient reuse of computed _interim_ allocations and _interim_ payments from other samples to swiftly calculate the _interim_ utility of misreports, dramatically speeding up training.

Whereas analytical results are only available for the BIC setting, which is, in effect, lower-dimensional, and easier to analyze, we are able to study through computational techniques the design of data markets in the _ex post IC setting_, which is a setting without existing theory. A second result, in the setting of multiple buyers, is to use our framework to conjecture the structure of an optimal design and prove its optimality (for this, we make use of _virtual values_ analogous to Myerson's framework ). We see this as an important contribution, as _ex post IC_ is a stronger notion of IC than BIC.

A third result is to demonstrate how our framework extends its utility beyond empirical results and serves as a toolbox to guide economic theory. To illustrate this, we study how revenue varies with competition in the multi-buyer setting where the prior information is uncertain. Despite the absence of existing theoretical results for this particular setting, our framework enables us to derive trends in revenue effortlessly. We also conjecture the structure of solutions for problems in the single buyer setting with an enlarged type, where both the buyer payoffs and priors are uncertain. For this case, we again derive empirical results using our proposed framework and use it to conjecture the properties of the underlying theoretical solution.

Related work.Conitzer and Sandholm [20; 21] introduced the use of _automated mechanism design (AMD)_ for economic design and framed the problem as an integer linear program (or just a linear program for Bayesian design). Responding to challenges with the enumerative representations used in these early approaches, Dutting et al.  introduced the use of deep neural networks for auction design, attaining more representational flexibility. Since then, there has been a line of work on this so-called approach of _differentiable economics_, including to problems with budget-constrained bidders , for minimizing agents' payments , applying to multi-facility location problems , balancing fairness and revenue (), and applying to two-sided matching . To the best of our knowledge, none of this work has considered the setting of the design of optimal data markets, which introduce new challenges in regard to handling agent actions (obedience) as well as incorporating negative externalities.

In regard to the data market problem, Bergemann et al.  build upon the decision-theoretic model pioneered by Blackwell  and study a setting with a single buyer. Cai and Velegkas  also give computational results in this model, making use of linear programs to compute the optimal menu for discrete type distributions. They also investigate a generalization of this model that allows multiple agents to compete for useful information. In this setting, at most, one agent receives the information. While this approach can be used for continuous type distribution by applying the LP to a discretized valuation space, solving it for even a coarser discretization can be prohibitively expensive. Further advancing economic theory, Bergemann et al.  consider more general type distributions and investigate both the cardinality of the optimal menu and the revenue achievable when selling complete information. Bonatti et al.  also study the multi-buyer setting modeling competition through negative externality.

Babaioff et al.  give a related framework, with the key distinction that the seller is not required to commit to a mechanism before the realization of the world state. As a result, the experiments and prices of the data market can be tailored to the realized state of the world. Chen et al.  extend their setting, considering budget-constrained buyers, formulating a linear program to find the solution of the problem for a discrete type space.

There exist several other models that study revenue-optimal mechanisms for selling data. For example, Liu et al.  characterize the revenue-optimal mechanism for various numbers of states and actions, and considering general payoff functions. However, in their setup, the state only impacts the payoff of the active action taken by a buyer, which provides considerable simplification and may not be realistic. Li  investigates a setting where the buyer can conduct their own costly experiment at a cost after receiving the signal. Different from the model considered in this paper, after receiving the signal from the data broker, the agent can subsequently acquire additional information with costs. The model also assumed that the valuation function of the agent is separable and that the private type of the agent represents her value of acquiring more information, which is different from the single buyer model studied in this paper, where the prior belief is also drawn from a distribution and constitutes a part of the buyer's type. Agarwal et al.  explore data marketplaces where each of multiple sellers sells data to buyers who aim to utilize the data for machine learning tasks, and Chen et al.  consider scenarios where neither the seller nor the buyer knows the true quality of the data. Mehta et al.  and Agarwal et al.  also incorporate buyer externalities into the study of data marketplaces.

Another line of research studies problems of _information design_, for example, the problem of _Bayesian Persuasion_. There, the model is different in that the sender of information has preferences on the action taken by the receiver, setting up a game-theoretic problem of strategic misrepresentation by the sender. Dughmi and Xu  studied this from an algorithmic perspective, and Castiglioni et al.  also brought in considerations from mechanism design by introducing hidden types; see also , , and  for more work on information design and Bayesian persuasion.

## 2 Preliminaries

Model.We consider a setting with \(n\) data buyers, \(N=\{1,,n\}\), each facing a decision problem under uncertainty. The _state of the world_, \(\), is unknown and is drawn from a finite state space \(=\{_{1},_{m}\}\). Each buyer \(i\) can choose an _action_, from a finite set \(_{i}\). Let \(=_{i=1}^{n}_{i}\). The _ex post_ payoff to buyer \(i\) for choosing action \(a_{i}_{i}\) under state \(\) is given by \(_{i}(,a_{i})\). Unless otherwise specified, we consider the case of matching utility payoffs where the buyer seeks to match the state and the action 2. In such settings, we have \(||=|_{i}|\) for each \(i[n]\), and the payoff is given by \(_{i}(,a_{i})=v_{i}\{=a_{i}\}\) where each \(v_{i}\) is drawn independently from a distribution \(_{i}\). Let \(=_{i=1}^{n}_{i}\).

Each buyer \(i\) also has an _interim_ belief, \(_{i}()\), about the world state. Each buyer's belief, \(_{i}\), is drawn independently from a distribution \(_{i}\). Let \(=_{i=1}^{n}_{i}\). The _type_ of a buyer is given by the tuple \((v_{i},_{i})\) and is denoted by \(_{i}\). If the buyers don't vary in \(v_{i}\) or their interim beliefs \(_{i}\), then \(_{i}=_{i}\) or \(_{i}=v_{i}\), respectively. Let \(_{i}_{i}_{i}\). The utility of a buyer \(i[n]\) is given by the utility function \(u_{i}:_{i}\). We assume that the utility of buyer \(i\) depends only on its own type \(_{i}\) but can depend on other players' actions as a negative externality. Additionally, we follow  and assume that this externality is _separable_, thus simplifying our utility \(u_{i}(a,,_{i})=v_{i}\{a_{i}=\}-E_{-i}(a_{-i}, ,_{i})\). In this paper, we consider settings where the negative externality is given by \(E_{-i}(a_{-i},,_{i})=_{j[n]setminus i}v_{i }\{a_{j}=\}\) where \(_{ 0}\) where \(\) captures the degree of competitiveness among buyers. Let \(=\)

Statistical Experiments.There is a data seller who observes the world state and wishes to sell information to one or more buyers to maximize expected revenue. The seller cells information through signaling schemes, where each scheme is called an experiment. The seller chooses, for each buyer \(i[n]\), a set of signals \(_{i}\) and a signaling scheme \(_{i}:_{i}\). If state \(\) is realized, then the seller sends a signal drawn from the distribution \(_{i}()\). Upon receiving a signal, the buyers update their prior beliefs and choose an optimal action accordingly. The signaling scheme \(_{i}\) can also be represented as a matrix \(_{i}\) - a collection of \(m\) row vectors each of dimensions \(|_{i}|\). The \(j\)-th row vector (for \(j[m]\)) specifies the likelihood of each signal when state \(_{j}\) is realized. Thus we have \(_{i}(_{j})=_{i,j}\).

The Mechanism Design Problem.The mechanism design goal is to design a set of experiments and corresponding prices to maximize the expected revenue of the seller. Let \(\) denote a message (bid) space. Define the signaling schemes for a buyer \(i[n]\) as \(_{i}:_{i}\) and a payment function \(t_{i}:_{ 0}\). Given bids \(b=(b_{1}, b_{n})\), if state \(\) is realized, then the seller sends a signal drawn from the distribution \(_{i}(,b)\) to buyer \(i\) and collects payment \(t_{i}(b)\). The sequence of interactions between one or more buyers and the seller takes place as follows:

1. The seller commits to a mechanism, \(=(,t)\), where \(=(_{1},,_{n})\) is a choice and \(t=(t_{1},,t_{n})\).
2. Each buyer \(i\) observes their type, \(_{i}\). The seller observes the state, \(\).
3. Each buyer reports a message \(b_{i}\).
4. The seller sends buyer \(i\) a signal, \(S_{i}_{i}\), generated according to the signaling scheme \(_{i}(,b)\), and collects payment \(t_{i}(b)\).
5. Each buyer \(i\) chooses an action \(a_{i}_{i}\), and obtains utility \(u_{i}(a,,_{i})-t_{i}(b)\), where \(a=(a_{1},,a_{n})\).

By the revelation principle for dynamic games [43, Section 6.3], as long as we consider incentive-compatible mechanisms, it is without loss of generality for the message space to be the type space of buyers, and for the size of the signal space to be the size of the action space, i.e., for each \(i[n]\), \(|_{i}|=|_{i}|\). In such mechanisms, the seller designs experiments where every signal leads to a different optimal choice of action. Following , we can then replace every signal as an action recommended by the seller.

Incentive Compatibility.A mechanism \((,t)\) is _Bayesian incentive compatible_ (BIC) if the buyer maximizes their expected utility (over other agents' reports) by both reporting their true type as well as by following the recommended actions. For the sake of notational convenience, let \(}_{-i}:=_{_{-i}_{-i}}\) denote the operator used for computing the interim representations.

For each \((_{i},_{i}^{})_{i}^{2}\) and for each deviation function \(:_{i}_{i}\), a BIC mechanism satisfies:

\[}_{-i}[}_{a (,)\\ _{i}}[u_{i}(a,,)-t_{i}()]] }_{-i}[}_{a (;_{i}^{},_{-i})\\ _{i}}[u_{i}((a_{i}),a_{-i},,)-t_ {i}(_{i}^{},_{-i})]]\] (1)In particular, this insists that double deviations (misreporting the type and disobeying the recommendation) are not profitable.

We also consider the stronger notion of _ex post incentive compatible_ (IC), which requires, for every agent \(i\), and for each \(\), and assuming that every other agent reports its type truthfully and follows the recommended action, then for each misreport \(_{i}^{}_{i}\), and each deviation function, \(:_{i}_{i}\), the following condition:

\[a(,)\\ _{i}}{}[u_{i}(a,,)-t_{i}( )]^{},_{-i})}{}[u_{i}((a_{i}),a_{-i},,)-t_{i}(_{i}^{},_{- i})]\] (2)

Individual Rationality.A mechanism is _interindividually rational_ (IIR) if reporting an agent's true type guarantees at least as much expected utility (in expectation over other agents' reports) as opting out of the mechanism. Let \(_{-i}:_{-i}_{-i}\) denote the recommendations to other participating buyers when buyer \(i\) opts out. For each agent \(i\), and each \(_{i}_{i}\), IIR requires

\[}_{-i}[a(; )\\ _{i}}{}[u_{i}(a;,)-t_{i}( )]]_{i}_{i}}{}( }_{-i}[a_{-i}_{-i} (;_{-i}),\\ _{i}}{}[u_{i}(_{i},a_{-i}; ,)]])\] (3)

It is in the seller's best interest to instantiate the recommendation function to the other buyers when buyer \(i\) opts out, \(_{-i}\), to minimize the value of the RHS of this IIR inequality. For this reason, it is without loss of generality to rewrite the above equation as:

\[}_{-i}[a(; )\\ _{i}}{}[u_{i}(a;,)-t_{i}( )]]}{}_{i} _{i}}{}(}_{-i}[ {c}a_{-i}(;_{-i})\\ _{i}}{}[u_{i}(_{i},a_{-i}; ,)]])\] (4)

In particular, and recognizing that a buyer's utility decreases the more informed other buyers are, the seller can achieve this by sending optimal recommendations to participating buyers in order to minimize the utility of a non-participating buyer.

We also consider a stronger version of IR, namely _ex post individual rationality_ (or simply IR). In this case, for each agent \(i\), and each \(\), we require:

\[a(;)\\ _{i}}{}[u_{i}(a;,)-t_{i}( )]}{}_{i}_{ i}}{}(a_{-i}(;_{-i}),\\ _{i}}{}[u_{i}(_{i},a_{-i}; ,)])\] (5)

## 3 Optimal Data Market Design in the Single-Buyer Setting

In this section, we formulate the problem of optimal data market design for a single buyer as an unsupervised learning problem. We study a parametric class of mechanisms, \((^{w},t^{w})\), for parameters, \(w^{d}\), where \(d>0\). For a single buyer, the goal is to learn parameters \(w\) that maximize \(_{}[t^{w}()]\), such that \((^{w},t^{w})\) satisfy _ex post_ IC and IR.3 By adopting differentiable loss functions, we can make use of tools from automatic differentiation and stochastic gradient descent (SGD). For notational convenience, we drop the subscript in this case, as there is only one buyer.

Neural Network Architecture.For the single buyer setting, any IC mechanism can be represented as a menu of experiments. For this, we extend the RochetNet architecture to represent a menu of priced statistical experiments. Specifically, the parameters correspond to a menu of \(P\) choices, where each choice \(p[P]\) is associated with an experiment, with parameters \(^{p}^{|||A|}\), and a price, \(^{p}\). Given this, we define a _menu entry_ as,

\[^{p}_{,j}=_{,j})}{_{k[m]}( ^{p}_{,k})}, t^{p}=^{p}\] (6)The input layer takes \(=(v,)\) as input and the network computes the \(P\) utility values corresponding to each menu entry. We do not impose obedience constraint explicitly. However, while computing the utility of a menu, we take into consideration the best possible deviating action an agent can take. From the perspective of buyer, if action \(k\) is recommended by an experiment choice \(p\), then \(Pr[=j|a_{k},]=_{j,k}^{p}}{Pr[s_{k}]}\). The best action deviation is thus \((k)=_{j[m]}_{j,k}^{p}}{Pr[s_{k}]}\), yielding a utility of \(v_{j[m]}_{j,k}^{p}}{Pr[s_{k}]}=_{j}_{j,k}^{p}}{Pr[s_{k}]}\). Taking an expectation over all signals, buyer \(i\) receives the following utility for the choice \(p[P]\):

\[h^{p}()=v(_{k[m]}max_{j[m]}\{_{j}_{j,k}^{p} \})-^{p}\] (7)

We also include an additional experiment, \(^{0}\), which corresponds to a _null experiment_ that generates the same signal regardless of state, and thus provides no useful information. This menu entry has a price of \(t^{b}=0\), and thus \(h^{0}()=v(_{j[m]}_{j})\). In particular, this menu entry has the same utility as that of opting out.

**Lemma 3.1**.: _Let \(p^{*}()=_{p\{0, P\}}h^{p}()\) denote the optimal menu choice. Then the mechanism \(=(^{w},t^{w})\) where \(^{w}(,)=_{}^{p^{*}()}\) and \(t^{w}()=t^{p^{*}()}\) satisfies IC and IR._

This mechanism is IC as it is agent optimizing, and is IR as it guarantees a buyer at least the utility of opting out.

**Training Problem.**  The expected revenue of such an IC and IR mechanism that is parameterized by \(,\) is given by \(_{}[^{p^{*}()}]\). Rather than minimizing a loss function that measures errors against ground truth labels (as in a supervised learning setting), our goal is to minimize expected negated revenue. To ensure that the objective is differentiable, we replace the argmax operation with a softmax during training. The _loss function_, for parameters \(\) and \(\), is thus given by \((,)=_{}[-_{p=1}^{ P}^{p}^{p}()]\) where \(^{p}()=(()}{},,()}{})\), and \(>0\) controls the quality of approximation. Note that, at test time, we revert to using the hard max, so as to guarantee exact IC and IR from a trained network.

During training, this null experiment \((^{0},t^{0})\) remains fixed, while the parameters \(^{p[] m}\) and \(^{p}\) are optimized through SGD on the empirical version of the loss calculated over \(\) i.i.d samples \(=\{^{(1)},^{()}\}\) drawn from \(\). We report our results on a separate test set sampled from \(\). We refer to the Appendix A.2 for more details regarding the hyperparameters.

## 4 Optimal Data Market Design in the Multi-Buyer Setting

In the multi-buyer setting, the goal is to learn parameters \(w^{d}\) that maximize \(_{}[_{i=1}^{n}t_{w}^{i}()]\), for a parametric class of mechanisms, \((^{w},t^{w})\), such that \((^{w},t^{w})\) satisfy IC (or BIC) and IR (or IIR). By restricting our loss computations to differentiable functions, we can again use tools from automatic differentiation and SGD. For the multi-buyer setting, we use differentiable approximations to represent the rules of the mechanism and compute the degree to which IC constraints are violated during training adopting an augmented Lagrangian method .

Neural Network Architecture.The neural network architecture has two components: one that encodes the experiments and another that encodes payments. We model these components in a straightforward way as feed-forward, fully connected neural networks with Leaky ReLU activation functions. The input layer consists of the reported type profile, \(\), encoded as a vector. For both IC and BIC settings, the component that encodes experiments outputs a matrix \(\) of dimensions \(n||||\), which represents an experiment that corresponds to each of the \(n\) agents. In order to ensure feasibility, i.e., the probability values of sending signals for each agent under each state realization is non-negative and sums up to 1, the neural network first computes an output matrix, \(\), of the same dimension. For all \(i,j,\), we then obtain \(_{i,,j}\) by computing \((_{i,,j})/_{k}(_{i,,k})\).

For the setting of IC (vs. BIC), we define payments by first computing a _normalized payment_, \(_{i}^{w}()\), for each buyer \(i\), using a sigmoid activation unit. The payment \(t_{i}^{w}()\) is computed as follows:

\[t_{i}^{w}()=_{i}^{w}() v_{i}(_{k[m]}_{i, k,k}^{w}()_{i,k}-_{k[m]}_{j[n] i}_{j, k,k}^{w}()_{j,k}-(_{i}-))\] (8)

**Lemma 4.1**.: _Any mechanism \(=(^{w},t^{w})\) where \(_{i}^{w}(,)=(_{i,}^{w}())\) and \(t^{w}\) satisfies Eqn 8 is ex post IR constraint for any \(w^{d}\)._

For the BIC setting we only need to compute the _interim_ payment, as we can replace \(_{_{-i}_{-i}}[t_{i}(_{i},_{-i})]\) by \(t_{i}(_{i})\). For this, we compute an interim normalized payment, \(_{i}\), for each buyer \(i\) by using a sigmoid unit. We compute the _interim_ payment as:

\[t_{i}^{w}(_{i})=_{i}^{w}(_{i}) v_{i} }_{-i}[_{k[m]}_{i,k,k}^{w}()_{i,k}- _{k[m]}_{j[n] i}_{j,k,k}^{w}() _{j,k}-(_{i}-)]\] (9)

**Lemma 4.2**.: _Any mechanism \(=(^{w},t^{w})\) where \(_{i}^{w}(,)=(_{i,}^{w}())\) and \(t^{w}\) satisfies Eqn 9 is interim IR for any \(w^{d}\)._

Training Problem.In order to train the neural network, we need to minimize the negated revenue subject to incentive constraints. Following Dutting et al. , we measure the extent to which a mechanism violates the IC (or BIC) constraints through the notion of _ex post_ regret (or interim regret) and then appeal to Lagrangian optimization. The regret for an agent is given by the maximum increase in utility, considering all possible misreports and all possible deviations for a given misreport in consideration while fixing the truthful reports of others (or in expectation over truthful reports of others for the BIC setting) when the others are truthful and obedient.

We define the _ex post_ regret for a buyer \(i\) as \(RGT_{i}^{w}=_{}[_{^{}_{i} _{i}}rgt_{i}^{w}(^{}_{i},)]\) where \(rgt_{i}^{w}(^{}_{i},)\) is defined as:

\[rgt_{i}^{w}(^{}_{i},)=v_{i}(_{k[m]}_{k^{ }[m]}\{_{i,k^{},k}^{w}(^{}_{i},_{-i}) _{i,k^{}}\}-_{k[m]}_{j[n] i }_{j,k,k}^{w}(^{}_{i},_{-i})_{j,k})\]

\[-v_{i}(_{k[m]}_{i,k,k}^{w}()_{i,k}- _{k[m]}_{j[n] i}_{j,k,k}^{w}()_{j,k} )-(t_{i}^{w}(^{}_{i},_{-i})-t_{i}^{w}())\] (10)

**Lemma 4.3**.: _Any mechanism \(=(^{w},t^{w})\) where \(_{i}^{w}(,)=(_{i,}^{w}())\) is ex post IC if and only if \(RGT_{i}^{w}=0\  i[n]\), except for measure zero events._

We define the _interim_ regret for a buyer \(i\) as \(_{i}^{w}=_{}[_{^{ }_{i}_{i}}_{i}^{w}(^{}_{i},_{i})]\) where \(_{i}^{w}(^{}_{i},_{i})\) is defined as:

\[_{i}^{w}(^{}_{i},_{i})=v_{i} (_{k[m]}_{k^{}[m]}}_{-i}[_{i, k^{},k}^{w}(^{}_{i},_{-i})_{i,k^{}}-_{j[n] i}_{j,k,k}^{w}(^{}_{i},_{-i}) _{j,k}])\] \[-v_{i}}_{-i}[_{k[m]}_{i,k,k}^{ w}(_{i},_{-i})_{i,k}-_{k[m]}_{j[n]  i}_{j,k,k}^{w}(_{i},_{-i})_{j,k}]-(t_{i}( ^{}_{i})-t_{i}(_{i}))\] (11)

**Lemma 4.4**.: _Any mechanism \(=(^{w},t^{w})\) where \(_{i}^{w}(,)=(_{i,}^{w}())\) is interim IC if and only if \(_{i}^{w}=0\  i[n]\), except for measure zero events._

Given regret, we compute the Lagrangian objective on the empirical version of loss and regret over samples \(=\{^{(1)},,^{(L)}\}\). We solve this objective using augmented Lagrangian optimization.

The BIC setting also involves an inner expectation to compute the interim representations. There, for each agent \(i\), we sample a separate subset \(_{-i}=\{_{-i}^{(1)},,_{-i}^{(K)}\}\), and replace the inner expectations with an empirical expectation over these samples. We sample several misreports, compute the best performing misreport among these samples, and use this as a warm-start initialization for the inner maximization problem. For the BIC setting, rather than sampling fresh misreports and computing the interim experiments and payments, we re-use the other samples from the minibatch and their already computed interim values to find the best initialization. This leads to a dramatic speed-up as the number of forward passes required to compute the regret reduces by an order magnitude of the number of initialized misreports. This, however, works only for the BIC setting, as the constraints are only dependent on the interim values.

We report all our results on a separate test set sampled from \(\). Please refer to Appendix B.6 for more details regarding the hyperparameters.

## 5 Experimental Results for the Single Buyer Setting

In this section, we demonstrate the use of RochetNet to recover known existing results from the economic theory literature. Additionally, we also show how we can use this approach to conjecture the optimal menu structure for settings outside the reach of current theory. Further, we give in the Appendix C.2 representative examples of how we can characterize the differential informativeness of the menu options when we change different properties of the prior distribution. This builds economic intuition in regard to the shape of optimal market designs.

Buyers with world prior heterogeneity.

We first show that RochetNet can recover the optimal menu for all the continuous distribution settings considered in  where the input distributions are a continuum of types. We specifically consider the following settings with binary states and binary actions with payoffs \(v=1\) and interim beliefs drawn from:

1. an unit interval, i.e, \( U\).
2. an equal weight mixture of \((8,30)\) and \((60,30)\).

The optimal menus for each of these settings are given by . For the first setting, the optimal menu consists of a fully informative experiment with a price of \(0.25\). For the second setting, the seller offers two menu options: a partially informative experiment and a fully informative experiment. In each case, RochetNet recovers the exact optimal menu. We describe the optimal menus, associated prices, revenue, and RochetNet revenue in the Appendix C.1.

We also give the results from additional experiments in Appendix C.2, where we demonstrate how the informativeness of the menu \(q\) changes, as we vary different properties of the economic environment.

Buyers with payoff and world prior heterogeneity.

We are aware of no theoretical characterization of optimal data market designs when both \(v\) and \(\) vary. In such cases, we can use RochetNet to conjecture the structure of an optimal solution. For this, we consider the following settings with enlarged buyer types with binary states and binary actions with:

1. \(v U\) and the interim beliefs are drawn from \(U\).
2. \(v U[c,1]\) and the interim beliefs are drawn from an equal weight mixture of \((8,30)\) and \((60,30)\) for \(c\).

For Setting C, RochetNet learns a menu consisting of a single fully informative experiment with a price of \(0.14\). For Setting D, RochetNet learns a menu consisting of a single fully informative experiment when \(c<0.55\). For higher values of \(c\), RochetNet learns an additional partially informative menu option. In Figure 1, we show how the differential informativeness \(q\) of the partially informative menu changes with \(c\).

Figure 1: The differential informativeness \(q\) of the menu(s) learned by RochetNet for Setting D, varying the parameter \(c\) that instantiates the economic environment.

## 6 Experimental Results for the Multi-Buyer Setting

In this section, we show how we can use RegretNet to recover known existing results for the multi-buyer, BIC setting. We also use RegretNet to conjecture the optimal solution for a multi-buyer problem in the _ex post_ IC setting, and then prove the optimality of the design. Lastly, we give results for a setting where it is analytically hard to compute the optimal solution but RegretNet is used to understand how revenue varies with changes to the intensity of negative externality, again building economic intuition for the market design problem.

**BIC settings.**  study the multi-buyer market design problem with two buyers, binary actions, and fixed interim beliefs, the same for each agent. They show that a deterministic signaling scheme is optimal, and thus characterize their solution in terms of recommending a correct action (selling a fully informative menu). Since the obedience constraints are defined on the interim representation, the optimal mechanism is also able to sometimes recommend incorrect actions to a buyer (in effect sending recommendations that are opposed with the realized state).

We consider the following settings from  with interim beliefs are given by \(_{1}=_{2}=(0.5,0.5)\) and \(=0.5\) and:

* The payoffs \(v_{1},v_{2}\) are sampled from the unit interval \(U\).
* The payoffs \(v_{1},v_{2}\) are sampled from the exponential distribution with \(=1\).

The results for these settings with a BIC constraint are shown in Figure 2 (top). The theoretically optimum solution contains two kinds of recommendations, those recommending the correct action (the optimal action to take given the realized state), and those recommending incorrect actions, separated by the black solid lines. The heatmap showed in the plots denotes our computational results, which show the probability of recommending the correct action. In particular, we can confirm visually (and from its expected revenue) that RegretNet is able to recover the optimal revenue as well the optimal experiment design. The test revenue and regret along with additional results are in Appendix D.1.

**Ex post IC settings.** We apply RegretNet to the same three settings, but now adopting _ex post_ IC constraints. This is of interest because there is no known analytical solution for the optimal mechanism for two buyers in the _ex post_ IC setting. See Figure 2 (bottom). Based on this, and additional experiments (in Appendix D.2 ), we were able to conjecture that the structure of the optimal design in this ex post IC setting, and we prove its optimality by following Myerson's framework for single item auctions. We defer the proof to the appendix D.4.

Figure 2: Experiments learned for Settings E and F, for BIC constraints (**top**) and _ex post_ IC constraints (**bottom**). The plot shows the probability of recommending the correct action to buyer \(1\) (left subplot) and buyer \(2\) (right subplot) for varying values of \(v_{1}\) (x-axis) and \(v_{2}\) (y-axis). For each setting, the theoretically optimal experiments are represented by solid lines separating the regions.

**Theorem 6.1**.: _Consider the setting with Binary State and Binary Actions where the buyers have a common interim belief \(_{i}=\). The payoff \(v_{i}\) for a buyer \(i\) is drawn from a regular distribution \(_{i}\) with a continuous density function. Define virtual value \(_{i}(v_{i})=v_{i}-)}{f(v_{i})}\), for pdf \(f\) and cdf \(F\) of distribution \(_{i}\). The revenue-optimal mechanism satisfying ex post IC and IR is a mechanism that calls the fully informative experiment to buyer \(i\) if \(_{i}(v_{i})_{i j}_{j}(v_{j})\). Otherwise buyer \(i\) receives an uninformative menu, where the signal corresponds to the most likely state based on the prior._

Studying the effect of varying the intensity of externalities.Following , we study the effect of the negative externality parameter \(\) on the revenue for the BIC, multi-buyer setting with a common and known prior for each buyer and payoffs sampled from \(U\). We also consider the case where the payoffs are constant but the interim beliefs are independently sampled from \(U\). While there is no known analytical characterization for the latter, we show how easy it is to study the models learnt by RegretNet to analyze economic properties of interest. Figure 3 shows the effect of \(\) on the revenue. In the context of uncertain priors, we note that the effect on revenue is similar to the setting where payoffs are uncertain. As we enhance competition intensity via \(\), the revenue grows. Even though the buyers are not recommended the correct action, the seller manages to generate revenue by threatening to share exclusive information with a competitor. This effect becomes fiercer in the settings with uncertain priors.

## 7 Conclusion

We have introduced a new deep neural network architecture and learning framework to study the design of optimal data markets. We have demonstrated through experimental work the flexibility of the framework, showing that it can adapt to relatively complex scenarios and facilitate the discovery of new optimal designs. Note that while we have only considered matching utility payoffs in this paper, our approach can easily be extended to non-matching utility payoffs as well.

We also point out some limitations. First, for our approach to continue to provide insights into the theoretically optimal design for larger problems (e.g., with more buyers, more signals, more actions), it will be important to provide interpretability to the mechanisms learned by RegretNet (designs learned by RochetNet, on the other hand, are immediately interpretable). Second, while our approach scales well with the number of buyers or states in the _ex post IC_ setting, it does not scale as easily with the number of buyers in the BIC setting. The challenge in the BIC setting comes from the interim computations involving conditional expectations over reports of others and scaling beyond what is studied in this paper will require new techniques, for example, exploiting symmetry. Third, we are making use of gradient-based approaches, which may suffer from local optima in non-convex problems. At the same time, deep learning has shown success in various problem domains despite non-convexity. The experiments reported here align with these observations, with our neural network architectures consistently recovering optimal solutions, when these are known, and thus optimality can be verified, and despite non-convex formulations. Fourth, we attain in the multi-buyer setting only approximate, and not exact, incentive alignment, and this leaves the question of how much alignment is enough for agents to follow the intended advice of a market design (there is little practical or theoretical guidance in this regard). Moreover, we do not know for a given solution whether there is an exact IC solution nearby. While there is some recent guiding theory [22; 26; 15] that provides transformations between \(\)-BIC and BIC without revenue loss in the context of auction design, extending these transformations to approximate IC settings and to problems with both types and actions presents an interesting avenue for future research.

Lastly, we return to where we started, and underline that markets for trading data about individuals raise substantive ethical concerns [1; 2; 5; 8; 11; 19; 33]. Our hope is that machine learning frameworks such as those introduced here can be used to strike new kinds of trade-offs, for example allowing individuals to also benefit directly from trades on data about themselves and to embrace privacy and fairness constraints.

Figure 3: Effect of \(\) on revenue