# Attack-Resilient Image Watermarking

Using Stable Diffusion

 Lijun Zhang

University of Massachusetts

Amherst, MA 01003-9264

lijunzhang@cs.umass.edu

&Xiao Liu

University of Massachusetts

Amherst, MA 01003-9264

xiaoliu1990@umass.edu

&Antoni Viros Martin

IBM Watson

Yorktown Heights, NY 10598

aviros@ibm.com

Cindy Xiong Bearfield

Georgia Institute of Technology

Atlanta, GA 30332

cxiong@gatech.edu

&Yuriy Brun

University of Massachusetts

Amherst, MA 01003-9264

brun@cs.umass.edu

&Hui Guan

University of Massachusetts

Amherst, MA 01003-9264

huiguan@cs.umass.edu

###### Abstract

Watermarking images is critical for tracking image provenance and proving ownership. With the advent of generative models, such as stable diffusion, that can create fake but realistic images, watermarking has become particularly important to make human-created images reliably identifiable. Unfortunately, the very same stable diffusion technology can remove watermarks injected using existing methods. To address this problem, we present ZoDiac, which uses a pre-trained stable diffusion model to inject a watermark into the trainable latent space, resulting in watermarks that can be reliably detected in the latent vector even when attacked. We evaluate ZoDiac on three benchmarks, MS-COCO, DiffusionDB, and WikiArt, and find that ZoDiac is robust against state-of-the-art watermark attacks, with a watermark detection rate above \(98\%\) and a false positive rate below \(6.4\%\), outperforming state-of-the-art watermarking methods. We hypothesize that the reciprocating denoising process in diffusion models may inherently enhance the robustness of the watermark when faced with strong attacks and validate the hypothesis. Our research demonstrates that stable diffusion is a promising approach to robust watermarking, able to withstand even stable-diffusion-based attack methods. ZoDiac is open-sourced and available at https://github.com/zhanglijun95/ZoDiac.

## 1 Introduction

Digital image watermarking, a technique for subtly embedding information within digital images, has become increasingly crucial and beneficial in the context of content protection and authenticity verification . The advance in generative AI technologies , such as stable diffusion, further underscores the need for watermarking solutions to distinguish between AI-generated and human-created images.

Given an existing image, many methods have been proposed to embed a watermark that is invisible and robust to watermark removal attacks. Conventional watermarking strategies have employed various methods, such as embedding information in texture-rich regions , manipulating the least significant bits , or utilizing the frequency domain . The emergence of deep learning has introduced neural network (NN)-based watermarking methods , which have shown promise in achieving high invisibility and robustness against traditional attacks, such as adding Gaussian noise or applying JPEG compression.

Unfortunately, the recent advent of powerful image generation techniques can circumvent existing watermarking methods. The most recent work  shows that stable diffusion can be used in a watermark removal attack, and none of the existing watermarking techniques are robust enough to that attack. Figure 1 shows that the watermark detection rate (WDR) of six existing watermarking methods (DwtDct, DwtDctSvd , RivaGAN , SSL , CIN , StegaSTamp ) before and after the stable-diffusion-based watermark removal attack  drops from 79%-100% before attack to only 0%-48% after attack on the MS-COCO dataset .

To address the problem, we propose a novel stable-diffusion-based watermarking framework called ZoDiac. ZoDiac takes as input an existing image and uses a pre-trained stable diffusion model to inject into the image a watermark that can be reliably detected even when attacked. The rationale behind ZoDiac is that a pre-trained stable diffusion maps a latent vector into an image and that _more than one latent vector can be mapped to perceptually the same image_. Given an existing image, ZoDiac identifies a latent vector that contains a watermark pattern and can also be mapped to the same image using a pre-trained stable diffusion model. ZoDiac further allows mixes of the original image and the watermarked image to enhance image quality with a minor influence on watermark robustness. To detect watermarks, ZoDiac applies a diffusion inversion process that remaps the image to the latent vector and then detects the watermark pattern in the latent vector by statistical test. Recent trend [11; 15; 42] has used diffusion models for watermarking, but it can only encode a watermark into synthetically-generated images when they are being generated. By contrast, ZoDiac can watermark existing and real-world images.

ZoDiac has two distinctive features that make it robust and effective. First, ZoDiac injects watermarks in the latent space that stable diffusion models operate on when sampling random noise to generate synthetic images, making the watermarks both invisible and robust to even the most advanced stable-diffusion-based attack method. We hypothesize that ZoDiac exhibits strong robustness because the image generation process of the diffusion model serves as a powerful attack-defense mechanism by default and empirically validate it in SS4.3. Second, while existing watermarking methods typically require the training of a dedicated model on a representative training dataset, ZoDiac builds on top of pre-trained stable diffusion models, forgoing the time-consuming training process.

Our main contributions are:

* _ZoDiac_ -- a novel framework for embedding invisible watermarks into existing images using pre-trained stable diffusion. To the best of our knowledge, ZoDiac is the first watermarking method that is robust to the most advanced generative AI-based watermark removal attack.
* _Empirically Demonstrated Strong Robustness Against Watermark Attacks_ -- Our evaluation on images from diverse domains, MS-COCO , DiffusionDB , and WikiArt  datasets, shows that ZoDiac is robust against the state-of-the-art watermark attack mechanism, with watermark detection rate (i.e., true positive rate) above \(98\%\) and false positive rate below \(6.4\%\), outperforming state-of-the-art watermarking methods. ZoDiac also maintains invisible image quality degradation, underscoring its efficacy in achieving robust watermarking with quality preservation (see examples in Figure 1).
* _Robustness Against Combined Attacks_ -- Prior watermarking method evaluations [42; 51] focused on robustness to only a single attack at a time. We show that in a more realistic scenario, where the attacker can combine multiple attacks, ZoDiac significantly outperforms all existing methods. For example, when combining all attacks other than image rotation, ZoDiac retains a detection rate above \(50\%\) while all existing methods fail with a detection rate of \(0\%\). Only one of the existing methods, SSL , is effective against rotation, but it is ineffective against other attacks. We propose a method for making ZoDiac robust to rotation (above \(99\%\)), only slightly increasing its false-positive rate (from \(0.4\%\) to \(3.4\%\)) on MS-COCO dataset with appropriate hyperparameter settings.

Figure 1: The watermark detection rate of existing methods and our ZoDiac before and after the diffusion-based attack _Zhao23_. Two example images show that ZoDiacâ€™s watermarks are perceptually invisible.

Preliminary and Related Work

We first introduce the image watermarking problem and then the diffusion model background necessary to understand ZoDiac. We place our work in the context of the most related research; Appendix A discusses related work in depth.

**The Robust Image Watermarking Problem.** Image watermarking aims to embed a predefined, detectable watermark into an image while ensuring that the watermarked image is similar to the original. This similarity is usually quantified using metrics such as the Peak Signal-to-Noise Ratio (PSNR) and the Structural Similarity Index (SSIM) . Malicious attacks can attempt to remove the watermark, again, without significantly changing the image. A _robust_ image watermarking method should be able to detect the watermark even in attacked images.

Both image watermarking and watermark removal attacks have been studied extensively. The development of deep neural networks (DNN) resulted in advanced learning-based watermarking approaches, such as RivaGAN , StegaStamp , and SSL . These methods train a dedicated DNN model on large-scale representative image datasets to watermark images. Meanwhile, advances in generative AI techniques have produced new attacks based on Variational AutoEncoders [2; 8] and Stable Diffusion . None of the existing watermarking approaches are sufficiently robust to these advanced diffusion-based attacks.

**Diffusion Models and DDIM Inversion.** Diffusion models , which both the most sophisticated attacks and our approach build on, are a class of generative AI models that generate high-resolution images. To explain diffusion models, we first explain the forward diffusion process, in which a data point sampled from a real data distribution \(x_{0} q(x)\) is gradually converted into a noisy representation \(x_{T}\) through \(T\) steps of progressive Gaussian noise addition. This transformation yields \(x_{T}\) as an isotropic Gaussian noise, i.e., \(x_{T}(,)\). Specifically, a direct generation of \(x_{t}\) from \(x_{0}\) is:

\[x_{t}=_{t}}x_{0}+_{t}},\] (1)

where \(_{t}=_{i=0}^{t}(1-_{i})\), \(_{i}(0,1)\) is the scheduled noise variance that controls the step size, and \((0,)\).

Diffusion models reverse this forward process, learning to retrieve the original image \(x_{0}\) from the noise \(x_{T}\) by estimating the noise at each step and iteratively performing denoising. The Denoising Diffusion Implicit Model (DDIM)  is a prominent denoising method, known for its efficiency and deterministic output. Formally, for each denoising step \(t\), a learned noise predictor \(_{}\) estimates the noise \(_{}(x_{t})\) added to \(x_{0}\), leading to an approximate of \(x_{0}\). Then DDIM reintroduces \(_{}(x_{t})\) to determine \(x_{t-1}\):

\[x_{t-1}{=}_{t-1}}(_{t} }_{}(x_{t})}{_{t}}}){+}_{t-1}}_{}(x_{t}).\] (2)

In this way, DDIM could deterministically recover the same image \(x_{0}\) from the specified noise \(x_{T}\). DDIM also enables an inversion mechanism  that can reconstruct the noise \(x_{T}\) from an image \(x_{0}\). DDIM inversion adheres to the forward diffusion process in Eq. (1), substituting \(_{t}\) with \(_{}(x_{t})\) at each timestep.

We denote the denoising process, that is, the image generation process as \(\) and its inversion as \(^{}\). A stable diffusion model  operates in the latent space. We use \(_{T}\) and \(_{0}\) in the latent space to represent the noise \(x_{T}\) and the image \(x_{0}\) respectively. A pre-trained Variational Autoencoder (VAE) carries out the transformation between the noise \(x_{T}\) and its latent vector \(_{T}\) (and also the image \(x_{0}\) and its representation \(_{0}\)). Throughout this paper, we refer to \(_{T}\) as the _latent vector_.

## 3 The ZoDiac Watermarking Framework

This section introduces ZoDiac, our novel watermarking technique that uses pre-trained stable diffusion models to achieve watermark invisibility and strong robustness to attacks. The core idea is to _learn_ a latent vector that encodes a pre-defined watermark within its Fourier space, and can be mapped by pre-trained stable diffusion models into an image closely resembling the original.

### Overview of ZoDiac

Figure 2 illustrates both the watermark embedding and detection phases of the ZoDiac framework. We first explain the high-level idea, and then SS3.2 and 3.3 detail each step.

**Watermark Embedding.** Watermark embedding consists of three main steps, _latent vector initialization_, _watermark encoding_, and _adaptive image enhancement_. Algorithm 1 lists the pseudocode for watermark embedding.

```
0: original image \(x_{0}\), watermark \(\)
0: pre-trained diffusion model \(\), and its inversion \(^{}\)
0: diffusion steps \(T\), latent update steps \(N\)
0: SSIM threshold \(s^{*}\)
0: watermarked image \(_{0}\)
1:\(_{T}^{}(x_{0})\)
2:for\(i=1\) to \(N\)do
3:\(_{0}(_{T})\)
4: Take gradient descent on \(_{_{T}}(x_{0},_{0})\) {Eq. (6)}
5:endfor
6:\(_{0}=_{0}+(x_{0}-_{0})\) {Eq. (7)}
7: Search \(^{*}\) s.t. \(S(_{0},x_{0}) s^{*}\) {Eq. (8)}
8:return\(_{0}\) ```

**Algorithm 1** ZoDiac-Watermarking

**Watermark Detection.** Watermark detection detects watermarks. ZoDiac first reconstructs the latent vector of the image under inspection via DDIM inversion, transforms the latent vector into the Fourier space, and then conducts a statistical test to detect a potential watermark (SS3.3).

Figure 2: Overview of ZoDiac with watermark embedding and detection phases. There are three major steps in the embedding phase: 1) latent vector initialization, 2) watermark encoding, and 3) adaptive image enhancement. In the detection phase, the watermark is decoded by performing DDIM inversion, Fourier transformation, and statistical testing.

### Watermark Embedding

#### 3.2.1 Latent Vector Initialization

Finding a good initialization for the latent vector \(_{T}\) allows a stable diffusion model to reproduce the original image \(x_{0}\) rapidly, and is thus critical to reducing the time spent on optimizing that latent vector. ZoDiac employs DDIM inversion to initialize the latent vector \(_{T}=^{}(x_{0})\), from which DDIM can then remap to the original image. Empirically, we find that using a randomly initialized latent vector can require hundreds of iterations when remapping, while using an initial latent vector from DDIM inversion converges in dozens of iterations while achieving a higher image quality (see details in Appendix B.1).

#### 3.2.2 Watermark Encoding

The watermark encoding step aims to encode a watermark into an image with minimal impact on its visual quality. ZoDiac injects the watermark into the Fourier Space of the initialized latent vector from SS3.2.1, and then optimizes the watermarked latent vector to ensure that it can be used to synthesize an image resembling the original. Our fundamental insights are two-fold: (1) injecting watermarks into the latent space of images can effectively improve the watermark robustness thanks to the potential attack-defense capability provided by the diffusion process (see SS4.3); (2) injecting watermarks into the Fourier representation of a latent vector helps preserve the quality of the watermarked image (see Appendix B.7).

**Watermark Injection.** ZoDiac injects a concentric ring-like watermark into the Fourier space of the latent vector, leading to a circularly symmetric watermark embedding in the low-frequency domain. Such a pattern is proved to be resistant to geometric transformations and common image distortions .

ZoDiac assumes that elements of a watermark \(\) are generated by randomly sampling from a complex Gaussian distribution, noted as \((0,1)\). Elements that are of the same distance to the center of the latent vector have the same value, making the watermark "ring-like". Formally, let \((_{T})^{ch w h}\) be the Fourier transformed latent vector, where \(ch\) is the number of channels, and \(w\) and \(h\) are the width and height. Let \(p=(i,j)\) be a coordinate, \(c=(h/2,w/2)\) be the latent vector's center, and \(d(p,c)\) be the Euclidean distance from a coordinate to the center. Each element in the watermark \(^{w h}\) is:

\[_{p}=w_{ d(p,c)},w_{ d(p,c) }(0,1).\] (3)

ZoDiac also needs a binary mask that indicates the location where the watermark will be applied. Mathematically, let \(\{0,1\}^{w h}\) be a binary mask with a predefined radius \(d^{*}\). Each item in the mask \(\) is

\[_{p}=1,&d(p,c) d^{*};\\ 0,&.\] (4)

Finally, the watermark \(\) is applied to the Fourier-transformed latent vector \((_{T})\) with the binary mask \(\),

\[(_{T})[ic,:,:]\!=\!(1\!-\!)( _{T})[ic,:,:]\!+\!,\] (5)

where \(ic\) is the watermark injecting channel and \(\) denotes the element-wise product. We denote the latent vector after watermarking as \(_{T}\).

**Latent Vector Optimization.** ZoDiac then seeks to find a latent vector \(_{T}\) such that, when being watermarked by \(\) and then processed by the denoising process \(\), generates an image \(_{0}\) that is the most similar to the original image \(x_{0}\). To solve the optimization problem, we design a reconstruction loss \(\) that allows ZoDiac to iteratively refine \(_{T}\) via standard backpropagation:

\[=_{2}(x_{0},_{0})+_{s}_{s}(x_{0 },_{0})+_{p}_{p}(x_{0},_{0}),\] (6)

where \(_{0}=(_{T})\), \(_{2}\) is the Euclidean distance, \(_{s}\) represents the SSIM loss , \(_{p}\) corresponds to the Watson-VGG perceptual loss , and \(_{s}\), \(_{p}\) are weighting coefficients. These coefficients are set to balance the scale of each loss component.

#### 3.2.3 Adaptive Image Enhancement

Adaptive image enhancement aims to improve the visual quality of the image \(_{0}\) generated from the watermark encoding step. To do this, it adaptively mixes \(_{0}\) with the original image \(x_{0}\) such that the _mixed image_ can meet a desired image quality threshold. Mathematically, the mixed image \(_{0}\) is:

\[_{0}=_{0}+(x_{0}-_{0}),\] (7)

where \(\) is a modulating factor. A higher \(\) improves image quality at the cost of potential watermark diminishing. Adaptive image enhancement automatically identifies the smallest \(\) that results in desired image quality through binary search. It optimizes the following objective:

\[, S(_{0},x_{0}) s^{*},\] (8)

where \(s^{*}\) is the desired image quality and \(S\) is an image similarity metric. We use the SSIM metric by default.

### Watermark Detection

In the watermark detection phase, our primary objective is to verify whether a given image \(x_{0}\) contains watermark \(\). The detection process starts with transforming \(x_{0}\) to \(=(^{}(x_{0}))[-1,:,:]^{w  h}\), representing the last channel of the Fourier transformed latent vector. It then detects the presence of \(\) in \(\) via a statistical test procedure. The statistical test computes a \(p\)-value, an interpretable statistical metric that quantifies the likelihood of the observed watermark manifesting in a natural image by random chance. A watermark is considered detected when the computed \(p\)-value falls below a chosen threshold.

To compute the \(p\)-value, we first define the null hypothesis as \(_{0}:(,^{2},_{ })\), where \(^{2}\) is estimated for each image from the variance of \(\) masked by the circular binary mask \(\), i.e., \(^{2}=}()^{2}\). This is because the DDIM inversion \(^{}\) maps any test image \(x_{0}\) into a Gaussian distribution , and the Fourier transformation of a Gaussian distribution remains Gaussian.

To test this hypothesis, we define a distance score \(\) that measures the disparity between \(\) and \(\) in the area defined by the binary mask \(\):

\[=}(- )^{2}.\] (9)

Under \(_{0}\), \(\) follows a non-central chi-squared distribution , characterized by \(\) degrees of freedom and a non-centrality parameter \(=}()^{2}\). An image is classified as watermarked if the value of \(\) is too small to occur by random chance. The probability of observing a value no larger than \(\), i.e., the \(p\)-value, is derived from the cumulative distribution function of the non-central chi-squared distribution. Non-watermarked images will exhibit higher \(p\)-values, while watermarked images yield lower values, indicating a successful rejection of \(_{0}\) and confirming the watermark's presence. In practice, we treat (\(1-p\))-value as the likelihood of watermark presence and set up a detection threshold \(p^{*}\) to determine the watermark presence An image with \((1-p)>p^{*}\) is considered to be watermarked.

## 4 Empirical Evaluation

This section evaluates ZoDiac's efficacy using a diverse domain of images including real photographs, AI-generated content, and visual artwork.

### Experimental Setup

**Datasets.** Our evaluation uses images from three domains, photographs, AI-generated images, and visual artwork. For each domain, we randomly sample 500 images from well-established benchmarks, including **MS-COCO**, **DiffusionDB**, and **WikiArt**.

**ZoDiac Settings.** We use the pre-trained stable diffusion model _stable-diffusion-2-1-base_ with 50 denoising steps. We show ZoDiac is compatible with other diffusion models in SS 4.4. We optimize the trainable latent vector for a maximum of 100 iterations using the Adam optimizer . It takes

[MISSING_PAGE_FAIL:7]

Since the attack strength tuned by the hyper-parameters of different attack methods will influence the presence and detection of the injected watermark, we evaluate the effectiveness of ZoDiac under other settings in the ablation study (see SS4.4 and Appendix B). Besides, unlike prior work, we go deeper and evaluate against the composite attack that combines all the aforementioned attacks (named "All") and a variant without rotation (named "All w/o \(\)").

We also examine the robustness of ZoDiac under _pipeline-aware attack_, where the attacker has partial or full knowledge of our watermarking method, in Appendix C.2. Our results confirm the robustness of ZoDiac in the face of partial knowledge attacks and underscore the critical importance of safeguarding the model weights and watermark configurations.

**Evaluation Metrics.** We evaluate the quality of the watermarked image (\(\)) compared to the original image (\(x\)) using three metrics: Peak Signal-to-Noise Ratio \(()(x,)=-10_{10}((x,))\), Structural Similarity Index (SSIM)  with range \(\), and LPIPS  that measures perceptual similarity. For PSNR and SSIM, larger values correspond to higher image similarity; for LPIPS, lower values do. To assess watermark robustness, we use the _Watermark Detection Rate (WDR)_ for watermarked images, which is the same as True Positive Rate (TPR), and _False Positive Rate (FPR)_ for non-watermarked images. Both WDR and FPR range from 0 to 1. We expect to achieve high WDR and low FPR.

### Results

Table 1 reports the watermarked image quality and WDR before and after attacks for ZoDiac and baselines.

**Image Quality.** ZoDiac achieves satisfactory image perceptual similarity, as defined by  and , of approximately \(30\)dB PSNR and \(0.92\) SSIM. ZoDiac's image quality outperforms the previously most robust watermarking method, StegaStamp. Figure 11 in Appendix E illustrates the visually imperceptible effect of ZoDiac's and other methods' watermarks. SS4.4 examines how increasing ZoDiac's SSIM threshold can further improve image quality, trading off WDR.

**Watermark Robustness.** ZoDiac consistently exhibits high detection rates, within \(2\%\) of the maximum WDR, against watermark removal algorithms as highlighted by the gray cells (except for the _Rotation_ attack). Traditional approaches, such as DwtDct and DwtDctSvd, consistently fail with brightness and contrast changes, rotation, and advanced generated-AI-based attacks. RivaGAN and SSL fail for advanced attacks, _Bmshj18_, _Cheng20_, and _Zhao23_. StegaStamp, despite being robust across most attacks, fails for rotation and demonstrates significantly diminished detection rates under the diffusion model-based attack _Zhao23_. When facing the composite attack excluding rotation ("All w/o \(\)" column), ZoDiac maintains a detection rate of about \(0.5\), while all baselines fail, with a WDR close to 0. Appendix B.8 provides more discussions on composite attacks.

The exception of rotation is noteworthy. All methods, apart from SSL which incorporates rotation during training, fail for rotational disturbances. In ZoDiac, this limitation stems from the non-rotation-invariant nature of the DDIM inversion process; the latent representation derived from an image and its rotated version differ significantly. However, rotation is not an invisible attack and its effects are readily reversible, allowing users to manually correct image orientation to facilitate watermark detection. Appendix C.1 presents an extended discussion on overcoming rotational attacks.

### Why ZoDiac is Attack Resilient

Recall that the image generation process is an iterative algorithm that progresses from \(x_{T}\) to \(x_{0}\), involving the prediction of an approximate \(x_{0}\) at each step and the subsequent addition of noise to obtain the noisy input for the next step. We hypothesize that this reciprocating denoising process may inherently enhance the robustness of the watermark when faced with strong attacks. To validate the hypothesis, we experiment with different denoising steps when reconstructing the watermarked image on the MS-COCO dataset. In addition to the commonly-used 50 denoising steps, we further evaluate denoising steps of 10, 1, and even 0, where 0 means utilizing only the well-trained image autoencoder in the diffusion model without the diffusion process.

Table 2 reports the watermarked image quality in terms of PSNR when setting the SSIM threshold \(s^{*}=0.92\) and the robustness when subjected to three representative attacks. Appendix B.2 contains the full table with all attacks. We make two observations. First, the number of denoising steps

[MISSING_PAGE_EMPTY:9]

probability of both watermark detection for watermarked images, measured by watermark detection rate (WDR), and false detection for non-watermarked images, measured by false positive rate (FPR). Table 3 reports the effects of detection thresholds \(p^{*}\{0.90,0.95,0.99\}\) on WDR and FPR before and after three representative attacks on MS-COCO dataset. Appendix B.4 contains the full table with all attacks for the three datasets and also provides the FPR of baselines for reference. _The data show that \(p^{*}=0.9\) maintains a high WDR and an acceptable FPR, in practice._

**Varying the Backbone Models.** ZoDiac is compatible with different pre-trained stable diffusion models. In this study, we extend our evaluation to the _stable-diffusion-v1-4_ and _stable-diffusion-xl-base-1.0_ (in addition to _stable-diffusion-2-1-base_). Figure 4 shows the trade-off curves between the watermarked image quality and the watermark detection rate without attack as well as with three representative attacks, _Rotation, Zhao23_, and _All w/o_\(\). Appendix B.5 shows additional results addressing other attacks. The data shows consistent performance (WDR and image quality in SSIM) between the two models, as indicated by the almost overlapped solid and dashed lines, suggesting that ZoDiac can seamlessly integrate with other pre-trained stable diffusion models, maintaining its state-of-the-art efficiency, regardless of the backbone model employed.

**Varying the Attack Strength.** We also compare ZoDiac with the strongest baseline StegaStamp under different hyper-parameter settings of the attack methods, in terms of WDR under different FPR levels. Table 4 reports the image quality in terms of PSNR and the watermarking robustness when we adjust the _Brightness_ and _Contrast_ attacks with a factor of 0.2 to 1.0 following WAVES . As the adjustment factors for brightness and contrast decrease from 0.9 to 0.2, the PSNR of the attacked watermarked images drops significantly--from 37.79 to 11.41 for brightness and from 38.57 to 14.54 for contrast. Despite this degradation, ZoDiac consistently maintains a WDR above 0.99 across all scenarios. Even at extreme settings, where PSNRs fall to 11.41 for brightness and 14.54 for contrast, ZoDiac significantly outperforms StegaStamp, achieving higher WDR and lower FPR. _This clearly demonstrates ZoDiac's robustness even under severe quality degradation._ Appendix B.6 includes additional results when tuning other attacks.

## 5 Contributions

We have presented ZoDiac, a robust watermarking framework based on pre-trained stable diffusion models. ZoDiac hides watermarks within the trainable latent space of a pre-trained stable diffusion model, enhancing watermark robustness while preserving the perceptual quality of the watermarked images. An extensive evaluation across three datasets of photographs, AI-generated images, and art demonstrates ZoDiac's effectiveness in achieving both invisibility and robustness to an array of watermark removal attacks. In particular, ZoDiac is robust to advanced generative-AI-based removal methods and composite attacks, while prior watermarking methods fail in these scenarios. This robustness, coupled with the ability to achieve high-quality watermarked images, positions ZoDiac as a significant advancement in the field of image watermarking. ZoDiac focuses on zero-bit watermarking , only hiding and detecting a mark. ZoDiac is constrained to adhere to a Gaussian distribution in the latent vector of the diffusion model, but future work will explore encoding meaningful information, such as a message, in the watermark while preserving ZoDiac's robustness.