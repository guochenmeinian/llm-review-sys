# Stochastic Multi-armed Bandits: Optimal Trade-off among Optimality, Consistency, and Tail Risk

David Simchi-Levi

Institute for Data, Systems, and Society

Massachusetts Institute of Technology

Cambridge, MA 02139

dslevi@mit.edu

&Zeyu Zheng

Industrial Engineering & Operations Research

University of California, Berkeley

Berkeley, CA 94720

zyzheng@berkeley.edu

&Feng Zhu

Institute for Data, Systems, and Society

Massachusetts Institute of Technology

Cambridge, MA 02139

fengzhu@mit.edu

###### Abstract

We consider the stochastic multi-armed bandit problem and fully characterize the interplay among three desired properties for policy design: worst-case optimality, instance-dependent consistency, and light-tailed risk. We show how the order of expected regret exactly affects the decaying rate of the regret tail probability for both the worst-case and instance-dependent scenario. A novel policy is proposed to achieve the optimal regret tail risk for any regret threshold. Concretely, for any given \([1/2,1)\) and \([0,1)\), our policy achieves a worst-case expected regret of \((T^{})\) and instance-dependent expected regret of \((T^{})\), while enjoys a probability of incurring an \((T^{})\) regret that decays exponentially with a polynomial \(T\) term. Such decaying rate is proved to be best achievable. We also generalize our analysis to the stochastic multi-armed bandit problem with non-stationary baseline rewards, where in each time period \(t\), the decision maker pulls one of \(K\) arms and collects a reward which is the sum of three terms: the mean of the pulled arm, an independent noise, and a non-stationary baseline reward as a function of \(t\). Our results reveal insights on the trade-off between expected regret and tail risk for both worst-case and instance-dependent scenario, indicating that more sub-optimality and inconsistency leaves space for more light-tailed risk of incurring a large regret.

## 1 Introduction

The stochastic multi-armed bandit (MAB) problem is a well-established area of research in sequential decision-making under uncertainty, applications of which include online advertising, recommendation systems, digital clinical trials, etc. Let \(T\) be a pre-fixed time horizon. In a standard MAB problem, the decision maker selects one of several arms (rewards of which are unknown a priori) in each time period \(t[T]\) with the goal of maximizing the expected sum of rewards over all time periods. The MAB problem highlights the exploration-exploitation trade-off: the decision maker must balance between exploring arms with relatively unknown reward distributions and exploiting arms with relatively known high expected rewards. There is a significant amount of literature on MAB, with a comprehensive review provided in .

In order to evaluate policy performance and guide policy design, much of the MAB literature uses the metric of maximizing the _expected cumulative reward_, or equivalently minimizing the **expected

**regret** (where _regret_ is generally defined as the difference between the cumulative reward of pulling the best arm and the cumulative reward of a policy). However, it has recently been documented that if an MAB policy design only focuses on minimizing the **expected regret**, the policy may be exposed to heavy-tailed risks of incurring a large regret; see  and  for detailed documentation. Roughly speaking, designing a policy that focuses only on the expected regret could be analogous to designing an investment portfolio that focuses only on the expected return without looking at other risks. As recently documented in , many renowned algorithms (e.g., Successive Elimination (SE) , Thompson Sampling (TS) ), despite of enjoying optimality on expected regret, can incur a "heavy-tailed risk" -- the probability of incurring a linear regret slowly decays at a polynomial rate \(((1/T))\) as \(T\) tends to infinity. In contrast, a "light-tailed" risk in this MAB setting means that the probability of a policy incurring a linear regret decays at an exponential rate \((-(T^{}))\) for some \(>0\).

Two important and popular notions in the MAB literature to describe properties of a policy -- worst-case _optimality_ and instance-dependent _consistency_ -- are both defined in terms of expected regret. There lacks an understanding in the literature about how much regret tail risk will arise by pursuing optimality and/or consistency for policy design. In particular:

_How do different levels of optimality and consistency respectively affect the tail risk? What is the optimal trade-off among optimality, consistency, and light-tailed risk?_

Motivated by these questions, we summarize our contributions in Section 1.1. To facilitate describing the results on regret orders and function orders, we use \(O()\) (\(()\)) and \(()\) (\(()\)) to present upper and lower bounds on the growth rate up to constant (logarithmic) factors, respectively, and \(()\) (\(()\)) to characterize the rate when the upper and lower bounds match up to constant (logarithmic) factors. We use \(o()\) and \(()\) to present strictly dominating upper bounds and strictly dominated lower bounds, respectively.

### Our Contributions

1. We characterize the connections and interplays among worst-case optimality, instance-dependent consistency, and light-tailed risk. We show that relaxing worst-case regret order or instance-dependent regret order can help make the regret tail lighter in an information-theoretic way. Given the family of policies with a worst-case regret of \((T^{})\) and instance-dependent regret of \((T^{})\), we demonstrate how fast we can best hope the probability of incurring an \((T^{})\) decays with \(T\), for any feasible tuple \((,,)\). (This can be viewed as a best-achievable "lower bound" result. The next item describes a matching "upper bound" result.)

2. We design a simple policy that, for any given \(\) and \(\), obtains \((T^{})\) worst-case regret and \((T^{})\) instance-dependent regret, and simultaneously obtains the best achievable regret tail probability for both worst-case and instance-dependent scenarios. Our regret tail bounds are explicit formulas showing that the probability of incurring a worst-case regret larger than any \(x\) is bounded by \((-((x/T^{1-}) T^{}))\), and that the probability of incurring an instance-dependent regret larger than any \(x\) is bounded by \((-(T^{}))\). Our policy design builds upon the idea of successive elimination, and constructs novel bonus terms to balance among worst-case optimality, instance-dependent consistency, and light-tailed risk.

3. Our theory is generalized to an advanced MAB model that allows a common non-stationary baseline among all arms for each time period. Different time periods can have different baseline rewards. The model may accommodate applications with structured non-stationarity beyond those from standard multi-armed bandit problems where arm rewards are assumed to be stationary. We apply a simple and novel technique of random permutation to deal with this additional feature. Last, a brief account of experiments are conducted to illustrate our theoretical findings. We discuss how tuning parameters affect the performance of our policy, and reiterate the insight that relaxing worst-case optimality and instance-dependent consistency (or allowing sub-optimality and inconsistency) may leave space for regret distribution being more light-tailed.

### Related Work

Our work builds upon the stochastic multi-armed bandit (MAB) literature, and reviews can be found in [4; 20; 25; 17]. However, the tail risk of stochastic bandit algorithms is not well understood. [2; 21] showed that the policy regret generally concentrates only at a polynomial rate. That is, the probability of incurring \(c( T)^{p}\) regret (with \(c>0\) and \(p>1\) fixed) is polynomially decaying with \(T\).  showed that a policy that obtains logarithmic regret can be sensitive to mis-specified risk parameter. That is, if one underestimated the risk parameter \(\) for subGaussian noises, then one may obtain a large regret. Note that the goal here is still to minimize the expected regret.

Our work is inspired by [11; 24].  first analyzed heavy-tailed risk for bandit algorithms and showed that the family of information-theoretically optimized bandit policies suffers from serious heavy-tailed risk: the probability of incurring a linear regret is at least \((1/T)\). They also modified UCB algorithms to reach a desired tail risk polynomially dependent on \(T\), making the algorithms more robust to mis-specifications.  showed the incompatibility between instance-dependent consistency and light-tailed risk. They also proposed a simple policy design showing that worst-case optimality (expected regret bounded by \(()\)) permits light-tailed risk (tail bound exponentially decaying with \(\)). However, the interplay among optimaililty, consistency, and tail risk remains unclear. This is the question we want to fully address in this work.

Our work is also related with multi-tasking bandits, where minimizing expected regret is not the only goal (see, e.g., [8; 9; 28; 29; 23]). In particular,  studied the optimal trade-off between efficiency (obtaining low regret) and statistical power (estimating arm gaps correctly). They also extended their analysis to the MAB problem with non-stationary baseline rewards. We note that their task is still centered on expectation, and their results are entirely based on an instance-dependent perspective. Another line of related work is risk-averse formulations of the stochastic MAB problem (see, e.g., [22; 12; 18; 31; 27; 5; 26; 19; 30; 3; 14; 7; 6]). These formulations consider different objectives other than expected regret, such as mean-variance and value-at-risk. Our work's objective and metric (levels of tail risks) are different, which leads to different policy design and analysis.

### Organization and Notation

The rest of the paper is organized as follows. In Section 2, we discuss the setup and introduce the key concepts. In Section 3, we show our main results. In Section 4, we extend our main results. In Section 5, we conclude. Experiments are provided in the supplementary material. Before proceeding, we introduce some notation. For any \(a,b\), \(a b=\{a,b\}\), \(a b=\{a,b\}\), and \(a_{+}=\{a,0\}\). We denote \([N]=\{1,,N\}\) for any positive integer \(N\). Next, we state our problem setting and describe all the notation used in the problem setting.

## 2 The Setup

### The Model

Fix \(T\) as the time horizon and \(K\) as the number of different arms. Without loss of generality, we presume that \(K 2\), \(T 3\), and \(T K\). In each time period \(t[T]\), the decision maker (DM) has access to all prior information and then chooses an arm \(a_{t}[K]\) to pull. Upon pulling the arm, the DM observes and receives a reward \(r_{t,a_{t}}\). Specifically, let \(H_{t}=\{a_{1},r_{1,a_{1}},,a_{t-1},r_{t-1,a_{t-1}}\}\) be the history information prior to time \(t\). \(H_{1}\) is set as \(\) for definition completeness.

In this work we consider policies that are allowed to utilize the knowledge of \(T\). When we say \(\) is policy, we mean that \(\) is composed of a series of "sub-policies": \((1),,(T),\). That is, with the prior knowledge of \(T\), \(\) executes \((T)\) throughout the whole time horizon. At time \(t\), the action taken is determined by \(_{i}(T):H_{t}\{T\} a_{t}\), which can potentially be random. Different \(T\)'s may lead to completely different sub-policies.

The time-\(t\) reward is independently sampled as \(r_{t,a_{t}}=_{a_{t}}+_{t,a_{t}}\), where \(_{a_{t}}\) is the mean reward of arm \(a_{t}\), and \(_{t,a_{t}}\) is a zero-mean random noise, independent across time periods. The random noise \(_{t,a_{t}}\) is assumed to be \(\)-subGaussian. That is, there exists a \(>0\) such that for any arm \(k\) and time \(t\),

\[\{(_{t,k} x),( _{t,k}-x)\}(-x^{2}/(2^{2})).\]Let \(=(_{1},,_{K})\) be the vector of means. Let \(_{*}=\{_{1},,_{K}\}\) be the optimal mean reward among the \(K\) arms. Note that the DM does not know \(b_{t}\) or \(\) a priori, except that \(b_{t}[0,B]\) (for some \(B 0\)) and \(^{K}\). The empirical regret of the policy \(=(_{1},,_{T})\) under the mean vector \(\) and the noise parameter \(\) over a time horizon of \(T\) is defined as

\[_{,}^{(T)}(T)=_{*} T-_{t=1}^{T}(_{ a_{t}}+_{t,a_{t}}).\]

Let \(_{k}=_{*}-_{k}\) denote the gap between the optimal arm and the \(k\)th arm. Define \(_{0}>0\) such that

\[1/_{0}=_{k^{}:_{k^{}}>0}1/_{k^{}}.\]

Denote \(n_{t,k}=_{s=1}^{t}\{a_{s}=k\}\) as the number of times arm \(k\) has been pulled up to time \(t\). We sometimes use \(n_{k}=n_{T,k}\) to denote the total number of times arm \(k\) pulled through the entire time horizon. We denote \(t_{k}(n)\) as the time period that arm \(k\) is pulled for the \(n\)-th time. We define the pseudo regret as

\[R_{,}^{(T)}(T)=_{k=1}^{K}n_{k}_{k}\]

and the aggregated random noise as

\[N^{}(T)=_{t=1}^{T}_{t,a_{t}}=_{k=1}^{K}_{m=1}^{n_{k}} _{t_{k}(m),k}.\]

Therefore, the empirical regret can also be written as \(_{,}^{}(T)=R_{,}^{}(T)-N^{}(T)\). In this work, for notation simplicity, we will write \(_{}^{}(T)\) instead of \(_{,}^{(T)}(T)\) and \(R_{}^{}(T)\) instead of \(R_{,}^{(T)}(T)\). The following simple lemma gives the mean and the tail probability of the aggregated noise \(N^{}(T)\).

**Lemma 2.1**.: _We have \([N^{}(T)]=0\) and_

\[\{(N^{}(T) x),(N^{}(T) -x)\}(}{2^{2}T}).\]

In the worst-case scenario, \(x\) is taken as \(()\), and so the tail in Lemma 2.1 is negligible. In the instance-dependent scenario, \(x\) may take \(o()\), making the tail in Lemma 2.1 no longer ignorable. We note that the empirical regret unavoidably incurs a tail in Lemma 2.1 due to the appearance of genuine noise, even if we always pull the optimal arm. Therefore, we will mainly focus on pseudo regret in our subsequent discussions.

### Worst-case Optimality, Instance-dependent Consistency, Light-tailed Risk

Now we describe concepts that are needed to formalize the policy design and analysis.

**1. Worst-case \(\)-optimality.** Fix \([1/2,1)\). A policy is said to be worst-case \(\)-optimal or simply, \(\)-_optimal_, if for any \(>0\), the policy has that

\[_{T+}[R_{}^{ }(T)]}{T^{+}}=0.\]

In brief, a policy is \(\)-optimal if the worst-case expected regret can never be growing in \(T\) at a polynomial rate faster than \(T^{}\). Intuitively, the smaller the \(\) is, the better performance a policy has in terms of worst-case expected regret order.

**2. Instance-dependent \(\)-consistency.** Fix \([0,1)\). A policy is called instance-dependent \(\)-consistent or simply \(\)-consistent, if for any underlying true mean vector \(\) and any \(>0\), the policy has that

\[_{T+}[R_{}^{}(T)]} {T^{+}}=0.\]In brief, a policy is \(\)-consistent if the expected regret can never grow faster than \(T^{}\) for any fixed instance. We note that the "worst-case" notion and the "instance-dependent" notion, in these two items, are most commonly used in the bandits literature, and both notions care about the **expectation** of the regret distribution. The next notion concerns the tail of regret distribution.

**3. \((,)\)-tail.** Fix \((0,1]\) and \(\). We differentiate between two scenarios: worst-case and instance-dependent.

(a). A policy is called worst-case \((,)\)-tailed, if there exists constants \(c(0,1/2)\) and \(C>0\) such that

\[_{T+}(R_ {}^{}(T)>cT^{})\}}{T^{}}-C.\]

Both \(c\) and \(C\) are allowed to rely on \((,)\). More intuitively, the above definition means that a policy is worst-case \((,)\)-tailed if the worst-case probability of incurring a regret of \(T^{}\) can be bounded by an exponential term of polynomial \(T^{}\):

\[_{}(R_{}^{}(T)>cT^{})=(- (T^{})).\]

All else equal, one would prefer a policy with larger \(\) so that the tail probability of incurring a big regret is lighter.

(b). A policy is called instance-dependent \((,)\)-tailed, if for any underlying true mean vector \(\), there exists constants \(c(0,1/2)\) and \(C>0\) such that

\[_{T+}(R_{}^{} (T)>cT^{})\}}{T^{}}-C.\]

Note that the constant \(C\) may be dependent on both \(c\) and \(\). In brief, a policy is instance-dependent \((,)\)-tailed if the instance-dependent probability of incurring a regret of \(T^{}\) can be bounded by an exponential term of polynomial \(T^{}\):

\[(R_{}^{}(T)>cT^{})=(-(T^{ })).\]

**Remarks.**

1. When defining the tail, we impose \(c(0,1/2)\) to avoid the corner case when \(=1\). In such case, if \(c 1\), the tail probability is zero because \(^{K}\). We note that when \(<1\), the condition \(c(0,1/2)\) is not essential, and here we retain it for simplicity of exposition.

2. It is well known that for the stochastic MAB problem, one can design algorithms to achieve both \(0\)-consistency and \(1/2\)-optimality. Among them, two types of policies are of prominent interest: Successive Elimination (SE) and Upper Confidence Bound (UCB). The bonus term (or, the confidence radius) \((n)\) is typically set as

\[(n)=}\] (1)

with \(>0\) being some tuning parameter. That said, both the SE policy and UCB policy may not perform well in terms of tail probability of incurring a large regret, as documented in  and .

## 3 Main Results

### Tail Lower Bound: The Best to Hope

In this section, we show how fast the regret tail can decay as a function of \(T\), given that a policy is \(\)-optimal or/and \(\)-consistent. More concretely, if a policy is \(\)-optimal or/and \(\)-consistent, Theorem 3.1 shows what is the fastest decaying rate we can hope for the probability that the pseudo regret is at least \((T^{})\) (in either the worst-case or instance-dependent scenario).

**Theorem 3.1**.: _We have the following arguments._

_1. Fix \([1/2,1)\). If a policy \(\) is \(\)-optimal, then for any \(>\) and \(>+-1\), \(\) can never be worst-case \((,)\)-tailed._

_2. Fix \([0,1)\). If a policy \(\) is \(\)-consistent, then for any \(>\) and \(>\), \(\) can never be instance-dependent \((,)\)-tailed._In the proof of Theorem 3.1, briefly, for the worst-case scenario, we construct a series of instance pairs such that the gap between two arms shrink with a polynomial rate of \(1/T\). For the instance-dependent scenario, we fix a pair of instances and investigates how the tail probability scales in the two environments as \(T\) increases. An intermediate step towards doing the complete proof is a lemma showing that if the policy is "effective", i.e., achieves a sub-linear regret under either case, then the estimation of the _sub-optimal_ arm becomes more precise in probability as \(T\) increases. Details are provided in the supplementary material.

Theorem 3.1 implies Corollary 3.2, which is a direct application of the following argument -- if a policy is _not_ instance-dependent \((,)\)-tailed, then it is also not worst-case \((,)\)-tailed.

**Corollary 3.2**.: _Fix \([1/2,1)\) and \([0,1)\). If a policy \(\) is both \(\)-optimal and \(\)-consistent, then we have the following arguments._

_1. For any \(>\) and \(>(+-1)\), \(\) can never be worst-case \((,)\)-tailed._

_2. For any \(>\) and \(>\), \(\) can never be instance-dependent \((,)\)-tailed._

To help better understand Corollary 3.2 in an intuitive way, we let \(x=(T^{})\), then the critical values of \(T^{}\) for different scenarios and cases are listed in Table 1. That said, the best we can hope for the order of the regret tail bounds cannot decay faster than the critical values.

### Tail Upper Bound: The Best to Achieve

In this section, we show that "the best we can hope" is achievable by concrete policies. Given \(\) and \(\), our goal is to design a policy such that the decaying rate of the log tail probabilities match the critical values indicated in Table 1. Namely, we design a _single_ policy that is \(\)-optimal and \(\)-consistent, and enjoys the optimal tail rate in _both_ worst-case and instance-dependent scenarios.

``` \(_{1}=[K]\). \(t 0\). \(i 1\). while\(t<T\)do  Sample a permutation \(_{i}\) of \(_{i}\) uniformly at random.  Pull each arm in \(_{i}\) once sequentially according to \(_{i}\). \(t t+|_{i}|\). \(_{i}=\{k| k^{}:_{t,k^{}}-(n_{ t,k^{}})>_{t,k}+(n_{t,k})\}\). \(_{i+1}=_{i}_{i}\). \(i i+1\). endwhile ```

**Algorithm 1** Successive Elimination with Random Permutation (SEwRP)

Algorithm 1 is designed upon the standard Successive Elimination (SE) algorithm. First, for each phase \(i\), we add a random permutation step prior to taking the actions. This randomization step will be useful for extending our theories. Second, the bonus term \((n)\) in SEwRP is different from standard bonus terms like (1) or those used in  -- we need to reach balance among optimality, consistency, and tail risk. The concrete design is given in Theorem 3.3, which fully characterizes the regret tail bound of Algorithm 1 in both worst-case and instance-dependent scenarios.

**Theorem 3.3**.: _For the \(K\)-armed bandit problem, \(=\) with_

\[(n)=_{1}}{n}_{2} T}{n}}\] (2)

_satisfies the following properties: fix any \(_{1},_{2} 0\), for any \(x>0\), we have_

  \(_{}_{}^{}(>x)\) (worst-case scenario) & \(-(x/T^{1-}) T^{}\) for large \(x\) \\  \(_{}^{}(>x)\) (instance-dependent scenario) & \(-T^{}\) for large \(x\) \\  

Table 1: Critical values of log tail probability for policies that are both \(\)-optimal and \(\)-consistent_1. (worst-case regret tail)_

\[_{}(R_{}^{}(T) x)  6K(-K^{1-}T^{})_{+}^{2}}{32^{2}KT})\] \[+6K^{2}T(-}{8^{2}}((x-K)_{+}}{2K^{}T^{1-}}_{2}^{2}T^{})).\] (3)

_2. (instance-dependent regret tail)_

\[(R_{}^{}(T) x)  3K(--4_{2}^{2}T^{ } T)_{+}}{8^{2}})\] \[+3KT_{k:_{k}>0}(-(T/K)^{ }_{k}_{2}^{2}T^{})}{8 ^{2}}),\] (4)

The design of our bonus term is novel and hopefully provides additional insights, as follows. The first component can be interpreted as controlling the worst-case tail risk, while the second one can be regarded as controlling the instance-dependent tail risk. There exhibits a _phase transition_ with respect to the size of confidence interval. At the beginning \((T^{2-})\) time periods, the second term dominates, and so the confidence interval shrinks at a rate of \(1/\), suggesting that we focus more on exploration within the consistency constraint. While in the remaining time periods, the first term dominates, and so the confidence interval shrinks at a rate of \(1/n\), suggesting that we focus more on exploitation within the optimality condition. Our policy design suggests that in real-world practice, to achieve more light-tailed risk, it might be beneficial to have two different phases in the policy design: more exploration at the beginning, and more exploitation afterwards.

The following proposition shows that our policy has \((T^{})\) worst-case expected regret and \((T^{})\) instance-dependent expected regret.

**Proposition 3.4**.: _For the \(K\)-armed bandit problem, \(=\) with (2) satisfies the following expected regret bounds (ignoring additive and multiplicative constant terms). If \(>0\) or \(=0\) and \(_{2}=(1)\), then_

\[_{}[R_{}^{}(T)]=O(K^{1-}T^ {})[R_{}^{ }(T)]=O(T^{} T/_{0}).\]

**Proof road-map.** Without loss of generality, we assume arm \(1\) is optimal. Let the regret threshold \(x K\). For any \(k 1\), we define

\[S_{k}=\{\}.\]

In the following, we differentiate between two scenarios.

For the worst-case scenario, we define

\[^{*}=\{k 1:n_{k} 1+T/K\}.\]

Then with some basic algebra, one can build

\[(R_{}^{}(T) x)_{k 1} ((n_{k}-1)_{k},\;k^{*})+ _{k 1}(_{k},\;k^{*})\] (5)

We need to emphasize that introducing \(^{*}\) allows us to establish \(_{k}=(x/T)\), otherwise we may only have \(_{k}=(x/KT)\). The goal of defining \(^{*}\) is to make sure our analysis aligns with our new bonus design (we have a \(1/K^{}\) factor in the numerator) such that our tail probabilities have optimal dependence on the number of arms \(K\).

We decompose the tail risk of an algorithm by two types of events: (i) spending too much time before correctly discarding a sub-optimal arm; (ii) wrongly discarding the optimal arm.

1. Consider the case when \(S_{k}\) happens. This corresponds to the tail risk of _spending too much time before correctly discarding a sub-optimal arm_. For either \(k^{*}\) or \(k^{*}\), we fix some non-random number \(n_{0}<n_{k}\) (the choice of \(n_{0}\) is important: to be precise, we let \(n_{0}=(x-K)/(2K_{k})\) when \(j^{*}\) and \(n_{0}=T/K\) when \(j^{*}\)) where \(n_{0}\) is a phase when a sub-optimal arm \(k\) is not eliminated by the optimal arm \(1\). Then arm \(1\) and \(k\) are both not eliminated after each of them being pulled \(n_{0}\) times, which means \[_{t_{1}(n_{0}),1}-(n_{0})_{t_{k}(n_{0}),k}+ (n_{0}).\] The probability of this event can be bounded using concentration properties of sub-Gaussian random variables.

2. Now consider the case when \(_{k}\) happens. This corresponds to the tail risk of _wrongly discarding the optimal arm_. Then after some phase \(n\), the optimal arm \(1\) is eliminated by some arm \(k^{}\), while arm \(k\) is not eliminated. We emphasize that \(k=k^{}\) does not necessarily hold when \(K>2\). As a result, the following two events hold simultaneously:

\[_{t_{k^{}}(n),k^{}}-(n)_{t_{1}(n), 1}+(n)_{t_{k}(n),k}+(n) _{t_{1}(n),1}+(n).\]

The two events leads to, respectively,

\[ (n)=(}{n} }{n}})\] \[\] \[ _{k}=().\]

Then the tail probability can be further bounded by

\[O((-(}{n} T^{}) }{T^{2}}))=O((-T^{1- }} T^{})).\]

which yields the second term in (3).

For the instance-dependent scenario, the proof follows similarly to that for the worst-case scenario, but with some amendment. For each \(k 1\), we treat \(_{k}\) as a constant, and instead of (5), we use

\[(R_{}^{}(T) x)\] \[ _{k:_{k}>0}((n_{k}-1)_{k} {(x-K)/_{k}}{_{k^{}:_{k^{}}>0}1/_{k^{} }},S_{k})\] \[+_{k:_{k}>0}((n_{k}-1)_{k} }{_{k^{}:_{k^{}}>0}1/_{k^{ }}},_{k}).\]

Here, we do not need \(^{*}\) to control the dependence on \(K\). Also, when bounding the probability when \(S_{k}\) happens, we accordingly define

\[n_{0}=(x-K)/_{k}^{2}_{0} n_{k}-1.\]

The detailed proof is left to the supplementary material. We would like to emphasize the technical novelty compared to that in . In general, since \(\) and \(\) become flexible constants, the proof requires more delicate controls on probability bounds. When proving the worst-case upper bound, we need a careful manipulation on \((n)\) since we are dealing with the minimum of two different types of bonus terms. When proving the instance-dependent upper bound, we require a careful division of the tail event to make the bound as tight as possible, depending on specific instances (\(\)). In , the tail bound is only concerned with the worst-case scenario with \(=1/2\), and hence the aforementioned challenges do not exist.

Finally, we would like to note that although applying the naive explore-then-commit (ETC) strategy might be able to circumvent heavy-tailed risk, the approach has two main issues:

1. From the regret expectation perspective, the ETC policy can only achieve worst-case \(O(T^{2/3})\) expected regret bound. When \([1/2,2/3)\), we still have to consider other types of policies. Further, it seems unlikely that without knowing the arm gaps \(\{_{k}\}\), the explore-then-commit policy can achieve \((T^{})\) worst-case regret and \((T^{})\) instance-dependent regret simultaneously with \(<\).

2. From the regret tail risk perspective, the tail probability of incurring a large regret may not be optimal in the worst-case. Consider a simple \(2\)-armed bandit case with arm gap \(\). An ETC policy with \(m=(T^{})\) (\([2/3,1)\)) steps of exploration has a probability of \(((-m^{2}))\) committing to a wrong arm. In the worst-case scenario, let \(=T^{(-1)/2}\) and the regret threshold be \(x=T^{(+1)/2}/4(m,(T-m))\). Then if we incur a regret of \(x\), it means we commit to a wrong arm after the exploration, which suggests \((R_{}^{}(T)>x)=((-m^{2}))=((-T^{ 2-1}))=((-x/T^{1-}))\).

## 4 Extension with Structured Non-stationarity

In this section, we extend our results to a more general stochastic MAB model. In certain applications, the assumption that the rewards for one arm are i.i.d. generated may fail to hold. On the other hand, the non-stationary MAB models are at the other extreme being a bit too conservative, where no structural properties exist. The stochastic MAB model with non-stationary baseline rewards tries to strike a balance between stationary stochastic MAB and fully adversarial MAB. Such a structure is receiving attentions in the literature (see, e.g., [13; 16; 15; 23]). We restate the setting as follows and highlights those different from the standard stochastic MAB model introduced in Section 2.

At each time \(t\), upon pulling an arm \(a_{t}\), a reward is independently sampled as \(r_{t,a_{t}}=b_{t}+_{a_{t}}+_{t,a_{}}\), where \(b_{t}\) is the baseline reward chosen by the nature at time \(t\), \(_{a_{t}}\) is the mean reward of arm \(a_{t}\), and \(_{t,a_{t}}\) is a zero-mean random noise, independent across time periods. The random noise \(_{t,a_{t}}\) is assumed to be \(\)-subGaussian. Let \(=(_{1},,_{K})\) be the vector of means and \(_{*}=\{_{1},,_{K}\}\) be the optimal mean reward among the \(K\) arms. Note that the DM does not know \(b_{t}\) or \(\) a priori, except that \(b_{t}[0,B]\) (for some \(B 0\)) and \(^{K}\). The empirical regret of the policy \(=(_{1},,_{T})\) under the mean vector \(\) and the noise parameter \(\) over a time horizon of \(T\) is defined as

\[_{}^{}(T)=_{*} T+_{t=1}^{T}b_{t}-_{t=1}^{ T}(b_{t}+_{a_{t}}+_{t,a_{t}})=_{*} T-_{t=1}^{T}( _{a_{t}}+_{t,a_{t}}).\]

Note that here although \(b_{t}\) appears in the model, the term get cancelled in the regret. Let \(_{k}=_{*}-_{k}\) denote the gap between the optimal arm and the \(k\)th arm. Same as Section 2.1, \(_{0}\), the pseudo regret and the aggregated random noise are defined accordingly.

**Theorem 4.1**.: _For the \(K\)-armed bandit problem with baseline rewards, \(=\) with (2) satisfies the following properties: fix any \(_{1},_{2} 0\), for any \(x>0\), we have 1. (worst-case regret tail)_

\[_{}(R_{}^{}(T) x)  6K(-K^{1-}T^{} )_{+}^{2}}{8(B+2)^{2}KT})\] \[+6K^{2}T(-}{2(B+2)^{2}}( (x-K)_{+}}{2K^{}T^{1-}}_{2}^{2}T^{} )).\] (6)

_2. (instance-dependent regret tail)_

\[(R_{}^{}(T) x)  3K(--4_{2}^{2}T^{ } T)_{+}}{2(B+2)^{2}})\] \[+3KT_{k:_{k}>0}(-(T/K)^{ }_{k}_{2}^{2}T^{})}{ 2(B+2)^{2}}),\] (7)

**Proposition 4.2**.: _For the \(K\)-armed bandit problem with baseline rewards, \(=\) with (2) satisfies the following expected regret bounds (ignoring additive and multiplicative constant terms). If \(>0\) or \(=0\) and \(_{2}=(1)\), then_

\[_{}[R_{}^{}(T)]=O(K^{1-}T^ {})[R_{}^{ }(T)]=O(T^{} T/_{0}).\]The proof of Theorem 4.1 follows that of Theorem 3.3, except that when bounding the mean of error terms, we now have not only the true noise \(\), but also a baseline \(b_{t}\). Lemma 4.3 is established to characterize the concentration of these combined error terms. We would like to note that the randomization step in SEwRP is crucial to hedge against the baseline rewards \(b_{t}\), for which deterministic algorithms may fail. With uniform permutation, although the estimation of one arm is still biased, the difference of estimations between two different arms becomes unbiased.

**Lemma 4.3**.: _Let \(_{i}\) be the (random) time period that we pull the last arm in \(_{i}\). For any \(n 1\) and \(k,k^{}[K]\), define_

\[E_{n}(k,k^{})=_{t=1}^{_{n} T}(b_{t}+ _{t,a_{t}})(\{a_{t}=k\}-\{a_{t}=k^{} \}).\]

_We have, for any \(x>0\),_

\[ \{(E_{n}(k,k^{}) x;_{n} T;k,k^{ }_{n}),\] \[(E_{n}(k,k^{})-x;_{n} T;k,k^{ }_{n})\}\] \[ 3(-}{2(B+2)^{2}}).\]

## 5 Conclusion

In this work, we study the stochastic MAB problem with the goal of obtaining light-tailed regret distribution under given degree of worst-case optimality and instant-dependent consistency. We fully characterize the tradeoff among optimality, consistency, and tail risk via (i) proving lower bounds for decaying rate of incurring a large regret and (ii) proposing a novel algorithm with explicit regret tail upper bounds that match the lower bounds. We extend our analysis to the stochastic MAB model with non-stationary baseline rewards, and obtain similarly tight regret tail bounds. We study the empirical performance via synthetic simulations, and present insights of our results.

An open question for this work is whether our results can be generalized to the _any-time_ case where the policy has no knowledge of \(T\). For the lower bound, it has been pointed out in  that not knowing \(T\) may have a significant impact on the concentration of regret distribution for standard UCB policies. For the upper bound, as is pointed out in , an SE type policy will fail to obtain light-tailed regret distribution under the any-time design even for the basic MAB model. Meanwhile, it seems nontrivial to incorporate randomization into confidence bound based policies to handle the stochastic MAB model with non-stationary baseline rewards. We leave the question for future work.