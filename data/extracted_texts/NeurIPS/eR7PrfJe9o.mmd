# Classification of Heavy-tailed Features in High Dimensions: a Superstatistical Approach

Urte Adomaityte

Department of Mathematics

King's College London

urte.adomaityte@kcl.ac.uk

Gabriele Sicuro

Department of Mathematics

King's College London

gabriele.sicuro@kcl.ac.uk

Pierpaolo Vivo

Department of Mathematics

King's College London

pierpaolo.vivo@kcl.ac.uk

###### Abstract

We characterise the learning of a mixture of two clouds of data points with generic centroids via empirical risk minimisation in the high dimensional regime, under the assumptions of generic convex loss and convex regularisation. Each cloud of data points is obtained via a double-stochastic process, where the sample is drawn from a Gaussian distribution whose variance is itself a random parameter sampled from a scalar distribution \(\). As a result, our analysis covers a large family of data distributions, including the case of power-law-tailed distributions with no covariance, and allows us to test recent "Gaussian universality" claims. We study the generalisation performance of the obtained estimator, we analyse the role of regularisation, and we analytically characterise the separability transition.

## 1 Introduction

Generalised linear models (GLMs) are still ubiquitous in the theoretical research on machine learning, despite their simplicity. Their nontrivial phenomenology is often amenable to complete analytical treatment and has been key to understanding the unexpected behavior of large and complex architectures. Random features models , for example, allowed to clarify many aspects of the well-known double-descent phenomenon in neural networks . A line of research spanning more than three decades  has considered a variety of GLMs to investigate a number of aspects of learning in high dimensions. Yet, a crucial assumption adopted in many such theoretical models is that the covariates are obtained from a _Gaussian_ distribution, or from a mixture of Gaussian distributions . Although such a Gaussian design has served as a convenient working hypothesis (in some cases experimentally and theoretically justified ), it is however not obvious how much it limits the scope of the results. It is reasonable to expect structure, heavy tails, and large fluctuations in real (often non-Gaussian) data  to play an important role in the learning process, and it would be therefore desirable to include structured and heavy-tailed-distributed covariates in our theoretical toolbox.

This paper presents, to the best of our knowledge for the first time, the exact asymptotics for classification tasks on covariates obtained from a mixture of heavy-tailed distributions. We focus on supervised binary classification assuming that the sample size \(n\) and the dimensionality \(d\) of the space where the covariates live are both sent to infinity, keeping their ratio \(}{{d}}=\) fixed. The paper fits therefore in the line of works on exact high-dimensional asymptotics for classification learning via a GLM , but, crucially, we relax the usual Gaussian data hypothesis by including in ouranalysis power-law-tailed distributions with possibly no covariance. The mixture is obtained from two distributions, each centered around a centroid \(^{d}\) and resulting from a double stochastic process. Namely, each sample point is obtained from a distribution \((,)\) whose covariance \(=_{d}^{d d}\) is itself a random variable so that \(\) has density \(\), supported on \(^{+}_{*}\). Using, for example, an appropriately parametrised inverse-Gamma distribution for \(\), such a _superstatistical_ construction (as known in the physics literature ) can provide, for example, a heavy-tailed, Cauchy-like data distribution with infinite covariance. The replica method , an analytical tool widely adopted in statistical physics, provides asymptotic formulas for a generic density \(\), allowing us to study the effects of non-Gaussianity on the performance curves, and test Gaussian universality hypotheses  in such a classification task.

Motivation and related worksLearning a rule to classify data points clustered in clouds in high dimension is a classical problem in statistics . Its ubiquity is exemplified by the recently observed neural collapse phenomenon in deep neural networks, in which the last layer classifier was found to operate on features clustered in clouds around the vertices of a simplex ; more recently, Seddik et al.  showed that Gaussian mixtures suitably describe the deep learning representation of GAN data. In theoretical models, data points are typically assumed to be organised in \(K\)_Gaussian_ clouds, each corresponding to a class. Each class \(k\), \(k\{1,,K\}\), is centered around a mean vector \(_{k}\) and has covariance \(_{k}\). The binary classification case, \(K=2\), is the simplest, and possibly most studied, setting. For this case, Mai and Liao  considered an ERM task with generic convex loss and ridge regularisation in the high-dimensional regime \(n\), \(d+\) with \(}{{d}}(0,+)\). In this setting, they gave a precise prediction of the classification error, showing the optimality of the square loss in the unregularised case. Their results have been extended by Mignacco et al. , who showed that the presence of a regularisation can actually drastically affect the performance, improving it. In the same setting, the Bayes optimal estimator has been studied in both the supervised and the semi-supervised setting ; almost-Bayes-optimal solutions have been put in relation to wide flat landscape regions . In the context of binary classification, the maximum number \(n\) of samples that can be perfectly fitted by a linear model in dimension \(d\) has been the topic of investigation since the seminal work of Cover  and is related to the classical storage capacity problems on networks . The corresponding separability transition value \(=}{{d}}\) is remarkably associated with the existence transition of the maximum likelihood estimator . The precise asymptotic characterisation of the test error in learning to classify \(K 2\) Gaussian clouds with generic means and covariances has been recently obtained by Loureiro et al. . Within this line of research, rigorous results have been obtained by a variety of methods, such as Gordon's inequality technique  or mapping to approximate message passing schemes .

As previously mentioned, the working hypothesis of _Gaussian design_ is widely adopted in high-dimensional classification problems. On top of being a convenient technical hypothesis, this assumption has been justified in terms of a "Gaussian universality" principle. In other words, in a number of circumstances, non-Gaussian features distributions are found to be effectively described by Gaussian ones with matching first and second moments as far as the asymptotic properties of the estimators are concerned . Such a "universality property" has been rigorously proven for example in compressed sensing  or in the case of LASSO with non-Gaussian dictionaries . A Gaussian equivalence principle introduced by Goldt et al.  has been proven to hold for a wide class of generalised linear estimation problems . Extending work by Hu and Lu , Montanari and Saeed  recently proved such a principle in a GLM under the assumption of _pointwise normality_ of the distribution of the features. This crucial assumption can be intended, roughly speaking, as the assumption of sub-Gaussian decay of a marginal of the feature distribution in any direction (see also  for further developments).

The Gaussian universality principle, however, can break down by relaxing some of the aforementioned assumptions on the feature distribution. Montanari and Saeed  for example showed that pointwise normality is a _necessary_ hypothesis for universality. Studying regression tasks on an elliptically distributed dataset, El Karoui  showed that claims of "universality" obtained in the Gaussian setting require serious scrutiny, as the statistics of the estimators might strongly depend on the non-Gaussianity of the covariates . More recently, Pesce et al.  showed that a structured Gaussian mixture cannot be effectively described by a single Gaussian cloud. Building upon a series of contributions related to the asymptotic performance of models in the proportional high-dimensional limit , we aim precisely to explore the validity of Gaussian universality within classification problems.

In this paper, we work in a "superstatistical" data setting [5; 7], meaning that we superpose the statistics of Gaussian data distribution with an assumed distribution of its variance. Such a construction is adopted in a number of disciplines and contexts to go beyond Gaussianity, albeit is known under different names. In statistical physics, it is known as "superstatistics" and is employed in the analysis of non-equilibrium and non-linear systems . In Bayesian modeling, it is common to refer to hierarchical priors and models [22; 23], while in probability, statistics, and actuarial sciences such distributions are known as compound probability distributions , or doubly-stochastic models [60; 66]. Crucially, this construction allows us to consider a very large family of non-Gaussian distributions, which include, but are not limited to, any power-law decay and Cauchy-like with possible infinite-covariance parametrisations.

Our contributionsIn this manuscript we provide the following results.

\(\) We study a classification task on a non-Gaussian mixture model (see Eq. (1) below) via a generalised linear model (GLM) and we analytically derive, using the replica method [14; 19; 48], an asymptotic characterisation of the statistics of the empirical risk minimisation (ERM) estimator. Our results go therefore beyond the usual Gaussian assumption for the dataset, and include for example the case of covariates obtained from a mixture of distributions with infinite variance. The analysis is performed in the high-dimensional, proportional limit and for any convex loss and convex regularisation. By using this result, we provide asymptotic formulas for the generalisation, training errors and training loss.

\(\) We analyse the performance of this ERM task on a specific family of dataset distributions by using different convex loss functions (quadratic and logistic) and ridge regularisation. We show in particular that, in the case of two balanced clusters with a specific non-Gaussian distribution, the optimal ridge regularisation strength \(^{}\) is finite, at odds with the Gaussian case, for which \(^{}\). In this respect, by considering distributions with matching first and second moments, we analytically show that the performances of the analysed GLM do depend in general on higher moments, and therefore the "Gaussian universality principle" breaks down when heavy-tailed distributions are considered.

\(\) We derive the separability threshold on a large family of non-Gaussian dataset distributions, possibly with unbounded covariance, generalising the known asymptotics for the separability of Gaussian clouds . The result of Cover  is recovered in the case of infinite distribution width.

\(\) Under some moment conditions, we derive the Bayes-optimal performance in the case of binary classifications with symmetric centroids, generalising the argument in Ref. .

\(\) We finally extend recent results on Gaussian universality in the Gaussian mixture model with random labels [25; 59] to the case of non-Gaussian distributions. We show that the universal formula for the square training loss at zero regularisation found in Ref.  holds in our more general setting as well.

## 2 Main result

Dataset constructionWe consider the task of classifying two data clusters in the \(d\)-dimensional space \(^{d}\). The dataset \(\{(^{},y^{})\}_{[n]}\) is obtained by extracting \(n\) independent datapoints \(^{}\), each associated with a label \(y^{}\{-1,1\}\) (a more general setting, involving a multiclass classification task, is discussed in Appendix A). The data points are correlated with the labels via a law \(P(,y)\) which we assume to have the form

\[P(,y)=_{y,1} P(|_{+})+_{y,-1}(1-)P( |_{-}),(0,1),_{}^{d}.\] (1a) Here \[P(|)\] is a distribution with mean \[\], and the mean vectors \[_{}^{d}\] are distributed according to some density, such that \[[\|\|^{2}]=(1)\], and correspond to the center of the two clusters. The scalar quantity \[\] weighs the relative contribution of the two clusters: in the following, we will denote \[_{+}==1-_{-}\]. Each cluster distribution \[P(|)\] around a vector \[\] is assumed to have the form \[P(|)_{}[( |,_{d}.)],\] (1b) where \[(|,)\] is a Gaussian distribution with mean \[^{d}\] and covariance \[^{d d}\], and \[\] is randomly distributed with some density \[\] with support on \[^{+}_{+}(0,+)\]. The family of "elliptic-like" distributions in Eq. (1b) has been extensively studied, for instance, by the physics community, in the context of _superstatistics_[5; 7]. Mixtures of normals in the form of Eq. 1b are a central tool in Bayesian statistics  due to their ability to approximate any distribution given a sufficient number of components . Although the family in Eq. (1b) is not the most general of such mixtures, it is sufficient to include a large family of power-law-tailed densities and to allow us to go beyond the usual Gaussian approximation. El Karoui  considered the statistical properties, in the same asymptotic proportional regime as here, of ridge-regularised regression estimators on datasets with distribution as in Eq. 1b, under the assumption (here relaxed) that \([^{2}]<+\). This _elliptic_ family includes a large class of distributions with properties markedly different from the ones of Gaussians. For example, the inverse-Gamma with density \(()=(2^{3})^{-1/2}\,^{-}\) leads to a \(d\)-dimensional Cauchy-like distribution \(P(|)(1-\|-\|^{2})^{-}\), having as marginals Cauchy distributions and \([\|-\|^{2}]=+\). We will perform our classification task by searching for a set of parameters \((^{},^{})\), called _weights_ and _bias_, respectively, that will allow us to construct an estimator via a certain classifier \(\{-1,1\}\)

\[(^{}^{}}{}+ ^{}).\] (2)

By means of the above law, we will predict the label for a new, unseen data point \(\) sampled from the same law \(P(,y)\). Our analysis will be performed in the high-dimensional limit where both the sample size \(n\) and dimensionality \(d\) are sent to infinity, with \(}{{d}}\) kept constant.

Learning taskIn the most general setting, the parameters are estimated by minimising an empirical risk function in the form

\[(^{},^{})_{^{ }^{d}\\ b}(,) (,)_{=1}^{n}(y^{}, ^{}^{}}{}+)+ r().\] (3)

Here \(\) is a strictly convex loss function with respect to its second argument, and \(r\) is a strictly convex regularisation function with the parameter \( 0\) tuning its strength.

State evolution equations.Let us now present our main result, namely the exact asymptotic characterisation of the distribution of the estimator \(^{}^{d}\) and of \(}{{}}^{}^{n}\), where \(^{d n}\) is the concatenation of the \(n\) dataset column vectors \(^{}^{d}\), \([n]\). Such an asymptotic characterisation is performed via a set of order parameters satisfying a system of self-consistent "state-evolution" equations, which we will solve numerically. The asymptotic expressions for generalisation and training errors, in particular, are written in terms of their solutions, the order parameters. In the following, we use the shorthand \(_{}(u)( 1,u)\), and given a function \(\{-1,1\}\), we write \(_{}( 1)\) and \(_{}[_{}]_{+}_{+}+_{-}_{-}\).

**Result 2.1**: _Let \((0,1)\) and \(\), both independent from other quantities. Let also be \((0,_{d})\). In the setting described above, given \(_{1}^{d}\) and \(_{2}^{n}\), the estimator \(^{}\) and the vector \(^{}}^{}^{n}\) verify:_

\[_{1}(^{})[n,d]{}_{ }[_{1}()]}_{n,d+}_{}[ _{2}()],\] (4)

_where we have introduced the proximal \(^{d}\), defined as_

\[_{}(\|^{2}}{2}-_{k=}_{k}^{}_{k}-^{} {w}+ r())\] (5)

_and where we also have introduced the proximal for the loss \(^{n}\), obtained by concatenating \(_{+}n\) quantities \(h_{+}\) with \(_{-}n\) quantities \(h_{-}\), with \(h_{}\) given by_

\[h_{}_{}[)^{2}}{2 r}+ _{}(u)],_{} m_{}+b+.\] (6)

_The collection of parameters \((q,m_{},v,,_{},,b)\) appearing in the equations above is given by the fixed-point solution of the following self-consistent equations:_

\[m_{}=}_{}[^{}_{}],\\ q=_{}[\|\|^{2}],\\ v=^{-}{{2}}}_{}[^{}],=_{,, }[ f_{}^{2}],\\ =- q^{-}{{2}}}_{,,}[ {}f_{}],\\ _{}=_{}_{,}[f_{}], f_{}-_{}}{v },\\ b=_{,,}[h_{}-m_{}].\] (7)

[MISSING_PAGE_FAIL:5]

### Finite-covariance case

Let us start by considering a data distribution as in Eq. (11) with shape parameter \(a=c+1>1\), which is therefore given by

\[P(|)=(a-1)^{a}(a+d/2)}{(a)\,^{d/2}( 2a-2\|-\|^{2})^{a+d/2}}\] (12)

and decays as \(\|\|^{-2a-1}\) in the radial direction for \(\|-\| 0\). As a consequence, the distribution has \(_{a}{}^{}/d\{\|-\|^{k}\}=+\) for \(k 2a\). With this choice, _all elements of the family in Eq. (12) have the same covariance \(=[(-)(-)^{}]= _{d}\) as a is varied_, including the Gaussian limit \(P(|)(,_{d})\) obtained for \(a+\).

In Fig. 1 we present the results of our numerical experiments using the square loss and small regularisation. An excellent agreement between the theoretical predictions and the results of numerical experiments is found for a range of values of \(a\) and sample complexity \(\), both for balanced, i.e., equally sized, and unbalanced clusters of data (the plot for this case can be found in Appendix A.3). The test error \(_{g}\) presents the classical interpolation peak at \(=1\), smoothened by the presence of a non-zero regularisation strength \(\), and the typical double-descent behavior . As \(a\) is increased, the results of Mignacco et al.  for Gaussian clouds with \(P(|)=(|,_{d})\) are approached. The \(a+\) curves correspond, therefore, to the Gaussian mixture model we would have constructed by simply fitting the first and second moments of each class in the finite-\(a\) case. The plot shows that, at given population covariance \(=_{d}\), the classification of power-law distributed clouds is associated with different, and in particular smaller, errors than the corresponding task on Gaussian clouds with the same covariance: in this sense, no Gaussian errors are systematically smaller for unbalanced clusters than for balanced clusters (see Appendix A.3).

The same numerical experiment was repeated using the logistic loss for training. Once again, in Fig. 2, we focus on \(=}{{2}}\) and show that the theoretical predictions of the generalisation and training errors agree with the results of numerical experiments for a range of sample complexity values \(\) and various values of \(a\). Just as for the square loss, the test error \(_{g}\) of the Gaussian model (\(a+\)) is larger than the one observed for power-law distributed clouds at finite values of \(a\). In the \( 0\) limit, the typical interpolation cusp in the generalisation error is observed: the cusp occurs at different values of \(\) as \(a\) is changed; interpolation occurs at smaller values of \(\) for larger \(a\) (i.e., for "more Gaussian" distributions). A comparison with the test error \(_{t}\) confirms that this cusp occurs at the value of \(\) where the training error becomes non-zero and the two training data clouds become non-separable [70; 16]. This sharp transition in \(\) also corresponds to the existence transition of maximum-likelihood estimator in high-dimensional logistic regression, analysed for Gaussian data in Refs. [70; 49] and, in our setting, in Section 4 below. For larger regularisation strength, the cusp smoothens, and the training error becomes non-zero at smaller values of \(\).

Figure 1: Test error \(_{g}\) (solid line, _top_), training error \(_{t}\)_(center)_ and training loss \(_{}\)_(bottom)_ as predicted by Eq. (8) in the balanced \(=}{{2}}\) case. The dataset distribution is parametrised as in Eq. (12). The classification task is solved using a quadratic loss with ridge regularisation with \(=10^{-5}\). In the top figure, the dashed line corresponds to the Bayes optimal bound. Dots correspond to the average outcome of 50 numerical experiments in dimension \(d=10^{3}\). In our parametrisation, the population covariance is \(=_{d}\) for all values of \(a\) and moreover, for \(a+\), the case of Gaussian clouds with the same centroids and covariance is recovered. For further details on the numerical solutions, see Appendix B.

### Infinite-covariance case

The family of distributions specified by Eq. (11) allows us to also consider the case of infinite covariance, i.e., \(^{2}=+\). To test our formulas in this setting, we considered the case in which each cloud is obtained by "contaminating" a standard Gaussian with an infinite-covariance distribution as in Eq. (11b) with \(c=1\) and \(a<1\). In other words, we use the density \(()=r_{a,1}()+(1-r)(-1)\), with \(r\) interpolation parameter, for \(\) in Eq. (1). Each class has therefore infinite covariance for \(0<r 1\) and the Gaussian case is recovered for \(r=0\). Fig. 3 collects our results for two balanced clouds, analysed using square loss and logistic loss. Good agreement between the theoretical predictions and the results of numerical experiments is found for a range of values of sample complexity and of the ratio \(r\). In this case, the finite-variance case \(r=0\) corresponds, not surprisingly, to the lowest test error with both square loss and logistic loss, which grows with \(r\).

### The role of regularisation in the classification of non-Gaussian clouds

One of the main results in the work of Mignacco et al.  is related to the effect of regularisation on the performances in a classification task on a Gaussian mixture. They observed that, for all values of the sample complexity \(\), the optimal ridge classification performance on a pair of balanced clouds is obtained for an infinite regularisation strength \(\), using both hinge loss and square loss. We tested the robustness of this result beyond the purely Gaussian setting. In Fig. 4 (left), we plot the test error obtained using square loss and different regularisation strengths \(\) on the dataset distribution as in Eq. (12) with \(a=2\). We observe that, both in the balanced case and in the unbalanced case, the optimal regularisation strength \(^{}\) is _finite_ and, moreover, \(\)-dependent. On the other hand, if we fix \(\) and let \(a\) grow towards \(+\), the optimal \(^{}\) grows as well to recover the result of Mignacco et al.  of diverging optimal regularisation for _balanced_ Gaussian clouds, as shown in Fig. 4 (center)

Figure 3: Test error \(_{g}\) in the classification of two balanced clouds, via quadratic loss (_left_) and logistic loss (_right_). In both cases, ridge regularisation is adopted (\(=10^{-4}\) for the square loss case, \(=10^{-3}\) for the logistic loss case). Each cloud is a superposition of a power-law distribution with infinite variance and a Gaussian with covariance \(=_{d}\). The parameter \(r\) allows us to contaminate the purely Gaussian case (\(r=0\)) with an infinite-variance contribution (\(0<r 1\)) as in Eq. (11) with \(c=1\) and \(a=}{{2}}\) (_left_) or \(a=}{{4}}\) (_right_). Dots correspond to the average test error of 20 numerical experiments in dimension \(d=10^{3}\). Note that, at a given sample complexity, Gaussian clouds are associated with the lowest test error for both losses.

Figure 2: Test error \(_{g}\) (_top_), training error \(_{t}\) (_center_) and training loss \(_{t}\) (_bottom_) via logistic loss training on balanced clusters parametrised as in Eq. (12) (\(=_{d}\)). Ridge regularisation with \(=10^{-4}\) is adopted. Dots correspond to the average over 20 numerical experiments with \(d=10^{3}\). The Gaussian limit is recovered for \(a+\). Further details on the numerical solutions can be found in Appendix B.

for \(=2\). This result is represented also in Fig. 4 (right), where it is shown that, in the _unbalanced_ case, the optimal regularisation strength \(^{}\) instead saturates to a finite value for \(a+\), i.e., for Gaussian clouds .

## 4 The separability threshold

By studying the training error \(_{t}\) with logistic loss at zero regularisation we can obtain information on the boundary between the regime in which the training data are perfectly separable and the regime in which they are not. In other words, we can extract the value of the so-called separability transition complexity \(^{}\). Once again, a complete characterisation of this transition point is available in the Gaussian mixture case, where \(^{}\) can be explicitly given as a function of \(^{2}\).

It is not trivial to extend this result to the general case of non-Gaussian mixtures. It is, however, possible to derive \(^{}\) within the large family of "superstatistical" models we are considering here under the assumption that Result 2.1 holds. In this case, in Appendix A.3 we prove the following.

**Result 4.1**: _In the considered double-stochastic model, data are linearly separable for \(<^{}\), where_

\[^{}_{(0,1],}}{S( ,)}, S(,)_{0}^{}f^{2}_{}_{+}f+} 0,1+_{-}f+} 0,1f\,.\] (14)

Fig. 5 shows the values of \(^{}\) for different choices of the shape parameters \(a\) and \(c\) in the case of two balanced clouds of datapoints distributed as in Eq. (11b) as predicted by Eq. (14). In Fig. 5 (left), we fixed \(^{2}=<+\), and plotted the separability threshold \(^{}\) for a range of values of the shape parameter \(a>1\). As \(a\) grows, the known threshold value for the Gaussian mixture case is recovered . The double limit \(a\) and \(^{2}\), on the other hand, provides the Cover  transition value \(^{}=2\), as expected. In Fig. 5 (right), instead, we analyse the case of infinite-variance clusters, by fixing \(a(0,1)\) and by varying the scale parameter \(c\) in Eq. (11b), which controls the spread (width) of the distribution. The Cover transition is therefore correctly recovered as \(c\) diverges for all values of \(a\).

Figure 4: (_Left_) Test error for ridge regularised quadratic loss for various regularisation strengths. The data points of each cloud in the training set are distributed as in Eq. (12), with shape parameter \(a=2\), for balanced clusters (_top_) and unbalanced clusters (\(=}{{4}}\), _bottom_). Points are the results of 50 numerical experiments, and the dashed lines are Bayes-optimal bounds. (_Center_) Test error for different regularisation strengths \(\) for two _balanced_ clusters with quadratic loss at sample complexity \(=2\) using the data distribution (12). The optimal regularisation strength value \(^{}\) obtained from averaging 5 runs for each \(a\) is marked with a cross. (_Right_) Optimal regularisation strength \(^{}\) at \(=2\) for different values of \(a[1.5,10^{2}]\) for both balanced and unbalanced clusters, obtained from averaging 5 runs. Note that, for \(=}{{2}}\), \(^{}+\) as \(a+\).

[MISSING_PAGE_FAIL:9]

[MISSING_PAGE_FAIL:10]