# Leveraging Drift to Improve Sample Complexity of Variance Exploding Diffusion Models

Ruofeng Yang

John Hopcroft Center for Computer Science

Shanghai Jiao Tong University

wanshuiyin@sjtu.edu.cn

&Zhijie Wang

John Hopcroft Center for Computer Science

Shanghai Jiao Tong University

violetevergarden@sjtu.edu.cn

&Bo Jiang

John Hopcroft Center for Computer Science

Shanghai Jiao Tong University

bjiang@sjtu.edu.cn

&Shuai Li

John Hopcroft Center for Computer Science

Shanghai Jiao Tong University

shuaili8@sjtu.edu.cn

Corresponding authorJohn Hopcroft Center for Computer Science

Shanghai Jiao Tong University

shuaili8@sjtu.edu.cn

###### Abstract

Variance exploding (VE) based diffusion models, an important class of diffusion models, have shown state-of-the-art (SOTA) performance. However, only a few theoretical works analyze VE-based models, and those works suffer from a worse forward convergence rate \(1/(T)\) than the \(\) of variance preserving (VP) based models, where \(T\) is the forward diffusion time and the rate measures the distance between forward marginal distribution \(q_{T}\) and pure Gaussian noise. The slow rate is due to the Brownian Motion without a drift term. In this work, we design a new drifted VESDE forward process, which allows a faster \(\) forward convergence rate. With this process, we achieve the first efficient polynomial sample complexity for a series of VE-based models with reverse SDE under the manifold hypothesis. Furthermore, unlike previous works, we allow the diffusion coefficient to be unbounded instead of a constant, which is closer to the SOTA models. Besides the reverse SDE, the other common reverse process is the probability flow ODE (PFODE) process, which is deterministic and enjoys faster sample speed. To deepen the understanding of VE-based models, we consider a more general setting considering reverse SDE and PFODE simultaneously, propose a unified tangent-based analysis framework, and prove the first quantitative convergence guarantee for SOTA VE-based models with reverse PFODE. We also show that the drifted VESDE can balance different error terms and improve generated samples without training through synthetic and real-world experiments.

## 1 Introduction

Recently, diffusion modeling has shown impressive performance in different areas (Ho et al., 2022; Rombach et al., 2022; Esser et al., 2024; Li et al., 2024). Diffusion models consist of two processes: the forward and reverse process. The forward process gradually converts data \(q_{0}\) to Gaussian noise, which can be described by an intermediate marginal distribution sequence \(\{q_{t}\}_{t[0,T]}\). The reverse process sequentially predicts noise and removes it from data to generate samples.

There are two common forward processes: (1) Variance preserving (VP) SDE and (2) variance exploding (VE) SDE. The VPSDE corresponds to an Ornstein-Uhlenbeck process, and the stationary distribution is \((0,)\). The VESDE has an exploding variance in the forward process. In earliertimes, VP-based models (Ho et al., 2020; Lu et al., 2022) provide an important boost for developing diffusion models. Recently, VE-based models have shown the ability to generate data distribution supported on low-dimensional manifolds (Song and Ermon, 2019, 2020). Since image and text datasets typically exhibit a low-dimensional manifold nature (Pope et al., 2021; Tang and Yang, 2024), VE-based models have achieved great performance in image generation, one-step generation, and reinforcement learning (Teng et al., 2023; Song et al., 2023; Ding and Jin, 2023). Furthermore, Karras et al. (2022) unify VP and VESDE and prove that the ODE solution trajectory of a specific VESDE is linear and directly towards the data manifold, which makes the denoise process easy.

After determining a forward SDE, diffusion models reverse it and generate samples by running the corresponding reverse process. Since the reverse drift term contains the gradient of forward logarithmic density \( q_{t}\) (a.k.a. score function), we estimate it by using the score matching technique (Vincent, 2011). After that, diffusion models discretize the continuous reverse process and run this discrete process starting from pure Gaussian. There are two widely used reverse processes: reverse SDE (Ho et al., 2020) and probability flow ODE (PFODE) (Song et al., 2020). The reverse SDE usually generates higher quality samples (Kim et al., 2022). The reverse PFODE always has a faster generation speed and is useful in other aspects such as calculating likelihoods (Song et al., 2020) or obtaining one-step generation models (Song et al., 2023). Hence, these processes are both critical, and providing the guarantee for VE-based models with these processes is necessary.

Recently, many works analyze the convergence guarantee of the VP-based diffusion models under the reverse SDE setting and prove that the VP-based models can sample from the target data distribution with polynomial complexity (Chen et al., 2023;c,a,b, Lee et al., 2023; Benton et al., 2023). As the first step of this work, we also analyze VE-based models under the reverse SDE setting. Different from the VP-based models, only a few works consider VE-based models and all of them suffer from slow \(1/(T)\) forward convergence rate (Lee et al., 2022; Gao et al., 2023; Gao and Zhu, 2024), which is worse than \((-T)\) one for VPSDE. A slow forward convergence rate makes a large distance between \(q_{T}\) and pure Gaussian noise, which leads to a large reverse beginning error. From the theoretical perspective, this error introduces hardness to balance three error sources, as shown in Section 5. From the empirical perspective, Lin et al. (2024) show that this error introduces a data information leakage problem, which leads to bad performance. To deal with this problem, De Bortoli et al. (2021) introduce a small drift term to obtain a \()}\) reverse beginning error. However, they introduce an additional \(\) in the discretization error term. Furthermore, their results do not allow unbounded \(_{t}\), which is the key point of the optimal solution trajectory and used by the SOTA models (Karras et al., 2022; Song et al., 2023). Therefore, the following question remains open:

_Is it possible to design a VESDE with a faster forward convergence rate than \(1/(T)\) and achieve the polynomial sample complexity when the diffusion coefficient is unbounded?_

In this work, for the first time, we propose a new drifted VESDE forward process, which enjoys a faster forward convergence rate and allows unbounded coefficients. We first show that the drifted VESDE has similar trends but performs better than the original SOTA VESDE on synthetic data (Section 7). After that, we analyze the sample complexity of drifted VESDE under the realistic manifold hypothesis. The manifold hypothesis means the data \(q_{0}\) is supported on a lower dimensional compact set \(\), and much empirical evidence shows that image and text dataset satisfy this hypothesis (Fefferman et al., 2016; Pope et al., 2021; Tang and Yang, 2024). Furthermore, as shown in Section 2, the manifold hypothesis is more realistic than previous data assumptions since it allows the blow-up phenomenon of the score function at the end of the reverse process, which matches the empirical observation (Kim et al., 2021). Under the manifold hypothesis, we prove that the drifted VESDE with a suitable larger \(_{t}\) balances the reverse beginning, discretization, and approximated score errors and achieves the first efficient polynomial sample complexity for VE-based models with reverse SDE.

To better understand VE-based models, we analyze reverse SDE and PFODE simultaneously after obtaining polynomial complexity for reverse SDE. Despite the great performance, a few theoretical works consider reverse PFODE (Chen et al., 2023;d,b, Gao and Zhu, 2024), and these works either focus on VPSDE or have strong assumptions. Hence, we propose the tangent-based framework for VE-based models and achieve the first quantitative convergence for the SOTA VE-based models with reverse PFODE. In conclusion, we accomplish the following results under the manifold hypothesis:

1. We propose a new drifted VESDE forward process, which allows \(\) forward convergence guarantee with suitable \(_{t}\). With this process, we achieve the first polynomial sample complexity for a series of VE-based models under the reverse SDE setting.

2. When considering the general setting, we propose the tangent-based unified framework and analyze reverse SDE and PFODE simultaneously. Under this framework, we prove the first quantitative guarantee for SOTA VE-based models with reverse PFODE.
3. We show that the drifted VESDE balances different error terms and improves generated samples without training via synthetic and real-world experiments.

## 2 Related Work

Before providing current results, we first discuss different assumptions about the data distribution from strong to weak. The strongest assumption is the log-concave distribution. While the log-Sobelev inequality (LSI) assumption is slightly weaker, it does not allow the presence of substantial non-convexity, which is far away from the multi-modal distribution. Recently, some works assume the score function is \(L\)-Lipschitz to allow the multi-modal distribution. However, this assumption can not explain the blow-up phenomenon of score (Kim et al., 2021). The last assumption is the manifold hypothesis, which is supported by much empirical evidence and allows the blow-up score.

**Analyses for VP-based models.** For the reverse SDE, Lee et al. (2022) achieve the first polynomial complexity with strong LSI assumption. Chen et al. (2023) remove the LSI assumption, assume the Lipschitz score and achieve polynomial complexity. Bortoli (2022) is the first work to focus on the sample complexity of diffusion models under the manifold hypothesis, and it is the most relevant work to our unified framework. However, as discussed in Section 6.1, the original tangent-based lemma can not deal with reverse PFODE even in VPSDE. We carefully control the tangent process to avoid additional \(\) by using the exploding variance property of VESDE. Recently, Chen et al. (2023) and Benton et al. (2023) also remove the Lipschitz score assumption, and Benton et al. (2023) achieve optimal dependence on \(d\). More recently, Conforti et al. (2023) use bounded Fisher information assumption and replace \(d\) with a Fisher information term.

For the PFODE, Chen et al. (2023) propose the first quantitative result with exponential dependence on the Lipschitz constant. Chen et al. (2023) achieve polynomial complexity by introducing a corrector component to inject suitable noise. More recently, Li et al. (2023) remove the additional corrector. However, their results rely heavily on the very specific \(_{t}\), which goes to \(0\) as \(T+\). Since VE-based models have an unbounded \(_{t}\), this method is not suitable for our models.

**Analyses for VE-based models.** When considering VESDE, most works focus on constant \(_{t}\) and reverse SDE. De Bortoli et al. (2021) provide the first convergence guarantee with exponential dependence on \(T\). Lee et al. (2022) analyze a constant diffusion coefficient VESDE and achieve polynomial sample complexity under the LSI assumption. When considering the reverse PFODE, Chen et al. (2023) only consider the discretization error and provide a quantitative convergence guarantee. However, their results introduce additional \(\) compared to ours (Section 6.1). Recently, Gao et al. (2023) and Gao and Zhu (2024) provide the polynomial results for a series of VESDE with reverse SDE and reverse PFODE under the log-concave assumption, respectively.

## 3 The Drifted Variance Exploding (VE) SDE

Diffusion models usually consist of a forward process and a reverse process. The forward process gradually injects noise to convert the data distribution to pure noise. To generate samples, diffusion models reverse the forward process and run the corresponding reverse process.

This section first recalls two previous forward processes: VPSDE and VESDE. Recently, the VE-based models achieve great performance in application (Karras et al., 2022; Song et al., 2023). However, unlike the widely analyzed VP-based models (Benton et al., 2023; Chen et al., 2023), the VE-based models suffer from challenges in obtaining an efficient sample complexity due to the slow forward convergence rate. To address this limitation, we introduce a new drifted VESDE forward process, which has a faster forward convergence rate, balances different error terms and achieves the first efficient polynomial sample complexity (see Section 5). Finally, we introduce how to reverse this new forward process and obtain an implementable algorithm.

### The VP and VESDE of Diffusion Models

We first introduce the general form of the forward process and then recall two common forward processes, VPSDE and VESDE, adopted in previous works (Ho et al., 2020; Karras et al., 2022). Let\(q_{0}\) be the data distribution. Given \(_{0}^{d}\), the forward process is defined by

\[_{t}=f(_{t},t)\:t+g(t)\: _{t},_{0} q_{0}\,,\]

where \((_{t})_{t 0}\) is the standard Brownian motion in \(^{d}\), \(f(_{t},t)\) is a drift coefficient and \(g(t)\) is a diffusion coefficient. Let \(q_{t}\) be the density function of \(_{t}\) at time \(t\). With a suitable choice of drift and diffusion terms (e.g. Section 3.1 and 3.2), the forward process gradually converts the data distribution into Gaussian noise. More specifically, the conditional distribution \(_{t}|_{0}\) is exactly \((m_{t}_{0},_{t}^{2})\) given \(_{0}\), where \(m_{t}\) is determined by the drift term and \(_{t}^{2}\) is determined by the diffusion term.

**The VPSDE forward process.** Let \(\{_{t}\}_{t 0}\) be a non-decreasing sequence with bounded range \([1/,]\). The VPSDE has the following formula:

\[_{t}=-_{t}_{t}\:t+}\:_{t}\,,_{0} q_{0}\,.\] (1)

In this case, \(m_{t}=(-_{0}^{t}_{s}s)\) and \(_{t}^{2}=1-m_{t}^{2}\). Note that \(m_{T}(-T/),\)which indicates a fast forward convergence rate \((q_{T}|(0,))(-T/)\)(Chen et al., 2023c).

**The VESDE forward process.** The VESDE forward process is defined without a drift term:

\[_{t}=_{t}^{2}/t}\: _{t}\,,_{0} q_{0}\,.\] (2)

Two common choices for \(_{t}^{2}\) are \(t\) and \(t^{2}\), with the latter achieving SOTA performance (Karras et al., 2022; Teng et al., 2023). However, VESDE only has a slow polynomial-decay forward convergence rate (Theorem 4.2), which introduces hardness to obtain an efficient sample complexity (see Section 5). This motivates us to design an improved VESDE process with a fast forward convergence rate.

### The Drifted VESDE Forward Process

Note that the forward convergence rate of the general process is upper bounded by \(m_{T}/_{T}^{2}\)(Theorem 4.2). In practical applications (Ho et al., 2020; Karras et al., 2022; Song et al., 2023), the variance of the forward process \(_{t}^{2}\) at time \(T\), which is determined by the diffusion term, does not exceed \(T^{2}\). This indicates the contribution of \(_{T}^{2}\) to the forward convergence rate is only \(1/(T)\). Hence, the exponential-decay forward convergence rate of VPSDE comes from the drift term, which introduces an exponential-decay \(m_{t}(-T/)\). Due to the absence of the drift term in VESDE, the data information, such as expectation \([q_{0}]\) and covariance \([q_{0}]\), does not decay and \(m_{t} 1\), which is a key to an only polynomial-decay forward convergence rate \(m_{T}/_{T}^{2} 1/(T)\). With the drift term, the VPSDE gradually removes the data information from \(q_{t}\) during the process, which makes \(q_{t}\) quickly converge to pure Gaussian noise. Inspired by this elimination effect of the drift term, we propose a drifted VESDE forward process:

\[_{t}=-_{t}_{t}\:t+ }\:_{t},_{0} q_{0}\,,\] (3)

where \([T,T^{2}]\) is the coefficient used to balance the drift and diffusion term 2, and \(\{_{t}\}_{t 0}\) is a positive non-decreasing sequence. In this case,

\[m_{t}=(-_{0}^{t}_{s}/\:s)\:\: _{t}^{2}=(1-m_{t}^{2})\,.\] (4)

We show that the drifted VESDE is not only an effective representation of the existing VESDE but also extends beyond it (see Section 7 and Appendix A.1). We also prove that this process with suitable \(_{t}\) has a \((-T)\) forward convergence rate and enjoys an efficient polynomial sample complexity.

### The Reverse Process of the Drifted VESDE

To generate samples from Gaussian noise, a diffusion model reverses the forward process. Let \(q_{t}^{}\) be the density function of the drifted VESDE forward process at time \(t\) and \((_{t})_{t[0,T]}=(_{T-t})_{t[0,T]}\). As shown in Cattiaux et al. (2021), the reverse process of drifted VESDE has the following form 3:

\[_{t}=_{T-t}\{_{t}/+(1+^{2})  q_{T-t}^{}(_{t})\}t+ }\:_{t}\,.\] (5)The parameter \(\) is used to determine the type of reverse processes. There are two common reverse processes in the application: reverse probability flow ODE (PFODE) (\(=0\)) (Song et al., 2020, 2023) and reverse SDE (\(=1\)) (Ho et al., 2020).

To generate distribution \(q_{0}\) through running the above reverse process, diffusion models need the true score function \( q_{T-t}^{}(_{t})\) and the accurate reverse beginning distribution \(q_{T}^{}\). However, \( q_{T-t}^{}(_{t})\) and \(q_{T}^{}\) contain the data information and usually can not be exactly calculated. For the score function, diffusion models approximate it using a score network \((T-t,)\) by minimizing the score matching objective function (Vincent, 2011). For the initial distribution of the reverse process, since \(q_{T}^{}\) should be close to a pure Gaussian, we choose \(q_{}^{}=(0,_{T}^{2})\) as an approximation. Then, the continuous reverse process \((}_{t})_{t[0,T]}\), incorporating \((T-t,)\) and \(q_{}^{}\), is defined as:

\[}_{t}=_{T-t}}_{t }/+(1+^{2})(T-t,}_{t})}t +}\;_{t}\,,}_{0} q_{}^{}\,.\]

Since diffusion models can not run a continuous process due to the nonlinear score function, these models usually discretize the above continuous process and freeze the approximated score at the beginning of each interval. Let \(\{_{k}\}_{k[K]}\) be the stepsize and \(t_{k+1}=_{j=0}^{k}_{j}\). As shown in Kim et al. (2021), \( q_{T-t}^{}(_{t})\) goes to \(+\) at the end of the reverse process. To mitigate this issue, they use the early stopping technique \(t_{K}=T-\), and we also employ this technique in this work. With the stepsize, we choose the exponential integrator discretization scheme (Zhang and Chen, 2022) to discretize the above process, which runs the following process:

\[}_{t}=_{T-t} }_{t}/+(1+^{2})(T-t_{k},}_{t_{k}}) }t+}\;_{t}\,, t[t_{k},t_{k+1}]\,.\] (6)

As shown in Karras et al. (2022), the choice of \(_{t}\) significantly affects the performance of models, and we need to determine \(_{t}\) before running the reverse process. The state-of-the-art diffusion models adopt \(_{t}=t\), which increases rapidly and has an unbounded range. However, current theoretical works assume \(_{t}\) to be a constant (Chen et al., 2023c) or confined to a bounded interval \([1/,]\)(Bortoli, 2022) to match the setting of VPSDE. To align more closely with practical applications of VE-based models, we allow an unbounded \(_{t}\) in this work. Furthermore, we make a detailed assumption on \(_{t}\) when considering different reverse processes.

**Assumption 3.1**.: Let \(\{_{t}\}_{t 0}\) be a positive, non-decreasing sequence. For any \([T,T^{2}]\), there exists constants \(\) and \(C\), such that for any \(t[0,T]\): (1) for \(=0\), then \(1/_{t}\{,t\}\) and \(_{0}^{T}_{t}/\;t C\); (2) for \(=1\), then \(1/_{t}\{,t^{2}\}\).

As shown in Chen et al. (2023b), due to the absence of the stochasticity, the small errors for quickly accumulate and are magnified. Hence, we assume a conservative \(_{t}\) for the reverse PFODE, whose growth rate is at most \(t\), to avoid an additional \(\) in the convergence guarantee (see Section 6.1). We note that this choice of \(_{t}\) is satisfied in practical applications (Song et al., 2020b; Karras et al., 2022). For the reverse SDE setting, we assume the growth rate of \(_{t}\) can depend on \(\) instead of at most linear. For example, when \(=T^{2}\), we can choose \(_{t}=t^{2}\), which has the same order as \(\). As shown in Theorem 4.2, the drifted VESDE with aggressive \(_{t}=t^{2}\) has an exponential-decay forward convergence rate, which leads to the first efficient polynomial complexity for VE-based models.

**Notations.** For \(x^{d}\) and \(A^{d d}\), we denote by \(\|x\|\) and \(\|A\|\) the Euclidean norm for vector and the spectral norm for matrix. We denote by \(_{K}=_{k\{0,,K-1\}}_{k}\) the maximum stepsize for \(k[0,K-1]\). We denote by \(q_{0}P_{T}\) the distribution of \(_{T}\), \(Q_{t_{K}}^{q_{}^{}}\) the distribution of \(_{t_{K}}\), \(R_{K}^{q_{}^{}}\) the distribution of \(}_{t_{K}}\) and \(Q_{t_{K}}^{q_{0}P_{T}}\) the distribution which does reverse process starting from \(q_{T}^{}\) (Eq. 5). We denote by \(_{1}\) and \(_{2}\) the Wasserstein distance of order one and two, respectively.

## 4 The Faster Forward Convergence Rate for the Drifted VESDE

This section shows that the drifted VESDE has a fast forward convergence rate. Since \(q_{T}^{}\) contains the data information, we first introduce the manifold hypothesis before controlling \((q_{T}^{},q_{}^{})\).

**Assumption 4.1**.: \(q_{0}\) is supported on a compact set \(\) and \(0\).

We denote \(R\) the diameter of the manifold by \(R=\{\|x-y\|:x,y\}\) and assume \(R>1\). As shown in Section 1, the manifold hypothesis is supported by much empirical evidence (Bengioet al., 2013; Fefferman et al., 2016; Pope et al., 2021) and allows the blow-up phenomenon of the score. Recently, Tang and Yang (2024) show that diffusion models can adapt to the intrinsic manifold structure. With Assumption 4.1, we obtain the forward process guarantee for the drifted VESDE.

**Theorem 4.2**.: _Assume Assumption 4.1 and 3.1. Let \(q_{}^{}=(0,_{T}^{2})\). With \(m_{T},_{T}\) defined in Equation (4), we have \((q_{T}^{},q_{}^{})}/_ {T}\), where \(=d|c|+[q_{0}]+R\) and \(c\) is the eigenvalue of \([q_{0}]\) with the largest absolute value._

Recall that \(m_{T}=(-_{0}^{T}_{t}/\;t)\), the previous VESDE (Song et al., 2020; Karras et al., 2022; Lee et al., 2022) chooses a conservative \(_{t}\) satisfies \(_{0}^{T}_{t}/\;t C\). However, with an aggressive \(_{t}\), the drifted VESDE will have a faster convergence rate. To illustrate the accelerated forward process, we use \(=T^{2}\) as an example and discuss different \(_{t}=t^{_{1}},_{1}\). Due to the definition of \(_{T}\), \(_{T} T\), and the forward convergence rate mainly depends on \(}\). When \(_{1}=1\) is conservative, \(m_{T}\) is a constant, and the convergence rate is \(1/T\). When \(_{1}=1+(2r(T))/(T)\) is slightly aggressive, the convergence rate is \(1/T^{r+1}\) for \(r>0\). When \(_{1} 1+(T-(T))/(T)\) is aggressive, the convergence rate is faster than \((-T)\). In our analysis, whether \(_{t}\) can be aggressive depends on the reverse process (see Section 6). When choosing an aggressive \(_{t}\), the drifted VESDE achieves an improved sample complexity compared with pure VESDE (see Section 5).

## 5 The Polynomial Complexity for a Series of VESDE with Reverse SDE

In this section, we first pay attention to the reverse SDE (\(=1\)) to show the power of the drifted VESDE. More specifically, we show that our general drifted VESDE form covers the current models (VP and VESDE). After that, we show that drifted VESDE can go beyond the current models and achieve an improved complexity with an aggressive \(_{t}\). Since the objective function minimizes the \(L_{2}\) distance between the ground truth and the approximated score, we assume that the approximated score is \(L_{2}\)-accuracy, which is exactly the same with Chen et al. (2023c) and Benton et al. (2023).

**Assumption 5.1**.: \(_{q_{t_{k}}}[\|s_{t_{k}}- q_{t_{k}}^{}\| ^{2}]_{}^{2}\) for \( k[K]\).

With this assumption, we provide a universe convergence guarantee for \([1,T^{2}]\) and \(_{t}[1,t^{2}]\) and discuss the sample complexity of VP and VE-based models in detail.

**Theorem 5.2**.: _Assume Assumption 3.1, 4.1, 5.1. Let \(\) defined in Theorem 4.2, \(_{K}=_{k\{0,,K-1\}}_{k}\), \(=T^{2}\) and \(_{t}[1,t^{2}]\). Then, we have that_

\[(R_{K}^{q_{}^{}},q_{}) }}{_{T}}+}{_{}^{4}}_{K}_{T} T}+_{}T}\,.\]

To guarantee the above convergence guarantee smaller than \((_{})\), each component of the result needs to be smaller than \(_{}\). As shown in Remark 5.3, it is difficult for pure VESDE to balance the approximated score and the first two error terms to achieve an efficient sample complexity. Hence, we discuss how to balance the reverse beginning and discretization error. More specifically, we require \(}/_{T}_{}\) and \(_{K}_{}^{8}_{}^{2}/(R^{4}d _{T} T)\), where the first inequality determines the order of \(T\) and the second inequality determines the stepsize \(_{K}\). After that, with sample complexity \(K=T/_{K}\), we have that \((R_{K}^{q_{}^{}},q_{})(_{ })\). The last step is to guarantee \(q_{}\) and \(q_{0}\) is close enough \(W_{2}^{2}(q_{0},q_{})_{W_{2}}^{2}\), which requires \(_{}^{2}_{W_{2}}^{2}/(d+R)\).

Following the above process, this general convergence guarantee leads to the polynomial sample complexity for VP and VE-based models. When \(_{t}=1\) and \(=1\), the drifted VESDE becomes VPSDE and achieve the complexity \((1/(_{W_{2}}^{8}_{}^{2}))\), which achieve exactly the same order compared with Chen et al. (2023c). When \(_{t}=1\) and \(=T\), our formula is similar but slightly better (Figure 2 and 3) to pure VESDE (\(_{t}^{2}=t\)) and achieves \(O(1/_{W_{2}}^{8}_{}^{4})\) result. For \(_{t}=t\) and \(=T^{2}\), the general formula is similar to SOTA pure VESDE (\(_{t}^{2}=t^{2}\)) and achieves the first polynomial results \(O(1/_{W_{2}}^{8}_{}^{7})\) for this model under the manifold hypothesis4.

Although we achieve the first polynomial sample complexity for VE-based models under the manifold hypothesis, it is clear that the results of the VE-based models are significantly worse than the result 

[MISSING_PAGE_FAIL:7]

_(1) If \(=1\) (the reverse SDE), choosing \(_{t}=t^{2}\), \(W_{1}(R_{K}^{q_{}^{}},q_{0})\) is bounded by_

\[(+)+(}{2}(}{^{3}}+))(C_{1}()T_{1}^{2}( )((}{^{3}}+)_{K}^{1/2}+1 )_{K}^{1/2}+e^{-T/2}}{}),\]

_where \(_{1}()=T^{2}(1/+/^{3})\) and \(C_{1}()\) is linear in \(^{2}\)._

_(2) If \(=0\) (PFODE), choosing a conservative \(_{t}\) (Assumption 3.1), \(W_{1}(R_{K}^{q_{}^{}},q_{0})\) is bounded by_

\[(+)+(}{2}(}{^{2}}+))(C_{2}()_{2}^{2}( )T((}{^{2}}+)_{K}^{1 /2}+1)_{K}^{1/2}+}{}),\]

_where \(_{2}()=T(1/+/^{2})\) and \(C_{2}()\) is linear in \(^{2}\)._

Theorem 6.1 proves the first quantitative guarantee for VE-based models with reverse PFODE using the unified tangent-based framework. Correspondingly, the Girsanov-based method [Chen et al., 2023c,a] can not deal with reverse PFODE since the reverse process diffusion term is not well-defined. Recently, Chen et al. [2023d] employ the Restoration-Degradation framework to analyze VESDE with reverse PFODE, which also has exponential dependence on \(R\) and \(\). Furthermore, their results have exponential dependence on \(_{t}\) (\(g_{}\) in Chen et al. [2023d]), which corresponds to \(\). However, our dependence on \(\) appears in the polynomial term. Hence, our framework is a suitable unified framework. Furthermore, we emphasize that our tangent-based unified framework is not a simple extension of Bortoli . We carefully control the tangent process according to the variance exploding property of VESDE to avoid \((T)\) term when considering PFODE (Section 6.1).

Theorem 6.1 has exponential dependence on \(R\) and \(\), which is introduced by the tangent process. Similar to Bortoli , if we assume the Hessian \(\|^{2} q_{t}(x_{t})\|/_{t}^{2}\), we obtain a better control on the tangent process and replace the exponential dependence on \(\) by a polynomial dependence on \(\) and exponential dependence on \(\) when considering reverse PFODE.

**Corollary 6.2**.: _Assume Assumption 3.1, 4.1 and \(\|^{2} q_{t}(x_{t})\|/_{t}^{2}\). Let \(=0\) (reverse PFODE), \((0,1/32),=T^{2}\), \(_{t}=t\) and \(_{2}(),C_{2}()\) defined in Theorem 6.1, we have_

\[W_{1}(R_{K}^{q_{}^{}},q_{0})(+ )+^{}}{^{}} ()(C_{2}()_{2}^{2}()T((}{^{2}}+)_{K}^{1/2}+1) _{K}^{1/2}+}{}).\]

Though the additional assumption is strong, many special cases, such as hypercube \(=[-1/2,1/2]^{p}\) satisfy this assumption. We emphasize that our analysis also holds for VESDE (\(_{t}^{2}=t^{2}\)) with reverse PFODE, which means our results can explain the SOTA model in Karras et al. .

### The Discussion on the Unified Framework

In this section, we introduce the unified tangent-based framework for reverse SDE and PFODE and discuss key steps to achieve the quantitative guarantee for PFODE. Firstly, we decompose the goal \(W_{1}(R_{K}^{q_{}^{}},q_{0})\) into three terms: \(W_{1}(R_{K}^{q_{}^{}},Q_{t_{K}}^{q_{}^{}})+W_{1 }(Q_{t_{K}}^{q_{}^{}},Q_{t_{K}}^{q_{}P_{T}})+W_{1} (Q_{t_{K}}^{q_{0}P_{T}},q_{0})\).

These terms correspond to the discretization scheme, reverse beginning distribution, and the early stopping parameter \(\). We focus on most difficult discretization term and first recall the stochastic flow of the reverse process for any \(x^{d}\) and \(s,t[0,T]\) with \(t s\):

\[_{s,t}^{x}=_{T-t}\{_{s,t}^{x}/+ (1+^{2}) q_{T-t}(_{s,t}^{x}) \}t+}_{t}\,,\]

where \(_{s,s}^{x}=\), the corresponding tangent process is

\[_{s,t}^{x}= _{T-t}_{s,t}^{x}/t+_{T-t} (1+^{2})^{2} q_{T-t}(_{s,t}^{x}) _{s,t}^{x}t\,.\]

The key of the discretization error is to bound tangent process \(\|_{s,t_{K}}^{x}\|\). For this term, we consider the reverse SDE and PFODE simultaneously and propose a general version of Bortoli .

**Lemma 6.3**.: _Assume Assumption 3.1 and 4.1. For \( s[0,t_{K}]\) and \(x^{d}\), we have_

\[\|_{s,t_{K}}^{x}\|(}{2_{T -t_{K}}^{2}}+)}{2}_{0}^{t_{K}}}{} u)\,.\]We emphasize that the general bound for the tangent process is the key to achieving the guarantee for VESDE with the reverse ODE. Recall that in the original lemma for the tangent processes, since \(\) is independent of \(T\) and \(_{t}\) is bounded in a small interval \([1/,]\), \(_{0}^{t_{K}}_{T-u}/u=(T)\), which means there is an additional \(\) when considering VPSDE with revere PFODE. However, our tangent-based lemma makes use of the variance exploding property of VESDE to guarantee that \(_{0}^{T}_{t}/t C\) with a conservative \(_{t}=t\) when considering reverse PFODE. When \(=1\), we choose aggressive \(_{t}=t^{2}\) since the choice of \(_{t}\) does not affect the bound of the tangent process.

For the early stopping term, it corresponds to \(\) and is smaller than \(2(R/+)\). Since we can not use the data processing inequality in Wasserstein distance, the reverse beginning terms consists of the bound of tangent process term and the forward process term:

\[W_{1}(Q_{t_{K}}^{q_{}^{}},Q_{t_{K}}^{q_{0}P_{T}}) }}{_{T}}(}{2_{T-t_{K}} ^{2}}+)}{2}_{0}^{t_{K}}}{}u)\,.\]

One notable future work is introducing the short regularization technique  and suitable corrector to remove the above exponential dependence.

## 7 Experiments

In this section, we show the power of the drifted VESDE forward process through experiments. Section 7.1 shows that aggressive one achieves good balance in different error terms. After that, we consider the approximated score and show that the conservative one can improve the quality of the generated distribution without training in the synthetic and real-world setting.

### The Aggressive Drifted VESDE Balances Errors

In this section, we do experiments on 2-D Gaussian to show that the aggressive drifted VESDE balances different errors. Since the ground truth score of the Gaussian can be directly calculated, we use the accurate score function to discuss the balance between the other two error terms clearly. We show how to use approximated score in Section 7.2.

As shown in Figure 2, the process with aggressive \(_{t}=t^{2}\) achieves the best and second performance in EI and EM discretization, which supports our theoretical result (Corollary 5.4). The third best process is conservative \(_{t}=t\) with the small drift term. The reason is that though it can not achieve a \(\) forward guarantee, it also has a constant decay on prior information, which slightly reduces the effect of the reverse beginning error (Section 3.1). The worst process is pure VESDE since it is hard to balance different error sources. Our experimental results also show that EI is better than EM.

Figure 1: Experiment results of Swiss roll with Euler Maruyama Method (Reverse SDE)

Figure 2: Results of \(2\)-D Gaussian

### The Conservative Drifted VESDE Benefits from VESDE without Training

As shown in Figure 2, the red and orange lines have similar trends. Hence, for conservative drifted VESDE, which satisfies (2) of Assumption 3.1, we can directly use the models trained by pure VESDE to improve the quality of generated distribution. We confirm our intuition by training the model with pure VESDE with \(_{t}^{2}=t\) and directly use the models to conservative drifted VESDE with \(_{t}=1\) and \(=T\). From the experimental results (Figure 1), it is clear that pure VESDE has a low density on the Swiss roll except for the center one, which indicates pure VESDE can not deal with large dataset variance, as we discuss in Section 4. For conservative drift VESDE, as we discuss in the above section, it can reduce the influence of the dataset information. Figure 1 (c) supports our augmentation and shows that the density of the generated distribution is more uniform compared to pure VESDE, which means that the drift VESDE can deal with large dataset mean and variance.

Beyond the synthetic data, we show that our conservative drifted VESDE can improve the generated images of pure VESDE without training on the real-world CelebA256 dataset. From the qualitative perspective, as shown in Figure 3, the images generated by our drifted VESDE have more detail (such as hair and beard details). On the contrary, since pure VESDE can not deal with large variance, the images generated by pure VESDE appear blurry and unrealistic in these details. From the quantitative results, we use aesthetic score  and Inception Score to measure the quality of generated images. Our drifted VESDE achieves aesthetic score \(5.813\), and IS \(4.174\), which is better than the results of baseline pure VESDE (aesthetic score \(5.807\) and IS \(4.082\)). There are more examples on CelebA256 and more experiments on Swiss roll and 1D-GMM to explore different sampling methods (RK45, PFODE) and different \(T\). We refer to Appendix G for more details.

## 8 Conclusion

In this work, we analyze the VE-based models under the manifold hypothesis. Firstly, we propose a new forward drifted VESDE process, which enjoys a faster forward convergence rate. Then, we show that with an aggressive \(_{t}\), the new process balances different errors and achieve the first efficient polynomial sample complexity for a series of VE-based models with reverse SDE.

After achieving the above results, we go beyond the reverse SDE and propose the tangent-based unified framework, which considers reverse SDE and PFODE at the same time. Under this framework, we make use of the variance exploding property of VESDE and achieve the first quantitative convergence guarantee for SOTA VE-based models with reverse PFODE. Finally, we show the power of the new drifted forward process through synthetic and real-world experiments.

**Future Work and Limitation.** This work proposes the first unified framework for VE-based models with an accurate score. After that, we plan to consider the approximated score error and provide a polynomial complexity for the VE-based models with reverse PFODE under the manifold hypothesis.

**Broader Impact.** Our work focuses on the convergence guarantee of the SOTA diffusion models and deepens the understanding of diffusion models. Therefore, this work can be viewed as a fundamental step in improving the quality of diffusion models and the societal impact is similar to general generative models .

Figure 3: Experiment results of CelebA dataset