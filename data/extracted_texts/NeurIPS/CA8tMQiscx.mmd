# Supplementary material to "Pointwise uncertainty quantification for sparse variational Gaussian process regression with a Brownian motion prior"

Pointwise uncertainty quantification for sparse variational Gaussian process regression with a Brownian motion prior

 Luke Travis

Department of Mathematics

Imperial College London

luke.travis15@imperial.ac.uk &Kolyan Ray

Department of Mathematics

Imperial College London

kolyan.ray@imperial.ac.uk

###### Abstract

We study pointwise estimation and uncertainty quantification for a sparse variational Gaussian process method with eigenvector inducing variables. For a rescaled Brownian motion prior, we derive theoretical guarantees and limitations for the frequentist size and coverage of pointwise credible sets. For sufficiently many inducing variables, we precisely characterize the asymptotic frequentist coverage, deducing when credible sets from this variational method are conservative and when overconfident/misleading. We numerically illustrate the applicability of our results and discuss connections with other common Gaussian process priors.

## 1 Introduction

Consider the standard nonparametric regression model, where we observe \(n\) training samples \(_{n}=\{(x_{1},y_{1}),,(x_{n},y_{n})\}\) arising from the model

\[y_{i}=f(x_{i})+_{i},_{i}^{id} (0,^{2}),\] (1)

where \(^{2}>0\) and the design points \(x_{i}^{d}\) are either fixed or considered as i.i.d. random variables. Our goal is to predict outputs \(y^{*}\) based on new input features \(x^{*}\), while accounting for the statistical uncertainty arising from the training data. A widely-used Bayesian approach is to endow \(f\) with a Gaussian process (GP) prior , which is especially popular due to its ability to provide _uncertainty quantification_ via posterior credible sets.

While explicit expressions for the posterior distribution are available, a well-known drawback is that these require \(O(n^{3})\) time and \(O(n^{2})\) memory complexity, making computation infeasible for large data sizes \(n\). To avoid this, there has been extensive research on low-rank GP approximations, where one chooses \(m n\) inducing variables to summarize the posterior, thereby reducing computation to \(O(nm^{2})\) time and \(O(nm)\) memory complexity, see the recent review .

We consider here the sparse Gaussian process regression (SGPR) approach introduced by Titsias , which is widely used in practice (see  for implementations) and has been studied in many recent works . While the computational dependence on the number of inducing variables \(m\) is relatively well-understood, fewer theoretical results are available on understanding how \(m\) affects the quality of statistical inference. In particular, it is crucial to understand how large \(m\) needs to be to achieve good statistical uncertainty quantification, ideally close to that of the true computationally expensive posterior. The present work contributes to this research direction by establishing precise theoretical guarantees for pointwise inference using a natural choice of SGPR with eigenvector inducing variables.

A main appeal of Bayesian methods is their ability to perform uncertainty quantification (UQ) via credible sets, often at the 95% level, see Figure 1 for a visualization involving a full GP and two SGPR approximations. We focus here on the canonical problem of pointwise estimation and UQ for \(f(x)\) at a single point \(x\), which corresponds to the practically relevant problem of quantifying the uncertainty of a prediction \(f(x)\) based on a new input \(x\). We study the frequentist behaviour of the resulting SGPR credible sets, with our main conclusion being that for well-calibrated priors and sufficiently many inducing points \(m\), SGPRs can indeed provide reliable, though conservative, uncertainty quantification.

Concretely, we consider a rescaled Brownian motion prior that models Holder smooth functions  and whose pointwise UQ for the corresponding full posterior was studied in . We extend this analysis to the SGPR setting using the eigendecomposition of the sample covariance matrix as inducing variables, i.e. the optimal rank-\(m\) posterior approximation. We provide a rigorous theoretical justification for pointwise estimation and UQ using this SGPR, provided \(m\) is large enough. Our main theoretical contributions are summarized that in dimension \(d=1\), for an \(\)-smooth truth \(f_{0}\), \(\)-smooth prior, \(,(0,1]\), and at least \(m n^{()}\) inducing variables:

1. The SGPR recovers the true value \(f_{0}(x)\) at a point \(x\) with convergence rate \(n^{-}\). If \(=\), this gives the minimax optimal rate \(n^{-}\).
2. For truths that are smoother than the prior \((>)\), SGPR credible sets are conservative with their frequentist coverage converging to a value strictly between their nominal level and one, which we characterize.
3. For truths that are rougher than the prior \(()\), coverage can be arbitrarily bad.
4. It is not necessary for the KL divergence between the SGPR and true posterior to vanish as \(n\) to get good (though conservative) coverage.
5. We provide a more general small-bias condition under which the coverage of SGPR credible sets is at least that of credible sets from the true posterior.

Our proofs exploit specific properties of Brownian motion to obtain explicit expressions, which allow us to obtain the above precise results. Such expressions seem difficult to obtain for other commons GPs (e.g. Matern, squared exponential), meaning that existing theoretical guarantees for the Matern SGPR apply to _enlarged_ credible sets . Since our results indicate that pointwise SGPR credible sets are already conservative, such enlargements make the SGPR UQ procedure very

Figure 1: Plot of the (sparse) posterior means with the ribbons representing 95% posterior pointwise credible intervals for the i) SGPR with \(m=5\) inducing variables (red); ii) SGPR with \(m=106\) inducing variables (green); iii) full GP (blue) and iv) the true function (black). Here, \(n=500\) and the covariance kernel is the rescaled Brownian motion with \(=0.5\).

conservative, see Section 4. We provide a complimentary perspective to these works, studying _true_ credible sets from a related GP, rather than modified credible sets from the Matern.

The Brownian motion prior we consider here shares many similarities with the Matern process, meaning our main qualitative conclusions also apply there, as we demonstrate in simulations. We thus verify the applicability of our limit theorems in numerical simulations, confirming they provide a good guide to the behaviour of SGPRs for finite sample sizes, including those based on Matern priors. To the best of our knowledge, our work is the first establishing exact theoretical coverage guarantees for SGPR pointwise credible sets, and can be viewed as a guide of what to expect for the other Gaussian processes, see Section 4.

**Related work.** Rigorous theoretical guarantees for Bayesian UQ using the full posterior have received much recent attention. In parametric models, the classic Bernstein-von Mises theorem  ensures that regular credible sets are asymptotic confidence sets, justifying Bayesian UQ from a frequentist perspective. However, such a result fails to hold in high- and infinite-dimensional settings [10; 16], such as GPs, where the performance is sensitive to the choice of prior and model. Theoretical guarantees for UQ using full GPs have been established mainly involving \(L^{2}\)-type credible sets (e.g. [17; 7; 30]) which, while mathematically more tractable, are less reflective of actual practice than pointwise credible sets. Results for pointwise Bayesian UQ are more difficult to obtain and are correspondingly much rarer [29; 40; 39], see Section 3. From a technical perspective, we perform a careful and novel analysis of the gap between the pointwise behaviour of the true posterior and its SGPR approximation, after which we can invoke ideas from the proofs for the full posterior .

While the frequentist asymptotic properties of VB have increasingly been investigated, this is usually in the context of estimation, convergence rates or approximation quality (e.g. [24; 2; 41; 27; 26], including for SGPRs [5; 6; 22]) rather than UQ. Available results on mean-field VB often show that this factoriazable approach provides overconfident UQ by underestimating the posterior variance [3; 4], though there exist more positive results in certain low-dimensional models . Regarding UQ for SGPRs, Nieman et al.  investigate the frequentist coverage of global \(L^{2}\)-credible sets from certain SGPRs, showing these can have coverage tending to 1, possibly after enlarging them. Vakili et al.  similarly show that enlarged pointwise or uniform credible sets can have good coverage in a different bandit-like setting.

**Organization.** In Section 2 we detail the problem setup, including notation and an overview of (sparse variational) Gaussian process regression. Main results on pointwise convergence and UQ for SGPRs based on a Brownian motion prior are found in Section 3, discussion on the connections with other GPs in Section 4, simulations in Section 5 and discussion in Section 6. In the supplement, we provide the proofs of our results (Section A) and additional simulations (Section B).

## 2 Problem setup and sparse variational Gaussian process regression

Recall that we observe \(n\) training examples \(_{n}=\{(x_{1},y_{1}),,(x_{n},y_{n})\}\) from model (1), and write \(=(y_{1},,y_{n})^{T}\) and \(=(f(x_{1}),,f(x_{n}))^{T}\). We denote by \(P_{f}\) the probability distribution of \(\) from model (1) and by \(E_{f}\) the corresponding expectation. For \(,^{n}\) we write \(,=_{i=1}^{n}_{i}_{i}\) for the inner-product on \(^{n}\) and \(\|\|=,^{1/2}\) for the usual Euclidean norm. Write \(C()\) for the space of continuous real-valued functions on \(\). For \((0,1]\), we further define the class of Holder smooth functions on \(\) by \(C^{}=C^{}=\{f::_{x y}}<\}\). Throughout the paper we make the following frequentist assumption:

**Assumption 2.1**.: _There is a true \(f_{0} L^{2}()\) generating the data \( P_{f_{0}}\) according to (1)._

We differentiate \(f\) coming from the Bayesian model with the 'true' generative \(f_{0}\).

### Sparse variational Gaussian process regression

In model (1), we assign to \(f GP(_{0},k)\) a Gaussian process (GP) prior with mean function \(_{0}:\) and covariance kernel \(k:\). We henceforth take the prior mean \(_{0}=0\) for simplicity since this will not alter the spirit of our results, see Remark 3.3 below. The resulting posterior distribution is again a GP by conjugacy , with mean and covariance functions equal to

\[_{n}(x)&=_{n}(x)^{T}( _{nn}+^{2}_{n})^{-1},\\ k_{n}(x,x^{})&=k(x,x^{})-_{n} (x)^{T}(_{nn}+^{2}_{n})^{-1}_{n}(x^{ }),\] (2)

where \(_{n}(x)=(k(x,x_{1}),,k(x,x_{n}))^{T}\) and \([_{nn}]_{ij}=k(x_{i},x_{j})\). In particular, the posterior variance at a point \(x\) is \(_{n}^{2}(x)=k_{n}(x,x)\). In Section 3.2 below, we will specifically consider the choice \(=\) and rescaled Brownian motion prior kernel \(k(x,x^{})=(n+1/2)^{}(x,x^{})\) for \(>0\).

We consider here the sparse variational Gaussian process (SGPR) approximation using inducing variables proposed by Titsias . The idea is to summarize the posterior via a relatively small number of inducing variables \(=\{u_{1},,u_{m}\}\), \(m n\), which are linear functionals of the prior process \(f\). By assigning \(\) a multivariate normal distribution, one obtains a low-rank variational family. Titsias  explicitly computed the minimizer in Kullback Leibler sense between this family of GPs and the full posterior, which yields the SGPR \(Q^{*}=GP(_{m},k_{m})\) with mean and covariance

\[_{m}(x)&=_{xm}(^{2} _{mm}+_{mn}_{nm})^{-1}_{mn} \\ k_{m}(x,x^{})&=k(x,x^{})-_{ xm}_{mm}^{-1}_{mx^{}}+_{xm}(_{ mm}+^{-2}_{mn}_{nm})^{-1}_{mx^{}}, \] (3)

where \(_{xm}=((f(x),u_{1}),,(f(x),u_{m}))= _{mx}^{T}\), \([_{mm}]_{ij}=(u_{i},u_{j})\) and we write \([_{nm}]_{ij}=(f(x_{i}),u_{j})\). Recalling that \((f(x),f(x^{})):=k(x,x^{})\) under the prior, for \(u_{j}\) of the form \(u_{j}=_{i=1}^{n}v_{j}^{i}f(x_{i})\) (see (4) below) we obtain \((f(x),u_{j})=_{j=1}^{n}v_{j}^{i}k(x,x_{i})\). The SGPR variance at \(x\) is \(_{m}^{2}(x)=k_{m}(x,x)\). The computational complexity of obtaining \(_{m}\) and \(k_{m}\) is \(O(nm^{2})\), which is much smaller than the \(O(n^{3})\) needed to compute the full posterior for \(m n\).

### Eigenvector inducing variables

The approximation quality of the SGPR depends on the inducing variables being well chosen. We consider here arguably the conceptually simplest and most canonical sparse approximation based on the eigendecomposition of \(_{nn}\). Let \(_{1}_{2}_{n} 0\) be the eigenvalues of the positive semi-definite matrix \(_{nn}\) with corresponding orthonormal eigenvectors \(_{1},,_{n}\). Writing \(_{j}=(v_{j}^{1},,v_{j}^{n})^{T}^{n}\), we take as inducing variables

\[u_{j}=_{j}^{T}=_{i=1}^{n}v_{j}^{i}f(x_{i}),\ \ \ \ j=1, ,m,\] (4)

so that \(u_{j}\) is a linear combination of the inducing points placed at each data point with weights proportional to the entries of the \(j^{th}\)-largest eigenvector of \(_{nn}\). Setting \(_{m}:=[_{1}_{m}]^{n m}\), this choice of inducing points implies

\[_{xm}=_{n}(x)^{T}_{m},_{mm}= {diag}(_{1},,_{m}),_{nm}=_{m}(_{1},,_{m})=_{mn}^{T},\]

see Section C.1 of . Writing \(_{nn}=_{i=1}^{n}_{i}_{i}_{i}^{T}\) and substituting these expressions into (3), we obtain the SGPR with mean and covariance functions

\[_{m}(x) =_{n}(x)^{T}[_{k=1}^{m}_{k}_{k} _{k}^{T}]\] (5) \[k_{m}(x,x^{}) =k(x,x^{})-_{n}(x)^{T}[_{k=1}^{m}_{k }_{k}_{k}^{T}]_{n}(x^{}),\] (6)

where \(_{k}=+_{k}}\). We study inferential properties of the SGPR with mean (5) and covariance (6).

Comparing these expressions with those for the full posterior (2), we see that this SGPR is the optimal rank-\(m\) approximation in the sense that we have replaced \((_{nn}+^{2}_{n})^{-1}=_{i=1}^{n}_{i}_{i}_{i}^{T}\) in both the mean and covariance (2) with \(_{i=1}^{m}_{i}_{i}_{i}^{T}\), corresponding to the \(m\) largest eigenvalues of \(_{nn}\). These inducing variables are an example of interdomain inducing features , which can yield sparse representations in the spectral domain and computational benefits . Computing this SGPRinvolves numerically computing the first \(m\) eigenvalues and corresponding eigenvectors of \(_{nn}\), which can be done in \(O(n^{2}m)\) time using for instance Lanczos iteration .

This choice of SGPR using eigenvector inducing variables has been shown to minimize certain upper bounds for the Kullback-Leibler (KL) divergence between order \(m\) SGPRs and the true posterior , reflecting that it can provide a good posterior approximation. Indeed, one can show that for \(m=m_{n}\) growing fast enough (though sublinearly in \(n\)), this SGPR converges to the posterior in the KL sense as \(n\). Under weaker growth conditions on \(m\), this SGPR still converges to the true generative \(f_{0}\) at the minimax optimal rate in the frequentist model , even when the SGPR does not converge to the true posterior as \(n\). Our results include both scenarios and will show that one can still obtain good frequentist UQ performance even for \(m\) small enough that the SGPR diverges from the full posterior (see Remark 3.7) unlike in .

## 3 Main results

### General results on pointwise inference

We now present our main results concerning estimation and uncertainty quantification at a point \(x\) using the SGPR \(Q^{*}\) with eigenvector inducing variables. Since both the posterior and SGPR are GPs, their marginal distributions at \(x\) satisfy \(f(x)|_{n}(_{n}(x),_{n}^{2}(x))\) and \(f(x)(_{m}(x),_{m}(x)^{2})\), respectively. It thus suffices to study these quantities under the frequentist assumption that there is a 'true' \(f_{0}\) generating the data, i.e. Assumption 2.1. We further define the frequentist bias and variance of the (sparse) posterior mean:

\[b_{n}(x) =E_{f_{0}}(_{n}(x)-f_{0}(x)), b_{m}(x) =E_{f_{0}}(_{m}(x)-f_{0}(x)),\] \[t_{n}^{2}(x) =_{f_{0}}(_{n}(x)), t_{m}^{2}(x) =_{f_{0}}(_{m}(x)),\]

where the expectation and variance are taken over \( P_{f_{0}}\). We have the following useful relationships between these quantities for the variational posterior and full posterior, which assumes fixed design, so that all statements are taken conditional on the design points \(x_{1},,x_{n}\). For simplicity, we take the noise variance to be \(^{2}=1\) in (1) for our theoretical results.

**Lemma 3.1**.: _For \(f_{0} L^{2}()\), \(x\) and \(_{m}(x):=[_{j=m+1}^{n}_{j}_{j}_{j}^ {T}]_{n}(x)\), we have:_

\[b_{m}(x) =b_{n}(x)-_{m}(x),_{0}\] (7) \[t_{m}^{2}(x) =t_{n}^{2}(x)-\|_{m}(x)\|^{2} t_{n}^{2}(x)\] (8) \[_{m}^{2}(x) =_{n}^{2}(x)+_{m}(x),_{n}(x) _{n}^{2}(x).\] (9)

The quantity \(_{m}(x)\) measures the rank gap due to ignoring the smallest \(n-m\) eigenvalues of \(_{nn}\). The SGPR approximation increases the posterior variance \(_{m}^{2}(x)_{n}^{2}(x)\) while reducing the frequentist variance of the posterior mean \(t_{m}^{2}(x) t_{n}^{2}(x)\). Thus if one can control the biases in (7), credible sets from the SGPR will have coverage at least as large as the full posterior. One can therefore ensure good coverage by taking \(m=m_{n}\) sufficiently small, but this can still lead to poor UQ by making the resulting credible intervals extremely wide, and therefore uninformative. We thus first study the effect of \(m\) on the quality of estimation, via the posterior convergence rate.

**Proposition 3.2** (Pointwise contraction).: _For \(f_{0} C()\), \(x\) and \(m=m_{n}\),_

\[E_{f_{0}}Q^{*}(f:|f(x)-f_{0}(x)|>M_{n}_{m}|_{n}) 0,\]

_as \(n\), where \(M_{n}\) is any (arbitrarily slowly growing) sequence and_

\[_{m}^{2}=b_{n}^{2}(x)+t_{n}^{2}(x)+_{n}^{2}(x)+| _{m}(x),_{0}|^{2}+|_{m}(x), _{n}(x)|^{2}.\]

_If \(_{m}(x),_{0}=o(b_{n}(x))\) and \(_{m}(x),_{n}(x)=o(_{n}^{2}(x))\) as \(n\), then the rate matches that of the true posterior \(_{n}^{2}=b_{n}^{2}(x)+t_{n}^{2}(x)+_{n}^{2}(x)\)._

The last result says that the SGPR _contracts_ about the true \(f_{0}\) at rate \(_{m}\), i.e. it puts all but a vanishingly small amount of probability on functions for which \(|f(x)-f_{0}(x)| M_{n}_{m}\), where \(f_{0}\) is the true function generating the data. Such results not only quantify the typical distance between a point estimator \((x)\) (e.g. SGPR mean/median) and the truth (, Theorem 8.7), but also the typical spread of \(Q^{*}\) about the truth. Ideally, most of the \(Q^{*}\)-probability should be concentrated on such sets with radius \(_{m}\) proportional to the optimal (minimax) rate, whereupon they have smallest possible size from an information-theoretic perspective.

Contraction rates in global \(L^{2}\)-losses have been considered in the variational Bayes literature . Such results crucially rely on the true posterior concentrating exponentially fast about the truth (see e.g. Theorem 5 in ), which happens in losses which geometrize the statistical model . This is known _not_ to be true for pointwise or uniform loss , and hence these previous proof approaches cannot be applied to the present pointwise setting. We must thus use an alternative approach, exploiting the explicit Gaussian structure of the SGPR.

The SGPR approach in UQ is to consider a smallest _pointwise credible set_ of probability \(1-\):

\[C_{m}^{}=C_{m}^{}(_{n})=[_{m}(x)-z_{1-} _{m}(x),_{m}(x)+z_{1-}_{m}(x)],\] (10)

with \(P(|N(0,1)| z_{1-})=1-\). We next establish guarantees on the _frequentist coverage_ of \(C_{m}^{}\), i.e. the probability \(1-^{}\) with \(_{f_{0}}P_{f_{0}}(f_{0}(x) C_{m}^{}) 1-^{ }\) over a target function class \(\).

**Remark 3.3** (Zero prior mean).: _Since \(f_{0}\) is a-priori unknown, such coverage guarantees must hold uniformly over a function class \(\) to be meaningful. For symmetric function classes, where \(f\) implies \(-f\), taking a good prior mean \(_{0}\) for \(f\) will make estimating \(-f\) correspondingly more difficult. Thus without loss of generality we may take zero mean \(_{0}=0\)._

**Proposition 3.4** (Pointwise UQ).: _Suppose that \(_{m}(x),_{0}=o(b_{n}(x))\) as \(n\). Then for \(m=m_{n} n\) and any \((0,1)\), the frequentist coverage of the credible sets satisfies_

\[_{n}P_{f_{0}}(f_{0}(x) C_{m}^{})_{n }P_{f_{0}}(f_{0}(x) C_{n}^{}).\]

_If in addition \(\|_{m}(x)\|^{2}=o(t_{n}^{2}(x))\) and \(_{m}(x),_{n}(x)=o(_{n}^{2}(x))\), then_

\[_{n}P_{f_{0}}(f_{0}(x) C_{m}^{})=_{n}P_{f_{ 0}}(f_{0}(x) C_{n}^{}).\]

The first conclusion says that if the rank gap is smaller than the posterior bias (a'small-bias' condition), SGPR credible sets will have asymptotic coverage at least at the level of the original full posterior, though perhaps larger, including possibly tending to one. The second conclusion gives further conditions on the rank gap under which the asymptotic coverages will be the same. Together with Proposition 3.2, the goal is to obtain a credible set \(C_{m}^{}\) of smallest possible diameter subject to having sufficient coverage.

### Fixed design with rescaled Brownian motion prior

We now apply our general results to a specific GP and find conditions on the number of inducing variables \(m\) needed to get good UQ. Consider the domain \(=\) with regularly spaced design points \(x_{i}=\) for \(i=1,,n\). For \(B\) a standard Brownian motion, consider as prior \(f=}B\), where \(c_{n}=(n+1/2)^{}\) for \(>0\). Thus \(f\) is a mean-zero GP with covariance kernel \(k(x,x^{})=c_{n}(x x^{})\), where \(x x^{}:=(x,x^{})\). The scaling factor \(c_{n}\) controls the smoothness of the sample paths of the GP and plays the same role as the lengthscale parameter for stationary GPs. The present rescaled Brownian motion is a suitable prior to model Holder functions of smoothness \((0,1]\) (e.g. ). In particular, for a true \(f_{0} C^{}\), \((0,1]\), one obtains (full) posterior contraction rate \(n^{-}\) in the global \(L^{2}\)-loss . We sometimes write \(Q_{}^{*}=Q^{*}\) for the corresponding SGPR to make explicit that the underlying prior is \(\)-smooth.

**Theorem 3.5**.: _Let \(f_{0} C^{}\), \((0,1]\) and \(x(0,1)\). Consider the SGPR \(Q_{}^{*}\) with rescaled Brownian motion prior of regularity \((0,1]\) and \(m=m_{n}\) inducing variables. Then_

\[E_{f_{0}}Q_{}^{*}(f:|f(x)-f_{0}(x)|>M_{n}(n^{-}+n^{}m^{-1+}+n^{ }m^{-3/2})|_{n}) 0\]

_as \(n\), where \(M_{n}\) is any (arbitrarily slowly growing) sequence. If \(m_{n} n^{()}\) then the contraction rate of the SGPR matches that of the full posterior \(n^{-}\)._

Theorem 3.5 shows that for \(m n^{()}\) inducing points, the SGPR attains the same pointwise contraction rate as the full posterior. If \(=\), we then recover the optimal (minimax) rate of convergence for a \(C^{}\)-smooth function. For instance if \(==1\), our result indicates that one can do minimax optimal pointwise estimation based on \(m_{n}\) inducing variables, a substantial reduction over the full \(n\) observations. Note this convergence guarantee can still hold in cases when the SGPR diverges from the posterior as \(n\), see Remark 3.7.

The restriction \((0,1]\) comes from rescaling the underlying Brownian motion . One can extend this to \(>1\) by considering a smoother baseline process , such as integrated Brownian motion, but the more complex form of the resulting eigenvectors and eigenvalues of \(_{nn}\) make our explicit proof approach difficult. Note also that the prior fixes the value \(f(0)=0\). One can avoid this by adding an independent normal random variable to \(f\), but since we consider pointwise inference at a point \(x>0\), this will not affect our results and we thus keep \(f(0)=0\) for simplicity. Nonetheless, the message here is clear: for sufficiently many inducing variables (but polynomially less than \(n\)), an SGPR based on a \(\)-smooth prior can estimate an \(\)-smooth truth at rate \(n^{-}\). We next turn to UQ.

**Theorem 3.6**.: _Let \(f_{0} C^{}\), \((0,1]\) and \(x(0,1)\). Consider the SGPR \(Q_{}^{*}\) with rescaled Brownian motion prior of regularity \((0,1]\) and \(m=m_{n} n^{}\) inducing variables. For \((0,1)\), let \(q_{m}^{}:=P_{f_{0}}(f_{0} C_{m}^{}(x))\) denote the frequentist coverage of the \(1-\) credible set \(C_{m}^{}(x)\) given by (10). Then as \(n\):_

1. _(Understanding case) If_ \(>\)_, then_ \(q_{m}^{} P(|N(0,1/2)| z_{1-})=:p_{}>1-\) _for all_ \(f C^{}\)_, where_ \(P(|N(0,1)| z_{1-})=1-\) _and_ \(N(0,1/2)\) _is the normal distribution with mean zero and variance_ \(1/2\)_._
2. _(Correct smoothing case) If_ \(=\)_, then for each_ \(p(0,p_{}]\)_, there exists_ \(f C^{}\) _such that_ \(q_{m}^{} p\)_._
3. _(Oversmoothing case) If_ \(<\)_, there exists_ \(f C^{}\) _such that_ \(q_{m}^{} 0\)_._

Theorem 3.6 provides exact expressions for the asymptotic coverage when the credible interval \(C_{m}^{}\) has diameter \(O(n^{-}{1+2}})\). In the undersmoothing case \(>\), the \(1-\) SGPR credible sets are _conservative_ from a frequentist perspective, i.e. their coverage converges to a value strictly between \(1-\) and \(1\). For instance if \(=0.05\,(0.1)\), the 95% (90%) credible set will have asymptotic coverage 99.4% (98.0%), indicating one does not want to enlarge such credible sets if using enough inducing variables. A desired asymptotic coverage can also be achieved by targetting the credibility according to the formula in Theorem 3.6(i). Reducing \(\) towards zero will generally ensure coverage for Holder functions, but this will also increase the size of the credible intervals to size \(O(n^{-})\), making them less informative. Note that the convergence in (i) is uniform over \(C^{}\)-balls of fixed radius.

In the oversmoothing case \(<\), the posterior variance underestimates the actual uncertainty and so the credible interval is too narrow, giving overconfident (bad) UQ for many Holder functions. In the correct smoothing case \(=\), where we obtain the minimax optimal contraction rate \(n^{-}\), coverage falls between these regimes - it does not fully tend to zero, but one can find a function whose coverage is arbitrarily bad, i.e. close to zero.

The best scenario thus occurs when the prior slightly undersmooths the truth, in which case the SGPR credible interval will have slightly conservative coverage but its width \(O(n^{-})\) is not too much larger than the minimax optimal size \(O(n^{-})\). Our results match the corresponding ones for the full computationally expensive posterior and the main messages are the same: undersmoothing leads to conservative coverage while oversmoothing leads to poor coverage .

**Remark 3.7** (Kullback-Leibler).: _If the number of inducing variables grows like \(n^{()} m n^{}\), then the conditions of Theorems 3.5 and 3.6 are met, but the KL-divergence between the SGPR and the true posterior tends to infinity as \(n\) (Lemma A.6 in the supplement). Thus one does not need the SGPR to be an asymptotically exact approximation of the posterior to get similarly good frequentist pointwise estimation and UQ. In particular, one can take \(m\) polynomially smaller in \(n\) than is required for the KL-divergence to vanish, see  for related bounds and discussion._

While  consider approximation quality as measured by the KL-divergence between the SGPR and true posterior, we consider here the different question of whether the SGPR behaves well for pointwise inference, even when it is not a close KL-approximation. The data-generating setup in  is also not directly comparable to ours. They take expectations over both the data \((x,y)\) and prior on \(f\), so their results are 'averaged' over the prior, which downweights the effect of sets of small prior probability. In contrast, the frequentist guarantees provided here hold assuming there is a true function \(f_{0}\) which generates the data according to (1) (Assumption 2.1), meaning that one seeks to understand the performance of the method for any fixed \(f_{0}\), including worst-case scenarios. Such setups can lead to very different conclusions, see e.g. Chapters 6.2-6.3 in .

## 4 Connections with other Gaussian process priors

The rescaled Brownian motion (rBM) prior we consider here can be thought of as an approximation to the Matern process of regularity \((0,1]\) since they both model \(\)-smooth functions. The rescaling factor \(c_{n}=(n+1/2)^{}\) in the covariance function \(k(x,x^{})=c_{n}(x x^{})\) plays the same role as the lengthscale parameter for the Matern and calibrates the GP smoothness. We thus expect similar theoretical results and conclusions to also hold for the Matern process, which seems to be the case in practice, as we verify numerically in Section 5. Indeed, similar UQ properties to the rBM posterior are conjectured to hold for the full Matern posterior , in particular that the coverage of credible sets satisfies similar qualitative conclusions to the three cases in Theorem 3.6.

On a more technical level, the success of GPs in nonparametric estimation is known to depend on their sample smoothness, as measured through their small ball probability [33; 36]. The posteriors based on both GPs converge to a \(C^{}\)-truth at rate \(n^{-}\) in \(L^{2}\)-loss ( for rBM,  for Matern), indicating the closeness of their small-ball asymptotics and hence that both GPs distribute prior mass similarly over their supports. This gives a more quantitative notion of the similarities of these GPs.

Theoretical guarantees do exist for the Matern SGPR. Theorem 3.5 of  nicely establishes that in a bandit-like setting and if the true \(f_{0}\) is in the prior reproducing kernel Hilbert space \(\) (roughly \(=+1/2\)), then inflating credible sets by a factor depending on the rank gap and an upper bound for \(\|f_{0}\|_{}\) guarantees coverage. Our parallel results suggest that this inflation is not necessary, since SGPR credible sets in this case will already be conservative. However, since our proofs rely on explicit expressions available for rBM but not for the Matern, it seems difficult to extend our approach to the different setting considered in  (and vice-versa); other techniques are required. Our results can thus be viewed as a guide as to what to expect when using a Matern SGPR and provide a different perspective reinforcing the main messages of , namely that SGPRs can provide reliable, if conservative, UQ.

On the other hand, the squared exponential kernel seems to behave qualitatively differently in numerical simulations, giving different coverage behaviour in the cases considered in Theorem 3.6, see Section 5. This is due to the difference in the smoothness of the sample paths, with squared exponential prior draws being far smoother, in particular analytic. This leads to somewhat different UQ behaviour for the true posterior . Rescaled Brownian motion is a less good approximation for the squared exponential kernel than for the Matern, and one must thus be cautious about transferring the messages derived here to the squared exponential.

## 5 Numerical simulations

We next investigate empirically the applicability of our theoretical results in finite sample sizes and whether the conclusions extend to related settings, such as different designs and other GP priors. We consider various nonparametric regression settings of the form (1) with \(C^{}\)-smooth truths and \(\)-smooth priors. We compute both the full posterior (columns marked GP) and SGPR (marked SGPR) with \(m n\) eigenvector inducing variables for \(f(x_{0})\) at a fixed point \(x_{0}\), and report the root-mean square error (RMSE), negative log predictive density (NLPD), and the length and coverage of the 90%-credible intervals of the form (10) (i.e. \(=0.1\)), see Section B in the supplement for definitions. The true noise variance in (1) is taken to be \(^{2}=1\), but is considered unknown and is estimated by maximizing the log-marginal likelihood as usual. We ran all simulations 500 times and report average values and their standard deviations when relevant. Simulations were run on a 2 GHz Quad-Core Intel Core i5 processor on a 2020 Macbook Pro with 16GB of RAM.

**Settings of the theoretical results.** We consider the setting of our theoretical results in Section 3 with \(=\) and \(x_{i}=i/(n+1/2)\) for \(i=1,,n\). To generate the data, we take \(f_{0}(x)=|x-0.5|^{}\), which is exactly \(\)-Holder at \(x_{0}=0.5\), and investigate pointwise inference at \(x_{0}=0.5\) for different choices of \(\). As Gaussian priors, we consider (i) rescaled Brownian motion of regularity \(\) described in Section 3, (ii) the Matern kernel with parameter \(\) and (iii) the square exponential kernel \(k(x,x^{})=\{-^{2}}(x-x^{})^{2}\}\), where the lengthscale \(_{n}=n^{-}\) is chosen to be appropriate for estimating \(-\)Holder smooth functions . We take \(m^{*}:=n^{-}\) inducing variables for the SGPR. Results are given in Table 1: **Fixed Design, \(\)**. We also consider the related case of uniform random design where \(x_{i} U(0,1)\) (Table 1: **Random Design, \(\)**).

Theorem 3.6 predicts that for 90% credible sets (\(=0.1\)), \(m m^{*}\) and \(>\), the coverage should converge to \(p_{0.1}=P(|N(0,1/2)|<z_{0.9})\) = 0.98. We see that for \(n=1000\), the observed coverages for both the full posterior and SGPR based on the Brownian motion prior are very close to this predicted value, and are indeed conservative. In the oversmoothing case \(<\), coverage is poor and far below the nominal level, while in the correct smoothing case (\(=\)), coverage is moderately below the nominal level. We see that the asymptotic theory is applicable for reasonable samples sizes.

The Matern process behaves qualitatively similarly to Brownian motion in these three cases, though the (still conservative) limiting coverage in the undersmoothing case is predicted to be slightly different , as reflected in Table 1. On the other hand, the square exponential behaves differently in all cases and generally has wider sets with this lengthscale choice. The wider credible intervals and larger RMSE suggest greater bias of the posterior mean. While rescaled Brownian motion seems a reasonable guide for the Matern, it does not seem so for the squared exponential, see Section 4.

For all three GP priors, the reported metrics are practically indistinguishable between the SGPR and the full GP, confirming that \(m n^{}\) inducing variables seems sufficient to obtain virtually the same pointwise credible intervals as the full posterior. However, since \(m^{*} n^{}\) for any \(>0\), the KL-divergence between the SGPR and the full posterior grows to infinity as \(n\) in the Brownian motion case (Lemma A.6), and hence the SGPR will differ from the posteriors in some ways. This reflects that one does not necessarily need to fully approximate the posterior in order to match its pointwise inference properties. Note that for fixed design, the length of the credible sets is not random since it depends only on the features \(x_{1},,x_{n}\), and so no standard errors are reported.

**Other settings.** We turn to simulation settings not covered by our theory. Given the above discussion, we consider only the Matern process in dimension \(d=10\) and the corresponding SGPR with \(m=m_{j}^{*}:=n^{}\). As features, consider random design with (i) \(x_{i}([-1/2,1/2]^{d})\) and (ii) \(X_{i}_{d}(0,_{})\) for \([_{}]_{ij}=1\) for \(i=j\) and \([_{}]_{ij}=\) otherwise. To better reflect correlation in real-world data, we also consider a semi-synthetic dataset with real features but simulated responses.

**Prior** &  &  &  &  \\  GP & SGPR & GP & SGPR & GP & SGPR & GP & SGPR & GP \\   & \), \(\)**} & & & & & \\  rBM & 0.98 & 0.98 & 0.41 & 0.41 & 0.09 & 0.09 & -0.90 (0.21) & -0.90 (0.21) \\ Matérn & 0.98 & 0.98 & 0.49 & 0.49 & 0.10 & 0.10 & -0.68 (0.16) & -0.68 (0.16) \\ SE & 0.91 & 0.91 & 0.65 & 0.65 & 0.19 & 0.19 & -0.28 (0.30) & -0.28 (0.30) \\   & \), \(\)**} & & & & \\  rBM & 0.74 & 0.74 & 0.41 & 0.41 & 0.18 & 0.18 & -0.09 (0.35) & -0.09 (0.35) \\ Matérn & 0.84 & 0.84 & 0.49 & 0.49 & 0.17 & 0.17 & -0.40 (0.32) & -0.40 (0.32) \\ SE & 0.88 & 0.88 & 0.65 & 0.65 & 0.21 & 0.21 & -0.21 (0.31) & -0.21 (0.31) \\   & \), \(\)**} & & & & \\  rBM & 0.98 & 0.98 & 0.49 (0.02) & 0.49 (0.02) & 0.11 & 0.11 & -0.65 (0.15) & -0.65 (0.15) \\ Matérn & 0.96 & 0.96 & 0.59 (0.03) & 0.59 (0.03) & 0.13 & 0.13 & -0.55 (0.14) & -0.55 (0.14) \\ SE & 0.92 & 0.92 & 0.76 (0.08) & 0.76 (0.08) & 0.20 & 0.20 & -0.02 (0.25) & -0.02 (0.25) \\   & \), \(\)**} & & & & \\  rBM & 0.25 & 0.25 & 0.49 (0.02) & 0.49 (0.02) & 0.37 & 0.37 & 2.23 (0.86) & 2.23 (0.86) \\ Matérn & 0.47 & 0.47 & 0.59 (0.02) & 0.59 (0.02) & 0.34 & 0.34 & 0.91 (0.66) & 0.91 (0.66) \\ SE & 0.71 & 0.71 & 0.77 (0.08) & 0.77 (0.08) & 0.31 & 0.31 & 0.36 (0.52) & 0.36 (0.52) \\  

Table 1: Comparison of SGPR and full posterior (marked GP) for 90% pointwise credible intervals for different values of \((,)\). For the SGPR we use \(m^{*}:=n^{}\) inducing variables, corresponding to 178, 316, 106 and 244 in the four \((n,,)\) regimes above (top-to-bottom).

As features, we took the first \(d=10\) columns and randomly sampled \(n=2000\) rows from a Korean meteorological dataset . In all cases, we consider estimating the \(-\)Holder function \(f_{0}(x)=\|x-x_{0}\|^{}\) at \(x_{0}=0\), and the resulting pointwise 90%-credible sets at \(x_{0}\) coming from the Matern SGPR. Results are presented in Table 2, where we see that for \(m=m_{d}^{*}\) the performance of the pointwise credible sets from the SGPR matches that of the full posterior in each design. Due to the higher dimension, credible intervals are less confident (wider) and have larger coverage.

## 6 Discussion

In this work, we established the frequentist asymptotic behaviour of pointwise credible intervals coming from sparse variational Gaussian process regression (SGPR) with eigenvector inducing variables based on a rescaled Brownian motion prior. We showed that if the prior undersmooths the truth and with enough inducing variables, SGPR credible sets can provide reliable, though conservative, uncertainty quantification, with the coverage converging to a value strictly between the nominal level and one. If the prior oversmooths the truth, UQ can be poor. We further showed that it is not necessary for the SGPR to converge to the true posterior in KL-divergence to have similar behaviour of the credible sets. Our results suggest that properly calibrated SGPRs can perform reliable UQ. We verified these conclusions in simulations and discussed connections with other GPs.

Despite the widespread use of SGPR, there are still relatively few theoretical guarantees for their use, particularly for UQ. Our work provides some new results in this direction, but most of this research area is still wide open. A key step would be to prove similar results for the most commonly used GP priors, notably the Matern and squared exponential. Similarly, one would like to extend these results to other choices of inducing variables, for instance the eigenfunctions of the kernel operator. While our results give some intuition of what one can expect, they rely on a careful analysis of Brownian motion with fixed design, and new ideas and techniques will be needed for these other settings.

It is also unclear what minimal number of inducing variables is needed to get good pointwise UQ. When \(=\), the threshold for minimax convergence rates for _estimation_ in \(L^{2}\) is \(n^{}\), which is smaller than our bound \(n^{()}\), see Section B in the supplement for some related numerical simulations. Our results are also _non-adaptive_ since they assume fixed prior smoothness \(\), whereas one often selects \(\) in a data-driven way, for instance by maximizing the marginal likelihood or evidence lower bound (ELBO). However, _adaptive_ UQ is a subtle topic which typically requires further assumptions (e.g. self-similarity) on the true generative function to even be possible , and extending our results to such settings will require significant technical and conceptual work.

**Acknowledgements.** We are grateful to four anonymous reviewers for helpful comments that improved the manuscript. The authors would like to thank the Imperial College London-CNRS PhD Joint Programme for funding which supported Luke Travis in his studies.

   \\   &  &  &  &  \\  Type & \(\) & \(\) & \(\) & SGPR & GP & SGPR & GP & SGPR & GP \\  Uniform & & 0.5 & 0.5 & 0.96 & 0.96 & 1.46 (0.03) & 1.46 (0.03) & 0.96 (0.26) & 0.96 (0.26) \\ Gaussian & 0.0 & 0.7 & 0.5 & 0.99 & 0.99 & 2.17 (0.05) & 2.17 (0.05) & 1.34 (0.11) & 1.34 (0.11) \\ Gaussian & 0.2 & 0.9 & 0.5 & 1.00 & 1.00 & 2.13 (0.06) & 2.13 (0.06) & 1.90 (0.14) & 1.90 (0.14) \\ Gaussian & 0.5 & 1.1 & 0.5 & 1.00 & 1.00 & 2.03 (0.06) & 2.03 (0.06) & 1.36 (0.12) & 1.36 (0.12) \\   \\   &  &  &  &  \\  \(\) & \(\) & SGPR & GP & SGPR & GP & SGPR & GP & SGPR & GP \\ 
1.0 & 0.5 & 1.00 & 1.00 & 2.29 & 2.29 & 0.16 & 0.16 & 3.22 (0.47) & 3.22 (0.47) \\  

Table 2: Comparison of SGPR and full posterior (GP) with Matern prior for 90% pointwise credible intervals for different values of \((,)\). The SGPR uses 534 and 1002 inducing variables in the first four rows and fifth row, respectively.