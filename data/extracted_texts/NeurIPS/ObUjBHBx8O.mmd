# Mitigating Spurious Correlations

via Disagreement Probability

 Hyeonggeun Han\({}^{1,2}\) Sehwan Kim\({}^{1}\) Hyungjun Joo\({}^{1,2}\)

**Sangwoo Hong\({}^{1,2}\) Jungwoo Lee\({}^{1,2,3}\)**

\({}^{1}\)ECE & \({}^{2}\)NextQuantum, Seoul National University \({}^{3}\)Hodo AI Labs

{hygnhan, sehwankim, joohj911, tkddn0606, junglee}@snu.ac.kr

Corresponding author

###### Abstract

Models trained with empirical risk minimization (ERM) are prone to be biased towards spurious correlations between target labels and bias attributes, which leads to poor performance on data groups lacking spurious correlations. It is particularly challenging to address this problem when access to bias labels is not permitted. To mitigate the effect of spurious correlations without bias labels, we first introduce a novel training objective designed to robustly enhance model performance across all data samples, irrespective of the presence of spurious correlations. From this objective, we then derive a debiasing method, Disagreement Probability based Resampling for debiasing (DPR), which does not require bias labels. DPR leverages the disagreement between the target label and the prediction of a biased model to identify bias-conflicting samples--those without spurious correlations--and upsamples them according to the disagreement probability. Empirical evaluations on multiple benchmarks demonstrate that DPR achieves state-of-the-art performance over existing baselines that do not use bias labels. Furthermore, we provide a theoretical analysis that details how DPR reduces dependency on spurious correlations.

## 1 Introduction

In the realm of machine learning, many classification models employ Empirical Risk Minimization (ERM) , which optimizes average performance. However, this approach has been found to underperform on certain groups of data  due to the prevalence of spurious correlations within training datasets . Spurious correlations refer to the strong correlations between target labels and easy-to-learn attributes (_i.e._, bias attributes), which are present in a majority of the training examples. ERM-trained models often rely on these bias attributes , leading to biased predictions and poor generalization on minority groups where spurious correlations are absent. For example, consider the cow/camel classification task illustrated in Figure 1. A majority of camel images feature desert backgrounds, while a majority of cow images feature pasture backgrounds. Models trained via ERM might learn to recognize animals based on their backgrounds--desert for camels and pasture for cows--rather than on their distinctive features. This reliance can result in misclassifications, such as erroneously identifying a camel in a pasture as a cow. Addressing these spurious correlations is a

Figure 1: An illustration of the cow/camel classification task. Red dotted boxes indicate samples where spurious correlations do not hold.

critical issue across various applications, including medical imaging , algorithmic fairness , and education .

There have been extensive efforts to reduce the effects of spurious correlations. Numerous studies have initially relied on the assumption that bias attributes are given in the training dataset [38; 18; 24; 35]. However, annotating bias attributes is labor-intensive and expensive, rendering methods dependent on such annotations impractical. Consequently, research has shifted towards developing debiasing techniques that do not require bias labels during training [34; 27; 1; 29; 28; 49]. In this line of research, samples with spurious correlations are called _bias-aligned samples_, whereas those lacking such correlations are termed _bias-conflicting samples_[34; 27; 23]. In the absence of explicit bias labels, many existing methods focus on identifying bias-conflicting samples and employ strategies such as upweighting or upsampling these samples to counteract the negative impacts of spurious correlations [34; 28; 1]. Despite their straightforward nature, questions persist regarding the optimal scale for the weight of each sample to effectively reduce dependence on spurious correlations.

We thus formulate a debiasing objective for improved robustness against spurious correlations and derive a practical resampling-based algorithm. Specifically, our debiasing objective is built on two groups: the bias-aligned group and the bias-conflicting group, each consisting of bias-aligned and bias-conflicting samples, respectively. This objective encourages the model to perform equally well across both groups. The key insight behind the objective is that models relying on spurious correlations exhibit worse performance on the bias-conflicting group compared to the bias-aligned group, whereas models that do not rely on spurious correlations should exhibit strong performance across both groups. Then, under a simple condition, we derive an objective function as a weighted loss, with weights proportional to the bias-conflicting probability for each training example. Since we consider cases where bias labels are not provided, we use the disagreement probability between the target label and the prediction of an intentionally biased model as a substitute for the bias-conflicting probability. Our proposed approach is simple yet effective in mitigating spurious correlations.

The main contributions of this paper can be summarized as follows:

* We present a debiasing objective for mitigating reliance on bias attributes. This objective aims to guide the model to have similar performance over two groups: the bias-aligned group and the bias-conflicting group. This approach differs from previous works, which typically define groups based on combinations of target labels and bias labels.
* We propose a new method, coined _Disagreement Probability based Resampling for debiasing (DPR)_, which is derived from the proposed objective. DPR leverages the disagreement probability between the target label and the prediction of a biased model to determine the weight of each training example.
* DPR achieves state-of-the-art performance across six benchmarks with spurious correlations, surpassing existing methods that do not use bias labels. Notably, on the bias-conflicting test set of Biased FFHQ (BFFHQ)--which contains only 0.5% of bias-conflicting samples in the training set--the proposed method significantly improves accuracy by 20.87% compared to ERM and by 6.2% compared to the best baseline.
* We theoretically demonstrate that DPR encourages consistent model performance across both bias-aligned and bias-conflicting groups, thus promoting strong performance across all samples regardless of spurious correlations.

## 2 Related work

Debiasing with bias annotations.Numerous previous works utilize bias labels for debiasing [38; 48; 18; 3; 44; 53]. For example, Group DRO  employs bias labels to define groups and directly enhances worst-group accuracy to mitigate the effect of spurious correlations; meanwhile, LISA  mixes two samples with the same label but different domains, or with different labels but the same domain, canceling out spurious correlations and learning invariant predictors. These methods have demonstrated their effectiveness across multiple benchmarks with spurious correlations. However, annotating bias labels for each training example is labor-intensive, and obtaining such labels can sometimes be challenging due to privacy concerns as well . Consequently, in more recent studies, some researchers have utilized only a small set of bias-annotated data to reduce reliance on bias labels [24; 35; 19]. For example, DFR  uses a small group-balanced dataset with bias labels to retrain the last layer of the ERM-trained model.

Debiasing without bias annotations.In an effort to eliminate reliance on bias annotations, recent studies predominantly focus on reducing bias without explicit bias labels [34; 22; 27; 1; 29; 28; 49; 45]. Given the unavailability of bias labels, these methods commonly employ a two-stage strategy: (1) identifying bias-aligned and bias-conflicting samples, and (2) training the debiased model by leveraging information obtained from (1). The identification of bias-conflicting samples is accomplished through the use of a deliberately biased model, trained either with generalized cross-entropy loss [34; 22; 27; 1; 29] or standard cross-entropy loss [28; 49; 45]. For instance, LfF  and DFA  regard samples as bias-conflicting samples if the biased model exhibits higher cross-entropy losses on these samples compared to the debiased model. Subsequent efforts then focus on enhancing classification accuracy for these identified bias-conflicting samples. Numerous studies have proposed diverse debiasing methods [14; 52; 8; 23], including those based on contrastive learning [49; 20] and unsupervised clustering [40; 42].

Many debiasing methods that do not require bias labels aim to enhance performance on the bias-conflicting group, yet the optimal extent of this enhancement remains uncertain. We contend that a debiased model should exhibit consistent performance across both bias-aligned and bias-conflicting groups. However, to the best of our knowledge, no existing training objective is explicitly designed for this purpose. Therefore, we introduce a novel training objective tailored for this purpose, from which we develop DPR--a debiasing method that does not rely on bias labels.

## 3 Problem formulation

We consider a multi-class classification problem with a dataset \(=\{(x_{i},y_{i})\}_{i=1}^{n}\), where each \(x_{i}\) represents an input, and each \(y_{i}\) is the corresponding label from \(K\) possible classes. These examples are presumed to be sampled from a training distribution \(P\). Given a classification model \(f_{}:^{K}\) that maps an input to \(K\) logits, and a convex loss \(:_{ 0}\), ERM aims to find a model that minimizes the expected loss \(_{(x,y) P}[(f_{}(x),y)]\). To this end, we typically minimize a surrogate loss \(}_{avg}\):

\[}_{avg}=_{(x,y)}(f_{}(x ),y).\] (1)

The cross-entropy (CE) loss is commonly used for training classification models. It is defined as \(_{}(f_{}(x),y)=-f_{}(x)[y]+_{y^{}}( f_{}(x)[y^{}])\), where \(f_{}(x)[y]\) denotes the logit corresponding to the \(y\)-th class label.

We assume there is a spurious correlation presence indicator \(b=\{,\}\) in the dataset. As this indicator denotes whether spurious correlations are present within each sample, it can also be considered as a bias-aligned or bias-conflicting group indicator. Similar to the Group DRO setting [38; 17], we adopt the latent prior probability change assumption . With a group indicator \(b\), we assume

\[P(x,y|b)=Q(x,y|b), P(b) Q(b),\] (2)

where \(P\) and \(Q\) denote the training and test data distributions, respectively. Under this assumption, \(P(x,y)\) and \(Q(x,y)\) are represented as mixtures of the conditional distributions \(P(x,y|b)\). Our goal is to find models that are robust against spurious correlations. Regardless of the presence of spurious correlations within each data example, a model that does not rely on these correlations should exhibit strong performance across all examples. In other words, the debiased model should perform consistently well on both bias-aligned and bias-conflicting groups. To this end, we propose the following training objective to avoid spurious correlations:

\[_{}_{b}\{}_{b}:=}_{(x,y,b) G_{b}}(f_{}(x),y)\},\] (3)

where \(G_{b}\) is a subset of the training data composed of samples drawn from \(P(x,y|b)\) and \(n_{b}\) is the size of \(G_{b}\). The proposed objective aims to minimize the maximum average loss over bias-aligned and bias-conflicting groups, thereby reducing the reliance of classification models on spurious correlations. However, to utilize the above objective, we must know the information about bias attributes. In the next section, we describe a practical method to train the debiased model using Equation (3) without bias labels.

## 4 DPR: Disagreement Probability based Resampling for debiasing

We present DPR, a resampling method derived from the proposed objective, which does not require bias annotations during training. First, we provide a walk-through of how the objective in Equation (3) can be reformulated as a weighted loss minimization problem. Next, we detail a method for calculating the weight of each training example, along with proxies for both bias-aligned and bias-conflicting groups. Finally, we provide a full description of our algorithm.

### Problem reformulation

To utilize the objective in Equation (3) without bias annotations, we reformulate this objective as a weighted loss minimization problem. For this purpose, we introduce the following assumption:

**Assumption 1**.: Let \(b_{a}\) and \(b_{c}\) represent the bias-aligned and bias-conflicting groups, respectively. The neural network, parameterized by \(\), satisfies that \(}_{b_{a}}<}_{b_{c}}\).

In Assumption 1, we assume that the model, parameterized by \(\), exhibits a higher average loss on the bias-conflicting group compared to the bias-aligned group in the training dataset. Under this assumption, the maximum average loss over groups in Equation (3) can be expressed as follows:

\[_{b}}_{b} =}}_{(x,y,b_{c}) G_{b_{c}}}(f_{ }(x),y)\] (4) \[=}}_{(x,y,b)}p(b=b_{c}|x)( f_{}(x),y)\] (5) \[=_{(x,y,b)}|x)}{p(b=b _{c})}(f_{}(x),y).\] (6)

When Assumption 1 is satisfied, Equation (4) holds. Given that all samples in \(G_{b_{c}}\) have \(p(b=b_{c}|x)\) equal to 1, whereas all samples in \(G_{b_{c}}\) have \(p(b=b_{c}|x)\) equal to 0, Equation (5) is derived from Equation (4). As \(p(b=b_{c})\) is equal to \(}}{n}\), Equation (6) is obtained. By denoting \(|x)}{p(b=b_{c})}\) as \(r(x,y,b)\), we obtain a weighted loss minimization as follows:

\[_{}_{(x,y,b)}r(x,y,b)(f_{}(x),y).\] (7)

Note that the weight \(r(x,y,b)\) can be interpreted as the sampling probability.

### Sampling probability with group proxy

In order to train the model using Equation (7), it is necessary to compute the sampling probability \(r(x,y,b)\) for each training example. However, directly calculating the probabilities \(p(b=b_{c}|x)\) and \(p(b=b_{c})\) is unfeasible without bias labels. To overcome this limitation, we first introduce proxies for the bias-aligned and bias-conflicting groups. We then derive substitutes for the probabilities \(p(b=b_{c}|x)\) and \(p(b=b_{c})\) using a biased model.

Group proxy.We focus on the characteristics of the biased model for the group proxies. Following Nam et al. , the biased model \(f_{}\) is trained using ERM with the generalized cross-entropy (GCE) loss :

\[_{}(f_{}(x),y)=(y|x)^{q}}{q},\] (8)

where \(p_{}(y|x)\) represents the probability assigned to the target label \(y\) by the neural network after a softmax layer, and \(q(0,1]\) is a hyperparameter. The GCE loss amplifies the bias of the model by up-weighting the gradient of the cross-entropy loss for samples with high probability \(p_{}(y|x)\), thereby training the model to rely on spurious correlations. Consequently, the biased model tends to predict correctly for bias-aligned samples and incorrectly for bias-conflicting samples . Building on this insight, leveraging the predictions \(y_{}\) of the biased model, we employ the agreement between the label and the biased model's prediction (_i.e._, \(y=y_{}\)) as a proxy for the bias-aligned group \(b_{a}\), and the disagreement (_i.e._, \(y y_{}\)) as a proxy for the bias-conflicting group \(b_{c}\).

Sampling probability.We now discuss how to compute the sampling probability \(r(x,y,b)\). Using the group proxies mentioned above, we substitute \(p(y y_{}|x)\) for \(p(b=b_{c}|x)\). For a given example \((x,y)\), the disagreement probability \(p(y y_{}|x)\) can be computed as follows:

\[p(y y_{}|x)=_{y_{}}p(y,y_{}|x)-p(y=y _{}|x)=1-p_{}(y|x),\] (9)

where \(p_{}(y|x)=(x)[y]/)}{Z()}\) is the probability assigned to label \(y\) by the biased model, \(Z()=_{y^{}}(f_{}(x)[y^{}]/)\) is the partition function, and \(\) is a temperature hyperparameter. Note that \(p_{}(y|x)\) is used to approximate \(p(b=b_{a}|x)\). It is crucial for the biased model to accurately capture the spurious correlation structure; hence, the probabilities of the biased model should be appropriately calibrated [13; 33; 32]. We also substitute \(p(y y_{})\) for \(p(b=b_{c})\). This probability can be estimated using all the training data, as in prior works [29; 45]:

\[p(y y_{})_{(x,y,b)}p(y y _{}|x)=_{(x,y,b)}(1-p_{}(y|x)).\] (10)

With Equations (9) and (10), we compute

\[(x,y)=}|x)}{p(y y_{ })}=}(y|x)}{_{(x,y,b)} (1-p_{}(y|x))}.\] (11)

Instead of \(r(x,y,b)\), we use \((x,y)\) as the sampling probability. We are now ready to train the debiased model.

### Training algorithm

We outline the entire training process for our method as follows. First, we train the biased model \(f_{}\). Next, we compute the sampling probability \((x,y)\) using the pretrained biased model. Before proceeding to train the debiased model \(f_{}\), it is worth noting that Equation (7) is derived under Assumption 1. Thus, it is essential to fulfill Assumption 1 when training the debiased model usingEquation (7). We leverage the characteristics of the biased model for this purpose. The biased model typically exhibits higher loss on bias-conflicting samples and lower loss on bias-aligned samples, thereby fulfilling Assumption 1. Consequently, we initialize the model \(f_{}\) with the biased model \(f_{}\) and then train \(f_{}\) using training examples sampled with the probability \((x,y)\). We also employ data augmentation to enhance the diversity of bias-conflicting samples. Simply oversampling these samples without enhancing their diversity does not effectively mitigate bias . Therefore, we enhance the diversity of bias-conflicting samples through data augmentation techniques such as random color jitter and random rotation. The complete training procedure is outlined in Algorithm 1.

## 5 Theoretical analysis

In this section, we theoretically demonstrate that DPR minimizes losses for both bias-aligned and bias-conflicting groups while reducing the disparity between their losses. All proofs are deferred to Appendix A. Let \(_{avg}\) be the expected average loss:

\[_{avg}:=_{(x,y) P}[(f_{}(x),y)].\] (12)

Let \(_{b}\) be the average loss of group \(b\):

\[_{b}:=_{(x,y) P_{b}}[(f_{}(x),y)],\] (13)

where \(P_{b}=P(x,y|b)\) denotes the training distribution conditioned on \(b\), for any \(b\). In this setting, we derive the following inequality for the loss gap between the bias-aligned and bias-conflicting groups.

**Theorem 1**.: Suppose that the loss function \((f_{}(x),y)\) is upper-bounded by a constant \(C>0\). Given two distinct groups \(b_{a}\) and \(b_{c}\) such that \(b_{a} b_{c}\), the following inequality holds with probability at least \(1-\), for any \(>0\):

\[|_{b_{a}}-_{b_{c}}| 2_{b} }_{b}+C_{b}|/)}}{n_{b}}}.\] (14)

Theorem 1 specifies that the upper bound on the disparity between losses for bias-aligned and bias-conflicting groups is determined by the maximum average loss over groups and a term dependent on the size of the smaller group. Additionally, we derive an inequality associated with the expected average loss.

**Theorem 2**.: In the same setting as Theorem 1, the expected average loss is bounded above with probability at least \(1-\):

\[_{}_{b}}_{b}+C }.\] (15)

According to Theorems 1 and 2, our proposed training objective not only closes the loss gap between bias-aligned and bias-conflicting groups but also reduces the expected average loss. However, in Equation (14), there remains a loss gap due to a term inversely related to the square root of the size of the smaller group. Note that DPR is a resampling method derived from the proposed objective when Assumption 1 is fulfilled, and it identifies and upsamples bias-conflicting samples. Thus, it efficiently minimizes both terms of the upper bound described in Equation (14). Given that \(_{avg}\) is expressed as a weighted sum of \(_{b_{a}}\) and \(_{b_{c}}\), these theorems indicate that DPR enhances performance across both bias-aligned and bias-conflicting groups while reducing the performance gap between them.

## 6 Experiments

### Datasets

We evaluate the debiasing performance of DPR using six benchmark datasets that exhibit spurious correlations. Colored MNIST and Multi-bias MNIST are synthetic datasets designed under the premise that models learn bias attributes first. Conversely, BAR, BFFHQ, CelebA, and CivilComments-WILDS are real-world datasets where inherent biases degrade model performance. We follow the evaluation protocols of previous studies [1; 27; 28] and provide a detailed description of these datasets in Appendix B.1.

Colored MNIST.Colored MNIST (C-MNIST) is a synthetic dataset designed for digit classification, comprising ten digits, each spuriously correlated with a specific color. Following the protocols in Ahn et al. , we set the ratios of bias-conflicting samples, denoted as \(\), at 0.5%, 1%, and 5% for the training set, and 90% for the unbiased test set. We report the accuracy on this unbiased test set.

Multi-bias MNIST.Multi-bias MNIST (MB-MNIST)  is a synthetic dataset designed to incorporate more complex patterns compared to C-MNIST and biased-MNIST . MB-MNIST comprises eight attributes: digit , alphabet , fashion object , Japanese character , digit color, alphabet color, fashion object color, and Japanese character color. The digit shape is the target attribute, while the other seven serve as bias attributes. In MB-MNIST, bias is introduced by aligning the digit with each of the other seven attributes, each with a probability of \(1-\). In our experiments, \(\) is set to 10%, 20%, and 30% for the training set and 90% for the unbiased test set, as in Ahn et al. . We report the accuracy on this unbiased test set.

Biased action recognition.The biased action recognition (BAR) dataset , designed for action classification, comprises six action classes such as climbing and fishing, each spuriously correlated with a specific place. The training set of BAR contains only bias-aligned samples, while the test set consists solely of bias-conflicting samples. We report the accuracy on this bias-conflicting test set.

Biased FFHQ.Biased FFHQ (BFFHQ) is a real-world facial dataset, which has age (young or old) as a label and gender (male or female) as a bias attribute. Predominantly, females are young and males are old in this dataset. We use a bias-conflicting ratio of \(=0.5\%\) in the training set and report accuracies on both an unbiased test set with \(=50\%\) and a bias-conflicting test set with \(=100\%\).

CelebA.CelebA  is a dataset for facial classification. The goal is to classify celebrity hair color as blond or non-blond, which is spuriously correlated with gender. Notably, only a few blond-haired celebrities are male. Following prior studies [49; 38], we report both average and worst-group accuracies on the test set, where groups are defined as combinations of class labels and bias labels.

CivilComments-WILDS.CivilComments-WILDS [5; 25] is a text classification dataset aimed at identifying whether online comments are toxic or non-toxic. The label is spuriously correlated with demographic identities such as gender, race, and religion. Following previous works [28; 25; 49], we report both average and worst-group accuracies on the test set, where groups are defined as combinations of class labels and bias labels.

### Experimental setup

Baselines.We compare our method with six baselines on various benchmarks: ERM, JTT , DFA , CNC , PGD , and LC . ERM denotes conventional training without any considerations for debiasing, while the others are debiasing methods that do not require bias annotations during training.

Implementation details.For all datasets except CelebA and CivilComments-WILDS, we follow the experimental settings of Ahn et al. . Specifically, for CMNIST and MB-MNIST, we employ two distinct types of simple CNN models, respectively. For BAR and BFFHQ, we utilize a ResNet18  pretrained on ImageNet . In the case of CelebA, we use a pretrained ResNet50, following the experimental settings of Zhang et al. . For CivilComments-WILDS, we deploy a pretrained BERT model and follow the experimental setup detailed in Liu et al. . Moreover, we apply data augmentation techniques--including random resize crop, random color jitter, and random rotation--for all vision datasets except CelebA, as discussed in Section 4.3. Further details on model architectures, hyperparameters, and image processing are provided in Appendix B.2.

### Experimental results and analysis

Classification accuracy.Table 1 presents the average accuracies on unbiased test sets for C-MNIST and MB-MNIST. DPR consistently outperforms or matches the performance of other baselines across all experiments with varying bias-conflicting ratios. Notably, for the MB-MNIST dataset with a ratio of 30%, DPR achieves an unbiased test accuracy of 94.04%, outperforming PGD by 3.28%. Even for MB-MNIST with a ratio of 10%, where all baselines except PGD fail to achieve higher accuracy, DPR exhibits the highest accuracy of 62.21%. In the more complex setting of MB-MNIST, compared to C-MNIST, the effectiveness of DPR is even more pronounced. The superiority of our method is further demonstrated on real-world benchmarks, as shown in Table 2. Our method consistently achieves the best performance for each real-world dataset. Specifically, for the BFFHQ dataset, DPR achieves an accuracy of 87.57% on unbiased test sets, which is 3.37% higher than PGD, and an accuracy of 76.80% on bias-conflicting test sets, which is 6.20% higher than LC. For the CelebA and CivilComments-WILDS datasets, our method achieves the highest worst-group accuracy compared to other baselines, with groups defined as the combination of the target and bias labels. We especially highlight the results for the BFFHQ benchmark, where our method improves accuracy on both unbiased and bias-conflicting test sets. This result supports our claim that DPR enhances performance on both bias-aligned and bias-conflicting groups.

Identifying group via disagreement probability.To discern whether each sample belongs to the bias-aligned or bias-conflicting group, we check if the target label disagrees with the prediction of the biased model and use its probability as an up-weight. To evaluate whether the disagreement probability between the target label and the prediction of the biased model distinguishes bias-conflicting samples from bias-aligned samples effectively, we plot the distributions of disagreement probabilities \(p(y y_{}|x)\) for each bias-aligned and bias-conflicting sample. The experiment is conducted on the C-MNIST dataset. As illustrated in Figure 2, bias-aligned samples generally exhibit

    &  &  \\  Ratio (\%) & 0.5 & 1 & 5 & 10 & 20 & 30 \\  ERM & 60.94 (0.07) & 79.13 (0.73) & 95.12 (0.24) & 25.23 (1.16) & 62.06 (2.45) & 87.61 (1.60) \\ JTT & 85.84 (1.32) & 95.07 (3.42) & 96.56 (1.23) & 25.34 (1.45) & 68.02 (3.23) & 85.44 (3.44) \\ DFA & 94.56 (0.57) & 96.87 (0.64) & 98.35 (0.20) & 25.75 (5.38) & 61.62 (2.60) & 88.36 (2.06) \\ PGD & 96.88 (0.28) & 98.38 (0.11) & **98.62 (0.14)** & 61.38 (4.41) & 89.09 (0.97) & 90.76 (1.84) \\ LC & 97.25 (0.21) & 97.34 (0.16) & 97.44 (0.37) & 25.86 (8.68) & 71.23 (1.71) & 89.57 (2.50) \\ DPR (Ours) & **97.52 (0.33)** & **98.40 (0.03)** & **98.62 (0.12)** & **62.21 (4.02)** & **89.11 (1.65)** & **94.04 (0.26)** \\   

Table 1: Average accuracies and standard deviations over three trials on two synthetic image datasets, C-MNIST and MB-MNIST, under varying ratios (%) of bias-conflicting samples. Except for LC, the results of baselines reported in Ahn et al.  are provided. The best performances are highlighted in **bold**.

    &  &  &  &  \\  Accuracy (\%) & Conflicting & Unbiased & Conflicting & Average & Worst & Average & Worst \\  ERM & 63.15 (1.06) & 77.77 (0.45) & 55.93 (0.64) & 94.9 (0.3) & 47.7 (2.1) & 92.1 (0.4) & 58.6 (1.7) \\ JTT & 63.62 (1.33) & 77.93 (2.16) & 56.13 (0.83) & 88.1 (0.3) & 81.5 (1.7) & 91.1 (-) & 69.3 (-) \\ DFA & 64.70 (2.06) & 82.77 (1.40) & 66.00 (2.00) & - & - & - & - \\ CNC & - & - & - & - & - & - \\ PGD & 65.39 (0.47) & 84.20 (1.15) & 70.07 (2.00) & 88.6 (-) & 88.0 (-) & 92.1 (-) & 70.6 (-) \\ LC & 63.45 (2.14) & 83.97 (0.83) & 70.60 (0.60) & - & 88.1 (0.8) & - & 70.3 (1.2) \\ DPR (Ours) & **66.11 (3.29)** & **87.57 (1.2)** & **76.80 (2.51)** & 90.7 (0.6) & **88.9 (0.6)** & **82.9 (0.7)** & **70.9 (1.7)** \\   

Table 2: Classification accuracies (%) and standard deviations over three trials on four real-world datasets. Conflicting refers to accuracy on bias-conflicting test sets, while Unbiased indicates accuracy on unbiased test sets. Average and Worst denote average test accuracy and worst-group accuracy, respectively. Results of all baselines except LC are taken from Ahn et al. , with the exception of bias-conflicting accuracy on BFFHQ. The best performances are highlighted in **bold**.

Figure 2: Distributions of disagreement probabilities for each sample within bias-aligned and bias-conflicting groups.

smaller disagreement probabilities compared to bias-conflicting samples. This result demonstrates that disagreement probability effectively differentiates bias-aligned and bias-conflicting samples. Moreover, the relatively high disagreement probability associated with bias-conflicting samples enables DPR to effectively identify and upsample bias-conflicting samples, suggesting that the disagreement probability \(p(y y_{}|x)\) serves as an efficient substitute for the bias-conflicting probability \(p(b=b_{c}|x)\).

Group losses of different models.As stated earlier in Section 4.3, our debiasing objective in Equation (7) should be used only when Assumption 1 is satisfied. A natural next question is: which type of model satisfies this assumption? We test three types of models: a randomly initialized model, a model pretrained on ImageNet, and a biased model. Specifically, we examine the average loss of a randomly initialized model on the bias-aligned and bias-conflicting groups of C-MNIST with a bias-conflicting ratio of 0.5%. Additionally, we examine the average loss of a pretrained model on the bias-aligned and bias-conflicting groups of BFFHQ. We also investigate the average loss of a biased model on the bias-aligned and bias-conflicting groups of C-MNIST and BFFHQ. The results, shown in Figure 3, indicate that both the randomly initialized and pretrained models have similar average losses on the bias-aligned and bias-conflicting groups. In contrast, the biased model has a higher average loss on the bias-conflicting group compared to the bias-aligned group for both C-MNIST and BFFHQ. This result supports the validity of initializing the debiased model with the biased model.

Ablation study.We conduct an ablation study on model initialization, GCE, and data augmentation. Model initialization refers to initializing the debiased model with the biased model. The evaluation is performed on C-MNIST with bias-conflicting ratios of 0.5% and 5%, as well as BFFHQ. Table 3 demonstrates the importance of each component. Comparing the first and second rows, we observe that GCE and data augmentation bring small improvements when initialization is not used. However, from rows 3-5, we observe that GCE and augmentation bring significant improvements when initialization is utilized. For BFFHQ, introducing both GCE and augmentation significantly improves the average accuracies on unbiased and bias-conflicting sets by 9.07% and 19.33%, respectively. Furthermore, we observe the performance gap between using and not using initialization. These results suggest that model initialization is crucial and that GCE and augmentation are also important when initialization is introduced. The best performances are consistently achieved when all components are utilized.

## 7 Conclusions and Limitations

We present DPR, a resampling method that leverages disagreement probability to identify and upsample bias-conflicting samples. This method is derived from a novel training objective designed to achieve consistent performance across both bias-aligned and bias-conflicting groups. It does not rely on bias annotations and has demonstrated state-of-the-art performance across spurious correlation benchmarks. However, DPR has certain limitations: its effectiveness depends on how well the biased model captures the spurious correlation structure, as it uses the predictions of this model to infer

Figure 3: Average loss of randomly initialized, pretrained, and biased models on bias-aligned and bias-conflicting groups. The error bars represent the standard deviations over three trials.

    &  &  &  &  &  \\   & & & Unbiased & Unbiased & Unbiased & Conflicting \\  ✗ & ✗ & ✗ & 66.13 (0.51) & 95.32 (0.42) & 77.07 (1.16) & 54.60 (2.43) \\ ✗ & ✓ & ✓ & 66.47 (1.74) & 95.21 (0.14) & 77.60 (0.79) & 55.60 (1.64) \\ ✓ & ✗ & ✗ & 89.06 (0.62) & 97.36 (0.29) & 78.50 (0.50) & 57.47 (0.90) \\ ✓ & ✓ & ✗ & 95.94 (0.45) & 97.66 (0.17) & 80.93 (1.33) & 63.40 (3.67) \\ ✓ & ✓ & ✓ & **97.52 (0.33)** & **98.62 (0.12)** & **87.57 (1.22)** & **76.80 (2.51)** \\   

Table 3: Ablation studies of the proposed method on the C-MNIST and BFFHQ datasets. We report the average test accuracies and standard deviations over three trials on unbiased and bias-conflicting test sets. A checkmark (✓) indicates the case where each component of the proposed method is applied. The best performances are highlighted in **bold**.

the group to which each training sample belongs. Moreover, DPR employs a two-stage approach that complicates the training process and introduces additional hyperparameters. Despite these limitations, DPR's simple implementation and strong performance, supported by theoretical analysis illustrating its ability to reduce loss disparity between groups and minimize average loss, underscore its usefulness in mitigating reliance on spurious correlations.