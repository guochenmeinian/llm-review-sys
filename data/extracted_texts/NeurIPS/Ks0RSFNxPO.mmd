# Time-Independent Information-Theoretic Generalization Bounds for SGLD

Futoshi Futami

Osaka University / RIKEN AIP

futami.futoshi.es@osaka-u.ac.jp

&Masahiro Fujisawa

RIKEN AIP

masahiro.fujisawa@riken.jp

Equal contribution.Corresponding author.

###### Abstract

We provide novel information-theoretic generalization bounds for stochastic gradient Langevin dynamics (SGLD) under the assumptions of smoothness and dissipativity, which are widely used in sampling and non-convex optimization studies. Our bounds are time-independent and decay to zero as the sample size increases, regardless of the number of iterations and whether the step size is fixed. Unlike previous studies, we derive the generalization error bounds by focusing on the time evolution of the Kullback-Leibler divergence, which is related to the stability of datasets and is the upper bound of the mutual information between output parameters and an input dataset. Additionally, we establish the first information-theoretic generalization bound when the training and test loss are the same by showing that a loss function of SGLD is sub-exponential. This bound is also time-independent and removes the problematic step size dependence in existing work, leading to an improved excess risk bound by combining our analysis with the existing non-convex optimization error bounds.

## 1 Introduction

Stochastic optimization, including stochastic gradient descent (SGD), is central to realizing practical large-scale or deep-learning models. There are currently considerable active discussions on accurately determining the generalization performance of models trained by SGD or its variants. In particular, stochastic gradient Langevin dynamics (SGLD) [13; 39; 29], a noisy variant of SGD, has garnered much attention in this type of study since it provides a useful theoretical framework for generalization error analysis based on the Langevin diffusion context . Our study aims to contribute to a more accurate understanding and evaluation of the generalization performance for SGLD.

There are two main approaches to generalization analysis in SGLD. One is the _information-theoretic analysis_ proposed by Russo and Zou  and Xu and Raginsky , by which a generalization error bound is derived using the mutual information (MI) between the learned parameters and the training dataset. Recently, some extensions using gradient information have been made to investigate the generalization properties of SGLD, for example, upper-bounding the MI with the norm of gradients  and the sum of gradient variances [25; 35; 37; 36]. Information-theoretic generalization bounds are applicable to a wide range of noisy iterative algorithms such as differentially private SGD  and stochastic gradient Hamiltonian Monte Carlo  modified to include a noisy momentum.

The other approach is _stability analysis_, by which the effects of changes in the learning algorithm due to the addition or removal of a single training data point on the generalization performance are investigated. Raginsky et al.  derived the non-asymptotic generalization and excess risk bound of SGLD via the exponential ergodicity of Langevin diffusion. Starting with the study by Raginskyet al. , there have been many attempts to improve the generalization analysis in SGLD from the stability perspective, such as those by Zhang et al. , Mou et al.  and Li et al. .

Unfortunately, these existing generalization bounds are _time-dependent_; namely, they diverge with increasing number of iterations unless the step size is adjusted so that the order of bound values is \((n^{-1})\) or \((n^{-1/2})\), where \(n\) is the sample size (see Section 5 for details). Farghly and Rebeschini  attempted to avoid this problem by Wasserstein stability analysis through reflection coupling  under the smoothness and dissipativity  assumptions commonly used in sampling and non-convex optimization communities [29; 44]. Although their bounds bypass the divergence problem when taking a supremum over time, the geometry introduced for the reflection coupling yields an unnatural dependence on step size, resulting in a vacuous bound as the step size decreases (see Table 1).

In this paper, we provide novel generalization bounds for SGLD under smooth and dissipative loss functions obtained by the information-theoretic approach. We focus on the upper bound of the MI, namely, the Kullback-Leibler (KL) divergence between the distributions of parameters learned from different training datasets. We then analyze its time evolution caused by the update of the SGLD algorithm through the Fokker-Planck (FP) equation (Lemma 1). On the basis of this analysis, we obtain time-independent generalization error bounds that decay to zero as \(n\) regardless of the number of iterations or whether the step size is fixed (Theorem 4 and Corollary 1). Conventional information-theoretic generalization bounds [29; 28; 35; 36] are derived by bounding the MI between the parameters at all iterations and the training dataset. Therefore, these bounds grow linearly with the number of iterations, resulting in a time-dependent generalization error bound. Our analysis based on time evolution eliminates both this linearity issue and the unnatural dependence on step size (the inverse of step size) in the time-independent bound of Farghly and Rebeschini .

Another contribution is providing the first information-theoretic generalization bound and the excess risk bound when the same loss is used for training and the generalization performance evaluation. In the conventional information-theoretic approach, deriving generalization error bounds under this setting was challenging owing to the unknown tail behavior of a loss function of SGLD. We overcome this difficulty with our discovery that a smooth and dissipative loss function of SGLD is sub-exponential.

## 2 Preliminaries

### Problem settings and stochastic gradient Langevin dynamics

We represent random variables in capital letters, such as \(X\), and deterministic values in lowercase letters, such as \(x\), and express the Euclidean inner product and distance as \(\) and \(\|\|\). Let \(\) be an unknown generating distribution on the instance space \(\) and \(w^{d}\) be the \(d\)-dimensional parameters such as weights of neural networks, where \(\) is the space of the parameters. We consider a loss function \(l:\) and the following optimization problem:

\[_{w W}L_{}(w)_{Z}[l(w,Z)]=_{}l(w,Z)(z),\]

which cannot be computed since \(\) is unknown. Instead, we typically minimize the empirical risk estimated using the dataset \(S\{Z_{i}\}_{i=1}^{n}\):

\[_{w}L_{S}(w)_{i=1}^{n}l(w,Z_{i}),\]

where \(\{Z_{i}\}_{i=1}^{n}\) are independent and identically distributed (i.i.d.) samples from \(\), i.e., \(Z_{i}}}{{}}\).

Stochastic gradient Langevin dynamics.In this paper, we use the SGLD algorithm  to solve the empirical risk minimization. SGLD utilizes the gradient information of the loss function; however, some loss functions, such as the \(0\)-\(1\) loss, are not differentiable. In this case, it is common to use the differentiable surrogate loss function \(f:\) (e.g., the cross-entropy loss) and minimize the following empirical risk: \(F_{S}(w)_{i=1}^{n}f(w,Z_{i})\). Given a mini-batch \(B[n]\{1,,n\}\) with \(k=|B| n\), we define its mini-batch version as

\[F(w,B)_{i B}f(w,Z_{i}).\]The SGLD algorithm updates the parameters using the following recursion:

\[W_{t+1}=W_{t}-_{t} F(W_{t},B_{t})+^{-1}_{t}}_{t},  W_{0} P_{W_{0}},\]

where \(P_{W_{0}}\) is a given initial distribution, \( F(w,B)\) is a stochastic gradient, \(t\) is the number of iterations, \(_{t}\) is the step size, \(_{t}\) is the inverse temperature, and \((B_{t})_{t=0}^{}\) is an i.i.d. sequence of random variables distributed uniformly on \(\{B[n]:|B|=k\}\). In addition, \((_{t})_{t=0}^{}\) is an i.i.d. sequence of standard Gaussian random variables, i.e., \(_{t}(0,_{d})\), where \(_{d}\) is the \(d\)-dimensional identity matrix. The output parameters \(W\) obtained using SGLD can be seen as the samples from a conditional distribution \(P_{W|S}:^{n}\). We express the \(t\)-th output of the SGLD algorithm as \(W_{t}\).

### Expected generalization error and its bounds

The focus of this paper is the _expected generalization error_, defined as

\[(,P_{W|S};L)_{S,W}[L_{}(W)-L_{S}(W)],\] (1)

where the expectation is taken over the joint distribution of \((S,W)\), i.e., \(^{n} P_{W|S}\).

Information-theoretic generalization bounds.Russo and Zou  and Xu and Raginsky  have shown that Eq. (1) can be bounded by the MI between the input dataset \(S\) and the output parameters \(W\) under the following sub-Gaussian assumption.

**Assumption 1** (sub-Gaussian losses).: _A loss function \(l(w,Z)\) is sub-Gaussian under \(Z\) for all \(w\), that is, there is a positive constant \(_{g}^{2}\) such that \(_{Z}[((l(w,Z)-l(w,Z)))]^{2} _{g}^{2}/2\) for all constant \(\)._

For example, bounded or Lipschitz-continuous loss functions satisfy this assumption. Assumptions regarding the tail behavior of the loss function distributions as in the above are necessary for the information-theoretic generalization error analysis. Bu et al.  have investigated information-theoretic generalization bounds with another tail-behavior assumption such as sub-exponential losses.

We introduce the following standard information-theoretic generalization bound.

**Theorem 1** (Russo and Zou  and Xu and Raginsky ).: _Suppose that Assumption 1 holds. Then, we have_

\[|(,P_{W|S};L)|^{2}}{n}I(W;S)},\] (2)

_under a training dataset \(S=\{Z_{i}\}_{i=1}^{n}\) and the algorithm's output \(W\), where \(I(W;S)\) is the MI between \(W\) and \(S\)._

In the SGLD context, \(I(W,S)\) of Eq. (2) can be upper-bounded in a form that incorporates the gradient variance . Given the output of the \(T\)-th iterate of the SGLD algorithm, \(W_{T}\), the following upper bound can be obtained.

**Theorem 2** (Modified bound of Pensia et al. ).: _Let \(f(,z)\) be an \(L\)-Lipschitz continuous function, namely, there is a constant \(L>0\) such that \(\|f(w,z)-f(,z)\| L\|w-\|\) holds for all \(w,\) and all \(z\). Then, we obtain_

\[I(W_{T};S)}}{{}}_{t=0}^{T}(1+_{t}}{d}[ f(W_{t},B_{t}) |W_{t}])_{t=0}^{T}(1+_{t }L^{2}}{d}),\] (3)

_where \([ f(W,B)|W]_{B}[\|_{W}f (W,B)-_{B}[_{W}f(W,B)]\|^{2}|W]\) is the conditional variance._

Note that bound (i) can be obtained by the data-processing inequality .

The merit of such information-theoretic generalization bounds is that we can evaluate the bound value using the empirically estimated gradient variance per iteration. However, unfortunately, from Eq. (3), this bound is _time-dependent_; namely, the bound value can diverge unless the gradient variance or \(_{t}_{t}\) approaches \(0\) as \(T\). This is due to the data-processing inequality when deriving upper bound (i) in Eq. (3). By the data-processing inequality, we obtain \(I(W_{T};S) I(W^{(T)};S)\), where \(W^{(T)}(W_{0},W_{1},,W_{T})\) denotes the joint random variables appearing in all the iterations in the algorithm. Since \(W^{(T)}\) is treated simultaneously, the bound is inevitably linear in \(T\).

Another limitation of the information-theoretic approach appears in the setting where training losses (\(f\)) are also used for performance evaluation, which is often employed in sampling and non-convex optimization studies of SGLD [29; 41]. In this setting, the generalization error is defined as

\[(,P_{W|S};F)_{S,W}[F_{}(W)-F_{S}(W)],\] (4)

where \(F_{}_{Z}[f(w,Z)]\). We cannot conduct the information-theoretic analysis for Eq. (4) because the tail behavior of the distribution of the training loss is unclear.

Time-independent generalization bounds for Eq. (4).To solve the above problems, Farghly and Rebeschini  provided the generalization error bounds of Eq. (4) from the stability perspective under the following assumptions widely used in the non-convex optimization analysis of SGLD [29; 41; 19].

**Assumption 2** (Smoothness).: _For each \(z\), \(f(,z)\) is differentiable and \(M\)-smooth. That is, there is a positive constant \(M\) for all \(w,\;\) and all \(z\) such that_

\[\| f(w,z)- f(,z)\| M\|w-\|.\]

**Assumption 3** (Dissipativity ).: _For each \(z\), \(f(,z)\) is \((m,b)\)-dissipative. 1 That is, there are positive constants \(m\) and \(b\) for all \(w\) and \(z\) such that_

\[m\|w\|^{2}-b f(w,z) w.\]

The discussion regarding loss functions that satisfy Assumption 3 is presented in Appendix B.

Hereafter, we eliminate the time dependence of the step size and temperature by setting \(_{t}=\) and \(_{t}=\). With this notation, Farghly and Rebeschini  derived the following generalization bound.

**Theorem 3** (Farghly and Rebeschini ).: _Suppose that Assumptions 2 and 3 hold. Assume that the initial law of \(W_{0}\) has a finite fourth moment \(\). Then, if \( 1/2m\), for any \(T\), we have_

\[|(,P_{W_{T}|S};F)|<C_{1}( T+1)}{n- k})(}+^{1/2}),\] (5)

_where \((x y)=\{x,y\}\), and \(C_{1}\) and \(C_{2}\) are the positive constant terms w.r.t. \(\{M,m,b,d,,\}\) and \(\{M,m,b,d,\}\), respectively._

Farghly and Rebeschini  utilized the Wasserstein stability on the basis of the contraction property of Langevin diffusion under reflection coupling. The important technique to derive the above bound is that we only focus on \(W_{T}\) differently from \(W^{(T)}\) of the information-theoretic approach when deriving the contraction property. In this way, the resulting bounds do not suffer from divergence as \(T\); however, it still has a problem. That is, Eq. (5) depends on the factor \(^{-1/2}\), which implies that it becomes vacuous or even diverges with decreasing \((=_{T})\) as \(T\).

In this paper, we propose new generalization bounds to address the drawbacks of the information-theoretic and stability-based approaches. Specifically, the proposed bounds are established on the basis of the two expected generalization errors outlined in Eqs. (1) and (4), which remain time-independent and do not diverge as the step size decreases.

## 3 Time-independent generalization error bound for SGLD

Here, we explain our time-independent bound of \((,P_{W|S};L)\) for SGLD. We first introduce the main result (Section 3.1) and then summarize its proof outline (Sections 3.2 and 3.3). Finally, in Section 3.4, we provide a detailed discussion on our bound with concrete examples.

### Main result

Our key idea is to derive the generalized error bound using the FP equation. To use the FP equation, we impose the following regularity condition for \(P_{W_{0}}\).

**Assumption 4** (Regularity of the initial distribution).: _The initial distribution of \(W_{0}\): \(P_{W_{0}}\) is a Gaussian distribution 2 with a finite variance \(s^{2}>0\), which is independent of \(\) and \(T\)._

Our analysis is also grounded in the time evolution of the FP equation using the logarithmic Sobolev inequality (LSI)  associated with \(\) described as follows. We state that \(\) satisfies the LSI with constant \(c_{}\), if for any \(\), the following relation holds:

\[(|) c_{}\|- \|^{2}.\]

Raginsky et al.  showed the existence of \(c_{}\) under Assumptions 2, 3, and \( 2/m\). Note that \(c_{}\) is expressed by the problem-dependent constant (see Appendix F.1 for details).

We now introduce our generalization error bound.

**Theorem 4**.: _Suppose that Assumptions 1, 2, 3, and 4 are satisfied. Then, for any \( 2/m\) and \((0,1} 4 c_{})\) and any \(T\), we have_

\[|(,P_{W_{T}|S};L)|_{g}^{2}}{n}( 1}})(V_{}+c_{2})},\] (6)

_where \(c_{1}\), \(c_{2}\), and \(V_{}\) are the positive constant terms w.r.t. \(\{M,m,b,d,,s^{2}\}\)._

The above theorem shows \(|(,P_{W_{T}|S};L)|=()\), which implies time independence since it does not diverge even if \(T\) and thus converges as \(n\).

In Eq. (6), the term \(V_{}\) corresponds to _stability_, which is expressed as the upper bound of the difference of the expected conditional gradients with respect to changes in training datasets at each iteration. This shows a certain similarity to existing information-theoretic generalization bounds, such as Theorem 2, expressed by the variance of gradients with respect to the training datasets. This similarity is discussed in detail in Section 3.4. Additionally, detailed information on the explicit expression of \(c_{1}\), \(c_{2}\), and \(V_{}\) can be found in Appendix F.

### Proof outline of Theorem 4

In this section, we present how to derive our bound in Theorem 4. Our aim here is to share the ideas behind our analysis and an outline of the proof, providing the detailed proof in Appendix F.

We adopt the information-theoretic approach and focus on the MI in Eq. (2). By using the Jensen inequality, we have the following upper bound of the MI:

\[I(W_{T};S)_{S,S^{}}(P_{W_{T}|S}|P_{W_{T}|S^{ }}),\] (7)

where \(S\) and \(S^{}\) are random variables drawn independently from \(^{n}\), and \((P_{W_{T}|S}|P_{W_{T}|S^{}})\) is the KL divergence from \(P_{W_{T}|S^{}}\) to \(P_{W_{T}|S}\). Note that this KL divergence indicates the stability of the learned parameter from two datasets, \(S\) and \(S^{}\). We also note that \(P_{W_{T}|S^{}}\) can be regarded as the data-dependent prior. Thus, this KL divergence is tighter than that of the data-independent prior, which is often used in the probably approximately correct (PAC)-Bayes bound 3.

The key idea is to analyze _the time evolution of the KL divergence_, which is summarized in the following lemma:

**Lemma 1**.: _Suppose that the same assumptions in Theorem 4 hold. Then, for any \(t\), we have_

\[(P_{W_{t}|S}|P_{W_{t}|S^{}}) e^{-}}}(P_{W_{t-1}|S}|P_{W_{t-1}|S^{}})+ V_{} +c_{3},\] (8)

_where \(V_{}\) and \(c_{3}\) is the constant term w.r.t. \(\{M,m,b,d,,s^{2}\}\)._We will discuss the details of Lemma 1 in Section 3.3. By recursively applying Eq. (8) from \(t=0\) to \(T\), we obtain

\[(P_{W_{T}|S}|P_{W_{T}|S^{}})}}}}{1-e^{-}}}} (V_{}+c_{3})}{}4 c_{ }(1}})}}}(V_{}+c_{3}),\]

which is based on the fact that \((P_{W_{0}|S}|P_{W_{0}|S^{}})=0\). Note that bound (i) can be obtained from \(e^{-}}}<1-}} +}{16^{2}c_{}^{2}}\) when \(}} 1\), and \(e^{-}}} 1-}}\).

### Proof outline of Lemma 1 under the continuous Langevin diffusion

Here, we organize our ideas for the proof of Lemma 1 that are important in the derivation of Theorem 4. For simplicity, we now provide an intuitive explanation and an outline of the proof under the continuous Langevin diffusion setting. Note that the results of Theorem 4 and Lemma 1 are based on the SGLD setting, and their proofs are shown in Appendix F.

The Langevin diffusion is defined as

\[W_{t}=- F(W_{t},S)t+} H_{t},\] (9)

where \(H_{t}\) is the standard Brownian motion in \(^{d}\). Note that, in this context, \(t\) expresses the continuous time and the _full-batch_ gradient \( F(W_{t},S)\) is used. The stationary distribution of Eq. (9) is given as the Gibbs distribution \((w)(- F(w,S))\).

With some abuse of notation, let us denote \(P_{W_{t}|S}\) as the conditional distribution obtained using Eq. (9) and express its density as \(_{t}\). Then, the FP equation  for Eq. (9) can be obtained as

\[(w,t)}{ t}=_{t}+_{t} F(w,S).\] (10)

Similarly, we can define the Langevin diffusion when we use dataset \(S^{}\) and the conditional distribution using that diffusion as \(P_{W_{t}|S^{}}\) with the density \(_{t}\), obtaining the FP equation in the form of \(_{t}\) replaced by \(_{t}\) in Eq. (10).

Now we analyze the time evolution of \((P_{W_{t}|S}|P_{W_{t}|S^{}})=(_{t}|_{t})\) at time \(t\), i.e., \((_{t}|_{t})/ t\). By utilizing the FP equations of \(_{t}\) and \(_{t}\) and the Cauchy-Schwartz inequality, we obtain the following upper bound:

\[(_{t}|_{t})}{ t} -\|_{t}-_{t}\|^{2}+ \| F(W_{t},S)- F(W_{t},S^{})\|^{2}.\] (11)

The second term on the right-hand side of Eq. (11) represents the stability of the gradient with respect to the randomness of the training dataset \(S,S^{}^{n}\), which leads to \(V_{}\) in Lemma 1 under the SGLD setting. Hereafter, we define \(\| F(W_{t},S)- F(W_{t},S^{})\|^{2}\) as \(_{_{t}}\).

By introducing \((w)\) into \(\|_{t}-_{t}\|^{2}\) in Eq. (11), we obtain

\[(_{t}|_{t})}{ t} -\|_{t}- \|^{2}+\|\|^{2}+ _{t}_{t}+ _{_{t}}\] \[-}}(_{t}|)+ (_{t},_{t},)+_ {_{t}}\] \[-}}((_{t}| _{t})+}{})+( _{t},_{t},)+_{_{t}},\] (12)

where the first inequality is from the fact that \(-x^{2}-\|x-y\|^{2}/2+y^{2}\) for \(x,y^{d}\) and the second one is from the LSI. We introduced \((_{t},_{t},)_{_{t}}\|\|^ {2}+2_{_{t}}_{t}_{t}\) to simplify the notation.

By integrating \(e^{}}}(_{t}|_{ t})}{ t}\) in Eq. (12) over \(t[0,]\) and rearranging it, we obtain

\[(_{}|_{})  e^{}}}(_{0}| _{0})\] \[+_{0}^{}e^{}}} (_{_{t}}-}} }{}+(_{t},_{t}, ))t.\] (13)In Appendix F, we show that the terms related to \(\) in Eq. (13) can be bounded by using the techniques of Raginsky et al.  and Vempala and Wibisono .

We next derive an upper bound for the following terms in Eq. (13): \([}{}]\) and \((_{t},_{t},)\) by using the _parametrix method_ for the FP equation , which allows us to expand the FP equation's solution via the heat kernel. On the basis of this expansion, we can upper bound Eq. (13) as

\[_{0}^{}e^{}}}(-}}}{}+( _{t},_{t},))t().\] (14)

By combining Eq. (14) with Eq. (13), we obtain the continuous version of Lemma 1.

The same procedure can be used for the SGLD setup. The difference from the continuous Langevin diffusion case is that the discretization errors and the effects of using a stochastic gradient are taken into account, resulting in the appearance of an additional constant 4 in the above bounds (see Appendix F for details).

### Additional discussion on our bound in terms of stability

We conclude this section by presenting further discussion on our bound in terms of stability with a concrete example.

As shown in Eq. (7), the information-theoretic generalization bound is closely related to the stability in KL divergence under the different training datasets. However, our bound in Theorem 4 incorporates the constant term \(c_{2}\), which is irrelevant to stability, alongside the stability term \(V_{}\). If we can avoid the occurrence of \(c_{2}\), the resulting upper bound of \((P_{W_{t}|S}|P_{W_{t}|S^{}})\) would be dominantly expressed by \(V_{}\), and as a result, we may obtain a bound where the relationship between generalization and stability is more directly represented.

The problematic constant term \(c_{2}\) arises from \(c_{3}\) in Lemma 1 analyzing the time evolution of stability in KL divergence. Specifically, the term \(c_{3}\) is the byproduct of treating the general dissipative function using LSI. Actually, it is possible to avoid the problematic constant term \(c_{3}\) and derive bounds that are evaluated solely on the basis of stability-related metrics in specific examples, such as strongly convex or bounded (non-convex) losses with \(l_{2}\)-regularization. For simplicity, we show this fact using the following theorem under the Langevin diffusion (LD) setting, where the probability induced by Eq. (9) is expressed as \(P_{W_{T}|S}\).

**Theorem 5**.: _Suppose that Assumptions 1 and 2 are satisfied and that \(F(w,z)\) is \(R\)-strongly convex (\(0<R<\)). Then, for any \(T_{+}\), we have_

\[(_{t}|_{t})}{ t}- \;(_{t}|_{t})+\| F(W_{t},S )- F(W_{t},S^{})\|^{2},\] (15)

_and_

\[|(,P_{W_{T}|S};L)|^{2}}{n} _{0}^{T}e^{-}\| F(W_{t},S)- F(W_{t},S^{})\|^{2}t}.\] (16)

A similar bound in Eq. (16) (with \(R\) replaced by \(/e^{8 C}\)) can be obtained for bounded non-convex losses with \(l_{2}\)-regularization, where \(F(w,z)=F_{0}(w,z)+\|w\|^{2}\) (\(0<<\)) and \(F_{0}(w,z)\) is \(C\)-bounded (\(0 C<\)). The full proof is summarized in Appendix F.4.

When comparing with Lemma 1, we can see that, in Eq. (15), stability-unrelated constants do not appear in the time evolution of KL divergence at each time step. Therefore, the resulting generalization bound is also independent of such constants. Furthermore, when compared with Theorem 2, which adds up the stability terms at all time steps, our bound is dominated by the stability terms near the final time step, as those at earlier time steps decrease geometrically by \(e^{-}\). This indicates that the stability around the initial time steps is of lesser importance in evaluating the final generalization performance.

Note that our bounds are closely related to the bound indicated in Proposition 9 of Mou et al. , which was also derived by focusing on stability. The bound of Mou et al.  primarily assessesgeneralization errors focusing on the _gradient norm_ near the conclusion of training. In contrast, our bounds evaluate it through the norm of _differences in gradients_, emphasizing the state in the proximity of training completion. In other words, our bound allows for the evaluation of generalization errors using a stability measure that is more closely related to generalization performance than the gradient norm. This benefit originates from our approach, which tracks the time evolution of MI-related stability in Eq. (15) on the basis of information-theoretic generalization bounds, in contrast to the PAC-Bayes bounds derived from the direct analysis of stability measures as in Mou et al. .

## 4 Generalization analysis for SGLD directly using a training loss

In this section, we consider the setting that the generalization performance is measured by a training loss \(f\) directly as in Eq. (4). We show that this is possible by demonstrating that loss functions of SGLD are sub-exponential under smooth and dissipative assumptions (Section 4.1). On the basis of this fact, we obtain for the first time an information-theoretic generalization bound of SGLD that is similar to Theorem 4. Finally, combining these results with existing optimization error bounds provides an excess risk bound with improved convergence (Section 4.2).

### Smooth and dissipative loss function of SGLD is sub-exponential

To perform an information-theoretic analysis for SGLD, it is necessary to know the tail behavior of \(f(W,Z)\). Our contribution here is showing that a loss function of SGLD under smooth and dissipative assumptions is sub-exponential.

**Theorem 6**.: _Suppose that Assumptions 2, 3 and 4 are satisfied. Let \(P_{W_{T}}=_{S}[P_{W_{T}|S}]\) be the marginal distribution of the output obtained using the SGLD algorithm at the \(T\)-th iteration. Then, for any \((0,1})\) and \(T\), \(f(W_{T},Z)\) is sub-exponential under the distribution \(P_{W_{T}}\). That is, there exist positive constants \(_{e}^{2}\) and \(\) w.r.t. \(\{m,,M,b,d,s^{2}\}\)5 such that_

\[_{W_{T} Z}[e^{(f(W_{T},Z)-_{W_{T}  Z}[f(W_{T},Z)])}]^{2}^{2}}{2} for \ all\ ||<.\]

Proof sketch.: First, note that under Assumptions 2 and 3, for any \(z\), we obtain

\[\|w\|^{2}- 3 f(w,z)\|w\|^{2}+M }\|w\|+A,\] (17)

where \(A\) is a positive constant (see Lemma 8 in Appendix G.1 for its explicit form). By employing Lemma B.2 from Farghly and Rebeschini , we can show the following fact: for any \(p\),

\[\|W_{T}\|_{2}^{2p}\|W_{0}\|_{2}^{2p}+c(p),\] (18)

where

\[c(p):=()^{p-1}(1+p(2p-1)d}{ m})[(2b+8}{m^{2}}b)^{p}+1+2()^{p-1}(2p-1)^{p}].\]

This implies that \(W_{T}\) is a sub-Gausssian random variable according to Proposition 2.5.2 in Vershynin . To show the sub-exponential property, we directly upper-bound \(_{W_{T} Z}[e^{(f(W_{T},Z)-_{W_{T} Z }[f(W_{T},Z)])}]\) by considering the Taylor expansion of the exponential moment and using Eqs. (17) and (18) (see Appendix G.2 for the complete proof). 

**Remark 1**.: _In previous information-theoretic analysis studies [28; 25; 35], it is often assumed that a loss function \(l(w,Z)\) is sub-Gaussian under the distribution \(\) for all \(w\). In contrast, Theorem 6 holds under the distribution \(P_{W_{T}}\), not conditioned on \(w\)._

We can interpret the sub-exponential property of SGLD intuitively as follows. Under Assumptions 2 and 3, the loss function grows at most as a quadratic function shown in Eq. (17). The conditional distribution of the parameters follows the Gaussian distribution, and the square of the Gaussian random variable is known as the chi-square (\(^{2}\)) random variable . According to these facts, we expect that the behavior of the loss function resembles that of the \(^{2}\)-random variable; therefore, it is sub-exponential since the \(^{2}\)-distribution is also sub-exponential . Theorem 6 validates this intuition.

### Generalization bounds for SGLD using the same loss for training and evaluation

On the basis of Theorem 6, we can derive the following information-theoretic generalization bound for SGLD even if a surrogate loss is not used. In contrast to Theorem 4, an assumption regarding the tail behavior of a loss function such as Assumption 1 is not necessary.

**Corollary 1**.: _Suppose that Assumptions 2, 3, and 4 are satisfied. Then, for any \( 2/m\), \((0,1} 4 c_{})\), and \(T\), we obtain_

\[|(,P_{W_{T}|S};F)|^{*-1}(}{n}(1 }})(V_{}+c_{2})),\]

_where_

\[^{*-1}(y)=^{2}y}&\ y ^{2}}{2}\\  y+^{2}}{2}&,\]

\(c_{1}\) _and \(c_{2}\) are the same as in Theorem 4, and \(_{e}^{2}\) and \(\) are the same as in Theorem 6._

Proof sketch.: This is the direct consequence of the sub-exponential property from Theorem 6 and the upper bound of MI in Eq. (7) (see Appendix G.3 for the complete proof). 

**Remark 2**.: _Despite the assumptions of Corollary 1 being the same as those made by Farghly and Rebeschini  except for the initial distribution and step size, the resulting bound becomes \(0\) as \(n\) without being dependent on inverse stepsize._

We conclude this section by introducing our excess risk bound. Let us define the excess risk as follows: \((,P_{W|S})_{W,S}[F_{}(W)-F_{}(w^{*})]\), where \(w^{*}=*{argmin}_{w}F_{}(w)\). Under this definition, we derive the following upper bound for the excess risk by utilizing Corollary 1.

**Corollary 2**.: _Suppose that Assumptions 2, 3, and 4 are satisfied. Then, for any \( 2/m\), \((0,1} 4 c_{})\), and \(T\), we obtain_

\[(,P_{W_{T}|S})=}+e^{-  T/c_{LS}}++c_{},\]

_where \(c_{}\) is the positive constant w.r.t. \(\{M,m,b,d,\}\) corresponding to the optimization error._

We show the complete proof in Appendix G.4. In contrast with the existing excess risk studies, our bound does not diverge with increasing \(t\) owing to the time-independent generalization bound in Corollary 1.

## 5 Related studies and discussion

In this section, we compare our generalization bounds with those in related studies. Table 1 shows the order of each bound value along with its assumptions for a loss function.

SGLD analysis with/without changing losses.The existing generalization error bounds in Table 1 are time-dependent; namely, we need to impose restrictive conditions for the step size \(\) in terms of \(t\) to achieve a generalization bound that decays to zero with increasing sample size  (see the right column in Table 1). Some important applications of SGLD do not satisfy these conditions. For instance, the short-run Markov chain Monte Carlo  method used in energy-based models  adopts SGLD with a _fixed_ step size. Another example is the cyclic SGLD  used in deep learning, where the step size is _periodically increased or decreased_ to facilitate escape from local optima.

Farghly and Rebeschini  first analyzed the generalization error of SGLD by using smoothness and dissipative assumptions, which are broadly used in sampling and non-convex optimization studies . Their bound is time-independent; the bound does not diverge with time and achieves the order \((n^{-1/2})\). However, the bound depends on the inverse of step size \(^{-1/2}\) owing to the reflection coupling , which results in the unnatural behavior of decreasing \(\) with increasing \(t\). Farghly and Rebeschini  also derived a bound that does not suffer from this problem by assuming the Lipschitz loss function with weight decay; however, these assumptions excessively restrict theclass of loss functions and algorithms. In contrast to these bounds, our bound is time-independent and does not require scaling \(\), \(t\), and \(n\) to achieve \((n^{-1/2})\).

Time evolution analysis of MI via FP equation.The analysis of SGLD using the FP equation has been successfully used in the convergence analysis of SGLD [32; 19]. These studies present analyses of the discretization errors and convergence properties of the unadjusted Langevin algorithm, SGLD, and variance-reduction SGLD (SVRG-LD) , comparing them with the continuous Langevin dynamics through the FP equation.

In generalization error analysis, the FP equation is mainly used to analyze the time evolution of KL divergence appearing in a generalization bound on the basis of the stability approach. Li et al.  analyzed the time evolution of the KL divergence between the probability densities of the parameters obtained from two training datasets that differ by only one data point under the bounded loss assumption. Mou et al.  also studied the KL divergence and Hellinger divergence, and they derived a generalization error bound on the basis of the PAC-Bayes notion . Our idea is similar to these: we analyze the time evolution of the KL divergence between the probability densities of the parameters obtained from two training datasets. The differences between our approach and other approaches are twofold. First, we do not assume weight decay or Lipschitz continuity but instead derive our analysis assuming smoothness and dissipativity. Second, the KL divergence we analyzed is tighter than that of the PAC-Bayes bound with data-independent prior dealt by Mou et al. .

## 6 Limitations and future work

In this paper, we provide a generalization analysis of SGLD, where Gaussian noise is a fundamental assumption for our theoretical results. Thus, it is difficult to extend our analysis to other noisy iterative algorithm variants with a different noise, such as differentially private SGD with Laplace or uniform noise . Another limitation of this study is that we have estimated the sub-exponential parameter roughly with respect to the dimensions of the model parameters. Further investigation of the sub-exponentiality of smooth and dissipative losses, and improvement of the dependence on dimensionality, are crucial for enhancing the practicality of our generalization bounds. The sub-exponential property of a loss function is expected to be helpful in fields other than generalized error analysis. For example, this property opens up room for new theoretical analysis policies that employ useful concentration and transport inequalities  in the sampling and optimization context. We hope that the analysis presented in this paper goes beyond generalization analysis and provides valuable insights into understanding the characteristics of machine learning.

   &  &  \\   (S) Raginsky et al.  (Thm. 2.1.) & Dissipative, Smoothness & \(( t+e^{- t/c}+1/n)\) \\ (**S) Mou et al.  (Thm. 1.) & Bounded, Lipschitz & \(()\) \\ (**S) Mou et al.  (Thm. 2.) & Lipschitz, Sub-Gaussian, (Weight decay) 6 [\((t+1)/n\)) \\ (**I)** Penisa et al.  (Cor. 1.) & Lipschitz, Sub-Gaussian & \(()\) \\ (**I)** Neyega et al.  (Thm. 3.1.) & Sub-Gaussian & \(()\) \\ (**S)** Fardhy and Rebeschini  (Thm. 3.1.) & Lipschitz, Smoothness, Weight decay & \((( t+1)(1/n+))\) \\ (**S)** Fardhy and Rebeschini  (Thm. 4.1.) & Dissipative, Smoothness & \((( t 1)(/n}+))\) \\ (**I)** Wang et al.  (Thm. 1.) & Sub-Gaussian & \(()\) \\ (**I)** Ours (Thm. 4 and Cor. 1) & Dissipative, Smoothness, Sub-Gaussian* & \(()\) \\  

Table 1: Comparison of our bounds with those in existing studies. Our bounds are time-independent and bounded even if \( 0\). (**I**) denotes the information-theoretic approach and (**S**) denotes the stability analysis approach. The symbol * means that the sub-Gaussian assumption is unnecessary for our bounds when using the same loss for training and generalization performance evaluation. Namely, our bounds can be derived under more relaxed assumptions for a loss function in this case.