# Complete Graphical Criterion for Sequential Covariate Adjustment in Causal Inference

Yonghan Jung\({}^{1}\)1  Min Woo Park\({}^{2}\)  Sanghack Lee\({}^{2*}\)

\({}^{1}\)Purdue University \({}^{2}\)Seoul National University

jung222@purdue.edu {alsdn0110,sanghack}@snu.ac.kr

###### Abstract

Covariate adjustment, also known as back-door adjustment, is a fundamental tool in causal inference. Although a sound and complete graphical identification criterion, known as adjustment criterion (Shpitser et al., 2010), exists for static contexts, sequential contexts present challenges. Current practices, such as the sequential back-door adjustment (Pearl and Robins, 1995) or multi-outcome sequential back-door adjustment (Jung et al., 2020), are sound but incomplete; i.e., there are graphical scenarios where the causal effect is expressible via covariate adjustment, yet these criteria do not cover. In this paper, we exemplify this incompleteness and then present the _sequential adjustment criterion_, a sound and complete criterion for sequential covariate adjustment. We provide a constructive sequential adjustment criterion that identifies a set that satisfies the sequential adjustment criterion if and only if the causal effect can be expressed as a sequential covariate adjustment. Finally, we present an algorithm for identifying a _minimal_ sequential covariate adjustment set, which optimizes efficiency by ensuring that no unnecessary vertices are included.

## 1 Introduction

Covariate adjustment (also known as the back-door adjustment (Pearl, 1995)) --\(_{}P(y x,)P()\) where \(\) is a set of covariates, \(X\) is a treatment, and \(Y\) is an outcome--is one of the most prevalent method for estimating causal effects from observational data. Sufficient conditions have been established to determine whether causal effects can be expressed through covariate adjustment. For example, back-door criterion (BD) (Pearl, 1995) is a sound graphical condition to determine if the causal effect is expressible as a covariate adjustment. Shpitser et al. (2010) extended the BD and developed a sound and complete graphical criterion, called adjustment criterion (AC). van der Zander et al. (2014) and Maathuis and Colombo (2015) extended the adjustment criterion to general graph classes including directed acyclic graphs, maximal ancestral graphs, or partial ancestral graphs. The criterion from Maathuis and Colombo (2015) is sound but incomplete, which Perkovic et al. (2018) addressed by developing a sound and complete adjustment criterion.

Beyond such static adjustment criterion, _sequential_ covariate adjustment (also known as the _g-formula_(Robins, 1986)) has been studied. For example, _sequential back-door (SBD) criterion_(Pearl and Robins, 1995) extended the back-door criterion to the sequential setting. Since the SBD criterion only considered a single outcome, Jung et al. (2020) extended it to accommodate multiple outcome variables called _multi-outcome sequential back-door (mSBD)_ criterion. However, as detailed in Sec. 3, this criterion is not complete; i.e., there exists an example where the mSBD criterion is not satisfied, but the causal effect is identified as a sequential covariate adjustment. While it is known that the _sequential ignorability condition_(Richardson and Robins, 2013) is sound and complete forthe g-formula estimand, it does not provide a graphical criterion that can be tested based on a graph compatible with the distribution.

To address this challenge, we devise a sound and complete graphical criterion for the sequential covariate adjustment. Table 1 visualizes our contribution against previous graphical criteria for covariate adjustments.2 Specifically, our contributions are as follows:

1. We demonstrate the incompleteness of mSBD criterion by exemplifying a graph such that the causal effect is given as sequential covariate adjustment where the mSBD criterion is not satisfied. Moreover, we discuss the impracticality of other existing criteria.
2. We devise sequential adjustment criterion (SAC), a sound and complete graphical criterion for sequential covariate adjustment.
3. We develop a constructive sequential adjustment criterion that yields a set that satisfies the SAC if and only if the causal effect can be expressed as a sequential covariate adjustment. Furthermore, we present an algorithm to identify a minimal sequential covariate adjustment set.

The proofs for all results are provided in Sec. A in the supplementary document.

## 2 Preliminaries

We introduce the necessary notation and background. Key notations are summarized in Table 2.

Structural Causal Models.We use Structural Causal Models (SCMs) (Pearl, 2000). An SCM \(\) is a quadruple \(,,P(),F\). \(\) is a set of exogenous (latent) variables following a joint distribution \(P()\). \(\) is a set of endogenous (observable) variables whose values are determined by functions \(F=\{f_{V_{i}}\}_{V_{i}}\) such that \(V_{i} f_{V_{i}}(_{i},_{i})\) where \(_{i}\{V_{i}\}\) and \(_{i}\). Each SCM \(\) induces a distribution \(P()\) and a causal graph \(=()\) over \(\) in which there exists a directed edge from every variable in \(_{i}\) to \(V_{i}\) and dashed-bidirected arrows encode correlated latent variables. Performing an intervention fixing \(=\) is represented through the do-operator, \((=)\), which encodes the operation of replacing the original equations of \(X\) (i.e., \(f_{X}(_{x},_{x})\)) by the constant \(x\) for all \(X\) and induces an interventional distribution \(P(())\).

Graphs.We consider a graph \(\) having vertices \(\) and edges \(\) composed of directed (\(V_{i} V_{j}\)) and bidirected edges (\(V_{i} V_{j}\)). An ordered sequence of distinct nodes in \(\) is called a _path_ between \(V_{i}\) and \(V_{j}\) in \(\) if (1) the start node is \(V_{i}\) and the end node is \(V_{j}\), and (2) there is an edge (directed or bidirected) between any two subsequent variables in the sequence. A variable \(V_{i}\) is called a _collider_ on the path if the path contains two edges having arrow heads toward \(V_{i}\); i.e., \(* V_{i}*\) where \(*\{,\}\). A path is _directed_ (or causal), if it contains only directed edges, all pointing in the same direction. We say that two sets of vertices \(,\) are _d-connected_ w.r.t. \(()\) in \(\) if there exists a path between \(V_{i}\) and \(V_{j}\) where every non-colliders on the path is not contained in \(\) and all colliders are in \(_{}()\). We say that \(\)_d-separates_\((,)\) in \(\) if they are not d-connected w.r.t. \(\) in \(\). We denote \(_{}\) by \(\) with removing those edges toward \(\) and from \(\). For disjoint sets of vertices \(_{1},,_{m}\), we use \((_{1},,_{m})\) to represent an ordered set, where the order needs to be highlighted. For the unordered set, we use braces as \(\{A_{1},,A_{m}\}\).

   Criterion & Static & Sequential & Multi-outcome & Completeness \\  BD (Pearl, 1995, 2000) & ✓ & ✗ & N/A & ✗ \\ AC (Shpitser et al., 2010) & ✓ & ✗ & N/A & ✓ \\ SBD (Pearl and Robins, 1995) & ✓ & ✓ & ✗ & ✗ \\ mSBD (Jung et al., 2020) & ✓ & ✓ & ✓ & ✗ \\  SAC (Ours) & ✓ & ✓ & ✓ & ✓ \\   

Table 1: Comparison of graphical criteria for (sequential) covariate adjustmentsAdjustment Criterion.We revisit the problem of characterizing a criterion such that the causal effect is given as an adjustment. Formally, the _adjustment set_ relative to \((,)\) in \(\) is defined as a set \(\) such that, for any \(P\) compatible with \(\), the following is satisfied (Shpitser et al., 2010):

\[P(())=_{}P( ,)P().\] (1)

The _adjustment criterion_(Shpitser et al., 2010) provides a sound and complete criterion for the causal effect \(P(())\) to be expressed as a covariate adjustment in Eq. (1). To present the adjustment criterion, we define a _proper causal path_ between \(\) and \(\) as a directed path from any of \(X\) to any of \(Y\) on which the path does not contain a node in \(\{X\}\). A proper causal path set \(_{}(,)\) is a collection of nodes excluding \(\) on all proper causal paths from \(X\) to \(Y\), defined in Table 2. \(_{}(,)\) is a descendant of the proper causal path set defined in Table 2. The adjustment criterion utilizes this subgraph called the _proper back-door graph_:

**Definition 1** (Proper Back-Door Graph (van der Zander et al., 2014)).: _Let \((,)\) denote a disjoint pair in \(\). The proper back-door graph \(_{}^{,}\) is a graph obtained from \(\) by removing an edge \(X D\) for each \(X\) and \(D_{}(,)\)._

Then, the adjustment criterion and its characterization are given as follows.

**Definition 2** (Adjustment Criterion (Shpitser et al., 2010; van der Zander et al., 2014)).: _Let \((,)\) denote a disjoint pair in \(\). A set of variables \(()\) is said to satisfy the adjustment criterion relative to \((,)\) in \(\) if (1) \(()_{_{}^{ ,}}\) and (2) \(_{}(,)=\)._

**Proposition 1** (Shpitser et al. (2010); van der Zander et al. (2014)).: \(\) _satisfies the adjustment criterion relative to \((,)\) in \(\) if and only if \(\) is an adjustment set relative to \((,)\) in \(\)._

For concreteness, in Fig. 3, \(\{Z_{a},Z_{b}\}\) satisfies the adjustment criterion relative to \(\{X_{1},X_{2}\}\) and \(\{Y_{1},Y_{2}\}\). See (van der Zander et al., 2014, Sec. 4.2) for details. In the later sections, we will extend this result to the sequential context.

## 3 Limitations of Existing Criterion for Sequential Covariate Adjustment

In this section, we demonstrate the limitations of existing criteria for sequential covariate adjustment, which is defined as follows:

**Definition 3** (Sequential Covariate Adjustment).: _Let \((,)\) denote a pair of ordered sets such that \(=(_{1},,_{m})\) and \(=(_{0},,_{m})\). Let \(()\) denote vertices ordered as \(=(_{1},,_{m})\). Define \(_{i}^{(i)}^{(i)}^{(i)}\). The set \(\) is said to be a sequential adjustment set relative to \((,)\) in \(\) if for any \(P\) compatible with \(\), the following is satisfied3:_

\[P(())=_{}_{j=0}^{m}P( _{j+1},_{j}_{j-1},_{j},_{j}).\] (2)

_The right-hand side of Eq. (2) is called the sequential covariate adjustment of \(\) w.r.t. \((,)\) in \(\)._

  
**Notation** & **Definition** \\  \(,X,,x\) & A random vector, variable, and their realized values. \\ \(_{}f()\) & A marginalization of \(f()\) over values in the domain of \(\). \\ \(^{(i)}\) & \((_{0},,_{i})\) for the ordered set \(=(_{0},,_{n})\). \\ \(^{ i}\) & \((_{i},,_{n})\) for the ordered set \(\). \\ \(_{}(),_{}()\) & Descendants and ancestors of \(\) in \(\). \\ \(_{}(,)\) & Proper causal path set; i.e., \((_{_{}}()) _{_{}}()\). \\ \(_{}(,)\) & \(_{}(_{}(,))\). \\   

Table 2: Key notationsIn this definition, sequential covariate adjustment relies on specific partitions \(=(_{1},,_{m})\) and \(=(_{0},,_{m})\). To standardize these partitions, we employ a fixed structure based on a topological order of \((,)\) in \(\) so as to ensure that the partition aligns with the causal structure.

**Definition 4** (Partitioning Operator).: _Let \(\) and \(\) denote disjoint vertices where \(=(X_{1},,X_{m})\) is topologically ordered along with \(\). Then, the operator \(^{}_{}\) partitions \(\) relative to \(\) and \(\); i.e., \(^{}_{}()=(_{0},, _{m})\), where_

\[_{i}_{}()&i=0,\\ ((^{(i-1)})_{}(X_{i }))_{}(^{ i+1})&i=1,,m.\] (3)

Hereafter, we will denote \((,)\) as a pair of vertices where \(=(X_{1},,X_{m})\) is topologically ordered with respect to \(\) and \(\) as the ordered set \(^{}_{}()\).

### Limitation of mSBD Criterion

The multi-outcome sequential back-door (mSBD) criterion (Jung et al., 2020) has been developed to determine whether an ordered set \(=(_{1},,_{m})\) constitutes a sequential adjustment set:

**Definition 5** (Multi-outcome Sequential Back-Door Criterion (Jung et al., 2020)).: _Let \((,)\) denote a pair of ordered sets in \(\). Let \(()\) be ordered as \(=(_{1},,_{m})\), and let \(_{i}^{(i)}^{(i)}^{(i)}\). Then, \(\) is said to satisfy the multi-outcome sequential back-door (mSBD) criterion w.r.t. \((,)\) in \(\) if, for \(i=1,,m\),_

\[_{i}^{ i} ;\] (4) \[(^{ i}\!\!\! X_{i}_{i -1},_{i})_{_{}{^{ i+1}}}}.\] (5)

**Proposition 2** (mSBD adjustment (Jung et al., 2020)).: _If \(=(_{1},,_{m})\) satisfies the mSBD criterion w.r.t. \((,)\) in \(\), the causal effect \(P(())\) is identifiable and expressible as sequential covariate adjustment of \(\) w.r.t. \((,)\) in \(\):_

\[P(())=_{}_{j=0}^{m}P( _{j+1},_{j}_{j-1},x_{j},_{j}).\] (6)

For concreteness, consider the causal diagram \(\) in Fig. 1 with \(=(X_{1},X_{2})\) and \(=(_{1},_{2})\). Applying the partitioning operator \(^{}_{}\), we divide \(\) into two subsets: \(_{1}=\{Y_{1}\}\) and \(_{2}=\{Y_{2}\}\). Next, we define \((_{1},_{2})\), where \(_{1}\{Z_{a},Z_{b}\}\) and \(_{2}\{Z_{c},Z_{d}\}\). This ordered set \(\) satisfies the mSBD criterion relative to \((,)\) in \(\). The first condition of the mSBD criterion holds since \(_{1}\) does not include any descendants of \(X_{1}\) in \(\), and similarly, \(_{2}\) excludes any descendants of \(X_{2}\). To check the second condition of the mSBD criterion, consider the graph \(_{}{X_{2}}X_{2}}\) derived from \(\) by removing the edges \(X_{1} Y_{1}\) and \(\{Z_{b} X_{2},Z_{c} X_{2},Y_{1} X_{2}\}\). In this graph, \((_{1},_{2})\) are conditionally independent of \(X_{1}\) given \(_{1}\) and \(X_{2}\), because any path from \(X_{1}\) to \(\{Y_{1},Y_{2}\}\) is blocked (\(d\)-separated) by \(_{1}\). Finally, in the graph \(_{}{X_{2}}}\), where the edge \(X_{2} Y_{2}\) is removed, any paths between \(X_{2}\) and \(Y_{2}\) are d-separated when conditioned on \(_{1}_{2}\). This analysis confirms that \(\) satisfies the mSBD criterion, and therefore, the causal effect is given as follows:

\[P(()) =_{_{1},_{2}}P(_{2}_{1},_{2},_{1},_{1},_{2})P(_{2}, _{1}_{1},_{1})P(_{1})\] \[=_{z_{a},z_{b},z_{c},z_{d}}P(y_{2} x_{1},x_{2},y_{1},z_{a},z_{b},z_{c},z_{d})P(z_{c},z_{d},y_{1} x_{1},z_{a},z_{b})P(z_{a},z_{b}).\] (7)

Despite its soundness (Prop. 2), the mSBD criterion is not complete. In other words, there are causal graphs such that \(P(())\) is expressible through sequential covariate adjustment, even though \((_{1},,_{m})\) does not satisfy the mSBD criterion relative to \((,)\) in \(\).

Figure 1: Graph exemplifying mSBD in Def. 5

**Proposition 3** (Incompleteness of mSBD criterion).: _There exists a causal graph \(\) where the causal effect \(P(())\) can be represented as a sequential covariate adjustment with \(\) such that \(\) does not satisfy the mSBD criterion relative to \((,)\) in \(\)._

To illustrate the incompleteness of the mSBD criterion, consider the graph \(\) in Fig. 2a with \(=(X_{1},X_{2})\) and \(=(_{1},_{2})\) (i.e., \(_{0}\)) with \(_{1}=\{Y_{1}\}\) and \(_{2}=\{Y_{2}\}\). Set \(:=(_{1},_{2})\), where \(_{1}\{Z_{a},Z_{b}\}\) and \(_{2}:=\{Z_{c},Z_{d}\}\). Then, while \(_{1}\) satisfies both Eqs. (4, 5) of the mSBD criterion, \(_{2}\) does not satisfy the mSBD condition in Eq. (4) since \(_{2}\) includes the descendant of \(X_{2}\). Nevertheless, the causal effect \(P(())\) is still expressible through sequential covariate adjustment as in Eq. (7). To demonstrate, we begin with the observation that \(_{1}\) satisfies the mSBD criterion in Eqs. (4, 5), leading to \(P(y_{1},y_{2}(x_{1},x_{2}))=_{z_{a},z_{b}}P(y_{2} (x_{2}),_{1})P(y_{1} x_{1},z_{a},z_{b})P(z_{a},z_{b})\), with \(_{1}_{1}_{1}_{1}=\{ X_{1},Y_{1},Z_{a},Z_{b}\}\). Next,

\[P(y_{2}(x_{2}),_{1}) =_{z_{c}}P(y_{2}(x_{2}),_{1})P(z_{c} _{1})\] \[=_{z_{c}}P(y_{2}(x_{2}),_{1},z_{c})P (z_{c}_{1}),\]

where the last equality holds by Rule 1 of do-calculus (Pearl, 1995): \((Y_{2}\!\!\! Z_{c} X_{2},_{1})_{_{}}}\). Further,

\[P(y_{2}(x_{2}),_{1},z_{c}) =_{z_{d}}P(y_{2}(x_{2}),_{1},z_{c},z_ {d})P(z_{d}(x_{2}),_{1},z_{c})\] \[=_{z_{d}}P(y_{2} x_{2},_{1},z_{c},z_{d})P(z_{d} _{1},z_{c}),\]

where the last equality holds by Rule 2 and 3 of do-calculus, i.e., \((Y_{2}\!\!\! X_{2}_{1},Z_{c},Z_{d})_{_{ }}}\) and \((Z_{d}\!\!\! X_{2}_{1},Z_{c})_{_{ {X_{2}}}}\), respectively. Combining these derivations, \(P(y_{1},y_{2}(x_{1},x_{2}))\) is expressible as the same as in Eq. (7). This exemplifies the incompleteness of mSBD criterion.

### Limitation of Other Existing Criteria

Besides mSBD, there are other methods attempting to establish conditions for determining if the causal effect can be represented as sequential covariate adjustment. For instance, the _no-unmeasured-confounding assumption_(Rosenbaum and Rubin, 1983) is a sufficient verification tool. However, as illustrated in Fig. 2a, the causal effect is expressible through sequential covariate adjustment even though an unmeasured confounder between the treatment \(X_{2}\) and the outcome \(Y_{1}\) presents.

On the other hand, the _sequential ignorability_ criterion (Robins, 1986, 2000) provides a condition for \(\) to be a sequential adjustment set:

\[^{ i}()\!\!\! X_{i}_{i}, _{i-1},\] (8)

where \(^{ i}()\) is a counterfactual variable induced from \(^{ i}\) by fixing \(=\) in the SCM. Graphical methods such as _single world intervention graphs_ (SWIGs) (Richardson and Robins, 2013) and _twin-networks_(Pearl, 2000; Shpister and Pearl, 2008) help in analyzing such counterfactual variables. However, each has its limitations in efficiently verifying sequential adjustment sets. SWIGs, for example, face challenges in capturing \(_{1},_{2}\) as a sequential adjustment set in Fig 2a, because they fail to accommodate both \(Y_{2}(x_{2})\) and \(_{2}\) in a SWIG. This limitation arises since the counterfactual variable \(_{2}(x_{2})\), instead of the observable \(_{2}\), will appear on the SWIG. In contrast, twin-networks are capable of exploring the relationship between \(Y_{2}(x_{2})\) and \(_{2}\). Yet, their practicality decreases with larger cardinality (\(m\)), as the size of twin-networks expands exponentially, leading to substantial computational demands. These observations motivate the necessity of computationally efficient and effective criterion to determine if a causal effect aligns with a sequential covariate adjustment.

## 4 Sequential Adjustment Criterion

In this section, we devise a _sequential adjustment criterion_ (SAC), which provides a sound and complete method for characterizing the causal effect \(P(())\) as a sequential covariate adjustment of \((_{1},,_{m})\) with respect to \((,)\). To begin with, we define a special subgraph called _proper sequential back-door graph_:

**Definition 6** (Proper Sequential Back-Door Graph).: _For a disjoint pair \((,)\) and the index \(i\), the proper sequential back-door graph \(_{,i}^{,}\) is a proper back-door graph induced from \(_{^{ i+1}}}\) relative to \((X_{i},^{ i})\); i.e.,_

\[_{,i}^{,}:=(_{ ^{ i+1}}})_{}^{X_{i},^{ i}}.\] (9)

As constructing the proper back-door graph from \(\) takes linear time \(O(||+||)\)(van der Zander et al., 2014), the sequential back-door graph can also be constructed in linear time \(O(||+||)\). Equipped with \(_{,i}^{,}\), the _sequential adjustment criterion_ is presented as follows:

**Definition 7** (Sequential Adjustment Criterion (SAC)).: _Let \((,)\) denote a disjoint pair. Let \((_{1},,_{m})\) denote a topologically ordered set of vertices disjoint to \((,)\) where each \(_{i}\) is non-descendant of \(^{ i+1}\). Then, \(\) is said to satisfy sequential adjustment criterion (SAC) w.r.t. \((,)\) in \(\) if the following conditions are satisfied for \(i=1,,m\):_

\[(^{ i}-7.0pt$}}X_{i}_{i},_{i-1})_{ _{,i}^{,}};\] (10) \[_{i}_{}(X_{i},^{  i})=.\] (11)

The sequential adjustment criterion characterizes the sequential covariate adjustment:

**Theorem 1** (Soundness and Completeness).: _Let \((,)\) denote a disjoint pair, and let \((_{1},,_{m})\) denote an ordered set of vertices disjoint to \((,)\). Then, the following are equivalent:_

1. \(\) _satisfies SAC relative to_ \((,)\) _in_ \(\)_._
2. \(\) _is a sequential adjustment set relative to_ \((,)\) _in_ \(\)_; i.e.,_ \[P(())=_{}_{j=0}^{m}P( _{j+1},_{j}_{j-1},x_{j},_{j}).\] (12)

For instance, consider Fig. 2a, where we witnessed that the causal effect \(P(y_{1},y_{2}(x_{1},x_{2}))\) is given as a sequential covariate adjustment of \(=(_{1}=\{Z_{a},Z_{b}\},_{2}=\{Z_{c},Z_{d}\})\). To confirm that this \(\) satisfies SAC relative to \((,)\) for \(=(X_{1},X_{2})\) and \(=(_{1},_{2})\) with \(_{1}=\{Y_{1}\}\) and \(_{2}=\{Y_{2}\}\), we examine \(_{,1}^{,}\) (Fig. 2b) and \(_{,2}^{,}\) (Fig. 2c). In \(_{,1}^{,}\), we observe that \(_{1}=\{Z_{a},Z_{b}\}\) d-separates \(X_{1}\) and \(\{Y_{1},Y_{2}\}\). Moreover, \(_{1}\) does not contain any descendant of proper causal paths from \(X_{1}\) to \(\{Y_{1},Y_{2}\}\) within this subgraph. Similarly, in \(_{,2}^{,}\), the path between \(X_{2}\) and \(Y_{2}\) is d-separated conditioned on \(_{2}=\{Z_{c},Z_{d}\}\) and \(_{1}=\{Z_{a},Z_{b},X_{1},Y_{1}\}\). Additionally, \(_{2}\) is not on any descendant of proper causal paths between \(X_{2}\) and \(Y_{2}\). Consequently, \(\) fulfills SAC relative to \((,)\) in the graph \(\).

The soundness and completeness of SAC provide extensive coverage, incorporating existing covariate adjustment criterion such as BD, AC, SBD, and mSBD in Table 1. Clearly, SAC covers the mSBD criterion due to its completeness. In other words, the mSBD criterion is sufficient for the sequential adjustment criterion.

**Corollary 1** (mSBD \(\) SAC).: _If \(\) satisfies the mSBD criterion relative to \((,)\) in \(\), then \(\) satisfies the SAC relative to \((,)\) in \(\)._

To demonstrate, consider \(\) in Fig. 1, where \((_{1},_{2})\) with \(_{1}\{Z_{a},Z_{b}\}\) and \(_{2}\{Z_{c},Z_{d}\}\). This \(\) satisfies the mSBD criterion relative to \((,)\) for \(=(X_{1},X_{2})\) and \(=(Y_{1},Y_{2})\). To

Figure 2: (a) Graph exemplifying SAC in Def. 7 and (b,c) its proper sequential back-door graphsensure that \(\) also satisfies the SAC relative to \((,)\) in \(\), we verify that \((_{1},_{2})\) meet the conditions in Eqs. (10, 11), respectively. Since \(_{1}\) and \(_{2}\) are both non-descendants of \(X_{1}\) and \(X_{2}\), respectively, we only need to verify that they meet the conditions of Eq. (11) for \((X_{1},(Y_{1},Y_{2}))\) and \((X_{2},Y_{2})\) respectively. First, consider \(_{,1}^{,}\), which removes edges \(\{X_{1} Y_{1},Z_{b} X_{2},Z_{c} X_{2}\}\) from \(\). In this graph, \(X_{1}\) is d-separated from \((Y_{1},Y_{2})\) given \(_{1}\). Next, consider \(_{,2}^{,}\), which removes the edge \(\{X_{2} Y_{2}\}\) from \(\). In this graph, \(X_{2}\) is d-separated from \(Y_{2}\) given \((_{1},X_{1},Y_{1})\) and \(_{2}\). Therefore, \(\) also satisfies the SAC relative to \((,)\) in \(\).

The broader coverage of SAC compared to the mSBD criterion is evident when compared to AC. First, the mSBD criterion is not extensive enough to cover the AC criterion. To witness, consider Fig. 3. Here, \(\{Z_{a},Z_{b}\}\) satisfies AC relative to \((,)\) for \(=(X,Y)\) and \(=(Y_{1},Y_{2})\). However, \(\) does not satisfy the mSBD criterion since it is a descendant set of \(_{1}\{X_{1}\}\). In contrast, AC is a sufficient criterion for SAC.

**Theorem 2** (Ac \(\) Sac).: _If \(\) satisfies the AC relative to \((,)\) in \(\), then there exists a partition of \(\) and a topological order of \(\) such that \(\) satisfies the SAC relative to \((,)\) in \(\)._

For concreteness, consider \(\) in Fig. 3(van der Zander et al., 2014). In \(\), \(\{Z_{a},Z_{b}\}\) satisfies the adjustment criterion relative to \((,)\) for \(=(X_{1},X_{2})\) and \(=(Y_{1},Y_{2})\) in \(\), and the causal effect is given as an adjustment as follows:

\[P(y_{1},y_{2}(x_{1},x_{2}))=_{}P( ,)P().\] (13)

Thm. 2 implies that \(\) meets the SAC relative to \((,)\) in graph \(\). To demonstrate this, for \(=(X_{1},X_{2})\), we apply the partitioning operator in Def. 4 and obtain \(_{0}=\{Y_{2}\}\), \(_{1}\{Y_{1}\}\), and \(_{2}=\). We set \(_{1}\{Z_{a},Z_{b}\}\). Since \(_{2}\) is empty, it is sufficient to demonstrate that \(_{1}\) meets the conditions of Eqs. (10) and (11). First, \(_{1}\) meets the condition of Eq. (11) as it contains no descendants on the causal paths from \(X_{1}\) to \(_{1}\). Consider the modified graph \(_{,1}^{,}\), obtained by removing the edges \(\{X_{1} Y_{1},Z_{b} X_{2}\}\). In this reduced graph, \(X_{1}\) and \(_{1}\) are d-separated given \(_{1}\) and \(_{0}\), confirming the conditions of SAC. Therefore, \((_{1},_{2})\) satisfies SAC relative to \((,)\) in \(\), and the causal effect is described as

\[P(y_{1},y_{2}(x_{1},x_{2}))=_{z_{a},z_{b}}P(y_{1} x_{1},z_{a},z_{b},y_{2})P(z_{a},z_{b} y_{2})P(y_{2}).\] (14)

Eqs. (13, 14) are equivalent since \(P(y_{1} x_{1},x_{2},z_{a},z_{b},y_{2})=P(y_{1} x_{1},z_{a},z_{b},y_{2})\) and \(P(y_{2} x_{1},x_{2},z_{a},z_{b})=P(y_{2} z_{a},z_{b})\) by the conditional independence implied by \(\).

### Constructive Sequential Adjustment Criterion

Sequential adjustment criterion in Def. 7 relies on a predefined partition \(=(_{1},,_{m})\). A natural question is how to construct such ordered partition of the covariates. We propose a method to construct a sequential adjustment set, which characterizes sequential covariate adjustment in that the ordered set meets the SAC if and only if the causal effect can be expressed through a sequential covariate adjustment.

**Theorem 3** (Construction of Sequential Adjustment Set).: _Let \((,)\) denote a disjoint pair in \(\). Define \(^{}(_{1}^{},,_{m}^{})\) and corresponding \((_{1}^{},,_{m}^{})\) and \((_{0}^{},,_{m-1}^{})\) alternatively as follows: For \(i=1,,m\),_

\[_{i-1}^{} ^{(i-1)}^{(i-1)}_{j=1}^ {i-1}_{j}^{},\] (15) \[_{i}^{} _{i-1}^{} _{}(X_{i},^{ i})_{ }(^{ i+1}),\] (16) \[_{i}^{} _{,i}(\{X_{i}\}^{  i}_{i-1}^{})_{i}^{}.\] (17)

_Then, the following statements are equivalent:_

1. _There exists an ordered set_ \((_{1},,_{m})\) _satisfying the sequential adjustment criterion w.r.t._ \((,)\) _in_ \(\)_._

Figure 3: (van der Zander et al., 2014, Fig. 2)

_2. The ordered set \(^{}\) satisfies SAC relative to \((,)\) in \(\)._

The set \(^{}\) can be constructed in \(O(m(||+||))\) since the procedures for constructing \(_{}(X_{i},^{ i})\) and \(_{,i}^{,}\) in Eq. (16), as well as finding ancestors and descendants in Eqs. (16, 17), each require \(O(||+||)\) and are repeated \(m\) times.

To concretely exemplify that the first statement implies the second one in Thm. 3, consider Fig. (a)a. Set \(_{0}\), \(_{1}\{Y_{1}\}\), and \(_{2}\{Y_{2}\}\) by the mechanism of the partitioning operator \(_{}^{,}\), \(_{,1}^{,}\) and \(_{,2}^{,}\) are depicted in Figs. (b)b, (c)c). Then, \(_{1}^{}\{Z_{a},Z_{b},Z_{c},Z_{d}\}\), since these are ancestors of \(\{X_{1},Y_{1},Y_{2}\}\) in \(_{,1}^{,}\). We can see that \(_{1}^{}\) satisfies Eqs. (10, 11) in the SAC because \(X_{1}\) and \(\{Y_{1},Y_{2}\}\) are d-separated in \(_{,1}^{,}\) given \(_{1}^{}\), and they are not on the descendant of proper causal paths between \(X_{1}\) and \(\{Y_{1},Y_{2}\}\). Next, \(_{2}^{}\). It satisfies Eqs. (10, 11) since \(X_{2}\) and \(Y_{2}\) are d-separated in \(_{,2}^{,}\) given \(\{X_{1},Y_{1}\}_{1}^{}_{2}^{}\). Combining with our previous observation that \(_{1}\{Z_{a},Z_{b}\}\) and \(_{2}\{Z_{c},Z_{d}\}\) satisfy Eqs. (10, 11), this example demonstrates that indeed \(^{}(_{1}^{},_{2} ^{})\) satisfies the SAC relative to \((,)\) in \(\).

As an example that the second statement implies the first one, consider Fig. (a)a, where \(_{0}\), \(_{1}\) and \(_{2}\{Y\}\) by the mechanism of the partitioning operator \(_{}^{}\). Next, \(_{,1}^{,}\) and \(_{,2}^{,}\) are depicted in Figs. (b)b, (c)c). Then, \(_{1}^{}\), since none of \(\{Z_{a},Z_{b},Z_{c}\}\) are the ancestors of \(\{X_{1},Y\}\). \(_{1}^{}\) satisfies Eqs. (10, 11) in the SAC, since the \(X_{1}\) and \(Y\) are d-separated in \(_{,1}^{,}\) given \(_{1}^{}\). Next, \(_{2}^{}\{Z_{a},Z_{b},Z_{c}\}\) since they are ancestors of \(X_{2}\) in \(_{,2}^{,}\). This \(_{2}^{}\) satisfies Eqs. (10, 11), since \(X_{2}\) and \(Y\) are d-separated in \(_{,2}^{,}\) given \(_{2}^{}\{X_{1}\}\). Therefore, \(^{}(_{1}^{},_{2} ^{})=(,\{Z_{a},Z_{b},Z_{c}\})\) satisfies SAC relative to \((,)\) in \(\).

### Minimal Sequential Adjustment Criterion

We have demonstrated the effectiveness of constructing sequential adjustment sets. However, when dealing with large graphs, \(^{}\) may include a large number of vertices, leading to high computational costs when evaluating sequential covariate adjustments. This situation highlights the need for a more parsimonious adjustment set. To address this, we introduce the _minimal_ sequential covariate adjustment set, which is the smallest subset of \(^{}\) without sacrificing the validity of the adjustment.

**Definition 8** (Minimal Sequential Covariate Adjustment Set).: _Let \((,)\) denote a disjoint pair in \(\). An ordered set of vertices \(^{}(_{1}^{},, _{m}^{})\) where each \(_{i}^{}\) are non-descendant of \(^{ i+1}\) is said to be a minimal sequential covariate adjustment set if, for each \(i=1,,m\),_

1. \(_{i}^{}\) _satisfies Eqs. (_10, 11_)._
2. _For any_ \(_{i}^{}_{i}^{}\)_,_ \(_{i}^{}\) _does not satisfy Eqs. (_10, 11_)._

To present the minimal sequential covariate adjustment set, we define a useful tool:

**Definition 9** (Closure (van der Zander and Liskiewicz, 2020)).: _For a disjoint vertices \(,,\) and \(\) in \(\), the closure of \(\) with respect to \(\) and \(\) in \(\), denoted as \(_{}(;,)\), is the union of \(\) and the collection of \(V_{}()\) that are connected to \(\) via a path satisfying the following:_

Figure 4: Example for minSCA and corresponding proper sequential back-door graphs

1. _The path only contains nodes in_ \(_{}()\)_; and_
2. _All non-collider vertices on the path are not in_ \(\)_; Equivalently, any vertex on the path that is in_ \(\) _is a collider on the path._

Verbally speaking, \(_{}(;,)\) is a set of vertices in \(_{}()\) that is d-connected to \(\) in \(\) conditioned on \(\), where the paths are through \(_{}()\). Finding the closure can be efficiently done in \(O(||+||)\) time (van der Zander and Liskiewicz, 2020), where \(||\) and \(||\) are the number of vertices and edges of the graph \(\). For example, consider \(_{_{,2}^{,}} (X_{2};Y,\{Z_{a},Z_{b},Z_{c},X_{1}\})\) with \(_{,2}^{,}\) in Fig. 4c. First, the ancestor of \(\{X_{2},Y\}\) are \(\{Z_{a},Z_{b},Z_{c},X_{1}\}\). Since \(Z_{a}\) and \(X_{1}\) are adjacent to \(X_{2}\), they are contained in the closure. However, \(\{Z_{b},Z_{c}\}\) are not in the closure, since all the non-collider vertices on the path between \(X_{2}\) and \(\{Z_{b},Z_{c}\}\) are contained in \(\{Z_{a},Z_{b},Z_{c},X_{1}\}\). Therefore, \(\{Z_{a},X_{1},X_{2}\}=_{_{,2}^{ ,}}(X_{2};Y,\{Z_{a},Z_{b},Z_{c},X_{1}\})\).

Equipped with the closure, we propose a procedure to construct the minimal sequential covariate adjustment in Algo. 1. The minimal sequential covariate adjustment set, \(^{}\), is derived directly from the ordered set \(^{}\), which characterizes the sequential covariate adjustment. Therefore, \(^{}\) naturally retains this characterizing property.

**Theorem 4** (Construction of Minimal Sequential Covariate Adjustment Set).: _Let \((,)\) denote a disjoint pair in \(\). Then, the following statements are equivalent:_

1. _There exists an ordered set_ \((_{1},,_{m})\) _satisfying SAC w.r.t._ \((,)\) _in_ \(\)_._
2. _The ordered set_ \(^{}=(,,)\) _from Algo._ 1 _is a minimal sequential covariate adjustment set._

Constructing \(^{}=(,,)\) can be achieved in \(O(m(||+||))\), as the construction of each \(^{}_{i}\) in Eq. (17) and the required closures each take \(O(||+||)\) and are repeated \(m\) times.

We now demonstrate Thm. 4 with a causal diagram \(\) in Fig. 4a. We have shown that \(^{}(^{}_{1},^{ }_{2})\) with \(^{}_{1}\) and \(^{}_{2}\{Z_{a},Z_{b},Z_{c}\}\) satisfies SAC relative to \((,Y)\) in \(\). Therefore, we only demonstrate Algo. 1 for \(^{}_{2}\{Z_{a},Z_{b},Z_{c}\}\). Run line 4: \(^{*}_{2}_{_{,2}^{ ,}}(Y;X_{2},\{Z_{a},Z_{b},Z_{c},X_{1}\})\{Z_{a},Z_{b},Z_ {c}\}\). First, \(\{Z_{a},Z_{c}\}\) is included in the closure since they are adjacent to \(Y\). Next, \(Z_{b}\) is included in the closure, since the path \(Y Z_{c} Z_{b}\) does not include non-collider vertex. Therefore, \(^{*}_{2}^{}_{2}=\{Z_{a},Z_{b},Z_{c}\}\). Next, run line 5. We already witnessed that \(\{Z_{a},X_{1},X_{2}\}=_{_{,2}^{ ,}}(X_{2};Y,\{Z_{a},Z_{b},Z_{c},X_{1}\})\), which leads to \(^{}_{2}\{Z_{a},X_{1},X_{2}\}\{Z_{a},Z_{b},Z _{c}\}=\{Z_{a}\}\). Therefore, \(^{}(^{}_{1},^{}_{2})=(,\{Z_{a}\})\).

## 5 Conclusion

We develop a sound and complete graphical criterion for sequential covariate adjustment. We start by highlighting the limitations of the existing mSBD criterion, acknowledging its soundness but noting its lack of completeness. (Prop. 3). Against this background, we introduce the _sequential adjustment criterion_ (Def. 7), which characterizes sequential covariate adjustment (Thm. 1). The proposed criterion includes and extends the mSBD and standard adjustment criterion, confirming its comprehensive nature since they imply the sequential adjustment criterion (Prop. 1 and Thm. 2). Further, we develop a procedure for constructing the sequential adjustment set that captures the sequential covariate adjustment (Thm. 3). Finally, we devise an algorithm to identify the minimal sequential covariate adjustment set (Algo. 1 and Thm. 4).