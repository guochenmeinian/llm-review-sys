# Asymptotics of Bayesian Uncertainty Estimation in Random Features Regression

Youngsoo Baek

Department of Statistical Science

Duke University

Durham, NC 27705

youngsoo.baek@duke.edu

Samuel I. Berchuck

Department of Biostatistics & Bioinformatics

Duke University

Durham, NC 27705

sib2@duke.edu

Sayan Mukherjee

Center for Scalable Data Analysis and Artificial Intelligence

Universitat Leipzig

Leipzig 04105

sayan.mukherjee@mis.mpg.de

Departments of Mathematics, Computer Science, Biostatistics & Bioinformatics, Duke University, NCMax Planck Institute for Mathematics in the Sciences, Leipzig

###### Abstract

In this paper, we compare and contrast the behavior of the posterior predictive distribution to the risk of the maximum a posteriori (MAP) estimator for the random features regression model in the overparameterized regime. We will focus on the variance of the posterior predictive distribution (Bayesian model average) and compare its asymptotics to that of the risk of the MAP estimator. In the regime where the model dimensions grow faster than any constant multiple of the number of samples, asymptotic agreement between these two quantities is governed by the phase transition in the signal-to-noise ratio. They also asymptotically agree with each other when the number of samples grows faster than any constant multiple of model dimensions. Numerical simulations illustrate finer distributional properties of the two quantities for finite dimensions. We conjecture they have Gaussian fluctuations and exhibit similar properties as found by previous authors in a Gaussian sequence model, which is of independent theoretical interest.

## 1 Introduction

One of the most surprising empirical observations in deep learning is the generalization of overparameterized models that can perfectly interpolate the data. The "double descent" curve, referring to the test error first increasing then decreasing with model complexity, has been both empirically and theoretically validated for linear (Hastie et al., 2022) and nonlinear models (Ghorbani et al., 2021; Mei and Montanari, 2022; Hu and Lu, 2022). Mei and Montanari (2022) showed that the generalization error of the random features (RF) model proposed by Rahimi and Recht (2007) does demonstrate double descent. Perhaps more surprisingly, they also showed that vanishingly small regularization can yield optimal generalization in a nearly noiseless learning task. These findings highlight the recent trend of explaining the success of machine learning through the prism of beneficial interpolation and overparameterization (Belkin, 2021).

There exists, however, another approach to overparameterized learning problems, which is the Bayesian posterior predictive distribution. In Bayesian practice, one can define the training objectiveas the negative log-likelihood of a probabilistic model. The ridge regularized predictor for the RF model studied by Mei and Montanari (2022) is the maximum a posteriori (MAP) estimator of this probabilistic model. A "truly Bayesian" approach, on the other hand, is to derive the posterior predictive distribution which averages over different predictors and summarizes one's uncertainty in prediction. The posterior predictive distribution is also referred to as the "Bayesian model average" in the literature (Ovadia et al., 2019; Fortuin et al., 2021). A fundamental question in Bayesian statistics is whether Bayesian credible sets, defined as high probability regions of the posterior, are also valid confidence sets in the frequentist sense (Kleijn and van der Vaart, 2012). While this is true in finite-dimensional settings and known as Bernstein von-Mises theorem, the behavior of "frequentist" and "Bayesian" confidence sets can be drastically different in high-to-infinite dimensions, as revealed by Cox (1993), Freedman (1999), Johnstone (2010).

In this work, we examine the frequentist properties of the Bayesian random features model. The focus is on whether the variance of the posterior predictive distribution (PPV) demonstrates similar asymptotics as the risk of the MAP estimator studied by Mei and Montanari (2022). The simplicity of the probabilistic model simplifies the study, as the posterior predictive distribution is available in closed form and is centered around the MAP estimator, for which we know the asymptotic risk. Due to this simplicity, agreement between the risk of the MAP estimator versus the PPV directly implies good coverage property of a natural confidence set formed by the posterior predictive. However, in light of previous work of Johnstone (2010), it is to be expected that such agreement can be hard to reach in high-dimensional learning. Previous literature relevant to our problem is reviewed in Section 2.3.

In this work, we show:

1. Absence of double descent phenomenon in the PPV with vanishing regularization (vague prior). Numerical instability does arise at the "interpolation boundary" for any finite dimensions.
2. In low noise problems, the expected width of the Bayesian credible ball for highly overparameterized models can be much wider than the true risk of the MAP predictor.
3. The expected width of a credible ball asymptotically agrees with the risk when the sample size grows much faster than the model dimensions. Numerical results show the required growth rate of the sample size is unreasonable for many learning problems.
4. Numerical simulations demonstrate finer distributional properties that are currently beyond the reach of theoretical analysis. They suggest the results of Freedman (1999) and Johnstone (2010) in the Gaussian sequence model are applicable to the more complicated RF model.

The rest of the paper is organized as follows. Section 2 reviews the basic setup of the RF model and its probabilistic reformulation. Section 3 summarizes our main results based on asymptotic formulae and numerical simulations. Section 4 concludes with a discussion of the implications and future directions.

## 2 Background on Random Features Model

Let inputs \(_{i}^{d},\ i=1,2,,n\) be drawn i.i.d. from a uniform measure (denoted \(\)) on a \(d\)-dimensional sphere with respect to the conventional Euclidean norm:

\[^{d-1}():=\{^{d}:||||=\}.\] (1)

Let outputs \(y_{i}\) be generated by the following model:

\[y_{i}=f_{d}(_{i})+_{i},\ f_{d}()=_{d,0}+,_{d}+f_{d}^{NL}().\] (2)

The model is decomposed into a linear component and a nonlinear component, \(f_{d}^{NL}\). The random error \(_{i}\)'s are assumed to be i.i.d. with mean zero, variance \(^{2}\), and finite fourth moment. We allow \(^{2}=0\), in which case the generating model is _noiseless_. In the analysis, these quantities will be assumed to obey further conditions, including an appropriate scaling so that all \(d\)-dependent quantities are \(O_{d}(1)\).

### Training with Ridge Regularization

We focus on learning the optimal _random features model_ that best fits the training data. This is a class of functions

\[:=\{f:f()=_{j=1}^{N}a_{j}(,_{j}/)\},\] (3)

which is dependent on \(N\) random features, \((_{j})_{j=1}^{N}\), which are drawn i.i.d. from \(^{d-1}\), and a nonlinear activation function, \(\). The training objective solves a regularized least squares problem for the linear coefficients \((a_{j})_{j=1}^{N}\):

\[_{^{N}}\{_{i=1}^{n}(y_{i}-_{j=1}^{N}a _{j}(_{i},_{j}/))^{2}+d_{1,d }_{2,d}||||^{2}\},\] (4)

where \(_{1,d}=N/d\), \(_{2,d}=n/d\), and \(>0\). The optimal weights, \(}}()\), determine an optimal ridge predictor denoted by \( f(;}())\). The dependence of the trained predictor on the dataset \((,)\) and features \(\) are suppressed in notation.

There exist both practical and theoretical motivations for studying RF regression. On the practical side, RF regression has been suggested by Rahimi and Recht (2007) as a randomized approximation scheme for training kernel ridge regression (KRR) models for large datasets. On the theoretical side, (4) describes a "lazy training" algorithm for a 2-layer neural network with activation function \(\). Previous studies have focused on the approximation power of such a function class (Jacot et al., 2018; Chizat et al., 2019) and the optimization landscape involved in training problems of type (4) (Mei et al., 2018, 2019).

Given a new input feature \(\), the ridge regularized predictor for the unknown output \(y\) has the form

\[() f(;})=(^{T}/)},\] (5)

with the optimal ridge weights \(}\) and a resolvent matrix that defines the joint posterior of the weights:

\[}}():=}()^{T}/,\] (6) \[}():=(^{T}+_{1,d }_{2,d}_{N})^{-1}.\] (7)

Here, \(:=(/)/\) for input design matrix \(^{n d}\) and output vector \((y_{i})_{i=1}^{n}\). Similarly we write \(():=(^{T}/)\). The \(L^{2} L^{2}(^{d-1}();)\) generalization error of predictor \(\) is defined by

\[R_{RF}(,,,):=_{}||f_{d}() -()||^{2}||f_{d}-||_{L^{2}}^{2},\] (8)

We emphasize that (8) is a random quantity, as it depends on \((,,)\).

### RF as Bayesian Model

The objective function (4) can be interpreted as a MAP estimation problem for an equivalent Bayesian model. Formally, we adopt a \(d\)-dependent weight prior distribution, denoted \(p()\), and also a normal likelihood, denoted \(p(|,,)\), centered around a function in the class (3) with variance \(^{-1}\).

\[ (0,^{-1}_{2,d} }{d}_{N})\] \[,, ((/),^{-1}_{n})\]

The normal likelihood model need not agree with the generating process (2), as is often the case for Bayesian deep learning. Technically and inferentially, it can be justified as a coherent update of belief given a squared error loss (Bissiri et al., 2016). The joint likelihood of \((,)\) is defined conditional on both the random features \(\) and an "inverse temperature" \(\). The choice to condition on \(\) instead of learning them can be unnatural in certain settings and is mainly for the convenience of analysis.

However, we do note that the RF model has been used by Crawford et al. (2018) as an approximation of fully Bayesian kernel learning.

The posterior predictive distribution, or Bayesian model average over the posterior of \(\), is defined as

\[p(y,,,):=_{^{N}}p(y, ,)\;p(,,)\;d,\] (9)

where the posterior of \(\) is a probability distribution placing higher mass near settings of \(\) minimizing ridge objective (4):

\[p(,,)[-\{ _{i=1}^{n}(y_{i}-f(;))^{2}+_{2,d }}{d}||||^{2}\}].\] (10)

This is a Gaussian measure centered around \(}\) (6) and covariance matrix \(}()/d\). Thus the posterior predictive at new input \(\) is also a normal distribution centered around \(\), with variance

\[s^{2}() s^{2}(;):=^{-1}(1+()^{T }}()()/d).\] (11)

We refer to (11) as the PPV. This quantity dictates the width of the uncertainty interval centered around (4) evaluated at \(\). The expected PPV over \(\) is defined by

\[S^{2}_{RF}(,,,):=_{}[s^{2}()]_{}[[y,,,]].\] (12)

The expectation over \(\), similarly as in (8), yields the radius of the posterior credible ball for a posterior Gaussian process \(f\) centered around the optimal predictor \(\). Furthermore, the Gaussian likelihood model simplifies the expected PPV into a decomposition of this radius and the inverse temperature of the posterior:

\[S^{2}_{RF}=||f-||^{2}_{L^{2}}\;dp(f,,)+^{-1},\] (13)

where \(p(f,,)\) is the law of Gaussian process \(f\) induced by the weight posterior \(p(,,)\). Thus, both summands in the display depend on the training features and are random. It is worth contrasting this definition with (12); in the next section, we explain in detail the motivation for comparing the two quantities.

The extra quantity introduced in the Bayesian formulation, \(\), governs how much the resulting posterior should concentrate around the ridge predictor (6). Since we are interested in the regime where \(N,d\), it is reasonable to assume the scale of the likelihood, \(\), must appropriately decrease with \(d\), similar to how the prior on \(\) is rescaled by \(1/d\). Practitioners may adopt some prior distribution on this parameter and perform hierarchical inference. We adopt a simpler, empirical Bayes approach and choose it to maximize the marginal likelihood:

\[^{-1}^{-1}():=, -()}{n}.\] (14)

This choice coincides with the training set error attained by predictor (4), so it will be decreasing as \(N\). If \(N>n\) and \( 0^{+}\), the training error vanishes as the model can perfectly interpolate the training set. We note the precise asymptotics of the training error has been already characterized by Mei and Montanari (2022) (Section 6).

A fundamental question here is whether \(R_{RF}\) and \(S^{2}_{RF}\) have similar asymptotics, as both quantities summarize uncertainty about our prediction in different ways. \(R_{RF}\) is the "frequentist's true risk," which requires assumptions about the unknown generative process. \(S^{2}_{RF}\), on the other hand, is the "Bayesian's risk" that can be actually computed without any model assumptions. Its asymptotics _does_ depend on model assumptions, as both the prior and likelihood need not capture the generative process (2). In particular, it is desired that it agrees with \(R_{RF}\) in some limiting sense. Throughout the rest of this work, we probe the question: Do \(R_{RF}\) and \(S^{2}_{RF}\) converge to the same value as \(d,n,N\)?

### Previous Works

We have introduced our problem of comparing two different quantities, \(R_{RF}\) and \(S^{2}_{RF}\), and provided their respective interpretations. Such comparison, between the frequentist risk and the variance of the posterior, was done by Freedman (1999) in a white noise model, where one observes an infinite square-summable sequence with Gaussian noise. The key finding is that the distributions of two corresponding statistics, re-normalized, have different variances. They are in fact radically different distributions in that they are essentially orthogonal. Knapik et al. (2011) clarified the situation by showing frequentist coverage of credible ball depends heavily on the smoothness of the prior covariance operator. Johnstone (2010) have extended the results to a sequence of finite but growing length, which is a setup more similar to ours. Our study for the RF model addresses a much simpler question, as the theoretical results in Section 3 only address whether two statistics converge to the same limits. Unlike in the work by previous authors, the identity of limits cannot be taken for granted. A key feature driving the different asymptotics of the two quantities is that the Bayesian's prior and the likelihood are "mismatched" with respect to the data generating process; i.e., \(f_{d}\) need not belong to the RF class (3). In Section 3.3, we demonstrate some distributional properties of \(R_{RF}\) and \(S_{RF}^{2}\) empirically observed in numerical simulations.

Uncertainty quantification in Bayesian learning has recently garnered much attention in the theoretical deep learning literature. We highlight, among many works: Clarte et al. (2023), characterizing exact asymptotic calibration of a Bayes optimal classifier and a classifier obtained from the generalized approximate message passing algorithm, and Clarte et al. (2023), demonstrating double descent-like behavior of the Bayes calibration curve in RF models. In particular, quantities \(R_{RF}\) and \(S_{RF}^{2}\) studied by our work can be related, respectively, to the "Bayes-optimal classifier" and "empirical risk classifier" of the latter work (Section 2). The recent work of Guionnet et al. (2023), on the other hand, explicitly addresses the model mismatch in Bayesian inference by deriving the exact, universal asymptotic formula for generalization of a misspecified Bayes estimator in a rank-1 signal detection problem.

## 3 Results

### Asymptotic Characterization

We present the main results and illustrate them through numerical simulations. We operate under assumptions identical to those of Mei and Montanari (2022), stated below. The proofs are collected in the Supplementary Materials.

**Assumption 1**.: _Define \(_{1,d}=N/d\) and \(_{2,d}=n/d\). We assume \(_{1,d}_{1}<+\) and \(_{2,d}_{2}<+\) as \(d\)._

**Assumption 2**.: _Let \(:\) be weakly differentiable and \(|(x)|,|^{}(x)|<c_{0}e^{c_{1}|x|}\) for some \(c_{0},c_{1}<+\). For \(G(0,1)\), the coefficients:_

\[_{0}=[(G)],\ _{1}=[G(G)],\ _{*}^{2}=E[ ^{2}(G)]-(_{0}^{2}+_{1}^{2})\] (15)

_are assumed to be greater than 0 (ruling out a linear \(\)) and finite._

**Assumption 3**.: _The generating model (2) satisfies_

\[_{0,d}^{2} F_{0}^{2}<+,\ ||_{d}||^{2} F_{1}^{2}<+;\] (16)

_furthermore, \(f_{NL,d}()\) is a centered Gaussian process on \(^{d-1}()\), whose covariance function has the form:_

\[[f_{NL,d}(_{1})f_{NL,d}(_{2})]=_{d}( _{1},_{2}/d).\] (17)

_The kernel \(_{d}\) satisfies_

\[[_{d}(x_{(1)}/)]=0,\ [x_{(1)}_{d}(x_{(1)} /)]=0_{d}(1) F_{*}^{2}<+,\] (18)

_where \(x_{(1)}\) is the first entry of \((^{d-1}())\). The signal-to-noise ratio (SNR) of the model is defined by_

\[=^{2}}{F_{*}^{2}+^{2}}.\] (19)

In this "linear proportional" asymptotic regime, we derive an asymptotic formula for the expected PPV akin to that of Mei and Montanari (2022) for the generalization error. Analysis shows Definition 1 of Mei and Montanari (2022), characterizing the asymptotics of \(R_{RF}\), can be straightforwardly applied to also characterize the asymptotics of \(S_{RF}^{2}\).

**Proposition 1**.: _Denote by \(_{+}\) the upper half complex plane: \(\{a+bi:=,\ b>0\}\). Let functions \(_{1},_{2}:_{+}_{+}\) be uniquely defined by the conditions: on \(_{+}\), \(_{1}(),_{2}()\) are analytic and uniquely satisfy the equations_

\[_{1} =_{1}(--_{2}-_{2}}{1-^{2} _{1}_{2}})^{-1},\] (20) \[_{2} =_{2}(--_{1}-_{1}}{1-^{2} _{1}_{2}})^{-1},\] (21)

_when \(|_{1}()|_{1}/()\) and \(|_{2}()|_{2}/()\), with \(()>C\) for sufficiently large constant \(C\). Define_

\[=_{1}(_{2}}/_{*})_{2}( _{2}}/_{*}),\ =}{_{*}}.\] (22)

_Under Assumptions 1-3 and for \(>0\),_

\[S^{2}_{RF}(,,,) ^{2}=^{2}}{1-^{2}}+F_{*}^{2}+ ^{2}\ \ d,n,N.\]

Note that \(^{2}\) depends on \((_{1},_{2},)\) only through function \(\). The following facts follow from this fact and the asymptotic characterization of function \(\) when \( 0^{+}\).

**Proposition 2**.: _The following holds for the map \((_{1},_{2},)^{2}\) defined in Proposition 1:_

1. _It is non-decreasing in_ \(\)_._
2. \(_{ 0^{+}}^{2}<+\) _when_ \(_{1}=_{2}\)_._

Item 2, Proposition 2 deserves special attention, as it seems to suggest that there is no "double descent" in the asymptotics of \(S^{2}\) when using an improper prior. This fact does _not_ possess an operational meaning at any finite \(N=n\), due to the ordering of the limits \(N,n\) and \( 0^{+}\). In fact, one may expect that the distribution of the least singular value of the relevant matrix \(\) causes numerical instability for small \(\) when \(N=n\). In Section 3.3, this hypothesis is empirically validated through simulations. Subtly, the theoretical prediction does accurately describe the numerical simulations for small choices of \(\). On the other hand, the asymptotic prediction for the frequentist risk does diverge when \( 0^{+}\) and \(_{1}=_{2}\).

### Comparison with Generalization Error

The asymptotics of (8), the "frequentist" risk for our comparison, was characterized by Mei and Montanari (2022) through a theorem similar to Proposition 1. Our main interest lies in comparing the risk against the Bayesian variance in two limiting cases:

1. Highly overparameterized models where \(_{1}\). The number of parameters grows faster than any constant multiple of the number of samples.
2. Large sample models where \(_{2}\). The number of samples grows faster than any constant multiple of the number of parameters.

The first regime has been studied as the relevant regime in modern deep learning. The second regime is closer to the classical regime of asymptotic statistics where only the number of samples \(n\) diverges. Below, we re-state the asymptotic formulae for \(R_{RF}\) of Mei and Montanari (2022) in these special cases, which admits simplifications relative to when both \(_{1},_{2}\) are finite.

**Proposition 3**.: (Theorem 4-5, Mei and Montanari (2022)) _Under the notation of Proposition 1, define a function_

\[(,,)=--^{2}-1 )+-^{2}-1}}{2(+1)}.\]

_In the highly overparameterized regime, where \(_{1}\), asymptotic risk is given as_

\[_{wide}(,,_{2},)=_{_{1}} _{d}R_{RF}(,,,)=^{2}+F_{*}^{2}+^{2})(_{2}+_{2}^ {2})}{(1+)(_{2}-2_{2}_{2}+_{2}^{2}_{2}-_{2}^ {2})}+F_{*}^{2}\]_with \(_{2}=(,_{2},/_{*}^{2})\). In the large sample regime, where \(_{2}\), asymptotic risk is given as_

\[_{lsamp}(,_{1},)=_{_{2}}_ {d}R_{RF}(,,,)=^{2} (_{1}^{2}+_{1}^{2})}{^{2}(_{1}-2_{1}_{1}+ _{1}^{2}_{1}-_{1}^{2})}+F_{*}^{2}\]

_with \(_{1}=(,_{1},/_{*}^{2})\)._

A simple question, mentioned in Section 2.2, was whether the two quantities agree. It turns out that in the second regime, at least, the two formulae converge to the same limit, which is the main content of the next Proposition. In the first regime, whether the limits agree is determined by the signal-to-noise ratio \(\). Mei and Montanari (2022) showed that if \(\) is larger than a certain critical threshold \(_{*}\), which depends on \((_{2},)\), the optimal regularization is achieved by \( 0^{+}\), whereas if \(\) is smaller than \(_{*}\), there exists an optimal regularization \(_{*}\) bounded away from \(0\). This phase transition also determines the agreement of the risk and the PPV in the limit.

**Proposition 4**.: (Proposition 5.2,Mei and Montanari (2022)+\(\)) _Define quantities_

\[_{*}(,_{2}) =^{2}-_{0,2}}{(1-_{2})_{0,2}+ _{2}},\] \[_{0,2} =(,_{2},0)\]

_under the notation of Proposition 3._

1. _If_ \(<_{*}\)_, then_ \(_{ 0}_{wide}(,,_{2},)\)_, is attained at some_ \(^{opt}>0\)_:_ \[^{opt} :=_{ 0}_{wide}(,, _{2},)=_{2}-^{2}_{*}_{2}+ ^{2}_{*}+_{*}-_{*}^{2}}{(_{*}^{2}-_{*}) _{2}},\] \[_{*} :=(,_{2},0).\] _Furthermore,_ \(_{wide}(,,_{2},^{opt})=_{_{1} }^{2}(_{1},_{2},^{opt})-^{2}\)_._ _If, on the other hand,_ \(>_{*}\)_, then_ \(_{ 0}_{wide}(,,_{2},)=0\)_. Furthermore,_ \(_{wide}(,,_{2},0)<_{_{1}}^{ 2}(_{1},_{2},0)-^{2}\)_._
2. \(_{ 0}_{lsamp}(,_{1},)=0\) _and_ \(_{lsamp}(,_{1},0)=_{_{2}}^{2}( _{1},_{2},0)-^{2}\)_._

Note the subtraction of the noise level \(^{2}\) from \(^{2}\). This is because \(S^{2}_{RF}\) is computed based on the training error in Proposition 1, which includes both the approximation error and the variance of data, whereas \(R_{RF}\) is computed based only on the approximation error in the test set.

### Numerical Simulations

In this section, we first compare evaluations of the asymptotic formulae for \(R_{RF}\) and \(S^{2}_{RF}\) for varying \((_{1},_{2},)\). We highlight their difference for finite \((_{1},_{2})\) at the optimal choice of \(\) for the MAP risk. We also present numerical simulations, which both validate the formulae (they concentrate fast) and empirically exhibit further interesting distributional properties (suggesting the need for second-order asymptotics). MATLAB codes used to produce simulation results are included in the Supplementary Materials.

Figure 1 shows the dramatic mismatch between \(R_{RF}\) and \(S^{2}_{RF}\) in the low-noise regime. It turns out the conservativeness of the credible ball persists for the choice of \(\) that depends on \((_{1},_{2})\). The situation becomes more delicate in the high-noise regime because there exists a phase transition in the optimal choice of \(\) that depends on (19), which decreases with the noise variance \(^{2}\). Figures 2.2a and 2b compare the two curves, \(\) and \(\), for the "optimally tuned" \(\) at which the best possible frequentist risk is attained, for a fixed pair of \((_{1},_{2})\). In a low-noise task, with \(=5\), the ratio of the frequentist risk of the posterior mean predictor to the width of the posterior predictive credible ball is less than 1 for a wide range of \(_{1}\). The situation is more nuanced and possibly more favorable for the Bayesian case in the high-noise task with \(=1/5\).

While Figure 1 validates good concentration properties of \(R_{RF}\) and \(S^{2}_{RF}\) with respect to their asymptotic formulae, we may want to investigate the rate of fluctuations for these quantities. Figure3 suggests an interesting phenomenon: both quantities appear Gaussian, but are nearly orthogonal precisely near the "interpolation boundary" where \(R_{RF}\) exhibits double descent (2nd subplot). Ourempirical results should be compared with the results of Freedman (1999) and Johnstone (2010). The Gaussianity of \(R_{RF}\) and \(S_{RF}^{2}\), if true, strengthens the agreement between the expected width \(S_{RF}^{2}\) and expected risk \(R_{RF}\) immediately transfers to the agreement between the frequentist coverage of \((1-)-\%\) Bayes credible ball around the mean and the nominal coverage. Again, such claims are generally true in finite-dimensional settings, but not true for high-dimensional settings. For instance, Freedman (1999) showed that asymptotically, the posterior variance fluctuates like a Gaussian random variable with a variance strictly smaller than that of the frequentist risk. Extracting such information is possible only if we study _second-order information_ of \(R_{RF}\) and \(S_{RF}^{2}\); in particular, suggests a Gaussian central limit for these quantities. A rigorous proof of a central limit theorem for \(R_{RF}\) and \(S_{RF}^{2}\) goes beyond the scope of this work. Nevertheless, we conjecture the following for the fluctuations of \(R_{RF}\) and \(S_{RF}^{2}\):

1. Both \(d(R_{RF}-R_{RF})\) and \(d(S_{RF}^{2}-S_{RF}^{2})\) weakly converge to Gaussian distribution with appropriate variances. The faster convergence rate of \(d\) rather than \(\) is known to be common in central limit theorems for linear spectral statistics (Lytova and Pastur, 2009).
2. When \(_{1}_{2}\), asymptotic variance of \(S_{RF}^{2}\) is smaller than \(R_{RF}\). When \(_{1}=_{2}\), the two distributions are nearly orthogonal. For large enough \(_{1}\), the asymptotic variances are of the same order.

These conjectures are of independent interest and pose interesting theoretical challenges. We must note that second-order asymptotics has received less attention in the deep learning community. Only recently did Li et al. (2021) study the asymptotic normality of prediction risk achieved by a min-norm least squares interpolator. Their result relies on a central limit theorem for linear statistics of eigenvalues of large sample covariance matrices, established by Bai and Silverstein (2004). Many central limit theorems in random matrix theory seem insufficient to handle kernel learning or learning with random features.

## 4 Discussion

In sum, our calculations and empirical findings suggest that the RF model still has some interesting discoveries to offer, particularly for those interested in the implications of Bayesian deep learning. The asymptotics of the posterior predictive summaries can be very different from that of the generalization error. Numerical simulations suggest that some version of the central limit holds so that depending on the particular scaling of dimensions, the frequentist coverage of the posterior predictive distribution can be arbitrarily low or high. We now conclude with a discussion of several conjectures and the next directions suggested by these findings.

**Heuristic Implications.** While our technical calculations are only applicable to the RF model, we believe the general perspective of comparing frequentist versus Bayesian estimation approaches to the deep learning model can offer useful heuristics explaining empirically observed phenomena in training Bayesian deep learning models.

One suggestion is that the different regimes of asymptotics may explain away the "cold posterior effect", first empirically observed by Wenzel et al. (2020). The authors forcefully suggested that raising the posterior of a deep learning model to an even larger power (i.e., more concentrated) can improve generalization. That the posteriors can be too wide in highly overparameterized, nearnoiseless regimes may explain this issue. Even though in this simple RF model setup, the posterior predictive mean is left unchanged from that of the posterior, it is plausible that for more complicated models this need not be so. When that posterior is much wider than the expected risk of the mean, we will mix over too many bad predicting weights, so it will be actually worse to average over the posterior than not.

**Technical Improvements.** The technically most interesting but quite challenging direction, suggested by our numerical simulations in Section 3.3, is to study second-order fluctuations of random matrix quantities often encountered in deep learning. While at this point a vast amount of literature exists that systematically overcomes the non-standard definitions of quantities like generalization error from the viewpoint of random matrix theory, we are aware of no study as of yet that overcomes the same issues to show a central limit-type result. On the other hand, central limit theorems for linear spectral statistics remain an active area of research in random matrix theory and are generally acknowledged to require more advanced, subtler arguments that are fundamentally different from first-order results(i.e., convergence of empirical spectral distribution). For a start, a separate work on the central limit theorem for linear spectral statistics of kernel matrices is in preparation by the authors.

Another interesting direction is to extend the comparison between frequentist and Bayesian modeling approaches to more complex models of training dynamics. For instance, Adlam and Pennington (2020) have derived precise asymptotics of generalization error in the neural tangent kernel (NTK) regime, in which the features \(\) are "learned" through a linearized approximation of the gradient flow in training. Mei et al. (2018, 2019) have suggested a different asymptotic model, in which \(\) evolve through nonlinear dynamics. An interesting challenge, both technically and conceptually, is to adapt their analysis to the Bayesian setting, where the gradient flow on the space of posterior measures of \(\) is approximated and specific projections are tracked.

**Making the "Right" Comparison.** A possible objection is that the comparison between two quantities is not appropriate: if interested in the coverage of function \(f_{d}\) with our credible set, then one must compare the expected width of the interval of the function space posterior, \(\), instead of that of the Bayesian model average. While the objection is sensible, the fact is that the average variance of the function posterior will be an even worse uncertainty estimate for underparameterized models, whereas it will make little difference for overparameterized models. The reason is that the variance of the posterior of \(\) only differs from that of the posterior predictive, in (11), by the training set error term (14). The training error dominates the PPV precisely for underparameterized models (\(_{1}<_{2}\)), so the curves of Figure 1 will now be non-_decreasing_ and asymptotically convergent to a similar constant in expectation. This fact illustrates that a simple interpretation of the width of the posterior is complicated in even simplistic high-dimensional models.

Another possible objection is that the same value of \(\) need not be optimal for the posterior predictive. Since the asymptotic curve for \(S^{2}\) is non-increasing in \(\), this implies one must choose even smaller \(\) than \(^{opt}\) to obtain less conservative credible intervals, regardless of the SNR \(\). This seems an odd consequence of using overparameterized models, where a good frequentist coverage is obtained by choosing a narrower prior than that with good "contraction property" (i.e., minimal \(L^{2}\) risk of posterior mean).

The final objection is that the RF model is simply not a very realistic model of practical Bayesian deep learning. We point out that quantifying the behavior of RF models as approximations of kernel learning methods remains a valid concern for Bayesian practitioners.