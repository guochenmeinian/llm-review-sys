# Effective Exploration Based on the Structural Information Principles

Xianghua Zeng\({}^{1}\), Hao Peng\({}^{1}\), Angsheng Li\({}^{1,2}\)

\({}^{1}\) State Key Laboratory of Software Development Environment, Beihang University, Beijing, China

\({}^{2}\) Zhongguancun Laboratory, Beijing, China

{zengxianghua, penghao, angsheng}@buaa.edu.cn, liangsheng@gmail.zgclab.edu.cn

###### Abstract

Traditional information theory provides a valuable foundation for Reinforcement Learning (RL), particularly through representation learning and entropy maximization for agent exploration. However, existing methods primarily concentrate on modeling the uncertainty associated with RL's random variables, neglecting the inherent structure within the state and action spaces. In this paper, we propose a novel **Structural** Information principles-based **E**ffective **E**xploration framework, namely **SI2E**. Structural mutual information between two variables is defined to address the single-variable limitation in structural information, and an innovative embedding principle is presented to capture dynamics-relevant state-action representations. The SI2E analyzes value differences in the agent's policy between state-action pairs and minimizes structural entropy to derive the hierarchical state-action structure, referred to as the encoding tree. Under this tree structure, value-conditional structural entropy is defined and maximized to design an intrinsic reward mechanism that avoids redundant transitions and promotes enhanced coverage in the state-action space. Theoretical connections are established between SI2E and classical information-theoretic methodologies, highlighting our framework's rationality and advantage. Comprehensive evaluations in the MiniGrid, MetaWorld, and DeepMind Control Suite benchmarks demonstrate that SI2E significantly outperforms state-of-the-art exploration baselines regarding final performance and sample efficiency, with maximum improvements of \(37.63\%\) and \(60.25\%\), respectively.

## 1 Introduction

Reinforcement Learning (RL) has emerged as a pivotal technique for addressing sequential decision-making problems, including game intelligence (Vinyals et al., 2019; Badia et al., 2020), robotic control (Andrychowicz et al., 2017; Liu and Abbeel, 2021), and autonomous driving (Prathiba et al., 2021; Perez-Gil et al., 2022). In the realm of RL, striking a balance between exploration and exploitation is crucial for optimizing agent policies and mitigating the risk of suboptimal outcomes, especially in scenarios characterized by high dimensions and sparse rewards (Zhang et al., 2021).

Recently, advancements in information-theoretic approaches have shown promise for exploration in self-supervised settings. The maximum entropy framework over the action space (Haarnoja et al., 2017) has led to the development of robust algorithms such as Soft Q-learning (Nachum et al., 2017), SAC (Haarnoja et al., 2018), and MPO (Abdolmaleki et al., 2018). Additionally, various objectives focused on maximizing state entropy are utilized to ensure comprehensive state coverage (Hazan et al., 2019; Islam et al., 2019). To facilitate the exploration of complex state-action pairs, MaxRenyi optimizes Renyi entropy across the state-action space (Zhang et al., 2021). However, a prevalent issue with entropy maximization strategies is their tendency to bias exploration towards low-value states, making them vulnerable to imbalanced state-value distributions in supervised settings. To mitigatethis, value-conditional state entropy is introduced to compute intrinsic rewards based on the estimated values of visited states (Kim et al., 2023). Due to their instability in noisy and high-dimensional environments, a Dynamic Bottleneck (DB) (Bai et al., 2021) is developed based on the Information Bottleneck (IB) principle (Tishby et al., 2000), thereby obtaining dynamics-relevant representations of state-action pairs. Despite their successes, existing information-theoretic exploration methods have a critical limitation: they often overlook the inherent structure within state and action spaces. This oversight necessitates new approaches to enhance exploration effectiveness.

Figure 1 illustrates a simple six-state Markov Decision Process (MDP) with four actions. The different densities of the blue and red lines represent different actions, as indicated in the legend, leading to state transitions aimed at optimizing the return to the initial state \(s_{0}\). Solid lines specifically denote actions \(a_{0}\) and \(a_{1}\). The transitions between states \(s_{2}\) and \(s_{5}\) are deemed redundant as they do not facilitate the primary objective of efficiently returning to \(s_{0}\). Therefore, the state-action pairs \((s_{2},a_{3})\) and \((s_{5},a_{3})\) have lower policy values. A policy maximizing state-action Shannon entropy would encompass all possible transitions (blue color). In contrast, a policy incorporating the inherent state-action structure will divide these redundant state-action pairs into a vertex sub-community and minimize the entropy of this sub-community to avoid visiting it unnecessarily. Simultaneously, it maximizes state-action entropy, resulting in maximal coverage for transitions (red color) that are more likely to contribute to the desired outcome in the simplified five-state MDP.

Departing from traditional information theory applied to random variables, structural information (Li and Pan, 2016) has been devised to quantify dynamic uncertainty within complex graphs under a hierarchical partitioning structure known as an "encoding tree". Structural entropy is conceptualized as the minimum number of bits required to encode a vertex accessible through a single-step random walk and is minimized to optimize the encoding tree. However, this definition is limited to single-variable graphs and cannot capture the structural relationship between two variables. While the underlying graph can encompass multiple variables, current structural information principles are limited in treating these variables as a single joint variable, measuring only its structural entropy. This limitation prevents the effective quantification of structural similarity between variables, inherently imposing a single-variable constraint. Prior research on reinforcement learning using structural information principles (Zeng et al., 2023b,c) has focused on independently modeling state or action variables without simultaneously considering state-action representations.

In this work, we propose SI2E, a novel and unified framework grounded in structural information principles for effective exploration within high-dimensional and sparse-reward environments. Initially, we embed state-action pairs into a low-dimensional space and present an innovative representation learning principle to capture dynamics-relevant information and compress dynamics-irrelevant information. Then, we strategically increase the state-action pairs' structural mutual information with subsequent states while decreasing it with current states. We analyze value differences among state-action representations to form a complete graph and minimize its structural entropy to derive the

Figure 1: By incorporating the inherent state-action structure, we simplify the original six-state Markov Decision Process (MDP) with four actions to a five-state MDP with two actions, effectively reducing the size of state-action space from \(24(6 4)\) to \(10(5 2)\). Here, \(s^{}_{2}\) and \(a^{}_{0}\) represent vertex communities \(\{s_{2},s_{5}\}\) and \(\{a_{0},a_{1}\}\), respectively. In this scenario, a policy maximizing state-action Shannon entropy would encompass all possible transitions (blue color). In contrast, a policy maximizing structural entropy would selectively focus on crucial transitions (red color), avoiding redundant transitions between \(s_{2}\) and \(s_{5}\).

optimal encoding tree, thereby unveiling the hierarchical community structure of state-action pairs. By leveraging this identified structure, we design an intrinsic reward mechanism tailored to avoid redundant transitions and enhance maximal coverage in exploring the state-action space. Furthermore, we establish theoretical connections between our framework and classical information-theoretic methodologies, highlighting the rationality and advantage of SI2E. Our thorough evaluations across diverse and challenging tasks in the MiniGrid, MetaWorld, and DeepMind Control Suite benchmarks have consistently shown SI2E's superiority, with significant improvements in final performance and sample efficiency, surpassing state-of-the-art exploration baselines. For further research, the source code is available at 1. Our contributions are summarized as follows:

* A novel framework based on structural information principles, SI2E, is proposed for effective exploration in high-dimensional RL environments with sparse rewards.
* An innovative principle of structural mutual information is introduced to overcome the single-variable constraint inherent in existing structural information and to enhance the acquisition of dynamics-relevant representations for state-action pairs.
* A unique intrinsic reward mechanism that maximizes the value-conditional structural entropy is designed to avoid redundant transitions and promote enhanced coverage in the state-action space.
* Our experiments on various challenging tasks demonstrate that SI2E significantly improves final performance and sample efficiency by up to \(37.63\%\) and \(60.25\%\), respectively, compared to state-of-the-art baselines.

## 2 Preliminaries

In this section, we formalize the definitions of fundamental concepts. The descriptions of primary notations are summarized in Appendix A.1 for ease of reference.

### Traditional Information Principles

Consider the random variable pair \(Z=(X,Y)\) with a joint distribution probability denoted by \(p(x,y)(0,1)\). The marginal probabilities, \(p(x)\) and \(p(y)\), are defined as \(p(x)=_{y}p(x,y)\) and \(p(y)=_{x}p(x,y)\), respectively. The joint Shannon entropy (Shannon, 1953) of \(X\) and \(Y\) is \(H(X,Y)=-_{(x,y)}[p(x,y) p(x,y)]\), which quantifies the total uncertainty in \(Z\). Conversely, the marginal entropies \(H(X)=-_{x}[p(x) p(x)]\) and \(H(Y)=-_{y}[p(y) p(y)]\) characterize the uncertainty in \(X\) and \(Y\) individually. The mutual information \(I(X;Y)=_{x,y}[p(x,y)]\) quantifies the shared uncertainty between \(X\) and \(Y\). It satisfies the following relationship: \(I(X;Y)=H(X)+H(Y)-H(X,Y)\).

### Reinforcement Learning

Within the context of RL, the sequential decision-making problem is formalized as a Markov Decision Process (MDP) (Bellman, 1957). The MDP is characterized by a tuple \((,,,^{e},)\), where \(\) denotes the observation space, \(\) the action space, \(\) the environmental transition function, \(^{e}\) the extrinsic reward function, and \([0,1)\) the discount factor. At each discrete timestep \(t\), the agent selects an action \(a_{t}\) upon observing \(o_{t}\). This leads to a transition to a new observation \(o_{t+1}(o_{t},a_{t})\) and a reward \(r_{t}^{e}\). The policy network \(\) is optimized to maximize the cumulative long-term expected discounted reward.

**Maximum State Entropy Exploration.** In environments with sparse rewards, agents are encouraged to explore the state space extensively, which can be incentivized by maximizing the Shannon entropy \(H(S)\) of state variable \(S\). When the prior distribution \(p(s)\) is not available, the non-parametric \(k\)-nearest neighbors (\(k\)-NN) entropy estimator (Singh et al., 2003) is employed. For a given set of \(n\) independent and identically distributed samples from a \(d_{x}\)-dimensional space \(\{x_{i}\}_{i=0}^{n-1}\), the entropy of variable \(X\) is estimated as follows:

\[_{KL}(X)=}{n}_{i=0}^{n-1} d(x_{i})+C\] (1)where \(d(x_{i})\) is twice the distance from \(x_{i}\) to its \(k\)-th nearest neighbor, and \(C\) is a constant term.

**Information Bottleneck Principle.** In the supervised learning paradigm, representation learning aims to transform an input source \(X\) into a representation \(Z\), targeted towards an output source \(Y\). The Information Bottleneck (IB) principle (Tishby et al., 2000) refines this process by maximizing the mutual information \(I(Z;Y)\) between \(Z\) and \(Y\), capturing the relevant features of \(Y\) within \(Z\). Concurrently, the IB principle imposes a complexity constraint by minimizing the mutual information \(I(Z;X)\) between \(Z\) and \(X\), effectively discarding irrelevant features. To balance these objectives, the IB principle utilizes a Lagrangian multiplier, facilitating a balanced trade-off between the richness of the representation and its complexity.

### Structural Information Principles

The encoding tree \(T\) of an undirected and weighted graph \(G=(V,E)\) is characterized as a rooted tree with the following properties: 1) Each tree node \(\) in \(T\) corresponds to a subset of graph vertices \(V_{} V\). 2) The subset \(V_{}\) of tree root \(\) encompasses all vertices in \(V\). 3) Each subset \(V_{}\) of a leaf node \(\) in \(T\) only contains a single vertex \(v\), thus \(V_{}=\{v\}\). 4) For each non-leaf node \(\), the number of its children is assumed as \(l_{}\), with the \(i\)-th child specified as \(_{i}\). The collection of subsets \(V_{_{1}},,V_{_{l_{}}}\) constitutes a sub-partition of \(V_{}\).

Given an encoding tree \(T\) whose height is at most \(K\), the \(K\)-dimensional structural entropy of graph \(G\) is defined as follows:

\[H^{T}(G)=-_{ T,}}{ (G)}()}{ {vol}(^{-})},\ \ \ H^{K}(G)=_{T}H^{T}(G)\] (2)

where \(g_{}\) is the weighted sum of all edges connecting vertices within the subset \(V_{}\) to vertices outside the subset \(V_{}\).

## 3 Structural Mutual Information

In this section, we address the single-variable constraint prevalent in existing structural information principles and introduce the concept of structural mutual information for subsequent state-action representation learning within our SI2E framework.

Given the random variable pair \((X,Y)\) with \(|X|=|Y|=n\), we construct an undirected bipartite graph \(G_{xy}\) to represent the joint distribution of \(X\) and \(Y\). In \(G_{xy}\), each vertex \(x X\) connects to each vertex \(y Y\) via weighted edges, where the weight of each edge equals the joint probability \(p(x,y)\). Notably, no edges connect vertices within the same set, \(X\) or \(Y\), and the total sum of the edge weights is \(1\), \(_{x,y}p(x,y)=1\). Each single-step random walk in \(G_{xy}\) accesses either a vertex from \(X\) or \(Y\). The structural entropy of variable \(X\) in \(G_{xy}\) is defined as the number of bits required to encode all accessible vertices in the set \(X\). It is calculated using the following formula:

\[H^{SI}(X)=-_{x X}(G_{xy})} (G_{xy})}=-_{x X} ,\] (3)

where the sum of all vertex degrees is twice the total sum of edge weights, resulting in \((G_{xy})=2\).

The structural entropy \(H^{SI}(Y)\) is defined similarly. We restrict the partitioning structure of \(G_{xy}\) to \(2\)-layer approximate binary trees, denoted as \(^{2}\), to calculate the required bits to encode accessible vertices in \(X\) or \(Y\), defined as the joint structural entropy. This tree structure mandates that each intermediate node (neither root nor leaf) has precisely two children. We begin by initializing a one-layer encoding tree, \(T^{0}_{xy}\), designating each non-root node \(\)'s parent as the root \(\), with \(^{-}=\). By applying the stretch operator from the HCSE algorithm (Pan et al., 2021), we pursue an iterative and greedy optimization of \(T^{0}_{xy}\), further detailed in Appendix A.2. The optimal encoding tree, \(T^{*}_{xy}\), for \(G_{xy}\) and the joint entropy under \(T^{*}_{xy}\) are achieved through:

\[T^{*}_{xy}=_{T^{2}}H^{T}(G_{xy}),\ \ \ H^{T^{*}_{xy}}(X,Y)=H^{T^{*}_{xy}}(G_{xy}).\] (4)

Utilizing \(2\)-layer approximate binary trees as the structural framework ensures computational tractability and more complex structures will increase the cost of increased computational complexity, which can be prohibitive for practical applications.

We derive the following proposition regarding \(^{2}\), with the detailed proof provided in Appendix B.1.

**Proposition 3.1**.: _Consider an undirected graph \(G=(V,E)\) with vertices \(v_{i}\) and \(v_{j}\) in \(V\). If the edge \((v_{i},v_{j})\) is absent from \(E\), then in the \(2\)-layer approximate binary optimal encoding tree \(T^{*}^{2}\), there does not exist any non-root node \(\) such that both \(v_{i}\) and \(v_{j}\) are included in its subset \(V_{}\)._

Each intermediate node \( T^{*}_{xy}\) corresponds to a subset comprising exactly one \(x\) vertex and one \(y\) vertex, thus establishing a one-to-one matching structure between variables \(X\) and \(Y\). The \(i\)-th intermediate node in \(T^{*}_{xy}\), ordered from left to right, is denoted as \(_{i}\). Within this subset, the \(x\) and \(y\) vertices are labeled as \(x_{i}\) and \(y_{i}\), respectively.

To define structural mutual information accurately, it is essential to consider the joint entropy of two variables under various partition structures. We introduce an \(l\)-transformation applied to \(T^{*}_{xy}\) to systematically traverse all potential one-to-one matching of these variables, providing a comprehensive measure of their structural similarity. Given an integer parameter \(l>0\), this transformation generates a new \(2\)-layer approximate binary tree, \(T^{l}_{xy}\), representing an alternative one-to-one matching structure.

**Definition 3.2**.: For each intermediate node \(_{i}\) in \(T^{l}_{xy}\), the \(x\) and \(y\) vertices in \(T^{l}_{_{i}}\) are specified as \(T^{l}_{_{i}}=\{x_{i^{}},y_{i}\}\), where \(i^{}=(i+l) n\).

The resulting tree \(T^{l}_{xy}\) is equivalent to the optimal tree \(T^{*}_{xy}\) when \(l=0\). We provide an example in Appendix A.3 with \(n=4\) for an intuitive understanding of the described process.

**Definition 3.3**.: Leveraging the relationship \(I(X;Y)=H(X)+H(Y)-H(X,Y)\) in traditional information theory, we formally define the structural mutual information, \(I^{SI}(X;Y)\), as follows:

\[I^{SI}(X;Y)=_{l=0}^{n-1}H^{SI}(X)+H^{SI}(Y)-H^{T^{l}_{xy}}(X,Y) =_{i,j}p(x_{i},y_{j}))+p(y_{j})} .\] (5)

The detailed derivation is provided in Appendix C.1. Structural mutual information quantifies the average difference between the required encoding bits of accessible vertices of a single variable and the joint variable. The following theorem outlines the connection between \(I^{SI}(X;Y)\) and \(I(X;Y)\), with a detailed proof in Appendix B.2.

**Theorem 3.4**.: _For a tuning parameter \(0 1\), its holds for the structural mutual information \(I^{SI}(X;Y)\), traditional mutual information \(I(X;Y)\), and joint Shannon entropy \(H(X,Y)\) that:_

\[I(X;Y) I^{SI}(X;Y) I(X;Y)+(1-) H(X,Y).\] (6)

## 4 The Proposed SI2E Framework

In this section, we describe the detailed designs of the proposed SI2E framework, which captures dynamic-relevant state-action representations through structural mutual information (see Section

Figure 2: The SI2E’s overview architecture, including state-action representation learning and maximum structural entropy exploration.

4.1) and enhances state-action coverage conditioned by the agent's policy by maximizing structural entropy (see Section 4.2). The overall architecture of our framework is illustrated in Figure 2.

### State-action Representation Learning

To effectively learn dynamics-relevant state-action representations, we present an innovative embedding principle that maximizes the structural mutual information with subsequent states and minimizes it with current states.

**Structural Mutual Information Principle.** In this phase, the input variables at timestep \(t\) encompass the current observation \(O_{t}\) and the action \(A_{t}\), with the target being the subsequent observation \(O_{t+1}\). We denote the encoding of observations \(O_{t}\) and \(O_{t+1}\) as states \(S_{t}\) and \(S_{t+1}\), respectively. We aim to generate a latent representation \(Z_{t}\) for the tuple \((S_{t},A_{t})\), which preserves information relevant to \(S_{t+1}\) while compressing information pertinent to \(S_{t}\). This embedding process mentioned above is detailed as follows:

\[S_{t}=f_{s}(O_{t}), S_{t+1}=f_{s}(O_{t+1}), Z_{t}=f_{z}(S_{t},A_{t}),\] (7)

where \(f_{s}\) and \(f_{z}\) are the respective encoders for states and state-action pairs (step I. a in Figure 2). For the state-action embeddings \(Z_{t}\), we construct two undirected bipartite graphs, \(G_{zs}\) and \(G_{zs^{}}\), as shown in step I. b of Figure 2. These graphs represent the joint distributions of \(Z_{t}\) with the current states \(S_{t}\) and subsequent states \(S_{t+1}\). In step I. c of Figure 2, we generate \(2\)-layer approximate binary trees for \(G_{zs}\) and \(G_{zs^{}}\) and calculate the mutual information \(I^{SI}(Z_{t};S_{t})\) and \(I^{SI}(Z_{t};S_{t+1})\) using Equation 5. Building upon the Information Bottleneck (IB) (Tishby et al., 2000), we present an embedding principle that aims to minimize \(I^{SI}(Z_{t};S_{t})\) while maximizing \(I^{SI}(Z_{t};S_{t+1})\), as demonstrated in step I. d of Figure 2. When the joint distribution between variables \(Z_{t}\) and \(S_{t+1}\) shows a one-to-one correspondence-meaning for each \(z_{t} Z_{t}\) value, there is a unique \(s_{t+1} S_{t+1}\) corresponding to it, and vice versa-their mutual information takes its maximum value. We introduce a theorem to elucidate the equivalence between \(I^{SI}(Z_{t};S_{t+1})\) and \(I(Z_{t};S_{t+1})\) under this condition.

**Theorem 4.1**.: _For a joint distribution of variables \(X\) and \(Y\) that shows a one-to-one correspondence, \(I^{SI}(X;Y)\) equals \(I(X;Y)\)._

A detailed proof is provided in Appendix B.3. When \(Z_{t}\) and \(S_{t}\) are mutually independent, the mutual information \(I(Z_{t};S_{t})\) attains its minimum value. Our \(I^{SI}(Z_{t};S_{t})\) goes beyond this, incorporating the joint entropy \(H(Z_{t},S_{t})\) according to Theorem 3.4. This integration effectively eliminates the irrelevant information embedded in the representation variable \(Z_{t}\), a significant step in our research. Consequently, structural mutual information can be considered a reasonable and desirable learning objective for acquiring dynamics-relevant state-action representations.

**Representation Learning Objective.** Due to the computational challenges of directly minimizing \(I^{SI}(Z_{t};S_{t})\), we formulate a variational upper bound \(I(Z_{t};S_{t})+H(Z_{t}|S_{t})+H(S_{t})\) (see Appendix C.2). Noting that the term \(H(S_{t})\) is extraneous to our model, we equate the minimization of \(I^{SI}(Z_{t};S_{t})\) to the minimization of \(I(Z_{t};S_{t})\) and \(H(Z_{t}|S_{t})\).

By employing a feasible decoder to approximate the marginal distribution of \(Z_{t}\), we derive an upper bound of \(I(Z_{t};S_{t})\) (See Appendix C.3) as follows:

\[I(Z_{t};S_{t})[p(z_{t},s_{t}) D_{KL}(p(z_{t}|s_{t})||q_{m}(z _{t}))] L_{up}.\] (8)

To concurrently decrease the conditional entropy \(H(Z_{t}|S_{t})\), we introduce a predictive objective (See Appendix C.4) through a tractable decoder \(q_{z|s}\) for the conditional probability \(p(z_{t}|s_{t})\) as follows:

\[H(Z_{t}|S_{t})[p(z_{t},s_{t})(z_{t}|s_{t })}] L_{z|s},\] (9)

where \(L_{z|s}\) represents the log-likelihood of \(Z_{t}\) given \(S_{t}\).

To efficiently optimize \(I^{SI}(Z_{t};S_{t+1})\), we maximize its lower bound, \(I(Z_{t};S_{t+1})\), as detailed in Theorem 3.4. By utilizing an alternative decoder \(q_{s|z}\) for the conditional probability \(p(s_{t+1}|z_{t})\), we obtain a lower bound of \(I(Z_{t};S_{t+1})\) (See Appendix C.5) as follows:

\[I(Z_{t};S_{t+1})[p(z_{t},s_{t+1}) q_{s|z}(s_{t+1}|z_{t}) ] L_{s|z},\] (10)

where \(L_{s|z}\) denotes the log-likelihood of \(S_{t+1}\) conditioned on \(Z_{t}\).

Within our SI2E framework, the definitive loss for representation learning is a combination of the above bounds, \(L=L_{up}+L_{z|s}+ L_{s|z}\), where \(\) is a Lagrange multiplier used to maintain equilibrium among the specified terms.

### Maximum Structural Entropy Exploration

We have designed a unique intrinsic reward mechanism to address the challenge of imbalance exploration towards low-value states in traditional entropy strategies, as discussed by . Specifically, we generate a hierarchical state-action structure based on the agent's policy and define value-conditional structural entropy as an intrinsic reward for effective exploration.

**Hierarchical State-action Structure.** Derived from the history of agent-environment interactions, we extract state-action pairs (step II. a in Figure 2) to form a complete graph \(G_{sa}\) (step II. b in Figure 2) that encapsulates the value relationships caused by the agent's policy. Within this graph, any two vertices \(v_{i}\) and \(v_{j}\) is connected by an undirected edge whose weight \(w_{ij}\) is determined as: \(w_{ij}=||(s^{i}_{t},a^{i}_{t})-(s^{j}_{t},a^{j}_{t})||_{2}\). The state-action pairs \((s^{i}_{t},a^{i}_{t})\) and \((s^{j}_{t},a^{j}_{t})\) are associated with vertices \(v_{i}\) and \(v_{j}\), respectively. We minimize the \(2\)-dimensional structural entropy of this graph \(G_{sa}\) to generate its \(2\)-layer optimal encoding tree, denoted as \(T^{*}_{sa}\) (step II. c in Figure 2). This tree \(T^{*}_{sa}\) delineates a hierarchical community structure among the state-action vertices, with the root node corresponding to a community encompassing all vertices. Each intermediate node in \(T^{*}_{sa}\) corresponds to a sub-community, including vertices that share similar \(\) values.

**Value-conditional Structural Entropy.** To measure the extent of the policy's coverage across the state-action space, we construct an additional distribution graph \(G^{{}^{}}_{sa}\) (step II. d in Figure 2). The graph \(G^{{}^{}}_{sa}\) shares the same vertex set as \(G_{sa}\). The following proposition confirms the existence of such a graph, with a detailed proof provided in Appendix B.4.

**Proposition 4.2**.: _Given positive visitation probabilities \(p(s^{0}_{t},a^{0}_{t}),,p(s^{n-1}_{t},a^{n-1}_{t})\) for all state-action pairs, there exists a weighted, undirected, and connected graph \(G^{{}^{}}_{sa}\), where each vertex's degree \(d_{i}\) equals its visitation probability \(p(s^{i}_{t},a^{i}_{t})\)._

In the graph \(G^{}_{sa}\), the set of all state-action vertices is denoted as \(V_{0}\), and the set of all state-action sub-communities is denoted as \(V_{1}\). The Shannon entropies associated with the distribution of visitation probabilities for these sets are represented as \(H(V_{0})\) and \(H(V_{1})\), respectively, where \(H(V_{0})=H(S_{t},A_{t})\). Within the \(2\)-layer state-action community represented by \(T^{*}_{sa}\), we define the structural entropy of \(G^{}_{sa}\) using Equation 2, denoted as \(H^{T^{*}_{sa}}(G^{}_{sa})\) (step II. e in Figure 2). The following theorem delineates the relationship between the value-conditional entropy \(H^{T^{*}_{sa}}(G^{}_{sa})\) with the state-action Shannon entropy \(H(S_{t},A_{t})\). A detailed proof is provided in Appendix B.5.

**Theorem 4.3**.: _For a tuning parameter \(0 1\), it holds for the structural entropy \(H^{T^{*}_{sa}}(G^{}_{sa})\) and the Shannon entropy \(H(S_{t},A_{t})\) that:_

\[ H(S_{t},A_{t}) H(V_{0})-H(V_{1}) H^{T^{*}_{sa}}(G^{}_ {sa}) H(S_{t},A_{t})\] (11)

where \(H(V_{0})-H(V_{1})\) is a variational lower bound of \(H^{T^{*}_{sa}}(G^{}_{sa})\). On the one hand, the term \(H(V_{0})\) ensures maximal coverage of the entire state-action space, analogous to the traditional Shannon entropy. On the other hand, the term \(H(V_{1})\) mitigates uniform coverage among state-action sub-communities with diverse \(\) values, thus addressing the challenge of imbalance exploration. By identifying the hierarchical state-action structure caused by the agent's policy, the SI2E achieves enhanced maximum coverage exploration, thereby guaranteeing its exploration advantage.

**Estimation and Intrinsic Reward.** Considering the impracticality of directly acquiring visitation probabilities, we employ the \(k\)-NN entropy estimator in Equation 1 to estimate the lower bound:

\[H(V_{0})-H(V_{1})}{n_{0}}_{i=0}^{n_{0}-1} d(v^ {0}_{i})-}{n_{1}}_{i=0}^{n_{1}-1} d(v^{1}_{i})+C,\ \ \ v^{0}_{i} V_{0},v^{1}_{i} V_{1}\] (12)

where \(d_{z}\) is the dimension of state-action embedding, \(n_{0}\) and \(n_{1}\) are the vertex numbers in \(V_{0}\) and \(V_{1}\), and \(d(v)\) is twice the distance from vertex \(v\) to its \(k\)-th nearest neighbor. By ignoring the constant term in Equation 12, we define the intrinsic reward \(r^{i}_{t}\) and train RL agents to address the target task using a combined reward \(r_{t}=r^{e}_{t}+ r^{i}_{t}\) (step II. f in Figure 2), where \(\) is a positive hyperparameter that modulates the trade-off between exploration and exploitation. The pseudocode, complexity analysis, and limitations of our framework are provided in Appendix A.

## 5 Experiments

In this section, we present a comprehensive suite of comparative experiments on MiniGrid [Chevalier-Boisvertt et al., 2018], MetaWorld [Yu et al., 2020], and the DeepMind Control Suite (DMControl) [Tunyasuvunakool et al., 2020] to evaluate the effectiveness of SI2E in terms of both final performance and sample efficiency. Consistent with previous work [Zeng et al., 2023c], we measure the required steps to attain specified rewards (\(0.9\) times SI2E's convergence reward) as a benchmark for assessing sample efficiency. For the SI2E implementation, we employ a randomly initialized encoder optimized to minimize the combined loss \(L\). All experiments are conducted with \(10\) different random seeds, and the learning curves are delineated in Appendix E.

### MiniGrid Evaluation

Initially, we assess our framework on navigation tasks using the MiniGrid benchmark, which includes goal-reaching tasks in sparse-reward environments. This setting is partially observable: the agent receives a \(7 7 3\) embedding of the immediate surrounding grid rather than the entire grid. For comparative purposes, we employ the A2C agent [Mnih et al., 2016] with Shannon entropy (SE) [Seo et al., 2021] and value-based state entropy (VCSE) [Kim et al., 2023] as our baselines. Table 1 (upper) displays the average values and standard deviations of success rates and required steps for various navigation tasks. The tasks encompass navigation with obstacles (SimpleCrossingS9N1), long-horizon navigation (RedBlueDoors, DoorKey, and Unlock), and long-horizon navigation with obstacles (KeyCorridorS3R1). The SI2E consistently exhibits enhanced final performance and sample efficiency across tasks, with an average success rate increase of \(4.92\%\), from \(89.97\%\) to \(94.40\%\), and an average decrease in required steps of \(38.10\%\), from \(635.65K\) to \(393.47K\). In the RedBlueDoors task, where baseline performances are inadequate, our SI2E significantly improves the success rate from \(79.82\%\) to \(85.80\%\) and reduces the required steps from \(1161.90K\) to \(461.90K\).

### MetaWorld Evaluation

We further evaluate the SI2E framework on visual manipulation tasks from the MetaWorld benchmark, which presents exploration challenges due to its large state space. We select the model-free DrQv2 algorithm as the underlying RL methodology. Adhering to the setup of [Seo et al., 2023], we employ the same camera configuration and normalize the reward with a scale of \(1\). We summarize the success rates and required steps for all exploration methods across six MetaWorld tasks in Table 1 (lower).

  MiniGrid &  &  &  \\ Navigation & Success Rate (\%) & Required Step (\(K\)) & Success Rate (\(\%\)) & Required Step (\(K\)) & Success Rate (\(\%\)) & Required Step (\(K\)) \\  A2C & - & - & \(88.18 3.44\) & \(57.08 15.87\) & \(80.57 2.26\) & \(658.74 21.03\) \\ A2C+VCSE & \(79.82 7.26\) & \(161.90 241.59\) & \(93.08 9.614\) & \(87.20 49.50\) & \(463.86 38.27\) \\  A2C+SI2E & \( 1.48\) & \( 61.53\) & \( 1.63\) & \( 27.03\) & \( 0.42\) & \( 6.11\) \\ Abs.(\(\%\)) Avg. & \(5.98(7.49)\) & \(70.00 (60.25)\) & \( 2.34(2.56)\) & \(61.85(31.79)\) & \(\)\(7.00(8.03)\) & \(61.41(32.15)\) \\  MiniGrid & DoorKey-60 & - & DoorKey-60 & - & DoorKey-60 & - &  \\ Navigation & Success Rate (\%) & Required Step (\(K\)) & Success Rate (\%) & Required Step (\(K\)) & Success Rate (\%) & Required Step (\(K\)) \\  A2C & \(92.67 8.47\) & \(567.20 96.57\) & - & \(92.48 11.96\) & \(669.78 154.74\) \\ A2C+VCSE & \(93.18 6.81\) & \(476.34 91.63\) & \(72.60 20.32\) & \(151.81 324.28\) & \(91.34 18.37\) & \(643.37 204.51\) \\ A2C+VCSE & \(94.08 2.58\) & \(336.75 19.84\) & \(94.32 11.09\) & \(1900.96 398.65\) & \(93.12 3.43\) & \(405.22 52.22\) \\  A2C+SI2E & \( 1.52\) & \( 19.85\) & \(\) & \( 125.77\) & \( 3.35\) & \( 53.71\) \\ Abs.(\(\%\)) Avg. & \(26.35 15.76\) & \(16.5(31.52)\) & \(42.4(2.52)\) & \(24.45 28.9(3.63)\) & \(4.01(34.17)\) & \(\)\(96.08(27.1)\) \\  MetaWorld &  &  &  \\ Manipulation & Success Rate (\%) & Required Step (\(K\)) & Success Rate (\%) & Required Step (\(K\)) & Success Rate (\%) & Required Step (\(K\)) \\  DrQv2 & \(94.55 4.64\) & \(105.0 5.0\) & - & - & - & - \\ DrQv2+SE & \(93.05 6.76\) & \(95.0 5.0\) & - & - & \(25.31 7.40\) & - \\ DrQv2+VCSE & \(98.00 2.39\) & \(77.5 2.5\) & \(80.90 10.19\) & - & \(Our SI2E framework enables the DrQv2 agent to solve all tasks with an average success rate of \(97.87\) after an average of \(64.79K\) environmental steps, significantly outperforming other baselines. Specifically, in the Door Open task, all baselines struggle to achieve a meaningful success rate with a satisfactory number of environmental steps. This result demonstrates the SI2E's effectiveness in improving and accelerating agent exploration in challenging tasks with expansive state-action spaces.

### DMControl Evaluation

Subsequently, we evaluate our framework across various continuous control tasks within the DMControl suite. As the foundational agent, we choose the same DrQv2 algorithm, which operates on pixel-based observations. We incorporate a state-action exploration baseline, MADE (Zhang et al., 2021), for a more comprehensive comparison. We evaluate all exploration methods across six continuous control tasks, documenting the episode rewards in Table 2. Observations reveal that SI2E remarkably increases the mean episode reward in each DMControl task. Specifically, in the Cartpole Swingup task characterized by sparse rewards, our framework boosts the average reward from \(707.76\) to \(795.09\), resulting in a \(12.34\%\) improvement in the final performance. Moreover, we compare the sample efficiency of SI2E and the best-performing baseline in Appendix E.3.

These results not only demonstrate the effectiveness of SI2E in acquiring dynamics-relevant representations for state-action pairs but also highlight its potential to motivate agents to explore the state-action space. To better understand the rationality and advantage of the SI2E framework, we provide visualization experiments in Appendix E.4.

### Ablation Studies

To further investigate the impact of two critical components within the SI2E framework, embedding principle (Section 4.1) and intrinsic reward mechanism (4.2), we perform ablation studies on MetaWorld and DMControl tasks, focusing on two distinct variants: (i) SI2E-DB, which utilizes the DB bottleneck (Bai et al., 2021) for learning state-action representations, and (ii) SI2E-VCSE, employing the state-of-the-art VCSE approach (Kim et al., 2023) for calculating intrinsic rewards. As depicted in Figure 3, SI2E surpasses all variants regarding final performance and sample efficiency. This outcome underscores the essential role of these critical components in conferring SI2E's superior capabilities. Additional ablation studies for the parameters \(\) and \(n\) are available in Appendix E.5.

## 6 Related Work

### Maximum Entropy Exploration

Maximum entropy exploration has evolved from focusing initially on unsupervised methods to incorporating task rewards in more advanced supervised models. In the unsupervised paradigm,

  Domain, Task & Hopper Stand & Cheetah Ran & Quadruped Walk & Pendulum Swingup & Cartpole Balance & Cartpole Swingup \\   & \(78.93 17.170\) & \(229.28 12.933\) & \(289.79 24.21\) & \(422.21 26.96\) & \(989.87 22.95\) & \(219.69 62.21\) \\  & \(313.39 91.15\) & \(228.22 12.21\) & \(209.27 24.20\) & \(10.80 2.92\) & \(993.80 75.24\) & \(219.69 62.21\) \\  & \(711.32 30.84\) & \(456.29 22.20\) & \(234.73 29.91\) & \(824.21 95.95\) & \(998.65 9.58\) & \(702.76 50.38\) \\  & \(71.09 112.94\) & \(366.99 35.74\) & \(262.63 23.92\) & \(672.11 34.63\) & \(996.16 40.60\) & \(701.18 41.75\) \\  & \( 53.21\) & \( 29.32\) & \( 29.05\) & \( 33.28\) & \( 2.97\) & \( 90.49\) \\  Abs.(\%) Avg. \(\) & \(80.08(11.17)\) & \(7.82(1.71)\) & \(109.24(37.63)\) & \(61.33(7.44)\) & \(0.93(0.09)\) & \(87.33(12.34)\) \\  

Table 2: Summary of average episode rewards for control tasks in DMControl, encompassing two cartpole tasks characterized by sparse rewards: “average value \(\) standard deviation” and “average improvement” (absolute value(\(\%\))). **Bold**: the best performance, underline: the second performance.

Figure 3: Learning curves across MetaWorld and DMControl tasks for ablation studies.

agents autonomously acquire behaviors by using state entropy as an intrinsic reward for exploration (Liu and Abbeel, 2021; Mutti et al., 2022; Yang and Spaan, 2023). In contrast, in the supervised paradigm, agents aim to maximize state entropy in conjunction with task rewards (Seo et al., 2021; Yuan et al., 2022).

However, these methods face challenges due to imbalances in the distributions of states with differing policy values. To address this issue, a value-based approach (Kim et al., 2023) has been proposed, which integrates value estimates into the entropy calculation to ensure balanced exploration. Nevertheless, the effectiveness of this approach heavily depends on the partitioning structure of states according to policy values, requiring prior knowledge about downstream tasks.

In this work, we leverage structural information principles to derive the hierarchical state-action structure in an unsupervised manner. We further define the value-conditional structural entropy as an intrinsic reward to achieve more effective agent exploration. Compared to current maximum entropy explorations, SI2E introduces an additional sub-community entropy and minimizes this entropy to motivate the agent to explore specific sub-communities with high policy values. This approach helps avoid redundant explorations within low-value sub-communities and achieves enhanced maximum coverage exploration. Our method allows for balanced exploration without requiring prior knowledge of downstream tasks, effectively addressing the limitations of previous approaches.

### Representation Learning

Novelty Search (Tao et al., 2020) and Curiosity Bottleneck (Kim et al., 2019) leverage the Information Bottleneck principle for effective representation learning. Additionally, the EMI method (Kim et al., 2019) maximizes mutual information in both forward and inverse dynamics to develop desirable representations. However, these methods are limited by the lack of an explicit mechanism to address the white noise issue in the state space. To overcome this challenge, the Dynamic Bottleneck model (Bai et al., 2021) is introduced for robust exploration in complex environments.

Our work defines structural mutual information to measure the structural similarity between two variables for the first time. Additionally, we present an innovative embedding principle that incorporates the entropy of the representation variable. This approach more effectively eliminates irrelevant information than the traditional information bottleneck principle.

### Structural Information Principles

Since the introduction of structural information principles (Li and Pan, 2016), these principles have significantly transformed the analysis of network complexities, employing metrics such as structural entropy and partitioning trees. This innovative approach has not only deepened the understanding of network dynamics--even in the context of multi-relational graphs (Cao et al., 2024)--but has also led to a wide array of applications across different domains. The application of structural information principles has extended to various fields, including graph learning (Wu et al., 2022), skin segmentation (Zeng et al., 2023), and the analysis of social networks (Peng et al., Zeng et al., 2024; Cao et al., 2024). In the domain of reinforcement learning, these principles have been instrumental in defining hierarchical action and state abstractions through encoding trees (Zeng et al., 2023, 20), marking a significant advancement in robust decision-making frameworks.

## 7 Conclusion

We propose SI2E, a novel exploration framework based on structural information principles. This framework defines structural mutual information to effectively capture state-action representations relevant to environmental dynamics. It maximizes the value-conditional structural entropy to enhance coverage across the state-action space. We have established theoretical connections between SI2E and traditional information-theoretic methodologies, underscoring the framework's rationality and advantages. Through extensive and comparative evaluations, SI2E significantly improves final performance and sample efficiency over state-of-the-art exploration methods. Our future work includes expanding the height of encoding trees and the range of experimental environments. Our goal is for SI2E to remain a robust and adaptable tool in reinforcement learning, particularly suited to high-dimensional and sparse-reward contexts.