# Contrastive dimension reduction: when and how?

Sam Hawke

Department of Biostatistics

University of North Carolina at Chapel Hill

shawke@unc.edu

&YueEn Ma

Department of Statistics & Operations Research

University of North Carolina at Chapel Hill

myueen@unc.edu

&Didong Li

Department of Biostatistics

University of North Carolina at Chapel Hill

didongli@unc.edu

###### Abstract

Dimension reduction (DR) is an important and widely studied technique in exploratory data analysis. However, traditional DR methods are not applicable to datasets with a contrastive structure, where data are split into a foreground group of interest (case or treatment group), and a background group (control group). This type of data, common in biomedical studies, necessitates contrastive dimension reduction (CDR) methods to effectively capture information unique to or enriched in the foreground group relative to the background group. Despite the development of various CDR methods, two critical questions remain underexplored: when should these methods be applied, and how can the information unique to the foreground group be quantified? In this work, we address these gaps by proposing a hypothesis test to determine the existence of contrastive information, and introducing a contrastive dimension estimator (CDE) to quantify the unique components in the foreground group. We provide theoretical support for our methods and validate their effectiveness through extensive simulated, semi-simulated, and real experiments involving images, gene expressions, protein expressions, and medical sensors, demonstrating their ability to identify the unique information in the foreground group.1

## 1 Introduction

High-dimensional datasets are ubiquitous in the era of big data, arising from applications such as image data (Shorten and Khoshgoftaar, 2019), gene/protein expressions (Bhola and Singh, 2018), and medical data from wearable devices (Cho et al., 2021; Banaee et al., 2013), to name a few. Dimension reduction (DR) is crucial in these contexts for various reasons (Fan et al., 2014): improving data visualization, reducing computational cost for downstream analysis (Fan and Li, 2006), minimizing noise (Thudumu et al., 2020), and enhancing interpretability (Johnstone and Titterington, 2009).

DR has been a vibrant research area for several decades, leading to the development of numerous methods (Ayesha et al., 2020). Principal component analysis (PCA, Hotelling (1933)), for instance, maximizes the variance in the reduced space and is widely applied across different domains (Jirsa et al., 1994; Novembre and Stephens, 2008; Pasini, 2017). Other methods, such as Multi-Dimensional Scaling (MDS, Torgerson (1952)) and Isomap (Tenenbaum et al., 2000), focus on preserving pairwise Euclidean and geodesic distances between samples, respectively. Probabilistic PCA (PPCA, Tipping and Bishop (1999)) incorporates uncertainty quantification through a probabilistic model. Additionally,techniques such as t-distributed Stochastic Neighborhood Embedding (tSNE, Van der Maaten and Hinton (2008)) and Uniform Manifold Approximation (UMAP, McInnes et al. (2018)), preserve the local probability distribution and manifold topological structure in the data, respectively.

In recent years, a new type of data has garnered attention, particularly in biomedical research involving case-control studies. Here, data are divided into a foreground group (case or treatment group) and a background group (control group). The objective is to identify low-dimensional representations unique to or enriched in the foreground group. This scenario necessitates contrastive dimension reduction (CDR) methods. For example, in a benchmark dataset for CDR on mouse protein expressions (Higuera et al., 2015), the foreground group consists of mice who received a shock therapy, while the background group includes mice that did not. The goal is to isolate the protein expression patterns unique to the foreground group, i.e., the shocked mice.

To address this problem, several CDR methods have been developed. For example, Contrastive PCA (CPCA, Abid et al. (2018)) extends PCA by maximizing the variation in the foreground while minimizing variation in the background. Additionally, Probabilistic Contrastive PCA (PCPCA, Li et al. (2020)) generalizes both CPCA and PPCA by incorporating a probabilistic model into the contrastive setting, enabling statistical inference. Furthermore, the Contrastive Latent Variable Model (CLVM, Severson et al. (2019)) introduces latent variables specifically designed for this contrastive setting. Moreover, the Contrastive Variational Autoencoder (CVAE, Abid and Zou (2019)) and Contrastive Variational Inference (CVI, Weinberger et al. (2023)) both leverage deep learning approaches to detect nonlinear patterns in the data. Collectively, these methods aim to isolate patterns unique to the foreground data relative to the background. These methods have been successful with a variety of datasets, identifying patterns that are often scientifically meaningful and opening doors to new scientific discoveries. For example, studies using these methods on mouse protein expression data have successfully identified subgroup structures, such as distinguishing between mice with and without Down Syndrome, and highlighted key proteins responsible for these differences. We reference various applications and discoveries using these methods in section 6 and appendix D.

Despite the development of these CDR methods, two critical questions remain underexplored: when should these CDR methods be applied, and how many unique components exist in the foreground group? The first question can be reframed as follows: given foreground and background groups, can we determine whether there exists unique information in the foreground group? The second question pertains to estimating the number of unique representations to the foreground, termed contrastive dimension in this paper. This is a counterpart of the intrinsic dimension estimation problem, with a rich literature (Camastra and Staiano, 2016; Levina and Bickel, 2004), but in the contrastive context.

In this paper, we answer the first question by proposing a hypothesis test to determine the existence of unique information in the foreground data. To answer the second question, we introduce the rigorous notion of contrastive dimension and provide a consistent estimator of this quantity. We provide theoretical support of our methods and validate their effectiveness through extensive simulated, semi-simulated, and real experiments involving images, gene expressions, protein expressions, and medical sensors.

The rest of the paper is organized as follows. In section 2, we provide more background on CDR methods and present our definition of contrastive dimension. In section 3, we present our solutions to the above questions: a hypothesis test and an estimator for the contrastive dimension. In section 4, we prove the consistency of our proposed estimator of the contrastive dimension and establish a finite-sample error bound. We demonstrate the effectiveness of the methods on simulated and semi-simulated data in section 5 and real data in section 6. Finally, in section 7, we discuss the strengths and weaknesses of our methods and identify potential directions for further study.

## 2 Background

In this section, we introduce our notations and provide a more detailed overview of various existing CDR methods. Throughout this paper, we denote the foreground data as \(X=\{x_{1},,x_{n_{x}}\}^{p}\) with dimension \(p\) and sample size \(n_{x}\), and background data as \(Y=\{y_{1},,y_{n_{y}}\}^{p}\) with the same dimension \(p\) but potentially different sample size \(n_{y}\). We do not make any assumptions on the ratio of sample sizes between groups, \(n_{x}:n_{y}\). For simplicity, we also assume each dataset is centered separately. Next, we briefly overview some existing CDR methods.

**Contrastive Principal Component Analysis (CPCA).** CPCA (Abid et al., 2018) was proposed to uncover the low-dimensional structure that is unique to the foreground data \(X\) relative to the background data \(Y\). Taking one-dimensional CPCA as an example, the objective is to find a direction, represented by a unit vector \(v^{p}\), that explains more variance in the foreground among all directions, and less variance in the background. Let \(C_{X}=}_{i=1}^{n_{x}}x_{i}x_{i}^{}\) and \(C_{Y}=}_{j=1}^{n_{y}}y_{j}y_{j}^{}\) be the sample covariance matrices of two datasets. Then, CPCA solves the following optimization problem:

\[*{argmax}_{\|v\|=1}\,v^{}C_{X}v- v^{}C_{Y}v= *{argmax}_{\|v\|=1}\,v^{}Cv,\]

where \([0,]\) is a tuning parameter, called the contrastive parameter, and \(C=C_{X}- C_{Y}\) is called the contrastive covariance matrix. The optimal \(v\) is simply the top eigenvector of \(C\). When \(=0\), CPCA coincides with PCA, and when \(=\), CPCA finds the direction that explains the least variance in the background group.

**Contrastive Latent Variable Model (CLVM).** CLVM (Severson et al., 2019) is a latent variable model, similarly proposed to discover patterns enriched in the foreground group \(X\):

\[x_{i}=Sz_{i}+Wt_{i}+_{i},\;y_{j}=Sz_{j}+_{j},\]

where \(z_{i},z_{j}^{k}\) and \(t_{i}^{t}\) are the latent variables, and \(_{i},_{j}^{p}\) are the noise terms. The factor loading \(S^{p k}\) represents the space shared between the foreground and background groups, while the factor loading \(W^{p t}\) represents the space unique to the foreground group. The primary goal of CLVM is to identify W, which represents the foreground-specific information.

**Probabilistic Contrastive Principal Component Analysis (PCPCA).** PCPCA (Li et al., 2020) was proposed as a probabilistic model to extend CPCA, allowing for uncertainty quantification:

\[x=Wz_{x}+_{x},y=Wz_{y}+_{y},\]

where \(W\) represents the factor loading, and \(_{x},_{y}\) are noise terms. However, PCPCA utilizes an unconventional strategy for estimating \(W\). Instead of maximizing the joint likelihood, which would be appropriate if the foreground and background groups are assumed to share the same space, the PCPCA objective is to maximize \(}\), where \([0,]\) is the contrastive hyperparameter, as in CPCA. When \(=0\), PCPCA reduces to Probabilistic PCA (Tipping and Bishop, 1999) on the foreground data, while PCPCA reduces to CPCA as the noise level goes to zero.

**Contrastive VAE (CVAE).** CVAE (Abid and Zou, 2019) considers a broadened view of the data-generating process, in which the foreground data \(X\) follows an arbitrary probability distribution \(f\) with unknown parameters \(\), conditional on salient variables \(s\) and irrelevant variables \(z\). The background data \(Y\) are assumed not to have the salient variables, as the CVAE model is given by

\[x_{i} f_{}(|s_{i},z_{i}),\;y_{j} f_{}(|0,z_{j}^{ }).\]

The problem here is to learn the parameters \(\) of \(f\), which CVAE does by training two probabilistic encoders \(q_{_{s}}(s|x)\) and \(q_{_{s}}(z|x)\) (salient and irrelevant) to infer \(s\) and \(z\), respectively, from the observed features, and a decoder network \(f_{}()\) which reconstructs the original samples from \(x=[s,z]\) in the foreground data, or \(y=[0,z^{}]\) in the background data.

**Contrastive Variational Inference (CVI).** CVI was proposed in Weinberger et al. (2023) specifically for the purpose of disentangling the split between treatment and control groups for single-cell data. To this end, CVI posits a data-generating process with latent variables \(z_{n}\), representing shared information between the two groups, and \(t_{n}\), representing information unique to the foreground group. Each gene expression in each sample of the foreground group is assumed to follow a generative process depending on \(z_{n}\) and \(t_{n}\) (both with \((0,I)\) priors), but in the background group \(t_{n}=0\) is assumed, similarly to CVAE. The posterior distribution of CVI is analytically intractable, so it is approximated using variational inference.

Each of the methods above has a similar goal: to discover variation unique to the foreground group relative to the background. However, none of these methods enables detection of whether there exists such variation at all. Additionally, for each method, the assumed reduced dimension (or number of latent features unique to the foreground) was treated as a tuning parameter required as input to run the method, without an easy-to-implement method to choose such a dimension.

Motivated by this gap, we consider the following linear model:

\[x_{i}=z_{i}+_{i},\;y_{j}=w_{j}+_{j},\;i=1,,n_{x}, \;j=1,,n_{y} \]where \(z_{i} V_{x}\), \(w_{j} V_{y}\) for some low-dimensional linear subspaces \(V_{x},V_{y}^{p}\), and \(_{i},_{j}\) represent the noise. We let \(x\) represent foreground and \(y\) represent background.

However, defining and identifying the information that is truly unique to the foreground requires a more rigorous approach. For example, in CLVM, even if we estimate a nonzero \(W\), it may not present information unique to the foreground if \(S\) and \(W\) are not appropriately distinguished. This motivates the need for a precise definition of the contrastive subspace and contrastive dimension:

**Definition 1**.: _Under the above notation, we define the contrastive subspace to be \(V_{xy}_{V_{y}^{}}(V_{x})\) and the contrastive dimension, denoted by \(d_{xy}\), to be the dimension of the contrastive subspace: \(d_{xy}(V_{xy})\)._

The rationale of our definition is that the contrastive subspace contains the information unique to the foreground data, guaranteed by the projection to \(V_{y}^{}\), the orthogonal complement of \(V_{y}\). In order to determine the existence of unique information in the foreground group, it is desirable to have a hypothesis test for testing \(H_{0}:d_{xy}=0\) versus \(H_{1}:d_{xy}>0\). Furthermore, an estimator for \(d_{xy}\) is valuable for providing a suggestion to use for the reduced dimension parameter in the CDR models presented above.

**Remark 1**.: _Based on model 1 and definition 1, \(V_{x} V_{y}\) is equivalent to \(d_{xy}=0\)._

**Remark 2**.: _Even a minute departure of \(V_{x}\) from \(V_{y}\) results in a nonzero \(d_{xy}\)._

Because we are interested in detecting where the foreground differs from the background, we allow our framework to detect even a small departure of \(V_{x}\) from \(V_{y}\), although a bigger departure will be easier to detect. This motivates our study of the principal angle between \(V_{x}\) and \(V_{y}\) in section 3.

It is worth noting that the new tasks we are proposing, namely determining whether there is unique information in the foreground group and quantifying how much, depart from the traditional CDR task of estimating the space representative of such unique information, assuming it exists. In this paper, we focus on our solution to these new tasks, starting with manageable assumptions about the data.

## 3 Methods

In this section, we present our methods to address the questions of whether there exists unique information in the foreground group and how many dimensions there are unique to the foreground group. First, we detail the hypothesis test of \(H_{0}:d_{xy}=0\) versus \(H_{1}:d_{xy}>0\). We introduce a contrastive version of the bootstrap resampling scheme, based on the null assumption that \(d_{xy}=0\), which is equivalent to the assumption of \(V_{x} V_{y}\). Next, we introduce the CDE of \(d_{xy}\). In both methods, we make the very reasonable sample size assumptions that \(n_{x}>d_{x}\) and \(n_{y}>d_{y}\), as many existing studies have observed a small intrinsic dimension (Pope et al., 2021). The inference in both of these problems is based on the notion of principal angles between two linear subspaces (Ye and Lim, 2016):

**Definition 2**.: _Let \(U\) and \(V\) be two subspaces of \(^{p}\) with dimensions \(d_{1}\) and \(d_{2}\), then the principal angles, denoted by \(_{i}(U,V)\), \(i=1,,(d_{1},d_{2})\) are defined recursively as follows_

\[(_{i}(U,V))=_{u_{i} U,v_{i} V,\|u_{i}\|=\|v_{i}\|=1,u_{i}^{ }u_{j}=v_{i}^{}v_{j}=0, j<i}u_{i}^{}v_{i}\]

To be clear, the \(u_{i}\) and \(v_{i}\) solving the maximization problem are not uniquely defined; however, the principal angles \(_{i}\) are uniquely defined. The principal angles measure the "difference" between two subspaces. For instance, if two spaces coincide, all principal angles are zero; when two spaces are orthogonal to each other, all principal angles are \(/2\). If \(U_{0}\) and \(V_{0}\) are orthogonal matrices spanning \(U\) and \(V\), respectively, then the calculation of the principal angles is given by the following equation

\[(_{i}(U,V))=_{i}(U_{0}^{}V_{0}), \]

where \(_{i}()\) denotes the \(i\)-th singular value of a matrix. As a result, we adopt this notion to study the relation between \(V_{x}\) and \(V_{y}\) for our purposes.

### Hypothesis test

We develop a hypothesis test for testing \(H_{0}:d_{xy}=0\) versus \(H_{1}:d_{xy}>0\) under the version of model 1 with the following assumptions,

\[x_{i}=S_{x}z_{i}+_{i},\;y_{j}=S_{y}w_{j}+_{j}, \]

where \(S_{x}^{p d_{x}}\) and \(S_{y}^{p d_{y}}\) are full rank, \(z_{i}_{d_{x}}(0,I)\), \(w_{i}_{d_{y}}(0,I)\), \([_{i}]=[_{j}]=0\), \((_{i})=_{x}^{2}I\), and \((_{j})=_{y}^{2}I\).

First, we assume \((d_{x},d_{y})<p/2\), which is a very weak assumption given that \(p\) is often much bigger than the intrinsic dimension in high-dimensional datasets.

**Remark 3**.: _With model 1, we do not make any assumptions the relations between intrinsic dimensions \(d_{x}\) and \(d_{y}\). However, by definition 1, \(d_{x}>d_{y}\) implies that \(d_{xy}>0\), indicating that there must be some unique information in the foreground space. Therefore, for our hypothesis test, we focus on the more challenging but important case of \(d_{x} d_{y}\)._

An equivalent formulation of the null and alternative hypotheses in this model is \(H_{0}:(S_{x})(S_{y})\) versus \(H_{1}:(S_{x})(S_{y})\), where \(()\) denotes the column space of a matrix. Motivated by the assumption that \(V_{x} V_{y}\) under \(H_{0}\), we draw a sample of size \(n_{x}\) with replacement from \(\{x_{1},,x_{n_{x}}\}\), and we draw a sample of size \(n_{y}\) with replacement from \(\{x_{1},,x_{n_{x}},y_{1},,y_{n_{y}}\}\). We repeat this bootstrap procedure \(B\) (\(B=1000\) throughout this paper) times and compare the largest angle between \(_{x}\) and \(_{y}\) in the original data with the distribution of the largest angles between those subspaces in the resampled data. The exact calculation is deferred to section 3.2.

```
Input: Foreground \(\{x_{i}\}_{i=1}^{n_{x}}\), Background \(\{y_{j}\}_{j=1}^{n_{y}}\), dimensions \(d_{x} d_{y}\), bootstrap parameter \(B\) Output: p-value for test of \(H_{0}:V_{x} V_{y}\) in model 1
1\(_{1}_{1}(x,y,d_{x},d_{y})\) ; // Compute as in Algorithm 2
2for\(b=1\)to\(B\)do
3\(x_{*}\) sample with repl.\((x,n_{x})\) ; // Resample foreground
4\(y_{*}\) sample with repl.\((\{x,y\},n_{y})\) ; // Resample background, pooled
5\(_{b}^{*}_{1}(x_{*},y_{*},d_{x},d_{y})\) ; // Compute as in Algorithm 2
6\(p^{*}<_{1}\}}{B}\) return\(p\)
```

**Algorithm 1**Contrastive Bootstrap Hypothesis Test

We demonstrate with simulations in section 5 that this hypothesis test produces conservative results, and in section 7 we discuss a potentially more powerful likelihood-based alternative. Additionally, this hypothesis test requires as input intrinsic dimension estimates for \(d_{x}\) and \(d_{y}\), for which there exists a rich literature with a variety of sophisticated methods (Campadelli et al., 2015). This conservatism is designed to reduce the likelihood of false positives, but it can also lead to some signals not being detected by the hypothesis test. One explanation for this phenomenon could be that the test's resampling technique might not handle nonlinear structures in the data effectively (e.g. if the data lie on a nonlinear manifold). Because \(V_{x}\) and \(V_{y}\) are assumed to be linear subspaces, a nonlinear pattern can obscure the differences the test is designed to detect.

### Contrastive dimension estimator (CDE)

We start from the following lemma to link our target, \(d_{xy}\), and principal angles between \(V_{x}\) and \(V_{y}\).

**Lemma 1**.: \(d_{xy}=(_{V_{y}^{}}V_{x})=\#\{i:_{i}(V_{x},V_{y})> 0\}+(d_{x}-d_{y},0)\)_._

As a result, to construct an estimator of \(d_{xy}\), it suffices to estimate \(V_{x}\), \(V_{y}\), and calculate the corresponding principal angles. Based on eq. (1), \(V_{x}\) and \(V_{y}\) consist of the top \(d_{x}\) and \(d_{y}\) eigenvectors of \(_{x}\) and \(_{y}\), respectively, which can be estimated by sample covariance matrices \(_{x}}_{i=1}^{n_{x}}x_{i}x_{i}^{}\) and \(_{y}}_{j=1}^{n_{y}}y_{j}y_{j}^{}\). Thus, we propose the following estimator:

\[_{xy}\#\{i:_{i}(_{1:d_{x}} (_{x}),_{1:d_{y}}( _{y}))>\}+(d_{x}-d_{y},0), \]where \(>0\) is a small toleration due to randomness from finite samples, and \(_{1:d}\) refers to the span of the first \(d\) eigenvectors. Let \(_{x}_{1:d_{x}}(_{x})\) and \(_{y}_{1:d_{y}}(_{y})\), by eq. (2), we have \(_{i}(_{i})=_{i}(_{x}^{}_{y})\), leading to algorithm 2.

```
Input: Foreground \(\{x_{1},,x_{n_{x}}\}\), Background \(\{y_{1},,y_{n_{y}}\}\), dimensions \(d_{x}\), \(d_{y}\), tolerance \(\) Output:\(_{xy}\)
1\((_{x},_{y})(n_{x}^{-1}_{i=1}^{n_{ x}}x_{i}x_{i}^{},\ n_{y}^{-1}_{i=1}^{n_{y}}y_{i}y_{i}^{})\) ; // Compute sample covariances
2\((_{x},_{y})(_{1:d_{x}}( _{x}),_{1:d_{y}}(_{y}))\) ; // Compute sample eigenvectors
3\(UDV^{}_{x}^{}_{y}\) ; // SVD
4\((_{1},,_{\{d_{x},d_{y}\}}) (D)\) ; // Singular values
5\(_{xy}\#\{j:_{j}<1-\}+(d_{x}-d _{y},0)\) return\(_{xy}\)
```

**Algorithm 2**Contrastive Dimension Estimator

Note that algorithm 2 takes intrinsic dimensions \(d_{x}\) and \(d_{y}\) as input. In practice, the user must choose a method to estimate the intrinsic dimension of both the foreground and background datasets. This flexibility allows for the incorporation of different intrinsic dimension estimators to complement our approach (Bac et al., 2021; Pope et al., 2021).

Some users may only be interested in estimating the contrastive dimension \(_{xy}\) and not in the hypothesis test for \(d_{xy}=0\). These users can skip the hypothesis testing step. However, the hypothesis test offers a direct way to assess uncertainty, guiding users on whether it is worthwhile to proceed with contrastive dimension reduction methods.

In the next section, we study the asymptotic and finite-sample behavior of this estimator \(_{xy}\).

## 4 Consistency and finite sample error bound

In this section, we provide theoretical support for the estimator \(_{xy}\) presented above, first by establishing its consistency, and then by constructing a finite-sample error bound for it.

**Theorem 1**.: _Assume that the second moments \(_{x}\) and \(_{y}\) are finite for both groups, and that the top \(d_{x}+1\) eigenvalues of \(_{x}\) and top \(d_{y}+1\) eigenvalues of \(_{y}\) are distinct. Then, our proposed estimator \(_{xy}\) is consistent: \(_{xy}[n_{x}]{n_{y}}d_{xy}\)._

The assumption of distinct eigenvalues is common in the literature (Vershynin, 2018) and ensures the identifiability of eigenvectors for each covariance matrix. Because we are interested in convergence to the space spanned by the top eigenvectors, rather than individual eigenvectors themselves, this assumption might be relaxed to the eigengap assumption that the \(d_{x}\)th and \((d_{x}+1)\)th eigenvalues of \(_{x}\) are distinct, and that the \(d_{y}\)th and \((d_{y}+1)\)th eigenvalues of \(_{y}\) are distinct. See section 7 for more discussion.

To describe the finite sample error bound, we recall that \(U_{x}\) and \(U_{y}\) are spanned by the top \(d_{x}\) and \(d_{y}\) eigenvectors of \(_{x}\) and \(_{y}\), respectively, and singular values of \(W U_{x}^{}U_{y}\), denoted by \(_{i}=_{i}(W),i=1,,m\), where \(m=(d_{x},d_{y})\), are the cosines of principal angles between \(U_{x}\) and \(U_{y}\). In practice, estimating the contrastive dimension as an integer can be somewhat restrictive for providing a finite sample error bound. Instead, we report the singular values to account for more uncertainty and provide a more nuanced understanding. Thus, we present the following finite sample error bound (and hence the convergence rate) of these estimated singular values rather than \(_{xy}\).

**Theorem 2**.: _In addition to all assumptions in theorem 1, we assume \(x\) and \(y\) in model 1 are sub-Gaussian. More precisely, assume that there exist constants \(K_{x},K_{y} 1\) such that_

\[\| x,v\|_{_{2}} K_{x}[ x,v^{2}]\| y,v\|_{_{2}}  K_{y}[ y,v^{2}]v ^{p}\]_where \(\|\|_{_{2}}\) is defined as in Section 3.4 of Vershynin (2018). Then, for any \(u>0\), with probability at least \(1-2e^{-u}\), we have_

\[_{j=1,,m}|_{j}-_{j}| C_{k \{x,y\}}}_{k}^{-1}K_{k}^{2}(}}+ })\|_{k}\|=O(n_{x}^{-1/2}+n_{y}^{-1/2}) \]

_where \(C\) is an absolute, positive constant, \(_{}\) is the minimum eigengap among the top \(d_{}+1\) eigenvalues of \(_{}\), and \(\|\|\) denotes spectral norm._

To show the finite sample error bound, we need the sub-Gaussianity assumption to ensure that the tails of the distribution are not too heavy. This assumption is also common and encompasses a large class of distributions (Vershynin, 2018).

Having established the theoretical support for the estimator, in the next section we focus on applying our methods to simulated data.

## 5 Simulations

To demonstrate the validity of our methods in practice, we apply them to four simulations for different purposes. The first two examples are purely simulated, fully under our control, with \(d_{xy}=0\) for the first one and \(d_{xy}>0\) for the second one. Because these first two simulations are purely synthetic, we repeat them both 100 times and report the means and standard deviations of the \(p\)-value, \(_{xy}\), and the four smallest singular values. The third simulation steps away from the ground truth being completely known by combining synthetic image data with known dimension, with real, grassy noise image data, elucidating the methods' performance in an interpretable setting. The final simulation is a variation on the third one, in which the synthetic data are replaced with MNIST images (Deng, 2012).

We describe the experimental settings of the simulations in more detail below and present results, including the \(p\)-value from our test \(_{xy}\), and the smallest four singular values, as shown in Table 4. We denote the estimates with a hat, if needed. In all these examples, the threshold is \(=0.1\).

We do not compare \(_{xy}\) with other estimators of contrastive dimension because, to our knowledge, no such estimators have been proposed in the literature.

**Simulation 1.** In this first simulation, we generate data from the specific case of model (3) with variance \(_{x}^{2}=_{y}^{2}=0.25\), \((S_{x})(S_{y})\) such that \(d_{xy}=0\), \(n_{x}=n_{y}=100\). Because \(d_{xy}=0\) is the assumption of \(H_{0}\) for the hypothesis test in Section 3, we repeat this simulation 100 times to empirically demonstrate the conservative type I error rate (defined by the proportion of \(p\)-values below \(\)) versus pre-specified \((0,1)\). We also repeat this simulation but with \(n_{x}=n_{y}=200\), and we present both plots of empirical type I error rate in Figure 1.

As shown in the first row of Table 4, both \(_{xy}\) and the \(p\)-value agree, on average, with the ground truth that \(d_{xy}=0\), showing that in this simulated setting, our methods do not erroneously detect a signal when there is none. However, given that the average smallest singular value value observed is \(0.901\), this simulation suggests that it may be prudent to use a choice of \(\) greater than \(0.1\), i.e. a cutoff for the singular value that is below \(0.9\). The standard deviation for \(_{xy}\) among the 100 replications is \(0.52\), which also suggests that a lower cutoff may be appropriate. The standard deviation of the \(p\)-value is \(0.153\), and of each of the smallest singular values is \(0.025\), \(0.013\), \(0.009\), and \(0.007\), respectively. Both plots of observed type I error in Figure 1 demonstrate that, in this setting, the hypothesis test is conservative. We discuss a more powerful potential alternative in Section 7.

  
**Setup** & \(d_{x}\) & \(d_{y}\) & \(d_{xy}\) & **p-value** & \(_{xy}\) & **4 smallest singular values** \\  Simulation 1 & 6 & 8 & 0 & 0.814 & 0.44 & 0.901, 0.939, 0.961, 0.975 \\ Simulation 2 & 6 & 8 & 6 & 0.029 & 6 & **0.059**, **0.106**, **0.159**, **0.215** \\ Sim. 3: Disk + Line & 4 & \(\) & 1 & 0.000 & 1 & **0.490**, 0.975, 0.981, 0.988 \\ Sim. 4: MNIST + Line & \(\) & \(\) & 1 & 0.000 & 1 & **0.407**, 0.904, 0.955, 0.975 \\   

Table 1: Summary of simulation results

**Simulation 2.** The only difference from Simulation 1 is that \(d_{xy}=6\). Because the singular values were all well below the cutoff of \(0.9\), the standard deviation of \(_{xy}\) among the 100 trials was \(0\); every trial achieved the correct estimate. Our hypothesis test produced a small \(p\)-value of \(0.029\) on average (standard deviation \(0.029\)), which at a significance level of \(=0.05\) leads one to the correct conclusion of rejecting \(H_{0}\) and concluding that \(d_{xy}>0\). Moreover, the six smallest singular values are \(0.059,0.106,0.159,0.215,0.279,0.367\) (standard deviations \(0.023\), \(0.028\), \(0.032\), \(0.034\), \(0.038\), and \(0.050\), respectively), all well below the threshold of \(0.9\), illustrating that CDE correctly identifies \(6\) directions unique to the foreground data.

**Simulation 3.** It is also useful to evaluate the performance of our methods on datasets where the ground truth is only partially known. So, in this simulation, we construct a semi-synthetic image dataset by generating 5000 disks of random centers \((c_{x},c_{y})\{5,,24\}^{2}\) and radii \(r\{1,,10\}\) uniformly, in the \(28\) by \(28\) grayscale pixel space.

Of these 5000 images, we draw a white line of random length beginning at the leftmost pixel of the sixth row on 2500 images to create the foreground (Fig. 2A). As a result, \(d_{x}=4\), parameterized by \(c_{x},c_{y},r\), and length of line. For background, we superimpose the remaining 2500 images on grass images as noise (Fig. 2B) so that \(d_{y}>d_{x}\). Although \(d_{y}\) is not known, \(d_{xy}\) is known to be one (the unique parameter being the length of the line). Here, we used the method of moments estimator (Amsaleg et al., 2018), leading to \(_{y}=20\).

Our method only gives one singular value (\(0.529\)) below the cutoff of \(0.9\), leading to a correct estimate of \(_{xy}=1\). Additionally, our hypothesis test produces a \(p\)-value of \(0\), which suggests to reject \(H_{0}\) in favor of \(H_{1}:d_{xy}>0\). This simulation illustrates that our methods produce favorable results when one of the groups has an estimated intrinsic dimension.

**Simulation 4.** To assess our methods in a simulation setting where both \(d_{x}\) and \(d_{y}\) are unknown, we consider a very similar simulation to the previous one, but where we start with 5923 handwritten 0's from the MNIST dataset (Deng, 2012) instead of randomly generated disks. We further randomly split them into two sets, to create foreground by adding lines (Fig. 2C), and background by imposing on grass images (Fig. 2D), leading to the corrupted MNIST data proposed in Abid et al. (2018). Using method of moments, \(_{x}=11\) and \(_{y}=14\). Crucially, the contrastive dimension \(d_{xy}=1\) is still known, allowing us to assess the results of our methods when \(d_{x}\) and \(d_{y}\) are both unknown.

CDE again accurately estimates exactly one singular value (\(0.256\)) below the cutoff of \(0.9\), leading to a correct estimate of \(_{xy}=1\). Furthermore, our hypothesis test produces a \(p\)-value of \(0\), leading to the correct conclusion that \(d_{xy}>0\) at a significance level of \(=0.05\). After successful applications of our methods to various settings, it is time to apply them to real datasets.

Figure 1: Hypothesis test Type I error plots. Left: \(n_{x}=n_{y}=100\). Right: \(n_{x}=n_{y}=200\).

Figure 2: Samples for simulations 3 (AB) and 4 (CD). AC: add line. BD: add grass.

Real data experiments

In this section, we apply our methods to real datasets previously studied in the literature to validate their effectiveness and interpret the results. In Table 2, we summarize relevant characteristics of each dataset along with the results. For each dataset, the intrinsic dimension estimation was performed with the method of moments estimator (Bac et al., 2021). Note that in each case where \(_{x}>_{y}\), the \(p\)-value is not reported because the hypothesis test does not apply. The cutoff for the singular values is set to \(0.9\) in all experiments.

**Corrupted MNIST.** The corrupted MNIST dataset was previously studied extensively by Abid et al. (2018), Abid and Zou (2019), Severson et al. (2019), and Li et al. (2020). The foreground group depicts handwritten 0's and 1's corrupted by images of grass, and the background contains only the grassy noise (no handwritten digits). In this case, the digits are unique to the foreground, supported by our \(p\)-value of \(0.008\). Furthermore, the contrastive dimension estimate for this dataset is \(_{xy}=5\), in line with the commonly believed dimension of digits 0 and 1 (Pope et al., 2021).

**Mouse Protein.** This dataset (Higuera et al., 2015) is a benchmark in the literature, considered in Abid et al. (2018), Li et al. (2020), and Severson et al. (2019). The foreground group contains the protein expressions of mice, some with and some without Down Syndrome, who were subjected to shock therapy, while the background group consists of protein expressions of mice without Down Syndrome who did not receive shock therapy. The intrinsic dimension estimates of \(_{x}=5\) and \(_{y}=4\) require that \(_{xy}>0\). In this setting, where the foreground space is bigger than the background space, the foreground group necessarily carries unique information. Nevertheless, the CDE estimate for this dataset of \(_{xy}=4\), which aligns with the observation of \(d_{xy} 2\) in the literature.

**mHealth.** The mHealth dataset (Banos et al., 2015), studied in Abid et al. (2018); Severson et al. (2019), consists of measurements made from medical sensors while a subject performs certain actions. While the foreground group contains measurements taken of a subject either squatting or cycling, the background measures a subject lying down. Our \(p\)-value \(<0.001\) and \(_{xy}=1\). This estimate explains the result in Abid et al. (2018), duplicated here in figure 3, showing that a single direction suffices to distinguish subgroups in the foreground data.

**BMMC.** This is a single-cell RNA sequencing dataset (Zheng et al., 2017) studied in Abid et al. (2018), Abid and Zou (2019), Severson et al. (2019), Li et al. (2020), and Weinberger et al. (2023). Here, the foreground group consists of gene expressions measured on bone marrow mononuclear cells (BMMCs) of patients with acute myeloid leukemia before and after receiving a transplant. The background group consists of healthy patients. Previous studies found that the 3rd and 4th PCs can separate pre- and post-transplant groups (Fig. 3), supported by our \(_{xy}=17>4\). However, the \(p\)-value of \(0.073\) stands somewhat in contradiction to this result, maybe due to the conservative nature of this hypothesis test, as illustrated in figure 1 and discussed in section 7.

**Small Molecule.** This is a dataset of cell line responses to small-molecule therapy (McFarland et al., 2020) and used in Weinberger et al. (2023). Here, the foreground group contains measurements from \(24\) cell lines treated with idasanutlin, while the background are the same cell lines treated with

  
**Dataset** &  & \(n_{x}\) & \(n_{y}\) & \(_{x}\) & \(_{y}\) & **p-Value** & \(_{xy}\) & **4 Smallest Singular Values** \\  Noisy MNIST & 784 & 5000 & 5000 & 20 & 20 & 0.008 & 5 & **0.095**, **0.315**, **0.705**, **0.846** \\ Mouse Protein & 77 & 270 & 135 & 5 & 4 & — & 4 & **0.319**, **0.472**, **0.886**, 0.919 \\ mHealth & 23 & 6451 & 3072 & 6 & 10 & 0.000 & 1 & **0.394**, 0.995, 0.997, 0.999 \\ BMMC & 500 & 4501 & 1985 & 26 & 30 & 0.073 & 17 & **0.042**, **0.123**, **0.182**, **0.306** \\ Small Molecule & 1000 & 3096 & 2831 & 12 & 11 & — & 4 & **0.627**, **0.699**, **0.894**, 0.925 \\ ECCITE-Seq & 1000 & 18343 & 2386 & 41 & 32 & — & 13 & **0.850**, **0.857**, **0.874**, **0.877** \\ Pathogen & 1000 & 4481 & 3240 & 24 & 25 & 0.161 & 10 & **0.259**, **0.345**, **0.528**, **0.700** \\ Perturb-Seq & 1000 & 24913 & 8907 & 49 & 47 & — & 28 & **0.038**, **0.102**, **0.131**, **0.176** \\ CelebA: Glasses & 1000 & 13193 & 189406 & 21 & 28 & 0.138 & 1 & **0.215**, 0.972, 0.975, 0.984 \\ CelebA: Hat & 1000 & 9818 & 192781 & 22 & 28 & 0.063 & 2 & **0.702**, **0.803**, 0.924, 0.938 \\   

Table 2: Summary of Results for Real Data Experimentsthe control dimethyl sulfoxide. \(_{x}=12\) and \(_{y}=11\) imply that \(_{xy}>0\). Nontheless, \(_{xy}=4\), suggesting that a CDR method with reduced dimension of \(4\) is appropriate.

**ECCITE-Seq.** This ECCITE-Seq dataset (Mimitou et al., 2019) was studied in Weinberger et al. (2023), containing joint RNA and surface protein expressions of pooled CRISPR screens. The foreground group consists of cell transcriptomes of perturbed cells, while the background is a set of control cells. \(_{x}=41\) and \(_{y}=32\) imply that \(_{xy}>0\). Therefore, the application of contrastive methods is suitable. Moreover, the CDE estimate of \(_{xy}=13\) helpfully gauges the number of directions unique to the foreground, recommending a reduced dimension of \(13\).

**Pathogen Data.** Studied by Weinberger et al. (2023), this dataset (Haber et al., 2017) contains gene expressions in the epithelial cells of mice infected with either Salmonella or H. Poly (foreground) or healthy mice (background). \(_{xy}=10\), suggesting that a contrastive method might fit well with a reduced dimension of \(10\). However, the \(p\)-value of \(0.161\) suggests that a linear contrastive method may not be appropriate. In fact, Weinberger et al. (2023) shows that only CVI, a deep learning based approach, works for this dataset, compared with linear methods, which aligns with our results.

**Perturb-Seq:** Studied by Weinberger et al. (2023), this dataset (Adamson et al., 2016) includes gene expressions measured of cells subjected to CRISPR-mediated perturbations (foreground) and cells treated with control guides (background). The hypothesis test is not applicable since \(_{x}>_{y}\). Regardless, CDE provides a helpful estimate for the amount of information unique to the foreground group, suggesting the efficacy of CDR methods.

**CelebA:** The CelebA dataset (Liu et al., 2015) was studied in Abid and Zou (2019) and with images of celebrities. We perform two experiments, with foreground being those wearing glasses and hat, respectively. In both, the background group is the remaining images. In the former case, \(_{xy}=1\), while in the latter \(_{xy}=2\). However, both cases have a somewhat large \(p\)-value, perhaps due to the conservative nature of the hypothesis test or nonlinearity.

## 7 Conclusion and Future Work

In this paper, we have introduced a hypothesis test to determines whether a linear CDR model is appropriate for a given dataset and an estimator of contrastive dimension, representing the dimension of the subspace unique to the foreground group relative to the background. This estimate of contrastive dimension can be used as the reduced dimension in downstream analysis with a CDR method. Meanwhile, there are still some open problems left to future work.

**Intrinsic Dimension Estimator.** The problem of estimating intrinsic dimension is challenging in its own right (Camastra and Staiano, 2016; Campadelli et al., 2015; Fefferman et al., 2016). While methods for it have been developed, there is not a single accepted standard for it. Fortunately, since \(|_{xy}-d_{xy}||_{x}-d_{x}|+ |_{y}-d_{y}|\), our \(_{xy}\) is robust when \(d_{x}\) and \(d_{y}\) are mis-specifying \(d_{x}\) and \(d_{y}\) in the Lipschitz-1 sense.

**Hypothesis Test.** Our hypothesis test introduces the notion of the contrastive bootstrap to allow for resampling under the assumption of the null hypothesis that the foreground space is a subset of the background space. However, a more powerful likelihood ratio test is applicable. Under model 3, the denominator is exactly from the solution of PPCA Tipping and Bishop (1999). However, the numerator involves a nontrivial constrained optimization problem. Naive gradient step method is neither effective nor scalable. An interesting future direction is to resolve this optimization issue.

**Uniqueness of Eigenvalues.** In section 4 we mentioned that the distinctness of eigenvalues ensures the identifiability of eigenvectors for each covariance matrix. However, this assumption can be relaxed since our focus is not on estimating each individual eigenvector but rather on identifying the eigenspace spanned by the top \(d_{x}\) and top \(d_{y}\) eigenvectors of \(_{x}\) and \(_{y}\).

**Extension to Nonlinear Setting.** In section 6, we mentioned that the data lying on a nonlinear manifold could lead to the apparent inconsistency between the estimator \(_{xy}\) being nonzero and the \(p\)-value produced by the hypothesis test being large. To appropriately handle the nonlinear case, a future work may consider a nonparametric extension analogous to the extension of CLVM (Severson et al., 2019) to CVAE (Abid and Zou, 2019).