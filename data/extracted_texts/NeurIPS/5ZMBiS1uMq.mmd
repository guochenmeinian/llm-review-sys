# Self-Adaptive Motion Tracking against On-body Displacement of Flexible Sensors

Chengxu Zuo1    Jiawei Fang1    Shihui Guo1*     Yipeng Qin2

1School of Informatics, Xiamen University, China

2School of Computer Science & Informatics, Cardiff University, UK

###### Abstract

Flexible sensors are promising for ubiquitous sensing of human status due to their flexibility and easy integration as wearable systems. However, on-body displacement of sensors is inevitable since the device cannot be firmly worn at a fixed position across different sessions. This displacement issue causes complicated patterns and significant challenges to subsequent machine learning algorithms. Our work proposes a novel self-adaptive motion tracking network to address this challenge. Our network consists of three novel components: i) a light-weight learnable Affine Transformation layer whose parameters can be tuned to efficiently adapt to unknown displacements; ii) a Fourier-encoded LSTM network for better pattern identification; iii) a novel sequence discrepancy loss equipped with auxiliary regressors for unsupervised tuning of Affine Transformation parameters. Experimental results show that our method is robust across different on-body position configurations. Our dataset and code are available at: [https://github.com/ZuoCX1996/Self-Adaptive-Motion-Tracking-against-On-body-Displacement-of-Flexible-Sensors](https://github.com/ZuoCX1996/Self-Adaptive-Motion-Tracking-against-On-body-Displacement-of-Flexible-Sensors).

## 1 Introduction

Following the philosophy of ubiquitous computing, wearable devices have emerged as a promising solution for motion tracking that has various applications in entertainment , human-computer interaction , healthcare , etc. Among different types of such wearable devices, those using _flexible sensors_ stand out for their advantages in long-term use scenarios. Specifically, flexible sensors can be easily integrated into wearable devices (_e.g._, sewn into ordinary clothing) while ensuring wearing comfort. These flexible sensors bend in response to human body movements (represented by joint angles), causing changes in their readings, which can be used for motion tracking .

In recent years, enabling wearable devices to be worn in non-fixed positions has become a crucial objective in order to make these devices more suitable for daily use . However, this flexibility poses new challenges for deep-learning powered motion capture (mocap) systems. That is, the inevitable on-body displacement across wearing sessions can cause significant data distribution shifts, which degrades the performance of supervised learning models (Figure 0(a)).

A straightforward solution to the above problem is to collect a large dataset that covers a wide spectrum of wearing positions for model training. However, this approach significantly amplifies data collection costs, including equipment expenses, manpower, and time investments. Furthermore, any alterations in device design (sensor position, quantity, etc.) necessitate a fresh round of data collection, resulting in significant resource consumption and impeding swift product iteration. Another solution is to fine-tune the model against "unseen" displacements with a small amount of labeled data under new displacements, _a.k.a._, supervised domain adaptation. However, this is infeasible for our task asobtaining accurate joint angles (_i.e.,_ labels) requires advanced optical motion capture systems that are difficult to set up in real-world scenarios (_e.g.,_ outdoor running, boating), hindering everyday use.

In this work, we address the above challenges by proposing a novel self-adaptive motion tracking network that can adapt itself to unknown displacements in an unsupervised way, using only a small amount of new sensor readings. Specifically, most existing unsupervised domain adaptation methods assume the source and target domains share identical feature distributions, which is not applicable to our task as our training set contains data with multiple displacements, while the test data has only one unknown displacement. To this end, we propose a novel solution that allows the alignment of test data with a subset of training data that also has one displacement, which encompasses three novel components: i) a light-weight learnable Affine Transformation layer whose parameters effectively model the distributional shifts caused by displacements; ii) a Fourier-encoded LSTM network that facilitates the learning of more frequency components for better pattern learning and identification; iii) a novel sequence discrepancy loss equipped with auxiliary regressors for unsupervised self-adaptation.

The contributions of our method are three-fold:

* We propose a novel self-adaptive motion tracking network that can adapt to unknown on-body displacements of flexible sensors in an unsupervised way, allowing for long-term and daily motion tracking.
* We propose three novel components for our network: i) a light-weight learnable Affine Transformation layer, ii) a Fourier-encoded LSTM network, and iii) a novel sequence discrepancy loss, which together efficiently reduce the distributional shifts of sensor readings caused by on-body displacements.
* Extensive experiments demonstrate the superior performance of our method against the state-of-the-art methods of domain adaptation applied in our scenario.

## 2 Related Work

### Domain Adaptation

Domain adaptation aims to mitigate the gap between the source and target domains so that models trained in the source domain(s) can be applied to the target domain(s). Traditional methods perform adaptation effectively by either reweighting samples from the source domain [7; 8], or seeking an explicit feature transformation that transforms the source and target samples into the same feature spaces [9; 10; 11; 12]. Subsequent studies have shown that deep neural networks can learn more transferable features for domain adaptation . For example, Deep Domain Confusion (DDC)  first proposed the use of Maximum Mean Discrepancy (MMD) loss to align the feature distribution of the target domain with that of the source domain for the domain adaption of deep neural networks; Deep Adaptation Networks (DAN)  extends the idea to the use of multiple-kernel MMD; Deep CORAL  proposed CORAL loss  for adaptation; Chen _et al._ propose a Higher-order Moment Matching (HoMM) method for better distribution discrepancy minimizing. Other works within deep neural networks also illustrate immense success in learning transferable

Figure 1: Demonstration of our problem setup. (a) Joint tracking with lateral and circular sensor displacements. (b) The data distribution shifts caused by lateral displacement, _e.g.,_\(l\)=1: lateral displacement shifts upwards by 1 cm; and (c) circular displacements, _e.g.,_\(c\)=5: circular displacement shifts clockwise by 5\({}^{}\). \(r_{1}\), \(r_{2}\): sensor readings.

features [19; 20; 21]. In addition, recent studies show that adversarial learning also contributes to learning more transferable and discriminative representations [22; 23; 24; 25; 26; 27; 28].

In summary, most existing domain adaptation methods assume that the source and target domains share the same feature distributions and thus aim to minimize relevant distributional differences . While in our task, the training set contains data with multiple displacements while the test data has only one unknown displacement, thus making the above-mentioned assumption invalid.

Addressing this issue, we propose a novel self-adaptive motion tracking network that tunes the parameters of an Affine Transformation layer with a novel sequence discrepancy loss, which can align the test data with a subset of training data that also has one displacement, achieving robust and accurate domain adaptation for flexible sensors.

### Human Motion Capture

Human motion capture records human body movements and has been widely applied in entertainment, healthcare, sports, etc. Existing mocap solutions can be roughly classified into two categories: vision-based and sensor-based.

Vision-based mocap solutions make use of the latest deep learning techniques and have achieved great success in specific scenarios [30; 31]. However, they rely on good visual conditions and are inherently weak against textureless clothes and environmental problems (_e.g._, challenging lighting, occlusion). Most existing sensor-based mocap solutions rely on Inertial Measurement Units (IMUs) to record motion inertia / acceleration for the analysis of human posture [32; 33; 34]. Although robust against environmental conditions, the dense and tight placement of IMUs is intrusive and inconvenient, hampering performers from moving freely in their daily lives.

To this end, people turned to flexible sensor-based wearable devices indistinguishable from daily clothing. For example, Glauser _et al._ designed a stretch-sensing soft glove and used it to interactively estimate hand poses with the aid of a deep neural network; Ma _et al._ proposed flexible all-textile dual tactile-tension sensors for precise monitoring of athletic and form, illustrating their potential application in robust physical training analysis. Zhou _et al._ uses a deep regressor to continuously predict the 3D upper body joints coordinates from 16-channel textile capacitive sensors.

### Flexible Sensors

Given their advantages of bio-compatibility, high stretch-ability, lightweight, and ease of integration within clothing, flexible sensors have been used for long-term monitoring of human physical status, specifically motion capture , human-computer interfaces , soft robotics , etc. For human motion tracking, existing methods have explored the use of flexible sensors in tracking the motion of the upper body , fingers , lower limbs , elbow joints , and knee joints . Along with such exploration, it has been noted that on-body displacement of sensors is inevitable as the device cannot be firmly worn at a fixed position across different sessions . Additionally, due to the deformation characteristics of flexible sensors, it is fairly complicated to achieve robust motion tracking in the presence of placement deviation [46; 47].

In this work, we start with an exemplary scenario: an elbow pad with two flexible and stretchable sensors for elbow joint tracking, and address this gap by proposing a novel self-adaptive motion tracking network that can adapt to unknown on-body displacements in an unsupervised manner to achieve robust and accurate motion tracking.

## 3 Hardware

We design and develop a prototype by augmenting a standard elbow pad with two soft stretchable (_i.e._, flexible) sensors, which are placed on the olecranon side of the elbow. The pad offers a versatile size of 20 cm in length and 25 cm in circumference, accommodating a broad spectrum of users. The two sensors are placed 2 cm apart.

Our method aims to estimate the bending angle, \(\), of an elbow joint (Figure 1) from the sensor readings of the two flexible sensors. The bending angle is defined as the angle in the sagittal plane between the humerus and the central line between the radius and the ulna. Fabric sensors are purchased as off-shelf products from ElasTech1. They are capacitive, _i.e._, their capacitance increase with the stretch caused by the bending of the arm. The sensor readings are digitized to values in the range  and transmitted wirelessly via Bluetooth Low Energy at a frame rate of 50Hz.

## 4 Method

In our work, a motion tracking system using flexible sensors aims to construct a function \(f\) between sensor readings \(R\) and joint angles \(\) (Figure 1a) that: \(\)=\(f(R)\). Naively, \(f\) can be approximated through supervised learning by fitting a model to collected \((R,)\) data. While in practice, it is infeasible to collect enough \((R,)\) data for training as \(R\) depends on the countless instances of on-body displacement of flexible sensors \((c,l)\), where \(c\) (deg) and \(l\) (cm) are circular and lateral displacement, respectively (Figure 1a). Addressing this issue, we propose a novel self-adaptive motion tracking network for flexible sensors that can efficiently adapt to unseen on-body displacements in an unsupervised manner. As Figure 2 shows, our network decomposes \(f\) into two parts:

\[f_{}=f_{_{0}}  f_{_{0}} \]

where \(_{0}\) denotes the sensor readings with a limited number of displacements in the training dataset, \(\) denotes the sensor readings with unknown displacements at the time of testing. Between them, \(f_{_{0}}\) is implemented with a light-weight learnable Affine Transformation layer whose parameters can be tuned to align \(\) to \(_{0}\) and thus adapt the network to "unseen" displacements (Sec. 4.1); \(f_{_{0}}\) is implemented with a Fourier-encoded LSTM network to reduce the learning bias towards low-frequency functions and produce more accurate results (Sec. 4.2). The tuning of \(f_{_{0}}\) is achieved by minimizing a novel sequence discrepancy loss equipped with auxiliary regressors (Sec. 4.3).

Figure 2: Overview of the proposed self-adaptive motion tracking network. Our network decomposes the mapping \(f\) between sensor readings \(\) and joint angles \(\) into two parts: \(f_{}=f_{_{0}}  f_{_{0}}\). (a) The intuition behind the adaptation function \(f_{_{0}}\), which aligns the test data \(\) to a subset of the training set \(_{0}\) that also has a single displacement. (b) Illustration of the three novel components in the proposed network: i) a learnable Affine Transformation layer; ii) a Fourier-encoded LSTM network; iii) a sequence discrepancy loss \(\) equipped with auxiliary regressors. Specifically, \(f_{_{0}}\) is implemented with the Affine Transformation layer, whose parameters are adapted with the sequence discrepancy loss \(\); \(f_{_{0}}\) is implemented with the supervisedly pre-trained Fourier-encoded LSTM network, whose parameters are frozen during adaptation.

### Learnable Affine Transformation

The proposed learnable Affine Transformation layer is an efficient implementation of \(f_{_{0}}\). Specifically, it models the _linear_ transformation components of flexible sensors in a motion tracking system:

* **Initial Stretch**, which is mainly affected by lateral displacements (Figure 1(b)) and can be modeled with the additive **bias** vector in affine transformation.
* **Stretching Range**, which is mainly affected by circular displacement (Figure 1(c)) and can be modeled with a **scaling** matrix in affine transformation.

Accordingly, let \(X=[r_{1},r_{2}]^{T}\) be the sensor readings, \(W_{s}=diag[s_{1},s_{2}]\) be the scaling matrix, \(B=[b_{1},b_{2}]^{T}\) be the bias vector, we have:

\[f_{_{0}}(X)=W_{s}X+B=s_{1}&0\\ 0&s_{2}r_{1}\\ r_{2}+b_{1}\\ b_{2} \]

Both \(W_{s}\) and \(B\) are learnable in the adaptation stage (Sec. 4.3) for the adaptation to unknown displacements.

### Fourier-encoded LSTM Network

We implement \(f_{_{0}}\) by augmenting a standard LSTM sequence prediction network with a Fourier Feature Encoding (FFE) layer, which models the _nonlinear_ mapping from flexible sensor signals to joint angles. Our key insight is that FFE helps to reduce the learning bias of deep neural networks towards low-frequency functions  that leads to underfitting of \(f_{_{0}}\).

The FFE layer used in our work is as follows:

\[x^{}=[(),()] \]

where \(x X\) is the input, \(A>|(X)-(X)|\) so that \(x^{}\) and \(x\) are in one-to-one correspondence. Please note that our Fourier-encoded LSTM network is only trained in the pretraining stage and fixed during adaptation (Figure 2).

### Unsupervised Adaptation to Displacements

**Input**: Pretrained model \(f\) with auxillary regressors; Scaling matrix \(W_{s}\) and Bias vector \(B\) of the affine transformation layer in \(f\); Test-time sensor readings \(R\); Batch size \(n\);

**Parameter**: Training epoch \(e\); Learning rate \(\);

**Output**: Adapted \(W_{s}\) and \(B\);

```
1:for\(i=1,,e\)do
2:for\(j=1,,|R|/n\)do
3:\(X\) a mini-batch of (sequence) samples from \(R\)
4:\( f(X)\)
5:\(W_{s} W_{s}-()}{ W_ {s}}\) ; \(B B-()}{ B}\)
6:endfor
7:endfor
8:return\(W_{s}\), \(B\)
```

**Algorithm 1** Unsupervised Adaptation to Displacements

As mentioned above, our network decomposes the mapping \(f\) into two parts \(f_{}=f_{_{0}} f _{_{0}}\). Between them, the challenging nonlinear components are well-approximated by \(f_{_{0}}\), which greatly simplifies our adaptation to tuning the parameters of the Affine Transformation layer of \(f_{_{0}}\). Intuitively, we aim to align the distribution of \(\) to that of \(_{0}\) so that \(f_{_{0}}\) can accurately map \(\) to joint angle \(\). Naively, this can be achieved by directly minimizing a distributional differenceloss between \(_{0}\) and \(\) or maximizing the prediction accuracy when using \(\). However, neither approach is effective for our task as i) the former assumes \(\) and \(_{0}\) share the same distribution after the affine transformation, which is incorrect because \(_{0}\) (the training set) contains data with multiple displacements while \(\) is collected with a single unknown displacement; and ii) the latter requires ground truth joint angles \(\) of \(\), which are unavailable during use. Addressing this challenge, we propose a novel sequence discrepancy loss equipped with auxiliary regressors as follows.

Sequence Discrepancy Loss.We observed that the domain gaps among different displacements are particularly evident when the elbow is bent and less when the elbow is flexed. Consequently, the domain gaps are not evenly distributed over time during elbow movement, leading to the discrepancy among different regressors that estimate the same joint angle \(_{t}\) with different choices of time windows, where \(t\) denotes the time step in a motion sequence. Our key idea is that the adaptation to unknown displacements can be achieved by minimizing such discrepancy. Specifically, let \(n\) be the length of the time window for the main regressor, we have

\[_{t}^{(0)}=f(R_{t-n+1},R_{t-n+2},...,R_{t}) \]

where \(_{t}^{(0)}\) is its joint angle estimate. Similarly, we include additional \(n-1\) auxillary regressors that predict \(_{t}\) with different time windows as:

\[_{t}^{(i)}=f(R_{(t+i)-n+1},R_{(t+i)-n+2},...,R_{t+i}) \]

where \(_{t}^{(0)}_{t}^{(1)}..._{t}^{(n-1)}\) for \(_{0}\) used in supervised pretraining, _i_=1,...,n-1. However, when \(\) is used, discrepancies occur among regressors and we tune the affine transformation parameters (Sec. 4.1) to minimize such discrepancies. Specifically, let \(^{(k)}=(_{1}^{(k)},_{2} ^{(k)},,_{t}^{(k)})\) be the mean of joint angle estimates of regressor \(k\), \(_{t}^{(k)}=_{t}^{(k)}-_{t}(^{(k)})}{_{t}(^{(k)})-_{t}(^{(k)})+ }\) be the normalized joint angles, \(=1\) for numerical purpose, we define:

\[_{mean} =_{k=0}^{n-1}(^{(k)}-_{i=0}^{ n-1}^{(i)})^{2} \] \[_{shape} =_{t}_{k=0}^{n-1}(_{t}^{(k)}- _{i=0}^{n-1}_{t}^{(i)})^{2} \]

Our overall sequence discrepancy loss is a weighted sum of \(_{mean}\) and \(_{shape}\):

\[=_{mean}+(1-)_{shape} \]

where \(\) is a weighting hyperparameter. Alg. 1 shows the pseudo-code of our adaptation algorithm.

## 5 Experimental Results

### Experimental Setup

Dataset and MetricsThe dataset used in this paper consists of sensor readings and joint angles collected by a single user wearing the augmented elbow pad (Sec. 3) while performing elbow flexion. The joint angles are computed using the 3D positions captured by a Nokov motion-capture system at a rate of 60 FPS. As instances of different on-body displacements, we collect 11 groups of data with circular displacements \(c\{-5,0,5\}\) and lateral displacements \(l\{-2,-1,0,1,2\}\). For each group, we collected data for 8 consecutive elbow flexion. In total, we collected 5,310 frames of data across the 11 valid groups. Among the 11 groups, we randomly selected 5 of them as the training set \(_{train}\) and used the rest 6 groups as the test set \(_{test}\). We have obtained _ethical approval_ for the publication of both datasets and results.

We use the Mean Absolute Error (MAE) of predicted joint angles (degrees) as our main evaluation metric. For each experiment, we repeat 20 times and report their mean and standard deviation (std). Unless specified, we use the same setups for all experiments.

Training DetailsOur model is trained in two stages: supervised pretraining and unsupervised adaptation. For the supervised pretraining, we employ an MSE loss:

\[_{mse}=_{k=0}^{n-1}_{t}(_{t}^{(k)}- _{t})^{2} \]

where \(_{t}^{(k)}\) is the output of regressor \(k\) at time step \(t\), \(_{t}\) is the corresponding ground truth joint angle. We use an Adam optimizer with a learning rate of \(1e^{-3}\), \(_{1}=0.9\), \(_{2}=0.999\), and training epoch \(e=30\). For the adaptation, we use an Adam optimizer with a learning rate of \(5e^{-3}\) and a weight decay of \(0.001\), \(_{1}=0.9\), \(_{2}=0.999\), and training epoch \(e=20\). We use \(n=10\) for both pretraining and adaptation. All experiments were conducted on a desktop PC with an AMD Ryzen 3950X CPU and an NVIDIA RTX 3080 GPU. Please see the supplementary materials for the details of network architectures.

### Comparisons with SOTA

As Table 1 shows, we compare our method with state-of-the-art (SOTA) domain adaptation methods. For a fair comparison, we have adapted the official code provided by the authors to share the same input and output format as ours. Please see the supplementary materials for more details on the implementation of SOTA methods. It can be observed that our method outperforms all SOTA methods, which demonstrates its effectiveness.

To gain more insights, we visualize the results of our method and its two strongest competitors, AdvSKM  and HoMM , as time series in Figure 3. The results show that our method fits the ground truth with a closer distance than other SOTA methods.

Comparison with Supervised LearningTo demonstrate the effectiveness of unsupervised learning in our task, we tune the parameters of Affine Transformation layer by supervised learning (_i.e._, supervised domain adaptation) to obtain its "upper bound". Even trained in an unsupervised manner, our method achieves results comparable to its supervised version (Table 1). This difference of 1.5 degrees indicates that our unsupervised learning approach is effective.

Experiments on different participantsTo further demonstrate the generalization ability of our method, we conducted experiments with five additional participants of varying body types (see the supplementary materials for body profile details). Each of these five participants wore the devices in three supervised on-body positions and performed three distinct physical activities sequentially: **ping-pong, basketball**, and **boxing**. Each activity lasted for a minimum duration of one minute. In total, this comprehensive evaluation approach yielded 15 (5 participants \(\) 3 on-body displacements) unique data segments across all participants, comprising 81,848 total frames. For each participant,

   Method & MAE (deg) \\  MMD  & 28.73 \(\) 8.50 \\ D-CORAL  & 13.83 \(\) 8.45 \\ DAAN  & 16.80 \(\) 7.88 \\ DSAN  & 14.03 \(\) 5.88 \\ AdvSKM  & 13.05 \(\) 5.19 \\ HoMM  & 11.03 \(\) 4.42 \\  Ours & **7.32 \(\) 2.85** \\ Supervised & 5.63\(\)1.95 \\   

Table 1: Results of comparative experiments.

Figure 3: Comparison with two most competitive SOTA methods (displacement condition: \(c\)=-5, \(l\)=1). As highlighted in the dashed boxes, our method (red) is much closer to the ground truth (blue). GT: ground truth.

we conducted 5 times 3-fold cross-validation experiments and recorded the average result. As Table 2 shows, our method achieves optimal or near-optimal results for all five additional users, indicating the effectiveness of our method against user diversity.

### Ablation Study

To demonstrate the effectiveness of the three novel techniques proposed, we conduct an ablation study as follows:

* **FFE**: Remove the Fourier Feature Encoding (FFE) layer from the LSTM network.
* **Affine**: Remove the Affine Transformation layer and tune all the parameters of the network during adaptation after supervised pretraining. For the adaptation, we use a weighted sum of two loss terms: i) a supervised loss \(_{mse}\) applied on the training data; and ii) our sequence discrepancy loss \(\) applied on the test data.
* **SD Loss**: Replace our Sequence Discrepancy (SD) loss with a more naive and stricter version: \[^{{}^{}}=_{t}_{k=0}^{n-1}(_{t}^{(k)}- _{t})^{2}\] (10) where \(_{t}=(_{t}^{(0)},...,_{ t}^{(n-1)})\).

### Justification of Motivation

Affine TransformationFigure 4 demonstrates the effective alignment of the target and source domains with our method. As shown in Figure 3(a) and 3(b), although light-weight, the proposed Affine Transformation layer effectively aligns the sensor reading distributions of test data (blue) to those in the training set (orange), thereby significantly improving the accuracy of joint angle estimation.

Sequence Discrepancy LossThe design rationale of this component is rooted in the insight that our sequence discrepancy loss \(\) shares a similar optimization landscape with the estimation error of joint angles during optimization (Figure 5). This consistency effectively offers the advantage of

    &  \\  User ID & D-CORAL & DSAN & HoMM & AdvSKM & Ours \\ 
1 & **11.84**\(\)**1.49** & 11.86 \(\) 1.57 & 11.96 \(\) 1.73 & 11.84 \(\) 1.80 & 12.07 \(\) 1.04 \\
2 & 16.59 \(\) 1.81 & 17.04 \(\) 1.80 & **16.53**\(\)**1.70** & 16.63 \(\) 0.95 & 16.69 \(\) 2.34 \\
3 & 14.94 \(\) 5.89 & 13.68 \(\) 4.19 & 15.24 \(\) 6.93 & 15.71 \(\) 6.89 & **12.70**\(\)**2.79** \\
4 & 11.76 \(\) 1.11 & 12.04 \(\) 1.16 & 12.06 \(\) 1.49 & 12.08 \(\) 1.73 & **9.30**\(\)**2.77** \\
5 & 19.41 \(\) 4.37 & 19.32 \(\) 4.34 & 20.58 \(\) 5.88 & 19.44 \(\) 4.21 & **13.96**\(\)**2.88** \\  Avg & 14.91 \(\) 0.34 & 14.79 \(\) 0.22 & 15.27 \(\) 0.48 & 15.14 \(\) 0.18 & **12.94**\(\)**0.25** \\   

Table 2: Experimental results on five additional participants.

   Case & FFE & Affine & SD Loss & MAE \\ 
1 & - & - & - & 13.40\(\)5.58 \\
2 & + & - & - & 11.81\(\)6.65 \\
3 & - & + & - & 12.58\(\)8.62 \\
4 & - & - & + & 14.36\(\)5.96 \\
5 & - & + & + & 10.27\(\)4.20 \\
6 & + & - & + & 12.36\(\)6.99 \\
7leading the network optimization toward the optimal point. As shown in Figure 6, i) before adaptation, the outputs of different regressors significantly differ from each other, leading to a high sequence discrepancy; ii) after adaptation, the discrepancy among regressors reduced and the accuracy of joint angle estimates for all regressors was improved significantly at the same time.

Fourier Feature EncodingExisting literature shows the existence of spectral bias: the tendency of neural networks to prioritize learning low-frequency functions . Figure 6(a) shows the frequency distribution difference between the prediction and ground truth. Without the component of FFE, the network output shows a large deviation in the region of low-frequency domain from the ground truth (on the left side of this plot). This over-emphasis on the low-frequency components inevitably dominates the prediction capability and weakens the reconstruction of the high-frequency signals.

Our experiment confirms that Fourier Feature Encoding (FFE) reduces the spectral bias of neural networks. Therefore, as Figure 7 shows, our method can approximate the mapping between sensor readings and joint angles in a more faithful way.

Figure 4: Original and adapted data distributions of our method, HoMM and AdvSKM. Note that due to method characteristics, our method is aligned directly using the sensor reading, while the latter two are aligned in the latent space. “dim 1” and “dim 2” are obtained using t-SNE.

Figure 5: Rationale of our Sequence Discrepancy (SD) loss (\(c\)=5, \(l\)=0). Our SD loss shares similar minima with the MAE errors. Error: errors of joint angle estimation. As defined in Eq. 2, Bias \(B=[b_{1},b_{2}]^{T}\) and Scaling \(W_{s}=diag[s_{1},s_{2}]\).

Figure 6: Justification of Sequence Discrepancy Loss (\(c\)=5, \(l\)=0). The accuracy of joint angle estimation improves along with the reduction of discrepancy among regressors. A1, A5, A9: auxiliary regressors 1, 5, 9. Main: main regressor. GT: ground truth.

Figure 7: Justification of Fourier Feature Encoding (FFE) (\(c\)=0, \(l\)=-1). (a) Time series of network outputs with/without FFE and the ground truth in the time domain. (b) Differences of network outputs between with/without FFE and the ground truth in the frequency domain.

## 6 Limitations and Future Work

LimitationsThe performance of the proposed method is dependent on the quality of the data in both the training and test sets. When the data quality is poor (_e.g._, noisy), the error in joint angle prediction may still be high even if the sensor readings are well aligned (see Figure 7(a) and 7(b)).

Spectfically, according to the frequency characteristics of elbow movement, we define the sensor signal greater than 5Hz as noise, and calculated the signal-to-noise ratio (SNR) for the sensor signals within the 11 data sets collected from a single user. Furthermore, we compiled the mean absolute error (MAE) for each set after implementing our adaptive approach. It can be found that our proposed method exhibits significant effectiveness when the SNR exceeds 10 dB. Conversely, maintaining satisfactory outcomes becomes challenging when the SNR falls below 10 dB (see the supplementary materials for the visualization).

Future WorkAs abovementioned, we believe that extending our method to learning with noisy data would be interesting future work. In addition, our work opens up a number of research directions for future efforts. First, in most domain adaptation methods, measuring the similarity between the distribution of the target domain and the source domain is a key step. While in our work, we found that the output of the auxiliary regressors can be used as an indicator of data distribution shifts from the source domain, and verified the feasibility of domain adaptation using only target domain data in flexible sensor applications. In future work, we hope to implement this idea in more diverse applications. Second, although we have only used translation and scaling, this work proves affine-based domain adaptation to be a promising solution to mitigate the data distribution shifts of flexible sensors. The effectiveness of rotation and reflection remains to be studied in our future work.

## 7 Conclusion

Our work proposes a novel self-adaptive motion tracking network to address the challenging data distributional shifts caused by on-body displacements of flexible sensors. To mitigate the effects of such displacements, we propose three novel techniques. First, we propose an Affine Transformation layer that can remap shifted data distributions to those in the training set efficiently. Second, we propose a Fourier-encoded LSTM network that can learn richer frequency components in the input signals and thus improves the accuracy of joint angle estimation. Finally, we propose a Sequence Discrepancy loss equipped with auxiliary regressors that can adapt the parameters of Affine Transformation effectively in an unsupervised manner. Experimental results show that our method can effectively adapt to unknown displacements of flexible sensors worn at different positions.

## 8 Acknowledgements

This work is supported by National Natural Science Foundation of China (62072383), the Fundamental Research Funds for the Central Universities (20720210044), and partially supported by Royal Society (IEC NSFC 211022).

Figure 8: Failure cases (noisy data). \(x\)-axis and \(y\)-axis (\([r_{1},r_{2}]\)): sensor readings. \(z\)-axis: joint angles. Blue and Orange: displacements in the training and test sets, respectively.