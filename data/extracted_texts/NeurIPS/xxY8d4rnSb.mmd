# ManiPose: Manifold-Constrained Multi-Hypothesis 3D Human Pose Estimation

Cedric Rommel\({}^{1}\)

Victor Letzelter\({}^{1,3}\)

Nermin Samet\({}^{1}\)

Renaud Marlet\({}^{1,5}\)

Matthieu Cord\({}^{1,2}\)

Patrick Perez\({}^{1}\)

Eduardo Valle\({}^{1,4}\)

\({}^{1}\)Valeo.ai, Paris, France \({}^{2}\)Sorbonne Universite, Paris, France

\({}^{3}\)LTCI, Telecom Paris, Institut Polytechnique de Paris, France

\({}^{4}\)Recod.ai Lab, School of Electrical and Computing Engineering, University of Campinas, Brazil

\({}^{5}\)LIGM, Ecole des Ponts, Univ Gustave Eiffel, CNRS, Marne-la-Vallee, France

###### Abstract

We propose _ManiPose_, a manifold-constrained multi-hypothesis model for human-pose 2D-to-3D lifting. We provide theoretical and empirical evidence that, due to the depth ambiguity inherent to monocular 3D human pose estimation, traditional regression models suffer from pose-topology consistency issues, which standard evaluation metrics (MPJPE, P-MPJPE and PCK) fail to assess. ManiPose addresses depth ambiguity by proposing multiple candidate 3D poses for each 2D input, each with its estimated plausibility. Unlike previous multi-hypothesis approaches, ManiPose forgoes generative models, greatly facilitating its training and usage. By constraining the outputs to lie on the human pose manifold, ManiPose guarantees the consistency of all hypothetical poses, in contrast to previous works. We showcase the performance of ManiPose on real-world datasets, where it outperforms state-of-the-art models in pose consistency by a large margin while being very competitive on the MPJPE metric.

## 1 Introduction

We propose _ManiPose_, a novel approach for human-pose 2D-to-3D lifting. ManiPose directly addresses the depth ambiguity inherent to monocular 3D human pose estimation by being both multi-hypothesis and manifold-constrained, thus avoiding pose consistency issues, which plague traditional regression-based methods. Unlike previous multi-hypothesis approaches, ManiPose forgoes the use of costly generative models, while still estimating the plausibility of each hypothesis.

Monocular 3D human pose estimation (HPE) is a challenging learning problem that aims to predict 3D human poses given an image or a video from a single camera. Often, the problem is split into two successive steps: first 2D human pose estimation, then 2D-to-3D lifting. Such separation is favorable because 2D-HPE is much more mature, leading to better overall results. Due to depth ambiguity and occlusions, 2D-to-3D lifting is intrinsically ill-posed: multiple 3D poses correspond to the same projection observed in 2D. Despite that, the field has experienced fast developments, with substantial improvements in terms of mean-per-joint-prediction error (MPJPE) and derived metrics (_e.g._, P-MPJPE, PCK) .

However, recent studies  noted that poses predicted by state-of-the-art models fail to respect basic invariances of human morphology, such as bilateral sagittal symmetry, or constant length across time of rigid body segments connecting the joints. Not only do we address those concerns with ManiPose (see Fig. 1), but we also provide theoretical elements clarifying the cause of those issues. We show in particular that pose consistency and traditional performance metrics (such as MPJPE)cannot be optimized simultaneously by a standard regression model, because MPJPE ignores the topology of the space of human poses, and traditional regression models imply unimodality, thus overlooking the inherently ambiguous nature of 3D-HPE.

Our contributions include:

* ManiPose, a novel, multi-hypothesis, manifold-constrained model for human-pose 2D-to-3D lifting, which is able to estimate the plausibility of each hypothesis without resorting to costly generative models.
* Theoretical insights that elucidate why traditional regression models associated with standard metrics such as MPJPE fail to enforce pose consistency.
* Extensive empirical results, including comparison to strong baselines, evaluation on two challenging datasets (Human 3.6M and MPI-INF-3DHP), and ablations. ManiPose outperforms state-of-the-art methods by a substantial margin in terms of pose consistency, while still beating them in the MPJPE metric. The ablations confirm the importance of both multiple hypotheses and of constraining the poses to their manifold.

The PyTorch  implementation of ManiPose and code used for all our experiments can be found at https://github.com/cedricrommel/manipose.

## 2 Related work

**Regression-based 2D-to-3D pose lifting.** While 2D-to-3D human pose lifting was initially restricted to static frames [31; 3], the field embraced recurrent , convolutional  and graph neural networks [2; 55; 14; 51] to handle motion. Spatial-temporal transformers appear more recently [42; 53], including MixSTE , arguably becoming the state of the art. We adopt them in our work. A few previous works constrain predicted poses to respect human symmetries [50; 4], an idea we advance with a novel constraint implementation, in a multi-hypothesis setting.

**SMPL-based methods.** While 3D human pose lifting's objective is to predict 3D joint positions based on 2D keypoints, the neighboring field of human pose and shape reconstruction (HPSR) aims at estimating whole 3D body meshes from images. HPSR is hence more challenging than 3D-HPE, which explains why models are often larger, frame-based and more reliant on optimization-based post-processing [16; 39; 46; 9]. Nonetheless, our work shares some ideas from this field. Indeed, modern HPSR methods often predict joint angles (and body shape parameters), which are fed to the pre-trained parametric model SMPL  to produce human body meshes, thus ensuring that limbs' sizes remain constant along a movement. Note, however, that these are also single-hypothesis regression methods and hence share the same caveats as most 3D-HPE approaches.

Figure 1: **Optimizing both 3D position and pose consistency requires combining constraints and multiple hypotheses.** Results from Tables 2 and 4. Previous unconstrained methods provide inconsistent poses (top). Regularization (MR) and disentanglement constraints improve consistency, but degrade joint position error (bottom-right). Ours is the only method that achieves both good joint error and consistency, thanks to a combination of disentanglement and a few hypotheses (see circles sizes).

**Multi-hypothesis 3D-HPE.** The intrinsic depth-ambiguity of 3D-HPE led the community to investigate multi-hypothesis approaches, including Mixture Density Networks [25; 36; 1], variational autoencoders , normalizing flows [18; 49] and diffusion models [12; 6; 10]. Contrary to ours, those methods rely on a generative model to sample 3D pose hypotheses conditioned on the 2D input. A notable exception is MHFormer , which, like ManiPose, is deterministic, but treats the hypotheses as intermediate representations to be aggregated at the final network layers, thus concluding with a one-to-one 2D-to-3D mapping. We strive to avoid such injectivity and to preserve the multiple hypotheses, for reasons we will justify both empirically and theoretically in the next sessions. Moreover, none of the previous multi-hypothesis approaches constrain hypotheses to lie on the human pose manifold, thus failing to guarantee good pose consistency.

**Multiple choice learning (MCL)** is a simple approach for estimating multimodal distributions, suited for ambiguous tasks, using the winner-takes-all loss. Adapted for deep learning by Lee _et al._[20; 21], it produces diverse predictors, each specialized in a particular subset of the data distribution. MCL has proved its effectiveness in several computer vision tasks [41; 19; 33; 8; 30; 45], and was first applied to 2D-HPE in . Our work is the first to employ MCL for the 3D-HPE task, by leveraging recent innovations of Letzelter _et al._.

## 3 ManiPose

Following the previous state of the art, we split 3D-HPE into two steps, first estimating \(J\) human 2D keypoints in the pixel space from a sequence of \(T\) video frames \([_{1},,_{T}]^{2 J T}\), and then lifting them to 3D joint positions \([}_{1},,}_{T}]^{3 J  T}\). We focus on the second step (_i.e._, lifting) in the rest of the paper, assuming the availability of 2D keypoints \(_{i}\). Our method aims to both ensure pose consistency and resolve depth ambiguity, as we will discuss in the next section.

### Constraining predictions to the pose manifold

**Rationale.** Human morphology prevents the joints from arbitrarily occupying the whole space. Instead, the poses within a movement are restricted to a manifold, reflecting the human skeleton's rigidity. If we knew the length of each segment connecting pairs of joints for a given subject, we could guarantee that the predicted poses lie on the correct pose manifold by only predicting the body part's rotations with respect to a reference skeleton. Since we do not have access to ground-truth segment lengths in real use cases, we propose to predict them, thus disentangling the estimation of the reference lengths (fixed across time) from the estimation of the joint rotations (variable across time).

**Disentangled representations.** We constrain model predictions to lie on an estimated manifold by predicting parametrized disentangled transformations of a reference pose \((^{3})^{J}\), for which all segments have unit length. Namely, we propose to split the network into two parts (_cf._ Fig. 2):

Figure 2: **Overview of ManiPose. The rotations module predicts \(K\) possible sequences of segment rotations with their corresponding likelihoods (scores), while the segments module estimates the shared segment lengths. Hence, predicted poses are constrained to a manifold defined by the estimated lengths, guaranteeing their consistency.**1. **Segments module**, which predicts segment lengths \(s^{J-1}\), shared by the \(T\) frames (time steps) of the input sequence;
2. **Rotations module**, which predicts the rotation \(r=[r_{1,0},,r_{T,J-1}](^{d})^{J T}\) of each joint relative to their parent joint at each time step.

**Rotations representation.** We represent rotations using 6D continuous embeddings (_i.e._, \(d=6\)). Compared to quaternions or axis-angles, those representations are continuous and, hence, better learned by neural networks, as demonstrated by their proposers .

**Pose decoding.** To deliver pose predictions in \((^{3})^{J T}\), the intermediate representations \((s,r)\) must be decoded. We achieve that in three steps (_cf._ Fig. 3):

1. We scale the unit segments of the reference pose \((^{3})^{J}\) using \(s\), forming a scaled reference pose \(^{}\): \(^{}_{j}=^{}_{(j)}+s_{j}(_{j}- _{(j)})\) for \(0<j J-1\), where \(\) maps the index of a joint to its parent's, if any.
2. For each time step \(1 t T\) and joint \(0 j<J\), we convert the predicted rotation representations \(r_{t,j}\) into rotation matrices \(R_{t,j}(3)\) (Algorithm 1).
3. We apply those rotation matrices \(R_{t,j}\) at each time step \(t\) to the scaled reference pose \(^{}\) using forward kinematics (Algorithm 2).

### Multiple choice learning

**ManiPose architecture.** As explained in the introduction, the inherent depth ambiguity of pose lifting requires multiple hypotheses to conciliate pose consistency and MPJPE performance. To address this, we adopt the multiple choice learning (MCL)  framework, more precisely leveraging the _resilient MCL_ approach as proposed by Letzelter _et al._. This methodology allows the estimation of conditional distributions for regression tasks, enabling our model to predict multiple plausible 3D poses for each 2D input. Specifically, instead of a single rotation \(r_{t}(^{d})^{J}\) per time step, ManiPose's rotations module predicts an intermediate representation \(e_{t}(^{d})^{J}\) that feeds \(K\) linear heads (with weights \(W^{k}_{r}\) and \(W^{k}_{}\)), each predicting its own rotation hypothesis \(r^{k}_{t}(^{d})^{J}\) with a corresponding likelihood \(^{k}_{t}\). That is, for all \(1 t T\), \(r^{k}_{t}=W^{k}_{r}e_{t}\) and \(^{k}_{t}=[_{t}]_{k}\), where the softmax function \(\) is applied to the vector \(_{t}=[^{1}_{t},,^{K}_{t}] ^{K}\) of intermediate values \(^{k}_{t}=W^{k}_{}e_{t}\).

All rotation hypotheses are decoded together with the shared segment-length predictions \(s\), resulting in \(K\) hypothetical pose sequences \(}^{k}=(}^{k}_{t})_{t=1}^{T}\), with corresponding likelihood sequences \(^{k}=(^{k}_{t})_{t=1}^{T}\), called **scores** hereafter (Fig. 2).

**Loss function.** As in , ManiPose is trained with a composite loss

\[=_{}+_{}\,.\] (1)

The first term, \(_{}\), is the winner-takes-all loss 

\[_{}(}(),)= _{t=1}^{T}_{k[\![1,K]\!]}(}^{k}_{t}(),_{t})\,,\] (2)

where \((}^{k}_{t}(),_{t}) _{j=0}^{J-1}\|_{t,j}-}^{k}_{t,j}()\|_{2}\), and \(}^{k}_{t}()\) denotes the pose prediction at time \(t\) using the \(k^{}\) head. The second term, \(_{}\), is the scoring loss

\[_{}(}(),(), )=_{t=1}^{T}(} _{t},_{t}),_{t}()\,,\] (3)

where \((,)\) is the cross-entropy, \(}_{t}=(}^{k}_{t})_{k=1}^{K}\), and

\[[(}_{t},_{t})]_{k}k *{arg\,min}_{k^{}[\![1,K]\!]}(}^{k^{}}_{t},_{t})\] (4)is the indicator function of the _winner_ pose hypothesis, which is the closest to the ground truth. Eq. (3) is the average cross-entropy between target and predicted scores \(_{t}()^{K}\) at each time \(t\).

Those losses are complementary. The winner-takes-all loss updates only the best predicted hypothesis, specializing each head on part of the data distribution . The scoring loss allows the model to learn how likely each head is to winning, thus avoiding overconfidence of non-winner heads (_cf._[19; 45]).

**Conditional distribution estimation.** As detailed in , the model may be interpreted probabilistically as a multimodal conditional density estimator. More precisely, it models the distribution \((|)\) of 3D poses conditioned on 2D poses as a mixture of Dirac distributions:

\[}(|)\,_{k=1}^{K} ^{k}()_{}^{k}()}()\,.\] (5)

Hence, the predicted conditional distribution has, at each predicted hypothesis \(}^{k}\), a peak whose likelihood is given by the predicted score \(^{k}\). As described in Section 4, interpreting hypotheses and scores probabilistically enables us to handle depth ambiguity.

## 4 Formal analysis

ManiPose, as outlined in Section 3, is crafted to address the flaws inherent in unconstrained, single-hypothesis lifting-based 3D-HPE methods (see Fig. 1). This section illustrates that without ManiPose's critical components (multiple hypotheses and manifold constraint), it is impossible to simultaneously minimize joint error and ensure pose consistency (Section 4.1). To illustrate this, a toy example within a simplified 1D-to-2D framework is provided in Section 4.2.

### Single-hypothesis position-error minimization leads to inconsistent skeleton lengths

We formally highlight the limitations of unconstrained single-hypothesis 3D-HPE, justifying our approach, which combines consistency constraints and multiple hypotheses to resolve depth ambiguity.

Let \(=[^{1},,^{J}]^{3 J}\) be a human pose, defined by the Cartesian 3D coordinates of each of the \(J\) joints of a predefined skeleton. Then, a sequence of \(T\) poses of the same subject at increasing time steps \(t_{1} t_{T}\) forms a movement \(=[_{0},,_{T}]^{3 J  T}\). Assuming bone length is fixed during a movement (which is empirically verifiable in human pose datasets), then the poses \(_{t}\) of \(\) must all lie on the same smooth manifold.

**Proposition 4.1** (Human pose manifold).: _Assuming a rigid skeleton, all poses of a movement \(=[_{t}]_{t=1}^{T}\) lie on a manifold \(\) of dimension \(2(J-1)\):_

\[ t\{1,,T\},_{t}\,.\] (6)

**Proof sketch.** (Detailed in Appendix B). Skeleton rigidity implies that, if \(i\) is a joint connected to the root, then it lies on a 2D sphere \(S^{2}(0,s_{i,0})\) centered at the origin with fixed radius \(s_{i,0}\). Another joint \(j\) linked to \(i\) has a position expressible by its spherical coordinates relative to \(i\) with fixed radius \(s_{j,i}\). That implies an homeomorphism between the position \(_{t,j}\) of joint \(j\) and the direct product of spheres centered at the origin \(S^{2}(0,s_{i,0}) S^{2}(0,s_{j,i})\). By induction, one can show that \(_{t}\) lies on a subspace of \((^{3})^{J}\), which is homeomorphic to a product of spheres centered at the origin. 

Proposition 4.1 implies that all poses predicted for a video sequence should ideally lie on the same manifold \(\) as the ground-truth data, which is homeomorphic to the direct product of 2D unit spheres \((S^{2})^{J-1}\) (_cf._ Appendix B). Crucially, we can further show that minimizing joint position error using a single-hypothesis model necessarily leads to predicted poses lying outside the true manifold:

**Proposition 4.2** (Inconsistency of MSE minimizer).: _With a rigid skeleton and mild assumptions on the training distribution, predicted 3D poses minimizing the traditional mean squared error (MSE) loss lie outside the pose manifold \(\)._

Figure 3: **Pose decoder overview.**

**Proof sketch.** (See Appendix B). Consider a skeleton with \(J\) points, with \((,)\), as pairs of corresponding 2D inputs and 3D poses. Let the function \(=(_{j})_{j=1}^{J-1}\) compute the lengths of the segments in a pose, which shall remain constant. On a dataset \(\{(_{i},p_{i})\}_{i=1}^{N}\) drawn from the joint distribution of 2D and 3D poses, let the expected MSE of a traditional predictive model \(f\) be \(_{,}[\|-f()\| _{2}^{2}]\). Let the ideal model \(f^{*}\) be the one minimizing that expected MSE, which is the conditional expectation \(f^{*}()=[\,|\,]\). Jensen inequality and the rigidity assumption imply that, for any joint \(j\), \(_{j}^{2}(f^{*}())<s_{j}^{2}\) where \(s_{j}\) is the true length of the segment associated with joint \(j\). This shows that the poses predicted by \(f^{*}\) violate the original segment length constraints, and thus, the original rigidity assumption. 

Proposition 4.2 has the following implications:

1. Traditional unconstrained single-hypothesis approaches are bound to predict inconsistent movements, where bone lengths may vary.
2. With a single hypothesis, models constrained to the manifold will always lose to unconstrained models in terms of MPJPE performance (formalized in Corollary B.1).
3. The only way of reaching both optimal MPJPE and consistency is through multiple hypotheses (formalized in Corollary B.3).

Therefore, the MPJPE metric (and its traditional extensions) is insufficient to assess 3D-HPE, as it completely ignores pose consistency. Furthermore, we are able to prove in Appendix B.2 that multiple hypotheses (constrained or not) can always reach better joint position errors than single-hypothesis models.

### Insights to the formal argument on a simplified setting

We illustrate the argument of Section 4.1 with a simplified 1D-to-2D setup. We further generalize this intuitive illustration to the 2D-to-3D setting in Appendix C of the supplementary.

As in human pose lifting, we take a root joint \(J_{0}\) as reference, fixed at \((0,0)\). For a joint \(J_{1}\), the problem amounts to predicting the 2D position \((x,y)\), given its 1D projection \(u=x\), assuming a constant distance \(s=1\) between them. This simplification ignores the camera perspective and considers the joints to be connected by a rigid segment as in the case of human poses.

We train three different models with comparable architectures on two datasets \(\{(x_{i},(x_{i},y_{i}))\}_{i=1}^{N}\) sampled from the angular distributions represented in blue on Fig. 4. The models correspond to:

1. A 2-layer MLP (\(}\)) trained to minimize the mean squared error between true \((x,y)\) and predicted joint positions \((,)\);
2. A constrained MLP of the same size (\(}\)), predicting the angle \(\) instead of the joint position;
3. ManiPose: our constrained multi-hypothesis model capable of predicting \(K=2\) possible angles \((^{k})_{k=1}^{K}\) with their corresponding likelihoods.

Fig. 4 shows that the traditional unconstrained single-hypothesis approach (\(}\)) leads to good results in an easy unimodal scenario (C), but fails when facing a more challenging bimodal distribution (D), leading to predictions outside the circle manifold, as depth ambiguity makes the lifting problem ill-posed. The single-hypothesis constrained model (\(}\)) delivers predictions on the circle, at the cost of worse MPJPE performance than the unconstrained MLP. Such performance decrease is due to the Euclidean topology of the MPJPE metric having its minimum (\(}\)) outside the manifold (Fig. 4-B).

Crucially, this implies that the unconstrained single-hypothesis models are bound to make inconsistent predictions, with varying "bone lengths" (the circle radius). It also shows that models constrained to the manifold (circle) will always be outcompeted by unconstrained models on MPJPE performance.

Predicting multiple hypotheses constrained to the circle, with their respective likelihoods (\(}\) in Fig. 4-B) allows escaping this dilemma, which is exactly what ManiPose does (\(}\) in Fig. 4-D). The

    & MPJPE \(\) & Distance to circle \(\) \\  Unconst. MLP & 0.753 \(\) 0.008 & 0.42 \(\) 0.01 \\ Constrained MLP & 0.777 \(\) 0.027 & **0.00 \(\) 0.00** \\ ManiPose & **0.752 \(\) 0.012** & **0.00 \(\) 0.00** \\   

Table 1: **1D-to-2D performance.** Fig. 4-D setting, results averaged over five random seeds.

predicted hypotheses are all on the circle, contrary to the unconstrained MLP, and spread between the two distribution modes, unlike the constrained single-hypothesis method.

Moreover, the predicted scores (length of green lines) match the \(\) and \(\) ground-truth likelihoods of the two modes. Those advantages translate into perfect pose consistency and into comparable MPJPE performance with respect to the unconstrained MLP (Table 1).

## 5 Experiments

### Experimental setup

**Datasets.** We evaluate our model on two 3D-HPE datasets. **Human 3.6M** contains 3.6 million images of 7 actors performing 15 different indoor actions. It is the most widely used dataset for 3D-HPE. Following previous works [52; 27; 53; 38], we train on subjects S1, S5, S6, S7, S8, and test on subjects S9 and S11, adopting a 17-joint skeleton (_cf._ Fig. 5). We employ a pre-trained CPN  to compute the input 2D keypoints, as in [38; 52]. **MPI-INF-3DHP** also adopts a 17-joint skeleton, but, with fewer samples and containing both indoor and outdoor scenes, it is more challenging than Human 3.6M. We used ground-truth 2D keypoints for this dataset, as usually done [53; 4; 52].

**Traditional evaluation metrics.** The mean per-joint position error (MPJPE) is the usual performance metric for the datasets above, under different protocols, both reported in mm. In protocol #1, the root joint position is set as a reference, and the predicted root position is translated to 0. In protocol #2 (P-MPJPE), predictions are additionally Procrustes-corrected. For MPI-INF-3DHP, additional thresholded metrics derived from MPJPE are often reported, such as AUC (Area Under Curve) and PCK (Percentage of Correct Keypoints) with a threshold at 150 mm, as explained in .

**Pose consistency metrics.** MPJPE being insufficient to assess pose consistency (Section 4), we further assess to which extent predicted skeletons are rigid by measuring the average standard deviations of segment lengths across time in predicted action sequences:

\[_{j=1}^{J-1}_{t=1} ^{T}(s_{t,j,(j)}-_{j,(j)})^{2}}\,,\] (7)

with \(s_{t,j,i}=\|}_{t,j}-}_{t,i}\|_{2}\) and \(_{j,i}=_{t=1}^{T}s_{t,j,i}\), where \(\) was defined in Section 3.1. We call this metric, reported in mm, the Mean Per Segment Consistency Error (MPSCE).

Figure 4: **(A) 1D-to-2D articulated pose lifting problem. (B) True MSE minimizers under a multimodal distribution. One-to-one mappings cannot both reach optimal performance and stay on the pose manifold (dashed circle). (C) Without depth ambiguity, unconstrained models are effective. (D) Ambiguity from multimodal distributions challenges both constrained and unconstrained models. Multi-hypothesis approaches can deliver an acceptable solution to the problem.**

Following [12; 40], we also assess the bilateral symmetry of predicted skeletons through the Mean Per Segment Symmetry Error (MPSSE), in mm:

\[_{}| |}_{t=1}^{T}_{j_{}}|s_{t,j,(j) }-s_{t,j^{},(j^{})}|,\ \ j^{}=(j)\,,\] (8)

where \(_{}\) denotes the set of indices of left-side joints and \(\) maps left-side joint indices to their right-side counterparts.

**Multi-hypothesis evaluation protocol.** One must decide how to use multiple hypotheses to compute the metrics. The dominant approach [24; 25; 36; 44; 49; 12] is the **oracle** evaluation, _i.e._, using the predicted hypothesis closer to the ground truth (_i.e._, Eq. (2) for MPJPE). That makes sense for multi-hypothesis methods, as the oracle metric measures the distance between the target and the discrete set of predicted hypotheses. It aligns with the idea of many possible outputs for a given input.

Hypotheses can also be _aggregated_ into a final pose, _e.g._, through unweighted or weighted averaging (using predicted scores). The latter has the disadvantage of falling back to a one-to-one mapping scheme, which is precisely what we want to avoid in a multi-hypothesis setting.

We report both oracle and aggregated metrics in our experiments, favoring oracle results.

**Implementation details.** ManiPose, as presented in Section 3, is compatible with any backbone. Here, we chose to build on the MixSTE  network for both the rotations and the segment modules (the latter in a reduced scale). Details about our architecture and training appear in Appendix D.

### Comparison with the state of the art

**Human 3.6M.** Comparisons with state-of-the-art single- and multi-hypothesis methods are presented in Table 2 and illustrated in Fig. 1. ManiPose outperforms previous methods in terms of Oracle MPJPE in comparable scenarios, while reaching nearly perfect consistency. Moreover, note that MPJPE and consistency metrics are not positively correlated for single-hypothesis methods. As predicted in Section 4.1, our empirical results show that MPJPE improvements achieved by MixSTE come at the cost of poorer consistency compared to previous models. In contrast, the only single-hypothesis constrained model, Anatomy3D , achieves good consistency at the expense of inferior MPJPE. Those results empirically validate the theoretical predictions of Sections 4.1 and B, further

    & \(T\) & \(K\) & Orac. & MPJPE \(\) & MPSSE \(\) & MPSCE \(\) \\   \\ ST-GCN  & 7 & 1 & 48.8 & 8.9 & 10.8 \\ VideoPose3D  & 243 & 1 & 46.8 & 6.5 & 7.8 \\ PoseFormer  & 81 & 1 & 44.3 & 4.3 & 7.2 \\ Anatomy3D  & 243 & 1 & 44.1 & 1.4 & 2.0 \\ MixSTE  & 243 & 1 & 40.9 & 8.8 & 9.9 \\   \\ Wehrbein _et al._ & 1 & 200 & ✓ & 44.3 & 12.2 & 14.8 \\ DiffPose (Holmquist _et al._* & 1 & 200 & ✓ & 43.3 & 14.9 & - \\ GFPPose  & 1 & 200 & ✓ & 35.6 & 13.1 & 16.5 \\ D3DP (P-Best)  & 243 & 20 & ✓ & 39.5 & 6.9 & 9.0 \\ GFPPose \({}^{}\) & 1 & 10 & ✓ & 45.1 & 13.1 & 16.5 \\ Sharma _et al._ & 1 & 10 & ✓ & 46.8 & 13.0 & 9.9 \\ DiffPose (Gong _et al._* & 243 & 5 & ✓ & 39.3 & 5.2 & 6.1 \\ MHFormer  & 351 & 3 & 43.0 & 5.7 & 8.0 \\  ManiPose (Ours) & 243 & 5 & 42.1 & 0.4 & 0.8 \\ ManiPose (Ours) & 243 & 5 & ✓ & **39.1** & **0.3** & **0.5** \\   

Table 2: **Pose consistency evaluation of state-of-the-art methods on Human3.6M.** MPJPE performance and pose consistency are not correlated; only ManiPose excels in both. \(T\): sequence length. \(K\): number of hypotheses. Orac.: Metric computed using oracle hypothesis. Grey lines: Methods where the Oracle MPJPE is computed with non-comparable number of hypotheses with respect to the other baselines. **Bold**: best; Underlined: second best. *: Method with unavailable code ; MPSSE values reported in . \(\): Results with comparable number of hypotheses. \(\): Results computed with official checkpoint and code.

confirming what we have shown, intuitively, in the simplified 1D-to-2D setting (Section 4.2). Note that while ManiPose is deterministic, previous multi-hypothesis methods are generative, except for MHFormer. Table 2 shows that they require up to two orders of magnitude more hypotheses than ManiPose to reach competitive performance (see, _e.g._, the performance of GFPose). This property is expected. Indeed, optimization based on Winner-Takes-All theoretically leads to an optimal coverage of the modes of the conditional distribution with a fixed number of samples , in contrast to generative-based approaches. This is reflected in the oracle metric, which approximates the so-called _quantization_ (or Distortion) error, as defined in (27), when the number of data points is large. More detailed MPJPE results per action appear in Tables 8 and 9 in the supplemental. We also complement our analysis on the diversity of ManiPose in Fig. 11 of the appendix.

Fig. 6 showcases qualitative results, where multiple hypotheses help in depth-ambiguous situations.

**MPI-INF-3DHP.** Similar results were obtained for this dataset (_cf._ Table 3). Not only does ManiPose reach consistency errors close to \(0\), but also best PCK and AUC performance. As for MPJPE, only  achieves slightly better performance, at the cost of large pose consistency errors.

### Ablation study

**Impact of components.** We evaluate the impact of removing each component of ManiPose on the Human 3.6M performance (Table 4). The components tested are the multiple hypotheses (MH) and the manifold constraint (MC). We also compare MC to a more standard manifold regularization (MR), _i.e._, adding Eq. (7) to the loss. Note that without all these components, we fall back to MixSTE , and that the performances reported in Table 4 also appear in Fig. 1.

We see that MR helps to improve pose consistency, but not as much as MC. However, without multiple hypotheses, MC consistency improvements come at the cost of degraded MPJPE performance, as

   & MR & MC & \(K\) & \# Params. & MPJPE \(\) & MPSSE \(\) & MPSCE \(\) \\  ManiPose (Ours) & ✗ & ✓ & 5 & 34.44 M & **39.1** & **0.3** & **0.5** \\ w/o MH & ✗ & ✓ & 1 & 34.42 M & 44.6 & **0.3** & **0.5** \\ w/o MC, w/ MR & ✓ & ✗ & 1 & 33.78 M & 42.3 & 5.7 & 7.3 \\ w/o MR (MixSTE) & ✗ & ✗ & 1 & 33.78 M & 40.9 & 8.8 & 9.9 \\  

Table 4: **Ablation study: Single hypothesis cannot optimize both MPJPE and consistency.** ManiPose uses the same backbone as MixSTE. MR: with manifold regularization. MC: manifold-constrained. **Bold**: best. Underlined: second best.

Figure 5: **MPSCE, MPSSE and MPJPE per segment/coordinate (lower is better).** ManiPose mostly helps to deal with the depth ambiguity (\(z\) coordinate). Ground-truth poses are represented but not visible because they have perfect consistency.

   & \(T\) & PCK \(\) & AUC \(\) & MPJPE \(\) & MPSSE \(\) & MPSCE \(\) \\  VideoPose3D  & 81 & 85.5 & 51.5 & 84.8 & 10.4 & 27.5 \\ PoseFormer  & 9 & 86.6 & 56.4 & 77.1 & 10.8 & 14.2 \\ MixSTE  & 27 & 94.4 & 66.5 & 54.9 & 17.3 & 21.6 \\ P-STMO  & 81 & 97.9 & 75.8 & **32.2** & 8.5 & 11.3 \\  ManiPose (Ours) Aggr. & 27 & 98.0 & 75.3 & 37.7 & **0.6** & **1.3** \\ ManiPose (Ours) Orac. & 27 & **98.4** & **77.0** & 34.6 & **0.6** & **1.3** \\  

Table 3: **Comparison with the state-of-the-art on MPI-INF-3DHP using ground-truth 2D poses.**\(T\): sequence length.

foreseen by our formal analysis (Section 4). Only the combination of both MC and MH allows us to optimize both consistency and MPJPE.

**Fine error analysis.** We can see in Fig. 5 that, compared to MixSTE, ManiPose reaches substantially superior MPSSE and MPSCE, consistency across all skeleton segments. Furthermore, note that larger MixSTE errors occur for segments knee-foot and elbow-wrist, which are the most prone to depth ambiguity. That agrees with coordinate-wise errors depicted in Fig. 5, showing that ManiPose improvements mostly translate into a reduction of MixSTE depth errors, which are twice as large as for other coordinates. Further ablations, including the effect of the number of hypotheses \(K\), the score loss weight \(\) and the rotations representation choice appear in the supplemental.

## 6 Conclusion

We presented a new manifold-constrained multi-hypothesis human pose lifting method (ManiPose) and demonstrated its empirical superiority to the existing state-of-the-art on two challenging datasets. Further, we provided theoretical evidence supporting the tenets of our method, by showing the inherent limitation of unconstrained single-hypothesis approaches to 3D-HPE. We established that unconstrained single-hypothesis methods cannot deliver consistent poses and that constraining or regularizing single-hypothesis models leads to worse position errors. We also showed that traditional MPJPE-like metrics are insufficient to assess consistency.

**Limitations.** To guarantee its consistency, ManiPose relies on the forward kinematics algorithm, which is inherently sequential across joints. Removing that dependence is an interesting avenue for accelerating the method. On another note, while ManiPose ensures the rigidity of the predicted poses, imposing constraints within human body articulation limits presents another area for enhancement.