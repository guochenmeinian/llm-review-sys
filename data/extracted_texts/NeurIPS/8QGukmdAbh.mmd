# New Bounds for Hyperparameter Tuning of

Regression Problems Across Instances

 Maria-Florina Balcan

Carnegie Mellon University

ninamf@cs.cmu.edu

&Anh Tuan Nguyen

Carnegie Mellon University

atnguyen@cs.cmu.edu

&Drayansh Sharma

Carnegie Mellon University

dravyans@cs.cmu.edu

###### Abstract

The task of tuning regularization coefficients in regularized regression models with provable guarantees across problem instances still poses a significant challenge in the literature. This paper investigates the sample complexity of tuning regularization parameters in linear and logistic regressions under \(_{1}\) and \(_{2}\)-constraints in the data-driven setting. For the linear regression problem, by more carefully exploiting the structure of the dual function class, we provide a new upper bound for the pseudo-dimension of the validation loss function class, which significantly improves the best-known results on the problem. Remarkably, we also instantiate the first matching lower bound, proving our results are tight. For tuning the regularization parameters of logistic regression, we introduce a new approach to studying the learning guarantee via an approximation of the validation loss function class. We examine the pseudo-dimension of the approximation class and construct a uniform error bound between the validation loss function class and its approximation, which allows us to instantiate the first learning guarantee for the problem of tuning logistic regression regularization coefficients.

## 1 Introduction

Regularized linear models, including the Elastic Net , and Regularized Logistic Regression , as well as their variants , have found widespread use in diverse fields and numerous application domains. Thanks to their simplicity and interpretability, those methods are popular choices for controlling model complexity, improving robustness, and preventing overfitting by selecting relevant features . Moreover, regularized linear models can be adapted to the non-linear regime using kernel methods , significantly expanding their applicability to a wide range of problems. In typical applications, one needs to solve not only a single regression problem instance, but several related problems from the same domain. Can we learn how to regularize with good generalization across the related problem instances?

Suppose we have a regression dataset \((X,y)^{m p}^{m}\), where \(X\) is a design matrix with \(m\) samples and \(p\) features, and \(y\) is a target vector. Regularized linear models aim to compute an estimator \(^{(X,y)}()\) by solving the optimization problem

\[^{(X,y)}()=*{argmin}_{^{p}} l(,(X,y))+_{1}\|\|_{1}+_{2}\| \|_{2}^{2},\] (1)

where \((_{1},_{2})_{>0}^{2}\) are the regularization coefficients. For instance, if \(_{>0}^{2}\), \(y^{m}\), and \(l(,(X,y))=\|y-X\|_{2}^{2}\) (squared-loss function), we get the well-known Elastic Net . On the other hand, if \(\{(_{1},0),(0,_{2})\}\) for \(_{1},_{2}>0\), \(y\{ 1\}^{m}\), and \(l(,(X,y))=_{i=1}^{m}(1+(-y_{i}x_{i}^{}))\), we obtain regularized logistic regression.

In regularized linear models, the parameters \(\) play a crucial role in controlling the sparsity (\(_{1}\)) and shrinkage (\(_{2}\)) constraints, and are essential in ensuring better generalization and robustness [9; 4; 12]. A popular approach in practice is cross-validation, which involves choosing a finite grid of values of \(\) and iteratively solving the regression problem for multiple values of \(\) and evaluating on held-out validation sets to determine the optimal parameter. Principled techniques with theoretical guarantees suffer from various limitations, for example require strong assumptions about the original problem , or aim to search the optimal parameter over a discrete subset instead of the whole continuous domain. Moreover, repeatedly solving the regression problem is particularly inefficient if we have multiple problem instances from the same problem domain.

In this work, we investigate an alternative setting for tuning regularization parameters, namely _data-driven algorithm design_, following the previous line of work by Balcan et al. . Unlike the traditional approach, which involves considering a single dataset \((X,y)\), in the data-driven approach, we analyze a collection of datasets or problem instances \((X^{(i)},y^{(i)},X^{(i)}_{},y^{(i)}_{})\) drawn from an underlying problem distribution \(\). Our objective is to determine the optimal regularization parameters \(\) so that when using the training set \((X^{(i)},y^{(i)})\) and \(\) to select a model in Optimization problem 1, the selected model minimizes loss on the validation set \((X^{(i)}_{},y^{(i)}_{})\). As remarked by Balcan et al. , data-driven algorithm design can handle more diverse data generation scenarios in practice, including cross validation and multitask-learning [15; 16]. We emphasize that the data-driven setting differs significantly from the standard single dataset setting.

In this paper, we consider the problem of tuning regularization parameters in regularized logistic regression and the Elastic Net across multiple problem instances. Our contributions are:

* We present an improved upper bound (Theorem 3.3) on the pseudo-dimension for tuning the Elastic Net regularization parameters across problem instances by establishing a novel structural result for the validation loss function class (Theorem 3.2). We provide a crucial refinement to the piecewise structure of this function class established by Balcan et al. , by providing a bound on the number of distinct functional behaviors across the pieces. This enables us to describe the computation of the validation loss function as a GJ algorithm , which yields an upper-bound of \(O(p)\) on the pseudo-dimension, a significant improvement of the prior best bound of \(O(p^{2})\) by Balcan et al. , and a corresponding improvement in the sample complexity (Theorem 3.4).
* Furthermore, we establish the tightness of our result by providing the first asymptotically matching lower bound of \((p)\) on the pseudo-dimension (Theorem 3.5). It is worth noting that our results have direct implications for other specialized cases, such as LASSO and Ridge Regression.
* We further extend our results on the Elastic Net to regularized kernel linear regression problem (Corollary 3.6).
* We propose a novel approach to analyze the problem of tuning regularization parameters in regularized logistic regression, which involves indirectly investigating an approximation of the validation loss function class. Using this approach, we instantiate the first learning guarantee for this problem in the data-driven setting (Theorem 4.4).

### Related work

**Model selection for regularized linear models.** Extensive research has focused on the selection of optimal parameters for regularized linear models, including the Elastic Net and regularized logistic regression. This process usually entails choosing the appropriate regularization coefficients for a given dataset [18; 19]. Nevertheless, a substantial proportion of this research relies on heuristic approaches that lack theoretical guarantees [20; 21]. Others have concentrated on creating tuning objectives that go beyond validation error [22; 23], but with no clearly defined procedures for provably optimizing them. The conventional method for selecting a tuning regularization parameter is through grid-based selection, which aims to choose the parameter from a subset, known as a grid, within the parameter space. While this approach provides certain guarantees , it falls short in delivering an optimal solution across the entire continuous parameter space, particularly when using tuning objectives that exhibit numerous discontinuities. Additionally, the grid-based technique is highly sensitive to density, as selecting a grid that is either too dense or too coarse might result in inefficient search or highly inaccurate solutions. Other guarantees require strong assumptions on the data distribution, such as sub-Gaussian noise [25; 13]. Some studies focus on evaluating regularized linear models by constructing solution paths [26; 2; 27]. However, it is important to note that these approaches are primarily computational in nature and do not provide theoretical guarantees.

**Data-driven algorithm design.** Data-driven algorithms can adapt their internal structure or parameters to problem instances from unknown application-specific distributions. It is proved to be effective for a variety of combinatorial problems, such as clustering, integer programming, auction design, and graph-based semi-supervised learning [28; 29; 30; 31]. Balcan et al.  recently introduced a novel approach to tuning regularization parameters in regularized linear regression models, such as Elastic Net and its variants. They applied data-driven analysis to reveal the underlying discrete structure of the problem and leveraged a general result from  to obtain an upper bound on the pseudo-dimension of the problem. To provably tune the regularization parameters across problem instances, they proposed a simple ERM learner and provided sample complexity guarantee for such learner. However, the general techniques from  do not always lead to optimal bounds on the pseudodimension. Our paper is an example of a problem where these bounds (as derived in ) are sub-optimal, and more specialized techniques due to  result in the tighter bounds that we obtain. Also prior work does not establish any lower bound on the pseudodimension. Furthermore, it should be noted that their analysis heavily relies on the assumption of having a closed-form representation of the Elastic Net estimator . This approach may not be applicable in analyzing other regularized linear models, such as regularized logistic regression, for which we propose an alternative approach.

## 2 Problem setting

In this section, we provide a formal definition of the problem of tuning regularization parameters in the Elastic Net and regularized logistic regression (RLR) across multiple problem instances, which follows the settings by Balcan et al. . Given a problem instance \(P=(X,y,X_{},y_{})\), where \((X,y)^{m p}^{m}\) represents the training dataset with \(m\) samples and \(p\) features, and \((X_{},y_{})^{m^{} p} ^{m^{}}\) denotes the validation split with \(m^{}\) samples, we consider the estimator \(_{(X,y)}()\) defined as:

\[_{(X,y)}()*{argmin}_{^{p} }l(,(X,y))+,R(),\] (2)

where \(l(,(X,y))\) represents the objective loss function, \(\) denotes the regularization coefficients, and \(R()=(\|\|_{1},\|\|_{2}^{2})\) represents the regularization vector function.

For instance, if \(_{>0}^{2}\), \(\), and \(l(,(X,y))=l_{}(,(X,y))=\|y-X\|_{2}^{2}\), we get the well-known Elastic Net. On the other hand, if \(\{(_{1},0),(0,_{2})\}\) for \(_{1},_{2}>0\), \(y\{ 1\}^{m}\), and \(l(,(X,y))=l_{}(,(X,y))=_{i=1}^{m}(1+ (-y_{i}x_{i}^{}))\), we obtain RLR with \(_{1}\) or \(_{2}\) regularization. Note that for the Elastic Net hyperparameter tuning problem, we allows the regularization coefficients of both \(_{1},_{2}\) are positive, while in the Regularized Logistic Regression

Figure 1: The process of tuning regularization parameter \(\) across problem instances. Given a set of \(N\) problem instances \(\{P^{(1)},,P^{(N)}\}\) drawn from some problem distribution \(\), one seeks to choose the best parameter \(\) by minimizing the total validation loss \(_{i=1}^{N}h(P^{(i)};)\).

problem, we consider either \(_{1}\) or \(_{2}\) as the regularization term. We then use the validation set \((X_{},y_{})\) to calculate the validation loss \(h(,P)=l(_{(X,y)}(),(X_{},y_{}))\) corresponding to the problem instance \(P\) and learned regularization parameters \(\).

In the _data-driven setting_, we receive a collection of \(n\) problem instances \(P^{(i)}=(X^{(i)},y^{(i)},X_{}^{(i)},y_{}^{(i)})_{m_{i},p_{i},m^{}_{i}}\) for \(i[n]\), where \(_{m_{i},p_{i},m^{}_{i}}:=^{m_{i} p_{i}} ^{m_{i} p_{i}}^{m^{}_{i}}\). The problem space \(_{m,p}\) is given by \(_{m,p}=_{m_{1} 0,m_{2} m,p_{1} P}_{m_{1},p_{1},m_{2}}\), and we assume that problem instance \(P\) is drawn i.i.d from the problem distribution \(\) over \(_{m,p}\). Remarkably, in this setting, problem instances can have varying training and validation sample sizes, as well as different sets of features. This general framework applies to practical scenarios where the feature sets differ among instances and allows one to learn regularization parameters that effectively work on average across multiple different but related problem instances. See Figure 1 for an illustration of the setting.

The goal here is to learn the value \(\) s.t. with high probability over the draw of \(n\) problem instances, the expected validation loss \(_{P}h(,P)\) is close to \(_{}_{P}[h(,P)]\). This paper primarily focuses on providing learning guarantees in terms of sample complexity for the problem of tuning regularization parameters in the Elastic Net and regularized logistic regression (RLR). Specifically, we aim to address the question of how many problem instances are required to learn a value of \(\) that performs well across all problems \(P\) drawn from the problem distribution \(\). To achieve this, we analyze the pseudo-dimension (in the case of the Elastic Net) or the Rademacher Complexity (for RLR) of the validation loss function class \(=\{h(,)\}\), where \(\) represents the search space for \(\).

## 3 Tight pseudo-dimension bounds for Elastic Net hyperparameter tuning

In this section, we will present our results on the pseudo-dimension upper and lower bounds for the regularized linear regression problem in the data-driven setting. Classic learning-theoretic results [33; 34] connect the pseudo-dimension of the validation loss function class (parameterized by the regularization coefficient) with the _sample complexity_ of the number of problem instances \(\{P^{(1)},,P^{(n)}\}\) drawn i.i.d. from some unknown problem distribution \(\) needed for learning good regularization parameters with high confidence. Let \(h_{}(,P)=l_{}(_{(X,y)}(),(X_{ {val}},y_{}))\) be the validation loss function of the Elastic Net, and \(_{}=\{h_{}(,P):_{m,p}_{ 0}_{>0}^{2}\}\) be the corresponding validation loss function class, we now present tight bounds for \((_{})\).

### The Goldberg-Jerrum framework

Recently, Bartlett et al.  instantiate a simplified version of the well-known Goldberg-Jerrum (GJ) Framework . The GJ framework offers a general pseudo-dimension upperbound for a wide class of functions in which each function can be computed by a _GJ algorithm_. We provide a brief overview of the GJ Framework which is useful in establishing our improved pseudo-dimension upper bound.

**Definition 1** (GJ Algorithm, ).: _A **GJ algorithm**\(\) operates on real-valued inputs, and can perform two types of operations:_

* _Arithmetic operators of the form_ \(v^{}=v v^{}\)_, where_ \(\{+,-,,\}\)_, and_
* _Conditional statements of the form_ "_if_ \(v 0\) _else_ \(\)_"._

_In both cases, \(v\) and \(v^{}\) are either inputs or values previously computed by the algorithm._

General speaking, each intermediate value of the GJ algorithm \(\) can be described by a _rational function_, which is a fractional between two polynomials, of the algorithm's inputs. The degree of a rational function is equal to the maximum degree of the polynomials in its numerator and its denominator. We can define two quantities that represent the complexity of GJ algorithms.

**Definition 2** (Complexity of GJ algorithm, ).: _The **degree** of a GJ algorithm is the maximum degree of any rational function it computes of the inputs. The **predicate complexity** of a GJ algorithm is the number of distinct rational functions that appear in its conditional statements._

The following theorem essentially shows that for any function class \(\), if we can describe any function \(f\) by a GJ algorithm of which the degree and predicate complexity are at most \(\) and \(\), respectively, then we can automatically obtain the upper bound for the pseudo-dimension of \(\).

**Theorem 3.1** ().: _Suppose that each function \(f\) is specified by \(n\) real parameters. Suppose that for every \(x\) and \(r\), there is a GJ algorithm \(_{x,r}\) that given \(f\), returns "true" if \(f(x) r\) and "false" otherwise. Assume that \(_{x,r}\) has degree \(\) and predicate complexity \(\). Then, \(()=O(n())\)._

### Upper bound

Our work improves on prior research  by presenting an upper bound on the pseudo-dimension of Elastic Net validation loss function class \(_{}\) parameterized by \(\). We extend the previous piecewise-decomposable structure of the loss function by providing a bound on the number of distinct rational piece functions for any fixed problem instance (Definition 3). This allows us to use a GJ algorithm and Theorem 3.1 to obtain better bounds on the number of distinct predicates that need to be computed. While prior research only used a bound on the number of distinct loss function pieces generated by algebraic boundaries, our new observation that the loss function has a limited number of possible distinct functional behaviors yields a tighter upper bound on the pseudo-dimension (Theorem 3.2). In Theorem 3.5, we will demonstrate the tightness of our upper bound by providing a novel lower bound for the problem.

We first provide a refinement of the piece-wise decomposable function class terminology introduced by  which is useful for establishing our improved upper bound. Intuitively, this corresponds to real-valued functions for which the domain is partitioned by finitely many _boundary functions_ such that the function is well-behaved in each piece in the partition, i.e. can be computed using a _piece function_ from another function class.

**Definition 3**.: _A function class \(^{}\) that maps a domain \(\) to \(\) is \((,k_{},,k_{})-\)piece-wise decomposable for a class \(\) of boundary functions and a class \(^{}\) of piece functions if the following holds: for every \(h\), (1) there are \(k_{}\) functions \(g^{(1)},,g^{(k_{})}\) and a function \(f_{}\) for each bit vector \(\{0,1\}^{k_{}}\) s.t. for all \(y\), \(h(y)=h_{_{y}}(y)\) where \(_{y}=\{(g^{(1)}(y),,g^{(k_{})}(y))\}\{0,1\}^{k_{ }}\), and (2) there is at most \(k_{}\) different functions in \(\)._

A key distinction from  is the finite bound \(k_{}\) on the number of different piece functions needed to define any function in the class \(\). Under this definition we give the following more refined structure for the Elastic Net loss function class by extending arguments from .

**Theorem 3.2**.: _Let \(_{}}=\{h_{}}(,):_{m,p} _{ 0}_{ 0}^{2}\}\) be the class of Elastic Net validation loss function class. Consider the dual class \(^{*}_{}}=\{h^{*}_{p}:_{}} _{ 0} P_{m,p}\}\), where \(h^{*}_{P}(h_{}}(,))=h_{}}(,P)\). Then \(^{*}_{}}\) is \((,3^{p},,3^{p})\)-piecewise decomposable, where the piece function class \(=\{f_{q}:_{}}\}\) consists at most \(3^{p}\) rational functions \(f_{q_{1},q_{2}}:h_{}}(,)(_{1 },_{2})}{q_{2}(_{1},_{2})}\) of degree at most \(2p\), and the boundary function class \(=\{g_{r}:_{}}\{0,1\}\}\) consists

Figure 2: An illustration of piece-wise structure of \(^{*}_{}}=\{h^{*}_{P}:_{}} _{ 0} P_{m,p}\}\). Given a problem instance \(P\), the function \(h^{*}_{P}()=h(P;)\) is a fixed rational function \(f_{i}()\) in each piece (piece function), that is regulated by boundary functions \(g_{r_{i}}\) of the form \(\{r_{i}()<0\}\). As mentioned in our main result, there are at most \(3^{p}\) functions \(f_{i}\) of degree at most \(2p\), and at most \(p3^{p}\) functions \(g_{r_{i}}\) where \(r_{i}\) is a polynomial of degree at most \(p\).

of semi-algebraic sets bounded by at most \(p3^{p}\) algebraic curves \(g_{r}:h_{}(,)\{r(_{1},_{2})<0\}\), where \(r\) is a polynomial of degree at most \(p\)._

Figure 2 demonstrates the piece-wise structure of \(_{}^{*}\), which allows us to establish an improved upper bound on the pseudo-dimension.

**Theorem 3.3**.: _Let \(_{}=\{h_{}(,):_{ 0 }_{>0}^{2}\}\) be the Elastic Net validation loss function class that maps problem instance \(P\) to validation loss \(h_{}(,P)\). Then \((_{})\) is \(O(p)\)._

_Proof Sketch._ For every problem instance \(P_{m,p}\), and a threshold \(r\), consider the computation \(\{h_{}(,P)-r 0\}\) for any \(h_{}(,)_{}\). From Theorem 3.2, we can describe \(\{h_{}(,P)-r 0\}\) as a GJ algorithm \(_{P,r}\) which is specified by 2 parameters \(_{1},_{2}\), has degree of at most \(2p\), and has predicate complexity of at most \((p+1)3^{p}\) (See Figure 3). Then Theorem 3.1 implies that \((_{})=O(p)\). \(\)

The detailed proof of Theorem 3.3 can be found on Appendix B.1.2. Recent work by Balcan et al.  also studied the Elastic Net, and showed the piece-wise structure of the dual function of the validation loss function which implies an upper bound of \(O(p^{2})\) by employing the general tool from . We establish a tighter bound of \(O(p)\) in Theorem 3.3 by establishing additional properties of the loss function class and giving a GJ algorithm for computing the loss functions.

To guarantee the boundedness of the considered validation loss function classes, we will have the following assumptions for the data and regularization parameters. The first assumption is that all features and target values in the training and validation examples are bounded. The second assumption is that we only consider regularization coefficient values \(\) within an interval \([_{},_{}]\). In practice, those assumptions are naturally satisfied by data normalization.

**Assumption 1** (Bounded covariate and label).: _We assume that all the feature vectors and target values in training and validation set is upper-bounded by absolute constants \(R_{1}\) and \(R_{2}\), i.e. \(\{\|X\|_{},\|X_{}\|_{}\} R _{1}\), and \(\{\|y\|_{},\|y_{}\|_{}\} R _{2}\)._

**Assumption 2** (Bounded Coefficient).: _We assume that \([_{},_{}]^{2}\) with \(_{}>0\)._

Under Assumptions 2, 1, Theorem 3.3 immediately implies the following generalization guarantee for Elastic Net hyperparameter tuning.

**Theorem 3.4**.: _Let \(\) be an arbitrary distribution over the problem instance space \(_{m,p}\). Under Assumptions 1, 2, the loss functions in \(_{}\) have range bounded by some constant \(H\) (Lemma C.1). Then there exists an algorithm s.t. for any \(,>0\), given \(N=O(}{^{2}}(p+()))\) sample problem instances drawn from \(\), the algorithm outputs a regularization parameter \(\) such that with probability at least \(1-\), \(_{P}h_{}(,P)<_{} _{P}h_{}(,P)+\)._

_Proof._ Denote \(^{*}=*{argmin}_{}_{P}h_{ }(,P)\). From Theorems 3.3 and A.2, given \(n=O(}{^{2}}(p+()))\) problem instances \(P^{(i)}\) for \(i[N]\) drawn from \(\), w.p. \(1-\), we have \(_{P}h_{}(,P)<_{i=1 }^{N}h_{}(,P^{(i)})+<_{i= 1}^{N}h_{}(^{*},P^{(i)})+<_{P }h_{}(^{*},P)+\). \(\)

Figure 3: An illustration of how \(\{h_{}(,P)-r 0\}\) is computed as a GJ algorithm. The number of boundary (polynomial) functions \(k_{}\) is at most \(p3^{p}\), and there are at most \(M=3^{p}\) distinct (rational) piece functions. All the polynomial and rational functions are of degree at most \(2p\).

### Lower bound

Remarkably, we are able to establish a matching lower bound on the pseudo-dimension of the Elastic Net loss function class, parameterized by the regularization parameters. Note that every Elastic Net problem can be converted to an equivalent LASSO problem . In fact, we show something stronger, that the pseudo-dimension of even the LASSO regression loss function class (parameterized by regression coefficient \(_{1}\)) is \((p)\), from which the above observation follows (by taking \(_{2}=0\) in our construction). Our proof of the lower bound adapts the "adversarial strategy" of  which is used to design a worst-case LASSO regularization path. While  construct a single dataset to bound the number of segments in the piecewise-linear LASSO solution path, we create a collection of problem instances for which all above-below sign patterns may be achieved by selecting regularization parameters from different segments of the solution path.

**Theorem 3.5**.: _Let \(_{}\) be a set of functions \(\{h_{}(,):_{m,p}_{ 0} ^{+}\}\) that map a regression problem instance \(P_{m,p}\) to the validation loss \(h_{}(,P)\) of LASSO trained with regularization parameter \(\). Then \(}(_{})\) is \((p)\)._

Proof Sketch.: Consider \(N=p\) problem instances for LASSO regression given by \(P^{(i)}=(X^{(i)},y^{(i)},X^{(i)}_{},y^{(i)}_{})\), where the training set \((X^{(i)},y^{(i)})=(X^{*},y^{*})\) is fixed and set using the "adversarial strategy" of , Proposition 2. The validation sets are given by single examples \((X^{(i)}_{},y^{(i)}_{})=(_{i},0)\), where \(_{i}\) are standard basis vectors in \(^{p}\). We will now proceed to provide the witnesses \(r_{1},,r_{N}\) and \(\) values to exhibit a pseudo-shattering of these problem instances.

Corresponding to subset \(T[p]\) of problem instances, we will provide a value of \(_{T}\) such that, we have \(_{}(_{T},P^{(i)})>r_{i}\) iff \(i T\), for each \(i[p]\) and each \(T[p]\). We set all witnesses \(r_{i}=0\) for all \(i[p]\). As a consequence of Theorem 1 in , the regularization path of \((X^{*},y^{*})\) consists of a linear segment corresponding all \(2^{p}\) unsigned sparsity patterns in \(\{0,1\}^{p}\) (we will not need all the segments in the construction, but note that it is guaranteed to contain all distinct unsigned sparsity patterns) and we select \(_{T}\) as any interior point corresponding to a linear segment with sparsity pattern \(\{(c_{1},,c_{p}) c_{i}=0\) iff \(i T\}\), i.e. elements in \(T\) are exactly the ones with sparsity pattern 0. Therefore, \(|_{T}^{*}_{i}|=0\) iff \(i T\), where \(_{T}^{*}\) is the LASSO regression fit for regularization parameter \(_{T}\). This implies the desired shattering condition w.r.t. witnesses \(r_{1}=0,,r_{N}=0\). Therefore, \(}(_{}) p\). See Appendix B.2 for a full proof. 

### Hyperparameter tuning in Regularized Kernel Regression

The Kernel Least Squares Regression () is a natural generalization of the linear regression problem, which uses a kernel to handle non-linearity. In this problem, each sample has \(p_{1}\) feature, corresponding to a real-valued target. Formally, each problem instance \(P\) drawn from \(\) can be described as

\[P=(X,y,X_{},y_{})^{m p_{1}} ^{m}^{m^{} p_{1}}^{m^{ }}.\]

A common issue in practice is that the relation between \(y\) and \(X\) is non-linear in the original space. To overcome this issue, we consider the mapping \(:^{p_{1}}^{p_{2}}\) which maps the original input space to a new feature space in which we hopefully can perform linear regression. Define \((X)=((x_{1}),,(x_{m}))_{m p_{2}}\), our goal is to find a vector \(^{p_{2}}\) so that the squared loss \(\|y-(X)\|_{2}^{2}+R(\|\|)\) is minimized, where the regularization term \(R(\|\|)\) is any strictly monotonically increasing function of the Hilbert space norm. It is well-known from the literature (e.g. ) that under the Representer Theorem's conditions, the optimal value \(^{*}\) can be linearly represented by row vectors of \((X)\), i.e., \(^{*}=(X)=_{i=1}^{m}(x_{i})_{i}\), where \(=(_{1},,_{m})^{m}\). This directly includes the \(_{2}\) regularizer but does not include \(_{1}\) regularization. To overcome this issue, Roth () proposed an alternative approach to regularized kernel regression, which directly restricts the representation of coefficient \(\) via a linear combination of \((x_{i})\), for \(i[m]\). The regularized kernel regression hence can be formulated as

\[^{(X,y)}_{l,}=*{argmin}_{^{m }}\|y-K\|_{2}^{2}+_{1}\|\|_{ 1}+_{2}\|\|_{2}^{2},\]

where \(k(x,x^{})=(x),(x^{})\) is the kernel mapping, and the Gram matrix \(K\) satisfies \([K]_{i,j}=k(x_{i},x_{j})\) for all \(i,j[m]\).

Clearly, the problem above is a linear regression problem. Formally, denote \(h_{}(,P)=\|y-K_{(X,y)}()\|_{2}\) and let \(_{}=\{h_{}(,):_{m,p} _{ 0}_{+}^{2}\}\). The following result is a direct corollary of Theorem 3.3, which gives an upper bound for the pseudo-dimension of \(_{}\).

**Corollary 3.6**.: \((_{})=O(m)\)_._

Note that \(m\) here denotes the training set size for a single problem instance, and Corollary 3.6 implies a guarantee on the number of problem instances needed for learning a good regularization parameter for kernel regression via classic results [33; 34]. Our results do not make any assumptions on the \(m\) samples within a problem instance/dataset; if these samples within problem instances are further assumed to be i.i.d. draws from some data distribution (distinct from problem distribution \(\)), then well-known results imply that \(m=O(k p)\) samples are sufficient to learn the optimal LASSO coefficient [37; 38], where \(k\) denotes the number of non-zero coefficients in the optimal regression fit.

## 4 Hyperparameter tuning for Regularized Logistic Regression

Logistic regression is more naturally suited to applications modeling probability of an event, like medical risk for a patient , predicting behavior in markets , failure probability of an engineering system  and many more applications . It is a fundamental statistical technique for classification, and regularization is again crucial for avoiding overfitting and estimating variable importance. In this section, we will present learning guarantees for tuning the Regularized Logistic Regression (RLR) regularization coefficients across instances. Given a problem instance \(P\) drawn from a problem distribution \(\) over \(_{m,p}\), let \(h_{}(,P)=l_{}(_{(X,y)}(),(X_{},y_{}))\) be the RLR validation loss function class (defined in Section 2), and let \(_{}=\{h_{}(,):_{m,p} _{ 0}_{>0}\}\) be the RLR validation loss function class, our goal is to provide a learning guarantee for \(_{}\). Besides, we also study the commonly used 0-1 validation loss function class \(_{}^{0:1}=\{h_{}^{0:1}(, ):_{m,p}_{ 0}_{>0}\}\), where \(h_{}^{0:1}(,P)=}_{i=1}^{m^{ }}\{y_{i}x_{i}^{}_{X,y}() 0\}\), which we will cover in Section 4.3. Similarly, to guarantee the boundedness of \(_{}\), we also assume that Assumptions 1 and 2 also hold in this setting.

### Approximate solutions of Regularized Logistic Regression

The main challenge in analyzing the regularized logistic regression, unlike the regularized logistic regression problem, is that the solution \(_{(X,y)}()\) corresponding to a problem instance \(P\) and particular value \(>0\) does not have a closed form depending on \(\). We then propose an alternative approach to this end, which is examining via the approximation \(_{(X,y)}^{()}()\) of the solution \(_{(X,y)}()\).

``` Set \(_{0}^{()}=_{(X,y)}(_{})\), \(t=0\), small constant \(_{>0}\), and \(=\{j[_{(X,y)}(_{})]_{j} 0\}\). while\(_{t}<_{}\)do \(_{t+1}=_{t}+\) \((_{t+1}^{()})_{}=(_{t}^{( )})_{}-[^{2}l(_{t}^{()},(X,y) )_{}]^{-1}[ l(_{t}^{( )},(X,y))_{}+_{t+1}(_{t}^ {()})_{}]\) \((_{t+1}^{()})_{-}=\) \(=\{j l(_{t+1}^{( )},(X,y))>_{t+1}\}\) \(=\{j|_{t+1,j}^{( )}|<\}\) \(t=t+1\) ```

**Algorithm 1** Approximate incremental quadratic algorithm for RLR with \(_{1}\) penalty, 

The approximation Algorithm 1 (Algorithm 2) for the solution \(()\) of RLR under \(_{1}\) (or \(_{2}\)) constraint were first proposed by Rosset [26; 2]. Given a problem instance \(P\), and a sufficiently small step-size \(>0\), using Algorithms 1, 2 yields an approximation \(_{(X,y)}^{()}\) of \(_{(X,y)}\) that are piece-wise linear functions of \(\) in total \((_{}-_{})/\). Moreover, it is also guaranteed that the error between \(_{(X,y)}^{()}\) and \(_{(X,y)}\) is uniformly upper bounded for all \([_{},_{}]\).

**Theorem 4.1** (Theorem 1, ).: _Given a problem instance \(P\), for small enough \(\), there is a uniform bound \(O(^{2})\) on the error \(\|_{(X,y)}()-_{(X,y)}^{()}()\|_{2}\) for any \([_{},_{}]\)._

Denote \(h_{}^{()}(,P)=l_{}(^{} (),(X_{},y_{}))\) the approximation function of the validation loss \(h_{}(,P)\). Using Theorem 4.1 and note that the loss \(f(z)=(1+e^{-z})\) is \(1\)-Lipschitz, we can show that the difference between \(h_{}^{()}(,P)\) and \(h_{}(,P)\) is uniformly upper-bounded.

**Lemma 4.2**.: _The approximation error of the validation loss function is uniformly upper-bounded \(|h_{}^{()}(,P)-h_{}(,P)|=O( ^{2})\), for all \([_{},_{}]\)._

We now present one of our main results, which is the pseudo-dimension bound of the approximate validation loss function class \(_{}^{()}\).

**Theorem 4.3**.: _Consider the RLR under \(_{1}\) (or \(_{2}\)) constraint with parameter \([_{},_{}]\) that take a problem instance \(P\) drawn from an unknown problem distribution \(\) over \(_{m,p}\). Under Assumptions 1 and 2, \(_{}\) is bounded by some constant \(H\) (Lemma C.2). Suppose that we use Algorithm 1 (or Algorithm 2) to approximate the solution \(_{(X,y)}()\) by \(_{(X,y)}^{()}()\) with a uniform error \(O(^{2})\) for any \([_{},_{}]\), where \(\) is the approximation step-size. Consider the approximation validation loss function class \(_{}^{()}=\{h_{}^{()}( ,):_{m,p}_{ 0}[ _{},_{}]\}\), where_

\[h_{}^{()}(,P)=}_{i=1}^{m ^{}}(1+(-y_{i}x_{i}^{}_{(X,y)}^{()}()))\]

_is the approximate validation loss. Then we have \((_{}^{()})=O(m^{2}+(1/ ))\). Further, we assume that \(=O()\) where \(H\) is the upperbound of \(_{}\) under Assumptions 1 and 2. Given any set \(\) of \(T\) problem instances drawn from a problem distribution \(\) over \(_{m,p}\), the empirical Rademacher complexity \(}(_{}^{()},)=O(H +(1/))/T})\)._

The key observation here is that the approximation solution \(_{(X,y)}^{()}\) is piece-wise linear over \((_{}-_{})/\) pieces, leading to the fact that the approximate validation loss function \(h_{}^{()}(,)\) is a "special function" (Pfaffian function ) in each piece, which is a combination of exponentiation of linear functions of \(\). The detailed proof of Theorem 4.3 can be found on the Appendix D.3.

### Learning guarantees for Regularized Logistic Regression hyperparameter tuning

Our goal now is to use the upper bound for empirical Rademacher complexity of the validation loss function class \(_{}\). We use techniques for approximate data-driven algorithm design due to , combining the uniform error upper bound between validation loss function \(h_{}(,P)\) and its approximation \(h_{}^{()}(,P)\) (Lemma 4.2) and empirical Rademacher complexity of approximation validation loss function class \(_{}^{()}\) (Theorem 4.3), to obtain a bound on the empirical Rademacher complexity of \(_{}\). This allows us to give a learning guarantee for the regularization parameters \(\), which is formalized by the following theorem.

**Theorem 4.4**.: _Consider the RLR under \(_{1}\) (or \(_{2}\)) constraint. Under Assumptions 1, 2, \(_{}\) is bounded by some constant \(H\) (Lemma C.2). Consider the class function \(_{}=\{h_{}(,):_{m,p} _{ 0}[_{},_{}]\}\) where \(h_{}(,P)\) is the validation loss corresponding to probleminstance \(P\) and the \(_{1}\)\((_{2})\) parameter \(\). Given any set \(\) of \(T\) problem instances drawn from a problem distribution \(\) over \(_{m,p}\), for any \(h_{}(,)_{}\), w.p. \(1-\) for any \((0,1)\), we have_

\[|_{i=1}^{T}h_{}(,P^{(i)})-_{P }[h_{}(,P)]| O(H+(1/)}{T}}+^{2}+} ),\]

_for some sufficiently small \(\)._

The proof detail of Theorem 4.4 is included in the Appendix D.3. The above generalization guarantee gives a bound on the average error on RLR validation loss over the problem distribution, for the parameter \(\) learned from \(T\) problem instances. In commonly used approaches, the validation set size is small or a constant, and our result can be interpreted as the upper bound on the generalization error in terms of the number of problem instances \(T\) and the step length \(\). We only consider RLR under \(_{1}\) (or \(_{2}\)) constraints, which are commonly studied in the literature, our analysis could be easily extended to RLR under \(_{q}\) constraint for any \(q 1\).

### An extension to 0-1 loss

Since logistic regression is often used for binary classification tasks, it is interesting to consider the 0-1 loss as the validation loss function. It has been shown that \(\{z 0\} 4(1+e^{-z})\) for any \(z\). This inequality, combined with Theorem 4.4, directly provides a learning guarantee for the 0-1 validation loss function.

**Theorem 4.5**.: _Let \(>2^{2}\) and \((0,1)\), where \(\) is the approximation step-size. Then for any \(n s(/2,)=((m^{2}+)+ }{(/2-^{2})^{2}})\), if we have \(n\) problem instances \(\{P^{(i)},,P^{(n)}\}\) drawn i.i.d. from some problem distribution \(\) over \(_{m,p}\) to learn the regularization parameter \(^{ERM}\) for RLR via ERM, then_

\[_{P}(h_{}^{0:1}(^{ERM},P))) 4 _{[_{},_{}]}_{P} (h_{}(,P))+4.\]

The detailed proof of Theorem 4.5 can be found on Appendix D.4. It is worth noting that we are providing learning guarantee for 0-1 validation loss function class \(_{}^{0:1}\) indirectly via the validation loss function class \(_{}\) with cross-entropy objective function, which is arguably not optimal. The question of how to provide a true PAC-learnable guarantee for \(_{}^{0:1}\) remains an interesting challenge.

## 5 Conclusion and future work

In this work, we present novel learning guarantees for tuning regularization parameters for both the Elastic Net and Regularized Logistic Regression models, across problem instances. For the Elastic Net, we propose fine-grained structural results that pertain to the tuning of regularization parameters. We use them to give an improved upper bound on the pseudo-dimension of the relevant validation loss function class of and we prove that our new bound is tight.

For the problem of tuning regularization parameters in regularized logistic regression, we propose an alternative approach that involves analyzing the approximation of the original validation loss function class. This approximation, characterized by a piece-wise linear representation, provides a useful analytical tool in the absence of an exact dependence of the logistic loss on the regularization parameters. Additionally, we employ an upper bound on the approximation error between the original and approximated functions, to obtain a learning guarantee for the original validation loss function class. Remarkably, our proposed approach is not restricted solely to regularized logistic regression but can be extended to a wide range of other problems, demonstrating its generality and applicability.

It is worth noting that this work only focuses on the sample complexity aspect of the hyperparameter tuning in the Elastic Net and Regularized Logistic Regression. The question of computational complexity in this setting is an interesting future direction. Other interesting questions include designing hyperparameter tuning techniques for this setting that are robust to adversarial attacks, and hyperparameter tuning for Regularized Logistic Regression with both \(_{1}\) and \(_{2}\) constraints.

Acknowledgement

We thank Yingyu Liang for useful discussions during early stages of this work and Mikhail Khodak for helpful feedback. This work was supported in part by NSF grants CCF-1910321 and SES-1919453, the Defense Advanced Research Projects Agency under cooperative agreement HR00112020003, and a Simons Investigator Award.