# The key contributions of this paper are:

SE(3)-Invariant Multiparameter Persistent Homology for Chiral-Sensitive Molecular Property Prediction

Andac Demir

Novartis

Francis Prael III

Novartis

Bulent Kiziltan

Novartis

{andac.demir, francis.prael_iii, bulent.kiziltan}@novartis.com

###### Abstract

In this study, we present a novel computational method for generating molecular fingerprints using multiparameter persistent homology (MPPH). This technique holds considerable significance for key areas such as drug discovery and materials science, where precise molecular property prediction is vital. By integrating SE(3)-invariance with Vietoris-Rips persistent homology, we effectively capture the three-dimensional representations of molecular chirality. Chirality, an intrinsic feature of stereochemistry, is dictated by the spatial orientation of atoms within a molecule, defining its unique 3D configuration. This non-superimposable mirror image property directly influences the molecular interactions, thereby serving as an essential factor in molecular property prediction. We explore the underlying topologies and patterns in molecular structures by applying Vietoris-Rips persistent homology across varying scales and parameters such as atomic weight, partial charge, bond type, and chirality. Our method's efficacy can be further improved by incorporating additional parameters such as aromaticity, orbital hybridization, bond polarity, conjugated systems, as well as bond and torsion angles. Additionally, we leverage Stochastic Gradient Langevin Boosting (SGLB) in a Bayesian ensemble of Gradient Boosting Decision Trees (GBDT) to obtain aleatoric and epistemic uncertainty estimates for gradient boosting models. Using these uncertainty estimates, we prioritize high-uncertainty samples for active learning and model fine-tuning, benefiting scenarios where data labeling is costly or time consuming. Our approach offers unique insights into molecular structure, distinguishing it from traditional single-parameter or single-scale analyses. When compared to conventional graph neural networks (GNNs) which usually suffer from oversmoothing and oversquashing, MPPH provides a more comprehensive and interpretable characterization of molecular data topology. We substantiate our approach with theoretical stability guarantees and demonstrate its superior performance over existing state-of-the-art methods in predicting molecular properties through extensive evaluations on the MoleculeNet benchmark datasets.

## 1 Introduction

Molecular property prediction has received substantial interest in recent years to accelerate the drug discovery process  and predict the 3D structure of proteins , with models showing potential to solve contemporary problems in materials science  and quantum chemistry . Recent adaptations of GNNs, including GIN , GAT , and MPNN , have demonstrated leading performance in molecular representation learning, excelling across various compound datasetsfor bioactivity and molecular property prediction tasks. Despite their success, utilization of GNNs for molecular property prediction suffers from \(3\) severe limitations:

_Oversmoothing:_ Neighborhood information is typically aggregated by permutation invariant, but non-injective operations such as an average, sum or max. This leads to an _oversmoothing_ problem, where node embeddings converge to similar values and the information-to-noise ratio of the message received by the nodes decreases [9; 47].

_Oversquashing:_ GNNs are susceptible to a bottleneck known as _oversquashing_. This occurs when the amount of information aggregated from an exponentially growing receptive field exceeds a node's capacity to process. As the number of GNN layers (and thus the receptive field) increases, all the information is compressed into fixed-length node vectors, potentially causing the loss of important information from more distant nodes .

_Capturing 3D spatial information or conformational changes:_ Traditional GNNs primarily focus on atomic connectivity through ionic and covalent bonds, often neglecting crucial intermolecular forces like hydrogen bonds, dipole-dipole interactions, and Van der Waals forces. These forces, although subtle, significantly impact molecular conformation and the resulting physical, chemical, and reactive properties of molecules. Despite their seemingly weak nature, the incorporation of 3D molecular conformers into analysis improves the accuracy of molecular property prediction [52; 27; 38; 25]. Yet, generating low energy stable 3D conformers for large-scale applications is computationally demanding [66; 53; 23]. Some methods instead use bond lengths, angles, or torsion angles as additional 3D features [10; 27; 25].

Chirality is a concept in stereochemistry, a branch of chemistry focused on the 3D arrangement of atoms in molecules, and the effects of these arrangements on the chemical properties and reactions of those molecules. A molecule is said to be chiral if it cannot be superimposed on its mirror image . It is paramount in drug design as it can lead to chiral sets of molecules, despite their similar physicochemical properties, exhibiting significantly different affinities, efficacies, and potencies when interacting with drug targets . An example of this is the common cardiovascular medication, amlodipine (Figure 1) . Amlodipine, functioning by inhibiting voltage-gated calcium channels (VGCCs), exists as two chiral forms: \(S\)-amlodipine and \(R\)-amlodipine, with the former being therapeutically active and the latter mostly inactive . Despite their similar chemical structures, the distinct 3D orientations allow \(S\)-amlodipine to bind to a VGCC pocket and inhibit its activity, while preventing \(R\)-amlodipine from doing the same . Consequently, \(S\)-amlodipine exhibits significant

Figure 1: **Chirality** (a, b) 2D chemical representation of (a) S-amlodipine, an FDA-approved calcium channel inhibitor and its enantiomer (b) R-amlodipine, a compound lacking calcium channel activity. The stereocenters on each are labeled in blue and magenta, respectively. (c, d) 3D representations of these molecules, with differences in 3D space highlighted. (c) Model of S-amlodipine bound within its binding pocket on a calcium channel, generated from empirical structural data (PDB ID: 7JPK ). (f) A model of R-amlodipine bound to the same pocket. The red asterisk marks a steric clash between the molecule and the binding pocket, indicating the inability of R-amlodipine to bind this pocket in this orientation. The inability of R-amlodipine to form a productive binding interaction is consistent with its lack of biological activity on this channel.

therapeutic value, unlike \(R\)-amlodipine. This underscores the necessity to consider chirality in drug design for achieving high specificity and minimal side effects.

One of the most common manifestations of chirality in organic molecules is tetrahedral (point) chirality, where a central atom, typically carbon, is bonded to four non-equivalent chemical groups. This arrangement results in non-superimposable mirror images called enantiomers . Enantiomers are denoted by dashed (Figure 1a) and bold (Figure 1b) wedges, indicating the orientation of the bonds relative to the plane of the molecule. Accurately differentiating enantiomers poses a challenge for Euclidean group [E(3)]-invariant GNNs that solely consider pairwise atomic distances or bond angles in their message updates, like SchNet . These models struggle to distinguish between enantiomers due to the inversion of chiral centers upon reflection. To address this, incorporating Special Euclidean group [SE(3)]-invariance becomes crucial in molecular property prediction [2; 39]. By accounting for SE(3)-invariance, models can effectively generalize across various molecular conformations, including chiral systems, leading to enhanced performance even with limited training data.1. We introduce a novel compound fingerprinting method by integrating SE(3)-invariance into _Vietoris-Rips persistent homology_, generating robust and versatile representations for chiral compound property prediction, thereby eliminating the need for multi-conformer data augmentation and expensive equivariant operations, such as spherical harmonics and Clebsch-Gordan coefficients.
2. We leverage Stochastic Gradient Langevin Boosting (SGLB)  in a Bayesian ensemble of Gradient Boosting Decision Trees (GBDT) . This allows us to separately quantify both _aleatoric_ and _epistemic uncertainties_, aiding in error prevention and the identification of informative compounds for data collection.
3. We establish _theoretical guarantees for the stability of compound fingerprints_ derived through MPPH.
4. Our method, validated through empirical evaluations on MoleculeNet benchmark datasets, surpasses state-of-the-art baselines significantly, proving the _superior predictive performance_ of the MPPH-based approach.

## 2 Related Work

There are two primary strategies for predicting the physical and chemical properties of molecules: 1) The utilization of established models such as random forest or gradient boosting decision trees, which rely on expert-engineered descriptors or molecular fingerprints, and 2) The optimization of GNN model architectures. In the first strategy, models operate on molecular fingerprints like SMILES , Dragon descriptors , Extended Connectivity Fingerprints (ECFP) [50; 70] or eigenspectrum of Coulomb matrices . Enhancements in this approach can be achieved by enriching the feature representation of nodes (atoms) with additional chemical information. Additionally, some studies have used explicit 3D atomic coordinates to further improve performance [52; 36; 18; 20]. The second strategy emphasizes optimizing model architecture and enhancing neighborhood aggregation. Graph Convolutional Neural Networks (GCN), for instance, generate a compound's feature representation through the convolution operations performed in the spectral domain of the compound's \(2D\) graph , which is obtained by transforming the graph into a set of eigenvectors and eigenvalues. Similarly, Message Passing Neural Networks (MPNN) update node and edge representations by passing messages between nodes, iteratively constructing a graph representation. Recently, conformer generation, accounting for molecules' 3D structures, has become crucial in property prediction . This is particularly important for non-rigid molecules that can adopt diverse conformations under varying conditions. 3D Infomax  pre-trains a \(2D\) network by maximizing the mutual information (MI) between its representation of a molecular graph and a 3D representation produced from the molecules' conformers. The weights of \(2D\) network are then fine-tuned to predict properties.

Additionally, the development of chiral-sensitive molecular representations is an area of significant interest in computational chemistry. DimeNet  and its faster successors DimeNet++  and GemNet  use spherical harmonics and Clebsch-Gordan coefficients to represent the relative directional information. SphereNet  improves computational efficiency by proposing spherical message passing, while SE(3)-Transformer leverages Wigner-D matrices for learning SO(3)'s irreducible representations. While these models can potentially learn chirality, their efficacy for molecular property prediction remains unexplored. Moreover, they utilize computationally intensive equivariant operations, such as spherical harmonics and Clebsh-Gordan coefficients [59; 22]. This introduces increased computational complexity and high-dimensional representations, thereby complicating model implementation and optimization.

In this paper, we build upon our previous work, ToDD [13; 14], enhancing its utility in ligand-based virtual screening and molecular property prediction. We generate topological fingerprints that remain invariant under SE(3) group actions, accurately representing relative atomic arrangements and tetrahedral chiral configurations.

## 3 Invariance of Persistent Homology Under E(3) Transformations

We present the concept of multiparameter persistent homology as a three-step process in Section C. Firstly, the process involves 'graph decomposition' (Figure 2), where vertices are masked based on their values in either ascending or descending order, subsequently breaking down a larger graph into smaller subgraphs. Secondly, 'persistent homology' comes into play, tracking changes in topological features like birth and death times within each subgraph's sequence of simplicial complexes. Lastly, in the'vectorization' step, these records are converted into a vector, a form that can be readily used in machine learning models.

In this section, we establish the invariance of persistent homology induced by Vietoris-Rips filtration under \(E(3)\). We first present a lemma related to the preservation of pairwise distances under \(E(3)\) transformations and then prove a theorem that demonstrates the \(E(3)\) invariance of Vietoris-Rips persistent homology.

**Lemma 3.1**.: _Preservation of Pairwise Distances under \(E(3)\): Let \(X^{3}\) be a finite set of points, and let \(g E(3)\) be an Euclidean transformation. Then, for any two points \(x_{i},x_{j} X\), the pairwise distance between \(x_{i}\) and \(x_{j}\) is preserved under the action of \(g\), i.e., \(\|g(x_{i})-g(x_{j})\|=\|x_{i}-x_{j}\|\)._

Proof.: Let \(g\) be an Euclidean transformation represented by a rotation matrix \(R SO(3)\), a translation vector \(t^{3}\), and a reflection matrix \(M O(3) SO(3)\). Then, for any two points \(x_{i},x_{j} X\),

\[\|g(x_{i})-g(x_{j})\|=\|M(Rx_{i}+t)-M(Rx_{j}+t)\|\,=\|M(R(x_{i}-x_{j}))\|\,=\| R(x_{i}-x_{j})\|\,=\|x_{i}-x_{j}\|.\] (1)

Figure 2: **Graph Decomposition** involves masking certain vertices based on their parameter values, and then considering only the remaining vertices and edges. In the given dataset, 10 unique atoms (H, C, N, O, F, P, S, Cl, Br, I) are identified, leading to the creation of 10 subgraphs. The atoms are color-coded as follows: Gray for Hydrogen, Black for Carbon, Blue for Nitrogen, Red for Oxygen, and Yellow for Sulfur. Note that some subgraphs may be identical. The original compound, manufacturing (a hepatitis B matrix), is displayed in the fact column. Vertices with the highest atomic mass are masked first and added in ascending order of atomic mass. Figure 2 illustrates the graph evolution along the y-axis in the initial column of Figure 6. Our framework builds the Vietoris-Rips complexes for each subgraph, as shown in the rows of Figure 6, and computes the rank of the homology groups of dimensions 0 and 1 for each sequence of simplicial complexes. The process is then repeated using different parameters: partial charge (in ascending order of decile groups in the partial charge histogram) and bond types (starting with vertices forming a ring structure, then adding vertices connected by triple, double, and finally, single bonds).

The second equality holds because reflections preserve distances, and the third equality holds because rotations preserve distances. 

**Theorem 3.2**.: \(E(3)\) _Invariance of Vietoris-Rips Persistent Homology: Let \(X^{3}\) be a finite set of points, and let \(g E(3)\) be an Euclidean transformation. Then, the Vietoris-Rips persistent homology of \(X\) is invariant under the action of \(g\), i.e., \(PH(VR_{}(X)) PH(VR_{}(g(X)))\) for all \(>0\)._

Proof.: Let \(X^{}=g(X)\). By Lemma 3.1, the pairwise distances between points in \(X\) are preserved under the action of \(g\). Therefore, for any \(>0\), a simplex \(\) is included in \(VR_{}(X)\) if and only if the corresponding simplex \(g()\) is included in \(VR_{}(X^{})\). This implies that the simplicial complexes \(VR_{}(X)\) and \(VR_{}(X^{})\) are isomorphic for all \(>0\), and consequently, their homology groups are isomorphic as well. Since the persistent homology is derived from the homology groups of the Vietoris-Rips complexes for all \(>0\), it follows that \(PH(VR_{}(X)) PH(VR_{}(g(X)))\). 

## 4 Incorporating SE(3)-Invariance into Multiparameter Persistent Homology

In the chiral-sensitive property prediction task, the filtration function \(f\) assigns to each atom a value that represents whether it's a chiral center and, if so, what type of chiral center it is. Let \(M\) denote a molecule, modeled as a connected graph where vertices represent atoms and edges represent bonds. Denote the vertex set of \(M\) as \(V(M)\). For each vertex \(v V(M)\), let \(C(v)\) be the set of its neighboring vertices, ordered according to the Cahn-Ingold-Prelog (CIP) priority rules. We define a chiral center as a vertex \(v\) with four different groups attached, i.e., \(|C(v)|=4\) and all elements of \(C(v)\) are distinct. The configuration of a chiral center \(v\), determined by the CIP rules, is denoted as:

\[(v)=1&,\\ 2&.\]

The filtration function \(f:V(M)\{0,1,2\}\) can now be defined compactly as:

\[f(v)=0&,\\ (v)&.\]

For each value \(r\), the sublevel set \(X_{r}=f((-,r])\) is the set of all atoms with \(f\)-values less than or equal to \(r\). The nested sequence of sublevel sets \(X_{r_{1}} X_{r_{2}}\) induces a nested sequence of Vietoris-Rips complexes \(VR_{}(X_{r_{1}}) VR_{}(X_{r_{2}})\). If we build a VR complex and compute the persistent homology based on this filtration function, we obtain a characterization of the molecule that identifies and distinguishes its chiral centers. Importantly, this characterization depends only on the relative configuration of the atoms, not on the absolute position/orientation of the molecule. Therefore, it's expected to be invariant under SE(3) transformations.

The persistent homology of this nested sequence of complexes is a sequence of homology groups \(PH(VR_{}(X_{r_{1}})),PH(VR_{}(X_{r_{2}})),\) and homomorphisms between them, which capture the topological features (connected components, loops, and voids) of the molecule that persist across multiple scales \(r_{1},r_{2},\).

**Theorem 4.1**.: _The Vietoris-Rips complex and its persistent homology are invariant under SE(3) transformations, assuming that the filtration function, \(f\), is also SE(3)-invariant._

Proof.: Let \(T:^{3}^{3}\) be a transformation in SE(3), let \(X^{3}\) be the set of atoms in the molecule, and let \(X^{}=T(X)\) be the transformed set of atoms. Let \(f\) be the filtration function, and let \(f^{}=f T\) be the transformed filtration function. Note that \(f^{}\) assigns to each atom in \(X^{}\) the same value that \(f\) assigns to the corresponding atom in \(X\), because \(f\) is assumed to be SE(3)-invariant.

First, we show that the Vietoris-Rips complex is invariant under \(T\). For any \(>0\) and \(r\), we have \(VR_{}(X_{r})=VR_{}(X_{r}^{})\), where \(X_{r}\) and \(X_{r}^{}\) are the sublevel sets of \(f\) and \(f^{}\) at \(r\), respectively. This is because for any two atoms \(x,y X_{r}\) with \(d(x,y)<\), their transformed counterparts \(x^{}=T(x),y^{}=T(y) X_{r}^{}\) also satisfy \(d(x^{},y^{})<\). This is a result of the fact that \(T\) is an isometry (i.e., it preserves distances), which is a property of all transformations in SE(3). Therefore, any simplex in \(VR_{}(X_{r})\) corresponds to a simplex in \(VR_{}(X^{}_{r})\), and vice versa.

Next, we show that the persistent homology is also invariant under \(T\). The persistent homology is computed from the nested sequence of Vietoris-Rips complexes, which we have shown to be invariant under \(T\). Furthermore, the homomorphisms between the homology groups in the sequence are induced by the inclusions \(X_{r_{1}} X_{r_{2}}\), which correspond under \(T\) to the inclusions \(X^{}_{r_{1}} X^{}_{r_{2}}\). Therefore, the entire structure of the persistent homology, including both the homology groups and the homomorphisms between them, is preserved under \(T\). 

**Theorem 4.2**.: _Assuming that the filtration function, \(f\), accurately identifies the chiral centers and their configurations in a compound, and is non-invariant under reflection, the Vietoris-Rips Persistent Homology, which operates on the nested sequence of subgraphs induced by \(f\), is also non-invariant under reflection._

Proof.: Consider a molecule \(M\) and its reflection \((M)\). By the definition of \(f\), \(f(v) f((v))\) for any chiral center \(v\) with 'R' or 'S' configuration due to the inversion of the configuration under reflection. Denote by \(VR_{f}(M)\) and \(VR_{f}((M))\) the filtered Vietoris-Rips complexes of \(M\) and \((M)\) with the filtration function \(f\). Then, due to the difference in \(f\) values, \(VR_{f}(M) VR_{f}((M))\). As persistent homology is derived from the filtered Vietoris-Rips complex, the non-isomorphism of the complexes implies non-isomorphism of the corresponding homologies. 

### Stability of MPPH Fingerprints

Stability in single parameter persistence vectorizations pertains to the consistency of the mapping from the space of persistence diagrams to the space of functions or vectors, assessed using the Wasserstein distance metric [1; 54]. Essentially, minor changes in the persistence diagram shouldn't drastically alter the vectorization. This concept has been leveraged to demonstrate the stability of Multiparameter Persistent Homology (MPPH) Fingerprints, where changes in the vectorizations are bounded by changes in the corresponding persistence diagrams. The induced matching distance between multiple persistence diagrams (Equation 3) and the distance between induced MPPH Fingerprints (Equation 4) are defined to uphold this stability. For more in-depth explanation and proof of the following theorem, please refer to D.

**Theorem 4.3**.: _If \(\) is a stable, single-parameter persistence vectorization, the resulting MPPH Fingerprint \(\) is also stable. That is, for any pair of graphs \(^{+}\) and \(^{-}\), a certain constant \(>0\) exists, ensuring the following inequality:_

\[(_{}(^{+}),_{}( ^{-}))_{}_{p_{}}(\{PD( ^{+})\},\{PD(^{-})\})\]

## 5 Experiments

We thoroughly evaluate the performance of our methods against the \(8\) state-of-the-art baselines: GraphConv , Weave , SchNet , Node-MPN , D-MPNN [67; 68], MGCN , GRAPHCL  and 3D Infomax  on \(6\) benchmark datasets (Lipophilicity, FreeSolv, ESOL, BACE, BBBP, ClinTox), primarily sourced from MoleculeNet  (a large scale benchmark for molecular machine learning) and adopt the 80/10/10 scaffold splits provided by OGB . See Section G.1 for further details.

### Uncertainty Quantification via SGLB Ensembles

The gradient boosting algorithm , enhanced by Stochastic Gradient Langevin Boosting (SGLB), iteratively builds a model \(F\) to minimize empirical risk \(L(F|D)\), where \(D\) is the set of \(N\) data points \((x_{1},y_{1}),(x_{2},y_{2}),...,(x_{N},y_{N})\). In this context, \(x\) represents the MPPH Fingerprint given in tabular data form, and \(y\) is the associated property. The model update equation is \(F^{(t)}(x)=F^{(t-1)}(x)+ h^{(t)}(x,^{(t)})\), where \(F^{(t-1)}\) is the prior model, \(h^{(t)}\) is a selected weak learner, \(^{(t)}\) is the model parameters, and \(\) is the learning rate. SGLB creates an ensemble of models, estimating uncertainty through the entropy of their predictive distributions. Bayesian inference approximates the true posterior \(p(|D)\) of this ensemble, with total uncertainty, _aleatoric uncertainty_ (knowledge uncertainty), and expected _epis endemic uncertainty_ (data uncertainty) estimated via entropy and variance calculations. In the case of continuous-valued targets, estimates are obtained using the law of total variance. To reach a globally optimal solution, SGLB injects Gaussian noise into the gradients and introduces a regularization term that moderates the influence of preceding models. For detailed mathematical explanations, refer to F.1, and for implementation specifics, see F.2.

### Experimental Results

We adopt a GBDT model, leveraging SGLB optimization with SE(3)-invariant multiparameter persistent homology (MPPH) Fingerprints as the input feature set. The model, comprising \(1000\) boosting stages, is trained with a refined maximum tree depth of \(6\), ascertained through exhaustive hyperparameter tuning. A learning rate of \(0.05\) is employed, and the criterion for splitting a node within the tree is stipulated as a minimum of \(2\) samples. Our method surpasses contemporary state-of-the-art GNNs as well as conventional Random Forest (RF) models, trained on ECFP-4 fingerprints as shown in Table 1.

Our SE(3)-invariant MPPH methodology outperforms top MoleculeNet models on FreeSolv , ESOL , BACE , BBBP , ClinTox , while demonstrating comparable results on Lipophilicity. These outcomes suggest that MPPH not only exceeds the performance of the leading MoleculeNet models but does so without necessitating the training of large-scale GNNs or generating 3D conformations. Moreover, our method displays a _marked improvement_ over all GNN baselines on FreeSolv, ESOL, and ClinTox. We postulate two reasons for these superior results. Firstly, enantiomers, despite sharing similar physiochemical properties, can display drastically different biological activities. Hence, our approach is expected to excel in biological systems such as drug potency (BACE), blood-brain barrier penetration (BBBP), and clinical trial toxicity (ClinTox) compared to those evaluating physiochemical properties like lipid solubility (Lipophilicity), and aqueous solubility (FreeSolv and ESOL). BBBP might represent a balanced case between physiochemical and biological factors . Secondly, the performance of GNNs can be affected worse on smaller datasets like FreeSolv and ESOL due to the restricted number of training samples. The limited size of datasets (up to \( 1000\) training molecules) negatively affects the performance of GNNs due to data sparsity . Furthermore, MPPH can effectively leverage domain knowledge to improve property prediction scores. For instance, it is a commonly acknowledged principle that the introduction of nonpolar groups, such as methyl groups, into a molecule can elevate its lipophilicity. MPPH, by incorporating bond polarity as an auxiliary parameter, effectively integrates crucial domain information, thereby augmenting the performance of lipophilicity prediction.

In highly imbalanced datasets such as BBBP and ClinTox, the ROC-AUC score provides an overly optimistic view of the model's performance, as the false positive rate does not change significantly with different thresholds in the presence of a large number of negative samples. To get a more comprehensive assessment of the model's performance on these datasets, we also present the PRC-AUC and F1-scores in Section G.3. In contrast to the RF model trained on ECFP-4 fingerprints, which significantly overfits to the majority class (negative labels), MPPH displays superior performance. Its PRC-AUC and F1-score metrics particularly highlight MPPH's proficiency in handling class imbalance, notably in the ClinTox dataset. Figure 3 illustrates the combined aleatoric and epistemic

  
**Model** & **Lipophilicity** & **FreeSolv** & **ESOL** & **BACE** & **BBBP** & **ClinTox** \(\) \\  ECFP-4+RF & 0.706\(\)0.011 & 0.560\(\)0.066 & 1.399\(\)0.177 & 0.881\(\)0.027 & 0.924\(\)0.024 & 0.859\(\)0.023 \\ GraphConv & 0.712\(\)0.049 & 2.900\(\)0.135 & 1.068\(\)0.050 & 0.854\(\)0.011 & 0.877\(\)0.036 & 0.845\(\)0.051 \\ Weave & 0.813\(\)0.042 & 2.398\(\)0.250 & 1.158\(\)0.055 & 0.791\(\)0.008 & 0.837\(\)0.065 & 0.823\(\)0.023 \\ SchNet & 0.909\(\)0.098 & 3.215\(\)0.755 & 1.405\(\)0.064 & 0.750\(\)0.033 & 0.847\(\)0.024 & 0.717\(\)0.042 \\ D-MPNN & **0.646\(\)0.014** & 1.010\(\)0.046 & 0.980\(\)0.258 & 0.878\(\)0.032 & 0.913\(\)0.026 & 0.894\(\)0.027 \\ MGCN & 1.113\(\)0.041 & 3.349\(\)0.097 & 1.266\(\)0.147 & 0.734\(\)0.030 & 0.850\(\)0.064 & 0.634\(\)0.042 \\ Node-MPI & 0.672\(\)0.051 & 2.185\(\)0.952 & 1.167\(\)0.430 & 0.815\(\)0.044 & 0.913\(\)0.041 & 0.879\(\)0.054 \\ GRAPHCL & 0.714\(\)0.011 & 3.744\(\)0.292 & 0.959\(\)0.047 & 0.772\(\)0.040 & 0.711\(\)0.020 & 0.511\(\)0.055 \\
3D Infomax & 0.695\(\)0.012 & 2.337\(\)0.227 & 0.894\(\)0.028 & 0.794\(\)0.019 & 0.691\(\)0.011 & 0.594\(\)0.032 \\ 
**SE(3)-I MPPH** & 0.738\(\)0.025 & 0.354\(\)0.053 & 0.612\(\)0.083 & 0.897\(\)0.012 & 0.940\(\)0.021 & 0.993\(\)0.004 \\  Relative gains & - & -36.8\% & -31.5\% & +0.016 & +0.016 & +0.099 \\   

Table 1: SE(3)-Invariant MPPH vs. state-of-the-art baselines. Shown is the root mean squared error (RMSE) for Lipophilicity, FreeSolv, ESOL (lower is better), and the area under the ROC-curve (ROC-AUC) for BACE, BBBP, ClinTox (higher is better). Best in **bold**, top baseline underlined. Improvement and deterioration against top baseline are color-coded.

uncertainty, as derived from SGLB, associated with regression predictions. Additional details on quantifying uncertainty in property predictions from classification models can be found in G.4.

In our ablation study, as detailed in Table 2, we demonstrate that incorporating domain-specific features, specifically SE(3)-invariance and chirality, significantly improves our model's performance across various metrics. We explore the impact of single-parameter persistence, focusing on factors like atomic mass, partial charge, bond type, and notably chirality, each influencing model effectiveness uniquely. Our approach combines Betti vectorizations from these parameters, including chirality and SE(3)-invariance, creating a holistic representation. This integration of orthogonal and complementary data enhances the model's ability to accurately depict molecular structures, thereby improving predictive accuracy in a chemically meaningful manner. The inclusion of SE(3)-invariance, in particular, aligns the model with the inherent symmetries of three-dimensional space, a key aspect for modeling molecular interactions. This feature ensures consistent model predictions, independent of the molecule's spatial orientation or position.

## 6 Conclusion

We have developed a novel method that employs multiparameter persistent homology for molecular fingerprinting. This method adeptly captures tetrahedral chirality by combining SE(3)-invariance with Vietoris-Rips persistent homology. This produces topological descriptors of molecules that depend only on the relative atomic configurations, not on the absolute position/orientation of the molecule. Paired with a Bayesian ensemble, our method estimates both epistemic and aleatoric uncertainties. Our approach is backed by theoretical stability guarantees, and outperforms GNN variants on the MoleculeNet benchmark datasets.

  
**Dataset** & **Metric** & **Atomic Mass (AM)** & **Partial Charge (PC)** & **Bond Type (BT)** & **Chirality** & **AM+PC+BT** & **All Params.** \\ 
**Lipophilicity** & RMSE \(\) & 1.018 & 1.121 & 1.028 & 1.194 & 0.765 & **0.738** \\
**FreeSolv** & RMSE \(\) & 0.542 & 0.427 & 1.107 & 0.773 & 0.378 & **0.354** \\
**ESOL** & RMSE \(\) & 0.991 & 0.977 & 1.339 & 1.496 & 0.624 & **0.612** \\ 
**BACE** & ROC-AUC \(\) & 0.833 & 0.852 & 0.840 & 0.802 & 0.885 & **0.897** \\
**BACE** & PRC-AUC \(\) & 0.748 & 0.829 & 0.808 & 0.757 & 0.880 & **0.905** \\
**BACE** & F1 \(\) & 0.682 & 0.762 & 0.828 & 0.778 & 0.800 & **0.815** \\ 
**BBBP** & ROC-AUC \(\) & 0.876 & 0.828 & 0.910 & 0.810 & 0.928 & **0.940** \\
**BBBP** & PRC-AUC \(\) & 0.956 & 0.923 & 0.975 & 0.920 & 0.978 & **0.987** \\
**BBBP** & F1 \(\) & 0.924 & 0.901 & 0.921 & 0.890 & 0.920 & **0.936** \\ 
**ClinTox** & ROC-AUC \(\) & 0.693 & 0.702 & 0.986 & 0.735 & 0.988 & **0.993** \\
**ClinTox** & PRC-AUC \(\) & 0.318 & 0.182 & 0.896 & 0.294 & 0.900 & **0.923** \\
**ClinTox** & F1 \(\) & 0.296 & 0.091 & 0.857 & 0.231 & 0.864 & **0.870** \\   

Table 2: **Comparative Analysis of SE(3)-Invariant MPPH, MPPH, and Single Parameter Persistent Homology.** This figure displays the performance contrasts among SE(3)-Invariant MPPH (depicted in the last column), MPPH (represented in the penultimate column), and Single Parameter Persistent Homology. The superior performance across different metrics and datasets is indicated in **bold** and highlighted. The juxtaposition first provides the efficacy and robustness of multiparameter persistent homology, and then highlights the superior performance of SE(3)-Invariant MPPH.

Figure 3: The red curve signifies the mean prediction, and the surrounding blue band represents the total uncertainty around the mean. The inference of our model appears to be effectively rational, as the congruity between both the mean and its associated uncertainty provides an apt fit to the data.