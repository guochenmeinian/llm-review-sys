# On the Identifiability of Poisson Branching Structural Causal Model Using Probability Generating Function

On the Identifiability of Poisson Branching Structural Causal Model Using Probability Generating Function

 Yu Xiang\({}^{1}\), Jie Qiao\({}^{1}\), Zhefeng Liang\({}^{1}\), Zihuai Zeng\({}^{1}\), Ruichu Cai\({}^{1,2}\), Zhifeng Hao\({}^{3}\)

\({}^{1}\)School of Computer Science, Guangdong University of Technology, Guangzhou, China

\({}^{2}\)Peng Cheng Laboratory, Shenzhen, China

\({}^{3}\)College of Science, Shantou University, Shantou, China

{thexiang2000, qiaojie.chn, lzfeng011021, zzhuaiii, cairuichu}@gmail.com,

haozhifeng@stu.edu.cn

Equal contribution.Corresponding author.

###### Abstract

Causal discovery from observational data, especially for count data, is essential across scientific and industrial contexts, such as biology, economics, and network operation maintenance. For this task, most approaches model count data using Bayesian networks or ordinal relations. However, they overlook the inherent branching structures that are frequently encountered, e.g., a browsing event might trigger an adding cart or purchasing event. This can be modeled by a binomial thinning operator (for branching) and an additive independent Poisson distribution (for noising), known as Poisson Branching Structure Causal Model (PB-SCM). There is a provably sound cumulant-based causal discovery method that allows the identification of the causal structure under a branching structure. However, we show that there still remains a gap in that there exist causal directions that are identifiable while the algorithm fails to identify them. In this work, we address this gap by exploring the identifiability of PB-SCM using the Probability Generating Function (PGF). By developing a compact and exact closed-form solution for the PGF of PB-SCM, we demonstrate that each component in this closed-form solution uniquely encodes a specific local structure, enabling the identification of the local structures by testing their corresponding component appearances in the PGF. Building on this, we propose a practical algorithm for learning causal skeletons and identifying causal directions of PB-SCM using PGF. The effectiveness of our method is demonstrated through experiments on both synthetic and real datasets.

## 1 Introduction

Causal discovery from observational data, particularly for count data is a crucial task that arises in numerous applications, including biology (Wiuf and Stumpf (2006)), economic (Weiss and Kim (2014)), network operation maintenance (Qiao et al. (2023); Cai et al. (2022)), etc. Much effort has been made to model and discover the causal structure from count data. One line of research models the count data as a type of Poisson Bayesian network (Park and Raskutti (2015, 2017)) or ordinal functional model (Ni and Mallick (2022)), based on which various types of discovering methods are investigated. However, the Bayesian network and ordinal modeling ignore the inherent branching structure among the counting relationship, which is frequently encountered in real world (Weiss (2018)). Take Fig. 1 (a) as an example, in online shopping, the purchasing event can be inherited from browsing, cart added, or promotion event, which exhibits a branching structure such that website browsing (\(X_{1}\)) may lead to either purchasing (\(X_{4}\)) directly without adding to the cart, or addingto the cart (\(X_{2}\)) followed by purchasing (\(X_{4}\)), as depicted in Fig. 1 (b). Accurately modeling and identifying the underlying causal mechanisms-particularly the branching structure inherent in these count variables-are of interest for providing valuable insights to service providers.

Branching structure modeling is well studied across various domains, notably within the context of the integer-value autoregressive model (Weiss (2018); Al-Osh and Alzaid (1987); McKenzie (1985)). Most of these studies model the relationship among count variables utilizing a thinning operator '\(\)' (Steutel and van Harn (1979)). For instance, the causal pair \(X_{1} X_{4}\) in Fig. 1(a) can be modeled as follows: \(X_{4}= X_{1}+\) where \( X_{1}_{n=1}^{X_{1}}_{n}^{()}\), \(_{n}^{()}}}{{}}()\), \(()\). That is, the thinning operator models the branching of an event, e.g., a website browsing event leads to a purchase with probability \(\), while the Poisson noise models the exogenous event. Such modeling can be formalized as the Poisson Branching Structure Causal Model (PB-SCM) (Qiao et al. (2024)). Recently, Qiao et al. (2024) further explores the identifiability of PB-SCM and proposes a likelihood-based heuristic searching method for learning causal skeleton and a cumulant-based method for identifying causal direction. Although some identifiability results are developed by Qiao et al. (2024) using cumulant, we show that there still remains a gap in that there exist causal directions that are identifiable while the algorithm fails to identify them. For example, the current approach cannot fully identify the causal directions among \(X_{1}\), \(X_{2}\), and \(X_{3}\) in Fig. 1 (a). Moreover, the likelihood-based heuristic searching method requires extensive coefficient estimating and structure searching suffering from computational complexity and potential convergence issues.

In this paper, we aim to develop the identifiability of the Poisson Branching Structural Causal Model (PB-SCM) using the Probability Generating Function (PGF) as the characterization of the distribution. Specifically, we first develop the closed-form solution for the PGF of PB-SCM which establishes the connection with the causal structure. With this connection, we find that each component in this closed-form solution is directly associated with a unique local structure, enabling us to learn the skeleton and analyze causal asymmetries without the need for the entire structure. Based on this, we provide an exact pseudo-polynomial time causal structure learning algorithm (i.e., polynomial in the magnitude of the observed variables). We demonstrate the effectiveness of the proposed causal discovery method using synthetic data and real-world data.

Our contributions are threefold. 1) We develop the closed-form solution for PGF of PB-SCM and establish a connection between the closed-form solution of PGF and the graphical patterns. 2) We exploit the closed-form solution of PGF to identify the causal skeleton as well as the causal direction of PB-SCM, which allows us to identify the adjacency and causal direction directly. 3) We propose a practical structure learning algorithm and demonstrate its efficiency and effectiveness through synthetic and real-world data experiments.

## 2 Related work

For brevity, we review causal discovery methods that are applicable and fully identifiable on observational discrete data. Numerous methods and theories have been developed for learning causal structure from observational data (Spirtes et al. (2000); Zhang et al. (2018); Glymour et al. (2019); Cai et al. (2018); Qiao et al. (2024)). In particular, for discrete data, one can employ constraint-based methods (Pearl (2009); Spirtes et al. (1995)), score-based methods (Chickering (2002); Tsamardinos et al. (2006)) to identify the causal structure by exploring the conditional independence relation

Figure 1: (a) An example of the causal graph of count data in an online shopping service. (b) An illustration of the branching structure inherent in count data, where browsing events trigger subsequent events that are summarized as counts.

among variables, but the conditional independence relation can only identify up to the Markov equivalent class (Pearl (2009)). Recently, numerous approaches have been developed for categorical or ordinal data that can identify beyond Markov equivalent class (Cai et al. (2018), Ni (2022), Ni and Mallick (2022), Peters et al. (2010), Leonelli and Varando (2023), Figueiredo and Oliveira (2023)). However, these methods are rarely suitable for count data. Although some recent works explore the Poisson Bayesian network for the Poisson data (Park and Raskutti (2015, 2017)), and further extend it to the zero-inflated Poisson data (Choi et al. (2020)), there still remains a gap in the identifiability of the Possion branching structure model.

## 3 Poisson Branching Structural Causal Model

In this section, we first introduce the Poisson branching structural causal model (PB-SCM), and then we introduce the preliminary of PGF.

### Problem Formulation

Let \(=\{X_{1},,X_{d}\}\) denote a \(d\)-dimensional random count vector, of which the causal relationship consists of a causal directed acyclic graph (DAG) \(G(,)\) with the vertex set \(=\{1,2,...,d\}\) and edge set \(\). We use \(}(i)=\{j|j i\}\), \(}(i)=\{j|i j\}\) and \(}(i)=\{j|i j\}\) denote the sets of parents, children and descendants of vertex \(i\) in \(G(,)\). We assume that any variable in \(\) satisfies the following Poisson Branching Structural Causal Model (PB-SCM):

**Definition 1** (Poisson Branching Structural Causal Model).: _For each random variable \(X_{i}\), let \(_{i}}(_{i})\) be the noise component of \(X_{i}\), \(X_{i}\) is generated by:_

\[X_{i}=_{j}(i)}_{j,i} X_{j}+_{i},\] (1)

_where \(_{j,i}(0,1]\) is the coefficient from vertex \(j\) to \(i\), and \( X_{i}\) is a Binomial thinning operator such that \( X_{i}=_{n=1}^{X_{i}}_{n}^{()}\), where \(_{n}^{()}}{}()\), independently of \(X_{i}\)._

The formulation is consistent with the existing literature, such as Qiao et al. (2024), Al-Osh and Alzaid (1987). We further assume that the _faithfulness assumption_, the _causal Markov assumption_, and the _causal sufficient assumption_ hold. These assumptions are commonly used in constraint-based causal discovery methods, e.g., PC algorithm (Spirtes et al. (2000)). With these assumptions, we formalize our goal as follows:

Goal.Given i.i.d. samples \(=\{x_{1}^{(j)},,x_{d}^{(j)}\}_{j=1}^{m}\) from the joint distribution \(P()\) generated by PB-SCM, our goal is to identify the unknown causal structure \(G\) from \(\).

### Preliminary

To develop the identifiability of PB-SCM, we resort to using the probability generating function as the proxy to analyze the distribution and its asymmetry property. Here, we recall the definition of the probability generating function:

**Definition 2** (Probability Generating Function).: _Given discrete random vector \(=[X_{1},...,X_{d}]^{T}\) taking values in the non-negative integers \(^{ 0}\), the probability generating function of \(\) is defined as:_

\[G_{}()=[z_{1}^{X_{1}} z_{d}^{X_{d}}]= _{x_{1},...,x_{d}=0}^{}p(x_{1},...,x_{d})z_{1}^{x_{1}} z_{d}^{x_{ d}},\] (2)

_where \(p\) is the probability mass function of \(\). The power series converges absolutely at least for all complex vectors \(=[z_{1},...,z_{d}]^{T}^{d}\) with \(\{|z_{1}|,...,|z_{d}|\} 1\)._

Since the PGF is uniquely defined by the probability mass function, such uniqueness of the power series expansion will in turn define the probabilities, meaning that the analysis of the distribution can be conducted on PGF as a proxy (Johnson et al. (2005)).

## 4 Structure Learning of PB-SCM Using Probability Generating Function

In this section, we demonstrate how to utilize PGF to identify causal structures. We first develop the closed-form solution for the PGF of PB-SCM, which has a compact and exact representation capturing the global structure information. Building on this, we delve into the components of the expansion of the PGF's closed form, demonstrating that each component in PGF is connected to a specific local structure. To effectively capture these components, we develop a local PGF. Finally, based on such a connection, we present theoretical results regarding the graphical implications of the component captured by local PGF, which can be used to discover causal structures.

### Motivating Example

Before the formal discussion, we first present a motivating example illustrating how PGF helps analyze the identifiability of PB-SCM.

Taking the triangular structure in Fig. 2 as an example, the corresponding closed form of PGF is given in Fig. 3. We can observe that the closed form of the PGF can be separated into three parts, starting at \(X_{1}\), \(X_{2}\), and \(X_{3}\), respectively. Each part of PGF encapsulates the path information in the overall causal structure. For example, considering the term \(z_{1}z_{2}z_{3}^{2}\) in 1, the \(z_{3}^{2}\) represents that there are two paths from \(X_{1}\) to \(X_{3}\) if the path \(_{1,2},_{2,3},_{1,3}\) are 'open'. By this, one can deduce that for the reserved direction, e.g., \(X_{3} X_{2}\), such a term \(z_{3}^{2}\) will not exist, which justifies that the causal direction between \(X_{2},X_{3}\) is identifiable.

Another attractive property of the PGF is the ability to analyze the local behavior of the structure. For example, by properly setting \(z_{1}\) approach \(0\), we can deduce whether the exist of adjacency between \(X_{2},X_{3}\) by testing whether the term \(z_{2}z_{3}\) exists as shown in term 1. Furthermore, as shown in Fig. 1, by analyzing the local PGF, we can show that the causal direction \(X_{1} X_{2} X_{3}\) is identifiability while the previous cumulant-based method (Qiao et al. (2024)) can not.

In light of the connection between PGF and the causal structure, we can develop a PGF-based method to effectively identify the causal structure. In the following section, we first demonstrate how the PGF encapsulates the causal structure by developing the closed-form solution of the PGF. Then, benefiting from the local analysis of PGF, we address the identifiability gap of PB-SCM and present a more general identifiability result.

Figure 3: Illustration of the graphical implication in the closed-form solution for the PGF of PB-SCM. Here, \(_{i,j}T_{X_{j}}(1)\) indicates that \(X_{j}\) is reached from \(X_{i}\), while \((1-_{i,j})T_{X_{j}}(0)\) indicates the opposite.

Figure 2: Example triangular structure.

### Closed Form Solution of Probability Generating Function

In order to analyze the identifiability of PB-SCM, we first establish a fundamental theorem that provides the closed-form solution for the PGF of PB-SCM:

**Theorem 1** (Closed-form solution for PGF of PB-SCM).: _Given a random vector \(=[X_{1},...,X_{n}]^{T}\) following PB-SCM, let \(_{(j)}=\{z_{l}|l(j)\{j\}\}\), the PGF of \(P()\) is given by \(G_{}()=_{i[d]}G_{_{i}}z_{i} _{j(i)}G_{i,j}(_{(j)})\), where_

\[G_{i,j}(_{(j)})=G_{B(_{i,j})}(z_{j} _{k(j)}G_{j,k}(_{(k)}))&,(j) \\ G_{B(_{i,j})}(z_{j})&,,\] (3)

_in which \(G_{_{i}}()\) is the PGF of Poisson noise \(_{i}\) and \(G_{B(_{i,j})}()\) is the PGF of Bernoulli distribution with parameter \(_{i,j}\)._

The main idea of the proof is to decompose the expectation of PGF according to the causal structure, e.g., a conditional expectation in PGF can be derived as \([z_{3}^{_{1,30}_{1}}|_{1}]=G_{B( _{1,3})}(z_{3})^{_{1}}\) since \(_{1,3}_{1}|_{1}(n=_{1 },p=_{1,3})\). Applying the above rule recursively with the law of expectation, we can obtain Theorem 1. The overall proof is given in Appendix A.1.

Theorem 1 reveals the inherent relationship between the causal structure and the close-formed solution of PGF. To see this connection more concretely, we further develop the following theorem:

**Theorem 2**.: _Given a random vector \(=[X_{1},...,X_{d}]^{T}\) following PB-SCM, the PGF of \(P()\) can be expressed by:_

\[G_{}()=_{i[d]}\{_{i}(T_{X_{i}}(1)-1)\},\] (4)

_where \(T_{X_{i}}(1)=z_{i}_{\{0,1\}^{(i)]}}}_{ j(i)}_{i,j}^{s_{j}}T_{X_{j}}(s_{j}),T_{X_{i}}(0)=1\) and \(_{i,j}^{s_{j}}=_{i,j}\) if \(s_{j}=1\) and \(_{i,j}^{s_{j}}=1-_{i,j}\) if \(s_{j}=0\)._

Theorem 2 provides a more compact closed-form solution for the PGF of PB-SCM. Intuitively, it consists of different path information starting at different vertex. Taking the triangular structure in Fig. 3 as an example, the closed-form solution of PGF can be expressed as follows:

\[G_{}() =_{1}[)(1- _{1,3})z_{1}}_{}}+(1-_{1,3})(1-_{2,3})z_{1}z_{2}+_{1,2}_{2,3 }(1-_{1,3})z_{1}z_{2}z_{3}}_{}}\] (5) \[+(1-_{1,2})z_{1}z_{3}}_{}}+_{1,3 }(1-_{2,3})z_{1}z_{2}z_{3}+_{1,2}_{2,3}_{1,3}z_{1}z_{ 2}z_{3}^{2}}_{}}-_{1}}\] \[_{2}[)z_{2} }_{}}+z_{ 2}z_{3}}_{}}-_{2}} \{_{3}(}_{}}-1)\},\]

which is the combination of three main terms \(T_{X_{1}}(1)\), \(T_{X_{2}}(1)\), and \(T_{X_{3}}(1)\) given in Theorem 2. Here \(T_{X_{i}}(1)\) contains all possible path information from \(X_{i}\) to all its descendants while \(T_{X_{i}}(0)\) denotes the vertex is 'close' which will not be reached at the current path. Theorem 2 shows that for each \(T_{X_{i}}(1)\), it enumerates all possible combinations of 'open' and 'close' of the children of \(X_{i}\) recursively. For example, in terms \(}\), we have \(X_{2}\) 'close' and \(X_{3}\) 'open' such that only \(z_{3}\) appears in this term and we obtain \(_{1,3}(1-_{1,2})z_{1}z_{3}\). Formally, we provide the graphical implication of the closed-form solution of PGF as follows:

**Proposition 1** (Graphical implication of closed-form solution of PGF).: _Given a random vector \(=[X_{1},...,X_{d}]^{T}\) following PB-SCM, for any subgraph \(G(,)\) with the subset of vertices \(\) such that the \(i\)-th vertex is the root vertex in \(G(,)\), a component \(Cz_{i}_{j L\{i\}}z_{j}^{p_{j}}\) with constant \(C 0\), exponent \(p_{j}^{+}\) exits in \(T_{X_{i}}(1)\), if and only if there exists a subgraph \(G(,^{})\) with subset of the edges \(^{}\) such that for each \(j\{i\}\), there are at least \(p_{j}\) directed paths from \(X_{i}\) to \(X_{j}\) in the subgraph \(G(,^{})\)._

Proposition 1 reveals the graphical implication of each term in the closed-form solution of PGF that each term is related to a number of directed paths in a certain subset graph. In particular, for thehighest order, in terms 4, \(z_{1}z_{2}z_{3}^{2}\) indicates that there are two paths from \(X_{1}\) to \(X_{3}\) and one path from \(X_{1}\) to \(X_{2}\) in this triangular structure, which implies that \(X_{1},X_{2}\) is the cause of \(X_{3}\) offering a way to identify the causal direction by detecting whether \(z_{3}^{2}\) exists. In fact, the cumulant-based method is exactly the method that identifies the causal direction by detecting the highest order of \(z_{i}\) using cumulant (Qiao et al. (2024)).

However, one drawback of detecting the highest order is that the highest order of \(z_{i}\) does not always contain full identification for PB-SCM. For example, in Fig. 1 (a), since \(z_{1}z_{2}z_{4}^{2},z_{2}z_{3}z_{4}^{2}\) has the order of 2 while \(z_{1}z_{2},z_{2}z_{3}\) only has an order of 1, we can only conclude the causal direction from \(X_{1},X_{2},X_{3}\) to \(X_{4}\) but not causal relation among \(X_{1},X_{2},X_{3}\) using merely the highest order. Fortunately, the causal structure \(X_{1} X_{2} X_{3}\) remains identifiable since the term \(z_{1}z_{2}z_{3}\) does not exist in the PGF. This indicates that there is no directed path starting from any vertex that passes through all three vertices \(X_{1},X_{2},X_{3}\). In this case, we can conclude that it must be the collider structure and allows us to identify the causal structure by detecting whether such a term exists. Another drawback of detecting the highest order term is that it requires multiple derivatives of PGF or complex construction with higher order cumulant, hindering the analysis of the identifiability. In this work, benefiting the local property of the PGF, we explore a consistent way to identify the causal structure while only lower-order information is required.

### Local Probability Generating Function

One of the attractive properties of PGF is the ability to isolate and examine some specific components by strategically setting the other variables \(z\) approach zero within the probability generating function, which allows us to investigate the local structure and devise a practical structure learning algorithm. Formally, we define the following local PGF:

**Definition 3** (Local Probability Generating Function).: _Given random vector \(=[X_{1},...,X_{d}]^{T}\) following PB-SCM and its PGF \(G_{}()\). The local PGF of vertices \([d]\) is the pointwise limit of \(G_{}()\) as the \(_{}\) approach \(\), \(_{}=\{z_{i}|i[d]\}\), denoted as: \(G_{}^{}()=_{_{}}G_{}()\)._

The local PGF can be constructed using the original PGF by setting the limit of \(z\). By this, similarly to Theorem 2, we have the following closed-form solution for the local PGF:

**Theorem 3**.: _Given a random vector \(=[X_{1},...,X_{n}]^{T}\) following PB-SCM and its PGF \(G_{}()\). For a subset \([d]\) of the set of vertices, and the set of the children of vertex \(i\) within \(\), denoted by \(_{}(i)=(i)\), the local PGF of \(\) can be expressed by:_

\[G_{}^{}()=_{i}\{_ {i}(T_{X_{i}}^{}(1)-1)\}_{i[d] }\{-_{i}\},\] (6)

_where \(T_{X_{i}}^{}(1)=z_{i}_{\{0,1\}^{\{ _{}(i)\}}}_{j_{}(i)}_{i,j}^{ s_{j}}T_{X_{j}}^{}(s_{j})_{j(i) _{}(i)}(1-_{i,j})\) and \(T_{X_{i}}^{}(0)=1\)._

Taking Fig. 3 as an example, the local PGF of vertices \(=\{X_{2},X_{3}\}\) is \(G_{}^{\{X_{2},X_{3}\}}=\{-_{1}\}\{_{2}[(1-_{2,3} )z_{2}+_{2,3}z_{2}z_{3}]-_{2}\}\{_{3}z_{3}-_{3}\}\). Such local probability generating function allow us to analysis and to identify the local structure, e.g., the term \(z_{2}z_{3}\) in the local PGF \(G_{}^{\{X_{2},X_{3}\}}\) represent the adjacent relation between \(X_{2}\) and \(X_{3}\).

In the following sections, we will further explore the identifiability of several specific structures that serve as fundamental local structures within a graph.

### Identifiability

In this section, we address the identifiability of the PB-SCM using the PGF. Our focus is on identifying three fundamental local structures to reconstruct the causal graph from causal skeleton to causal direction: (i) the adjacent relation, (ii) the local triangular structure, and (iii) the local collider structure.

**Adjacent relation.** We first address the identifiability of the adjacent relation, which is involved in identifying the causal skeleton. For each pair of vertices \(X_{i},X_{j}\), the component \(z_{i}z_{j}\) appears in the PGF if and only if \(X_{i}\) and \(X_{j}\) are adjacent, indicating that there exists a path either from \(X_{i}\) to \(X_{j}\) or from \(X_{j}\) to \(X_{i}\). Therefore, we can detect the adjacency relation by testing whether the second partial derivative \( G_{}^{\{i,j\}}()}{ z_{i} z _{j}}\) equal to zero in a local structure. In order to construct a hypothesis test for such a condition, we formulate the condition as a rank condition. Formally, the adjacent relation can be identified using the following theorem:

**Theorem 4** (Identifiability of adjacent vertices).: _Let \(X_{i},X_{j}\) be two arbitrary vertices with the corresponding local PGF \(G_{}^{\{i,j\}}()\). Define the matrix \(^{\{i,j\}}=G_{}^{\{i,j\}}()& }^{\{i,j\}}()}{ z_{i}}\\ }^{\{i,j\}}()}{ z_{j}}&G_{}^{\{i,j\}}()}{ z_{i} z_{ j}}\) with \(z_{i},z_{j}\) approach \(1\), the condition \((^{\{i,j\}})=1\) if and only if \(X_{i}\) is non-adjacent to \(X_{j}\)._

Intuitively, Theorem 4 identify the adjacent relation by detecting the existence of \(z_{i}z_{j}\) in the logarithm of the PGF, i.e., the \(T_{X_{i}}(i)\) inside the exponential function. By this, the identification of the causal skeleton is given. Next, we show the identifiability of a local triangular structure.

**Triangular structure.** For any three vertices \(X_{i},X_{j},X_{k}\) forming a triangular structure. Such a structure must have one and only one vertex with an in-degree of \(2\). This asymmetry is captured by the second-order derivative of local PGF, e.g., \(z_{i}z_{j}z_{k}^{2}\) where \(X_{k}\) has an in-degree of \(2\). By this, the causal direction \(X_{i} X_{k}\) and \(X_{j} X_{k}\) in the local triangular structure is identifiable as follows:

**Theorem 5** (Identifiability of local triangular structure).: _Let \(X_{i},X_{j},X_{k}\) form a triangular structure with the corresponding local PGF \(G_{}^{\{i,j,k\}}()\). Define the matrix \(^{\{i,j,k\}}=G_{}^{\{i,j,k\}}()& }^{\{i,j,k\}}()}{ z_{k}}\\ }^{\{i,j,k\}}()}{ z_{k}}&G_{}^{\{i,j,k\}}()}{ z_{k}^{2}}\) with \(z_{i},z_{j},z_{k}\) approach \(1\), the condition \((^{\{i,j,k\}})=2\) if and only if \(X_{k}\) is the vertex with an in-degree of \(2\) in this triangular structure, i.e., \(X_{i}}}\)._

Note that the causal direction in the triangular structure is not fully identifiable because it does not exhibit asymmetry and can always construct an equivalent PGF in the reversed direction which is also discussed in Qiao et al. (2024). Next, we consider the identifiability of the local collider structure, which is also referred to as the unshielded collider structure.

**Local collider structure.** Given three adjacent vertices \(X_{i}-X_{j}-X_{k}\). If they form a collider structure \(X_{i} X_{j} X_{k}\), the corresponding pattern in the closed-form solution of PGF is \(z_{i}z_{j}+z_{j}z_{k}\) but no \(z_{i}z_{j}z_{k}\), reflecting the absence of non-block path among these three vertices. Thus we have \( G_{}^{\{i,j,k\}}()}{ z_{i}  z_{k}}=0\). Similarly, we can construct a rank condition for identifying such local collider structure using the following theorem:

**Theorem 6** (Identifiability of local collider structure).: _Let \(X_{i},X_{j},X_{k}\) be three adjacent vertices with the corresponding local PGF \(G_{}^{\{i,j,k\}}()\). Define the matrix \(^{\{i,j,k\}}=G_{}^{\{i,j,k\}}()& }^{\{i,j,k\}}()}{ z_{i}}\\ }^{\{i,j,k\}}()}{ z_{k}}&G_{}^{\{i,j,k\}}()}{ z_{i} z_{ k}}\) with \(z_{i},z_{j},z_{k}\) approach \(1\), the condition \((^{\{i,j,k\}})=1\) if and only if the vertices \(X_{i},X_{j},X_{k}\) form the structure \(X_{i} X_{j} X_{k}\)._

Combining the identifiability in Theorem 5 and Theorem 6 of the local structure, we conclude the following graphical implication of the identification of PB-SCM.

**Theorem 7** (Graphical implication of identifiability).: _Given a pair of adjacent vertices \(X_{i},X_{j}\) following PB-SCM, the causal direction of \(X_{i} X_{j}\) is identifiable if there exists a vertex \(X_{k}\{X_{i},X_{j}\}\) such that \(X_{k} X_{j}\)._

### Learning Causal Structure of PB-SCM Using Probability Generating Function

In this section, we propose a practical algorithm for learning the causal structure of PB-SCM using PGF. Note that the probability generating function can be estimated by employing the empirical probability generating function (Nakamura and Perez-Abreu (1993)). The algorithm is given in Alg. 1. Our algorithm involves two steps: learning the skeleton of DAG \(G\) using the result developed in Theorem 4 and inferring the causal direction using the results developed in Theorem 5 and 6.

**Learning Causal Skeleton.** To learn the causal skeleton, following the Theorem 4, we construct the matrix \(^{\{i,j\}}\) for each pair of vertices \(X_{i},X_{j}\), and assess its rank to determine adjacency between the vertices (Line 2-4). Notably, learning the causal skeleton is efficient because each pair of vertices requires only one examination.

**Learning Causal Direction.** Given the skeleton, we orient the causal direction following the Theorem 5 and Theorem 6. Our initial focus is on orienting within triangular structures. For each triangular structure, we enumerate the matrix \(^{\{i,j,k\}}\) to test whether \(X_{k}\) has indegree of two based on Theorem 5 and orient \(X_{i} X_{k}\) and \(X_{j} X_{k}\) if detected (Line 5-7). After the orientation in the triangular structure, we focus on orienting the remaining undirected edges following Theorem 6. Specifically, for each undirected edge \(X_{i}-X_{j}\), we first consider testing the causal direction in a pattern like \(X_{i}-X_{j} X_{k}\). Then, we consider testing the causal direction in pattern \(X_{i}-X_{j}-X_{k}\). Such a test is conducted by constructing the matrix \(^{\{i,j,k\}}\) and to test whether the rank is \(1\), and then orient \(X_{i} X_{j} X_{k}\) if detected (Line 8-10).

**Rank Test.** To test the rank of \(^{\{i,j\}},^{\{i,j,k\}}\) and \(^{\{i,j,k\}}\), we employ a rank test by testing whether the second (minimum) eigenvalue \(_{2}\) is zero, i.e., \(H_{0}:_{2}=0\)\(v.s.\)\(H_{1}:_{2} 0\). Since the trace of the matrix converges to a normal distribution based on the central limit theorem, and thus the sum of eigenvalues is also Gaussian. Thus, if \(H_{0}\) is true, we approximate the eigenvalue as a normal distribution with zero mean. We further employ bootstrap method (Efron and Tibshirani (1994)) to estimate the variance of such distribution by calculating the bootstrapping statistic \(_{2}^{+}\) from \(N\) resampling dataset \(^{+}\{^{+}_{i}|^{+}_{i=1,..,N} ,\}\) and estimate the variance of \(_{2}^{+}\). Building on this, the p-value of \(_{2}\) from the original dataset can be obtained.

**Complexity Analysis.** In the step of learning skeleton, we determine whether each pair of vertices is adjacent by testing the rank of the matrix following Theorem 4, and hence the complexity of skeleton learning is \((d(d-1))\). In the step of learning causal direction, we consider the complete graph, where there are \(=\) triangular structures, and for each triangular structures, we test the rank of the matrix for three vertices following Theorem 5, and hence the complexity is \(()\). Similarly, in orienting collider structures from a complete graph, we choose three adjacent vertices and test the rank once following Theorem 6, hence the complexity is \(()\). Therefore, the total complexity is \((d(d-1)+)\).

## 5 Experiment

### Synthetic Experiments

In this section, we test our proposed method on synthetic data. We first conduct control experiments on synthetic data to evaluate the sensitivity of our method to sample size and different indegree rates. Following this, we present case studies involving 3, 4, and 5 vertices to further illustrate the identifiability of our approach. The baseline methods include the cumulant-based method (Cumulant) (Qiao et al. (2024)), OCD (Ni and Mallick (2022)), PC (Spirtes et al. (2000)), GES (Chickering (2002)).

Sensitivity ExperimentIn the sensitivity experiment, we synthesize data with fixed parameters while traversing the target parameter. The default settings are as follows, sample size=30000, number of vertices=10, indegree rate=3.0, range of causal coefficient \(_{i,j}[0.1,0.3]\), range of the mean of Poisson noise \(_{i}[0.05,0.15]\). Each simulation is repeated 15 times.

In the control experiments on the average in-degree given in Table 1, as the average in-degree controls the sparse of causal structure, the higher the in-degree rate, the less sparse in causal structure leading to a decrease of performance of the baseline methods, PC, GES and OCD. In contrast, our method and Cumulant show improved performance as they benefit from the denser structure which provides more identifiable structures. Additionally, our method outperforms Cumulant by overcoming identifiability limitations through leveraging PGF, demonstrating better performance.

In the control experiments on sample size presented in Table 2, our method's performance improves with increasing sample sizes, consistently outperforming all baseline methods. Furthermore, it surpasses Cumulant under the same conditions due to its efficient identification of directions in local structures without relying on high-order statistics, thus enhancing accuracy.

Case StudyTo demonstrate the identifiability of the proposed PGF-based method, we present case studies using causal graphs with 3, 4, and 5 vertices. The results of our method and the baseline methods are summarized in Table 3.

Generally, our PGF-based method successfully identifies almost all the edges, except for \(X_{1} X_{2}\) in the graphs with 3 and 5 vertices. This is because there is neither a vertex with an indegree of 2 to provide causal asymmetry, nor an additional vertex to form the local collider structure, which aligns with our theoretical results. Notably, the cumulant-based method fails to identify the structure \(X_{1} X_{2} X_{3}\) in the 4-vertex graph and the edge \(X_{4} X_{5}\) in the 5-vertex graph, as it cannot leverage low-order information. This limitation, however, is successfully addressed by the PGF-based method, which can utilize such information effectively. Regarding other baseline methods, PC and GES encounter difficulties in identifying the Markov equivalent class, while OCD illustrates identifiability issues in PB-SCM.

   &  \\  Avg. In-degree & 2.0 & 2.5 & 3.0 & 3.5 & 2.0 & 2.5 & 3.0 & 3.5 \\  Ours & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) \\ Cumulant & \(0.73 0.03\) & \(0.77 0.02\) & \(0.80 0.04\) & \(0.83 0.03\) & \(13.40 1.28\) & \(14.10 1.51\) & \(13.00 2.37\) & \(13.20 2.23\) \\ PC & \(0.60 0.17\) & \(0.62 0.11\) & \(0.54 0.12\) & \(0.60 0.12\) & \(9.90 3.45\) & \(11.80 2.48\) & \(15.90 3.91\) & \(16.10 3.21\) \\ GCS & \(0.48 0.14\) & \(0.48 0.11\) & \(0.41 0.11\) & \(0.37 0.10\) & \(14.90 4.48\) & \(19.56 4.61\) & \(25.90 4.18\) & \(30.5 4.06\) \\ OCD & \(0.23 0.22\) & \(0.27 0.23\) & \(0.28 0.16\) & \(0.37 0.14\) & \(16.10 3.70\) & \(19.40 5.50\) & \(23.60 4.62\) & \(24.30 4.67\) \\  

Table 1: Sensitivity to Avg. In-degree Rate.

   &  \\  Sample Size & 5000 & 15000 & 30000 & 50000 & 5000 & 15000 & 30000 & 50000 \\  Ours & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) & \(\) \\ Cumulant & \(0.72 0.04\) & \(0.78 0.02\) & \(0.80 0.04\) & \(0.80 0.03\) & \(19.90 3.35\) & \(15.00 4.11\) & \(13.00 2.49\) & \(13.60 2.63\) \\ PC & \(0.45 0.11\) & \(0.54 0.11\) & \(0.54 0.13\) & \(0.66 0.09\) & \(19.50 4.30\) & \(15.70 3.77\) & \(15.90 4.12\) & \(13.00 2.79\) \\ GES & \(0.39 0.10\) & \(0.44 0.20\) & \(0.41 0.11\) & \(0.43 0.22\) & \(23.70 4.14\) & \(22.70 7.85\) & \(25.90 4.41\) & \(24.10 8.54\) \\ OCD & \(0.30 0.12\) & \(0.35 0.18\) & \(0.28 0.16\) & \(0.38 0.20\) & \(21.90 3.35\) & \(20.80 4.57\) & \(23.60 4.62\) & \(20.90 5.74\) \\  

Table 2: Sensitivity to Sample Size.

  Causal Graph & Ours & Cumulant & PC & GES & OCD \\  \(X_{1}\) & \(X_{2}\) & \(X_{3}\) & \(X_{4}\) & \(X_{5}\) & \(X_{6}\) & \(X_{7}\) \\  \(X_{3}\) & \(X_{4}\) & \(X_{5}\) & \(X_{6}\) & \(X_{7}\) & \(X_{8}\) & \(X_{9}\) \\  \(X_{5}\) & \(X_{6}\) & \(X_{7}\) & \(X_{8}\) & \(X_{9}\) & \(X_{1}\) & \(X_{1}\) \\  \(X_{7}\) & \(X_{8}\) & \(X_{9}\) & \(X_{1}\) & \(X_{2}\) & \(X_{3}\) & \(X_{4}\) & \(X_{5}\) \\  \(X_{8}\) & \(X_{9}\) & \(X_{1}\) & \(X_{2}\) & \(

### Real World Experiments

In this section, we evaluate the performance of our proposed method on two real-world datasets to assess its effectiveness in realistic scenarios.

Football Events DatasetWe test the proposed method on a real-world football events dataset1, which includes 941,009 events from 9,074 games across Europe. The experiment focused on analyzing the causal relationships between specific events such as Foul, Yellow card, Second yellow card, Red card, and Substitution, as depicted in Fig. 4. The goal is to identify causal relationships from the counts of these events.

In detail, we orientate in the local triangular structures \(Y_{1}-Y_{2}-F\), \(Y_{2}-R-F\), and the local collider structure \(Y_{1}-S-R\). As a result, Our method successfully identifies adjacent vertex \(-\) and other six causal directions, which is consistent with our theoretical result.

Shopping Mall Paid Search Campaign Count DataWe also evaluate our method using a shopping small paid search campaign dataset2. This dataset contains information from a five-month paid search campaign for a U.S. shopping mall, spanning from July to November 2021. In this analysis, we focus on the count variables _Impressions_, _Clicks_, and _Conversions_, which represent fundamental count data in e-commerce scenarios. These variables exhibit the following causal relationships: _Impressions \(\) Clicks_, _Clicks \(\) Convers_, and _Impressions \(\) Convers_, forming a triangular structure.

Our experimental results demonstrate that the proposed method successfully identifies the adjacent relation between _Impressions_ and _Clicks_, and the other two causal directions. These results align with our theoretical findings, suggesting that the method has the potential to be applied to real-world scenarios involving count data.

## 6 Conclusion

In this work, we investigate the identifiability of the Poisson branching structural causal model using the probability generating function. We derive a nontrivial closed-form solution for the PGF of PB-SCM and further establish the connection between the closed-form solution of PGF to the causal structure, showing that the closed-form solution of PGF encompasses the path information with various subgraphs. With this connection, we employ the local property of PGF and propose a simple yet efficient way to identify the local causal structure of PB-SCM by constructing a matrix with rank test. By this, we provide a practical algorithm and a hypothesis test approach for testing the causal structure and verifying the effectiveness of the algorithm via synthesis and real-world data. The proposed theoretical results take a meaningful step in understanding the causal mechanism and completing the identifiability result of PB-SCM.

The main limitation of this work is that the explicit estimation of the probability generating function does not scale well to the number of nodes. Developing a sample-efficient estimating method could be a promising direction. In addition, causal faithfulness and sufficient assumption may restrict the usage of this work in a border scenario, which needs to be processed with extra detection steps to eliminate the effect.

## 7 Acknowledgments

This research was supported in part by National Key R&D Program of China (2021ZD0111501), National Science Fund for Excellent Young Scholars (62122022), Natural Science Foundation of China (61876043, 61976052, 62406080), the major key project of PCL (PCL2021A12). We sincerely appreciate the comments from anonymous reviewers, which greatly helped to improve the paper.

Figure 4: Football Event Graph (\(F\): Foul, \(Y_{1}\): Yellow card, \(Y_{2}\): Second yellow card, \(R\): Red card, \(S\): Substitution)