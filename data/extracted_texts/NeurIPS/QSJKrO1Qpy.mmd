# Hodge-Aware Learning on Simplicial Complexes

Anonymous Author(s)

Affiliation

Address

email

###### Abstract

Neural networks on simplicial complexes (SCs) can learn from data residing on simplices such as nodes, edges, triangles, etc. However, existing works often overlook the Hodge theory that decomposes simplicial data into three orthogonal characteristic subspaces, such as the identifiable gradient, curl and harmonic components of edge flows. In this paper, we aim to incorporate this data inductive bias into learning on SCs. Particularly, we present a general convolutional architecture which respects the three key principles of uncoupling the lower and upper simplicial adjacencies, accounting for the inter-simplicial couplings, and performing higher-order convolutions. To understand these principles, we first use Dirichlet energy minimizations on SCs to interpret their effects on mitigating the simplicial oversmoothing. Then, through the lens of spectral simplicial theory, we show the three principles promote the Hodge-aware learning of this architecture, in the sense that the three Hodge subspaces are invariant under its learnable functions and the learning in two nontrivial subspaces are independent and expressive. To further investigate the learning ability of this architecture, we also study it is stable against small perturbations on simplicial connections. Finally, we experimentally validate the three principles by comparing with methods that either violate or do not respect them. Overall, this paper bridges learning on SCs with the Hodge decomposition, highlighting its importance for rational and effective learning from simplicial data.

## 1 Introduction

It is not uncommon to have polyadic interactions in such as friendship networks , collaboration networks , gene regulatory networks , etc [4; 5; 6]. To remedy the pitfall that graphs are limited to model pairwise interactions between data entities on nodes, simplicial complexes (SCs) have become popular among others . A SC can be informally viewed as an extension of a graph, which is the simplest SC, by including, not limited to, some triangles over the edge set. SCs like graphs have algebraic representations - the Hodge Laplacians, an extension of graph Laplacians [8; 9]. Moreover, besides node-wise data, SCs can support data on general simplices, e.g., flow-type data, e.g., water flows , traffic flows , information flows , etc., naturally arise as data on edges, and data related to three parties, e.g., triadic collaborations , can be defined on triangles in a SC.

Thus, existing works have built NNs on SCs to learn from such simplicial data, to name a few, [13; 14; 15; 16; 17; 18; 19]. In analogous to graph neural networks (GNNs) learning from node data relying on the adjacency between nodes, the idea behind these works is to rely on the relations between simplices. Such relations can be twofold: first, two simplices can be lower and upper adjacent to each other, such as an edge can be (lower) adjacent to another edge via a common node, and can also be (upper) adjacent to others by sharing a common triangle; and second, there exist the inter-simplicial couplings (or simplicial incidences) such that a node can induce data on its incident edge and a triangle can cause data on its three edges, or the other way around. Along with this idea, [15; 16; 19] proposed convolutional-type NNs by applying the simplicial adjacencies, [14; 20] included also inter-simplicial couplings, and [17; 21] generalized the graph message-passing  to SCs based on both relations.

However, these works often solely focus on the simplicial structures, overlooking _the Hodge decomposition_, which gives three orthogonal subspaces that uniquely characterize the simplicial data. An edge flow can be decomposed into three distinct parts: a curl-free part induced by some node data, a divergence-free (div-free) part that follows flow conservation (in-flows equal to out-flows at nodes), and a harmonic part that is both div- and curl-free. Meanwhile, real-world simplicial data often presents properties to be in certain subspaces but not others, or its components carry physical usefulness, e.g., statistical ranking, exchange market , traffic networks , brain networks , game theory , etc. Thus, intuitively, as an example, a Hodge-biased learner should not, at least not primarily, learn in the div-free space if the edge flow is curl-free. If the learning function preserves the subspaces and operates independently in three subspaces, the learning space is substantially shrunk. This in fact provides an important inductive bias allowing for rational and effective learning on SCs.

Motivated by this, in this paper, we present the general convolutional learning on SCs, SCCNN, which respects three key principles of uncoupling the lower and upper simplicial adjacencies, accounting for the inter-simplicial couplings, and performing higher-order convolutions. Unlike existing convolutional methods [14; 15; 16], which either lack theoretical insights or only discuss their architectural differences in the simplicial domain, we focus on providing a theoretical analysis of these three principles from both the perspectives of simplicial and simplicial data, specifically Hodge theory. This offers deeper and unique insights when compared to the more closely related works [19; 17].

**Main contributions.** In Section 3.2, we first use Dirichlet energy minimizations on SCs to understand how uncoupling the lower and upper adjacencies in Hodge Laplacians and the inter-simplicial couplings can mitigate the oversmoothing inherited from generalizing GCN to SCs. Under the help of spectral simplicial theory [26; 27; 28], in Section 4, we characterize the spectral behavior of SCCNN and its expressive power. We show SCCNN performs independent and expressive learning in the three subspaces of the Hodge decomposition, which are invariant under its learning operators. This Hodge-awareness (or Hodge-aided bias) allows for effective and rational learning on SCs compared to MLP or simplicial message-passing . In Section 5, we also prove it is stable against small perturbations on the strengths of simplicial connections, and show how three principles can affect the stability. Lastly, we validate our findings on different simplicial tasks, including recovering foreign currency exchange (forex) rates, predicting triadic and tetradic collaborations, and trajectories.

## 2 Background

**Simplicial complex and simplicial adjacencies.** A \(k\)-simplex \(s^{k}\) is a subset of \(=\{1,,n_{0}\}\) with cardinality \(k+1\). A _face_ of \(s^{k}\) is a subset with cardinality \(k\). A _coface_ of \(s^{k}\) is a \((k+1)\)-simplex that has \(s^{k}\) as a face. Nodes, edges and (filled) triangles are geometric realizations of 0-, 1- and 2-simplices. A SC \(\) of order \(K\) is a collection of \(k\)-simplices, \(k=0,,K\), with the _inclusion_ property: \(s^{k-1}\) if \(s^{k-1} s^{k}\) for \(s^{k}\). A graph is a SC of order one and by taking into account some triangles, we obtain a SC of order two. We collect all \(k\)-simplices of \(\) in set \(^{k}=\{s^{k}_{i}\}_{i=1,,n_{k}}\) with \(n_{k}=|^{k}|\), i.e., \(=_{k=0}^{K}^{k}\). For \(s^{k}\), We say a \(k\)-simplex is _lower (upper) adjacent_ to \(s^{k}\) if they share a common face (coface). For computations, an _orientation_ of a simplex is chosen as an ordering of its vertices (a node has a trivial orientation). Here we consider the lexicographical ordering \(s^{k}=[1,,k+1]\), e.g., a triangle \(s^{2}=\{i,j,k\}\) is oriented as \([i,j,k]\).

**Algebraic representation.** Incidence matrix \(_{k}\) describes the relations between \((k-1)\)- (i.e., faces) and \(k\)-simplices, e.g., \(_{1}\) is the node-to-edge incidence matrix and \(_{2}\) edge-to-triangle. We have \(_{k}_{k+1}=\) by definition . The \(k\)-_Hodge Laplacian_ is \(_{k}=_{k}^{}_{k}+_{k+1} _{k+1}^{}\) with the _lower Laplacian_\(_{k,}=_{k}^{}_{k}\) and the _upper Laplacian_\(_{k,}=_{k+1}_{k+1}^{}\). We have a set of \(_{k},k=1,,K-1\) in a SC of order \(K\) with the graph Laplacian \(_{0}=_{1}_{1}^{}\), and \(_{K}=_{K}^{}_{K}\). Note that \(_{k,}\) and \(_{k,}\) encode the lower and upper adjacencies of \(k\)-simplices. For example, for \(k=1\), they encode the edge-to-edge adjacencies through nodes and triangles, respectively.

**Simplicial data.** A \(k\)-_simplicial data (or \(k\)-signal)_\(_{k}^{n_{k}}\) is defined by an _alternating_ map \(f_{k}\) which assigns a real value to a simplex, and restricts that if the orientation of a simplex is anti-aligned with the reference orientation, then the sign of the signal value will be changed .

**Incidence matrices as derivative operators on SCs.** We can measure how a \(k\)-signal \(_{k}\) varies w.r.t. the faces and cofaces of \(k\)-simplices by applying \(_{k}_{k}\) and \(_{k+1}^{}_{k}\). For a node signal \(_{0}\), \(_{1}^{}_{0}\) computes its _gradient_ as the difference between adjacent nodes. Thus, a constant \(_{0}\) has zero gradient. For an edge flow \(_{1}\), \([_{1}_{1}]_{j}=_{i<j}[_{1}]_{[i,j]}-_{j<k}[ _{1}]_{[j,k]}\) computes its _divergence_, which is the difference between the in-flow and the out-flow at node \(j\), and \([_{2}^{}_{1}]_{t}=[_{1}]_{[i,j]}-[_{1} ]_{[i,k]}+[_{1}]_{[j,k]}\) computes the _curl_ of \(_{1}\), which is the net-flow circulation in triangle \(t=[i,j,k]\).

**Theorem 1** (Hodge decomposition [23; 9]).: _The \(k\)-simplicial data space admits an orthogonal direct sum decomposition \(^{n_{k}}=(_{k}^{})( _{k})(_{k+1})\). Moreover, we have \((_{k+1}^{})=(_{k}^{}) (_{k})\) and \((_{k})=(_{k})(_ {k+1})\)._

In the node space, this is trivial as \(^{n_{0}}=(_{0})(_{1})\) where the kernel of \(_{0}\) contains constant node data and the image of \(_{1}\) contains nonconstant data. In the edge case, three subspaces carry more tangible meaning: the _gradient space_\((_{1}^{})\) collects edge flows as the gradient of some node signal, which are _curl-free_; the _curl_ space \((_{2})\) consists of flows cycling around triangles, which are _div-free_; and flows in the _harmonic space_\((_{1})\) are both div- and curl-free. In this paper, we inherit the names of three edge subspaces to general \(k\)-simplices. This theorem states that any \(_{k}\) can be uniquely expressed as \(_{k}=_{k,}+_{k,}+ _{k,}\) with gradient part \(_{k,}=_{k}^{}_{k-1}\), curl part \(_{k,}=_{k+1}_{k+1}\), for some \(_{k 1}\), and harmonic part following \(_{k}_{k,}=\).

## 3 Simplicial Complex CNNs

We start by introducing the general convolutional architecture on SCs, followed by its properties, then we discuss its components from an energy minimizations perspective. We refer to Appendix B for some illustrations. In a SC, a 8CCNN at layer \(l\) computes the \(k\)-output \(_{k}^{l}\) with \(_{k-1}^{l-1}\), \(_{k}^{l-1}\) and \(_{k+1}^{l-1}\) as inputs, i.e., a map \(_{k}^{l}:\{_{k-1}^{l-1},_{k}^{l-1}, _{k+1}^{l-1}\}_{k}^{l},\) for all \(k\). It admits a detailed form

\[_{k}^{l}=(_{k,}^{l}_{k,}^{l-1}+_{k}^{l}_{k}^{l-1}+_{k,}^{l} _{k,}^{l-1}),_{k}^{l}=_{t=0}^{T_{}}w_{k, ,t}^{l}_{k,}^{t}+_{_{}}^{T_{ }}w_{k,u,t}^{l}_{k,}^{t}.\] (1)

1) Previous output \(_{k}^{l-1}\) is passed to a simplicial convolution filter (SCF ) \(_{k}^{l}\) of orders \(T_{},T_{}\), which performs a linear combination of the data from up to \(T_{}\)-hop lower-adjacent and \(T_{}\)-hop upper-adjacent simplices, weighted by two sets of learnable weights \(\{w_{k,,t}^{l}\},\{w_{k,u,t}^{l}\}\).

2) \(_{k,}^{l-1}=_{k}^{}_{k-1}^{l-1}\) and \(_{k,}^{l-1}=_{k+1}_{k+1}^{l-1}\) are the lower and upper projections from \((k 1)\)-simplices via incidence relations, respectively. Then, \(_{k,}^{l-1}\) is passed to a lower SCF \(_{k,}^{l}:=_{t=0}^{T_{}}w_{k,,t}^{ l}_{k,}^{t}\), and the upper projection \(_{k,}^{l-1}\) is passed to an upper SCF \(_{k,}^{l}:=_{t=0}^{T_{}}w_{k,u,t}^{l} _{k,}^{t}\). Lastly, the sum of the three SCF outputs is passed to an elementwise nonlinearity \(()\).

This architecture subsumes the methods in [14; 15; 16; 19; 18; 20]. Particularly, we emphasize on the key three principles. 1) Uncouple the lower and upper Laplacians: this leads to an independent treatment of the lower and upper adjacencies, achieved by using two sets of learnable weights; 2) Account for the inter-simplicial couplings: \(_{k,}\) and \(_{k,}\) carry the nontrivial information contained in the faces and cofaces (by Theorem 1); and 3) Perform higher-order convolutions: considering \(T_{},T_{} 1\) in SCFs which leads to a multi-hop receptive field on SCs. In short, SCCNN propagates information across SCs based on two simplicial adjacencies and two incidences in a multi-hop fashion.

### Properties

**Simplicial locality.** SCFs admit an intra-simplicial locality: \(_{k}_{k}\) is localized in \(T_{}\)-hop lower and \(T_{}\)-hop upper \(k\)-simplicial neighborhoods . A SCCNN preserves such locality as \(()\) does not alter the information locality. It also admits the inter-simplicial locality between \(k\)- and \((k 1)\)-simplices, which extends to simplices of orders \(k 2\) if \(L 2\) because \(_{k}(_{k+1})\). Moreover, the two localities are coupled in a multi-hop way through SCFs such that a node not only interacts with its incident edges and the triangles including it, but also those further hops away.

**Complexity.** A SCCNN layer has the parameter complexity of order \((T_{}+T_{})\) and the computational complexity \((k(n_{k}+n_{k+1})+n_{k}m_{k}(T_{}+T_{}))\), linear to the simplex dimensions, where \(m_{k}\) is the maximum of the number of neighbors for \(k\)-simplices.

**Equivariance.** SCCNNs are permutation-equivivariant, which allows us to list simplices in any order, and orinetation-equivariant if \(()\) is odd, which gives us the freedom to choose reference orientations. In Appendix B.3, we provide formal discussions on such equivariances and why permutations form a symmetry group of a SC and orientation changes are symmetries of data space but not SCs.

### A perspective of SCCNN from Dirichlet energy minimization on SCs

**Definition 2**.: The _Dirichlet energy_ of \(_{k}\) is \(D(_{k})=D_{}(_{k})+D_{}(_{k}):= \|_{k}_{k}\|_{2}^{2}+\|_{k+1}^{}_{k} \|_{2}^{2}\).

For node signals, \(D(_{0})=\|_{1}^{}_{0}\|_{2}^{2}=_{i}_{j} \|x_{0,i}-x_{0,j}\|^{2}\) is a \(_{2}\)-norm of the _gradient_ of \(_{0}\). For edge flows, \(D(_{1})\) is the sum of the total divergence and curl, which measure the flow variations w.r.t. nodes and triangles, respectively. In general, \(D(_{k})\) measures the lower and upper \(k\)-simplicial signal variations w.r.t. the faces (\(D_{}(_{k})\)) and cofaces (\(D_{}(_{k})\)). A \(k\)-signal \(_{k}\) with \(D(_{k})=0\) follows \(_{k}_{k}=\), called _harmonic_, e.g., a constant node signal and a div- and curl-free edge flow.

**Simplicial shifting as Hodge Laplacian smoothing.** considered \(_{k}\) as a weighted variant of \(-_{k}\), generalizing the GCN layer . This simplicial shifting step is necessarily a Hodge Laplacian smoothing . Given an initial \(_{k}^{0}\), we consider the Dirichlet energy minimization:

\[_{_{k}}\|_{k}_{k}\|_{2}^{2}+\| _{k+1}^{}_{k}\|_{2}^{2},>0,\;\;_{k,}^{l+1}=(- _{k,}-_{k,})_{k} ^{l}\] (2)

with step size \(>0\). The simplicial shifting \(_{k}^{l+1}=w_{0}(-_{k})_{k}^{l}\) is a gradient descent with \(==1\) and weighted by \(w_{0}\), then followed by nonlinearity. A minimizer of Eq. (2) with \(=1\) is in the harmonic space \((_{k})\). Thus, an NN composed of simplicial shifting layers may lead to an output with exponentially decreasing Dirichlet energy as it deepens, i.e., _simplicial oversmoothing_.

**Proposition 3**.: _If \(w_{0}^{2}\|-_{k}\|_{2}^{2}<1\), \(D(_{k}^{l+1})\) in a simplicial shifting exponentially converges to 0._

This generalizes the oversmoothing of GCN and its variants . However, when uncoupling the lower and upper parts of \(_{k}\) in this shifting, associated with \( 1\), the decrease of \(D(_{k})\) can slow down or cease because the objective instead looks for a solution primarily in either \((_{k})\) (for \( 1\)) or \((_{k+1}^{})\) (for \( 1\)), not necessarily in \((_{k})\), as we show in Section 6.

**Inter-simplicial couplings as sources.** Given some nontrivial \(_{k-1}\) and \(_{k+1}\), we consider

\[_{_{k}}\|_{k}_{k}-_{k-1}\|_{2}^{2 }+\|_{k+1}^{}_{k}-_{k+1}\|_{2}^{2},\] (3)

which has a gradient descent \(_{k,}^{l+1}=(-_{k})_{k }^{l}+(_{k,}+_{k,})\). It resembles the whole layer in , \(_{k}^{l+1}=w_{0}(-_{k})_{k}^{l}+w_{1} _{k,}+w_{2}_{k,}\) with some weights, followed by nonlinearity. We have \(D(_{k}^{l+1}) w_{0}^{2}\|-_{k}\|_{2}^{2}D( _{k}^{l})+w_{1}^{2}_{}(_{k,})\| _{k,}\|_{2}^{2}+w_{2}^{2}_{}(_{k, })\|_{k,}\|_{2}^{2}\), by triangle inequality. The projections here act as energy sources, and also the objective looks for an \(_{k}\) in the images of \(_{k+1}\) and \(_{k}^{}\), instead of \((_{k})\) when \(_{k-1}\) and \(_{k+1}\) are not trivial. Thus, inter-simplicial couplings can potentially mitigate the oversmoothing as well.

Here we show simply generalzing GCN will inherit its oversmoothing to SCs. However, both the separation of the lower and upper Laplacians and inter-simplicial couplings could potentially mitigate this oversmoothing. We here considered a Dirichlet energy minimization perspective. They can also be explained by means of diffusion process on SCs . We refer to Appendix B.4 for this.

## 4 From convolutional to Hodge-aware

In this section, we show how SCCNN, guided by the three principles, performs _the Hodge-aware learning_, allowing for rational and effective learning on SCs while remaining expressive. To ease the exposition, we first provide a more fine-grained spectral view on how SCCNN learns from simplicial data of different variations in the three subspaces based on the simplicial spectral theory . Then, we characterize its expressive power and discuss its Hodge-awareness.

**Definition 4** ().: The simplicial Fourier transform (SFT) of \(_{k}\) is \(}_{k}=_{k}^{}_{k}\) where the Fourier basis \(_{k}\) can be found as the eigenbasis of \(_{k}\) and the eigenvalues are _simplicial frequencies_.

**Proposition 5** ().: _The SFT basis can be found as \(_{k}=[_{k,}\;_{k,}\; _{k,}]\) where 1) the zero eigenspace \(_{k,}\) of \(_{k}\) spans \((_{k})\), and an eigenvalue \(_{k,}=0\) is a harmonic frequency; 2) the nonzero eigenspace \(_{k,}\) of \(_{k,}\) spans \((_{k}^{})\), and an eigenvalue \(_{k,}\) is a gradient frequency, measuring the lower variation \(D_{}(_{k,})\); 3) the nonzero eigenspace \(_{k,}\) of \(_{k,}\) spans \((_{k+1})\), and an eigenvalue \(_{k,}\) is a curl frequency, measuring the upper variation \(D_{}(_{k,})\)._

Thus, the SFT of \(_{k}\) can be found as \(}_{k}=[}_{k,}^{},}_{k,}^{},}_{k,}^{}]^{}\), where each component is the intensity of \(_{k}\) at a simplicial frequency. Consider \(_{k}=_{k,}_{k,}+_{k }_{k}+_{k,}_{k,}\) in a SCCNN layer. Multiplying on both sides by \(_{k}\), we then have the SFT \(}\) as

\[}_{k,}=}_{k, }}_{k,},\\ }_{k,}=}_{k,}}_{k,}+}_{k,}}_{k,},\\ }_{k,}=}_{k,}}_{k,}+}_{k,}}_{k,},}_{k,}=(w_{k,, }+w_{k,,0}),\\ }_{k,}=_{t=0}^{T_{}}w_{k,,t} _{k,}^{}+w_{k,,0},\\ }_{k,}=_{t=0}^{T_{}}w_{k,,t} _{k,}^{}+w_{k,,0}, the frequency response of \(_{k}\) as \(}_{k}=(_{k}^{}_{k}_{k})\), and \(}_{k,}\) and \(}_{k,}\), the responses of \(_{k,}\) and \(_{k,}\), can be expressed accordingly. This spectral relation (4) shows how the learning of SCCNN is performed at frequencies in different subspaces. Specifically, the gradient SFT \(}_{k,}\) is learned by a gradient response \(}_{k,}\), which is independent of the curl response \(}_{k,}\) learning the curl SFT \(}_{k,}\), and they only coincide at the trivial harmonic frequency, as shown in Fig. 0(a). Likewise, the lower and upper projections are independently learned by \(}_{k,}\) and \(}_{k,}\), respectively.

The nonlinearity induces the information spillage that one type of spectra could be spread over other types. That is, \((}_{k,})\) could contain information in harmonic or curl subspaces, as illustrated in Fig. 0(b). This is to increase the expressive power of SCCNN, which can be characterized as follows.

**Theorem 6**.: _A SCCNN layer with inputs \(_{k,},_{k},_{k,}\) is at most expressive as an MLP layer \((_{k,}^{}_{k,}+ _{k}_{k}+_{k,}^{}_{k,})\) with \(_{k}=_{k,}+_{k,}\) where \(_{k,}\) and \(_{k,}\) are analytical matrix functions of \(_{k,}\) and \(_{k,}\), respectively, and \(_{k,}^{}\) and \(_{k,}^{}\) likewise. Moreover, this expressivity can be achieved when setting \(T_{}=T_{}^{}=n_{k,}\) and \(T_{}=T_{}^{}=n_{k,}\) in Eq. (1) with \(n_{k,}\) the number of distinct gradient frequencies and \(n_{k,}\) the number of distinct curl frequencies._

The proof follows from Cayley-Hamilton theorem . This expressive power can be better understood spectrally. The gradient SFT of \(_{k}\) can be learned most expressively by an analytical function \(g_{k,}()\), the eigenvalue of \(_{k,}\) at a gradient frequency. And the curl SFT of \(_{k}\) can be learned most expressively by another analytical function \(g_{k,}()\), the eigenvalue of \(_{k,}\) at a curl frequency. These two functions only need to coincide at harmonic frequency \(=0\). The SFTs of lower and upper projections can be learned most expressively by two independent functions as well. Given this expressive power and Eq. (4), we show SCCNN performs the Hodge-aware learning as follows.

**Theorem 7**.: _A SCCNN is Hodge-aware in the sense that 1) three Hodge subspaces are **invariant** under the learnable SCF \(_{k}\), i.e., \(}_{k}(_{k}^{})\) if \((_{k}^{})\), and likewise for \((_{k+1}),(_{k})\): 2) the gradient and curl spaces are invariant under the learnable lower SCF \(_{k,}\) and upper SCF \(_{k,}\), respectively; 3) the learning in the gradient and curl spaces are **independent and expressive**._

This theorem essentially shows SCCNN performs expressive learning independently in the gradient and curl subspaces from three inputs while preserving the three subspaces to be invariant w.r.t its learning functions. This allows for the **rational and effective learning** on SCs. On one hand, the invariance of subspaces under the learnable SCFs substantially shrinks the learning space and makes SCCNN effective, meanwhile, its expressive power is guaranteed by the independent expressive learners, together with the nonlinearity. Instead, the non-Hodge-aware learning, e.g., MLP or simplicial message-passing using MLP to aggregate and update , has a much larger learning space which requires more training data for accurate learning, as well as larger computational complexity.

On the other hand, simplicial data often presents (implicit or explicit) properties that Hodge subspaces can capture. For example, water flows, traffic flows, electric currents  follow flow conservation (div-free, in \((_{1})\)), or curl-free forex rates, as we show in Section 6, or the gradient component of pairwise comparison data gives consistent global ranking but others are unwanted . SCCNN is able to capture these characteristics effectively, generating rational outputs due to the invariance of subspaces and independent learning in gradient and curl spaces. We illustrate a trivial example below.

_Example 8_.: Suppose learning to remove non-div-free noise from some input for flow conservation. SCCNN can correctly do so because when a not-well-learned SCF, preserving the noise and useful

Figure 1: (a) _(top):_ Independent gradient and curl learning responses. _(bottom):_ Stability-selectivity tradeoff of SCFs where \(_{}\) has better stability but smaller selectivity than \(_{}\). (b) Information spillage of nonlinearity. (c) The distance between the perturbed outputs and true when node adjacencies are perturbed. _(top):_\(L=1\), triangle output remains clean. _(bottom):_\(L=2\), triangle output is perturbed.

parts primarily in their own spaces, causes large loss, e.g., mse, the Hodge-awareness restricts it to suppress in the gradient space and preserve in others. This however can be difficult non-Hodge-aware learners, e.g., MLP or MPSN , especially when the amount of data is limited, because the non-div-free noise can be disguised as useful by their unbiased transformation into other spaces, and the useful parts could be transformed into noise space, generating irrational non-div-free output though the overall mse can be small. _Thus, simplicial data characteristics can be easily ignored by non-Hodge-aware learners when the invariance condition is not satisfied._

**Comparison to others.** We here discuss some other existing learning methods on SCs to emphasize on the Hodge-awareness.  considered \(_{k}=_{i}w_{i}_{k}^{i}\) to perform convolutions without uncoupling the lower and upper parts of \(_{k}\), which makes it _strictly less expressive_ and non-Hodge-aware, because it cannot perform different learning at frequencies in both gradient and curl spaces, though deeper layers and higher orders can compensate its expressive at other frequencies.  applied \(_{k}\) with \(T_{}=T_{}=1\), which has a limited linear learning response. SCCNN returns the methods in [19; 38] when there is no inter-simplicial coupling needed. [14; 20] took the form of simplicial shifting by generalizing the GCN without uncoupling the two adjacencies, which is not-Hodge-aware. Spectrally, this gives a limited lower-pass linear spectral response, shown in Fig. 0(a).

## 5 How robust are SCCNNs to domain perturbations?

In practice, a SCCNN is often built on a weighted SC to capture the strengths of simplicial adjacencies and incidences, with a same form as Eq. (1), except for that the Hodge Laplacians and the projection matrices are weighted, denoted as general operators \(_{k,},_{k,}\). These matrices are often defined following [29; 39; 40], e.g., [14; 20] considered a particular random walk formulation , or can be learned from data, e.g., via an attention method [42; 38]. Since SCCNN relies on the Hodge Laplacians and projection matrices, in this section, we address the question, _when these operators are perturbed, how accurate and robust are the outputs of a SCCNN?_ This models the domain perturbations on the strengths of adjacent and incident relations such as a large weight is applied when two edges are weakly or not adjacent, or data on a node projects on an edge not incident to it. By quantifying this stability, we can explain the robust learning ability of SCCNN. We consider a relative perturbation model, also used to study the stability of CNNs [43; 44; 45] and GNNs [46; 47; 48; 49].

Denote the perturbed lower and upper Laplacians as \(}_{k,}\) and \(}_{k,}\) by perturbations \(_{k,}\) and \(_{k,}\), and the lower and upper projections as \(}_{k,}\) and \(}_{k,}\) by perturbations \(_{k,}\) and \(_{k,}\), respectively.

**Definition 9** (Relative perturbation).: Consider some perturbation matrix \(\) of an appropriate dimension. For a symmetric matrix \(\), its (relative) perturbed version is \(}()=++\). For a rectangular matrix \(\), its (relative) perturbed version is \(}()=+\).

This relative perturbation model, in contrast to an absolute one , quantifies perturbations w.r.t. the local simplicial topology in the sense that weaker connections in a SC are deviated by perturbations proportionally less than stronger connections. We further consider the integral Lipschitz property, extended from , to measure the variability of spectral response functions of \(_{k}\).

**Definition 10**.: A SCF \(_{k}\) is _integral Lipschitz_ with constants \(c_{k,}\), \(c_{k,} 0\) if the derivatives of response functions \(_{k,}()\) and \(_{k,}()\) follow that \(|^{}_{k,}()| c_{k,}\) and \(|^{}_{k,}()| c_{k,}\).

This property provides a stability-selectivity tradeoff of SCFs independently in gradient and curl frequencies. A spectral response can have both good selectivity and stability in small frequencies (a large \(|^{}_{k,}|\) for \( 0\)), while in large frequencies, it tends to be flat for better stability at the cost of selectivity (a small variability for large \(\)), as shown in Fig. 0(a). As of the polynomial nature of responses, all SCFs of a SCCNN are integral Lipschitz. We also denote the integral Lipschitz constant for the lower SCFs \(_{k,}\) by \(c_{k,}\) and for the upper SCFs \(_{k,}\) by \(c_{k,}\). Given the following reasonable assumptions, we are ready to characterize the stability bound of a SCCNN.

**Assumption 11**.: _a) The perturbations are small such that \(\|_{k,}\|_{2}_{k,},\|_{k, }\|_{2}_{k,},\|_{k,}\|_{2} _{k,}\) and \(\|_{k,}\|_{2}_{k,}\). b) The SCFs \(_{k}\) of a SCCNN have a normalized bounded frequency response (for simplicity, though unnecessary), likewise for \(_{k,}\) and \(_{k,}\). c) The lower and upper projections are finite \(\|_{k,}\|_{2} r_{k,}\) and \(\|_{k,}\|_{2} r_{k,}\). d) The nonlinearity \(()\) is \(c_{}\)-Lipschitz (e.g., \(,,\)). e) The initial input \(_{k}^{0}\), for all \(k\), is finite, \(\|_{k}^{0}\|_{2}[]_{k}\).._

**Theorem 12**.: _Let \(_{k}^{L}\) be the \(k\)-simplicial output of an L-layer SCCNN on a weighted SC. Let \(}_{k}^{L}\) be the output of the same SCCNN but on a relatively perturbed SC. Under Assumption 11, the Euclidean distance between the two outputs is finite and upper-bounded \(\|}_{k}^{L}-_{k}^{L}\|_{2}[]_{k}\) where_

\[=c_{}^{L}_{l=1}^{L}}^{l-1} ^{L-l},=t_{0}&t_{0,u}\\ t_{1,d}&t_{1}&t_{1,u}\\ t_{2,d}&t_{2}=1&r_{0,u}\\ r_{1,d}&1&r_{1,u}\\ r_{2,d}&1,\] (5)

_for \(K=2\), which are tridiagonal, and \(}\) is defined as \(\) but with off-diagonal entries \(_{k,}=r_{k,}(1+_{k,})\) and \(_{k,}=r_{k,}(1+_{k,})\). Diagonal entries of \(\) are \(t_{k}=c_{k,}_{k,}_{k,}+c_{k, }_{k,}_{k,}\), and off-diagonals are \(t_{k,}=r_{k,}_{k,}+c_{k,} _{k,}_{k,}r_{k,}\) and \(t_{k,}=r_{k,}_{k,}+c_{k,} _{k,}_{k,}r_{k,}\), where \(_{k,}\) captures the eigenvector misalignment between \(_{k,}\) and perturbation \(_{k,}\) with a factor \(}\), and likewise for \(_{k,}\)._

This result bounds the outputs of a SCCNN on all simplicial levels, showing they are stable to small perturbations on the strengths of simplicial adjacencies and incidences. Specifically, we make two observations from the seemingly complicated expression. 1) The stability bound depends on i) the degree of perturbations including their magnitude \(\) and \(\), and eigenspace misalignment \(\), ii) the integral Lipschitz properties of SCFs, and iii) the degree of projections \(r\). \(2)\) The stability of \(k\)-output depends on factors of not only \(k\)-simplices, but also simplices of adjacent orders due to inter-simplicial couplings. When \(L=1\), node output bound \(d_{0}\) depends on factors in the node space, as well as the edge space factored by the projection degree, and vice versa for edge output. As the layer deepens, this mutual dependence expands further. When \(L=2\), factors in the triangle space also affect the stability of node output \(d_{0}\), and vice versa for triangle output, as observed in Fig. 0(c).

More importantly, this stability provides practical implications for learning on SCs. While accounting for inter-simplicial couplings may be beneficial, it does not help with the stability of SCCNNs when the number of layers increases due to the mutual dependence between different outputs. Thus, to maintain the expressive power, higher-order SCFs can be used in exchange for shallow layers. This does not harm the stability because, first, the components of high-frequency can be spread over the low frequency due to the nonlinearity where the spectral responses are more selective without losing the stability; and second, higher-order SCFs are easier to be learned with smaller integral Lipschitz constants than lower-order ones, thus, better stability. The latter can be easily seen by comparing one-order and two-order cases. We also experimentally show this in Fig. 4.

## 6 Experiments

**Synthetic.** We first illustrate the evolution of Dirichlet energies of outputs on nodes, edges and triangles of a SC of order two by numbers of simplicial shifting layers with \(=\). The inputs on them are randomly sampled from \(([-5,5])\). Fig. 2 shows simply generalizing GCN on SCs could lead to oversmoothing on simplices of all orders. However, uncoupling the lower and upper parts of \(_{1}\) by setting, e.g., \(=2\) could mitigate the oversmoothing on edges. Lastly, the inter-simplicial coupling could almost prevent the oversmoothing.

**Foreign currency exchange.** In forex problems, for any currencies \(i,j,k\), the _arbitrary-free_ condition of a fair market reads as \(r^{i/j}r^{j/k}=r^{i/k}\) with the exchange rate \(r^{i/j}\) between \(i\) and \(j\). That is, the exchange path \(i j k\) provides no profit or loss over a direct exchange \(i k\). By modeling the forex as a SC of order two and the exchange rates as edge flows \([_{1}]_{[i,j]}=(r^{i/j})\), this condition translates as \(_{1}\) is curl-free, i.e., \([_{1}]_{[i,j]}+[_{1}]_{[j,k]}-[_{1}]_{[i,k]}=0\) in any triangle \([i,j,k]\). Here we consider a real-world forex market from  at three intestamps, which contains certain degree of arbitrage. We artificially added some random noise and "curl noise" (only in the curl space) to this market, in which we aim to recover the forex rates. We also randomly masked 50\(\%\) of the rates, where we aim to interpolate the market such that it is arbitrage-free. Three settings create three types of learning needs. To evaluate the performance, we measure both normalized mse and total arbitrage (total curl), both equally important for the goal of _creating a fair market by small price fluctuations_.

From Table 1, we make the following observations. 1) MPSN  fails at this task: although it can reduce nmse, it outputs unfair rates with large arbitrage, which is against the forex principle, because it is not Hodge-aware, unable to capture the arbitrage-free property with small amount of data. 2) SNN  fails too: as discussed in Section 4, it restricts the gradient and curl spaces to be always learned in the same fashion, unable to meet the need of disjoint learning of this task in two spaces. 3) PSNR  can reconstruct relatively fair forex rates with small nmse. In the curl noise case, the reconstruction is perfect, while in the other two cases, the nmse and arbitrage are three times larger than SCCNN due to its limited linear learning responses. 4) SCCNN performs the best in both reducing the total error and the total arbitrage. We also notice that with \(=\), the arbitrage-free rule is fully learned by SCCNN. However, it has relatively larger errors in the random and interpolation cases due to its limited linear expressive power. With \(=\), SCCNN can tackle these more challenging cases, finding a good compromise between overall error and data characteristics.

**Simplex Prediction.** We then test SCCNN on simplex prediction task which is an extension of link prediction in graphs . Our approach is to first learn the features of lower-order simplices and then use an MLP to identify if a simplex is closed or open. We built a SC as  on a coauthorship dataset  where nodes are authors and collaborations of \(k\)-authors are \((k-1)\)-simplices. The input simplicial data is the number of citations, e.g., \(_{1}\) and \(_{2}\) are those of dyadic and triadic collaborations, which does not present explicit properties like forex rates. Thus, 2-simplex (3-simplex) prediction amounts to predict triadic (tetradic) collaborations. From the AUC results in Table 2, we make three observations. 1) SCCNN, MPSN and Bunch  methods outperform the rest due to the inter-simplicial couplings. 2) Uncoupling the lower and upper parts in \(_{k}\) improves the feature learning (SCNN  better than SNN). 3) Higher-order convolution further improves the prediction (SCNN better than PSNR, SCCNN better than Bunch). Note that MPSN has three times more parameters than SCCNN under the settings of the best results.

**Ablation study.** Table 3 reports the results of SCCNN when certain simplicial relation is missing, which helps understand their roles. When not considering the edge-to-node incidence, it (when using node features) is equivalent to GNN with poor performance. When removing other adjacencies or incidences, the best performance remains but with an increase of model complexity, more layers required. This, however, is not preferred, because the stability decreases as the model deepens and becomes influenced by factors in other simplicial space, as shown in Fig. 0(c). We also considered the case with limited input, e.g., when the input on nodes or on edges is missing. The best performance of SCCNN only slightly drops with an increase of convolution order, compared to before \(T=2\).

**How tight is the stability bound?** We consider the perturbations which relatively shift the eigenvalues of Hodge Laplacians and the singular values of projection matrices by \(\). We compare the bound in Eq. (5) with experimental distance on each simplex level. Fig. 3 shows the bound becomes tighter as perturbation increases.

**Trajectory prediction.** We lastly test on predicting trajectories in a synthetic SC and of ocean drifters from , introduced by . From Table 4 we first observe SCCNN and Bunch with inter-simplicial couplings do not perform better than those without. This is because zero inputs are applied on nodes and triangles , which makes inter-couplings inconsequential. Secondly, using higher-order convolutions improves the

   Methods & Synthetic & Ocean drifts \\  SNN  & 65.5\(\)2.4 & 52.5\(\)6.0 \\ PSNN  & 63.1\(\)3.1 & 49.0\(\)8.0 \\ SCNN  & **67.7\(\)1.7** & 53.0\(\)7.8 \\ Bunch  & 62.3\(\)4.0 & 46.0\(\)6.2 \\ SCCNN & 65.2\(\)4.1 & **54.5\(\)7.9** \\   

Table 4: Trajectory prediction.

   
   Missing & 2-Simplex & Param. \\  â€” & 98.7\(\)0.5 & \(L=2\) \\ Edge-to-Node & 93.9\(\)1.0 & \(L=5\) \\ Node-to-Node & 98.7\(\)0.4 & \(L=4\) \\ Edge-to-Edge & 98.5\(\)1.0 & \(L=3\) \\ Node-to-Edge & 98.8\(\)0.3 & \(L=4\) \\  Node input & 98.2\(\)0.5 & \(T=4\) \\ Edge input & 98.1\(\)0.4 & \(T=3\) \\   

Table 3: Ablation study. Figure 4: Stability as \(T\) increases.

Figure 3: Stability bound. Figure 4: Stability as \(T\) increases.

average accuracy in both datasets (SCNN better than PSNN on average, SCCNN better than Bunch). Note that the prediction here aims to find a candidate from the neighborhood of end node, which depends on the node degree. Since the average node degree of the synthetic SC is \(5.24\) and that in ocean drifter data is \(4.81\), a random guess has around \(20\%\) accuracy. The high standard derivations could come from the limited ocean drifter dataset.

**Convolution orders on stability.** We also show that NNs with higher-order SCFs have more potential to learn better integral Lipschitz properties, thus, better stability. We consider SCNNs  with orders \(T_{}=T_{}=1,3,5\) and train them with a regularizer to reduce the integral Lipschitz constants. As shown in Fig. 4, the higher-order case has a smaller distance (better stability) between the outputs without and with perturbations, with consistent better accuracy, comapred to the lower-order case.

## 7 Related Work, Discussion and Conclusion

Related work mainly concerns learning methods on SCs.  first used \(_{1,}\) to build NNs on edges in a graph setting without the upper edge adjacency.  then generalized convolutional GNNs  to simplices by using the Hodge Laplacian.  instead uncoupled the lower and upper Laplacians to perform one- and multi-order convolutions, to which  added attention schemes.  considered a variant of  to identify topological holes and  combined shifting on nodes and edges for link prediction. Above works learned within a simplicial level and did not consider the incidence relations (inter-simplicial couplings) in SCs, which was included by . These works considered convolutional-type methods, which can be subsumed by SCCNN. Meanwhile,  generalized the message passing on graphs  to SCs, relying on both adjacencies and incidences. Most of these works focused on extending GNNs to SCs by varying the information propagation on SCs without many theoretical insights into their components. Among them,  discussed the equivariance of PSNN to permutation and orientation, which SCCNN admits as well.  studied the messgae-passing on SCs in terms of WL test of SCs built by completing cliques in a graph. The more closely related work  gave only a spectral formulation based on SCFs.

**Discussion.** In our opinion, the advantage of using SCs is not only about them being able to model higher-order network structure, but also support simplicial data, which can be both human-generated data like coauthorship, and physical data like flow-typed data. This is why we approached the analysis from the perspectives of both simplicial structures and the simplicial data, i.e., the Hodge theory and spectral simplicial theory . We provided deeper insights into why three principles are needed and how they can guide the effective and rational learning from simplicial data. As what we practically found, in experiments where data exhibits properties characterized by the Hodge decomposition, SCCNN performs well due to the Hodge-awareness while non-Hodge-aware learners can fail at giving rational results. In cases where data does not possess such properties, SCCNN has better or comparable performance than the ones which violate or do not respect the three principles. This also shows the advantages of SCCNN, especially when data has certain properties.

Concurrently, there are works on more general cell complexes, e.g., , where 2-cells inlcude not only triangles, but also general polygon faces. We focus on SCs because a regular CW complex can be subdivided into a SC  to which the analysis in this paper applies, or we can generalize our analysis by allowing \(_{2}\) to include 2-cells. This is however informal and does not exploit the power of cell complexes, which lies on cellular sheaves, as studied in .

**Limitation.** A major limitation of our method is that it cannot learn differently from features at the frequencies of the same type and the same value. For instance, harmonic features are learned in a same fashion because they all have zero frequency. This is however common in convolutional type learning methods on both graphs and SCs. Also, our stability analysis concerns the perturbations on the connection strengths and did not consider the case where simplices join or disappear. Both of them can be interesting future directions, together with more physical-based data applications.

**Conclusion.** We proposed three principles for convolutional learning on SCs, summarized in a general architecture, SCCNN. Our analysis showed this architecture, guided by the three principles, demonstrates an awareness of the Hodge decomposition and performs rational, effective and expressive learning from simplicial data. Furthermore, our study reveals that SCCNN exhibits stability and robustness against perturbations in the strengths of simplicial connections. Experimental results validate the benefits of respecting the three principles and the Hodge-awareness. Overall, our work establishes a solid foundation for learning on SCs, highlighting the importance of the Hodge theory.