# Systematic Visual Reasoning through

Object-Centric Relational Abstraction

 Taylor W. Webb*+

Department of Psychology

University of California, Los Angeles

Los Angeles, CA

taylor.w.webb@gmail.com

&Shanka Subhra Mondal*+

Department of Electrical and Computer Engineering

Princeton University

Princeton, NJ

smondal@princeton.edu

* Equal Contribution

&Jonathan D. Cohen

Princeton Neuroscience Institute

Princeton, NJ

jdc@princeton.edu

###### Abstract

Human visual reasoning is characterized by an ability to identify abstract patterns from only a small number of examples, and to systematically generalize those patterns to novel inputs. This capacity depends in large part on our ability to represent complex visual inputs in terms of both objects and relations. Recent work in computer vision has introduced models with the capacity to extract object-centric representations, leading to the ability to process multi-object visual inputs, but falling short of the systematic generalization displayed by human reasoning. Other recent models have employed inductive biases for relational abstraction to achieve systematic generalization of learned abstract rules, but have generally assumed the presence of object-focused inputs. Here, we combine these two approaches, introducing Object-Centric Relational Abstraction (OCRA), a model that extracts explicit representations of both objects and abstract relations, and achieves strong systematic generalization in tasks (including a novel dataset, CLEVR-ART, with greater visual complexity) involving complex visual displays.

## 1 Introduction

When presented with a visual scene, human reasoners have a capacity to identify not only the objects in that scene, but also the relations between objects, and the higher-order patterns formed by multiple relations. These abilities are fundamental to human visual intelligence, enabling the rapid induction of abstract rules from a small number of examples, and the systematic generalization of those rules to novel inputs . For example, when presented with the image in Figure 1, one can easily determine that the objects in the top and bottom rows are both governed by a common abstract pattern (ABA). Furthermore, one could easily then generalize this pattern to _any_ potential shapes, even those that one has never observed before. Indeed, this is arguably what it means for a pattern to be considered _abstract_.

Though this task appears effortless from the perspective of human reasoning, it exemplifies the type of problems that pose a significant challenge for standard neural network methods. Rather than inducing an abstract representation of the underlying rules in a given task, neural networks tend to overfit to the specific details of the examples observed during training, thus failing to generalize those rules to novel inputs .

To address this, a number of neural network methods have recently been proposed that incorporate strong inductive biases for _relational abstraction_, also referred to as a'relational bottleneck' . The key insight underlying these approaches is that abstract visual patterns are often characterized by the _relations_ between objects, rather than the features of the objects themselves. For example, the pattern seen in Figure 1 is characterized by the relation between the shape and position of the objects. By constraining architectures to process visual inputs in terms of relations between objects, these recent approaches have achieved strong systematic (i.e., out-of-distribution) generalization of learned abstract rules, given only a small number of training examples .

However, a major assumption of these approaches is that relations are computed between _objects_. Accordingly, these methods have generally relied on inputs consisting of pre-segmented visual objects, rather than multi-object scenes. Furthermore, these methods can sometimes be brittle to task-irrelevant visual variation, such as spatial jitter or Gaussian noise . It is thus unclear whether and how these approaches might scale to complex and varied real-world settings.

In this work, we take a step toward the development of relational reasoning algorithms that can operate over more realistic visual inputs. To do so, we turn to object-centric representation learning , a recently developed approach in which visual scenes are decomposed into a discrete set of object-focused latent representations, without the need for veridical segmentation data. Though this approach has shown success on a number of challenging visual tasks , it has not yet been integrated with the strong relational inductive biases that have previously been shown to enable systematic, human-like generalization . Here, we propose Object-Centric Relational Abstraction (OCRA), a model that combines the strengths of these two approaches. Across a suite of visual reasoning tasks (including a novel dataset, CLEVR-ART, with greater visual complexity), we find that OCRA is capable of systematically generalizing learned abstract rules from complex, multi-object visual displays, significantly outperforming a number of competitive baselines in most settings.

Figure 1: **Object-Centric Relational Abstraction (OCRA). OCRA consists of three core components, responsible for modeling objects, relations, and higher-order relations. First, given a visual input \(\), slot attention extracts object-centric representations, consisting of factorized feature embeddings \(_{k=1 K}\) and position embeddings \(_{k=1 K}\). Second, pairwise relation embeddings \(_{kk^{}}\) are computed by first passing each pair of feature embeddings to a relational operator \(\), and then additively incorporating their position embeddings. This allows visual space to serve as an indexing mechanism for visual relations. Finally, relational embeddings are passed to a transformer to model the higher-order patterns formed by multiple relations.**

## 2 Approach

Figure 1 shows a schematic depiction of our approach. OCRA consists of three core components, each responsible for a different element of the reasoning process. These three elements can be summarized as 1) extraction of object-centric representations, 2) computation of pairwise relational embeddings, and 3) processing of higher-order relational structures - patterns across multiple relations - in order to identify abstract rules. We describe each of these three components in the following sections.

### Object-centric representation learning

OCRA employs slot attention  to extract object-centric representations from complex, multi-object visual inputs. Given an image \(\), the goal of slot attention is to extract a set of latent embeddings (i.e., _slots_), each of which captures a focused representation of a single visual object, typically without access to ground truth segmentation data.

To do so, the image is first passed through a series of convolutional layers, generating a feature map \(^{H W D}\). Positional embeddings \(^{H W D}\) are then generated by passing a 4d position code (encoding the four cardinal directions) through a separate linear projection. Feature and position embeddings are additively combined, and then passed through a series of 1x1 convolutions. This is then flattened, yielding \(^{N D}\) (where \(N=H W\)), over which slot attention is performed.

The set of \(K\)\(^{K D}\) is then randomly initialized (from a shared distribution with learned parameters), and a form of transformer-style cross-attention is employed to attend over the pixels of the feature map. Specifically, each slot emits a query \(()^{K D}\) (through a linear projection), and each location in the feature map emits a key \(()^{N D}\) and a value \(()^{N D}\). For each slot, a query-key attention operation is then used to generate an attention distribution over the feature map \(=(}\,() ()^{})\) and a weighted mean of the values \(=()\) is used to update the slot representations using a Gated Recurrent Unit , followed by a residual MLP. This process is repeated for \(T\) iterations, leading to a competition between the slots to account for each pixel in the feature map.

For the purposes of computing relational embeddings, we employed a factorized object representation format, in which position is represented distinctly from other object features. For a given input image, after performing \(T\) iterations of slot attention, we used the final attention map \(_{T}^{K N}\) to compute feature- and position-specific embeddings for each slot:

\[_{k}=_{T}\,()[k] \]

\[_{k}=_{T}\,()[k] \]

where \(\) and \(\) represent the feature- and position-embedding maps (prior to being combined). As will be seen in the following section, this factorized representation allows visual space to serve as an indexing mechanism for pairwise relations, mirroring the central role of spatial organization in human visual reasoning .

Although slot attention can in principle be learned end-to-end in the service of a specific downstream reasoning task, here we chose to pre-train slot attention using an unsupervised objective. This decision reflects the assumption that human-like visual reasoning does not occur in a vacuum, and visual representations are generally not learned from scratch when performing each new task. Instead, visual object representations are shaped by a wealth of non-task-specific prior experience. To model the effects of this prior experience, we pre-trained slot attention to reconstruct randomly generated multi-object displays, using a slot-based autoencoder framework (more details in Section 4.3.1). Importantly, for experiments testing generalization of abstract rules to novel objects, we ensured that these objects did not appear in the pre-training data for slot attention.

### Relational embeddings

After extracting object embeddings, we employed a novel relational embedding method, designed to allow OCRA to abstract over the perceptual features of individual objects (and thus systematicallygeneralize learned rules to inputs with novel perceptual features). This embedding method consisted of two steps. First, we applied a relational operator \(\) to compute the pairwise relation between two feature embeddings \(_{k}\) and \(_{k^{}}\). In the present work, we define this operator as:

\[(_{k},_{k^{}})=(_{k}_{}_{k^{ }}_{})_{} \]

where \(_{k}\) and \(_{k^{}}\) are first projected through a shared set of linear weights \(_{}^{D D}\), and the dot product between these weighted embeddings is then projected back out into the original dimensionality using another set of weights \(_{}^{1 D}\). Using dot products to model pairwise relations introduces a layer of abstraction between the perceptual features of the objects and the downstream reasoning process, in that the dot product _only_ represents the relations between objects, rather than those objects' individual features. We hypothesized that this relational bottleneck would lead to improved generalization to inputs with novel perceptual features. Additionally, the shared projection weights (\(_{}\)) enable the model to learn which features are relevant for a given task, and to only compute relations between those features.

After applying the relational operator, we then compute the relational embedding for objects \(k\) and \(k^{}\) as:

\[_{kk^{}}=(_{k},_{k^{}})+_{k}_{ }+_{k^{}}_{} \]

where the position embeddings \(_{k}\) and \(_{k^{}}\) are each projected through a shared set of linear weights1\(_{}^{D D}\) and added to the output of \(\). This allows the relation between objects \(k\) and \(k^{}\) to be indexed by their spatial position, thus endowing OCRA with an explicit variable-binding mechanism.

### Processing of higher-order relations

After computing all \(K^{2}\) pairwise relational embeddings, we then pass these embeddings to a reasoning process to extract higher-order relations - patterns formed between multiple relations. This is an essential component of visual reasoning, as abstract rules, such as the one displayed in Figure 1, are typically defined in terms of higher-order relations. We model these higher-order interactions using a transformer :

\[=(_{k=1,k^{}=1}..._{k=K,k^{ }=K}) \]

where the inputs are formed by the set of all pairwise relational embeddings \(_{kk^{}}\) (for all \(k=1...K\) and all \(k^{}=1...K\)), and \(\) is a task-specific output. Because we employ a symmetric relational operator in the present work, we do not in practice present the full matrix of pairwise comparisons, but instead limit these comparisons to those in the upper triangular matrix.

## 3 Related Work

A number of methods for annotation-free object segmentation have recently been proposed , including the slot attention method employed by our proposed model . Though the details of these methods differ, they share the general goal of decomposing visual scenes into a set of latent variables corresponding to objects, without access to ground truth segmentation data. Building on the success of these object-encoding methods, some recent work has developed object-centric approaches to visual reasoning that combine slot-based object representations with transformer-based architectures , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , 

[MISSING_PAGE_FAIL:5]

**ART.** The Abstract Reasoning Tasks (ART) dataset was proposed by Webb et al. , consisting of four visual reasoning tasks, each defined by a different abstract rule (Figure S1). In the'same/different' task, two objects are presented, and the task is to say whether they are the same or different. In the'relational match-to-sample' task, a source pair of objects is presented that either instantiates a'same' or 'different' relation, and the task is to select the pair of target objects (out of two pairs) that instantiates the same relation. In the 'distribution-of-3' task, a set of three objects is presented in the first row, and an incomplete set is presented in the second row. The task is to select the missing object from a set of four choices. In the 'identity rules' task, an abstract pattern is instantiated in the first row (ABA, ABB, or AAA), and the task is to select the choice that would result in the same relation being instantiated in the second row.

The primary purpose of this dataset was to evaluate strong systematic generalization of these rules. Thus, each task consists of a number of generalization regimes of varying difficulty, defined by the number of unique objects used to instantiate the rules during training (out of a set of 100 possible objects). In the most difficult regime (\(m=95\)), the training set consists of problems that are created using only 5 objects, and the test problems are created using the remaining 95 objects, whereas in the easiest regime (\(m=0\)), both training and test problems are created from the complete set of 100 objects (though the arrangement of these objects is distinct, such that the training and test sets are still disjoint). The most difficult generalization regime poses an especially difficult test of systematic generalization, as it requires learning of an abstract rule from a very small set of examples (details shown in Table S1), with little perceptual overlap between training and test.

As originally proposed , the ART dataset involved pre-segmented visual objects. Here, we investigated a version of this task involving multi-object visual displays (see Supplementary Section S2 for details). We also applied random spatial jitter (random translation of up to 5 pixels in any direction) to each object, as this was previously found to significantly impair performance in some previous reasoning models .

**SVRT.** The Synthetic Visual Reasoning Test (SVRT), proposed by Fleuret et al. , consists of 23 binary classification tasks, each defined by a particular configuration of relations. The tasks can be broadly divided into two categories: those that are based primarily on same/different relations ('SD'; tasks 7, 21, 5, 19, 6, 17, 20, 1, 13, 22, 16; example shown in Figure S5(a)), and those that are primarily based on spatial relations ('SR'; tasks 12, 15, 14, 9, 23, 8, 10, 18, 4, 3, 11, 2; example shown in Figure S5(b)). As with previous work , we limit training to a relatively small number of examples (either 500 or 1000 per task).

**CLEVR-ART.** We created a novel dataset based on ART using realistically rendered 3D shapes from CLEVR  (Figure S4). We focused on two specific visual reasoning tasks: relational-match

Figure 2: **Abstract visual reasoning tasks. Three datasets used to evaluate systematic visual reasoning. Abstract Reasoning Tasks (ART) consist of four separate visual reasoning tasks: same/different, relational-match-to-sample, distribution-of-3, and identity rules (pictured). Systematic generalization is studied by training on problems involving a small number of objects (as few as 5), and testing on heldout objects. Synthetic Visual Reasoning Test (SVRT) consists of 23 tasks, each defined by separate abstract rule. Rules are defined based on either spatial relations (SR) or same/different relations (SD; pictured). In example problem, category 1 always contains three sets of two identical objects, category 2 always contains two sets of three identical objects. CLEVR-ART is a novel dataset consisting of ART problems rendered using more realistic 3D shapes, based on the CLEVR dataset.**-to-sample and identity rules. Problems were formed from objects of three shapes (cube, sphere, and cylinder), three sizes (small, medium, and large), eight colors (gray, red, blue, green, brown, purple, cyan, and yellow) and two textures (rubber and metal). To test systematic generalization, the training set consisted of problems using only small and medium sized rubber cubes in four colors (cyan, brown, green, and gray) whereas the test set consisted only of problems using large sized metal spheres and cylinders in four distinct colors (yellow, purple, blue, and red). The training and test sets thus involved completely disjoint perceptual features, similar to the original ART.

### Baselines

We compared our model to results from a set of baseline models evaluated by Vaishnav and Serre , including their GAMR architecture, ResNet50 , and a version of ResNet that employed self-attention (Attn-ResNet) . To the best of our knowledge, these baselines represent the best performing models on the tasks that we investigated. We also investigated an additional set of baselines that combined our pretrained slot attention module with various reasoning architectures, including GAMR , ESBN , Relation Net (RN) , Transformer , Interaction Network (IN) , and CoRelNet . These baselines benefited from the same degree of pre-training and object-centric processing as our proposed model, but employed different reasoning mechanisms. Finally, we investigated a self-supervised baseline (a Masked Autoencoder (MAE) ) to assess the extent to which a generative objective might encourage systematic generalization (see Tables S13, S14 for results). All baselines were evaluated using multi-object displays. See Supplementary Section S3 for more details on baselines.

### Experimental Details

#### 4.3.1 Pre-training slot attention

We pre-trained slot attention using a slot-based autoencoder framework. For ART, we generated a dataset of random multi-object displays (see Figure S2), utilizing a publicly available repository of unicode character images. We eliminated any characters that were identical to, or closely resembled, the 100 characters present in the ART dataset, resulting in a training set of 180k images, and a validation set of 20k images. For SVRT, we pre-trained two versions of slot attention on all tasks, one using 500 and the other using 1000 training examples from each of the 23 tasks. For CLEVR-ART, we generated a dataset of randomly placed 3D shapes from CLEVR, and pre-trained slot attention using a training set of 90k images, and validation set of 10k images.

To pre-train slot attention, we used a simple reconstruction objective and a slot-based decoder. Specifically, we used a spatial broadcast decoder , which generates both a reconstructed image and a mask for each slot. We then generated a combined reconstruction, normalizing the masks across slots using a softmax, and using the normalized masks to compute a weighted average of the slot-specific reconstructions.

After pre-training, the slot attention parameters were frozen for training on the downstream reasoning tasks. For ART, we found that despite not having been trained on any of the objects in the dataset, slot attention was nevertheless able to generate focused attention maps that corresponded closely to the location of the objects (see Figures S6).

#### 4.3.2 Training details and hyperparameters

Images were resized to \(128 128\), and pixels were normalized to the range \(\). For SVRT, we converted the images to grayscale, and also applied random online augmentations during training, including horizontal and vertical flips. Tables S2 and S3 describes the hyperparameters for the convolutional encoder and spatial broadcast decoder respectively. For slot attention, we used \(K=6\) (\(K=7\) for CLEVR-ART) slots, \(T=3\) attention iterations per image, and a dimensionality of \(D=64\). Training details are described in Table S4

Table S5 gives the hyperparameters for the transformer. To solve the SVRT tasks, and the same/different ART task, we used a CLS token (analogous to CLS token in ) together with a sigmoidal output layer to generate a binary label, and trained the model with binary cross-entropy

[MISSING_PAGE_FAIL:8]

the slot-transformer. This disparity was especially striking in the most difficult generalization regime (\(m=95\)), in which models were trained on only 5 objects, and tested on a heldout set of 95 objects. Importantly, no component of OCRA (including both the slot attention and relational reasoning components) had been exposed to these heldout objects. OCRA outperformed the next-best baselines in this regime (GAMR and slot-transformer) by as much as 25%, demonstrating a significant degree of systematic generalization. We also analyzed OCRA's learned relational embeddings, finding that they captured relational information even in this out-of-distribution setting (Figure S5).

Many of the baseline models that we evaluated did not contain a relational bottleneck (Transformer, IN, RN, GAMR, ResNet), limiting their ability to generalize relational patterns to novel objects (i.e., higher values of \(m\)). The comparison with these models thus demonstrates the importance of the relational bottleneck, which enables systematic generalization of learned relational patterns. The ESBN and CoRelNet architectures _did_ include a relational bottleneck, but they were not designed with multi-object inputs in mind, and therefore performed poorly on these tasks in all regimes (even when combined with our slot attention module). This is due primarily to the random permutation of slots in slot attention, which motivated our positional embedding variable-binding scheme (allowing OCRA to keep track of which relations correspond to which pairs of objects).

On SVRT, OCRA showed comparable overall performance with GAMR, displaying marginally better performance on tasks characterized by same/different relations, while GAMR performed marginally better on tasks involving spatial relations (Figure 11, right). OCRA also outperformed GAMR on CLEVR-ART (Figure 11, left), demonstrating that its capacity for systematic generalization can be extended to problems involving more realistic visual inputs. Overall, the results on ART, SVRT, and CLEVR-ART demonstrate that OCRA is capable of solving a diverse range of relational reasoning problems from complex multi-object displays.

### Ablation Study

We performed an ablation study targeting each of OCRA's major components, focusing on the most difficult regime of the relational match-to-sample and identity rules tasks (Table 11). To evaluate the importance of OCRA's capacity for object-centric processing, we tested a version of the model without slot attention ('w/o Slot Attention'), in which the visual feature map was instead divided into a \(4 4\) grid, treating each image patch as though it were an 'object'. We also tested a version in which slot attention was only trained end-to-end on the visual reasoning tasks ('w/o Pre-training'), to test the importance of prior exposure to a diverse range of multi-object displays. To evaluate the importance of OCRA's relational embedding method, we tested five different ablation models. In one model ('w/o Relational Embeddings'), slot embeddings were passed directly to the transformer. In another model ('w/o Factorized Representation'), we did not compute separate feature and position embeddings for each object, and instead applied the relational operator directly to the slot embeddings. In a third model ('w/o Relational Bottleneck'), relational embeddings were computed simply by applying an MLP to each pair of slot embeddings (allowing the model to overfit to the perceptual

Figure 4: **CLEVR-ART. Results for systematic generalization on two CLEVR-ART tasks. Results reflect test accuracy averaged over 5 trained networks \(\) standard error. SVRT. Results on the Synthetic Visual Reasoning Test (SVRT) . OCRA and GAMR showed comparable overall performance, with OCRA performing marginally better on problems involving same / different relations, and GAMR performing marginally better on problems involving spatial relations.**

details of these embeddings), thus removing OCRA's inductive bias for relational abstraction. In a fourth model ('w/o Inner Product') the dot product in the relational operator (Equation 5) was replaced with a learned bottleneck, in which each pair of slot embeddings was passed to a learned linear layer with a one-dimensional output. This model tested the extent to which the inherently relational properties of the dot product are important for relational abstraction (as opposed to resulting merely from compression to a single dimension). In a fifth model ('Replace Inner Product w/ Outer Product'), the dot product was replaced with an outer product (resulting in a \(D D\) matrix, which was then flattened and projected via a learned linear layer to an embedding of size \(D\)). Finally, to evaluate the importance of OCRA's capacity to process higher-order relations, instead of passing relational embeddings to a transformer, we instead summed all relation embeddings elementwise and passed the resulting vector to an MLP, as is done in the Relation Net ('w/o Transformer'). All ablation models performed significantly worse than the complete version of OCRA, demonstrating that all three elements in our model - object-centric processing, relational abstraction, and higher-order relations - play an essential role in enabling systematic generalization.

## 6 Limitations and Future Directions

In the present work, we have presented a model that integrates object-centric visual processing mechanisms (providing the ability to operate over complex multi-object visual inputs) with a relational bottleneck (providing a strong inductive bias for learning relational abstractions that enable human-like systematic generalization of learned abstract rules). Though this is a promising step forward, and a clear advance relative to previous models of abstract visual reasoning, it is likely that scaling the present approach to real-world settings will pose additional challenges. First, real-world images are especially challenging for object-centric methods due to a relative lack of consistent segmentation cues. However, there has recently been significant progress in this direction , in particular by utilizing representations from large-scale self-supervised methods , and it should be possible to integrate these advances with our proposed framework. Second, the current approach assumes a fixed number of slot representations, which may not be ideal for modeling real-world scenes with a highly variable number of objects . Though we did not find that this was an issue in the present work, in future work it would be desirable to develop a method for dynamically modifying the number of slots. Third, OCRA's relational operator is applied to all possible pairwise object comparisons, an approach that may not be scalable to scenes that contain many objects. In future work, this may be addressed by replacing the transformer component of our model with architectures that are better designed for high-dimensional inputs . Finally, it is unclear how our proposed approach may fare in settings that involve more complex real-world relations, and settings that require the discrimination of multiple relations at once. It may be beneficial in future work to investigate a'multi-head' version of our proposed model (analogous to multi-head attention), in which multiple distinct relations are processed in parallel. A major challenge for future work is to develop models that can match the human capacity for structured visual reasoning in the context of complex, real-world visual inputs.

    & RMTS & ID \\  OCRA (full model) & **85.31\(\)2.0** & **92.80\(\)0.3** \\ w/o Slot Attention & 56.58\(\)3.1 & 84.42\(\)1.1 \\ w/o Pre-training & 58.69\(\)3.6 & 53.48\(\)4.8 \\ w/o Relational Embeddings & 74.79\(\)1.8 & 81.21\(\)1.1 \\ w/o Factorized Representation & 50.26\(\)0.2 & 75.40\(\)0.6 \\ w/o Relational Bottleneck & 63.62\(\)1.0 & 76.56\(\)1.8 \\ w/o Inner Product & 50.70\(\)0.4 & 48.07\(\)2.6 \\ Replace Inner Product w/ Outer Product & 62.84\(\)1.6 & 69.58\(\)1.1 \\ w/o Transformer & 51.29\(\)0.2 & 44.18\(\)0.6 \\   

Table 1: Ablation study on \(m=95\) generalization regime for two ART tasks. Results reflect test accuracy averaged over 10 trained networks \(\) standard error.

Acknowledgements

Shanka Subhra Mondal was supported by Office of Naval Research grant N00014-22-1-2002 during the duration of this work. We would like to thank Princeton Research Computing, especially William G. Wischer and Josko Plazonic, for their help with scheduling training jobs on the Princeton University Della cluster.