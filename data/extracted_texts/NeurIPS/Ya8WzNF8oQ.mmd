# Beyond Stationarity: Convergence Analysis of Stochastic Softmax Policy Gradient Methods

Anonymous Author(s)

Affiliation

Address

email

###### Abstract

Markov Decision Processes (MDPs) deliver a formal framework for modeling and solving sequential decision-making problems. In this paper, we make several contributions towards the theoretical understanding of (stochastic) policy gradient methods for MDPs. The focus lies on proving convergence (rates) of softmax policy gradient towards global optima in undiscounted finite-time horizon problems, i.e. \(=1\), without regularization. Such problems are relevant for instance for optimal stopping or specific supply chain problems. Our estimates must differ significantly from several recent articles that involve powers of \((1-)^{-1}\).

The main contributions are the following. For undiscounted finite-time MDPs we prove asymptotic convergence of policy gradient to a global optimum and derive a convergence rate using a weak Polyak-Lojasiewicz (PL) inequality. In each decision epoch, the derived error bound depends linearly on the remaining duration of the MDP. In the second part of the analysis, we quantify the convergence behavior for the stochastic version of policy gradient. The analysis yields complexity bounds for an approximation arbitrarily close to the global optimum with high probability.

As a by-product, our stochastic gradient arguments prove that the plain vanilla REINFORCE algorithm for softmax policies indeed approximates global optima for sufficiently large batch sizes.

## 1 Introduction

Policy gradient methods continue to enjoy great popularity in practice due to their model-free nature and high flexibility. Despite their far-reaching history (Williams, 1992; Sutton et al., 1999; Konda and Tsitsiklis, 1999; Kakade, 2001), there were no proofs for the global convergence of these algorithms for a long time. Nevertheless, they have been very successful in many applications, which is why numerous variants have been developed in the last few decades, whose convergence analysis, if available, is mostly limited to convergence to stationary points (Pirotta et al., 2013; Schulman et al., 2015; Papini et al., 2018; Clavera et al., 2018; Shen et al., 2019; Xu et al., 2020; Huang et al., 2020; Xu et al., 2020; Huang et al., 2022).

In recent years, notable advancements have been achieved in the convergence analysis towards global optima (Fazel et al., 2018; Agarwal et al., 2021; Mei et al., 2020; Bhandari and Russo, 2021, 2022; Cen et al., 2022; Xiao, 2022; Alfano and Rebeschini, 2023). These achievements are partially attributed to the utilization of (weak) gradient domination or Polyak-Lojasiewicz (PL) inequalities (Polyak, 1963). As examined in Karimi et al. (2016) a PL-inequality and smoothness implies a linear convergence rate for gradient descent methods. In certain cases, only a weaker form of the PL inequality can be derived, which states that it is only possible to limit the norm of the gradient instead of the squared norm of the gradient by the distance to the optimum. Despite this limitation, \((1/n)\)-convergence can still be achieved in some instances.

The research community has predominantly focused on discounted Markov decision processes (MDPs) with infinite time horizon: \((,,p,r,)\) is an MDP, where \(\) is a finite state space, \(\) is a finite action space, \(p\) is a transition function such that \(p(s^{}|s,a)\) denotes the probability of transitioning from state \(s\) to state \(s^{}\) under action \(a\). The reward function is given by \(r: R\), where \(R\) is usually assumed to be bounded and positive, and \((0,1)\) is a discount factor. The value function under consideration takes the form

\[V^{}(s)=_{S_{0}=s,A_{t}(|S_{t}),S_{t+1} p(|S_ {t},A_{t})}_{t=0}^{}^{t}r(S_{t},A_{t}),\] (1)

for all \(s\). Investigating a stationary policy applied in every time point suffices for discounted MDPs (Puterman, 2005, Theorem 6.1.1). Yet, in this paper, we focus on MDPs with finite-time horizons and without a discount factor, i.e., \(=1\). There is a prevailing argument that finite-time MDPs do not require additional scrutiny as they can be transformed into infinite horizon MDPs. However, specific challenges arise in certain scenarios, such as optimal stopping (Li et al., 2009) or finite-time inventory control problems (Bhandari and Russo, 2022), where a non-stationary policy becomes necessary. Unlike in infinite time horizon MDPs, reducing the problem to stationary policies is inadequate for finite-time MDPs, and a new policy must be trained recursively at each time step (Puterman, 2005). Our convergence analysis comprises two steps: firstly, we investigate convergence at each time step and secondly, we examine the error accumulation through backward induction. A detailed discussion of finite-time MDPs is presented in Section 2. There are some recent articles also studying policy gradient of finite-time horizon MDPs considering fictitious discount algorithms (Guo et al., 2022) or finite-time linear quadratic control problems (Hambly et al., 2021, 2022; Zhang et al., 2021).

We begin with a discussion of relevant results for discounted MDPs that encourage our contributions. In Agarwal et al. (2021), the global asymptotic convergence of policy gradient is demonstrated under tabular softmax parametrization, and convergence rates are derived using log-barrier regularization and natural policy gradient. Building upon this work, Mei et al. (2020) showed the first convergence rates for policy gradient using non-uniform PL-inequalities (Mei et al., 2021), specifically for tabular softmax parametrization. However, this convergence rate is fundamentally dependent on the discount factor, \((1-)^{-6}\), and cannot be readily extrapolated to undiscounted MDPs with finite-time horizons.

To bridge this gap, we consider policy gradient under tabular softmax parametrization, but in undiscounted MDPs with finite-time horizons and non-stationary policies. In Section 3, we show asymptotic convergence to a global optimum and subsequently derive a global convergence rate using a weaker form of the PL-inequality. The convergence rate at a fixed time point is linearly depending on the remaining duration of the MDP, which is a better property compared to \((1-)^{-6}\). The issue of dependency on \(\) when it approaches \(1\) is a significant subject in the context of discounting, and various efforts have been made to mitigate this dependency. For instance, employing entropy regularization as demonstrated in Mei et al. (2020) or applying mirror descent as described in Xiao (2022) can enhance the rate of convergence.

In the second part of the paper, we abandon the assumption that the exact gradient is known and focus on the model free stochastic policy gradient method. For this type of algorithm, very little is known even in the discounted case. Agarwal et al. (2021) discussed the approximate natural policy gradient for log-linear policies, and Ding et al. (2022) derived complexity bounds for entropy-regularized stochastic policy gradient. They use a well-chosen stopping time which measures the distance to the set of optimal parameters, and simultaneously guarantees convergence to the regularized optimum prior to the occurrence of the stopping time by using a small enough step size and large enough batch size. Similar to this idea, we construct a different stopping time in this work, which allows us to analyze convergence of the stochastic policy gradient method in the finite, non-stationary case and also in the infinite discounted case without regularization. The stopping time we propose measures the distance between the policy gradient and stochastic policy gradient trajectories and stops when the stochastic gradient differs too far from the exact gradient updates. This allows us to derive complexity bounds for an approximation arbitrarily close to the global optimum that does not require a set of optimal parameters, which is relevant when considering softmax parametrization.

To the best of our knowledge, the results presented in this paper provide the first convergence analysis of softmax policy gradient in the undiscounted finite-time MDP setting without regularization. We note that discussions in Bhandari and Russo (2022) do not apply to softmax parametrization, as they assume the existence of optimal parameters in the parameter space.

The remainder of this manuscript is structured as follows: In Section 2, we discuss finite-time MDPs and explain how to solve them using backward induction. In Section 3, we show asymptotic convergence to a global optimum and derive the corresponding convergence rate. Moreover, in Section 4, we present the results pertaining to finite-time stochastic policy gradient and in Section 5 we analyze the error accumulation using backward induction for exact and stochastic gradients. In Section 6, we provide our findings regarding infinite discounted MDPs, where we derive complexity bounds for the REINFORCE algorithm.

## 2 Finite-time horizon MDPs

A finite-time MDP is defined by a tuple \((,,,r,p)\) with \(=\{0,,H-1\}\) decision epochs, finite state space \(=_{0}_{H-1}\), finite action space \(=_{s}_{s}\), a reward function \(r:\) and transition function \(p:()\) with \(p(_{h+1}|s,a)=1\) for every \(h<H-1\), \(s_{h}\) and \(a_{s}\). Let \((D)\) denote the set of all probability measures over a finite set \(D\). Due to finite decision epochs, the choice of the action is time dependent, i.e. non-stationary policies \(=(_{h})_{h=0}^{H-1}\) must be considered, where \(_{h}:_{h}()\) for every \(h\) is such that \(_{h}(_{s}|s)=1\) for every \(s_{h}\). Denote by \(_{(h)}=(_{k})_{k=h}^{H-1}\) the sub-policy of \(\) form \(h\) to \(H-1\), and define the \(h\)-state value function under policy \(\) for every \(s_{h}\) by

\[V_{h}^{_{(h)}}(s):=_{s}^{_{(h)}}_{k=h}^{H-1}r(S_{k},A_{k}), h,\] (2)

where \(_{s}^{_{(h)}}\) is the expectation under the measure such that \(S_{h}=s\), \(A_{k}_{k}(|S_{k})\) and \(S_{k+1} p(|S_{k},A_{k})\) for \(h k<H-1\). The \(h\)-state-action value function for every tuple \((s,a)_{h}_{s}\) is defined by

\[Q_{h}^{_{(h+1)}}(s,a):=r(s,a)+_{s^{}_{h+1}}p(s^{ }|s,a)V_{h+1}^{_{(h+1)}}(s^{}), h H-2.\] (3)

Note that \(Q_{h}\) is independent of policy \(_{h}\) and for \(H-1\), \(Q_{H-1}(s,a):=r(s,a)\) independently of any policy. Furthermore, define the \(h\)-state-action advantage function

\[A_{h}^{_{(h)}}(s,a):=Q_{t}^{_{(h+1)}}(s,a)-V_{h}^{_{(h)}}(s), s _{h},a_{s}.\] (4)

In the following, we will suppress the dependence of \(_{(h)}\) and write \(\) in the superscripts of \(V_{h}\), \(Q_{h}\) and \(A_{h}\), when the policy is clear out of context. We denote by

\[V_{h}^{}(_{h}):=_{s_{h}}[V_{h}^{}(s)]\]

the value function for an initial state distribution \(_{h}\) on \(_{h}\) in epoch \(h\). The performance difference lemma (Kakade and Langford, 2002) is a useful identity to compare policies. It turns out to be very useful to prove convergence of policy gradient methods (Agarwal et al., 2021). For finite-time MDPs the following version is proved in the supplementary material:

**Lemma 2.1** (Performance difference lemma).: _For any \(h\) and for any pair of policies \(\) and \(^{}\) the following holds true for every \(s_{h}\):_

\[V_{h}^{}(s)-V_{h}^{^{}}(s)=_{k=h}^{H-1}_{S_{h}=s}^{ _{(h)}}_{k}^{^{}}(S_{k},A_{k}).\]

In order to address finite-time MDPs it becomes necessary to consider non-stationary policies because the optimal decision at each time point depends on the time horizon until the end of the problem. Thus, to solve finite-time MDPs with policy gradient a time-dependent parametrization of the policy is required. Consider a parameter space denoted by \(=_{0}_{H-1}\), where a policy parameter \(=(_{0},,_{H-1})\) includes \(H\) different parameters. A parametric policy \(^{}=(^{_{h}})_{h=0}^{H-1}\) is defined such that the policy in epoch \(h\) depends only on the parameter \(_{h}\). It is worth noting that finite-time MDPs are typically solved using backward induction as known from dynamic programming theory (Puterman, 2005). In order to obtain the optimal solution for a finite-time MDP through backward induction the parametrization must have the capability to approximate any deterministic policy. This is because deterministic optimal policies exist for finite-time MDPs similar to discountedMDPs. These conditions have made the tabular softmax policy a subject of extensive research in the context of discounted MDPs, owing to its ability to meet these requirements (Mei et al., 2020; Agarwal et al., 2021; Ding et al., 2022). Let \(_{h}=^{d_{h}}\) for all \(h\), where \(d_{h}=_{s_{h}}|_{s}|\) the number of state-action pairs in epoch \(h\). Then the tabular softmax parametrization is defined to be

\[^{}(a|s)=} ((s,a^{}))},=((s,a))_{s_{h},a _{s}}^{d_{h}}.\] (5)

In the forthcoming chapters, we will center our convergence analysis on this parametrization. Nevertheless, we emphasize that the results presented in this section are also valid for any other parametrization.

To solve a finite-time MDP the problem is partitioned into \(h\) sub-problems, with each epoch being considered separately. Given any fixed policy \(\), the objective function in epoch \(h\) is defined to be the \(h\)-state value function in state \(s_{h}\) under the policy \((^{_{h}},_{(h+1)}):=(^{_{h}},_{h+1}, ,_{H-1})\),

\[J_{h,s}(_{h}):=E_{S_{h}=s}^{(^{_{h}},_{(h+1)})} _{k=h}^{H-1}r(S_{k},A_{k}).\] (6)

An optimal parameter \(_{h}^{*}\) is then sought such that \(J_{h,s}(_{h}^{*})=_{_{h}}J_{h,s}()\), for all \(s_{h}\). In order to attain an optimal policy at each time point, this problem is approached via backward induction, and the parametrization \(\) in equation (6) is selected to be the pre-optimized one. Assuming that the parametrization is able to approximate an optimal policy (e.g. the softmax parametrization), then the backward induction yields optimal parameters \(_{h}^{*},,_{H-1}^{*}\) in the sense that, see Puterman (2005, Sec. 4.5),

\[J_{h,s}(_{h}^{*})=_{_{h}_{h},,_{H-1} _{H-1}}V_{h}^{^{}}(s),\]

for all \(s_{h}\). To employ the policy gradient method, it is essential to compute the gradient of \(J_{h,s}()\) with respect to \(\) for a given policy \(\). Notably, the forthcoming policy \(\) can be _any_ policy, independent of the current parameter \(\), which is trained during epoch \(h\). This approach significantly deviates from the one used in discounted MDPs, such as in Sutton et al. (1999), where a stationary policy is parametrized and utilized at every time step. Despite the differences, a policy gradient theorem can still be attained, allowing the gradient of the objective function to be written as an expectation.

**Theorem 2.2**.: _For a fixed policy \(\) and \(h\) the gradient of \(J_{h,s}()\) defined in (6) is given by_

\[ J_{h,s}()=_{S_{h}=s,A_{h}^{}(|s)}[ (^{}(A_{h}|S_{h}))Q_{h}^{}(S_{h},A_{h})].\]

As for the value function, we denote by \(J_{h}():=_{s_{h}}[J_{h,s}()]\) the objective function under some initial state distribution \(_{h}\) on \(_{h}\). Algorithm 1 summarizes policy gradient in finite-time MDPs.

``` Result: Approximate policy \(^{*}^{*}\)  Initialize \(^{(0)}=(_{0}^{(0)},,_{H-1}^{(0)})\) for\(h=H-1,,0\)do  Choose fixed step size \(_{h}\) and number of training steps \(N_{h}\) for\(n=0,,N_{h}-1\)do  Calculate \( J_{h}(_{h}^{(n)})\) with fixed policy \(^{*}\) after \(h\) \(_{h}^{(n+1)}=_{h}^{(n)}+_{h} J_{h}(_{h}^{(n)})\)  end for  Set \(_{h}^{*}=^{_{h}^{(N_{h})}}\)  end for ```

**Algorithm 1**Policy Gradient for finite-time MDPs and non-stationary policies

Training each time point separately and having a fixed policy \(\) after \(h\), we state a version of the performance difference lemma given this specific setting.

**Corollary 2.3**.: _For any \(h\) and two policies \(\) and \(^{}\): If \(_{(h+1)}=^{}_{(h+1)}\), it holds that_

\[V_{h}^{}(s)-V_{h}^{^{}}(s)=_{S_{h}=s}^{_{(h)}}A_{ h}^{^{}}(S_{h},A_{h}).\]Convergence Analysis of Softmax Policy Gradient

Before we combine all decision epochs as stated in Algorithm 1, we provide convergence results for each \(h\) given that the policy after \(h\) is fixed and denoted by \(\). The error analysis over time is then employed in Section 5.

_Assumption 3.1_.: Throughout the remaining manuscript we assume that the rewards are bounded in \([0,R^{*}]\), for some \(R^{*}>0\).

### Asymptotic convergence

The choice of tabular softmax parametrization is particularly convenient as derivatives are simple.

**Lemma 3.2**.: _Let \(h\), then the partial derivatives of \(J_{h}\) with respect to \(\) take the following form_

\[()}{(s,a)}=(s)^{}(a|s)A_{ h}^{(^{},_{(h+1)})}(s,a).\]

Furthermore, \(J_{h}\) is a smooth function with respect to \(\). The proof is based on a more general result which proves smoothness for all parametrizations with bounded gradient and Hessian of the log-policy.

**Proposition 3.3**.: _Let \(h\) and consider the objective function \(J_{h}()\). If there exists \(G,M>0\) such that_

\[||^{}(a|s)||_{2} G||^{2} ^{}(a|s)||_{2} M,\]

_for all \(s_{h}\), \(a_{s}\), then for any initial state distribution \(_{h}\) of \(S_{h}\) the function \(J_{h}()\) is \(_{h}\)-smooth in \(\) with \(_{h}=(H-h)R^{*}(G^{2}+M)\)._

Smoothness under these assumptions in the discounted finite-time setting with stationary policy was shown for example in Xu et al. (2020b) and Xu et al. (2020a). We obtain the following smoothness parameter:

**Lemma 3.4**.: _Let \(h\), then the \(h\)-state value function under softmax parametrization, \( J_{h}()\), is \(_{h}\)-smooth with \(_{h}=2(H-h)R^{*}||\)._

We point out that the smoothness parameter is independent of the choice of \(\). A consequence of the smoothness is the asymptotic convergence of the objective function towards a global maximum. As each epoch is considered separately we just write \(_{n}\) instead of \(_{h}^{(n)}\) until Section 5.

**Theorem 3.5**.: _Let \(h\) and consider the gradient ascent updates_

\[_{n+1}=_{n}+_{h} J_{h}(_{n})\] (7)

_for arbitrary \(_{0}^{d_{h}}\). We assume that \(_{h}(s)>0\) for all \(s_{h}\) and \(0<_{h}}\). Then, for all \(s_{h}\), \(J_{h,s}(_{n})\) converges to \(J_{h,s}^{*}\) for \(n\), where \(J_{h,s}^{*}=_{}J_{h,s}()<\)._

The difficulties that arise from softmax parametrization are the same as discussed in Agarwal et al. (2021) for the infinite time setting: The softmax policy approximates an optimal deterministic policy. Therefore, parameters converge to \(-\) for suboptimal actions and to \(\) for optimal actions. The idea of the proof follows the outline of the discounted MDP setting except for one main distinction: the action-value function \(Q_{h}\) is independent of the policy gradient updates such that no limiting process has to be constructed. A detailed proof is provided in B.1.

Note that the assumption \(_{h}(s)>0\) for all \(s_{h}\) is necessary for sufficient exploration. The same assumption is needed for the initial distribution of a discounted MDP in Agarwal et al. (2021, Thm. 10). Furthermore, Mei et al. (2020, Prop. 3) have demonstrated the necessity of this assumption.

### Convergence rate

In order to derive a convergence rate for tabular softmax parametrized finite-time MDPs we will establish a weaker form of the PL-inequality. Therefore, consider for \(h\) a deterministic optimal policy \(_{h}^{*}\), given that the policy after \(h\) is fixed by \(\), i.e. for all \(s_{h}\),

\[_{h}^{*}(|s)=}{}\, \,V_{h}^{(,_{(h+1)})}(s).\]

Please note here that the optimal policy and also \(J_{h,s}^{*}\) depend on the choice of \(\).

[MISSING_PAGE_FAIL:6]

**Theorem 4.1**.: _For any \(h\) consider the stochastic process \((_{n})_{n 0}\) generated by_

\[_{n+1}=_{n}+_{h}^{(n)}\,_{h}^{K_{h}}( ),\]

_for arbitrary batch size \(K_{h} 1\) and initial \(_{0}\) such that \([J_{h}(_{0})]<\). Furthermore, suppose that \(_{h}^{(n)}\) is decreasing, such that \(_{n 0}_{h}^{(n)}=\) and \(_{n 0}(_{h}^{(n)})^{2}<\). Then \( J_{h}(_{n}) 0\) almost surely for \(n\)._

With Lemma C.1 and the boundedness of the \(h\)-state value functions, this follows directly from the stochastic approximation theorem stated in Bertsekas and Tsitsiklis (2000) (see Proposition C.2 in the supplementary material).

### Complexity bounds to approximate to global optimum with high probability

In the following denote by \((_{n})_{n 1}\) the deterministic sequence generated by policy gradient with exact gradients,

\[_{n+1}=_{n}+_{h} J_{h}(_{n}).\] (10)

Let \((_{n})_{n 0}\) be the stochastic process from (9) such that the initial parameter agree, \(_{0}=_{0}\), and the step size \(_{h}\) is the same for both processes. The natural filtration of \((_{n})_{n 0}\) is denoted by \((_{n})_{n 0}\). Recall that \(c_{h}=_{n 0}_{s}^{_{n}}(a^{*}(s)|s)\) is bounded away from \(0\) by Lemma 3.7. The idea of the convergence analysis for stochastic softmax policy gradient is to define the following stopping time

\[:=\{n 0:\|_{n}-_{n}\|_{2}}{4}\}.\]

This means, \(\) is the first time when the stochastic process \((_{n})_{n 0}\) is _too far away_ from the policy gradient trajectory \((_{n})_{n 0}\). Hence, all challenges encountered in the deterministic case transfer to the stochastic context, indicating that the model dependent constant \(c_{h}\) naturally appears in the error bounds of the stochastic case. We emphasize that \(\) is a stopping time with respect to the filtration \((_{n})_{n 0}\) by construction.

First, consider the event \(\{n\}\), i.e. \(\|_{n}-_{n}\|_{2}}{4}\). It follows by the \(\)-Lipschitz continuity of \(^{}(a^{*}(s)|s)\) (Lemma C.3) that \(_{0 k}_{s}^{_{k}}(a^{*}(s)|s) }{2}>0\) (Lemma C.4). This allows us to use the weak PL-inequality of Lemma 3.6 to derive a convergence rate on the event \(\{n\}\) in the following sense:

**Lemma 4.2**.: _Suppose \(_{h}(s)>0\) for all \(s_{h}\), the batch size \(K_{h}^{(n)}^{2}C_{h}}{32_{h}^{2}N_{h}^{3}}(1-}})n^{2}\) is increasing for some \(N_{h} 1\) and the step size \(_{h}=}}\), for fixed \(h\). Then,_

\[(J_{h}^{*}-J_{h}(_{n}))_{\{n\}} }_{h}}{3(1-}})c_{h}^{2}n}.\]Secondly, consider the complementary event \(\{ n\}\). We can bound the probability of this event by \(\) for a large enough batch size \(K_{h}\). The proof is based on a similar result obtained by Ding et al. (2022, Lem. 6.3) for discounted MDPs.

**Lemma 4.3**.: _Suppose \(_{h}(s)>0\) for all \(s_{h}\). Then, for any \(>0\), we have \(( n)<\) if \(K_{h}C_{h}}{^{2}c_{h}^{2}^{2}}\) and \(_{h}=}}\)._

We are now ready to formulate the main result of this section.

**Theorem 4.4**.: _Suppose the stochastic policy gradient updates are generated by (9) for arbitrary initialization \(_{0}^{d_{h}}\). Suppose that \(_{h}(s)>0\) for all \(s_{h}\) and choose for any \(,>0\),_

1. _the number of training steps_ \(N_{h}(}{3 c_{h}^{2}})^{2}\)_,_
2. _the step size_ \(_{h}=}}\) _and the batch size_ \(K_{h}=^{3}C_{h}}{^{2}c_{h}^{2}^{2}}\)_._

_Then, \((J_{h}^{*}-J_{h}(_{N_{h}}))\)._

It should be noted that the choice of step size \(_{h}\) and batch size \(K_{h}\) are closely connected and both strongly depend on the number of training steps \(N_{h}\). Specifically, as \(N_{h}\) increases, the batch size increases, while the step size tends to decrease to prevent exceeding the stopping time with high probability. However, it is possible to increase the batch size even further and simultaneously benefit from choosing a larger step size, or vice versa.

## 5 Error Analysis over Time

In this section, we will first examine the accumulation of error over time for the policy gradient Algorithm 1, and secondly, for the stochastic policy gradient Algorithm 2. In both cases the error accumulates linearly such that an \(\)-error in each time point \(h\) results in an overall error of \(\). This is due to the additive structure of the rewards and comes naturally from the backward induction of dynamic programming for finite-time MDPs.

**Theorem 5.1**.: _Assume that \(_{h}(s)>0\) for all \(h\), \(s_{h}\). Let \(>0\), the step size \(_{h}=}\) and the batch size \(N_{h}=||}{c_{h}^{2}} {1}{_{h}}_{}\). Denote by \(^{*}=(^{_{0}^{N_{0}}},,^{_{H-1}^{N_{H-1}}})\) the final policy from Algorithm 1, then for all \(s_{0}\),_

\[V_{0}^{*}(s)-V_{0}^{^{*}}(s).\]

For the stochastic policy gradient algorithm, we obtain the following main result:

**Theorem 5.2**.: _Assume that \(_{h}(s)>0\) for all \(h\), \(s_{h}\). Let \(,>0\), the step size \(_{h}=N_{h}}\), number of training steps \(N_{h}=(H^{2}}_{}}{ 3 c_{h}^{2}})^{2}\) and the batch size \(K_{h}=^{2}H^{2}C_{h}}{_{h}c_{h}^{2}^{2}}\). Denote by \(^{*}=(^{_{0}^{N_{0}}},,^{_{H-1}^{N_{H-1}}})\) the final policy from Algorithm 2, then_

\[ s_{0}:V_{0}^{*}(s)-V_{0}^{^{* }}(s).\]

In both results we observe that the number of training steps in each epoch depends on the constant \(}_{}=_{s}(s)}\). The proofs of Section D reveal that this constant occurs to ensure that the objective \(J_{h,s}(_{h}^{(N_{h})})\) is close to \(J_{h,s}^{*}\) for every \(s_{h}\).

## 6 Convergence Analysis of Stochastic Policy Gradient in Infinite Horizons

In this final section, we show how to combine the results of Mei et al. (2020) with our stochastic gradient arguments to show that the plain vanilla REINFORCE algorithm without regularization can approximate global maxima if the batch sizes are chosen properly. Our theoretically derived batch sizes are clearly not of practical use but give a first insight why REINFORCE requires large batch sizes to give reasonable approximations. In the following, we consider the discounted MDP setting from Equation (1) with rewards taking values in \(\), i.e. \(R^{*}=1\), and tabular softmax parametrization \(^{}\) from (5) with \(=^{||||}\). The objective function \(J():=_{S_{0}}[V^{^{}}(S_{0})]\) is defined for an initial state distribution \(\). It is important to highlight that \(^{}\) is now a stationary policy used in every epoch. Our arguments rely on the weak PL-inequality for the exact value function. Mei et al. (2020) proved that

\[\|}()}{}\|_{2} \|^{^{*}}}{d_{}^{^{}}}\|_{}}^{}(a^{*}(s)|s)}{|}}(V^{*}( )-V^{^{}}()),\]

where \(a^{*}(s)=\;^{*}(|s)\) the optimal action in state \(s\) and \(\|^{^{*}}}{d_{}^{^{}}}\|_{}\) is the distribution mismatch coefficient introduced in Agarwal et al. (2021). We present an alternative version in Lemma E.2 without the constant \(||^{-1/2}\). The typical approach to prove convergence of stochastic gradient schemes is to iteratively compare the stochastic gradient update to the deterministic one and then control the error. This is not always possible, but for stochastic softmax policy gradient we show that the error can be controlled for large enough batch sizes. We proceed in a manner similar to Section 4.2. Thus, to state the theorem let us denote by

\[_{n+1}=_{n}+ J(_{n}), _{n+1}=_{n}+J^{K}()\] (11)

the policy gradient and stochastic policy gradient schemes. Also denote by \(c:=_{n 0}_{s}^{_{n}}(a^{*}(s)|s)\) the model dependent constant from the weak PL-inequality of (Mei et al., 2020, Lem. 8). For the algorithm we use the unbiased gradient estimator proposed by Zhang et al. (2020) which the authors used to prove convergence to a stationary point. Our main contribution is the following convergence result towards the global optimum:

**Theorem 6.1**.: _Let \((_{n})_{n 0}\) and \((_{n})_{n 0}\) be the (stochastic) policy gradient updates from (11) for arbitrary initial \(_{0}=_{0}\). Suppose \((s)>0\) for all \(s\) and choose for any \(,>0\),_

1. _the number of training steps_ \(N((1-)^{3}})^{2}\)_,_
2. _step size_ \(=}{8}\)__
3. _batch size_ \(K=\{e^{2}C}{2048}(-)\| ^{^{*}}}{}\|_{}^{-2},N^{3 }C}{c^{2}^{2}}\}\)_._

_Then, \((J^{*}-J(_{N}))\), where \(J^{*}=_{}J()\)._

We present more details on the algorithm and the proof in Section E of the supplementary material. We emphasize that the dependency on the distribution mismatch coefficient and the model dependent constant \(c\) are unavoidable since the stochastic gradient ascent is derived from the deterministic gradient ascent. To the best of our knowledge, this is the first convergence analysis for stochastic policy gradient with softmax parametrization without regularization. So far, Ding et al. (2022) derived complexity bounds for convergence of softmax policy gradient to the entropy-regularized optimum.

## 7 Conclusion and Future Work

In this paper, we have presented a convergence analysis of policy gradient methods for undiscounted MDPs with finite-time horizon in the tabular setting. Assuming exact gradients we have obtained an \((1/n)\)-convergence rate which is linearly dependent on the time horizon. In the model-free setting we have derived complexity bounds to approximate the error to global optima with high probability. Moreover, we were able to extend this result to discounted MDPs without regularization.

In the finite-time case, it would be intriguing to explore policy parametrizations with a smaller parameter space as for example log-linear policies. Additionally, investigating modern policy gradient algorithms such as TRPO and natural policy gradient within the context of finite-time MDPs could further enhance the convergence rate. In the stochastic setting, it is desirable to eliminate the model-dependent parameter from the complexity bounds to construct a practicable algorithm. This would require an improved convergence analysis of policy gradient with exact gradients.