# GroundDiT: Grounding Diffusion Transformers

via Noisy Patch Transplantation

 Phillip Y. Lee1  Taehoon Yoon1  Minhyuk Sung

KAIST

{phillip0701,taehoon,mhsung}@kaist.ac.kr

###### Abstract

We introduce GroundDiT, a novel training-free spatial grounding technique for text-to-image generation using Diffusion Transformers (DiT). Spatial grounding with bounding boxes has gained attention for its simplicity and versatility, allowing for enhanced user control in image generation. However, prior training-free approaches often rely on updating the noisy image during the reverse diffusion process via backpropagation from custom loss functions, which frequently struggle to provide precise control over individual bounding boxes. In this work, we leverage the flexibility of the Transformer architecture, demonstrating that DiT can generate noisy patches corresponding to each bounding box, fully encoding the target object and allowing for fine-grained control over each region. Our approach builds on an intriguing property of DiT, which we refer to as _semantic sharing_. Due to semantic sharing, when a smaller patch is jointly denoised alongside a generalizable-size image, the two become _semantic clones_. Each patch is denoised in its own branch of the generation process and then transplanted into the corresponding region of the original noisy image at each timestep, resulting in robust spatial grounding for each bounding box. In our experiments on the HRS and DrawBench benchmarks, we achieve state-of-the-art performance compared to previous training-free approaches. Project Page: https://groundit-diffusion.github.io/.

Figure 1: Spatially grounded images generated by our GroundDiT. Each image is generated based on a text prompt along with bounding boxes, which are displayed in the upper right corner of each image. Compared to existing methods that often struggle to accurately place objects within their designated bounding boxes, our GroundDiT enables more precise spatial control through a novel noisy patch transplantation mechanism.

Introduction

The Transformer architecture  has driven breakthroughs across a wide range of applications, with diffusion models emerging as significant recent beneficiaries. Despite the success of diffusion models with U-Net  as the denoising backbone , recent Transformer-based diffusion models, namely Diffusion Transformers (DiT) , have marked another leap in performance. This is demonstrated by recent state-of-the-art generative models such as Stable Diffusion 3  and Sora . Open-source models like DiT  and its text-guided successor PixArt-\(\) have also achieved superior quality compared to prior U-Net-based diffusion models. Given the scalability of Transformers, Diffusion Transformers are expected to become the new standard for image generation, especially when trained on an Internet-scale dataset.

With high quality image generation achieved, the next critical step is to enhance user controllability. Among the various types of user guidance in image generation, one of the most fundamental and significant is _spatial grounding_. For instance, a user may provide not only a text prompt describing the image but also a set of bounding boxes indicating the desired positions of each object, as shown in Fig. 1. Such spatial constraints can be integrated into text-to-image (T2I) diffusion models by adding extra modules that are designed for spatial grounding and fine-tuning the model. GLIGEN  is a notable example, which incorporates a gated self-attention module  into the U-Net layers of Stable Diffusion . Although effective, such fine-tuning-based approaches incur substantial training costs each time a new T2I model is introduced.

Recent training-free approaches for spatially grounded image generation  have led to new advances, removing the high costs for fine-tuning. These methods leverage the fact that cross-attention maps in T2I diffusion models convey rich structural information about where each concept from the text prompt is being generated in the image . Building on this, these approaches aim to align the cross-attention maps of specific objects with the given spatial constraints (_e.g_. bounding boxes), ensuring that the objects are placed within their designated regions. This alignment is typically achieved by updating the noisy image in the reverse diffusion process using backpropagation from custom loss functions. However, such loss-guided update methods often struggle to provide precise spatial control over individual bounding boxes, leading to missing objects (Fig. 4, Row 9, Col. 5) or discrepancies between objects and their bounding boxes (Fig. 4, Row 4, Col. 4). This highlights the need for finer control over each bounding box during image generation.

We aim to provide more precise spatial control over each bounding box, addressing the limitations in previous loss-guided update approaches. A well-known technique for manipulating local regions of the noisy image during the reverse diffusion process is to directly replace or merge the pixels (or latents) in those regions. This simple but effective approach has proven effective in various tasks, including compositional generation  and high-resolution generation . One could consider defining an additional branch for each bounding box, denoising with the corresponding text prompt, and then copying the noisy image into its designated area in the main image at each timestep. However, a key challenge lies in creating a noisy image patch-at the same noise level-that _reliably_ contains the desired object while fitting within the specified bounding box. This has been impractical with existing T2I diffusion models, as they are trained on a limited set of image resolutions. While recent models such as PixArt-\(\) support a wider range of image resolutions, they remain constrained by specific candidate sizes, particularly for smaller image patches. As a result, when these models are used to create a local image patch, they are often limited to denoising a fixed-size image and cropping the region to fit the bounding box. This approach can critically fail to include the desired object within the cropped region.

In this work, we show that by exploiting the flexibility of the Transformer architecture, DiT can generate noisy image patches that fit the size of each bounding box, thereby reliably including each desired object. This is made possible through our proposed joint denoising technique. First, we introduce an intriguing property of DiT: when a smaller noisy patch is jointly denoised with a generalable-size noisy image, the two gradually become semantic clones--a phenomenon we call _semantic sharing_. Next, building on this observation, we propose a training-free framework that involves _cultivating_ a noisy patch for each bounding box in a separate branch and then _transplanting_ that patch into its corresponding region in the original noisy image. By iteratively transplanting the separately denoised patches into their respective bounding boxes, we achieved fine-grained spatial control over each bounding box region. This approach leads to more robust spatial grounding, particularly in cases where previous methods fail to accurately adhere to spatial constraints.

In our experiments on the HRS  and DrawBench  datasets, we evaluate our framework, GroundDiT, using PixArt-\(\) as the base text-to-image DiT model. Our approach demonstrates superior performance in spatial grounding compared to previous training-free methods [38; 9; 47; 48], especially outperforming the state-of-the-art approach , highlighting its effectiveness in providing fine-grained spatial control.

## 2 Related Work

In this section, we review the two primary approaches for incorporating spatial controls into text-to-image (T2I) diffusion models: fine-tuning-based methods (Sec. 2.1) and training-free guidance techniques (Sec. 2.2).

### Spatial Grounding via Fine-Tuning

Fine-tuning with additional modules is a powerful approach for enhancing T2I models with spatial grounding capabilities [51; 31; 2; 53; 46; 16; 10; 54]. SpaText  introduces a spatio-textual representation that combines segmentations and CLIP embeddings . ControlNet  incorporates a trainable U-Net encoder that processes spatial conditions such as depth maps, sketches, and human keypoints, guiding image generation within the main U-Net branch. GLIGEN  enables T2I models to accept bounding boxes by inserting a gated attention module into Stable Diffusion . GLIGEN's strong spatial accuracy has led to its integration into follow-up spatial grounding methods [48; 38; 30] and applications such as compositional generation  and video editing . InstanceDiffusion  further incorporates conditioning modules to provide finer spatial control through diverse conditions like boxes, scribbles, and points. While these fine-tuning methods are effective, they require task-specific datasets and involve substantial costs, as they must be retrained for each new T2I model, underscoring the need for training-free alternatives.

### Spatial Grounding via Training-Free Guidance

In response to the inefficiencies of fine-tuning, training-free approaches have been introduced to incorporate spatial grounding into T2I diffusion models. One approach involves a region-wise composition of noisy patches, each conditioned on a different text input [5; 50; 32]. These patches, extracted using binary masks, are intended to generate the object they are conditioned on within the generated image. However, since existing T2I diffusion models are limited to a fixed set of image resolutions, each patch cannot be treated as a complete image, making it uncertain whether the extracted patch will contain the desired object. Another approach leverages the distinct roles of attention modules in T2I models--self-attention captures long-range interactions between image features, while cross-attention links image features with text embeddings. By using spatial constraints such as bounding boxes or segmentation masks, spatial grounding can be achieved either by updating the noisy image using backpropagation based on a loss calculated from cross-attention maps [48; 38; 9; 7; 18; 36], or by directly manipulating cross- or self-attention maps to follow the given spatial layouts [26; 4; 14]. While the loss-guided methods enable spatial grounding in a training-free manner, they still lack precise control over individual bounding boxes, often leading to missing objects or misalignment between objects and their bounding boxes. In this work, we propose a novel training-free framework that offers fine-grained spatial control over each bounding box by harnessing the flexibility of the Transformer architecture in DiT.

## 3 Background: Diffusion Transformers

Diffusion Transformer (DiT)  represents a new class of diffusion models that utilize the Transformer architecture  for their denoising network. Previous diffusion models like Stable Diffusion  use the U-Net  architecture, of which each layer contains a convolutional block and attention modules. In contrast, DiT consists of a sequence of DiT blocks, each containing a pointwise feedforward network and attention modules, removing convolution operations and instead processing image tokens directly through attention mechanisms.

DiT follows the formulation of diffusion models , in which the forward process applies noise to a real clean data \(_{0}\) by

\[_{t}=}_{0}+} (0,I),\ _{t}.\] (1)

The reverse process denoises the noisy data \(_{t}\) through a Gaussian transition

\[p_{}(_{t-1}|_{t})=(_{t};_{ }(_{t},t),_{}(_{t},t))\] (2)

where \(_{}(_{t},t)\) is calculated by a learned neural network trained by minimizing the negative ELBO objective . While \(_{}(_{t},t)\) can also be learned, it is usually set as time dependent constants.

Positional Embeddings.As DiT is based on the Transformer architecture, it treats the noisy image \(_{t}^{h w d}\) as a set of image tokens. Specifically, \(_{t}\) is divided into patches, each transformed into an image token via linear embedding. This results in \((h/l)(w/l)\) tokens, where \(l\) is the patch size. Importantly, before each denoising step, 2D sine-cosine positional embeddings are assigned to each image token to provide spatial information as follows:

\[_{t-1}((_{t}),t,c).\] (3)

Here, \(()\) applies positional embeddings, \(()\) represents a single denoising step in DiT at timestep \(t\), and \(c\) is the text embedding. This contrasts with U-Net-based diffusion models, which typically do not utilize positional embeddings for the noisy image. Detailed formulations of the positional embeddings are provided in the **Appendix (Sec. A)**.

## 4 Problem Definition

Let \(P\) be the input text prompt (_i.e_., a list of words), which we refer to as the _global prompt_. Let \(c_{P}\) be the text embedding of \(P\). We define a set of \(N\) grounding conditions \(G=\{g_{i}\}_{i=0}^{N-1}\), where each condition specifies the coordinates of a bounding box and the desired object to be placed within it. Specifically, each condition \(g_{i}:=(b_{i},p_{i},c_{i})\) consists of the following: \(b_{i}^{4}\), the \(xy\)-coordinates of the bounding box's upper-left and lower-right corners, \(p_{i} P\), the word in the global prompt describing the desired object within the box, and \(c_{i}\), the text embedding of \(p_{i}\). The objective is to generate an image that aligns with the global prompt \(P\) while ensuring each specified object is accurately positioned within its corresponding bounding box \(b_{i}\).

## 5 GroundiT: Grounding Diffusion Transformers

We propose \(\), a training-free framework based on DiT for generating images spatially grounded on bounding boxes. Each denoising step in \(\) consists of two stages: Global Update and Local Update. Global Update ensures coarse alignment between the noisy image and the bounding boxes through a gradient descent update using cross-attention maps (Sec. 5.1). Following this, Local Update further provides fine-grained control over individual bounding boxes via a novel noisy patch transplantation technique (Sec. 5.3). This approach leverages our key observation of DiT's semantic sharing property, introduced in Sec. 5.2. An overview of this two-stage denoising step is provided in Fig. 2.

Figure 2: A single denoising step in \(\) consists of two stages. The Global Update (Sec. 5.1) established coarse spatial grounding by updating the noisy image with a custom loss function. Then, the Local Update (Sec. 5.3) further provides fine-grained spatial control over individual bounding boxes through a novel technique called noisy patch transplantation.

### Global Update with Cross-Attention Maps

First, the noisy image \(_{t}\) is updated to spatially align with the bounding box inputs. For this, we leverage the rich structural information encoded in cross-attention maps, as first demonstrated by Chefer _et al._. Each cross-attention map shows how a region of the noisy image correspond to a specific word in the global prompt \(P\). Let DiT consist of \(M\) sequential DiT blocks. As \(_{t}\) passes through the \(m\)-th block, the cross-attention map \(a_{i,t}^{m}^{h w 1}\) for object \(p_{i}\) is extracted. For each grounding condition \(g_{i}\), the _mean_ cross-attention map \(A_{i,t}\) is obtained by averaging \(a_{i,t}^{m}\) over all \(M\) blocks as follows:

\[A_{i,t}=_{m=0}^{M-1}a_{i,t}^{m}.\] (4)

For convenience, we denote the operation of extracting \(A_{i,t}\) for every \(g_{i} G\) as below:

\[\{A_{i,t}\}_{i=0}^{N-1}(_{t},t,c_ {P},G).\] (5)

Then, following prior works on U-Net-based diffusion models [48; 47; 38; 9; 36; 7], we measure the spatial alignment for each object \(p_{i}\) by comparing its mean cross-attention map \(A_{i,t}\) with its corresponding bounding box \(b_{i}\), using a predefined grounding loss \((A_{i,t},b_{i})\) as defined in R&B . The aggregated grounding loss \(_{}\) is then computed by summing the grounding loss across all grounding conditions \(g_{i} G\):

\[_{}(\{A_{i,t}\}_{i=0}^{N-1},G)=_{i=0}^{N-1}(A_{i,t},b_{i}).\] (6)

Based on the backpropagation from \(_{}\), \(_{t}\) is updated via gradient descent as follows:

\[}_{t}_{t}-_{t}_{_{t} }_{}\] (7)

where \(_{t}\) is a scalar weight value for gradient descent. We refer to Eq. 7 as the _Global Update_, as the whole noisy image \(_{t}\) is updated based on an aggregated loss from all grounding conditions in \(G\).

The Global Update achieves reasonable accuracy in spatial grounding. However, it often struggles with more complex grounding conditions. For instance, when \(G\) contains multiple bounding boxes (_e.g._, six boxes in Fig. 4, Row 9) or small, thin boxes (_e.g._, Fig. 4, Row 5), the desired objects may be missing or misaligned with the boxes. These examples show that the Global Update lacks fine-grained, box-specific control, underscoring the need for precise controls for individual bounding boxes. In the following sections, we introduce a novel method to achieve this fine-grained spatial control.

### Semantic Sharing in Diffusion Transformers

In this section, we present our observations on an intriguing property of DiT, _semantic sharing_, which will serve as a key building block for our main method in Sec. 5.3.

Joint Denoising.We observed that DiT can _jointly_ denoise two different noisy images together. For example, consider two noisy images, \(_{t}\) and \(_{t}\), both at timestep \(t\) in the reverse diffusion process. Position embeddings are applied to the image tokens according to their sizes, resulting in \(}_{t}=(_{t})\) and \(}_{t}=(_{t})\). Notably, the two noisy images can differ in size, providing flexibility in joint denoising. The key part is that the two noisy images--more precisely, two sets of image tokens--are merged into a single set \(_{t}\). We denote this process as \(()\) (see Alg. 1, line 4). \(_{t}\) is passed through the DiT blocks, yielding the output \(_{t-1}\), which is then split into the denoised versions \(_{t-1}\) and \(_{t-1}\) via \(()\). Joint denoising is illustrated in Fig. 3-(A), and a pseudocode for a single step of joint denoising is shown in Alg. 1.

Semantic Sharing.Surprisingly, we found that joint denoising of two noisy images generates semantically correlated content in correponding pixels, even when the initial random noise differs. Consider two noisy images, \(_{T}^{h_{} w_{} d}\) and \(_{T}^{h_{} w_{} d}\), both initialized from a unit Gaussian distribution \((0,I)\). We experiment with a reverse diffusion process in which, for the initial \(100\)% of the denoising steps (\(\)), \(_{T}\) and \(_{T}\) undergo joint denoising. For the remainingtimesteps, they are denoised independently. The same text embedding \(c\) is used as a condition in both cases.

Fig. 3 shows the generated images from \(_{T}\) and \(_{T}\) across different \(\) values. In Fig. 3-(B), \(_{T}\) and \(_{T}\) have the same resolution (\(h_{}=h_{},w_{}=w_{}\)), while in Fig. 3-(C) their resolutions differ (\(h_{}>h_{},w_{}>w_{}\)). When \(=0\), the two noisy images are denoised completely independently, resulting in clearly distinct images (leftmost column). We found that DiT models have a certain range of resolutions within which they can generate plausible images--which we refer to as _generatable resolutions_--but face challenges when generating images far outside this range. This is demonstrated in the output of \(_{0}\) in Fig. 3-(C) with \(=0\). Further discussions and visual analyses are provided in the **Appendix (Sec. D)**. But as \(\) increases, allowing \(_{T}\) and \(_{T}\) to be jointly denoised in the initial steps, the generated images become progressively more similar. When \(=1\), the images generated from \(_{T}\) and \(_{T}\) appear almost identical. These results demonstrate that, in joint denoising, assigning identical or similar positional embeddings to different image tokens promotes strong interactions between them during the denoising process. This correlated behavior during joint denoising causes the two image tokens to converge toward semantically similar outputs--a phenomenon we term _semantic sharing_.

Notably, this pattern holds not only when both noisy images share the same resolution (Fig. 3-(B)), but even when one of the images does not have DiT's generatable resolution (Fig. 3-(C)). While self-attention sharing techniques have been explored in U-Net-based diffusion models to enhance style consistency between images [20; 34], they have been limited to images of equal resolution. By leveraging the flexibility to assign positional embeddings across different resolutions, our joint

``` Inputs:\(_{t}^{h_{} w_{} d}, _{t}^{h_{} w_{} d},t,c,l\);// Noisy images, timestep, text embedding, patch size. Outputs:\(_{t-1},_{t-1}\);// Noisy images at timestep \(t-1\). FunctionJointDenoise(\(_{t},_{t},t,c\)); \(n_{} h_{}w_{}/l^{2},\ n_{}  h_{}w_{}/l^{2}\); // Store the number of image tokens. \(}_{t}(_{t}),\ }_{t} (_{t})\); // Apply positional embeddings. \(_{t}(}_{t},}_{t})\); // Merge two sets of image tokens. \(_{t-1}(_{t},t,c)\); // Denoising step with DiT. \(\{_{t-1},_{t-1}\}(_{t-1}, \{n_{},n_{}\})\); // Split back into two sets. return\(_{t-1},_{t-1}\); ```

**Algorithm 1**Pseudocode of Joint Denoising (Sec. 5.2).

Figure 3: **(A) Joint Denoising.** Two different noisy images, \(_{t}\) and \(_{t}\), are each assigned positional embeddings based on their respective sizes. The two sets of image tokens are then merged and passed through DiT for a denoising step. Afterward, the denoised tokens are split back into \(_{t-1}\) and \(_{t-1}\). **(B), (C) Semantic Sharing.** Denoising two noisy images using joint denoising results in semantically correlated content between the generated images. Here, \(\) indicates that joint denoising is during the initial \(100\%\) of the timesteps, after which the images are denoised for the remaining steps.

denoising approach extends across heterogeneous resolutions, offering greater versatility. We provide further discussions and analyses on semantic sharing in the **Appendix (Sec. D)**.

### Local Update with Noisy Patch Transplantation

In this section, we introduce our key technique: Local Update via noisy patch cultivation and transplantation. Building on DiT's semantic sharing property from Sec. 5.2, we show how this can be leveraged to provide precise spatial control over each bounding box.

Main & Object Branches.We propose a parallel denoising approach with multiple branches: one for the main noisy image \(}_{t}\) and additional branches for each grounding condition \(g_{i}\). The main branch denoises the main noisy image using the global prompt \(P\), while each object branch is designed to denoise local regions within the bounding boxes, enabling fine-grained spatial control over each region. For each \(i\)-th object branch, there is a distinct _noisy object image_\(_{i,t}\), initialized as \(_{i,T}(0,I)\). We predefine the resolution of the noisy object image \(_{i,t}\) by searching in PixArt-\(\)'s generatble resolutions that closely match the aspect ratio of the corresponding bounding box \(b_{i}\). With \(}_{t}\) obtained from Global Update (Sec. 5.1), each branch performs denoising in parallel. Below we explain the denoising mechanism for each branch.

Noisy Patch Cultivation.In the main branch at timestep \(t\), the noisy image \(}_{t}\) is denoised using the global prompt \(P\) as follows: \(}_{t-1}((}_{t}),t,c_{P})\), where \(}_{t}\) is the output from the Global Update and \(c_{P}\) is the text embedding of \(P\). For the \(i\)-th object branch, there are two inputs: the noisy object image \(_{i,t}\) and a subset \(_{i,t}\) of image tokens extracted from \(}_{t}\), corresponding to the bounding box \(b_{i}\). We denote this extraction as \(_{i,t}(}_{t},b_{i})\), where \(_{i,t}^{h_{i} w_{i} d}\) is referred to as a _noisy local patch_. Here, \(h_{i}\) and \(w_{i}\) corresponds to height and width of bounding box \(b_{i}\), respectively. Joint denoising is then performed on \(_{i,t}\) and \(_{i,t}\) to yield their denoised versions:

\[\{_{i,t-1},_{i,t-1}\}(_{i,t},_{i,t},t,c_{i}),\] (8)

where \(c_{i}\) is the text embedding of the object \(p_{i}\).

Through semantic sharing with the noisy object image \(_{i,t}\) during joint denoising, the denoised local patch \(_{i,t-1}\) is expected to gain richer semantic features of object \(p_{i}\) than it would without joint denoising. Note that even when the noisy local patch \(_{i,t}\) does not meet the typical generatable resolution of DiT (since it often requires cropping small bounding box regions of \(}_{t}\) to obtain \(_{i,t}\)), it offers a simple and effective way for enriching \(_{i,t}\) of the semantic features of object \(p_{i}\). We refer to this process as _noisy patch cultivation_.

Noisy Patch Transplantation.After cultivating local patches through joint denoising in Eq. 8, each patch is transplanted into \(}_{t-1}\), obtained from the main branch. The patches are transplanted in their original bounding box regions specified by \(b_{i}\) as follows:

\[}_{t-1}}_{t-1}(1- _{i})+(_{i,t-1},b_{i})_{i}\] (9)

Here, \(\) denotes the Hadamard product, \(_{i}\) is a binary mask for the bounding box \(b_{i}\), and \((_{i,t-1},b_{i})\) applies zero-padding to \(_{i,t-1}\) to align its position with that of \(b_{i}\). This transplantation enables fine-grained local control for the grounding condition \(g_{i}\). After transplanting the outputs from all \(N\) object branches, we obtain \(_{t-1}\), representing the final output of \(\) denoising step at timestep \(t\). In \(_{t-1}\), the image tokens within the \(b_{i}\) region are expected to possess richer semantic information about object \(p_{i}\) compared to the initial \(}_{t-1}\) from the main branch. This process is referred to as _noisy patch transplantation_. We provide implementation details and full pseudocode of a single \(\) denoising step in the **Appendix (Sec. E)**.

## 6 Results

In this section, we present the experiment results of our method, \(\), and provide comparisons with baselines. For the base text-to-image DiT model, we use PixArt-\(\), which builds on the original DiT architecture  by incorporating an additional cross-attention module to condition on text prompts.

Figure 4: Qualitative comparisons between our GroundDtT and baselines. Leftmost column shows the input bounding boxes, and columns 2-6 include the baseline results. The rightmost column includes the results of our GroundDtT.

### Evaluation Settings

Baselines.We compare our method with state-of-the-art training-free approaches for bounding box-based image generation, including R&B , BoxDiff , Attention-Refocusing , and Layout-Guidance . For a fair comparison, we also implement R&B using PixArt-\(\), which we refer to as _PixArt-R&B_, and treat it as an internal baseline. Note that this is identical to our method without the Local Guidance (Sec. 5.3).

Evaluation Metrics and Benchmarks.

* **(Grounding Accuracy)** We follow the evaluation protocol of R&B  to assess spatial grounding on the HRS  and DrawBench  datasets, using three criteria: spatial, size, and color. The HRS dataset consists of 1002, 501, and 501 images for each respective criterion, with bounding boxes generated using GPT-4 by Phung _et al._. For DrawBench, we use the same 20 positional prompts as in R&B .
* **(Prompt Fidelity)** We use the CLIP score  to evaluate how well the generated images adhere to the text prompt. Additionally, we assess our method using PickScore  and ImageReward , which provide human alignment scores based on the consistency between the text prompt and generated images.

### Grounding Accuracy

Quantitative Comparisons.Tab. 1 presents a quantitative comparison of grounding accuracy between our method, \(\), and baselines. \(\) outperforms all baselines across different criteria of grounding accuracy--spatial, size, and color--including the state-of-the-art R&B  and our internal baseline PixArt-R&B. Notably, the spatial accuracy on the HRS benchmark  (Col. 1) of \(\) is significantly higher, with a +14.87% improvement over R&B and +7.88% over PixArt-\(\). The comparison between PixArt-\(\), PixArt-R&B and \(\) highlights the effectiveness of the two-stage pipeline of \(\). First, integrating the loss-based Global Update into PixArt-\(\) results in a substantial improvement in spatial accuracy (from 17.86% to 37.13%). Then, incorporating our key contribution, the Local Update, further boosts accuracy (from 37.13% to 45.01%). For size accuracy (Col. 2), which evaluates how well the size of each generated object matches its corresponding bounding box, \(\) shows a +1.01% improvement over R&B. In terms of color accuracy (Col. 3), our method achieves a +6.60% improvement over PixArt-R&B and outperforms R&B by +3.63%. This underscores the effectiveness of our noisy patch transplantation technique in accurately assigning color descriptions to the corresponding objects. As DrawBench  only contains images with two bounding boxes, which are relatively easy to generate, employing the Global Update is sufficient for grounding. We present additional quantitative comparisons of grounding accuracy in the **Appendix (Sec. B)**.

Qualitative Comparisons.Fig. 4 presents the qualitative comparisons. When the grounding condition involves one or two simple bounding boxes (Rows 1, 2), both our method and the baselines

    &  & DrawBench \\  & Spatial (\%) & Size (\%) & Color (\%) & Spatial (\%) \\    \\  Stable Diffusion  & 8.48 & 9.18 & 12.61 & 12.50 \\ PixArt-\(\) & 17.86 & 11.82 & 19.10 & 20.00 \\ Layout-Guidance  & 16.47 & 12.38 & 14.39 & 36.50 \\ Attention-Refocusing  & 24.45 & 16.97 & 23.54 & 43.50 \\ BoxDiff  & 16.31 & 11.02 & 13.23 & 30.00 \\ R\&B  & 30.14 & 26.74 & 32.04 & 55.00 \\   \\  PixArt-R\&B & 37.13 & 20.76 & 29.07 & **60.00** \\  \(\) & **45.01** & **27.75** & **35.67** & **60.00** \\   

Table 1: Quantitative comparisons of grounding accuracy on HRS  and DrawBench  benchmarks. **Bold** represents the best, and underline represents the second best method.

successfully generate objects within the designated regions. However, as the number of bounding boxes increases and the grounding conditions become more challenging, the baselines struggle to correctly place each object inside the bounding box (Rows 4, 8), or even fail to generate the object at all (Rows 5, 7, 9). In contrast, GroundDiT successfully grounds each object within the boxes, even when the number of boxes is relatively high, such as four boxes (Rows 5, 6, 8), five boxes (Row 7) and six boxes (Row 9). This highlights that our proposed noisy patch transplantation technique provides superior control over each bounding box, addressing the limitations of previous loss-based update methods, as discussed in Sec. 5.1. For more qualitative comparisons, including images generated with various aspect ratios, please refer to the **Appendix (Sec. G and Fig. 5)**.

### Prompt Fidelity

Tab. 2 presents a quantitative comparison of prompt fidelity between our method and PixArt-R&B. Each metric is measured using the generated images from the HRS dataset . GroundDiT achieves higher CLIP score  than PixArt-R&B (Col. 1), indicating that our noisy patch transplantation improves the text prompt fidelity of the generated images. Additionally, our method achieves a higer ImageReward  score, which measures human preference by considering both prompt fidelity and overall image quality. While GroundDiT shows a slight underperformance compared to PixArt-R&B in Pickscore , it remains comparable overall. We provide further comparisons of prompt fidelity with other baselines in the **Appendix (Sec. C).**

## 7 Conclusion

In this work, we introduced GroundDiT, a training-free spatial grounding technique for text-to-image generation, leveraging Diffusion Transformers (DiT). To address the limitation of prior approaches, which lacked fine-grained spatial control over individual bounding boxes, we proposed a novel approach that transplants a noisy patch generated in a separate denoising branch into the designated area of the noisy image. By exploiting an intriguing property of DiT, semantic sharing, which arises from the flexibility of the Transformer architecture and the use of positional embeddings, GroundDiT generates a smaller patch by simultaneously denoising two noisy image: one with a smaller size and the other with a generaltable resolution by DiT. Through semantic sharing, these two noisy images become semantic clones, enabling fine-grained spatial control for each bounding box. Our experiments on the HRS and DrawBench benchmarks demonstrated that GroundDiT achieves state-of-the-art performance compared to previous training-free grounding methods.

Limitations and Societal Impacts.A limitation of our method is the increased computation time, as it requires a separate object branch for each bounding box. We provide further analysis on the computation time in the **Appendix (Sec. F)**. Additionally, like other generative AI techniques, our method is susceptible to misuse, such as creating deepfakes, which can raise significant concerns related to privacy, bias, and fairness. It is crucial to develop safeguards to control and mitigate these risks responsibly.

   Method & CLIP score \(\) & ImageReward \(\) & PickScore \(\) \\  PixArt-R\&B & 33.49 & 0.28 & **0.52** \\
**GroundDiT (Ours)** & **33.63** & **0.44** & 0.48 \\   

Table 2: Quantitative comparisons on prompt fidelity on HRS benchmark . **Bold** represents the best method.