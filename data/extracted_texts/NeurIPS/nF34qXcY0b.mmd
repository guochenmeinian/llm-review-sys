# Identification of Analytic Nonlinear Dynamical Systems with Non-asymptotic Guarantees

Negin Musavi

nmusavi2@illinois.edu

&Ziyao Guo

ziyaog2@illinois.edu

&Geir Dullerud

dullerud@illinois.edu

&Yingying Li

yl101@illinois.edu

 Coordinated Science Laboratory

University of Illinois Urbana-Champaign

###### Abstract

This paper focuses on the system identification of an important class of nonlinear systems: nonlinear systems that are linearly parameterized, which enjoy wide applications in robotics and other mechanical systems. We consider two system identification methods: least-squares estimation (LSE), which is a point estimation method; and set-membership estimation (SME), which estimates an uncertainty set that contains the true parameters. We provide non-asymptotic convergence rates for LSE and SME under i.i.d. control inputs and control policies with i.i.d. random perturbations, both of which are considered as non-active-exploration inputs. Compared with the counter-example based on piecewise-affine systems in the literature, the success of non-active exploration in our setting relies on a key assumption about the system dynamics: we require the system functions to be real-analytic. Our results, together with the piecewise-affine counter-example, reveal the importance of differentiability in nonlinear system identification through non-active exploration. Lastly, we numerically compare our theoretical bounds with the empirical performance of LSE and SME on a pendulum example and a quadrotor example.

## 1 Introduction

Learning control-dynamical systems with statistical methodology has received significant attention in the past decade (Sarker et al., 2023; Li et al., 2023; Chen and Hazan, 2021; Simchowitz and Foster, 2020; Wagenmaker and Jamieson, 2020; Simchowitz et al., 2018; Dean et al., 2018; Abbasi-Yadkori and Szepesvari, 2011; Li et al., 2021). In particular, the estimation of linear dynamical systems, e.g. \(x_{t+1}=A^{*}x_{t}+B^{*}u_{t}+w_{t}\), is relatively well-studied: it has been shown that non-active exploration by i.i.d. noises on control inputs \(u_{t}\) and system disturbances \(w_{t}\) are already enough for accurate system identification, and least square estimation (LSE) can achieve the optimal estimation convergence rate (Simchowitz and Foster, 2020; Simchowitz et al., 2018).

However, nonlinear control systems are ubiquitous in real-world applications, e.g. robotics (Siciliano et al., 2010; Alaimo et al., 2013), power systems (Simpson-Porco et al., 2016), transportation (Kong et al., 2015), etc. Motivated by this, there has been a lot of attention on learning nonlinear systems recently. One natural and popular direction to study nonlinear system identification is on learning linearly parameterized nonlinear systems as defined below, which is a straightforward extension fromthe standard linear systems (Mania et al., 2022; Khosravi, 2023; Foster et al., 2020)

\[x_{t+1}=_{*}(x_{t},u_{t})+w_{t}\]

where \(_{*}\) is a vector of unknown parameters and \((x_{t},u_{t})\) is a known vector of nonlinear features.

On the one hand, some classes of these systems are shown to enjoy similar benefits of linear systems. For example, bilinear systems can also be estimated by LSE under non-active exploration with i.i.d. noises (Sattar et al., 2022), as well as linear systems with randomly perturbed nonlinear policies (Li et al., 2023).

On the other hand, it is also known that non-active exploration is insufficient for general linearly parameterized nonlinear systems. In particular, (Mania et al., 2022) provides a counter example showing that non-active exploration is insufficient to learn accurate models under piece-wise affine feature functions. This motivates a sequence of follow-up work on the design of active exploration for nonlinear system estimation, which is largely motivated by the non-smooth feature functions such as ReLu in neural networks (Mania et al., 2022; Kowshik et al., 2021; Khosravi, 2023).

However, there is a big gap between bilinear systems, which is infinitely differentiable, and the counter example by non-smooth systems. A natural question is: to what extent can non-active exploration still work for linearly parameterized nonlinear systems?

Contributions.One major contribution of this paper is showing that LSE with non-active i.i.d. noises can efficiently learn any linearly parameterized nonlinear systems with real-analytic feature functions and provide a non-asymptotic convergence rate. Notice that real-analytic feature functions are common in physical systems. For example, polynomial systems satisfy this requirement and have wide applications in power systems (Simpson-Porco et al., 2016), fluid dynamics (Noack et al., 2003), etc. Further, trigonometric functions also satisfy the real-analytic property so a large range of robotics and mechanical systems also satisfy this requirement (Siciliano et al., 2010; Alaimo et al., 2013).

A side product of our LSE convergence rate analysis is the convergence rate for another commonly used uncertainty quantification method in control: set membership estimation (SME).

Numerically, we test our theoretical results in pendulum and quadrotor systems. Simulations show that LSE and SME can indeed efficiently explore the system and converge to the true parameter under non-active exploration noises.

Technically, the key step in our proof is establishing the block-martingale-small-ball condition (BMSB) for general analytic feature functions, which greatly generalizes the bilinear feature function in Sattar et al. (2022). Our result is built on an intuition inspired by the counter example in (Mania et al., 2022): the counter example in (Mania et al., 2022) requires that some feature function is zero in a certain region, so nothing can be learned about its parameter if the states stay in this region. However, analytic functions cannot be a constant zero in a positive-measure region unless it is a constant zero everywhere. Therefore, the counter example does not work, and non-active exploration around any states can provide some useful information. Our proof formalizes this intuition by utilizing the Paley-Zygmund Petrov inequality (Petrov, 2007).

Related work.Inspired by neural network parameterization, nonlinear systems of the form \(x_{t+1}=(A_{*}x_{t})+w_{t}\) is also studied in the literature, where \(()\) is a known nonlinear link function and \(A_{*}\) is unknown. The least square cost is no longer quadratic or even convex in this case and various optimization methods have been proposed to learn this type of systems (Kowshik et al., 2021; Sattar et al., 2022; Foster et al., 2020).

Another related line of research focuses on nonlinear regression with dependent data (Ziemann and Tu, 2022; Ziemann et al., 2023, 2024),1 which can be applied to nonlinear system identification. The nonlinear regression in (Ziemann and Tu, 2022; Ziemann et al., 2023, 2024) is based on non-parametric LSE and its variants, and their convergence rates under different scenarios have been analyzed. It is interesting to note that this line of work usually assumes certain persistent excitation assumptions,2 whereas our paper demonstrates that persistent excitation holds by establishing the BMSB condition for linearly parameterized and real-analytic nonlinear control systems.

Uncertainty set estimation is crucial for robust control under model uncertainties Lu and Cannon (2023); Lorenzen et al. (2019); Li et al. (2021a). SME is a widely adopted uncertainty set estimation method in robust adaptive control (Lorenzen et al., 2019; Lu and Cannon, 2023; Bertsekas, 1971; Bai et al., 1995). Recently, there is an emerging interest in analyzing SME's convergence and convergence rate for dynamical systems (Li et al., 2024; Lu et al., 2019; Xu and Li, 2024), because previous analysis focus more on the linear regression problem (e.g. (Akcay, 2004; Bai et al., 1998)). There are also recent applications of SME to online control Yu et al. (2023), power systems Yeh et al. (2024), and computer vision Gao et al. (2024); Tang et al. (2024).

**Notation.** The set of non-negative real numbers is denoted by \(_{ 0}\). The notation \(\) stands for the ceiling function. For a real vector \(z^{n}\), \(\|z\|_{2}\) represents its \(_{2}\) norm, \(\|z\|_{}\) represents its \(_{}\) norm, and \(z^{i}\) represents its \(i\)-th component with \(i=1 n\). The set of real symmetric matrices is denoted by \(^{n}\). For a real matrix \(Z\), \(Z^{}\) represents its transpose, \(\|Z\|_{2}\) its maximum singular value, \(\|Z\|_{F}\) its Frobenius norm, \(_{}(Z)\) its minimum singular value, \((Z)\) its vectorization obtained by stacking its columns, and for a real square matrix \(Z\), \((Z)\) represents its trace. For a real symmetric matrix \(Z\), \(Z 0\) and \(Z 0\) indicate that \(Z\) is positive definite and positive semi-definite, respectively. For a measurable set \(^{n}\), \(^{n}()\) represents its Lebesgue measure in \(^{n}\) and \(^{c}\) represents its complement in \(^{n}\). The notation \(\) stands for the empty set. For a set \(\) of matrices \(^{n m}\), \(()\) denotes its diameter and it is defined as \(()=_{,^{}} \|-^{}\|_{F}\). For \(z_{i}\) with \(i=1,,\), the notation \((z_{1},,z_{})\) denotes a matrix in \(^{}\) with diagonal entries of \(z_{i}\). This paper uses \((0,_{w},[-w_{},w_{}])\) to refer to the truncated Gaussian distribution generated by Gaussian distribution with zero mean and \(_{w}^{2}\) variance with truncated range \([-w_{},w_{}]\). The same applies to multi-variate truncated Gaussian distributions.

## 2 Problem Formulation and Preliminaries

This paper studies the system identification/estimation of linearly parameterized nonlinear systems:

\[x_{t+1}=_{*}x_{t},u_{t}+w_{t},\] (1)

where \(x_{t}^{n_{x}}\), \(u_{t}^{n_{u}}\), and \(w_{t}^{n_{x}}\) denote the state, control input, and system disturbance respectively; \(_{*}^{n_{x} n_{}}\) denotes the unknown parameters to be estimated, and \(()\) denotes a vector of known nonlinear feature/basis functions, i.e., \(()=(^{1}(),,^{n_{}}())^{}\), where \(^{i}():^{n_{x}+n_{u}}\). Without loss of generality, we consider zero initial condition, i.e. \(x_{0}=0\), and linearly independent feature functions, that is, \(_{i=1}^{n_{}}c_{i}^{i}(x_{t},u_{t})=0\) implies that \(c_{i}=0\) for all \(i\).3

The linearly parameterized nonlinear system (1) is a natural generalization of linear control systems \(x_{t+1}=A_{*}x_{t}+B_{*}u_{t}+w_{t}\) and has wide applications in, for example, robotics (Siciliano et al., 2010; Alaimo et al., 2013), power systems (Simpson-Porco et al., 2016), transportation (Kong et al., 2015), etc. Therefore, there has been a lot of research on learning this type of system (1) utilizing the methodology and insights from linear system estimation. For example, it is common to estimate a linearly parameterized nonlinear system by least squares estimation (LSE), which enjoys desirable performance in linear systems.

In particular, LSE for (1) is reviewed below

\[_{T}=*{arg\,min}_{}_{t=0}^{T-1} x_{t+1}-(x_{t},u_{t})_{2}^{2}.\] (2)

For linear systems, LSE enjoys the following good property: LSE can achieve the optimal rate of convergence with i.i.d. noises \(w_{t}\) and i.i.d. control inputs \(u_{t}\) under proper conditions ((Simchowitz et al., 2018)). This good property has been generalized to some linearly parameterized nonlinear systems, such as bilinear systems, and linear systems with nonlinear control policies. Unfortunately, general linearly parameterized nonlinear systems do not enjoy this good property of linear systems, meaning i.i.d. random inputs may not provide enough exploration for non-smooth feature functions \(()\). Therefore, a series of follow-up work focuses on the design of active exploration methods.

However, due to the simplicity of implementation, i.i.d. random inputs remain a popular method in empirical research of system identification and sometimes enjoy satisfactory performance, despite the lack of theoretical guarantees. Therefore, this paper aims to establish more general conditions that allow provable convergence of nonlinear system estimation under i.i.d. random inputs.

In the rest of this paper, we will show that with certain smoothness and continuous conditions, i.i.d. random inputs are sufficient for estimation of (1), which recovers the good property of linear systems.

### Assumptions

In the following, we formally describe the smoothness and continuity conditions that enables efficient exploration of (1) by i.i.d. random inputs.

**Assumption 1** (Analytic feature functions).: _All components of the feature vector \(()\) are real analytic functions in \(^{n_{x}+n_{u}}\),4 i.e., for every \(1 i n_{}\), \(^{i}(x,u)\) is an infinitely differentiable function such that the Taylor expansion in every \((,)\) converges point-wise to \(^{i}(x,u)\) in a neighborhood of \((,)\)._

Analytic functions include polynomial functions and trigonometric functions, which are important components of many physical systems in real-world applications, e.g. power systems, robotics, transportation systems, etc. In particular, we provide two illustrative examples below.

**Example 1** (Pendulum).: _Many multilink robotic manipulators can be understood as interconnected pendulum dynamics. The motion equations of a single pendulum, consisting of a mass \(m\) suspended from a weightless rod of length \(l\) fixed at a pivot without friction, can be expressed as:_

\[=-()+}+w,\]

_where \(\) represents the angle of the rod relative to the vertical axis, \(g\) is the gravity constant, \(u\) is the torque input, and \(w\) is the disturbance applied to this system. After discretization the system dynamics can be rewritten in the structure of (1) with the feature vector consisting of expressions involving \(()\) and \(u\), all of which are analytic functions. The matrix of unknown parameters contains terms of the pendulum's mass and the rod's length._

**Example 2** (Quadrotor (Alaimo et al., 2013)).: _Let \(p^{3}\) and \(v^{3}\) represent the center of mass position and velocity of the quadrotor in the inertial frame, respectively; let \(^{3}\) denote its angular velocity in the body-fixed frame and \(q^{4}\) denote the quaternion vector. The quadrotor's equations of motion can then be expressed as:_

\[p\\ v\\ q\\ =v\\ -ge_{z}+Qfu\\  q\\ I^{-1}(_{u}- I)+w,\]

_where \(g\) is the gravity constant, \(m\) is its total mass, \(I=(I_{xx},I_{yy},I_{zz})\) its inertia matrix with respect to the body-fixed frame, \(f_{u}\) the total thrust, \(_{u}^{3}\) the total moment in the body-fixed frame, \(e_{z}=(0,0,1)^{}\), \(Q=q_{0}^{2}+q_{1}^{2}-q_{2}^{2}-q_{3}^{2}&2(q_{1}q_{2}-q_{0}q_{ 3})&2(q_{0}q_{2}-q_{1}q_{3})\\ 2(q_{1}q_{2}-q_{0}q_{3})&q_{0}^{2}-q_{1}^{2}+q_{2}^{2}-q_{3}^{2}&2(q_{2}q_{3}- q_{0}q_{1})\\ 2(q_{1}q_{3}-q_{0}q_{2})&2(q_{0}q_{1}-q_{2}q_{3})&q_{0}^{2}-q_{1}^{2}-q_{2}^{2}+q_{ 3}^{2},\) and_

\[=0&-_{1}&-_{2}&-_{3}\\ _{1}&0&_{3}&-_{2}\\ _{2}&-_{3}&0&_{1}\\ _{3}&_{2}&-_{1}&0.\]

_Similar to the pendulum example, after discretization the system dynamics can be rewritten in the structure of (1) with the feature vector consisting of cubic polynomials in states and inputs, which are real-analytic. The unknown parameters contain terms of the mass and inertial moments of the quadrotor._

Next, we introduce the assumption on the random inputs, which relies on the following definition.

**Definition 1** (Semi-continuous distribution).: _We define a probability distribution \(\) as semi-continuous if there does not exist a set \(E\) with Lebesgue measure zero such that \((E)=1\)._The semi-continuous distribution is a weaker requirement than continuous distributions. In particular, any continuous distributions, or a mixture distribution with one component as a continuous distribution, can satisfy the requirement of semi-continuity. The semi-continuity can also be interpreted by the Lebesgue Decomposition Theorem (Chapter 6 of (Halmos, 2013)) as discussed below.

**Remark 1** (Connection with Lebesgue Decomposition Theorem).: _Definition 1 can be interpreted by the Lebesgue Decomposition Theorem, which suggests that any probability distribution can be decomposed into a purely atomic component and a non-atomic component (see more details in Halmos (2013)). A semi-continuous distribution as defined in Definition 1 requires the distribution's non-atomic component to be nonzero._

In the following, we provide the assumptions on \(w_{t}\) and \(u_{t}\) using the semi-continuity definition.

**Assumption 2** (Bounded i.i.d. and semi-continuous disturbance).: \(w_{t}\) _is i.i.d. following a semi-continuous distribution with zero mean and a positive definite covariance matrix \(_{w}_{w}^{2}I_{n_{x}} 0\) and a bounded support, i.e. \(\|w_{t}\|_{} w_{}\) almost surely for all \(t\)._

The i.i.d. assumption is common in the literature of system identification for linear and nonlinear systems. As for the bounded assumption on \(w_{t}\), although it is stronger than the sub-Gaussian assumption on \(w_{t}\) in the literature of linear system estimation, it is a common assumption in the literature of nonlinear system estimation (Mania et al., 2022; Shi et al., 2021; Kim and Lavaei, 2024). Further, in many physical applications, noises are usually bounded, e.g. the wind disturbances in quadrotor systems are bounded, the renewable energy injections in power systems are also bounded, etc.

The semi-continuity assumption may seem restrictive since it rules out the discrete distributions. However, the disturbances in many realistic systems can satisfy the semi-continuity because realistic noises are usually generated from a mixture distribution where at least one component is continuous, e.g. the wind disturbances and renewable generations are continuous.

For the control inputs \(u_{t}\), we first impose the same assumption as Assumption 2 for simplicity. Later in Section 3, we will also discuss the relaxation of this assumption to include control policies.

**Assumption 3** (Bounded i.i.d. and semi-continuous inputs).: \(u_{t}\) _is i.i.d. following a semi-continuous distribution with zero mean and positive definite covariance \(_{u}_{u}^{2}I_{n_{x}} 0\) and bounded support, i.e. \(\|u_{t}\|_{} u_{}\) almost surely for all \(t\)._

Lastly, we introduce our stability assumption based on the input-to-state stability definition below.

**Definition 2** (Locally input-to-state stability (LISS)).: _Consider the general nonlinear system \(x_{t+1}=f(x_{t},d_{t})\) with \(x_{t}^{n_{x}}\), \(d_{t}^{n_{d}}\), \(f\) being a continuous function such that \(f(0,0)=0\). This system is called locally input-to-state stable (LISS) if there exist constants \(_{x}>0\), \(>0\) and functions \(\), \(\) such that for all \(x_{0}\{x_{0}^{n_{x}}:\|x_{0}\|_{2}_{x}\}\) and any input \(d_{t}\{d^{n_{d}}:_{t}\|d_{t}\|_{}\}\), it holds that \(\|x_{t}\|_{2}\|x_{0}\|_{2},t+_{t}\|d_ {t}\|_{}\) for all \(t 0\).5_

**Assumption 4** (LISS system).: _System (1) is LISS with parameters \(_{x}\) and \(\) such that \(_{x}\|x_{0}\|_{2}\) and \((w_{},u_{})\), respectively._

Assumption 4 is imposed, together with the bounded disturbances and inputs in Assumptions 2 and 3, to guarantee bounded states during the control dynamics (for instance, see the proof of Theorem 1in Appendix A). In particular, many studies on learning-based nonlinear control require a certain boundedness on the states for theoretical analysis Sattar and Oymak (2022); Foster et al. (2020); Li et al. (2023a).

In addition, it is interesting to note that this paper only requires local stability of the dynamics, whereas several learning-based nonlinear control papers assume certain global properties, such as global exponential stability in (Foster et al., 2020), global exponential incremental stability in (Sattar and Oymak, 2022; Li et al., 2023a; Lin et al., 2024), or global Lipschitz smoothness in (Lee et al., 2024).6 This difference in the dynamics assumption reflects a _trade-off_ with the disturbance assumptions:we assume a stronger assumption on the boundedness of disturbances and a weaker assumption on local stability, whereas much of the literature considers (sub)Gaussian distributions (which can be unbounded) but requires stronger global properties for dynamics. Since this paper is largely motivated by physical systems, which typically encounter bounded disturbances/inputs and generally only satisfy local stability (Slotine and Li, 1991), we address this trade-off through our current set of assumptions, leaving it as an exciting future direction to consider relaxing these assumptions.

## 3 Main Results

In this section, we provide the estimation error bounds of LSE for linearly parameterized nonlinear systems under i.i.d. random inputs. The estimation error bounds rely on the establishment of probabilistic persistent excitation, which will be introduced in the first subsection. Later, we also generalize the results to include control policies and discuss the convergence rate of another popular uncertainty quantification method in the control literature, set membership estimation, whose formal definition is deferred to the corresponding subsection.

### Probabilistic Persistent Excitation

It is well-known that persistent excitation (PE) is a crucial condition for successful system identification (Narendra and Annaswamy, 1987). In the following, we introduce the persistent excitation condition for our linearly parameterized nonlinear systems.

**Definition 3** (Persistent excitation (Skantze et al., 2000; Sastry and Bodson, 2011)).: _System (1) is persistently excited if there exist \(s>0\) and \(m 1\) such that for any \(t_{0} 0\), we have_

\[_{t=t_{0}}^{t_{0}+m-1}x_{t},u_{t}^{ }x_{t},u_{t} s^{2}I_{n_{}}.\]

In the stochastic setting, PE is closely related with a block-martingale small-ball (BMSB) condition proposed in Simchowitz et al. (2018), which can be viewed as a probabilistic version of PE.

**Definition 4** (BMSB (Simchowitz et al., 2018)).: _Let \(\{_{t}\}_{t 1}\) denote a filtration and let \(\{y_{t}\}_{t 1}\) be an \(\{_{t}\}_{t 1}\)-adapted random process taking values in \(^{n_{y}}\). We say \(\{y_{t}\}_{t 1}\) satisfies the \((k,_{sb},p)\)-block martingale small-ball (BMSB) condition for a positive integer \(k\), a \(_{sb} 0\), and a \(p\), if for any fixed \(v^{n_{y}}\) such that \(\|v\|_{2}=1\), the process \(\{y_{t}\}_{t 1}\) satisfies \(_{i=1}^{k}|v^{}y_{t+i}|v}_{t} p\) almost surely for any \(t 1\)._

One major contribution of this paper is formally establishing the BMSB condition for linearly parameterized nonlinear systems with real-analytic feature functions.

In the following, we first investigate the open-loop system with i.i.d. inputs and later extend the results to the closed-loop systems with inputs \(u_{t}=(x_{t})+_{t}\), where \(_{t}\) represents the noise and \(:^{n_{x}}^{n_{u}}\) denotes a control policy. The following theorem considers the open-loop systems.

**Theorem 1** (BMSB for open-loop systems).: _Let \(u_{t}=_{t}\) and consider the filtration \(_{t}=(w_{0},,w_{t-1},x_{0},,x_{t},_{0}, ,_{t})\). Suppose Assumptions 1, 2, 3, 4 hold, then there exist \(s_{}>0\) and \(p_{}(0,1)\) such that the \(\{_{t}\}_{t 1}\)-adapted process \(x_{t},u_{t}}_{t 1}\) satisfies the \(1,s_{}^{2}I_{n_{}},p_{}\)-BMSB condition._

Proof Sketch.: Intuitively, BMSB requires that any linear combination of feature functions remains positive with a non-vanishing probability. Notice that a linear combination of real-analytic functions is itself real-analytic, and the zeros of an analytic function have measure zero. These facts allow us to show that the probability of a linear combination of linearly independent feature functions equaling zero is less than one, as long as the noises follow semi-continuous distributions, by the connection of the Lebesgue measure and the probability measure in Definition 1.

In more detail, the proof leverages a variant of the Paley-Zygmund argument (Petrov, 2007), which provides a lower bound for the tail properties of positive random variables. Specifically, it states that the probability of a positive random variable being small depends on the ratio of its even moments.

We apply this result to the random variable \(|v^{T}x_{t+1},u_{t+1}_{t}|\) with \(\|v\|_{2}=1\) and aim to show that the lower bound is non-trivial for any direction \(v\) with \(\|v\|_{2}=1\) and any filtration \(_{t}\), \(t 0\). We then use results from measure theory to demonstrate the existence of such a non-trivial lower bound. This is done by showing that the Lebesgue measure of the set where \(|v^{T}x_{t+1},u_{t+1}|=0\) is zero, and thus the even moments of \(|v^{T}x_{t+1},u_{t+1}_{t}|\) are non-zero, provided that the noise and disturbance distributions are semi-continuous. For further details, please refer to Appendix A. 

It is worth pointing out that Theorem 1 only establishes the existence of the constants \((s_{},p_{})\), and deriving explicit formulas of these constants are left for future work. In particular, it can be challenging to derive a generic formula for all linearly parameterized nonlinear systems, but an exciting direction is to study reasonable sub-classes of systems and construct their corresponding formulas of the constants \((s_{},p_{})\).

### Non-asymptotic Bounds for LSE

We are now prepared to present the non-asymptotic convergence rate for the LSE in learning the unknown parameters of the system (1).

**Theorem 2** (LSE's convergence rate for open-loop systems).: _Consider the dynamical system described in (1) with i.i.d. inputs \(u_{t}=_{t}\) and assume that Assumptions 1, 2, 3, 4 are satisfied. Let \(s_{}\) and \(p_{}\) be as defined in Theorem 1, and define \(_{}=_{t 0}\|(z_{t})\|_{2}^{2}\). For a fixed \((0,1)\) and \(T 1\), if \(T\) satisfies the condition_

\[T}()+2n_{} (})+n_{}(_{}}{  s_{}^{2}}),\]

_then LSE's estimation \(_{T}\) satisfies the following error bound with probability at least \(1-3\)._

\[_{T}-_{*}_{2}}{p_{ }}+()+n_{}( })+n_{}(_{}}{ s_{ }^{2}})}{Ts_{}^{2}}}.\]

The proof relies on Theorem 1 and Theorem 2.4 in (Simchowitz et al., 2018). The complete proof is provided in Appendix B.1.

Theorem 2 demonstrates that LSE converges to the true parameters under random control inputs and random disturbances (non-active exploration) at a rate of \(}\) for linearly parameterized nonlinear systems. This is consistent with the convergence rates of LSE for linear systems in terms of \(T\).

Regarding the dependence of the convergence rate on dimension, the explicit dependence is \(+n_{}}\), where \(n_{x}\) and \(n_{}\) refer to the dimensions of the state and the characteristic vector, respectively. In addition, it is worth mentioning that other parameters, such as \(s_{},p_{},_{}\), may also implicitly depend on the dimensions. For some special systems, such as bilinear systems, it has been shown that these constants are independent of dimensions (Sattar et al., 2022). It is left as future work to explore other nonlinear systems' implicit dimension dependence.

Next, we can generalize the i.i.d. inputs \(u_{t}\) to include control policies, i.e., \(u_{t}=(x_{t})+_{t}\), where \(_{t}\) satisfies Assumption 3 and \((x_{t})\) is analytic.

**Corollary 1** (LSE's convergence rate for closed-loop systems).: _Consider inputs \(u_{t}=(x_{t})+_{t}\), where \(()\) is real-analytic, \(_{t}\) satisfies Assumption 3, and the closed-loop system \(x_{t+1}=_{*}(x_{t},(x_{t})+_{t})+w_{t}\) satisfies Assumption 4 for both \(w_{t}\) and \(_{t}\). Then, the same convergence rate as in Theorem 2 holds._

The proof is provided in Appendix B.2.

### Non-asymptotic Diameter Bounds for SME

Set membership estimation (SME) is another popular method for uncertainty quantification in control system estimation (Bertsekas, 1971; Fogel and Huang, 1982; Lu and Cannon, 2023; Li et al., 2024). Unlike LSE, SME is a set-estimator and directly estimates the uncertainty set. Since the analysis of SME also relies on the probabilistic persistent excitation analysis, we can also establish the convergence rate of SME for linearly parameterized nonlinear systems under i.i.d. noises in the following. In particular, SME estimates the uncertainty set as

\[_{T}=_{t=0}^{T-1}:x_{t+1}-(x_{t },u_{t})},\] (3)

where \(\) is a bounded set such that \(w_{t}\) for all \(t 0\).

The convergence of SME relies on an additional assumption as shown in the following: the tightness of the bound \(\) on the support of \(w_{t}\)'. This tightness assumption is commonly considered in SME's literature (Li et al., 2024; Lu et al., 2019; Akcay, 2004). In addition, (Li et al., 2024) discusses the relaxation of this assumption by learning a tight bound at the same time as learning the uncertainty set of \(_{*}\) for linear systems. Similar tricks can be applied to nonlinear systems, but this paper only considers the vanilla case of SME for simplicity.

**Assumption 5** (Tight bound on disturbances).: _Assume for any \(>0\), there exists \(q_{w}()>0\), such that for any \(1 j n\) and \(t 0\), we have \((w_{t}^{j}+w_{}) q_{w}()>0\), \((w_{}-w_{t}^{j}) q_{w}()>0\)._

Assumption 5 requires that \(w_{t}\) can visit the boundary of the set \(\)' arbitrarily closely with a positive probability. For example, for a one-dimensional \(w_{t}\) bounded by \(-w_{} w_{t} w_{}\), the assumption 5 requires that there is a positive probability that \(w_{t}\) is close to \(w_{}\) and \(-w_{}\), that is, for any \(>0\), we have \((w_{}- w_{t} w_{})>0\) and \((-w_{} w_{t}-w_{}+)>0\).

Next, we state a non-asymptotic bound on the diameter of the uncertainty set estimated by SME.

**Theorem 3** (SME's diameter bound for open-loop systems).: _Consider the system (1) with i.i.d. inputs \(u_{t}=_{t}\). Suppose Assumptions 1, 2, 3, 4 are satisfied. Consider \(s_{}\), and \(p_{}\) defined in Theorem 1 and let \(b_{}=_{t 0}\|(z_{t})\|_{2}\). For any \(m 0\) and \((0,1)\), when \(T>m\), we have_

\[(_{T})> n_{}^{2.5})a_{2}^{n_{}}(-a_{3}m)\;+\; n_{x}^{2.5}n_{}^{2.5})a_{4}^{n_{x}n_{}}1-q_{w} }{4}}^{},\]

_where \(a_{1}=p_{}}{4}\), \(a_{2}=^{2}}{s_{}^{2.5}}\), \(a_{3}=^{2.5}}{8}\), \(a_{4}=}}{s_{}p_{}}\). The constants hidden in \(\) are provided in the Appendix C.1._

The proof of Theorem 3 is based on Theorem 1 in this paper and Theorem 1 from (Li et al., 2024). The detailed proof is provided in Appendix C.1.

Theorem 3 establishes an upper bound on the "failure" probability of SME, that is, the probability that the diameter of the uncertainty set exceeds \(\). To ensure that the failure probability is less than \(1\), one can select \(m=O((T))\) and choose a sufficiently large \(T\) such that \(T m=O((T))\). If \(w_{t}\) is more likely to visit the boundaries of the set \(\) (meaning larger \(q()\)), the SME is less likely to estimate an uncertainty set with a diameter greater than \(\).

To provide more intuitions on the diameter bound in Theorem 3, we consider \(q_{w}()=c_{w}\) for some \(c_{w}>0\). Note that several common distributions, including the uniform distribution and the truncated Gaussian distribution, satisfy this property on \(q_{w}()\) (see Appendix C.2 for explicit formulas of \(c_{w}\)). With \(q_{w}()=c_{w}\), we can provide a convergence rate of the SME in terms of \(T\) in the following.

**Corollary 2** (SME's convergence rate when \(q_{w}()=c_{w}\) ).: _For any \(>0\), let_

\[m O+n_{} }{s_{}p_{}}}{p_{}^{2}}.\]

_If \(w_{t}\)'s distribution satisfies \(q_{w}()=c_{w}\) for all \(>0\), then when \(T>m\), we have:_

\[(_{T}) O}+mn_{x}^{1.5}n_{}n_{x}}{s_{ }p_{}}}{c_{w}s_{}p_{}T},\]

_with probability at least \(1-2\). Here the constants hidden in \(O()\) are provided in Appendix C._The proof of Corollary 2 is provided in Appendix C.2.

Finally, similar to LSE, we can extend SME's convergence rates from open-loop systems to closed-loop systems with real-analytic control policies, i.e., \(u_{t}=(x_{t})+_{t}\), where \(_{t}\) satisfies Assumption 3 and \((x_{t})\) is real-analytic.

**Corollary 3** (SME's convergence rate for closed-loop systems).: _Consider inputs \(u_{t}=(x_{t})+_{t}\), where \(()\) is real-analytic, \(_{t}\) satisfies Assumption 3, and the closed-loop system \(x_{t+1}=_{*}(x_{t},(x_{t})+_{t})+w_{t}\) satisfies Assumption 4 in terms of both \(w_{t}\) and \(_{t}\). Then, the same convergence rates as in Theorem 3 and Corollary 2 still hold._

The proof of Corollary 3 is provided in Appendix C.3.

## 4 Numerical Experiments

In this section, we evaluate the performance of LSE in estimating the unknown parameter \(_{*}\) and SME in estimating the uncertainty set for the unknown parameters using the pendulum and quadrotor examples outlined in Section 2. We compare the empirical convergence rates of LSE and SME with the theoretical rates in Theorem 2 and Corollary 2. In each case, the input \(u_{t}\) is composed of a control policy and i.i.d. noise, such that \(u_{t}=(x_{t})+_{t}\). For our experiments, we employ noise and disturbances drawn from uniform and truncated-Gaussian distributions. To compute theoretical rates, we numerically estimate parameters such as \(s_{}\) and \(p_{}\) (see Appendix E). Further details can be found in our source code.7

The details for these scenarios are outlined below:

* **Pendulum 1:** In the pendulum example described in Section 2, the control input is \(u_{t}=-k_{t}+_{t}\). This scenario includes two unknown parameters: \(_{1}=\) and \(_{2}=}\).
* **Quadrotor 2:** For the quadrotor example in Section 2, the control input is defined as \(u_{t}=(x_{t})+_{t}\), where \((x_{t})\) follows the controller proposed by Alaimo et al. (2013). The quadrotor system involves \(13\) states and \(4\) inputs, with the unknown parameter matrix \(_{*}\) containing \(7\) parameters, including the mass \(m\) and specific elements of the inertia matrix \(I\).

Further details on controller gains and unknown parameters are provided in Appendix D.

LSE Results:Figures 0(a) and 0(b) present a comparison between the LSE theoretical bound from Theorem 2 with its empirical estimation error of the unknown parameters \(_{*}\) versus trajectory length \(T\) for the pendulum example, with uniform and truncated-Gaussian noises and disturbances. Similarly, Figures 0(c) and 0(d) show this comparison for the quadrotor example. In each figure, both the theoretical bound and empirical error are normalized by the \(l_{2}\) norm of the nominal parameter \(_{*}\). The log-log plots for both scenarios demonstrate that the empirical error rate achieves \((})\) which in consistent with the theoretical rate in Theorem 2.

SME Results:Figures 0(a) and 0(b) show the empirical convergence rate of SME for the pendulum example, for uniform and truncated-Gaussian noises and disturbances, in comparison to the theoretical rate from Corollary 2. Both the theoretical bound and empirical error in the figures are normalized by the \(l_{2}\) norm of the nominal parameter \(_{*}\). The log-log plots indicate that the empirical rate achieves \(O()\), which is consistent with the results from Corollary 2 and with the related results for linear systems in (Li et al., 2024). A similar result can be observed for the quadrotor example, in Figures 0(c) and 0(d). Additionally, Figure 3 shows the uncertainty sets estimated by SME for the two unknown parameters, labeled \(_{1}\) and \(_{2}\), in the pendulum example, along with the diameters of these sets as trajectory length grows. We observe that these sets contract as trajectory length increases, with the true values of the unknown parameters lying within the estimated uncertainty sets. The illustration of uncertainty sets for the quadrotor example is provided in Appendix D.2.

## 5 Concluding Remarks

**Conclusion.** This study examines the probabilistic persistent excitation in a class of nonlinear systems influenced by i.i.d. noise and stochastic disturbances, with the stipulation that their distributions do not concentrate on sets of Lebesgue measure zero. Based on this we then present an explicit bound on the convergence rate of SME estimations and LSE estimations for this class of dynamical systems. Additionally, numerical experiments in the context of robotics are provided to illustrate both methods.

**Limitations.** One limitation of this work is that our analysis relies on a specific class of i.i.d. noises and stochastic disturbances, where the probability distribution is not concentrated on sets of Lebesgue measure zero. While this is a sufficient condition, it is possible that the BMSB conditions are satisfied under other circumstances. Another limitation is that, though we provide sufficient conditions for the existence of parameters satisfying the BMSB condition, the explicit dependence is not detailed here. Lastly, imperfect observations are not considered here.

**Future Work.** Our future work includes several promising directions, e.g., to explore cases that do not satisfy our semi-continuity assumption, such as discrete noises, and to investigate the explicit dependence of the BMSB parameter on system attributes, such as state, input, and feature dimensions, etc. Furthermore, extending this work to imperfect state observations is an important next step. Finally, a potential direction is to provide a non-asymptotic analysis of the volumes of uncertainty sets estimated by SME uncertainty sets, as opposed to the current focus on their diameters.

Figure 1: Convergence rate of the LSE for pendulum and quadrotor scenarios: (a) Pendulum example with uniform, (b) Pendulum example with truncated-Gaussian, (c) Quadrotor example with uniform, and (d) Quadrotor example with truncated-Gaussian noises and disturbances. Here, uniform noises and disturbances are i.i.d. generated from uniform\(([-1,1])\), and truncated-Gaussian noises and disturbances are i.i.d. truncated-Gaussian\((0,0.1,[-1,1])\). “theo” denotes the theoretical convergence rate, and “empr” represents the empirical rate. The mean error across 20 trials is shown by dots on the empirical plots, with shaded areas illustrating empirical standard deviation.

Figure 2: Convergence rate of the SME for pendulum and quadrotor scenarios: (a) Pendulum example with uniform, (b) Pendulum example with truncated-Gaussian, (c) Quadrotor example with uniform, and (d) Quadrotor example with truncated-Gaussian noises and disturbances. Here, uniform noises and disturbances are i.i.d. generated from uniform\(([-1,1])\), and truncated-Gaussian noises and disturbances are i.i.d. truncated-Gaussian\((0,0.5,[-1,1])\). “theo” denotes the theoretical convergence rate, and “empr” represents the empirical rate. The mean error across 10 trials is shown by dots on the empirical plots, with shaded areas illustrating empirical standard deviation.

## Broader Impact

This paper is a foundation research and develops theoretical insight to estimation of nonlinear control systems. We do not see a direct path to negative applications in general. But we want to mention that successful applications of our theoretical results rely on verifying the assumptions in this paper.