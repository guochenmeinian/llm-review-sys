# ChatPathway: Conversational Large Language Models for Biology Pathway Detection

Anonymous Author(s)

Affiliation

Address

email

###### Abstract

Biological pathways, like protein-protein interactions and metabolic networks, are vital for understanding diseases and drug development. Some databases such as KEGG are designed to store and map these pathways. However, many bioinformatics methods face limitations due to database constraints, and certain deep learning models struggle with the complexities of biochemical reactions involving large molecules and diverse enzymes. Importantly, the thorough exploration of biological pathways demands a deep understanding of scientific literature and past research. Despite this, recent advancements in Large Language Models (LLMs), especially ChatGPT, show promise. We first restructured data from KEGG and augmented it with molecule structural and functional information sourced from UniProt and PubChem. Our study evaluated LLMs, particularly GPT-3.5-turbo and Galactica, in predicting biochemical reactions and pathways using our constructed data. We also assessed its ability to predict novel pathways, not covered in its training dataset, using findings from recently published studies. While GPT demonstrated strengths in pathway mapping, Galactica encountered challenges. This research emphasizes the potential of merging LLMs with biology, suggesting a harmonious blend of human expertise and AI in decoding biological systems.

## 1 Introduction

Biological pathways, including protein-protein interaction networks, metabolic networks, and gene regulatory networks, are intricate systems of proteins and molecules interacting in processes like signaling . Investigating these pathways is essential for understanding disease mechanisms and drug development. Techniques like GSEA  and SPIA  aid this exploration. Databases like KEGG  have also been developed to collate and visualize these networks systematically. However, identifying pathways from genome-inferred proteins and enzymes is limited by database completeness, complicating data integration from varied sources.

Recent advancement in deep learning offers new tools for scientific research. Among these tools, Large language models (LLMs) have been revolutionizing in the domain of Natural Language Processing (NLP). Their fantastic generalization ability is obtained by pretraining on extensive textual datasets. ChatGPT, released by OpenAI in November 2022 , exemplifies the capabilities of such models. ChatGPT's aptitude for understanding scientific texts has seen its application in interpreting protein sequences and molecular structures like SMILES, aiding in tasks such as molecule editing  and chemistry-focused projects . Other models,such as SciBERT , BioLM , and Galactica , have been developed explicitly for processing scientific literature and typically of a smaller scale.

Existing deep learning methods mainly utilize chemical structure in the format of graph [8; 28] or SMILES  to predict chemical reactions. Predicting biochemical reactions poses a more complex set of challenges compared to chemical reactions. A significant factor is the involvement of large molecules, which often participate in these reactions. These large molecules introduce an additional layer of complexity due to their diverse structures and functionalities, necessitating a more nuanced approach for accurate prediction. Besides, the outcome of biochemical reactions is also significantly influenced by the variety of enzymes involved. Different enzymes have the potential to catalyze the same set of reactants to yield diverse products, following unique pathways and mechanisms. This variability and diversity necessitate a comprehensive understanding of enzyme specificity and the conditions under which they operate. Yet, LLMs can integrate data from diverse sources, offering nuanced insights into pathway interactions. Given their training in vast data repositories and their ability of reasoning, they may deduce interactions based on existing knowledge or even pioneer groundbreaking hypotheses about pathways, which helps experimental design in wet-lab.

Consequently, our research seeks to assess the capabilities of LLMs for pathway predictions. We have formulated three primary tasks for our assessment in Figure 1: (1) _Biochemical Reaction Prediction_: Given reactants and enzymes, the task is to predict the products. (2) _Metabolism Pathway Prediction_: This involves predicting the complete metabolic pathway given the initial reactants and enzymes, where each step is similar to the biochemical reaction prediction. (3) _Regulatory Pathway Prediction_: The objective is to predict the complete regulatory relationships within a pathway given stimuli. These tasks are framed within the context of identifying the relationships between the input elements and predicting the likely outputs, providing a basis for understanding the underlying probabilistic distributions of biochemical reactions and pathways. To accomplish these tasks, we systematically restructured relevant data from KEGG through the API, incorporating important functional and structural information retrieved from UniProt  and PubChem . We utilized data encompassing 11,944 reactions, 480 metabolism pathway modules, and 1,356 regulatory pathways from KEGG. Our analysis centers on evaluating the performance of GPT-3.5-turbo and Galactica in predicting the outcomes of biochemical reactions based on enzymes and in reconstructing complete pathways or regulatory networks from initial stimuli and enzymes. The results suggest GPT exhibits promising potential in mapping comprehensive pathways documented in KEGG. When introduced to novel scenarios beyond its training scope, GPT is adept at outlining various plausible downstream pathway progressions. This capability not only provides valuable insights but also charts out prospective research trajectories for scientists. However, GPT's current limitation lies in its inability to predict the precise targets involved in the pathway.

To sum up, our contributions are: (1) We curated and assembled 11,944 reaction and 1,836 pathway data from KEGG, enriched with molecular structural and functional insights from UniProt and PubChem, for easier accessibility; (2) We initiated the exploration of the capabilities of large language models for predicting biological pathways. It is important to note that LLMs are designed to be knowledgeable across a vast spectrum of fields. This enables them to synthesize information from diverse areas and offer insights that might be challenging for individual researchers to arrive at. Our findings lay both the strengths and limitations of LLMs, charting a path for further refinements.

## 2 Dataset Construction

Our primary data source was the KEGG database . To assess the efficacy of LLM in predicting biochemical reactions, we compiled a set of 11,944 reactions from KEGG. The constituents of these reactions can be either compounds or glycans. For compounds, their corresponding SMILES were fetched from PubChem using the CAS numbers provided by KEGG. In the case of glycans, we gathered monosaccharide compositions directly from KEGG. It's worth noting that the enzymes responsible for these reactions are occasionally specified. For every unique EC number, we also sourced functional, activity, and sequence information from UniProt when a UniProt ID was available. We consolidated all this data into a structured JSON file.

Additionally, 480 KEGG metabolism pathway modules are collected from the KEGG database through the API. Each of these modules represents a segment of a more intricate pathway, depicted through manually created pathway maps. These maps encapsulate molecular interactions, reactions, and relational networks, predominantly encompassing metabolic pathways and cellular processes. We have structured each module based on consecutive reactions. The reactants, products, and associated enzymes for each of these reactions are also archived in a JSON file. Since each metabolism pathway is composed of several reactions, the detailed information can be retrieved from the previously constructed reaction data. For each reaction within a pathway, we identified its parent reactions as well as any external reactants that are not products of any preceding reactions.

Moreover, we utilized 1,356 KEGG networks, which we recognize as regulatory pathways that encompass protein-protein interactions. These regulatory pathways prioritize variations in molecular interaction and reaction networks, manifesting as network variation maps. Examples include gene expression profiles, protein-protein interaction networks, and perturbations in molecular networks related to diseases and drugs. To articulate a regulatory pathway in textual form, we adhered to KEGG's notational conventions, outlining the regulatory relationships between two components. We follow the KEGG instructions and translate the symbols used in describing the molecular interactions as: \(\) inhibition; \(\) expression; \(\) complex formation; \(\)/ missing interaction or reaction; \(\) Activation or Enzymatic reaction or transport process; \(\) Substrate binding to enzyme or transporter; \(\) Enzyme-enzyme relation of successive reactions; \(\) repression.

The detailed information we retrieved from the database is illustrated in Figure 3.

## 3 Prompt Design and Preliminary Results

We used the GPT-3.5-turbo (175 B parameters) and Galactica base model (1.3 B parameters) as our primary models. The detailed prompts are given in Table 2 in Appendix C.

### Reaction

Since single reactions are the basic units of a complex pathway, we first assessed a total of 11,756 individual biochemical reactions. However, we excluded those KEGG reactions for which the API retrieval did not provide a list of reactants. If the KEGG entry includes the "ENZYME" section, we incorporate the enzyme information. For predictions made using Galactica, we employed the Question Answering mode: **Question:**_prompt_**\(\)unAnswer:**, with the base prompt mirroring that of GPT.

Figure 1: An illustration of biochemical reactions, metabolism pathways, and regulatory pathways. (a) In biochemical reaction prediction, product is predicted; (b) In metabolism pathway prediction, all the inner products are predicted; (c) In the regulatory pathway, the regulated components and the regulatory relationship are predicted.

**Evaluation** Predictions were manually assessed by aligning them with the actual products. A prediction is correct if it matches either the name or the SMILES representation of every product, recognizing that certain products might lack a SMILES notation, such as proteins. The results are shown in Table1 1

### Metabolism Pathway

We assessed a total of 131 KEGG pathway modules among the 480 collected modules. For each module, we designated the reactants of the initial reaction as the stimuli that initiate the pathway. We applied three different ways to run the experiments, which are also visualized in Figure 2: (1) Using an autoregressive approach, we allowed the large language model to predict subsequent reactions. This meant that its earlier predicted parents reactions were continuously fed back into the model, serving as the prior state of the pathway. The model also needs to decide which products participate in the following reaction. The results are labeled as metabolism_pathway_auto; (2) Similar to the first method, we also conducted experiments where the models were provided with ground truth reactants at each step, rather than relying on their prior predictions, which are labeled as metabolism_pathway_auto_true; (3) For each module, we provide the complete initial half of the ground truth reactions directly to the model and task it with predicting the remaining reactions. The outcomes of this approach are presented in the metabolism_pathway_one-time column in Table 1.

Given that Galactica lacks conversational memory, for the first two methods, we compiled its predictions for all reaction precursors of a reaction and then supplied these to Galactica, prompting it to forecast the following step using a similar Question Answering framework.

**Evaluation** Considering that the pathway is complex to evaluate, we adopted an additional GPT-3.5-turbo as the evaluator to assess the congruence between the predicted pathway/network and the ground truth. In the third method, we have observed that by supplying the reactions, GPT occasionally directly recognizes the entire pathway without the need for explicit prediction. This phenomenon could explain the significantly higher accuracy observed in the metabolism_pathway_one-time results.

**Baseline** We employed DAVID bioinformatics resources  as a baseline method, which, given enzymes, identifies the pathways in which these enzymes participate, ranked by p-values, by searching existing databases like KEGG. Since this tool only supports website interaction and the results need to be manually checked, we tested it with 20 selected metabolism pathways, on which GPT-3.5-turbo has a 50% predicting accuracy. We input all the enzymes listed by KEGG and verified whether

Figure 2: Visualization of three metabolism pathway prediction methods: (a) Auto-regressive prediction, where the LLM predicts subsequent steps based on prior predictions; (b) Auto-regressive prediction with ground truth reactants, where the LLM is provided the true reactants at each step; and (c) One-time prediction, where the LLM is supplied with complete reactions from the first half of the pathway to predict the remaining pathway.

the corresponding KEGG pathway was returned by the tool. The results are also presented in Table 1.Given that we tested KEGG data and the system directly fetches data from KEGG, its performance is notably superior.

### Regulatory Pathway

We examined 353 regulatory pathways taken from the KEGG network section, encompassing protein interactions and signaling pathways. As with previous evaluations, the initial stimulus, whether a protein or another compound, was provided to the model. To represent it in textual form, we followed KEGG's notational standards, detailing the regulatory relationships between two entities, which is included as background information as shown in the prompts in Table 2 in Appendix C. Correspondingly, three types of experiments are performed, which are similar to the examples given in Figure 2, while it no longer predicts the products but the regulated objects and regulatory relationships. (1) For autoregressive generation, we provided the initial step, noting that a single stimulus could be part of various regulatory pathways. The model then anticipates the subsequent interaction based on its prior prediction. Similarly, for Galactica prediction, we collected all the predictions of precursor steps as the knowledge and let it predict the next step; The results are under column regulatory_pathway_auto in in Table 1; (2) In parallel, we also executed experiments where models were given the true previous step to predict subsequent regulations, which are labeled as regulatory_pathway_auto_true in Table 1; (3) For each pathway, we provide the initial half of the ground truth steps directly to the models and task them with predicting the remaining steps. The results are presented in the regulatory_pathway_one-time column.

**Evaluation** Similarly, we adopted an additional GPT-3.5-turbo as the evaluator to assess the congruence between the predicted pathway/network and the ground truth.

**Baseline** Similar to the metabolism pathway, we tested David Bioinformatics Resources with 20 selected regulatory pathways, on which GPT-3.5-turbo has a 50% predicting accuracy. We input all the proteins involved in each pathway and verified whether the corresponding KEGG pathway was returned by the tool. The results are presented in Table 1.

### Case Studies

To evaluate GPT's potential in novel biological pathway prediction, we tested it on two papers that were published in 2023, after GPT-3.5-turbo was released.

**Case 1** Embryos from various metazoan lineages can induce a state of transcriptional dormancy, allowing development to pause in response to adverse environmental conditions. Collignon et al.  elaborate on the mechanics of this process, the Mettl3 mediating N6-methyladenosine RNA methylation directly destabilizes the mRNA of N-Myc, the transcriptional amplifier, causing suppression of global nascent transcription. This pathway together with the Mettl3 regulating the destabilization of global mRNA leads to a developmental pause.

To assess the capabilities of GPT-3.5-turbo in understanding and predicting this biological process, we presented the following prompt:

   Model & Reaction & Metabolism & Pathway &  \\  David BR & â€“ &  &  \\   & & auto & auto\_true & one-time & auto & auto\_true & one-time \\  GPT-3.5-turbo & 24.06\% & 24.62\% & 25.38\% & 42.31\% & 20.11\% & 39.94\% & 26.85\% \\ Galactica (base) & 1.08\% & 0\% & 0\% & 0\% & 0\% & 0\% & 0\% \\   

Table 1: Accuracy(%) of GPT-3.5-turbo and Galactica (base)Under adverse environmental conditions, embryonic stem cells from metazoan lineages enter reversible states of developmental pausing, or diapause. There is a pathway starting with Mettl3 regulating the process, predict the pathway starting with Mettl3.

The response generated by GPT can be referenced in Appendix D.1. Notably, the third point highlighted by GPT accurately indicates that Mettl3 facilitates the addition of m6A modifications to mRNA molecules. However, it doesn't explicitly mention the modification of N-Myc mRNA.

**Case 2** Another study  shows that E4ligase, yeast Ufd2 and human UBE4B (the human homolog of Ufd2) move to mitochondria and ubiquitylate mitofusins, thereby inhibiting mitochondrial fusion under environmental stress conditions. This progress leads to mitochondrial fragmentation. Based on this fact, we formed the following prompt for GPT:

**In human cells, under the stress of heat shock, UBE4B translocates to mitochondria, predict the following reaction in this pathway.**

The response generated by GPT can be referenced in Appendix D.2. The second point mentions that UBE4B will interact with Mitochondrial Proteins related to mitochondria maintenance, repair, and quality control, while it doesn't give specific targets. In a real situation, scientists might be then interested in knowing which proteins in mitochondria can interact with UBE4B. We further asked GPT about the details:

**You mentioned that UBE4B can interact with other mitochondria proteins involved in mitochondrial quality control, maintenance, and repair. Can you give some possible proteins in detail?**

The complete answer is given in Appendix D.2. The sixth point mentions that UBE4B could potentially influence the Mfn1 and Mfn2 ubiquitination, resulting in an impact on the mitochondria fusion. This is what the paper suggests and thus it can be considered as a successful prediction.

## 4 Conclusion

In our study, we combined traditional biology with advanced artificial intelligence, specifically focusing on models like GPT-3.5-turbo and Galactica, to explore their potential in biological pathway prediction and analysis. Our results show that GPT can effectively understand and predict complex biochemical interactions, often with a level of accuracy comparable to well-established databases like KEGG. However, they sometimes struggled with specifics, indicating areas that need further improvement. However, Galactica is less effective in handling the long biology description and given comprehensive pathway predictions.

Our real-world tests, using recent scientific publications, highlighted both the strengths and limitations of these models in predicting novel pathways. Leveraging GPT's capacity to amalgamate vast data from diverse sources, it stands as a specialist across multiple biology disciplines, offering holistic predictions on pathways. This serves as a brainstorming tool for scientists, assisting in refining their research focus. However, given its occasionally broad outputs, human intervention remains pivotal to discern and extract the most insightful information from its analyses.

In summary, our findings support the idea that LLMs can be a powerful tool to complement traditional biology research. However, human expertise remains essential to ensure the accuracy and relevance of LLMs predictions. As we move forward, the collaboration between human experts and AI will be crucial for gaining deeper insights into biological systems.