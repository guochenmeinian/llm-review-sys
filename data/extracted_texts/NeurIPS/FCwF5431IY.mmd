# Directed Cyclic Graph for Causal Discovery from Multivariate Functional Data

Saptarshi Roy

Department of Statistics

Texas A&M University

College Station, TX 77843

roys8001@stat.tamu.edu

&Raymond K. W. Wong

Department of Statistics

Texas A&M University

College Station, TX 77843

raywong@tamu.edu

&Yang Ni

Department of Statistics

Texas A&M University

College Station, TX 77843

yni@stat.tamu.edu

###### Abstract

Discovering causal relationship using multivariate functional data has received a significant amount of attention very recently. In this article, we introduce a functional linear structural equation model for causal structure learning when the underlying graph involving the multivariate functions may have cycles. To enhance interpretability, our model involves a low-dimensional causal embedded space such that all the relevant causal information in the multivariate functional data is preserved in this lower-dimensional subspace. We prove that the proposed model is causally identifiable under standard assumptions that are often made in the causal discovery literature. To carry out inference of our model, we develop a fully Bayesian framework with suitable prior specifications and uncertainty quantification through posterior summaries. We illustrate the superior performance of our method over existing methods in terms of causal graph estimation through extensive simulation studies. We also demonstrate the proposed method using a brain EEG dataset.

## 1 Introduction

Motivation.Multivariate functional data arise in many fields such as biomedical research (Wei and Li, 2008; Chiou and Muller, 2016), environmental science (Korte-Stapff et al., 2022), finance (Kowal et al., 2017), plant science (Wong et al., 2019; Park et al., 2022), and sport science (Volkmann et al., 2021) where multiple variables are measured over time or other domains. The increasing availability of functional data in these fields provides us with great opportunities to discover causal relationships among random functions for the better understanding of complex systems, which is helpful for various machine learning and statistics tasks such as representation learning (Scholkopf et al., 2021), fairness (Tang et al., 2023), transfer learning (Rojas-Carulla et al., 2018), and reinforcement learning (Zeng et al., 2023). One motivating example is electroencephalography (EEG) where electrical activity from the brain is recorded non-invasively from electrode channels by placing them on the scalp or directly on the surface of the brain. Given its continuous nature and the short time separation between the adjacent measuring points, it is natural to treat the data at each brain location/region as a function over time. A relevant scientific goal is to estimate brain effective connectivity among different regions, which will potentially allow us to make better decisions, design more effective interventions, and avoid unintended consequences. However, existing structural equation model (SEM) based causal discovery methods assume acyclic relationships among the random functions by imposing a directed acyclic graph (DAG) structure, which may be too restrictive for many real applications. For example, there are strong indications that in brain effective connectivity studies, due to reciprocal polysynaptic connections, the brain regions are far from exhibiting acyclicity (Friston, 2011; Markov et al., 2012), and that in genetic pathways, due to the presence of multiple upstream regulators and downstream targets for every signaling component, feedback loops/directed cycles are regular motifs (Brandmanand Meyer, 2008]. Thus, in light of the prevalence of cycles in complex systems, it is desirable to have a flexible model for causal discovery among random functions that can account for such cyclic causal structures.

Challenges.Causal discovery for multivariate functional data in the presence of cycles is an inherently difficult problem that is not yet well understood. We highlight three prominent challenges. (i) Functional data are infinite-dimensional in nature. It may so happen that the low-frequency spectrum of one curve might causally influence the high-frequency spectrum of another curve. This demands identification of pertinent features that can be used to create a finite-dimensional representation of the data, which is easier to work with and analyze. However, the challenge is that we may not know _a priori_ what the relevant features are when dealing with infinite-dimensional objects. Blind adoption of standard (non-causal-adaptive) low-dimensional features can lead to errors or inaccuracies. (ii) Although the identifiability of causal models for multivariate functional data in the absence of cycles has been established in recent works [Zhou et al., 2022b, Lee and Li, 2022], showing identifiability of causal models from multivariate data, let alone multivariate functions, is still a challenging and complex task in cases where causal relationships are obscured by the presence of cycles. (iii) It is common that functional data are only observed over discrete time points with additional noises. Such incomplete and noisy observations of the functions add another layer of difficulty in probing the causal relationships of interest.

Related work.Causal discovery from multivariate functional data has been studied by a few recent works [Zhou et al., 2022b, Lee and Li, 2022, Yang and Suzuki, 2022], which have already shown some promising results in discovering causality in, e.g., EEG data and longitudinal medical record data. However, all of them are limited to DAGs, which do not allow inference of cyclic causality. While there has been a surge of research on causal discovery methods for scalar random variables in the presence of feedback loops/cycles over the last few decades [Richardson, 1996, Lacerda et al., 2008, Mooij et al., 2011, Hyttinen et al., 2012, Huang et al., 2019, Mooij and Heskes, 2013, Mooij and Claassen, 2020, Zhou et al., 2022a], none of these approaches have been extended to discovering causal dependencies among random functions in multivariate settings. Therefore, how to handle cyclic causal relationships among multivariate functional data while addressing the aforementioned challenges remains a largely unsolved problem.

Contributions.In this paper, we propose an operator-based non-recursive linear structural equation based novel causal discovery framework that identifies causal relationships among functional objects in the presence of cycles and additional measurement/sampling noises. Our major contribution is four-fold.

1. We consider a causal embedding of the functional nodes into a lower-dimensional space for dimension reduction that adapts to causal relationships.
2. We prove that the causal graph of the proposed model is uniquely identifiable under standard causal assumptions.
3. We capture within-function dependencies using a data-driven selection of orthonormal basis that is both interpretable and computationally efficient.
4. To perform inference and uncertainty quantification from finite-sample data, we adopt a fully Bayesian hierarchical formulation with carefully selected prior distributions. Posterior inference is performed using Markov chain Monte Carlo (MCMC). We demonstrate the effectiveness of the proposed method in identifying causal structure and key parameters through simulation studies and apply the framework to the analysis of brain EEG data, illustrating its real-world applicability. Code will be made available on the project's website on Github.

## 2 Model definition and causal identifiability

### Notations

Let \([p]=\{1,,p\}\) for any positive integer \(p\). A causal directed cyclic graph (DCG) is a graph \(=(,)\), which consists of a set of vertices or nodes \(=[p]\) representing a set of random variablesand a set of directed edges \(=\{ j|j,\}\) representing the direct causal relationships among the random variables. In a DCG, we do not assume the graph to be acyclic. A causal DCG model is an ordered pair \((,)\) where \(\) is a joint probability distribution over \(\) (more rigorously, the random variables that \(\) represents) that satisfies conditional independence relationships encoded by the causal DCG \(\). A simple directed cycle is a sequence of distinct vertices \(\{v_{1},,v_{k}\}\) such that the induced subgraph by these vertices is \(v_{1} v_{k} v_{1}\). For a vertex \(j\), we use \((j)\) to denote the set of parents (direct causes).

### Model framework

Consider a multivariate stochastic process \(=(Y_{1},,Y_{p})^{}\) where each \(Y_{j}\) is defined on a compact domain \(_{j}\). Without loss of generality, we assume \(_{1}==_{p}=\). Suppose \(Y_{j}_{j}\) where \(_{j}\) is a Hilbert space of functions defined on \(_{j}\). We let \(,\) denote the inner product of \(_{j}\). We propose a causal model that captures the relationships among \(Y_{1},,Y_{p}\).

Our proposed model considers an operator-based non-recursive linear structural equation model on the random functions \(\) as

\[Y_{j}()=_{(j)}(_{j}Y_{})()+ f_{j}(), j[p],\] (1)

where \(_{j}\) is a linear operator that maps \(_{}\) to \(_{j}\), and \(f_{j}_{j}\) is an exogenous stochastic process. Clearly, for any \(j,\) such that the edge \( j\), \(_{j}\) is not a null operator. Now by stacking the \(p\) equations in (1), we obtain

\[=+,\] (2)

where \(=(_{j})_{j,=1}^{p}\) is a matrix of operators and \(=(f_{1},,f_{p})^{}\) is a \(p\)-variate stochastic process. In DAGs, the causal effect matrix can be arranged into a lower block triangular structure given a topological/causal ordering. But since our model allows for cycles, we have no such restriction on the structure of the operator matrix \(\) except that \(_{jj}, j[p]\), is null, i.e., no self-loops.

Model (1) is infinite-dimensional and hence challenging to estimate and interpret. To alleviate such difficulties, we consider a low-dimensional causal embedding structure. Specifically, we assume that the causal relationships are preserved in an unknown low-dimensional subspace \(_{j}\) of \(_{j}\). Denote the dimension of \(_{j}\) by \(K_{j}\). Let \(_{j}\) and \(_{j}\) be the projection onto \(_{j}\) and its orthogonal complement in \(_{j}\) respectively. We assume \(_{j}=_{j}_{j}_{}\), which implies that causal effects can be fully described within the low-dimensional subspaces \(\{_{j}\}_{j=1}^{p}\). As such, (1) can be split into

\[_{j}Y_{j} =_{(j)}_{j}(_{ }Y_{})+_{j}f_{j},\] (3) \[_{j}Y_{j} =_{j}f_{j}.\]

We assume that \(_{j}f_{j}\) and \(_{j}f_{j}\) are independent of each other. Now, by defining \(_{j}=_{j}Y_{j}\) and \(_{j}=_{j}f_{j}, j[p]\), (3) can be compactly written as

\[=+,\] (4)

where \(=(_{1},,_{p})^{}\) and \(=(_{1},,_{p})^{}\) with \(_{j},_{j}_{j}, j[p]\).

In practice, the random functions in \(\) can only be observed over a finite number of (input) locations, possibly with measurement errors. More specifically, for each random function \(Y_{j}\), we observe \(\{(t_{ju},X_{ju})\}_{u=1}^{m_{j}}\), where \(X_{ju}\) is the measurement of \(Y_{j}\) at location \(t_{ju}_{j}\) and \(m_{j}\) is the number of measurements obtained from \(Y_{j}\). Defining \(_{j}=_{j}Y_{j}\), we consider the following measurement model:

\[X_{ju}=Y_{j}(t_{ju})+e_{ju}\\ =_{j}(t_{ju})+_{j}(t_{ju})+e_{ju}, u[m_{j}],j[p], \] (5)

with independent noises \(e_{ju} N(0,_{j}), u[m_{j}]\).

More compactly, (5) can be written as

\[=()+()+,\] (6)where \(=(_{1}^{},,_{p}^{})^{}\), \(()=(_{1}(_{1})^{},,_{p}( _{p})^{})^{}\), \(()=(_{1}(_{1})^{},,_{p}( _{p})^{})^{}\) and \(=(_{1}^{},,_{p}^{})^{}\) with \(_{j}=(X_{j1},,X_{jm_{j}})^{},_{j}(_{j})=( _{j}(t_{j1}),,_{j}(t_{jm_{j}}))^{},_{j}( _{j})=(_{j}(t_{j1}),,_{j}(t_{jm_{j}}))^{}\) and \(_{j}=(e_{j1},,e_{jm_{j}})^{}\).

We call our proposed model, **FENCE**, which stands for '**F**unctional **E**mbedded **N**odes for **C**yclic causal Exploration', reflecting its purpose.

### Causal identifiability

In this section, we shall show that the graph structure of the proposed FENCE model is identifiable for functional data measured discretely with random noises under several causal assumptions. We start by defining causal identifiability and state our assumptions.

**Definition 2.1**.: (_Causal Identifiability_) Suppose \(\) is a \(p\)-variate random function and \(\) is the observed noisy version of \(\) given by (6). Assume \(\) follows FENCE model \(=(,)\) where \(\) is the underlying graph and \(\) is the joint distribution of \(\) over \(\). We say that \(\) is causally identifiable from \(\) if there does not exist any other \(^{*}=(^{*},^{*})\) with \(^{*}\) such that the joint distribution \(^{*}\) on \(\) induced by \(^{*}\) is equivalent to \(\) induced by \(\).

In other words, for a causal graph to be identifiable, there must not exist any other graph such that the joint distributions induced by the two different graphs are equivalent. Next, we list and discuss a few assumptions to establish the causal identifiability of the proposed model.

**Assumption 1**.: _(Causal Sufficiency) The model \(=(,)\) is causally sufficient, i.e., there are no unmeasured confounders._

Assuming no unmeasured confounders keeps the causal discovery task more manageable especially for cyclic graphs with purely observational data.

**Assumption 2**.: _(Disjoint Cycles) The cycles in \(\) are disjoint, i.e., no two cycles in the graph have two nodes that are common to both._

Assuming disjoint cycles induces a natural topological ordering and forms a directed acyclic hypergraph-like structure within the DCG. The same assumption was made in Lacerda et al. (2008).

**Assumption 3**.: _(Stability) For the model \(\), the moduli of the eigenvalues of the finite rank operator \(\) are less than or equal to \(1\), and none of the real eigenvalues are equal to \(1\)._

According to Fisher, 1970, the SEM in (4) can be viewed as being in a state of equilibrium, where the finite rank operator \(\) represents coefficients in a set of dynamical equations that describe a deterministic dynamical system observed over small time intervals as the time lag approaches zero. The eigenvalue conditions are deemed necessary and sufficient for the limiting behavior to hold, as argued by Fisher, 1970. Such an assumption is widely adopted in e.g., econometrics, and Lacerda et al., 2008 made this assumption as well.

**Assumption 4**.: _(Non-Gaussianity) The exogenous variables have independent mixture of Gaussian distributions. i.e., \(_{jk}}}{{}}_{m=1}^{M_{jk}} _{jkm}(_{jkm},_{jkm})\) with \(M_{jk} 2\)._

The assumption of non-Gaussianity on the exogenous variables has been proven useful in causal discovery as it induces model identifiability in the linear SEM framework (Aapo and Petteri, 1999, Shimizu et al., 2006, Lacerda et al., 2008, Spirtes and Zhang, 2016). Mixture of Gaussian can approximate any continuous distribution arbitrarily well given a sufficiently large number of mixture components (Titterington et al., 1985, McLachlan and Peel, 2000, Rossi, 2014). It is also easy to sample, which facilitates our posterior inference.

**Assumption 5**.: _(Non-causal dependency) We assume \(()=()\), where \(()=diag(_{11}(_{1}),,_{pp}(_{p}))\) and \(\) represent another exogenous component of the model. Here \(_{jj}(_{j})\) is a mixing matrix that mixes the independent entires in \(\) to generate temporal dependence within the \(j\)-th block. We assume \(_{jk}}}{{}}_{m=1}^{M_{jk}}^{ }_{jkm}(^{}_{jkm},^{}_{jkm})\) with \(M_{jk} 1\)._

Since the model assumes that all causal information in \(\) is preserved in the lower-dimensional space \(_{j}\) and not in its orthogonal complement, it is apparent that while each \(_{j}(_{j})\) within a block can have temporal dependence, it is independent of \(_{l}(_{})\) when \(j\) and \(j,[p]\).

For some basis \(\{_{jk}\}_{k=1}^{K_{j}}\) that spans the low-dimensional causal embedded space \(_{j}\), \(_{j}\) in (5) can be further expanded by, \(_{j}(t_{ju})=_{k=1}^{K_{j}}_{jk}_{jk}(t_{ju})\). Therefore (6) can be written more compactly as

\[=()}+()+,\] (7)

where \(()=(_{1}(_{1}),,_{p}(_{p}))\) with \(_{j}(_{j})=(_{jv}(t_{ju}))_{u=1,v=1}^{m_{j},K_{j}}\).

**Assumption 6**.: _(Sufficient sampling locations) The basis matrix \(()\) of size \(_{j=1}^{p}m_{j}_{j=1}^{p}K_{j}\) has a full column rank._

This assumption implies enough sampling locations, over which each random function \(Y_{j}\) is observed, to capture all the causal information that \(Y_{j}\) contains.

Given these six assumptions, our main theorem establishes the causal identifiability of the proposed model.

**Theorem 2.1**.: _Under Assumptions 1-6, \(=(,)\) is causally identifiable._

The proof essentially involves two steps as shown in Figure 1. On the left-hand side (LHS) of the diagram, we depict the hypergraph-like structure that emerges when assuming the existence of disjoint cycles (Assumption 2), whereas, on the right-hand side (RHS), we offer a magnified view of the hypernodes (nodes containing simple directed cycle). Our approach to proving causal identifiability progresses from the LHS to the RHS. That is, we first prove the identifiability of the hypergraph-like structure depicted on the LHS of Figure 1, and then we proceed to establish the identifiability of each simple directed cycle within every hypernode in the hypergraph. The detailed exposition of the proof can be found in Section A of the Supplementary Materials.

## 3 Bayesian model formulation

In this section, we will describe the inference procedure of the proposed model. A straightforward approach would be a two-step procedure where the first step performs functional principal component analysis on each function marginally to reduce the dimension, and then the second step learns causal structure based on the principal components. However, this simple approach has several disadvantages. First, the estimated functional principal components that explain the most variation of each individual function marginally may not optimally capture the cause-effect dependence relationships among different functions. Second, this procedure is unreliable since estimation uncertainty fails to propagate correctly from the first step to the second step. As such, we propose a fully Bayesian approach, which reduces the dimension of functional data adaptively for causal structure learning.

### Model parameters

Let \(=(E_{j})_{j,=1}^{p}\) denote the adjacency matrix where \(E_{j}=1\) indicates the existence of a directed edge from node \(\) to node \(j\), and 0 otherwise. Let \(\{_{k}\}_{k=1}^{S}\) be a set of \(S\) common unknown basis

Figure 1: Two important components of causal identifiability proof: (I) identifiability of directed acyclic hypergraph induced by disjoint cycles, and (II) identifiability of each disjoint cycle.

functions that approximate each random function \(Y_{j}\) i.e., \(Y_{j}=_{k=1}^{S}_{jk}_{k}\) where \(\{_{jk}\}_{k=1}^{S}\) denote the set of basis coefficients. Note that \(\{_{k}\}\) is not the basis for the lower-dimensional causal embedded subspace \(_{j}\). However, we assume that the first \(K_{j}\) of them actually spans \(_{j}\) and our goal is to hunt for them through a properly designed inference procedure. Moreover, according to our assumption, we build our SEM on the first \(K_{j}\) of the basis coefficients \(}_{j}=(_{j1},,_{ jK_{j}})^{}\). Defining \(}_{j}=(_{j,K_{j}+1},,_{jS})^{}\) with \(}_{j}=_{j}\), jointly they can be written as

\[}=}}+},\] (8)

where \(}=(}_{1}^{},, }_{p}^{},}_{1}^{ },,}_{p}^{})^{}\), \(}=(}_{1}^{}, ,}_{p}^{},_{1}^{ },,_{p}^{})^{}\) with \(}_{j}=(_{j1},,_{jK_{j}})^{}\) and \(_{j}=(_{j,K_{j}+1},,_{jS})^{}\). Here \(}=&\\ &\) where \(=((_{j}(a,b))_{a=1,b=1}^{K_{j},K_{}})_{j, =1}^{p}\) with \(_{jj}=\) since we assume the absence of self loops. To carry out inference, we assume \(_{jk},_{jk}}{{}}_{m=1}^{M_{jk}}_{jkm}N(_{ jkm},_{jkm})\).

### Adaptive basis expansion

As the \(_{k}\)'s are specifically useful for restricting the original function space for each \(Y_{j}\) to a lower-dimensional causally embedded smooth space of dimension \(K_{j}\), we make the basis \(\{_{k}\}\) adaptive for causal structure learning by further expanding them with known spline basis functions (Kowal et al., 2017), \(_{k}()=_{r=1}^{R}A_{kr}b_{r}()\), where \(=(b_{1},,b_{R})^{}\) is the set of fixed cubic B-spline basis functions with equally spaced knots and \(_{k}=(A_{k1},,A_{kR})^{}\) are the corresponding spline coefficients. Since we do not fix \(_{k}\)'s _a priori_, the basis functions \(_{k}\)'s can be learned from data _a posteriori_ and hence are adaptive to both data and causal structure (i.e., the basis functions, the functional data, and the causal graph are dependent in their joint distribution).

### Prior specifications

Prior on spline coefficients.The prior on \(A_{k}\) is chosen to serve multiple purposes. (i) It sorts the basis functions by decreasing smoothness and therefore helps to identify the spanning set of size \(K_{j}\) for the underlying smooth causally embedded space \(_{j}\). (ii) Although not a strict requirement for modelling purpose, it forces \(_{k}\)'s to be orthonormal, i.e. \(_{k}()_{k^{}}()\,d=I(k=k^{})\). As such, the orthogonality constraints help eliminate any information overlap between the basis functions, which keeps the total number of necessary basis functions that actually contribute to the causal structure learning to a minimum. (iii) It regularizes the roughness of \(_{k}\)'s to prevent overfitting.

For (iii), more specifically, we restrict the roughness of the basis functions \(_{k}()\) by assigning a prior that penalizes its second derivatives (Gu, 1992; Wahba, 1978; Berry et al., 2002):

\[_{k} N(,_{k}^{-1}^{ -}),\]

where \(^{-}\) is the pseudoinverse of \(=^{\,}(t)[^{ \,}(t)]^{}\,dt\). Let \(=^{}\) be the singular value decomposition of \(\). Following Wand and Ormerod, 2010, to facilitate computation, we reparameterize \(_{k}()=_{r=1}^{R}_{kr}_{k}()\) with \(}()=(1,t,^{T}()}}^{-})^{}\) where \(}\) is the \((R-2)(R-2)\) submatrix of \(\) corresponding to non-zero singular values (note that the rank of \(\) is \(R-2\) by definition) and \(}\) is the corresponding \(R(R-2)\) submatrix of \(\). This induces a prior on \(}_{k}\) given by

\[}_{k} N(,_{k})_{k}=(,,_{k}^{-1},,_{k}^{-1}).\]

In other words, the intercept and the linear term are unpenalized but the non-linear terms are penalized, the degree of which is controlled by \(_{k}\). In practice, we set the first two diagonal elements of \(_{k}\) as \(10^{8}\). We constrain the regularization parameters \(_{1}>>_{S}>0\) by putting a uniform prior:

\[_{k} (L_{k},U_{k}),\;\;k[S],\] \[U_{1} =10^{8},L_{k}=_{k+1}\;\;k[S-1],\] \[U_{k} =_{k-1}\;\;k\{2,,S\},L_{S}=10^{-8},\]

which implies that the smoothness of \(_{k}()\) decreases as \(k\) gets larger.

Priors on the adjacency matrix.We propose to use an independent uniform-Bernoulli prior on each entry \(E_{j}\) of \(\), i.e., \(E_{j}|_{}}{}()\) and \((0,1)\). The marginal distribution of \(\) with \(\) integrated out is given by

\[p()= p(|)p()\,d=(_{j}E _{j}+1,_{j}(1-E_{j})+1).\]

Now, for example, if \(_{0}\) denotes the null adjacency matrix and \(_{1}\) denotes the adjacency matrix with only one edge, then we can see that \(p(_{0})/p(_{1})=p^{2}-p\). Therefore, an empty graph is favored over a graph with one edge by a factor of \(p^{2}-p\), and, importantly, this penalty increases with \(p\). Thus, the uniform-Bernoulli prior prevents false discoveries and leads to a sparse network by increasing the penalty against additional edges as the dimension \(p\) grows.

Prior on the causal effect matrix.Now given \(\), we assume an independent spike and slab prior on the entries of \(=(_{j})_{j,=1}^{p}\):

\[_{j}|E_{j}(1-E_{j})MVN(_{j};,s {I}_{K_{j}},_{K_{}})+E_{j}MVN(_{j};,_ {K_{j}},_{K_{}}),\]

where \(MVN(_{j};,_{K_{j}},_{K_{}})\) is a matrix-variate normal distribution with row and column covariance matrices as \(_{K_{j}}\) and \(_{K_{}}\), respectively. We assume a conjugate inverse-gamma prior on the causal effect size, \((a_{},b_{})\). We choose \(a_{}=b_{}=1\). We fix \(s=0.02\) so that when \(E_{j}=0\), \(_{j}\) is negligibly small.

Priors on the parameters of the Gaussian mixture distribution.We choose conjugate priors for the parameters of the Gaussian mixture distribution:

\[(_{jk1},,_{jkM_{jk}})(, ,),\ j[p],k[S]\] \[_{jkm} N(a_{},b_{}),\ _{jkm}(a_{ },b_{}),\ \ j[p],k[S],m[M_{jk}]\]

We have fixed values for the hyperparameters, \(=1,a_{}=0,b_{}=100,a_{}=b_{}=1\).

Prior on the noise variances.We assume a conjugate prior for \(_{j}(a_{},b_{}),\)\(\ j[p]\). We choose \(a_{}=b_{}=0.01\).

We simulate posterior samples through Markov chain Monte Carlo (MCMC). Details are given in Section B of the Supplementary Materials. Sensitivity analyses will be conducted to test the hyperparameters including \((a_{},b_{}),(a_{},b_{}),(a_{},b_{}),s,R,S,M\) and \(\).

## 4 Simulation study

Data generationThe data were simulated according to various combinations of sample size (\(n\)), number of nodes (\(p\)), and grid size (\(m_{j}=d\)\( j[p]\)) where \(n\{75,150,300\}\), \(p\{20,40,60\}\), and \(d\{125,250\}\). The grid evenly spans the unit interval \(\); the results with unevenly spaced grids are presented in Section C of the Supplementary Materials. The true causal graph \(}\) was generated randomly with edge formation probability \(2/p\). Given \(\), each non-zero block \(_{j}\) of the causal effect matrix was generated from the standard matrix-variate normal distribution. We set the true number of basis functions to be \(K=4\). In order to generate \(K=4\) orthonormal basis functions, we first simulated unnormalized basis functions by expanding them further with 6 cubic B-spline basis functions where the coefficients were drawn from the standard normal distribution and then empirically orthonormalized them. The basis coefficients \(}\) were generated following (8) with the exogenous variables \(}_{j}\) drawn independently from Laplace distribution with location parameter \(=0\) and scale parameter \(b=0.2\). We have also considered other non-Gaussian distributions for the exogenous variables; the corresponding results are provided in Section C of the Supplementary Materials. Finally, noisy observations were simulated following (6) with the signal-to-noise ratio, i.e., the mean value of \(|Y_{j}^{(i)}(t)|/_{j}\) across all \(i\) and \(t\), set to 5. Here, superscript \((i)\) denotes the \(i\)th sample, where \(i[n]\).

For the implementation of the proposed FENCE, we fixed the number of mixture components to be 10 and ran MCMC for 5,000 iterations (discarding the first 2,000 iterations as burn-in and retaining every 5th iteration after burn-in). The causal graph \(G\) was then estimated by using the median probability model , i.e., by thresholding the posterior probability of inclusion at 0.5.

[MISSING_PAGE_FAIL:8]

Real data application

Brain EEG data.We demonstrate the proposed FENCE model on a brain EEG dataset from an alcoholism study (Zhang et al., 1995). This dataset was earlier used to demonstrate functional undirected graphical models (Zhu et al., 2016; Qiao et al., 2019) and functional Bayesian network (Zhou et al., 2022b). Data were initially obtained from 64 electrodes placed on subjects' scalps, which captured EEG signals at 256 Hz (3.9 ms epoch) during a one-second period. The study consists of 122 subjects, out of which 77 are in the alcoholic group and 45 are in the control group. Each subject completed 120 trials. During each trial, the subject was exposed to either a single stimulus (a single picture) or two stimuli (a pair of pictures) shown on a computer monitor. We particularly focus on the EEG signals filtered at \(\) frequency bands between 8 and 12.5Hz using the eegfit function of the eeglab toolbox of Matlab as \(\) band signals are associated with inhibitory control (Knyazev, 2007). Given that the EEG measurements were recorded from each subject over multiple trials, these measurements are not independent of each other due to the time dependency of the trials. Moreover, since the measurements were obtained under various stimuli, the signals may have been affected by different stimulus effects. To mitigate these issues, we calculated the average of the band-filtered EEG signals for each subject across all trials under a single stimulus, resulting in a single event-related potential curve per electrode per subject. By doing so, we eliminated the potential dependence between the measurements and the influence of different stimulus types. We performed separate analyses of the two groups to identify both the similarities and dissimilarities in their brain effective connectivity.

We conducted a Shapiro-Wilk normality test on the observed functions for each of the \(p=64\) scalp positions at each of the \(m_{j}=256\)\( j[p]\) time points to evaluate their Gaussianity. The results showed that for numerous combinations of scalp position and time point, the null hypothesis (which assumes that the observations are marginally Gaussian) was rejected. Thus, we conclude that the non-Gaussianity of the proposed model is appropriate. Next, for posterior inference, we ran MCMC for 20,000 iterations, discarded the first half as burn-in, and retained every 10th iteration after burn-in. The estimated causal graph by thresholding the posterior inclusion probability to \(0.9\) is given below in Figure 2.

Results.There are some interesting findings. First, for both groups (alcoholic and control), brain regions that are located in adjacent positions tend to be more connected than the brain regions that are far apart. Second, dense connectivity is observed in the frontal region of the brain in both groups, with multiple cycles being formed. Third, compared to the control group, the alcoholic group has more connectivity across the left parietal and occipital lobes. Fourth, the same cycle of Iz, Cz, and RPA is observed in both groups.

Figure 2: Estimated causal brain connectivity from EEG records by FENCE with posterior probability of inclusion \( 0.9\), separately for the alcoholic (left) and control (right) group. The bi-directed edges are just directed cycles, i.e., \(i j\) means \(i j\) and \(i j\).

Validity.We now discuss the validity of our real data results. In Hayden et al., 2007, it was observed that alcohol-dependent subjects exhibited frontal asymmetry, distinguishing them from the control group. Our own investigation aligns well with these results, as we have identified denser connectivity across various brain regions in the middle and left areas of the frontal lobe among alcoholic subjects, when compared to controls. Furthermore, Winterer et al., 2003 documented coherent differences between alcoholics and controls in the posterior hemispheres, specifically in the temporal, parietal, and occipital lobes. In accordance with their findings, our study provides additional support for this claim, as we have observed heightened activity with several cycles formed in those same regions within the alcoholic group when compared to the control group.

## 6 Discussion

We briefly highlight here several potential avenues for future development of our current work. First, an intriguing and important direction would be to explore the relaxation of the causal sufficiency assumption in the model identifiability. Second, our current model is based on a linear non-Gaussian assumption over the exogenous variables, but a nonlinear model could be considered as an alternative. Lastly, an alternative approach to determining the effective number of basis functions that span the lower-dimensional causal embedded space would be to utilize the ordered shrinkage priors (Bhattacharya and Dunson, 2011, Legramanti et al., 2020) in order to adaptively eliminate redundant components, resulting in a more flexible methodology.