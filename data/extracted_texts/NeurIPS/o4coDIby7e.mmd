# Measuring Goal-Directedness

Matt MacDermott

Imperial College London

&James Fox

University of Oxford

London Initiative for Safe AI

&Francesco Belardinelli

Imperial College London

&Tom Everitt

Google DeepMind

###### Abstract

We define _maximum entropy goal-directedness (MEG)_, a formal measure of goal-directedness in causal models and Markov decision processes, and give algorithms for computing it. Measuring goal-directedness is important, as it is a critical element of many concerns about harm from AI. It is also of philosophical interest, as goal-directedness is a key aspect of agency. MEG is based on an adaptation of the maximum causal entropy framework used in inverse reinforcement learning. It can measure goal-directedness with respect to a known utility function, a hypothesis class of utility functions, or a set of random variables. We prove that MEG satisfies several desiderata and demonstrate our algorithms with small-scale experiments 1.

## 1 Introduction

In order to build more useful AI systems, a natural inclination is to try to make them more _agentic_. But while agents built from language models are touted as the next big advance , agentive systems have been identified as a potential source of individual , systemic , and catastrophic  risks. Agency is thus a key focus of behavioural evaluations  and governance . Some prominent researchers have even called for a shift towards designing explicitly non-agentic systems .

A critical aspect of agency is the ability to pursue goals. Indeed, the _standard theory of agency_ defines agency as the capacity for intentional action - action that can be explained in terms of mental states such as goals . But when are we justified in ascribing such mental states? According to Daniel Dennett's instrumentalist philosophy of mind , we are justified when doing so is useful for predicting a system's behaviour.

This paper's key contribution is a method for formally measuring goal-directedness based on Dennett's idea. Since pursuing goals is about having a particular causal effect on the environment2, defining our measure in a causal model is natural. Causal models are general enough to encompass most frameworks popular among ML practitioners, such as single-decision prediction, classification, and regression tasks, as well as multi-decision (partially observable) Markov decision processes. They also offer enough structure to usefully model many ethics and safety problems .

Maximum entropy goal-directedness (MEG) operationalises goal-directedness as follows, illustrated by the subsequent running example.

A variable \(D\) in a causal model is _goal-directed_ with respect to a utility function \(\) to the extent that the conditional probability distribution of \(D\) is well-predicted by the hypothesis that \(D\) is optimising \(\).

**Example 1**.: A mouse begins at the centre of a gridworld (Figure 0(a)). It observes that a block of cheese is located either to the right or left (\(S\)) with equal probability, proceeds either away from it or towards it (\(D\)), and thus either obtains the cheese or does not (\(T\)).

Suppose that the mouse moves left when the cheese is to the left and right when it is to the right, thus consistently obtaining the cheese. Intuitively, this behaviour seems goal-directed, but can we quantify how much? Figure 1 gives an overview of our procedure. We first model the system of interest as a causal Bayesian network (Figure 0(b)) with variables \(S\) for the cheese's position, \(D\) for the mouse's movement, and \(T\) for whether or not the mouse obtains the cheese. Then, we identify a candidate decision variable \(D\) and target variable \(T\), hypothesising that the mouse optimises a utility function that depends on \(T\) (Figure 0(c)). Finally, we form a model of what behaviour we should expect from \(D\) if it is indeed optimising \(U\) and then measure how well this model predicts \(D\)'s observed behaviour (Figure 0(d)).

Ziebart (2010)'s maximum causal entropy (MCE) framework suggests a promising way to construct a model for expected behaviour under a given utility function. However, there are several obstacles to applying it to our problem: it cannot measure the predictive usefulness of _known_ utility functions, and it only finds the most predictive _linear_ utility function. In practice, arbitrary known utility functions can be plugged in, but the results are _not scale-invariant_. We overcome these difficulties by returning to first principles and deriving an updated version of the MCE framework.

In summary, our contributions are four-fold. We (i) adapt the MCE framework to derive _maximum entropy goal-directedness_ (MEG), a philosophically-motivated measure of goal-directedness with respect to known utility functions, and show that it satisfies several key desiderata (Section 3); (ii) we extend MEG to measure goal-directedness in cases without a known utility function (Section 4); (iii) we provide algorithms for measuring MEG in MDPs (Section 5); and (iv) we demonstrate the algorithms empirically (Section 6).

Related Work.Inverse reinforcement learning (IRL) (Ng and Russell, 2000) focuses on the question of _which_ goal a system is optimising, whilst we are interested in _to what extent_ the system can be seen as optimising a goal. We are not the first to ask this question. Some works take a Bayesian approach inspired by Dennett's intentional stance.3 Most closely related to our work is Orseau et al. (2018), which applies Bayesian IRL in POMDPs using a Solomonoff prior over utility functions and an \(\)-greedy model of behaviour. This lets them infer a posterior probability distribution over whether an observed system is a (goal-directed) "agent" or "just a device". Our approach distinguishes itself from these by considering arbitrary variables in a causal model and deriving our behaviour model from the principle of maximum entropy. Moreover, since our algorithms can take advantage of differentiable classes of utility functions, our approach may be amenable to scaling up using deep neural networks. Oesterheld (2016) combines the intentional stance with Bayes' theorem in cellular automata, but does not consider specific models of behaviour. Like us, Kenton et al. (2023) consider goal-directedness in

Figure 1: Computing maximum entropy goal-directedness (MEG).

a causal graph. However, they require variables to be manually labelled as _mechanisms_ or _object-level_, and only provide a binary distinction between agentic and non-agentic systems (see Appendix A for a detailed comparison). Biehl and Virgo (2022); Virgo et al. (2021) propose a definition of agency in Moore machines based on whether a system's internal state can be interpreted as beliefs about the hidden states of a POMDP.

## 2 Background

We use capital letters for random variables \(V\), write \((V)\) for their domain (assumed finite), and use lowercase for outcomes \(v(V)\). Boldface denotes sets of variables \(=\{V_{1},,V_{n}\}\), and their outcomes \(()=_{i}(V_{i})\). Parents and descendants of \(V\) in a graph are denoted by \(_{V}\) and \(_{V}\), respectively (where \(_{V}\) and \(_{V}\) are their instantiations).

Causal Bayesian networks (CBNs) are a class of probabilistic graphical models used to represent causal relationships between random variables (Pearl, 2009).

**Definition 2.1** (Causal Bayesian network).: A _Bayesian network_\(M=(G,P)\) over a set of variables \(=\{V_{1},,V_{n}\}\) consists of a joint probability distribution \(P\) which factors according to a directed acyclic graph (DAG) \(G\), i.e., \(P(V_{1},,V_{n})=_{i=1}^{n}P(V_{i}_{V_{i}})\), where \(_{V_{i}}\) are the parents of \(V_{i}\) in \(G\). A Bayesian network is _causal_ if its edges represent direct causal relationships, or formally if the result of an intervention \((=)\) for any \(\) can be computed using the _truncated factorisation formula_: \(P((=))=_{i:v_{i}}P(v_{ i}_{v_{i}})\) if \(\) is consistent with \(\) or \(P((=x))=0\) otherwise.

Figure 0(b) depicts Example 1 as a CBN, showing the causal relationships between the location of the cheese (\(S\)), the mouse's behavioural response (\(D\)), and whether the mouse obtains the cheese (\(T\)).

We are interested in to what extent a set of random variables in a CBN can be seen as goal-directed. That is, to what extent can we interpret them as _decisions_ optimising a _utility function_? In other words, we are interested in moving from a CBN to a causal influence diagram (CID), a type of probabilistic graphical model that explicitly identifies decision and utility variables.

**Definition 2.2** (Causal Influence Diagram (Everitt et al., 2021)).: A _causal influence diagram_ (CID) \(M=(G,P)\) is a CBN where the variables \(\) are partitioned into decision \(\), chance \(\), and utility variables \(\). Instead of a full joint distribution over \(\), \(P\) consists of conditional probability distributions (CPDs) for each _non-decision_ variable \(V\).

A CID can be combined with a _policy_\(\), which specifies a CPD \(_{D}\) for each decision variable \(D\), in order to obtain a full joint distribution. We call the sum of the utility variables the _utility function_ and denote it \(=_{U}U\). Policies are evaluated by their total expected utility \(_{}[]\). We write \(^{}\) for the uniformly random policy.

CIDs can model a broad class of decision problems, including Markov decision processes (MDPs) and partially observable Markov decision processes (POMDPs) (Everitt et al., 2021).

**Example 2** (POMDP).: A mouse begins at the centre of the grid, with a block of cheese located either at the far left or the far right (Figure 2). The mouse does not know its position or the position of the cheese (\(S_{1}\)) but can smell which direction the cheese is in (\(O_{1}\)) and decide which way to move (\(D_{1}\)). Next step, the mouse again smells the direction of the cheese (\(O_{2}\)) and again chooses which way to proceed (\(D_{2}\)).

## 3 Measuring goal-directedness with respect to a known utility function

Maximum Entropy Goal-directedness.Dennett's instrumentalist approach to agency says that we can ascribe mental states (such as utilities) to a system to the extent that doing so is useful for predicting its behaviour (Dennett, 1989). To operationalise this, we need a model of what behaviour is predicted by a utility function. According to the _principle of maximum entropy_(Jaynes, 1957), we should choose a probability distribution with the highest entropy distribution satisfying our requirements, thus minimising unnecessary assumptions (following Occam's razor). We can measure the entropy of a policy by the expected entropy of its decision variables conditional on their parents \(H_{}(_{D})=-_{D}_{d, _{D} P_{}}_{D}(d_{D})\). This is Ziebart et al. (2010)'s _causal entropy_, which we usually refer to as just the entropy of \(\).

In our setting, the relevant constraint is expected utility. To avoid assuming that only optimal agents are goal-directed, we construct a set of models of behaviour which covers all levels of competence an agent optimising utility \(\) could have. We define the set of _attainable expected utilities_ in a CID as \(()=\{u( _{}[]=u)\}\).

**Definition 3.1** (Maximum entropy policy set, known utility function).: Let \(M=(G,P)\) be a CID with decision variables \(\) and utility function \(\). The _maximum entropy policy set for \(u()\)_ is \(^{}_{,u}*{argmax}_{ _{}[]=u}H_{}(_{D})\). The _maximum entropy policy set for \(\)_ is the set of maximum entropy policies for _any_ attainable expected utility \(^{}_{}_{u( )}^{}_{,u}\).

For each attainable expected utility, \(^{}_{}\) contains the highest entropy policy which attains it. In MDPs, this policy is unique \(^{}_{,u}\) and can be found with backwards induction (see Section 5).

We measure predictive accuracy using cross-entropy, as is common in ML. We subtract the predictive accuracy of the uniform distribution, so that we measure predictive accuracy relative to random chance. This makes MEG always non-negative.

**Definition 3.2** (Maximum entropy goal-directedness, known utility function).: Let \(M(G,P)\) be a CID with decision variables \(\) and utility function \(\). The _maximum entropy goal-directedness_ (MEG) of a policy \(\) with respect to \(\) is

\[_{}()_{^{} ^{}_{}}_{}[_{D} (^{}(D_{D})-(D)|})].\] (1)

As we will see, in a Markov Decision Process, this is equivalent to maximising predictive accuracy by varying the rationality parameter \(\) in the'soft-optimal' policy \(^{}_{}\) used in maximum entropy reinforcement learning .4

If instead of having access to a policy \(\), we have access to a set of full trajectories \(\{(^{i}_{D_{1}},D^{i}_{1},,_{D^{i}_{n}},D^{i}_{n}) \}_{i}\), the expectation \(_{}\) in Equation (1) can be replaced with an average over the trajectory set. This is an unbiased and consistent estimate of \(_{}()\) for the policy \(\) generating the trajectories.

Example.Consider a policy \(\) in Example 1 that proceeds towards the cheese with probability \(0.8\). How goal-directed is this policy with respect to the utility function \(\) that gives \(+1\) for obtaining the cheese and \(-1\) otherwise?

To compute \(_{}()\), we first find the maximum entropy policy set \(^{}_{}\), and then take the maximum predictive accuracy with respect to \(\). In a single-decision setting, for each attainable expected utility \(u\) there is a unique \(^{}_{,u}\) which has the form of a Boltzmann policy \(^{}_{,u}(d s)=[ U|d,s])}{_{d^{}}([U|d^{},s])}\) (cf. Theorem 5.1). The rationality parameter \(=(u)\) can be varied to get the correct expected utility. Predictive accuracy with respect to \(\) is maximised by \(^{}_{,0.8}\), which has a rationality parameter of \(= 2\). The expected logprob of a prediction of this policy is

Figure 2: Sequential multi-decision mouse example.

\(_{}[_{,0.8}^{}(D_{D} )]=-0.50\), while the expected logprob of a uniform prediction is \(()=-0.69\). So we get that \(_{}()=-0.50-(-0.69)=0.19\). For comparison, predictive accuracy for the optimal policy \(^{*}\) is maximised when \(=\), and has \(_{}(^{*})=0-(-0.69)=0.69\).

Properties.We now show that MEG satisfies three important desiderata. First, since utility functions are usually only defined up to translation and rescaling, a measure of goal-directedness with respect to a utility function should be translation and scale invariant. MEG satisfies this property:

**Proposition 3.1** (Translation and scale invariance).: _Let \(M_{1}\) be a CID with utility function \(_{1}\), and let \(M_{2}\) be an identical CID but with utility function \(_{2}=a_{1}+b\), for some \(a,b\), with \(a 0\). Then for any policy \(\), \(_{_{1}}()=_{_{2 }}()\)._

Second, goal-directedness should be minimal when actions are chosen completely at random and maximal when uniquely optimal actions are chosen.

**Proposition 3.2** (Bounds).: _Let \(M\) be a CID with utility function \(\). Then for any policy \(\) we have \(0_{}()_{D}(| (D)|)\), with equality in the lower bound if \(\) is the uniform policy, and equality in the upper bound if \(\) is the unique optimal (or anti-optimal) policy with respect to \(\)._

Note that MEG has a natural interpretation as the amount of evidence provided for a goal-directed policy over a purely random policy. The larger a decision problem, the more opportunity there is to see this evidence, so the higher MEG can be.

Third, a system can never be goal-directed towards a utility function it cannot affect.

**Proposition 3.3** (No goal-directedness without causal influence).: _Let \(M=(G,P)\) be a CID with utility function \(\) and decision variables \(\) such that, \(()_{}=\). Then \(_{}()=0\)._

Comparison to MCE IRLOur method is closely related to MCE IR (Ziebart et al., 2010) (see Gleave and Toyer (2022) for a useful primer). In this subsection, we discuss the key similarities and differences.

The MCE IRL method seeks to find a utility function that explains the policy \(\). It starts by identifying a set of \(n\) linear features \(f_{i}\) and seeks a model policy that imitates \(\) as far as these features are concerned but otherwise is as random as possible. It thus applies the principle of maximum entropy with \(n\) linear constraints. The form of the model policy involves a weighted sum of these features. In a single-decision example, it takes the form

\[^{}(d s)=[_{i}w_{i}f_{i}  d,s])}{_{d^{}}([w_{i}f_{i}  d^{},s])}.\] (2)

The weights \(w_{i}\) are interpreted as a utility function over the features \(f_{i}\). MCE IRL can, therefore, only return a linear utility function.

In contrast, our method seeks to measure the goal-directedness of \(\) with respect to an arbitrary utility function \(\), linear or otherwise. Rather than constructing a single maximum entropy policy with \(n\) linear constraints, we construct a class of maximum entropy policies, each with a different single constraint on the expected utility.

A naive alternative to defining the goal-directedness of \(\) with respect to \(\) as the maximum predictive accuracy across \(\)'s maximum policy set, we could simply plug in our utility function \(\) to \(^{}\) from Equation (2), and use that to measure predictive accuracy. If \(\) is linear in the features \(f_{i}\), we could substitute in the appropriate weights, but even if not, we could still replace \(_{i}w_{i}f_{i}\) with \(\). Indeed, this is often done with nonlinear utility functions in _deep_ MCE IRL (Wulfmeier et al., 2015).

However, this would not have a formal justification, and we would run into a problem: scale non-invariance. Plugging in \(2\) would result in a more sharply peaked \(^{}\) than \(\); in Example 1, we would get that the mouse is more goal-directed towards \(2\) than \(\), with a predictive accuracy (measured by negative cross-entropy) of -0.018 vs -0.13. In contrast, constructing separate maximum entropy policies for each expected utility automatically handles this issue. The policy in \(^{}_{2}\) which maximises predictive accuracy for \(\) has an inversely scaled rationality parameter \(^{}=\) compared to the maximally predictive policy in \(^{}_{2}\). In other words, they are the same policy, and we get that \(_{}()=_{2}( )=0.19\) (cf. Proposition 3.1).

Measuring goal-directedness without a known utility function

In many cases where we want to apply MEG, we may not know exactly what utility function the system could be optimising. For example, we might suspect that a content recommender is trying to influence a user's preferences, but may not have a clear hypothesis as to in what way. Therefore, in this section, we extend our definitions for measuring goal-directedness to the case where the utility function is unknown.

We first extend CIDs to include multiple possible utility functions.

**Definition 4.1**.: A _parametric-utility CID_ (CID) \(M^{}\) is a set of CIDs \(\{M^{}\}\) which differ only in the CPDs of their utility variables.

In effect, a parametric CID is a CID with a parametric class of utility functions \(^{}\).

The maximum entropy policy set from Definition 3.1 is extended accordingly to include maximum entropy policies _for each utility function_ and each attainable expected utility with respect to it.

**Definition 4.2** (Maximum entropy policy set, unknown utility function).: Let \(M^{}=(G,P)\) be a parametric-utility CID with decision variables \(\) and utility function \(^{}\). The _maximum entropy policy set for \(^{}\)_ is the set of maximum entropy policies for any attainable expected utility for any utility function in the class: \(^{}_{^{}}_{,u (^{})}^{}_{^{ },u}\).

**Definition 4.3** (Meg, unknown utility function).: Let \(M^{}=(G,P)\) be a parametric-utility CID with decision variables \(\) and utility function \(^{}\). The _maximum entropy goal-directedness_ of a policy \(\) with respect to \(^{}\) is \(_{^{}}()=_{^{}}_{}()\).

**Definition 4.4** (Meg, target variables).: Let \(M=(G,P)\) be a CBN with variables \(\). Let \(\) be a hypothesised set of decision variables and \( V\) be a hypothesised set of _target_ variables. The _maximum entropy goal-directedness_ of \(\) with respect to \(\), \(_{}()\), is the goal-directedness of \(=P(_{D})\) in the parametric CID with decisions \(\) and utility functions \(:()\) (i.e., the set of all utility functions over \(T\)).

For example, if we only suspected that the mouse in Example 1 was optimising some function of the cheese \(T\), but didn't know which one, we could apply Definition 4.4 to consider the goal-directedness towards \(T\) under any utility function defined on \(T\). Thanks to translation and scale invariance (Proposition 3.1), there are effectively only three utility functions to consider: those that provide higher utility to cheese than not cheese, those that do the opposite, and those that are indifferent.

Note that \(\) has to include some descendants of \(\), in order to enable positive MEG (Proposition 3.3). However, it is not necessary that \(\) consists of _only_ descendants of \(\) (i.e., \(\) need not be a subset of \(()\)). For example, goal-conditional agents take an instruction as part of their input \(_{D}\). The goal-directedness of such agents can only be fully appreciated by including the instruction in \(\).

Pseudo-terminal goals.Definition 4.4 enable us to state a result about a special kind of instrumental goal. It is well known that an agent that optimises some variable has an instrumental incentive to control any variables which mediate between the two . However, since the agent might want the mediators to take different values in different circumstances, it need not appear goal-directed with respect to the mediators. Theorem 4.1 shows that in the special case where the mediators _d-separate_ the decision from the downstream variable, the decision appears at least as goal-directed with respect to the mediators as with respect to the target.

**Theorem 4.1** (Pseudo-terminal goals).: _Let \(M=((,),P)\) be a CBN. Let \(,,\) such that \(\). Then \(_{}()_{}()\)._

For example, in Figure 2, the agent must be at least as goal-directed towards \(S_{3}\) as it is towards \(U_{3}\), since \(S_{3}\) blocks all paths (i.e. d-separates) from \(\{D_{1},D_{2}\}\) to \(U_{3}\).

Intuitively, this comes about because, in such cases, a rational agent wants the mediators to take the same values regardless of circumstances, making the instrumental control incentive indistinguishable from a terminal goal. This means we do not have to look arbitrarily far into the future to find evidence of goal-directedness. An agent that is goal-directed with respect to next week must also be goal-directed with respect to tomorrow.

Computing MEG in Markov Decision Processes

In this section, we give algorithms for computing MEG in MDPs. First, we define what an MDP looks like as a CID. We then establish that soft value iteration can be used to construct our maximum entropy policies, and give algorithms for computing MEG when the utility function is known or unknown.

Note that in order to run these algorithms, we do not need an explicit causal model, and so we do not have to worry about hidden confounders. We do, however, need black-box access to the environment dynamics, i.e., the ability to run different policies in the environment and measure whatever variables we are considering utility functions over.

**Definition 5.1**.: A _Markov Decision Process_ (MDP) is a CID with variables \(\{S_{t},D_{t},U_{t}\}_{t=1}^{n}\), decisions \(=\{D_{t}\}_{t=1}^{n}\) and utilities \(=\{U_{t}\}_{t=1}^{n}\), such that for \(t\) between 1 and \(n\), \(_{D_{t}}=\{S_{t}\}\), \(_{U_{t}}=\{S_{t}\}\), while \(_{S_{t}}=\{S_{t-1},D_{t-1}\}\) for \(t>1\), and \(_{S_{1}}=\).

Constructing Maximum Entropy PoliciesIn MDPs, Ziebart's soft value iteration algorithm can be used to construct maximum entropy policies satisfying a set of linear constraints. We apply it to construct maximum entropy policies satisfying expected utility constraints.

**Definition 5.2** (Soft Q-Function).: Let \(M=(G,P)\) be an MDP. Let \(\{0\}\). For each \(D_{t}\) we define the _soft Q-function_\(Q_{,n}^{}:(D_{t})( _{D_{t}})\) via the recursion:

\[Q_{,n}^{}(d_{n}_{n}) =[U_{t}+(  Q_{,t+1}^{}(_{D_{t+1}}))| d_{t},_{t+1}]t<n,\] \[Q_{,n}^{}(d_{n}_{n}) =[U_{n} d_{n},_{n}],\]

where \((Q_{,t+1}^{}(_{D_{t+1}}))=_{d_{t+1}(D_{t+1})}( Q_{ ,t+1}^{}(d_{t+1}_{D_{t+1}}))\).

Using the soft Q-function, we show that there is a unique \(^{}_{,u}\) for each \(\) and \(u\) in MDPs.

**Theorem 5.1** (Maximum entropy policy in MDPs).: _Let \(M=(G,P)\) be an MDP with utility function \(\), and let \(u()\) be an attainable expected utility. Then there exists a unique maximum entropy policy \(^{}_{u}^{}_{,u}\), and it has the form_

\[^{}_{u,t}(d_{t}_{t})=^{}_{,t }(d_{t}_{t})^{}(d_{t}_{t}))}{_{d^{} (D_{t})}( Q_{,t}^{}(d_{t}^{ }_{t}))},& 0\\ ^{}(d_{t}_{t}),&=0.\] (3)

_where \(=_{^{}\{,- \}}_{t}_{}[(^{}_{^{},t}(d _{t}_{t}))]\)._

We refer to a policy of the form of \(_{}\) as a soft-optimal policy with a rationality parameter of \(\).

Known Utility FunctionTo apply Definition 3.1 to measure the goal-directedness of a policy \(\) in a CID \(M\) with respect to a utility function \(\), we need to find the maximum entropy policy in \(^{}_{}\) which best predicts \(\). We can use Theorem 5.1 to derive an algorithm that finds \(^{}_{u}\) for any \(u()\).

Fortunately, we do not need to consider each policy in \(^{}_{,u}\) individually. We know the form of \(^{}_{u}\), and only the real-valued rationality parameter \(\) varies depending on \(u\).

The gradient of the predictive accuracy with respect to \(\) is

\[_{}_{}[_{D}(^{}_{}(D_{})-(D)})]=_{}[]-_{^{ }_{}}[].\]

The predictive accuracy is a concave function of \(\), so we can apply gradient ascent to find the global maximum in \(\), which is the same as finding the maximum in \(u\).

\(_{}()\) can therefore be found by alternating between applying the soft value iteration of Definition 5.2 to find \(^{}_{}\), computing \(_{}[]-_{^{}_{ }}[]\), and taking a gradient step. See Algorithm 1.

If the \(\) that maximises predictive accuracy is \(\) or \(-\), which can happen if \(\) is optimal or anti-optimal with respect to \(\), then the algorithm can never reach the (nonetheless finite) value of \(_{}()\), but will still converge in the limit.

Unknown-utility algorithmTo find unknown-utility MEG, we consider soft-optimal policies for various utility functions \(\) and maximise predictive accuracy with respect to \(\) as well as \(\). Let \(^{}\) be a differentiable class of functions, such as a neural network, and write \(^{}_{,}\) for a soft-optimal policy with respect to \(^{}\), and \(Q^{}_{,}\) for the corresponding soft Q-function. We can take the derivative of the predictive accuracy with respect to \(\) and get \(_{}[_{}]-_{^{ }_{}}[_{}]\). Algorithm 2 extends Algorithm 1 to this case.

```
0:
0: Parametric MDP \(M_{}\) over differentiable class of utility functions, policy \(\)
0:\(_{_{}}()\)
1: Initialise utility parameter \(\), rationality parameter \(\), set learning rate \(\).
2:repeat
3: Apply soft value iteration to find \(Q^{}_{,}\)\(\) Definition 5.2
4:\(^{}_{,}( Q^{}_{,})\)
5:\(g_{}(_{}[^{}]- _{^{}_{}}[^{}])\)
6:\(g_{}(_{}[_{}^{ }]-_{^{}_{}}[_{} ^{}])\)
7:\(+ g_{}\)
8:\(+ g_{}\)
9:until Stopping condition
10:return\(_{}[_{D}(^{}_{, }(D_{D})-(D)|})]\) ```

**Algorithm 2** Unknown-utility MEG in MDPs

An important caveat is that if \(^{}\) is a non-convex function of \(\) (e.g. a neural network), Algorithm 2 need not converge to a global maximum. In general, the algorithm provides a _lower bound_ for \(_{_{}}()\), and hence for \(_{}()\) where \(=_{^{}}\). In practice, we may want to estimate the soft Q-function and expected utilities with Monte Carlo or variational methods, in which case the algorithm provides an _approximate_ lower bound on goal-directedness.

## 6 Experimental Evaluation

We carried out two experiments5 to measure known-utility MEG with respect to the environment reward function and unknown-utility MEG with respect to a hypothesis class of utility functions. We used an MLP with a single hidden layer of size 256 to define a utility function over states.

Our experiments measured MEG for various policies in the CliffWorld environment from the seals suite (Gleave et al., 2020). Cliffworld (Figure 2(a)) is a 4x10 gridworld MDP in which the agent starts in the top left corner and aims to reach the top right while avoiding the cliff along the top row. With probability \(0.3\), wind causes the agent to move upwards by one more square than intended. The environment reward function gives \(+10\) when the agent is in the (yellow) goal square, \(-10\) for the (dark blue) cliff squares, and \(-1\) elsewhere. The dotted yellow line indicates a length 3 goal region.

MEG vs Optimality of policyIn our first experiment, we measured the goal-directedness of policies of varying degrees of optimality by considering \(\)-greedy policies for \(\) in the range \(0.1\) to \(0.9\). Figure 2(b) shows known- and unknown utility MEG for each policy.6 Predictably, the goal-directedness with respect to the environment reward decreased toward \(0\) as the policy became less optimal. So did unknown-utility MEG - since, as \(\) increases, the policy becomes increasingly uniform, it does not appear goal-directed with respect to _any_ utility function over states.

MEG vs Task difficultyIn our second experiment, we measured the goal-directedness of optimal policies for reward functions of varying difficulty. We extended the goal region of Cliffworld to run for either 1, 2, 3 or 4 squares along the top row and back column and considered optimal policies for each reward function. Figure 2(c) shows Cliffworld with a goal region of length 3. Figure 2(b) shows the results. Goal-directedness with respect to the true reward function decreased as the task became easier to complete. A way to interpret this is that as the number of policies which do well on a reward function increases, doing well on that reward function provides less and less evidence for deliberate optimisation. In contrast, unknown-utility MEG stays high even as the environment reward becomes easier to satisfy. This is because the optimal policy proceeds towards the _nearest_ goal-squares and, hence, it appears strongly goal-directed with respect to a utility function which gives high reward to only those squares. Since this narrower utility function is more difficult to do well on than the environment reward function, doing well on it provides more evidence for goal-directedness. In Appendix D.3, we visualise the policies in question to make this more explicit. We also give tables of results for both experiments.

## 7 Limitations

Environment AccessAlthough computing MEG does not require an explicit causal model (cf. Section 5), it does require the ability to run various policies in the environment of interest - we cannot compute MEG purely from observational data.

IntractabilityWhile MEG can be computed with gradient descent, doing so may well be computationally intractable in high dimensional settings. In this paper, we conduct only preliminary experiments - larger experiments based on real-world data may explore how serious these limitations are in practice.

Choice of variablesMEG is highly dependent on which variables we choose to measure goal-directedness with respect to. At one extreme, all (deterministic) policies have maximal goal

Figure 3: (a) The CliffWorld environment. (b) MEG of \(\)-greedy policies for varying \(\). MEG decreases as the policy gets less optimal. (c) MEG for optimal policies for various reward functions. Known-utility MEG decreases as the goal gets easier to satisfy, but unknown-utility MEG stays higher because the optimal policies also do well with respect to a narrower goal.

directedness with respect to their own actions (given an expressive enough class of utility functions). This means that, for example, it would not be very insightful to compute the goal-directedness of a language model with respect to the text it outputs 7. At the other extreme, if a policy is highly goal-directed towards some variable \(T\) that we do not think to measure, MEG may be misleadingly low. Relatedly, MEG may also be affected by whether we use a binary variable for \(T\) (or the decisions \(D\)) rather than a fine-grained one with many possible outcomes. We should, therefore, think of MEG as measuring what _evidence_ a set of variables provides about a policy's goal-directedness. A lack of evidence does not necessarily mean a lack of goal-directedness.

Distributional shiftsMEG measures how predictive a utility function is of a system's behaviour _on distribution_, and distributional shifts can lead to changes in MEG. A consequence of this is that two almost identical policies can be given arbitrarily different goal-directedness scores, for example, if they take different actions in the start state of an MDP and thus spend time in different regions of the state space. It may be that by considering changes to a system's behaviour under interventions, as Kenton et al. (2023) do, we can distinguish "true" goals from spurious goals, where the former predict behaviour well across distributional shifts, while the latter happen to predict behaviour well on a particular distribution (perhaps because they correlate with true goals) (Di Langosco et al., 2022). We leave this to future work.

Behavioural vs mechanistic approachesThe latter two points suggest that mechanistic approaches to understanding a system's goal-directedness could have advantages over behavioural approaches like MEG. For example, suppose we could reverse engineer the algorithms learned by a neural network. In that case, it may be possible to infer which variables the system is goal-directed with respect to and do so in a way which is robust to distributional shifts. However, mechanistic interpretability of neural networks (Elhage et al., 2021) is an ambitious research agenda that is still in its infancy, and for now, behavioural approaches appear more tractable.

Societal implicationsAn empirical measure of goal-directedness could enable researchers and companies to keep better track of how goal-directed LLMs and other systems are. This is important for dangerous capability evaluations (Shevlane et al., 2023; Phuong et al., 2024) and governance (Shavit et al., 2023). A potential downside is that it could enable bad actors to create more dangerous systems by optimising for goal-directedness. We judge that this does not contribute much additional risk, given that bad actors can already optimise a system to pursue actively harmful goals.

## 8 Conclusion

We proposed maximum entropy goal-directedness (MEG), a formal measure of goal-directedness in CIDs and CBNs, grounded in the philosophical literature and the maximum causal entropy principle. Developing such measures is important because many risks associated with advanced artificial intelligence come from goal-directed behaviour. We proved that MEG satisfies several key desiderata, including scale invariance and being zero with respect to variables that can't be influenced, and that it gives insights about instrumental goals. On the practical side, we adapted algorithms from the maximum causal entropy framework for inverse reinforcement learning to measure goal-directedness with respect to nonlinear utility functions in MDPs. The algorithms handle both a single utility function and a differentiable class of utility functions. The algorithms were used in some small-scale experiments measuring the goal-directedness of various policies in MDPs. In future work, we plan to develop MEG's practical applications further. In particular, we hope to apply MEG to neural network interpretability by measuring the goal-directedness of a neural network agent with respect to a hypothesis class of utility functions taking the network's hidden states as input, thus taking more than just the system's behaviour into account.

Acknowledgements

The authors would like to thank Ryan Carey, David Hyland, Laurent Orseau, Francis Rhys Ward, and several anonymous reviewers for useful feedback. This research is supported by the UKRI Centre for Doctoral Training in Safe and Trusted AI (EP/S023356/1), and by the EPSRC grant "An Abstraction-based Technique for Safe Reinforcement Learning" (EP/X015823/1). Fox acknowledges the support of the EPSRC Centre for Doctoral Training in Autonomous Intelligent Machines and Systems (EP/S024050/1).