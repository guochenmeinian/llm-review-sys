# Boosting Weakly-Supervised Referring Image Segmentation via Progressive Comprehension

Zaiquan Yang, Yuhao Liu\({}^{}\), Jiaying Lin, Gerhard Hancke\({}^{}\), Rynson W.H. Lau\({}^{}\)

Department of Computer Science

City University of Hong Kong

{zaiquyang2-c, yuhliu9-c,jiayinlin5-c}@my.cityu.edu.hk

{gp.hancke, Rynson.Lau}@cityu.edu.hk

###### Abstract

This paper explores the weakly-supervised referring image segmentation (WRIS) problem, and focuses on a challenging setup where target localization is learned directly from image-text pairs. We note that the input text description typically already contains detailed information on how to localize the target object, and we also observe that humans often follow a step-by-step comprehension process (_i.e._, progressively utilizing target-related attributes and relations as cues) to identify the target object. Hence, we propose a novel Progressive Comprehension Network (PCNet) to leverage target-related textual cues from the input description for progressively localizing the target object. Specifically, we first use a Large Language Model (LLM) to decompose the input text description into short phrases. These short phrases are taken as target-related cues and fed into a Conditional Referring Module (CRM) in multiple stages, to allow updating the referring text embedding and enhance the response map for target localization in a multi-stage manner. Based on the CRM, we then propose a Region-aware Shrinking (RaS) loss to constrain the visual localization to be conducted progressively in a coarse-to-fine manner across different stages. Finally, we introduce an Instance-aware Disambiguation (IaD) loss to suppress instance localization ambiguity by differentiating overlapping response maps generated by different referring texts on the same image. Extensive experiments show that our method outperforms SOTA methods on three common benchmarks.

+
Footnote †: \({}^{}\) Joint corresponding authors.

## 1 Introduction

Referring Image Segmentation (RIS) aims to segment a target object in an image via a user-specified input text description. RIS has various applications, such as text-based image editing [17; 13; 2] and human-computer interaction [62; 51]. Despite remarkable progress, most existing RIS works [7; 58; 27; 26; 21; 5] rely heavily on pixel-level ground-truth masks to learn visual-linguistic alignment. Recently, there has been a surge in interest in developing weakly-supervised RIS (WRIS) methods via weak supervisions, _e.g._, bounding-boxes , and text descriptions [54; 18; 30; 4], to alleviate burden of data annotations. In this work, we focus on obtaining supervision from text descriptions only.

The relatively weak constraint of utilizing text alone as supervision makes visual-linguistic alignment particularly challenging. There are some attempts [30; 18; 22; 46] to explore various alignment workflows. For example, TRIS  classifies referring texts that describe the target object as positive texts while other texts as negative ones, to model a text-to-image response map for locating potential target objects. SAG  introduces a bottom-up and top-down attention framework to discoverindividual entities and then combine these entities as the target of the referring expression. However, these methods encode the entire referring text as a single language embedding. They can easily overlook some critical cues related to the target object in the text description, leading to localization ambiguity and even errors. For example, in Fig. 1(e), TRIS  erroneously activates all three players due to its use of cross-modality interactions between the image and the complete language embedding only.

We observe that humans typically localize target objects through a step-by-step comprehension process. Cognitive neuroscience studies [48; 41] also support this observation, indicating that humans tend to simplify a complex problem by breaking it down into manageable sub-problems and reasoning them progressively. For example, in Fig. 1(b-d), human perception would first begin with _"a player"_ and identify all three players (b). The focus is then refined by the additional detail _"blue and gray uniform"_, which helps exclude the white player on the left (c). Finally, the action _"catches a ball"_ helps further exclude the person on the right, leaving the correct target person in the middle (d).

Inspired by the human comprehension process, we propose in this paper a novel Progressive Comprehension Network (PCNet) for WRIS. We first employ a Large Language Model (LLM)  to dissect the input text description into multiple short phrases. These decomposed phrases are considered as target-related cues and fed into a novel Conditional Referring Module (CRM), which helps update the global referring embedding and enhance target localization in a multi-stage manner. We also propose a novel Region-aware Shrinking (RaS) loss to facilitate visual localization across different stages at the region level. ReS first separates the target-related response map (indicating the foreground region) from the target-irrelevant response map (indicating the background region), and then constrains the background response map to progressively attenuate, thus enhancing the localization accuracy of the foreground region. Finally, we notice that salient objects in an image can sometimes trigger incorrect response map activation for text descriptions that aim for other target objects. Hence, we introduce an Instance-aware Disambiguation (IaD) loss to reduce the overlapping of the response maps by rectifying the alignment score of different referring texts to the same object.

In summary, our main contributions are as follows :

* We propose the Progressive Comprehension Network (PCNet) for the WRIS task. Inspired by the human comprehension processes, this model achieves visual localization by progressively incorporating target-related textual cues for visual-linguistic alignment.
* Our method has three main technical novelties. First, we propose a Conditional Referring Module (CRM) to model the response maps through multiple stages for localization. Second, we propose a Region-aware Shrinking (RaS) loss to constrain the response maps across different stages for better cross-modal alignment. Third, to rectify overlapping localizations, we propose an Instance-aware Disambiguation (IaD) loss for different referring texts paired with the same image.

Figure 1: Given an image and a language description as inputs (a), RIS aims to predict the target object (d). Unlike existing methods (_e.g._, TRIS  (e) – a WRIS method) that directly utilize the complete language description for target localization, we observe that humans would naturally break down the sentence into several key cues (_e.g._, Q1 – Q3) and progressively converge onto the target object (from (b) to (d). This behavior inspires us to develop the Progressive Comprehension Network (PCNet), which merges text cues pertinent to the target object step-by-step (from (f) to (h)), significantly enhancing visual localization. \(\) denotes the text combination operation.

* We conduct extensive experiments on three popular benchmarks, demonstrating that our method outperforms existing methods by a remarkable margin.

## 2 Related work

**Referring Image Segmentation (RIS)** aims to segment the target object from the input image according to the input natural language expression. Hu _et al_.  proposes the first CNN-based RIS method. There are many follow-up works. Early methods [60; 28; 38] focus on object-level cross-modal alignment between the visual region and the corresponding referring expression. Later, many works explore the use of attention mechanisms [15; 7; 58; 19] or transformer architectures [58; 29] to model long-range dependencies, which can facilitate pixel-level cross-model alignment. For example, CMPC  employs a two-stage progressive comprehension model to first perceive all relevant instances through entity wording and then use relational wording to highlight the referent. In contrast, our approach leverages LLMs to decompose text descriptions into short phrases related to the target object, focusing on sentence-level (rather than word-level) comprehension, which aligns more closely with human cognition. Focusing on the visual grounding, DGA  also adopts multi-stage refinement. It aims to model visual reasoning on top of the relationships among the objects in the image. Differently, our work addresses the weakly RIS task and aims to alleviate the localization ambiguity by progressively integrating fine-grained attribute cues.

**Weakly-supervised RIS (WRIS)** has recently begun to attract some attention, as it can substantially reduce the burden of data labeling especially on the segmentation field [25; 57; 63]. Feng _et al_.  proposes the first WRIS method, which uses bounding boxes for annotations. Several subsequent works [18; 22; 30] attempt to use weaker supervision signal, _i.e_., text descriptions. SAG  proposes to first divide image features into individual entities via bottom-up attention and then employ top-down attention to learn relations for combining entities. Lee _et al_.  generate Grad-CAM for each word of the description and then consider the relations using an intra-chunk and inter-chunk consistency. Instead of merging individual responses, TRIS  directly learns the text-to-image response map by contrasting target-related positive and target-unrelated negative texts. Inspired by the generalization capabilities of segmentation foundation models [20; 8; 34], PPT  enables effective integration with pre-trained language-image models [43; 33] and SAM  by a lightweight point generator to identify the referent and context noise. Despite their success, these methods encode the full text as a single embedding for cross-modality alignment, which overlooks target-related nuances in the textual descriptions. In contrast, our method proposes to combine progressive text comprehension and object-centric visual localization to obtain better fine-grained cross-modal alignment.

**Large Language Models (LLMs)** are revolutionizing various visual domains, benefited by their user-friendly interfaces and strong zero-shot prompting capabilities [3; 49; 1; 47]. Building on this trend, recent works [42; 55; 53; 64; 45] explore the integration of LLMs into vision tasks (_e.g_., language-guided segmentation [55; 53], relation , and image classification ) through parameter-efficient fine-tuning or knowledge extraction. For example, LISA  and GSVA  utilize LLaVA , a large vision-language model (LVLM), as a feature encoder to extract visual-linguistic cross-modality features and introduce a small set of trainable parameters to prompt SAM  for reasoning segmentation. RECODE  and CuPL  leverage the knowledge in LLMs to generate informative descriptions as prompts for different categories classification. Unlike these works, we capitalize on the prompt capability of LLMs to help decompose a single referring description into multiple target object-related phrases, which are then used in our progressive comprehension process for RIS.

## 3 Our Method

In this work, we observe that when identifying an object based on a description, humans tend to first pinpoint multiple relevant objects and then narrow their focus to the target through step-by-step reasoning [48; 41]. Inspired by this, we propose a Progressive Comprehension Network (PCNet) for WRIS, which enhances cross-modality alignment by progressively integrating target-related text cues at multiple stages. Fig. 2 shows the overall framework of our PCNet.

Given an image \(\) and a referring expression \(\) as input, we first feed \(\) into a Large Language Model (LLM) to break it down into \(K\) short phrases \(_{sub}=\{t_{0},t_{1},\,,t_{K-1}\}\), referred to as target-related text cues. We then feed image \(\) and referring expression \(\) and the set of short phrases \(_{sub}\) into image encoder and text encoder to obtain visual feature \(_{0}^{H W C_{v}}\) and language feature \(_{0}^{1 C_{t}}\), and \(_{sub}=\{_{0}\), \(_{1}\), \(\), \(_{K-1}\}\), with \(_{k}^{1 C_{t}}\), where \(H=H_{I}/s\) and \(W=W_{I}/s\). \(C_{v}\) and \(C_{l}\) denote the numbers of channels of visual and text features. \(s\) is the ratio of down-sampling. We then use projector layers to transform the visual feature \(_{0}\) and textual features \(_{0}\) and \(_{sub}\) to a unified dimension \(C\), _i.e._, \(_{0}^{H W C}\), \(_{0}\) and \(_{i}\) are in \(^{1 C}\).

We design PCNet with multiple consecutive Conditional Referring Modules (CRMs) to progressively locate the target object across \(N\) stages1. Specifically, at stage \(n\), the \(n\)-th CRM updates the referring embedding \(_{n}\) into \(_{n+1}\) conditioned on the short phrase \(q_{n}\) from the proposed Referring Modulation block. Both \(_{n+1}\) and visual embedding \(_{n}\) are fed into Response Map Generation to generate the text-to-image response map \(_{n}\) and updated visual embedding \(_{n+1}\). Finally, the response map \(_{N-1}\) generated by the \(n\)-th CRM is used as the final localization result. To optimize the resulting response map for accurate visual localization, we employ the pre-trained proposal generator to obtain localization-matched mask proposals. We also propose Region-aware Shrinking (RaS) loss to constrain the visual localization in a coarse-to-fine manner, and Instance-aware Disambiguation (IaD) loss to suppress instance localization ambiguity.

In the following subsections, we first discuss how we decompose the input referring expression into target-related cues in Sec. 3.1. We then introduce the CRM in Sec. 3.2. Finally, we present our Region-aware Shrinking loss in Sec. 3.3, and Instance-aware Disambiguation loss in Sec. 3.4.

### Generation of Target-related Cues

Existing works typically encode the entire input referring text description, and can easily overlook some critical cues (_e.g._, attributes and relations) in the description (particularly for a long/complex description), leading to target localization problems. To address this problem, we propose dividing the input description into short phrases to process it individually. To do this, we leverage the strong in-context capability of the LLM  to decompose the text description. We design a prompt, with four parts, to instruct the LLM to do this: (1) general instruction \(_{G}\); (2) output constraints \(_{C}\); (3) in-context task examples \(_{E}\); and (4) input question \(_{Q}\). \(_{G}\) describes the overall instruction, _e.g._"decomposing the referring text into target object-related short phrases". \(_{C}\) elaborates the output setting, _e.g._, sentence length of each short phrase. In \(_{E}\), we specifically curate several in-context pairs as guidance for the LLM to generate analogous outputs. Finally, \(_{Q}\) encapsulates the input text description and the instruction words for the LLM to execute the operation. The process of generating

Figure 2: The pipeline of PCNet. Given a pair of image-text as input, PCNet enhances the visual-linguistic alignment by progressively comprehending the target-related textual nuances in the text description. It starts with using a LLM to decompose the input description into several target-related short phrases as target-related textual cues. The proposed Conditional Referring Module (CRM) then processes these cues to update the linguistic embeddings across multiple stages. Two novel loss functions, Region-aware Shrinking (RaS) and Instance-aware Disambiguation (IaD), are also proposed to supervise the progressive comprehension process.

target-related cues is formulated as:

\[_{sub}=\{t_{0},\,t_{1},\,,\,t_{K-1}\}=(_ {G},_{C},_{E},_{Q})\] (1)

where \(K\) represents the total number of phrases, which varies depending on the input description. Typically, longer descriptions more likely yield more phrases. To maintain consistency in our training dataset, we standardize it to five phrases (_i.e._, \(K=5\)). If fewer than five phrases are produced, we simply duplicate some of the short phrases to obtain five short phrases. In this way, phrases generated by LLM are related to the target object and align closely with our objective.

### Conditional Referring Module (CRM)

Given the decomposed phrases (_i.e._, target-related cues), we propose a CRM to enhance the discriminative ability on the target object region conditioned on these phrases, thereby improving localization accuracy. As shown in Fig. 2, the CRM operates across \(N\) consecutive stages. At each stage, it first utilizes a different target-related cue to modulate the global referring embedding via a referring modulation block and then produces the image-to-text response map through a response map generation block.

**Referring Modulation Block.** Considering the situation at stage \(n\), we first concatenate one target-related cue \(q_{n}\) and the \(L\) negative text cues obtained from other images 2, to form \(_{n}^{}^{(L+1) C}\). We then fuse the visual features \(_{n}\) with \(_{n}^{}\) through a vision-to-text cross-attention, to obtain vision-attended cue features \(}_{n}^{(L+1) C}\), as:

\[_{v t}=((_{n}^{}W_{1}^{q^{ }})(_{n}W_{2}^{V})^{}/)\,;\,\,}_{n}=(_{v t}(_{n}W_{3}^{V}))+ _{n}^{}\] (2)

where \(_{v t}^{(L+1) H W}\) denotes the vision-to-text inter-modality attention weight. \(W_{*}^{Q}\) and \(W_{*}^{^{}}\) are learnable projection layers. \(\) denotes matrix multiplication. Using the vision-attended cue features \(}_{n}\), we then enrich the global textual features \(_{n}\) into cue-enhanced textual features \(_{n+1}^{1 C}\) through another text-to-text cross-attention, as:

\[_{t t}=((_{n}W_{1}^{Q})(}_{n}W_{2}^{})^{}/)\,;\,\,_{n+1}= (_{t t}(}_{n}W_{3}^{}))+ _{n}\] (3)

where \(_{t t}^{1(L+1)}\) represents the text-to-text intra-modality attention weight. \(W_{*}^{Q}\) and \(W_{*}^{}\) are learnable projection layers. In this way, we can enhance the attention of \(_{n}\) on the target object by conditioning its own target-related cue features and the global visual features.

**Response Map Generation.** To compute the response map, we first update the visual features \(_{n}\) to \(}_{n}\) by integrating them with the updated referring text embedding \(_{n+1}\) using a text-to-visual cross-attention, thereby reducing the cross-modality discrepancy. Note that \(}_{n}\) is then used in the next stage (_i.e._, \(_{n+1}=}_{n}\)). The response map \(_{n}^{H W}\) at the \(n\)-th stage is computed as:

\[_{n}=((}_{n} _{n+1}^{}))\] (4)

where Norm normalizes the output in the range of \(\). To achieve global visual-linguistic alignment, we adopt classification loss \(_{}\) in  to optimize the generation of the response map at each stage. It formulates the target localization problem as a classification process to differentiate between positive and negative text expressions. While the referring text expressions for an image are used as positive expressions, the ones from other images can be used as negative for this image. More explanations are given in appendix.

### Region-aware Shrinking (RaS) Loss

Despite modulating the referring attention with the target-related cues stage-by-stage, image-text classification often activates irrelevant background objects due to its reliance on global and coarse response map constraints. Ideally, as the number of target-related cues used increases across each stage, the response map should become more compact and accurate. However, directly constraining the latter stage to have a more compact spatial activation than the former stage can lead to a trivial solution (_i.e._, without target activation). To address this problem, we propose a novel region-aware shrinking (RaS) loss, which segments the response map into foreground (target) and background (non-target) regions. Through contrastive enhancement between these regions, our method gradually reduces the background interference while refining the foreground activation in the response map.

Specifically, at stage \(n\), we first employ a pretrained proposal generator to obtain a set of mask proposals, \(=\{m_{1},\,m_{2},\,,m_{P}\}\), where each proposal \(m_{p}\) is in \(^{H W}\) and \(P\) is the total number of segment proposals. We then compute a alignment score between the response map \(_{n}\) and each proposal \(m_{p}\) in \(\) as:

\[_{n}=\{s_{n,1},\,s_{n,2},\,,\,s_{n,P}\}s_{n,p}=( _{n} m_{p}),\] (5)

where \(\) denotes the hadamard product. The proposal with the highest score (denoted as \(m_{f}\)) is then treated as the target foreground region, while the combination of other proposals (denoted as \(m_{b}\)) is regarded as non-target background regions. With the separated regions, we define a localization ambiguity \(S_{n}^{amb}\), which measures the uncertainty of the target object localization in the current stage \(n\), as:

\[S_{n}^{amb}=1-((_{n},\,m_{f})-( _{n},\,m_{b})),\] (6)

where \(S_{n}^{amb}\) is in the range of \([0,\,1]\), and IoU denotes the intersection over union. When the localization result (_i.e._, the response map) matches the only target object proposal instance exactly, ambiguity is 0. Conversely, if it matches the more background proposals, ambiguity approaches 1.

Assuming that each target in the image corresponds to an instance, by integrating more cues, the model will produce a more compact response map and gradually reduce the ambiguity. Consequently, based on the visual localization results from two consecutive stages, we can formulate the region-aware shrinking objective for a total of \(N\) stages as:

\[_{}=_{n=0}^{N-2}(0,\,(S_{n+ 1}^{amb}-S_{n}^{amb})).\] (7)

By introducing region-wise ambiguity, \(_{}\) can direct non-target regions to converge towards attenuation while maintaining and improving the quality of the response map in the target region. This enables the efficient integration of target-related textual cues for progressively finer cross-modal alignment. Additionally, the mask proposals can also provide a shape prior to the target region, which helps to further enhance the accuracy of the target object localization.

### Instance-aware Disambiguation (IaD) Loss

Although the RaS loss can help improve the localization accuracy by reducing region-wise ambiguity within one single response map, it takes less consideration of the relation between different instance-wise response maps. Particularly, we note that, given different referring descriptions that refer to different objects of an image, there are usually some overlaps among the corresponding response maps. For example, in Fig. 2, the player in the middle is simultaneously activated by two referring expressions (_i.e._, the response maps \(_{*,a}\) and \(_{*,d}\) have overlapping activated regions), resulting in inaccurate localization. To address this problem, we propose an Instance-aware Disambiguation (IaD) loss to help enforce that different regions of the response maps within a stage are activated if the referring descriptions of an image refer to different objects.

Specifically, given a pair of image \(_{a}\) and input text description \(_{a}\), we first sample extra \(N_{d}\) text descriptions, \(_{d}=\{t_{1},\,t_{2},\,,\,t_{N_{d}}\}\), where the referred target object of each text description \(t_{d}\) is in the image \(_{a}\) but is different from the target object referred to by \(_{a}\). We then obtain the image-to-text response maps \(_{a}\) and \(_{d}=\{_{1},\,_{2},\,,\,_{N_{d}}\}\) for \(_{a}\) and \(_{d}\) through Eq. (4). Here, we omit the stage index \(n\) for clarity. Then, based on the Eq. (5), we obtain the alignment scores \(_{a}\) and \(\{_{d}\}_{d=1}^{N_{d}}\) for \(_{a}\) and \(_{d}\). In \(\), the larger the value, the higher the alignment between the corresponding proposal (specified by the index) and the current text. To disambiguate overlapping activated regions, we constrain that the maximum index of the alignment score between \(_{a}\) and each of \(_{d}\) must be different from each other (_i.e._, different texts must activate different objects). Here, we follow  to compute the index vector, \(y^{1 P}\), as:

\[y=(())+-( ),\] (8)where \(()\) represents the stop gradient operation. Finally, we denote the index vectors for \(_{a}\) and \(\{_{d}\}_{d=1}^{N_{d}}\) as \(y_{a}\) and \(\{y_{d}\}_{d=1}^{N_{d}}\), and we formulate the IaD loss as:

\[_{}=}_{d=1}^{N_{d}}(1-||y_{a}-y_{ d}||^{2}).\] (9)

By enforcing the constraint at each stage, the response maps activated by different referring descriptions in an image for different instances are separated, and the comprehension of the discriminative cues is further enhanced.

## 4 Experiments

### Settings

**Dataset.** We have conducted experiments on three standard benchmarks: RefCOCO , RefCOCO+ , and RefCOCOg . They are constructed based on MSCOCO . Specially, the referring expressions in RefCOCO and RefCOCO+ focus more on object positions and appearances, respectively, and they are characterized by succinct descriptions, averaging 3.5 words in length. RefCOCOg contains much longer sentences (average length of 8.4 words), making it more challenging than others. RefCOCOg includes two partitions: UMD  and Google .

**Implementation Details.** We train our framwork for 15 epochs with a batch size of 36 on an RTX4090 GPU. The total loss for training is \(_{}=_{}+_{}+_{}\). By default, we set the number of stages \(N\) to 3, and the number of the additional text descriptions sampled for each image \(N_{d}\) to 1. Without loss of generality, we use FreeSOLO  and SAM  as the proposal generators to obtain two versions: PCNet\({}_{S}\) and PCNet\({}_{F}\). Refer to Sec. A for more implementation details.

    &  &  &  &  &  &  \\  & & & Val & TestA & TestB & Val & TestA & TestB & Val (G) & Val (U) & Test (U) \\   & GroupViT  & GroupViT & ✗ & 25.0 & 26.3 & 24.4 & 25.9 & 26.0 & 26.1 & 30.0 & 30.9 & 31.0 \\  & CLIP-ES  & ViT-Base & ✗ & 41.3 & 50.6 & 30.3 & 46.6 & 56.2 & 33.2 & 49.1 & 46.2 & 45.8 \\  & WWbL  & VGG16 & ✗ & 31.3 & 31.2 & 30.8 & 34.5 & 33.3 & 36.1 & 29.3 & 32.1 & 31.4 \\   & SAG  & ViT-Base & ✗ & 56.2 & 63.3 & 51.0 & 45.5 & 52.4 & 36.5 & 37.3 & – & – \\  & TRIS  & ResNet-50 & ✗ & 51.9 & 60.8 & 43.0 & 40.8 & 40.9 & 41.1 & 52.5 & 51.9 & 53.3 \\  & PCNet\({}_{F}\) & ResNet-50 & ✗ & 59.6 & 66.6 & 48.2 & 54.7 & 65.0 & 44.1 & 57.9 & 57.0 & 57.2 \\  & PCNet\({}_{S}\) & ResNet-50 & ✗ & **60.0** & **69.3** & **52.5** & **58.7** & **65.5** & **45.3** & **58.6** & **57.9** & **57.4** \\   & LAVT\({}^{}\) & Swin-Base & N/A & 72.7 & 75.8 & 68.7 & 65.8 & 70.9 & 59.2 & 63.6 & 63.3 & 63.6 \\   & GroupViT  & GroupViT & ✗ & 18.0 & 18.1 & 19.3 & 18.1 & 17.6 & 19.5 & 19.9 & 19.8 & 20.1 \\   & CLIP-ES  & ViT-Base & ✗ & 13.8 & 15.2 & 12.9 & 14.6 & 16.0 & 13.5 & 14.2 & 13.9 & 14.1 \\   & TSEG  & ViT-Small & ✗ & 25.4 & – & – & 22.0 & – & – & 22.1 & – & – \\   & WWbL  & VGG16 & ✗ & 18.3 & 17.4 & 19.9 & 19.9 & 18.7 & 21.6 & 21.8 & 21.8 & 21.8 \\   & SAG  & ViT-Base & ✗ & **33.4** & 33.5 & **33.7** & 28.4 & 28.6 & **28.0** & 28.8 & – & – \\   & TRIS  & ResNet-50 & ✗ & 25.1 & 26.5 & 23.8 & 22.3 & 21.6 & 22.9 & 26.9 & 26.6 & 27.3 \\   & PCNet\({}_{F}\) & ResNet-50 & ✗ & 30.9 & 35.2 & 26.3 & 28.9 & 31.9 & 26.5 & 29.8 & 29.7 & 30.2 \\   & PCNet\({}_{S}\) & ResNet-50 & ✗ & 31.3 & **36.8** & 26.4 & **29.2** & **32.1** & 26.8 & **30.7** & **30.0** & **30.6** \\   & CLIP  & ResNet-50 & ✗ & 36.0 & 37.9 & 30.6 & 39.2 & 42.7 & 31.6 & 37.5 & 37.4 & 37.8 \\   & SAG  & ViT-Base & ✗ & 44.6 & 50.1 & 38.4 & 35.5 & 41.1 & 27.6 & 23.0 & – & – \\   & TRIS  & ResNet-50 & ✗ & 41.1 & 48.1 & 31.9 & 31.6 & 31.9 & 30.6 & 38.4 & 39.0 & 39.9 \\   & PIT  & ViT-Base & ✗ & 46.8 & 45.3 & **46.3** & 45.3 & 45.8 & 44.8 & 43.0 & – & – \\   & PCNet\({}_{S}\) & ResNet-50 & ✗ & **52.2** & **58.4** & 42.1 & **47.9** & **56.5** & **36.2** & **47.3** & **46.8** & **46.9** \\   & Oracle & ResNet-50 & ✗ & 72.7 & 75.3 & 67.7 & 73.1 & 75.5 & 68.2 & 69.0 & 68.3 & 68.4 \\   

Table 1: Quantitative comparison using mIoU and PointM metrics. “(U)” and “(G)” indicate the UMD and Google partitions. “**Segmentor”** denotes utilizing the pre-trained segmentation models (SAM  by default) for segmentation mask generation. † denotes that the method is fully-supervised. “-” means unavailable values. Oracle represents the evaluation of the best proposal mask based on ground-truth. Best and second-best performances are marked in **bold** and underlined.

**Evaluation Metrics.** We argue that the key to WRIS is target localization, and the performance evaluation should not rely primarily on pixel-wise metrics. With the accurate localization points, pixel-level masks can be readily obtained by prompting the pre-trained segmentors (_e.g._, SAM ). Thus, following [18; 22; 30], we adopt localization-based metric (_i.e._, PointM), and pixel-wise metrics (_i.e._, mean and overall intersection-over-union (mIoU and oIoU) for evaluation. PointM  is used to evaluate the localization accuracy, which computes the ratio of activation peaks in the mask region.

### Comparison with State-of-the-Art Methods

**Quantitative comparison.** Tab. 1 compares our method with various SOTA methods. Specifically, we first compare target localization accuracy using the PointM metric. We evaluate two model variants: PCNet\({}_{F}\) and PCNet\({}_{S}\), which use different segmentors (_e.g._, FreeSOLO  and SAM ) to extract mask proposals for RaS and IaD losses. Even when using FreeSOLO as the proposal generator, our model still significantly outperforms all compared methods. For example, on the most challenging dataset, RefCOCOg, with more complex object relationships and longer texts, PCNet\({}_{F}\) achieves performance improvements of 55.2% and 10.3% on the Val (G) set compared to SAG and TRIS3. PCNet\({}_{S}\) further boosts the performance if we replace FreeSOLO with the stronger SAM.

In addition, we verify the accuracy of the response map through pixel-wise mIoU metric. Results are shown in the middle part of Tab. 1. Our PCNet still achieves superior performances on all benchmarks, against all compared methods. Particularly, PCNet\({}_{F}\) and PCNet\({}_{S}\) outperform TRIS by an improvement of 10.8% and 14.1% mIoU, respectively, on the RefCOCOg Val (G) set. In the bottom part of Tab. 1, we compare the accuracy of the extracted mask proposals generated using the target localization point (_i.e._, the peak point of the response map) to prompt SAM. We can see that our PCNet significantly outperforms other WRIS methods. We can also see that higher PointM values correlate with higher mIoU accuracy values of the corresponding mask proposals for different methods. We further tested the mask accuracy using the Ground-Truth localization point (_i.e._, the last row), and find that its performance even surpasses the fully-supervised method, LAVT . All these results highlight the critical importance of target localization (_i.e._, peak point) for the WRIS task.

In Fig. 3, we show some visual results of our method across different scenes by using the target localization point (_i.e._, the green marker) to prompt SAM to generate the target mask. Our method effectively localizes the target instance among other instances within the image, even in complex scenarios with region occlusion (a), multiple instances (b), similar appearance (c), and dim light (d).

### Ablation Study

We conduct ablation experiments on the RefCOCOg dataset and report the results on the Val (G) set from both PCNet\({}_{S}\) and PCNet\({}_{F}\) in Tab. 2, and from PCNet\({}_{F}\) in Tab. 3, Tab. 4, and Tab. 5.

**Component Analysis.** In Tab. 2, we first construct a single-stage baseline (_1st_ row) to optimize visual-linguistic alignment by removing all proposed components and using only the global image-text classification loss \(_{}\). We then introduce the proposed conditional referring module (CRM) to the baseline to allow for multi-stage progressive comprehension (_2nd_ row). To validate the efficacy of the region-aware shrinking loss (RaS) and instance-aware disambiguation loss (IaD), we introduce them separately (_3rd_ and _4th_ rows). Finally, we combine all proposed components (_5th_ row).

Figure 3: qVisual results of our PCNet. The green markers denote the peaks of the response maps.

[MISSING_PAGE_FAIL:9]

outperforms ADD but is less effective than VTA+ADD, verifying the importance of the vision context. Finally, our CRM combines VTA and TTA and achieves the best results.

**Number of Referring Texts.** In Tab. 5, we analyze the effect of \(N_{d}\) used in \(_{}\). The results show that \(N_{d}=1\) is enough, and the performance deteriorates as \(N_{d}\) increases. This is because an image typically has 2-3 text descriptions, which means \(N_{d}\) should be 1-2. As \(N_{d}\) increases, repeated sampling becomes more frequent, affecting model training and thus leading to poorer results.

## 5 Conclusion

In this paper, we have proposed a novel Progressive Comprehension Network (PCNet) to perfom progressive visual-linguistic alignment for the weakly-supervised referring image segmentation (WRIS) task. PCNet first leverages a LLM to decompose the input referring description into several target-related phrases, which are then used by the proposed Conditional Referring Module (CRM) to update the referring text embedding stage-by-stage, thus enhancing target localization. In addition, we proposed two loss functions, region-aware shrinking loss and instance-aware disambiguation loss, to facilitate comprehension of the target-related cues progressively. We have also conducted extensive experiments on three RIS benchmarks. Results show that the proposed PCNet achieves superior visual localization performances and outperforms existing SOTA WRIS methods by large margins.

Our method does have limitations. For example, as shown in Fig. 5, when the text description refers to multiple objects, our method fails to return all referring regions. This is because our model design always assumes that there is only one object referred to by the language expression. In the future, we plan to incorporate more fine-grained vision priors  and open-world referring descriptions (_e.g._, camouflaged , semi-transparent , shadow  and _etc._) into the model design to enable a more generalized solution.