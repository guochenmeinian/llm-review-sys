# Unraveling Molecular Structure:

A Multimodal Spectroscopic Dataset for Chemistry

Marvin Alberts\({}^{1,2,4*}\) Oliver Schilter\({}^{1,3,4*}\) Federico Zipoli\({}^{1,4}\)

Nina Hartmann\({}^{2}\) Teodoro Laino\({}^{1,4}\)

\({}^{1}\)IBM Research \({}^{2}\)University of Zurich \({}^{3}\)EPFL \({}^{4}\)NCCR Catalysis

marvin.alberts@ibm.com

{oli, fzi, teo}@zurich.ibm.com

nina.hartrampf@chem.uzh.ch

Equal Contributions

###### Abstract

Spectroscopic techniques are essential tools for determining the structure of molecules. Different spectroscopic techniques, such as Nuclear magnetic resonance (NMR), Infrared spectroscopy, and Mass Spectrometry, provide insight into the molecular structure, including the presence or absence of functional groups. Chemists leverage the complementary nature of the different methods to their advantage. However, the lack of a comprehensive multimodal dataset, containing spectra from a variety of spectroscopic techniques, has limited machine-learning approaches mostly to single-modality tasks for predicting molecular structures from spectra. Here we introduce a dataset comprising simulated \({}^{1}\)H-NMR, \({}^{13}\)C-NMR, HSQC-NMR, Infrared, and Mass spectra (positive and negative ion modes) for 790k molecules extracted from chemical reactions in patent data. This dataset enables the development of foundation models for integrating information from multiple spectroscopic modalities, emulating the approach employed by human experts. Additionally, we provide benchmarks for evaluating single-modality tasks such as structure elucidation, predicting the spectra for a target molecule, and functional group predictions. This dataset has the potential automate structure elucidation, streamlining the molecular discovery pipeline from synthesis to structure determination. The dataset and code for the benchmarks can be found at https://rxn4chemistry.github.io/multimodal-spectroscopic-dataset.

## 1 Introduction

The rapid advancement of artificial intelligence (AI) and machine learning (ML) methods has ushered in a new era for the field of chemistry. Computational approaches have transformed various aspects of chemical research, including retrosynthesis planning , reaction optimization through Bayesian optimization , molecular design  and more. Tasks that were previously laborious and time-consuming when performed manually are now being automated, accelerating the discovery process. Despite these advancements, one critical aspect of chemistry that remains heavily reliant on human expertise is structural elucidation - the process of determining the molecular structure from spectroscopic data.

While chemists often have an intuition about a molecule that was synthesized, the actual composition of the product needs to be verified using spectroscopic data. Different spectroscopic techniques yield different types of information. For instance, certain functional groups (e.g., alcohols) will exhibit characteristic peaks in specific regions of the infrared (IR) spectrum (e.g., 3200-3300 cm\({}^{-1}\)),while the mass spectrum (MS) can be used to find the molecular weight of a molecule in question. Similar to solving a complex puzzle, the more spectroscopic modalities a chemist has access to, the more information and hints they can gather to predict the molecular structure and explain the observed spectral peaks.

While AI/ML models have been developed for this task, they predominantly focus on single spectroscopic modalities, such as infrared (IR) [14; 15] or nuclear magnetic resonance (NMR) [16; 17] spectroscopy. In contrast, human experts leverage multiple modalities by combining information from various spectroscopic techniques to gain a better understanding of the molecular structure. To bridge this gap and enable the automation of structural elucidation, there is a need for a multimodal dataset containing spectra from a variety of spectroscopic techniques.

Multimodal datasets in other fields, such as computer vision and natural language processing [18; 19; 20; 21; 22], have enabled remarkable achievements like text-to-image generation [23; 24; 25], image captioning , object detection using bounding boxes [27; 28], and even multitask models [29; 30]. Similarly, we postulate that a multimodal dataset for chemical spectra could lead to significant advancements. Such a dataset would serve as a valuable resource for developing AI/ML models capable of integrating information from multiple spectroscopic modalities, emulating the approach employed by human experts in analyzing and interpreting spectral data.

In this paper, we introduce a dataset comprising simulated IR, \({}^{1}\)H-NMR, \({}^{13}\)C-NMR, Heteronuclear Single Quantum Coherence (HSQC)-NMR, positive-ion mass spectrometry (MS), and negative-ion MS spectra for a large set of 790k realistic molecules extracted from patent data. We specifically sample molecules from the United States Patent Office (USPTO) dataset, which is commonly used for reaction prediction [31; 32]. We also introduce initial baseline models for single-modality tasks, namely predicting molecular structures from spectral data, generating spectras from molecular structures, and identifying functional groups present in molecules based on spectral information. These models demonstrate the potential of our dataset for automated molecular structure elucidation and serve as benchmarks for evaluating other AI architectures on these tasks.

By leveraging AI/ML methodologies and the comprehensive information from multiple spectroscopic modalities, this dataset has the potential to close the loop between automated synthesis and automated structural elucidation, streamlining the molecular discovery cycle.

## 2 Related Work

**USPTO Dataset:** The USPTO dataset, by Lowe , has become a staple for machine learning based works in chemistry [2; 31; 32; 34]. It is sourced from patent data and in contrast to many other datasets in chemistry fully open source, making a popular choice for training and evaluating reaction prediction models. The main advantage of this dataset is that all molecules are sourced from patent data, i.e. their distribution is very similar to molecules common in industry and to a lesser extent academia.

**NMR:** Predicting the chemical structure from NMR spectra remains a largely unexplored subject. Jonas  first utilized imitation learning to predict the molecular structure from \({}^{13}\)C-NMR spectra. Sridharan et al.  approached the problem from a different angle using a reinforcement learning guided Monte Carlo tree search to generate molecules from \({}^{13}\)C-NMR spectra. The first work to combine both \({}^{1}\)H- and \({}^{13}\)C-NMR spectra employed 1D-CNNs to predict substructures contained in the parent molecule from both \({}^{1}\)H and \({}^{13}\)C-NMR spectra. Subsequently, a database search is employed to provide the closest match . More recently Alberts et al.  demonstrated that Transformer models are capable of generating molecular structure from annotated NMR spectra.

However, very few other works have been published and comparison between the approaches is rare. A few studies have evaluated model performance on the experimental spectra available in the nmrshiftdb2 database  but most works utilise different private datasets. While some exclusively train on a limited amount of experimental spectra, most simulate a large number of spectra and pretrain on these simulated spectra. At the time of writing, none of the simulated datasets used in these works are publicly available hindering the transparent benchmarking of model architectures.

**IR:** Similar to NMR spectra few works investigate full structure elucidation from IR spectra. Alberts et al.  showed that it is possible to predict the chemical structure from IR spectra of small molecules. On the other hand, predicting the presence of certain functional groups from IR spectra has been assessed extensively [38; 39; 40; 41]. For this application there are also no standardized datasets with each work using different spectra for training and evaluation. The closest standardised dataset, the NIST Gas-Phase IR Database  contains solely 5,228 spectra limiting the applicability for machine models.

**MS/MS:** Out of the three spectroscopic methods, structure elucidation from MS/MS spectra is the most explored and commonly used in laboratories. However, most approaches rely on matching a given MS/MS spectra to a large database inherently limited by the size and diversity of the database . In another approach a fragmentation tree is derived from the MS/MS spectrum and matched to a database of fragmentation trees. While also relying on a database, this approach is less limited as fragmentation trees can be predicted with relatively high fidelity [44; 45; 46; 47]. To remove the need for database matching some works have proposed predicting the chemical structure directly from the MS/MS spectrum. Of these MSNovelist  relies on an LSTM whereas MassGenie  utilizes a Transformer model to predict the structure as Simplified molecular-input line-entry system (SMILES) . As with NMR and IR spectra, the datasets used for training mass spectrometry models are often not publicly accessible. These datasets typically require a commercial license for access, such as the NIST MS database. However, efforts to create open-access repositories of experimentally measured data are underway, with the GNPS database being a notable example.

## 3 Dataset

Since in organic chemistry spectral data is often acquired during reactions to monitor progress or after completion, a dataset intended for inferring molecular structures should encompass a chemical space similar to that accessible through common organic chemistry reactions. Therefore, we chose to utilize the USPTO reaction dataset, mined by Lowe  who extracted chemical reactions from the US patent database. This dataset spans 1,435,481 chemical reactions across various reaction classes and as such only contains realistic molecular structures and commonly used chemicals such as solvents, reactant and reagent. We identified all unique molecules from these reactions and applied filtering criteria based on the heavy atom count (all atoms except Hydrogen), retaining only those molecules with more than five and fewer than 35 heavy atoms. Additionally, we filtered out molecules containing elements other than Carbon, Hydrogen, Oxygen, Nitrogen, Sulfur, Phosphorus, Silicon, Boron, and the halogens. This reduced the number of molecules from 1,675,439 to 1,416,499. We attempted to simulate all molecules; however, since some simulations failed for certain molecules, we opted to include only those molecules for which all spectra simulations were successful (see Figure1).

Overall, we ended up with 794.403 unique molecules and their corresponding IR, \({}^{1}\)H-NMR, \({}^{13}\)C-NMR, HSQC-NMR, and MS/MS spectra (for more details about the simulations, refer to Section 3.1). The molecular structures is represented as SMILES and additionally the molecular formula of each molecule (e.g. \(C_{6}H_{12}O_{6}\)) is provided. The distribution of SMILES lengths and heavy atom counts is visualized in Figure 2 (A), spanning the full range between 5 and 35 heavy atoms. Additionally, the chemical similarity between 200 randomly sampled molecules was investigated by calculating the Tanimoto similarity of their chemical fingerprints (see Figure 2 (C)). It can be seen that the dataset comprises a broad range of dissimilar chemical structures which is desired.

The chemical similarity is weakly correlated with the similarity in the IR spectra domain, as shown in Figure 2 (D), indicating that molecules with similar chemical compositions may also have similar IR spectra. For all similarity calculation refer to section A.4.

Figure 1: Overall workflow: Molecules are extracted from reaction data (USPTO), filtered to only contain certain atom types as well as minimum and maximum molecule size, then for each molecule the corresponding spectra are simulated resulting in a dataset of spectra for 790k molecules.

As chemical functional groups are often distinctly responsible for patterns in certain areas of the spectra (e.g., aromatic rings causing peaks in the range of 6.0 - 8.7 ppm in the \({}^{1}\)H-NMR, as exemplified in Section A.3), we analyzed the functional group compositions of our collected dataset. In Figure 2 (B), the distribution is visualized. As can be seen, the most prevalent functional groups are Alkanes, Arenes, and Ethers, followed by Haloalkanes, and overall spanning a broad range of functional groups.

Overall our dataset comprises 790k unique molecules and their spectra, spanning a large diverse space regarding their chemical similarity, molecule size, as well as functional group composition.

### Data Generation

An overview of the generated data can be found in Table 1. In addition, the spectra and annotations for two molecules are shown in Appendix section A.1.

**NMR Simulations:** We employ MestReNova  to simulate \({}^{1}\)H-, \({}^{13}\)C- and HSQC-NMR spectra. The spectra were simulated using deuterated Chloroform as solvent. Default settings were used for all simulations. For \({}^{13}\)C-NMR spectra, \({}^{1}\)H decoupled spectra were generated.

We utilize the in-built spectral analysis tools of MestreNova to annotate the spectra. For \({}^{1}\)H-NMR spectra, we employ the automultiplet analysis function yielding a set of peaks, the type of each peak e.g. doublet, triplet, etc., and the normalized integration of the peak. The same method yields the position and intensity of the peaks in the \({}^{13}\)C-NMR spectra. Similarly, we obtain the position and integration for peaks in the HSCQC spectra.

**IR Simulations:** IR spectra can be simulated either by approximating the bonds in the molecule as harmonic oscillators and calculating their frequencies or by measuring the dipole-dipole moment of the molecule over time . While the first approach is computationally cheaper it only yields the position and intensity of each peak in the spectrum which can subsequently be broadened e.g. via

Figure 2: (A) Size and functional group (B) distribution of the full dataset. 200 randomly sampled molecules were investigated for their chemical similarity to each (C) as well as if the IR spectra similarity correlates to the chemical similarity (D).

a Gaussian function. Overtones and anharmonicities are neglected by this approach. On the other hand, a simulated IR spectrum derived from dipole-dipole data does contain these features at the expense of higher computation requirements.

We developed a high throughput pipeline to orchestrate molecular dynamics simulations and calculate the spectra from the molecule's dipole moment. Based on a molecule as a SMILES string we generate the corresponding Protein Data Bank (PDB) file and optimize the geometry of the molecule with the General AMBER Force Field (GAFF) . We choose the same force field for the molecular dynamics simulation and generate the input files for a Large-scale Atomic-Molecular Massively Parallel Simulator (LAMMPS)  simulation using AMBER tools . The system is allowed to equilibrate for 250 ns, before recording the dipole moment of the molecule for a further 250 ns. IR spectra are calculated from the dipole moment according to Braun . The simulated spectra have a range from 400-4000 \(cm^{-1}\) with a resolution of 2 \(cm^{-1}\).

**MS/MS Simulations:** The development MS/MS simulation tools is advancing rapidly, with new tools and approaches emerging frequently. To capture the current state of the art, we selected three distinct methods that represent different approaches to MS/MS simulation: Competitive Fragmentation Modeling for Metabolite Identification 4.0 (CFM-ID 4.0) , Subformula Classification for Autoregressively Reconstructing Fragmentations (SCARF) Goldman et al. , and ICEBERG Goldman et al. . While SCARF and ICEBERG employ pure machine learning approaches, CFM-ID represents a hybrid methodology combining machine learning with rule-based systems. Important to note is that we use the publically available checkpoints for both SCARF and ICEBERG. The performance report in Goldman et al.  and Goldman et al.  was obtained using the closed source NIST20 database.

We simulate positive mode Electrospray Ionisation (ESI) MS/MS spectra using hydrogen adducts using all three methods. Additionally, we use CFM-ID to simulate negative mode spectra, generating spectra at three ionization energies (10eV, 20eV, and 40eV) in both positive and negative modes. All three tools provide chemical formula annotations for the fragments in their simulated MS/MS spectra.

### Experimental vs Simulated Spectra

To evaluate the similarity of the simulated spectra to experimental ones, we compared them with a set of 251 molecules and their corresponding experimentally measured spectra from Van Bramer and Bastin . Out of these 251 molecules, 96 had all spectroscopic techniques measured and were also simulated in the dataset introduced in this manuscript (excluding HSQC-NMR). Since each spectral technique has a different representation, multiple approaches were required for comparison. Table 2 presents the spectral similarity between the real-world measured spectra and our simulated approach. Additionally, as a comparison metric, the similarity of each the 96 simulated spectra versus

   Modality & Subtype & Data Description \\  IR & Spectrum & Vector of size 1.800 \\  \({}^{1}\)H- & Spectrum & Vector of size 10.000 \\ NMR & Annotated Spectrum & Start, End, Centroid, Integration and Type of each peak \\  \({}^{13}\)C- & Spectrum & Vector of size 10.000 \\ NMR & Annotated Spectrum & Centroid and Intensity of each peak \\  HSQC- & Spectrum & Matrix: 512x512 \\ NMR & Annotated Spectrum & X, Y coordinates and integration of each peak \\  Positive & Spectrum & m/z \& Intensity of each peak \\ MS/MS & m/z Annotations & Chemical formula corresponding to the m/z of each peak \\  Negative & Spectrum & m/z \& Intensity of each peak \\ MS/MS & m/z Annotations & Chemical formula corresponding to the m/z of each peak \\   

Table 1: Overview of the data available for the different modalities. For all modalities except IR we provide annotations in addition to the unprocessed spectrum.

all experimental spectra was calculated. The similarity metrics used are listed in the table (their definitions can be found in Appendix section A.4).

Relying primarily on cosine similarity-based metrics has a significant limitation. For example, in the case of NMR spectra, even if the shape and integral are accurately simulated, a slight peak shift compared to the experimentally measured spectrum (a common effect caused by the solvent ) can result in a drastic reduction in cosine similarity. While a chemist would consider the two compared spectra similar, the cosine similarity score would be substantially lower than when the peaks are aligned. Despite this limitation, it can be seen that, on average, all simulated spectra have a higher similarity to their corresponding experimental spectra compared to average similarity against all other experimental spectra. This shows that the simulated data represents somewhat realistically experimentally measured spectra. For visual inspection of the similarity between simulated and experimental spectra see Figure 3. A more in-depth analysis of the similarity between experimental and simulated spectra on larger datasets is presented in appendix section A.5.

   Spectrum & Sim. vs Exp. Sim vs other Exp. Similarity Metrics \\  IR & 31.5 & 26.6 & Cosine Similarity \\  MS/MS (CFM-ID, Positive) [10 eV] & 30.1 & 17.9 & CosineGreedy Similarity  \\ MS/MS (CFM-ID, Positive) [20 eV] & 40.1 & 22.6 & CosineGreedy Similarity  \\ MS/MS (CFM-ID, Positive) [40 eV] & 48.9 & 26.6 & CosineGreedy Similarity  \\  MS/MS (SCARF, Positive) & 14.1 & 8.2 & CosineGreedy Similarity  \\ MS/MS (ICEBERG, Positive) & 17.0 & 10.9 & CosineGreedy Similarity  \\  \({}^{1}\)H-NMR & 21.9 & 6.8 & Cosine Similarity \\ \({}^{13}\)C-NMR & 48.4 & 8.6 & CosineGreedy Similarity  \\   

Table 2: Similarity metrics between experimental and simulated spectra. For the MS/MS only positive modes are compared as the experimental spectra were measured in this mode.

Figure 3: Simulated vs experimentally measured (A) \({}^{1}\)H-NMR (B) \({}^{13}\)C-NMR (C) MS/MS [+40 eV] and (D) IR of the molecule 2,2-dimethyl-3-methylenebicyclo[2.2.1]heptane (shown in the lower right).

Benchmarks

In the following we will present benchmarks on predicting the correct structure, functional groups contained in a molecule and generating spectra from a given molecule. We only evaluate performance on single modalities and leave exploring multimodal tasks for future work. All experiments are conducted with five fold cross validation. An overview of the different tasks is shown in Figure 4.

### Structure Elucidation from Spectra

As described in the introduction, we envision full structure elucidation from spectra as the primary use case for this dataset. To this end, we provide baseline results on predicting the exact chemical structure from spectra (see Table 3). We train a vanilla encoder-decoder transformer model [64; 65] on each individual modality and on the combination of \({}^{1}\)H- and \({}^{13}\)C-NMR. More information on the exact model and parameters used can be found in Appendix A.6. In addition to the spectra, we provide the models with the chemical formula, i.e. the elements present in the molecule, as a prior. The chemical formula can be obtained experimentally via high resolution MS.

To train a transformer model on the spectra we convert the spectra into a structured text representation. For IR and NMR spectra we follow the representations described in earlier works by Alberts et al. [17; 14]. For IR spectra this representation converts the spectrum to a set of 400 tokens each sampled from a fixed position in the spectrum and bins the intensities to tokens. For \({}^{13}\)C-NMR spectra the representation provides the model with the position of each peak in the spectrum, whereas \({}^{1}\)H-NMR spectra we provide the integration and type of each peak in addition its beginning and end. We train a

    & Top–1\% & Top–5\% & Top–10\% \\  IR & 9.97 \(\) 0.46 & 21.23 \(\) 0.33 & 24.01 \(\) 0.42 \\  MS/MS (CFM-ID, Negative) & 20.98 \(\) 0.23 & 39.32 \(\) 0.19 & 44.93 \(\) 0.29 \\ MS/MS (CFM-ID, Positive) & 23.53 \(\) 0.21 & 42.59 \(\) 0.14 & 47.53 \(\) 0.31 \\  MS/MS (SCARF, Positive) & 1.92 \(\) 0.11 & 5.26 \(\) 0.37 & 6.81 \(\) 0.48 \\ MS/MS (ICEBERG, Positive) & 15.52 \(\) 2.10 & 31.46 \(\) 3.28 & 36.22 \(\) 3.45 \\  \({}^{13}\)C-NMR & 51.95 \(\) 0.29 & 70.01 \(\) 0.21 & 74.12 \(\) 0.30 \\ \({}^{1}\)H-NMR & 64.99 \(\) 0.31 & 81.94 \(\) 0.31 & 84.07 \(\) 0.32 \\ \({}^{1}\)H-NMR + \({}^{13}\)C-NMR & 73.38 \(\) 0.08 & 87.94 \(\) 0.14 & 89.98 \(\) 0.16 \\   

Table 3: Top–1, Top–5, and Top–10 Accuracy (see Appendix A.7) of a Transformer model trained to predict the chemical structure (SMILES) from the different modalities.

Figure 4: Overview of the benchmarks. Left: Structure elucidation using transformer models. We convert each spectra into a structured text representation to make it ingestible by the model. Top Right: Generation of spectra from molecules using a transformer model. We reuse the same structured text representation. Bottom right: Predicting functional groups from the spectra as a multilabel multiclass classification problem. We assess transformers, a 1D-CNN and gradient boosted trees.

model on the spectra generated by SCARF, ICEBERG and CFM-ID. In addition, for CFM-ID we train a model both for the positive as well as the negative MS/MS spectra. Each peak in a spectra is described using the peaks m/z and intensity. Examples for all representations can be found in Appendix section A.8.

We observe the worst performance for models solely trained on IR spectra followed by MS/MS spectra. On the other hand, \({}^{1}\)H- and \({}^{13}\)C-NMR perform relatively well. Encouragingly the combination of both \({}^{1}\)H- and \({}^{13}\)C-NMR performs the best. These results can be explained by the information contained in each modality. While IR spectra can be leveraged easily to determine the functional groups present in a molecule, for larger and more complex molecules the peaks in the spectrum start to overlap rendering it difficult to extract information. The low performance on MS/MS spectra is caused by similar factors: The more complex the molecule, the larger the number of potential fragmentations, increasing the difficulty of assigning a definite structure. Models trained on \({}^{1}\)H-NMR spectra perform better than \({}^{13}\)C-NMR as \({}^{1}\)H-NMR spectra typically contain more information. However, as the two types of spectra probe different aspects of the molecule they complement each other resulting in a performance increase of 7.8% when combined. We also conducted zero-shot experiments of the models trained on simulated data on the Van Bramer and Bastin  dataset. These results are shown in appendix section A.9.

### Functional Group prediction

Another task that can be explored using the dataset is predicting the functional groups present in the structure from the spectra. We extract functional groups from the molecules using the SMARTS  pattern defined in A.2. While not as useful to chemists as full structure elucidation, the success of a chemical reaction can in most cases be determined by a change in functional groups. We approach this task as a multiclass, multilabel classification problem. As such we evaluate the performance of three different models, a boosted tree classifier , a 1D-CNN as implemented by Jung et al.  and a transformer model, in predicting the functional groups present in the target molecule. The performance of the models on the modalities is shown in Table 4. We train the boosted gradient tree and 1D-CNN on the non processed vector form of each spectrum. In contrast we employ the same representations as used in for structure elucidation task for the transformer model. Unlike the previous task, we do not include the chemical formula as an input.

Across four modalities the transformer trained on the structured text representations outperforms both the 1D-CNN and the gradient boosted trees. Only on IR spectra is the performance of the 1D-CNN marginally better than the Transformer model. In contrast to MS/MS and the NMR spectra, IR spectra are not sparse explaining the good performance of the 1D-CNN.

### Spectra prediction

We primarily conceived the dataset to explore structure elucidation. However, the dataset can also be used for the reverse, i.e. predicting the corresponding spectrum given a target molecule. To this end we train a transformer model to predict the from the molecule for each modality. We use the same

   Spectrum & XGBoost & 1D-CNN  & Transformer \\  IR & 0.834 \(\) 0.001 & **0.895 \(\) 0.002** & 0.881 \(\) 0.021 \\  MS/MS (CFM-ID, Positive) & 0.725 \(\) 0.002 & 0.645 \(\) 0.001 & **0.897 \(\) 0.012** \\ MS/MS (CFM-ID, Negative) & 0.761 \(\) 0.001 & 0.648 \(\) 0.006 & **0.905 \(\) 0.009** \\  MS/MS (SCARF, Positive) & 0.763 \(\) 0.001 & 0.737 \(\) 0.003 & **0.771 \(\) 0.004** \\ MS/MS (ICEBERG, Positive) & 0.734 \(\) 0.001 & 0.677 \(\) 0.001 & **0.885 \(\) 0.007** \\  \({}^{13}\)C-NMR & 0.804 \(\) 0.001 & 0.674 \(\) 0.056 & **0.913 \(\) 0.017** \\ \({}^{1}\)H-NMR & 0.797 \(\) 0.003 & 0.839 \(\) 0.005 & **0.935 \(\) 0.031** \\   

Table 4: F1 scores for predicting functional groups from the different spectra.

model architecture and representations as in section 4.1. This mean that while we predict the whole spectrum for IR spectra, for all other modalities a processed form of the spectrum is generated. In the case of the MS/MS spectra this consists of the m/z of each peak and it's intensity. Similarly for \({}^{13}\)C-NMR spectra the model predicts the position of each peak. However, for \({}^{1}\)H-NMR spectra we predict the start and end of each peak, it's type and integration.

To compare the predicted and target spectrum we use two similarity metrics: One one hand we employ greedy cosine similarity and on the other the exact token accuracy. For MS/MS, \({}^{13}\)C- and \({}^{1}\)H-NMR spectra we compute the cosine similarity by first aligning the peaks in the predicted and target spectrum before calculating the similarity. The results are shown in Table 5.

For IR spectra we observe both a low cosine and token similarity. This is likely caused by the represenation used for predicting the spectra as a sequence of 400 tokens has to be generated for each spectrum. Other approaches such as graph neural networks as proposed by McGill et al.  may show better performance. For both positive and negative MS/MS we observe a decrease in performance with an increase in the ionisation energy, likely a result of molecules fragmenting to a larger extent at higher ionisation energy and as such resulting in a more complex spectrum. Predicted \({}^{1}\)H- and \({}^{13}\)C-NMR spectra both exhibit a high cosine similarity while showing a small token accuracy. This is caused by two factors: One one hand only the position of the peak is used to calculate the similarity and on the other hand the token accuracy requires an exact match of the token, i.e. even if the predicted peak has an error of only 0.1ppm it would be deemed false.

### Other tasks to explore

While we benchmark three different tasks that could be of interest to researchers, the dataset can also be used for various other ML applications. The following ideas serve as starting points for potential research opportunities to explore.

**Including more information:** Typically, when predicting the structure of molecules from spectra, chemists do not start from scratch. Instead, they leverage prior knowledge of the reaction performed to make informed initial guesses about the structure. These guesses may include the desired product, the starting material, or plausible side products. Chemists then use clues obtained from various spectra to confirm or eliminate these initial hypotheses. In this context, we propose a task where a model is provided with a set of molecules and a spectrum, and it predicts which molecule from the set corresponds to the given spectrum.

   Spectrum & Cosine Similarity & Token Accuracy \\  IR & 23.91 \(\) 0.14 & 13.55 \(\) 0.16 \\  MS/MS (Positive) [10 eV] & 83.94 \(\) 0.10 & 31.58 \(\) 0.09 \\ MS/MS (Positive) [20 eV] & 77.09 \(\) 0.18 & 11.05 \(\) 0.13 \\ MS/MS (Positive) [40 eV] & 66.35 \(\) 0.15 & 6.94 \(\) 0.16 \\  MS/MS (Negative) [10 eV] & 82.87 \(\) 0.25 & 33.92 \(\) 0.19 \\ MS/MS (Negative) [20 eV] & 75.86 \(\) 0.18 & 11.82 \(\) 0.11 \\ MS/MS (Negative) [40 eV] & 69.50 \(\) 0.23 & 8.95 \(\) 0.17 \\  MS/MS (SCARF, Positive) & 66.39 \(\) 0.03 & 5.04 \(\) 0.08 \\ MS/MS (ICEBERG, Positive) & 63.17 \(\) 0.01 & 4.62 \(\) 0.04 \\  \({}^{13}\)C-NMR & 92.69 \(\) 0.31 & 35.7 \(\) 0.27 \\  \({}^{1}\)H-NMR & 94.86 \(\) 0.29 & 17.93 \(\) 0.24 \\   

Table 5: Cosine similarity and token accuracy of transformer models when predicting spectra from structure. We predict an individual MS/MS spectra for each ionisation energy 

**Mixtures:** While the previous sections discussed structure elucidation from pure compounds, in reality chemists typically encounter mixtures far more often than pure compounds, e.g. a reaction is a mixture of a set of compounds. The mixtures commonly need to be separated into their constituent components before definite structure elucidation can be carried out. If the components of a mixture could identified accurately this would greatly aid chemists. The spectra of mixtures can be constructed as convex combinations of their constituent components for NMR and IR spectra. As such this dataset could be used to construct the spectra of complex mixture based on which the components of the mixture can be predicted.

**Representations:** While our study utilized SMILES as the primary form to represent molecules there are a variety of different chemical representations that could be explored, reaching from SELFIES, deep-SMILES as well as generating graph instead of a text-based representation. Additionally, the spectral information could be represented in various ways. For instance, generating figures from vector representations and employing image-based models.

**Multimodal Approaches:** Combining the different types of spectra for a true multimodal model is significantly harder than e.g. predicting the structure from a single modality. Not only does the best representation for each modality need to be considered but also how to combine the different modalities. We suggest the following approach: First optimise the representation for each modality individually before considering how to combine them. Here the approaches range from early fusion, in practice often a simple concatenation of the different modalities, over medium fusion, embed each modality then fuse, to late fusion. Another consideration is how to process each modality and weigh each modality. Each of these factors would need to be considered when building a multimodal model.

## 5 Conclusion and Limitations

In this study we introduce the first multimodal spectroscopic dataset for structure elucidation including six different types of spectra for 790k molecules sampled from USPTO. We conduct a series of experiments on structure elucidation, generating a spectrum from a molecule and evaluate boosted gradient trees, 1D-CNNs and transformer models on classifying which functional groups are present in a molecule based on the spectra.

However, the dataset also has multiple limitations, the largest being that all data is simulated. As a result, there is a distribution shift between simulated and experimental spectra and models trained on the data in this set will likely benefit from further finetuning on experimental spectra. The efficacy of these models is inherently determined by the fidelity of the underlying simulation used to generate the spectra. Another limitation is the chemical space covered by USPTO. The USPTO dataset contains molecules sourced from patents and as a result, is biased towards synthesisable molecules with applications in industry. This means that models trained on our dataset may not perform as well on molecules outside of this scope, e.g. natural products.

We hope that this work can address the severe lack of openly available spectroscopic datasets and serve as a foundation to build models capable of automated structure elucidation for chemistry and with that streamline the molecular discovery pipeline from synthesis to structure determination.

## Code and Data availability

The code for the benchmark and the dataset used in this study is publicly available under the following link: https://github.com/rxn4chemistry/multimodal-spectroscopic-dataset.