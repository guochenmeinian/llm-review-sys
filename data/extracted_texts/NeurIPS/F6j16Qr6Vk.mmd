# Toward Better PAC-Bayes Bounds for Uniformly Stable Algorithms

Sijia Zhou\({}^{1}\) Yunwen Lei\({}^{2}\)1  Ata Kaban\({}^{1}\)

\({}^{1}\)School of Computer Science, University of Birmingham, Birmingham B15 2TT, United Kingdom

\({}^{2}\) Department of Mathematics, The University of Hong Kong, Pokfulam, Hong Kong, China

sxz115@student.bham.ac.uk leiyw@hku.hk a.kaban@bham.ac.uk

###### Abstract

We give sharper bounds for uniformly stable randomized algorithms in a PAC-Bayesian framework, which improve the existing results by up to a factor of \(\) (ignoring a log factor), where \(n\) is the sample size. The key idea is to bound the moment generating function of the generalization gap using concentration of weakly dependent random variables due to Bousquet et al (2020). We introduce an assumption of sub-exponential stability parameter, which allows a general treatment that we instantiate in two applications: stochastic gradient descent and randomized coordinate descent. Our results eliminate the requirement of strong convexity from previous results, and hold for non-smooth convex problems.

## 1 Introduction

Stochastic optimization methods are the workhorses of many modern machine learning problems. A lot of progress has been made in reducing optimization errors with less training time in stochastic settings . One such method is stochastic gradient descent (SGD), which builds a stochastic gradient estimator iteratively based on a randomly sampled example to approximate the gradient for the next iteration. SGD is appealing for large-scale data analysis due to its cheap computational cost, simplicity and efficiency.

Obtaining models that generalize well is the goal in machine learning and we undertake a theoretical analysis of this problem. The generalization behavior of a model can be quantified by the excess risk, which decomposes into two components: the optimization error and the generalization error (or generalization gap). In this paper, we focus on the analysis of the generalization error of stochastic optimization methods. We combine two useful approaches to bound the generalization error, that is algorithmic stability  and PAC-Bayes bounds . Our hope is to retain the benefits of both approaches to derive powerful generalization bounds to better understand the behavior of stochastic optimization methods.

Seminal work by Bousquet et al.  provided generalization bounds for uniformly stable algorithms in the deterministic case. Sharper generalization bounds were obtained via a moment bound on the generalization gap and a concentration inequality of weakly dependent random variables . Extending stability-based bounds to randomized algorithms is a challenge. In , where the stability-based bounds for the randomized algorithms were considered, the results hold for fixed distributions. To give bounds uniformly for all distributions, we need to turn to PAC-Bayes analysis. A recent work analyzed stable algorithms in the PAC-Bayes framework and derived generalization bounds that hold for any distribution . However, a comparison between  and  reveals that the error convergence rate in the randomized case  is much slower than that for the deterministic case . In more detail, it was shown that \(\)-uniformly stable (\(\) is decreasing w.r.t. \(n\), where \(n\) is the samplesize) and deterministic algorithms would imply generalization bounds of order \((1/+)\)[8; 18]2, while PAC-Bayes bounds of order \(O(1/+)\) were developed for randomized algorithms . In , the randomness comes from the sampling of hyperparameters such as the index of examples chosen in SGD, and the PAC-Bayes bounds hold for any posterior distribution which may depend on the dataset. It is clear that the PAC-Bayes bounds can be slower than those in [8; 18] by a factor of \(\), which motivates a natural question: can we develop PAC-Bayes bounds for randomized algorithms which match the rate of deterministic algorithms?

This paper explores the above question. We provide sharper PAC-Bayes bounds that hold for uniformly stable randomized algorithms. We adapt a moment bound  previously used for stable algorithms in deterministic cases and extend it to the PAC-Bayesian framework, to give bounds that hold for randomized predictors. The PAC-Bayes framework is based on the work of . However, we take a different analysis strategy to control the change in hyperparameters, which is based on an assumption of sub-exponential stability parameter. This general assumption allows us to bound the moment generating function (MGF) of the generalization gap within a high probability domain where our assumption holds (see Appendix A.2). Furthermore, we prove that this assumption holds for both SGD and randomized coordinate descent (RCD). We then illustrate the advantage of our results over existing bounds.

Regarding the convergence rate, our main result improves on the existing PAC-Bayes bounds  by a factor of \(\) (ignoring a log factor). This improvement holds under weaker conditions under which convergence is not guaranteed in . Our primary technical tool is a moment bound, which we extend to randomized learning algorithms in the PAC-Bayes framework. This allows our bounds to hold for all possible posteriors, not just fixed ones  or deterministic algorithms [8; 18]. We need to introduce novel techniques to handle the randomness of the hyperparameter, which is a challenge in the PAC-Bayes analysis (details will be given in Section 3.2).

Regarding assumptions, our result holds without the requirement of hyperparameter stability in previous work . Instead, we introduce a new assumption on the sub-exponential behavior of uniform stability by viewing the uniform stability as a function of the random hyperparameter. Interestingly, it suffices to study the sub-exponential behavior of uniform stability under the prior distribution, which makes the sub-exponential assumption easy to check.

We show that the uniform stability of SGD and RCD have a mixture of sub-Gaussian and sub-exponential tails that satisfy this assumption. Thus, we remove the strong convexity assumption in the existing analysis of SGD  and extend the result to non-smooth problems. Our result also applies to RCD, where the randomness arises from the selected coordinates.

The remainder of the paper is organized as follows. We discuss the basics on PAC-Bayes and stability analysis in Section 2. We present our main results in Section 3, and apply it to SGD and RCD in Section 4. We survey the related work on stability and PAC-Bayesian analysis in Section 5, and conclude the paper in Section 6.

## 2 Preliminaries

We first introduce some notations. Let \(\) and \(\) denote the input and output space respectively and let \(=\). We are given a set of training examples of size \(n\), \(S=\{z_{1}=(x_{1},y_{1}),,z_{n}=(x_{n},y_{n})\}\), drawn independently and identically distributed (i.i.d.) from an unknown distribution \(\) on \(\). We hope to learn a predictor from a class of hypotheses \(\) to predict unseen new data drawn from \(\). Let \(\) denote the weight space, \(^{d}\), and \(\) denote a hyperparameter space. A deterministic learning algorithm \(A:^{n}\) maps the training examples to a hypothesis \(h_{}\) determined by \(\). The quality of a hypothesis is measured by a loss function, \(:[0,M]\).

The goal of any learning algorithm is to produce a predictor that generalizes well. That means that the learned predictor applied on previously unseen input data from the marginal of \(\) should have a small expected loss. For any \(\), the risk of a predictor returned by the algorithm \(A\) is a random variable as a function of \(S\), defined as

\[R(A(S;))=_{z}[(A(S;),z)].\] (2.1)Since \(\) is unknown, we have no access to the true risk. Instead, the empirical risk is often used as an approximation

\[R_{S}(A(S;))=_{i=1}^{n}(A(S;),z_{i}).\] (2.2)

We are interested in how well the empirical risk can estimate the risk. The difference between them is the generalization gap \(G(S;) R(A(S;))-R_{S}(A(S;))\). We can upper bound the risk by bounding this difference.

### PAC-Bayes basics

We are interested in randomized algorithms, such as stochastic gradient descent (SGD) and randomized coordinate descent (RCD). In such algorithms, there is an in-built random sampling mechanism that we can think of as a random hyperparameter. In other words, a randomized algorithm may be viewed as a deterministic algorithm with hyperparameters \(\) that follow a distribution. Therefore, for the analysis that follows, we will explicitly define distributions on \(\). There has been a lot of interest in SGD because it is often used to train a model and its randomness comes from independent sampling of training instances to estimate gradient directions. In this case, the hyperparameters \(\) form a random sequence \(=(_{1},...,_{T})\), where every \(_{t}[n]\), for \(t[T]\), is an i.i.d. index of a training point from \(S\). Here \([n]\) denotes \(\{1,,n\}\).

Any distribution over the hyperparameter space \(\) induces a distribution over the predictors (or weights since we often consider parametric models). In the PAC-Bayes methodology, the common approach is to define a prior distribution on the domain of the weights [13; 22; 34; 53]. However, in the context of randomized algorithms of the kind mentioned above it is more natural to exploit the randomness already present through a distribution on the domain of the hyperparameters.

Hence, we will conduct PAC-Bayesian analysis by focusing on the randomness of the hyperparameters. Let \(\) be any prior distribution on the hyperparameter domain \(\), chosen before seeing the training data. Given a randomized algorithm, we will only need to prove a condition for the prior \(\) on \(\), and in return our generalization guarantees will hold with high probability for _all_ posteriors \(\) on \(\). In particular, we can assume a simple uniform distribution as a prior for SGD, i.e. SGD with uniform sampling, and derive bounds for data-dependent non-uniform sampling [49; 56; 66]. For example, SGD with importance sampling  shows better results than uniform sampling, and there are efforts to learn good sampling distributions  in a line of research towards self-certified learning algorithms [13; 44].

The quality of a predictor learned by an algorithm \(A\) from the training sample \(S\), is defined as the expected risk w.r.t the PAC-Bayes posterior \(\) as

\[R(S,)=*{}_{}[R(A(S; ))].\] (2.3)

Its empirical counterpart, the expected empirical risk w.r.t. \(\) is

\[R_{S}(S,)=*{}_{}[R_{S}(A (S;))].\] (2.4)

In special cases this expectation can be computed analytically; most often it is approximated either by Monte Carlo sampling or by analytical upper bounds.

PAC-Bayes bounds aim to estimate \(R(S,)\) in terms of \(R_{S}(S,)\) and the divergence between \(\) and \(\). A key ingredient that PAC-Bayes bounds rest upon is a change of measure inequality, also known as variational formula. For completeness this is given in Appendix (Lemma A.3).

### Algorithmic stability basics

Another relatively recent framework for generalization analysis is based on the concept of algorithmic stability . The key concept in this framework quantifies how sensitive a learning algorithm is to small perturbations of the training data. There are several notions of algorithmic stability, and the one we use in our work is the following uniform stability . We denote \(S S^{}\) if they are neighboring datasets, i.e., \(S\) and \(S^{}\) differ by at most a single example.

**Definition 1** (Uniform Stability).: For any \(\), an algorithm \(A:S A(S;)\) is \(_{}\)-uniformly stable w.r.t. a loss function \(\) if \( S S^{}^{n}, z\),

\[|(A(S;),z)-(A(S^{};),z)|_{}.\] (2.5)

Recall that \(A\) is a randomized algorithm whose randomness is exclusively due to a random draw of \(\). Hence, given a fixed instance of \(\), the algorithm \(A\) becomes a deterministic algorithm. This simple observation helps us reduce the problem from randomized learning to deterministic learning. Based on this observation, the next section presents sharper generalization bounds for randomized algorithms in comparison to previous results .

## 3 Main Results

First we introduce a sub-exponential assumption on the stability parameter. This will allow us to make some key innovations: 1) We will be able to remove one of the assumptions required by [32, Theorem 2] (hyperparameter stability) and only require uniform stability. 2) we will state our result in more general terms, and instantiate it to specific algorithms such as SGD and RCD.

**Assumption 1** (Sub-exponential stability).: Let \(\) be a fixed probability distribution on \(=_{t=1}^{T}_{t}\). We say that a randomized algorithm with random hyperparameters \(\) satisfies sub-exponential stability if, for any fixed instance of \(\) it satisfies \(_{}\)-uniform stability w.r.t. a loss function \(\), and there exists \(c\) such that for any \((0,1/n]\), with probability at least \(1-\) over draws of \(\):

\[_{}_{}[_{}]+c(1/ ).\] (3.1)

In other words, this assumption says that the deviation of \(_{}\) from its mean roughly has a sub-exponential tail. We will show that \(c\) is dominated by \(_{}[_{}]\) in typical stochastic optimization algorithms such as SGD and RCD.

Note that in the above assumption, the probability is made w.r.t. \(\), which is a prior distribution independent of \(S\). We can choose \(\) to be a uniform distribution. In this case, we will show that SGD satisfies this assumption under mild conditions on the loss functions with very small \(_{}[_{}]\) and \(c\).

Recall that for any fixed instance of \(\), the trained model of the learning algorithm \(A\) on data set \(S\) with hyperparameters \(\) is a deterministic predictor. Our proof strategy for our main result below is to first fix \(\), and apply a recent technique of obtaining sharp bounds  to the resulting deterministic algorithm. After that, we deal with the randomness of \(\).

In Theorem 1 we give our main result. This bound is useful when we have small \(_{}[_{}]\) and \(c\). We will see two examples in Section 4. We denote \(B B^{}\) if there exists a universal constant \(c_{1}>0\) such that \(B c_{1}B^{}\). We use \(B B^{}\) if there exists a universal constant \(c_{2}>0\) such that \(B c_{2}B^{}\). We use \(B B^{}\) if \(B B^{} B\). The proof is given in Appendix A.2.

**Theorem 1** (Generalization of sub-exponentially stable randomized algorithms).: _Consider a learning algorithm \(A(S;)\) that satisfies Assumption 1 w.r.t. \(\) and \(c_{}[_{}]\). Assume \((A(S;),z)[0,M]\). Then for any \(_{1}(0,1)\) the following inequality holds with probability at least \(1-_{1}\) uniformly for all \(\)_

\[_{}R(A(S;))-R_{S}(A(S;)) D_{}(\|)+(1/_ {1})_{}[_{}] ^{2}n,}},\]

_where \(D_{}(\|)\) means the KL divergence between \(\) and \(\), i.e., \(D_{}(\|)=_{} ()}{()}\)._

To apply Theorem 1, we only need to check the sub-exponential assumption w.r.t. the prior \(\). Then, we use the PAC-Bayesian analysis to transfer this stability assumption w.r.t. the specific \(\) to a bound holding for all posterior distributions.

### Comparison

Next, we compare our result (Theorem 1) with the previous generalization bounds on randomized algorithms due to  and observe the advantages that our approach offers.

To blend the stability into the PAC-Bayes framework, where hyperparameters \(\) follow a distribution,  defined the following new hyperparameter stability assumption for learning algorithms (Definition 2) and obtained the stability-based PAC-Bayes bound given in Theorem 2.

**Definition 2** (Hyperparameter Stability).: A learning algorithm \(A\) has uniform hyperparameter stability \(_{}\) w.r.t. the loss function \(\), if

\[_{S^{n}}_{z}_{, ^{}:D_{H}(,^{})=1}|(A(S;),z)- (A(S;^{}),z)|_{},\] (3.2)

where \(D_{H}(,^{})_{i=1}^{||} [v_{i} v_{i}^{}]\) is the Hamming distance and \([]\) denotes the indicator function, i.e., \([E]=1\) if the event \(E\) holds and \(0\) otherwise.

Observe that, uniform stability (Definition 1) concerns the stability of an algorithm with respect to a change in the training set. In contrast, the above Definition 2 requires stability w.r.t. a change in the hyperparameters. Moreover, the approach in  requires stability w.r.t. both the loss function and the hyperparameters to derive the following PAC-Bayes bound.

**Theorem 2** (Theorem 2 of ).: _Let \(A\) be a randomized learning algorithm and \((A(S;),z)[0,M]\). Assume \(A\) is \(_{}\)-uniformly stable w.r.t. loss functions, and \(_{}\)-uniformly stable w.r.t. hyperparamters. Consider the prior \(\) as a fixed probability distribution defined on \(=_{t=1}^{T}_{t}\). Then for any \(n 1\), \(T 1\), and \((0,1)\), the following inequality holds with probability at least \(1-\) over draws of a data set, \(S^{n}\), for every posterior \(\) on \(\)_

\[_{}R(A(S;))-R_{S}(A(S; ))D_{}(\|)+ (1/)(M+n_{}[_{ }])^{2}/n+T_{}^{2}}.\]

We now compare our bound (Theorem 1) with the bound above (Theorem 2).

In terms of the rate, our bound in Theorem 1 improves the previous result of Theorem 2 by up to a factor of \(\) (up to poly-logarithmic factors when the divergence is polylogarithmic in \(n\)). To see this, consider the case where in both Theorem 1 and Theorem 2, the term that contains the stability parameter dominates over the KL term. Then, in Theorem 1, for \(_{}\)-uniformly stable randomized algorithms, we have

\[_{}R(A(S;))-R_{S}(A(S; ))=(_{}[ _{}]),(n^{-})}D_{}( \|).\]

In contrast, Theorem 2 in  gives

\[_{}R(A(S;))-R_{S}(A(S; ))=_{}[ _{}]+_{}D_{}^{}( \|).\] (3.3)

It is clear that, in the case when \((_{}[_{}])\) dominates the KL divergence then having replaced it with \((_{}[_{}])\) we improved (3.3) by up to a factor of \(\) (ignoring a log term). The prior \(\) can be selected freely if it is independent of \(S\). The posterior \(\) can depend on the data. Indeed, a strength of the PAC-Bayesian analysis is that it applies to any \(\), and therefore it allows to choose a distribution \(\) in a data-dependent manner. The posterior \(\) can be optimized to control the divergence between \(\) and \(\). Therefore, we typically have a small KL divergence.

Observe also that, in Theorem 1, when \(_{}[_{}] O(n^{-})\), our generalization bound is \((n^{-})\), while (3.3) implies a vacuous bound \(O(1)\) so generalization is not guaranteed. Furthermore, our bounds require \(_{}[_{}] 1/\) to get almost optimal rates \((1/)\). As a comparison, the results in Eq. (3.3) require stronger condition \(_{}[_{}] 1/n\) and \(_{} 1/T\) to get the rate \(O(1/)\).

In the unlikely case when the KL divergence is the dominating term, for example, \(D_{}(\|) O(n)\), then Theorem 2 achieves better result. But in this circumstance, both Theorems 1 and 2 require \(_{} O(n^{-})\) to converge at a rate of \(O(n^{-})\), which we believe this to be also rather uncommon.

In terms of assumptions, we eliminate the hyperparameter stability assumption in  at the price of an additional sub-exponential tail assumption on the uniform stability parameter. We will prove later in Section 4 that this general assumption holds for more stochastic optimization methods and even for non-smooth problems. In conclusion, we achieve better results under weaker conditions.

### Proof sketch and challenge in the analysis

We begin by noting that \(\) is applied to the output of \(A(S;)\), which depends on the training data and the hyperparameters. Therefore, \((A(S;))\) could be sensitive to changes in both the dataset and the hyperparameters. To address this issue, Theorem 2 assumes hyperparameter stability, which requires small changes in \((A(S;))\) when the hyperparameters are perturbed.

In contrast to the previous method, we adopt a different strategy for controlling changes in \(\). Our \(_{}\) is a random variable w.r.t. \(\). We assume a sub-exponential concentration behavior of \(_{}\) to control its deviation (Assumption 1). This allows us to control \(_{}\) without necessitating hyperparameter stability. Based on this assumption, our proof proceeds by bounding the MGF of the generalization gap. A key challenge is to handle the randomness of \(_{}\). More precisely, for any temporarily fixed \(\) it has been shown that \(G(S;)\) is a mixture of sub-Gaussian and sub-exponential random variables when only considering the randomness of \(S\). Then a bound of \(_{S}[( G(S;))]\) requires an assumption \( 1/_{}\) (by Eq. (A.5) on sub-exponential random variables). This constraint makes it challenging since we need to choose an appropriate \(\) and control the associated \(_{S}_{}[( G(S;)]\) (the random constraint makes the selection of \(\) difficult). Our key idea to address this problem is to control the MGF of another function \(H:^{n}\) defined as follows

\[H(S;)=R(A(S;))-R_{S}(A(S;))& _{},\\ 0&,\]

where Assumption 1 holds everywhere on \(_{}\), which is a subset of \(\) with probability measure at least \(1-\). This definition of \(H\) has two benefits.

\(\) First, \(H(S;)\) is equal to \(G(S;)\) with high probability. Therefore, a high-probability bound on \(H\) would imply a high-probability bound on \(G\).

\(\) Second, \(H\) is convenient to control. For any \(_{}\), the MGF satisfies \(_{S}[( H(S;)] 1\). For any \(_{}\), the term \(_{S}[( H(S;))]\) can be controlled under an assumption \( 1/_{}[_{}]\) due to the definition of \(_{}\) which relates \(_{}\) with its expectation. A key difference is that the random \(_{}\) is replaced by \(_{}[_{}]\) in the constraint of \(\), which allows us to choose a deterministic \(\) uniformly for all \(\). A further expectation w.r.t. \(\) would imply a bound on \(_{S;}[( H(S;))]\), which is needed in the PAC-Bayes analysis.

Finally, we manipulate this MGF bound in the PAC-Bayes framework by the variational formula (Lemma A.3), building upon the framework of .

### Bounds in Expectation

Our previous analysis gives high-probability bounds. In this subsection, we give PAC-Bayes bounds in expectation. In this case, we no longer need an assumption on the concentration behavior of \(_{}\) around its expectation. The proof is given in Appendix A.3.

**Theorem 3**.: _Consider any \(_{}\)-uniformly stable algorithm \(A\) and \(M\)-bounded loss \(\). For any distribution \(\), we have_

\[_{S}_{}R(A(S;))-R_{S}(A( S;))(^{2}(\|)+1)^{} (}{n}+16_{}[_{}^{2} ])^{}.\] (3.4)

**Remark 1**.: Under the same assumption, it was shown in Theorem 1 in  that

\[_{S}_{}R(A(S;))-R_{S}(A( S;))(^{2}(\|)+1)^{} (}{n}+12M_{}[_{}] )^{}.\] (3.5)

Therefore, our analysis gives a bound of the order \(O1/+_{}[_{}] ^{}\), while Eq. (3.5) gives a bound \(O1/+_{}[_{}] ^{}\). It is known that \(_{}[_{}^{2}]\) can be much smaller than \(_{}[_{}]\). For example, for SGD with \(t\) iterations and \(\) being the uniform distribution, it was shown \(_{}[_{}]=O( t/n)\) and \(_{}[_{}^{2}]=O(^{2}t/n)\) if the loss function is convex and smooth . In the typical setting with \(=O(1/)\) and \(t n\) (in this setting SGD achieves optimal rates), we have \(_{}[_{}]=O(1/)\) and \(_{}[_{}^{2}]=O(1/n)\). In this case, our analysis gives PAC-Bayes bounds of the order \(O(1/)\), while Eq. (3.5) gives PAC-Bayes bounds of the order \(O(1/n^{})\). Therefore, our analysis implies much better PAC-Bayes bounds than that in .

Applications

We apply our general results to derive PAC-Bayes bounds for two optimization algorithms: Stochastic Gradient Descent (SGD) and Randomized Coordinate Descent (RCD). To this aim, we introduce some necessary definitions. Let \(\|\|_{2}\) denote the Euclidean norm.

**Definition 3** (Lipschitz continuity).: We say a loss function \((;z)\) is \(L\)-Lipschitz if for any \(\) and \(z\), we have \(\|(;z)\|_{2} L\). This implies that for any \(_{1}\), \(_{2}\),

\[|(_{1};z)-(_{2};z)| L\|_{1}- _{2}\|_{2}.\] (4.1)

**Definition 4** (Convexity).: Let \( 0\). We say a loss function \((;z)\) is \(\)-strongly convex if for any \(_{1},_{2}\) and \(z\), we have

\[(_{1};z)(_{2};z)+( _{2};z),_{1}-_{2}+ \|_{1}-_{2}\|_{2}^{2}.\] (4.2)

We say the loss function \(\) is convex if the above inequality holds with \(=0\).

**Definition 5** (Smoothness).: Let \( 0\). We say a loss function \((;z)\) is \(\)-smooth if for any \(_{1}\), \(_{2}\)\(\) and \(z\), we have

\[\|(_{1};z)-(_{2};z)\|_{2}\| _{1}-_{2}\|_{2}.\] (4.3)

For the applications, we only need to verify the sub-exponential stability of the algorithm w.r.t. the prior sampling \(\), which is often chosen to be simple such as the uniform distribution.

### Applications to Stochastic Gradient Descent

SGD is one of the most popular algorithms to solve optimization problems in machine learning due to its simplicity and efficiency. The basic idea is to build a stochastic gradient based on a randomly selected example, which is used to update iterates. Here we consider SGD with a general sampling scheme, where the random index follows from a general distribution. This general SGD has already been considered in the literature to improve the efficiency of SGD with uniform sampling, including importance sampling  and Markov chain sampling .

**Definition 6** (SGD with general sampling).: Let \(_{1}\) be an initial point. Let \(\) be a probability measure over \([n]^{T}\) and \(S=\{z_{1},,z_{n}\}\) be a training dataset. Let \((i_{1},,i_{T})\) be drawn according to \(\). At the \(t\)-th iteration, SGD with sampling scheme \(\) updates the model by

\[_{t+1}=_{t}-_{t}(_{t};z_{i_{t}}),\] (4.4)

where \(\{_{t}\}\) is a positive step-size sequence. If \(\) is the uniform distribution, then we call it SGD with uniform sampling (SGDU).

Now we apply Theorem 1 to develop PAC-Bayes bounds for SGD applied to convex problems, covering both smooth and non-smooth cases. We will show that SGD enjoy sub-exponential stability.

#### 4.1.1 Smooth case

In the following lemma to be proved in Appendix II.1.1, we give stability bounds for SGDU and show it satisfies Assumption 1. Recall that the indicator function \([]\) is defined in Definition 2.

**Lemma 4** (Stability bound).: _Let \(S\) and \(S^{}\) be neighboring datasets. Suppose for all \(z\) the loss function is convex, \(\)-smooth and \(L\)-Lipschitz. Let \(\{_{t}\},\{^{}_{t}\}\) be the sequence produced by SGDU on \(S\) and \(S^{}\) respectively with \(_{t} 2/\). Then SGDU with \(t\) iterations and the hyperparameter \(\) is \(_{}\)-uniformly stable with_

\[_{}=2L^{2}_{k[n]}_{j=1}^{t}_{j}[i_{j}=k].\]

_If \(_{t}=\), then for any \((0,1)\), with probability at least \(1-\) we have_

\[_{}_{}[_{}]+4L^{2} 1+(t/n)^{}(1/).\]

_That is, Assumption 1 holds with \(c=4L^{2}1+(t/n)^{}\) w.r.t. \(\)._We can combine the above lemma with Theorem 1 to obtain PAC-Bayes bounds for SGD, whose proof is given in Appendix II.1.1. An interesting property is that generalization bounds for SGD with general sampling can be derived based on the stability analysis for SGD with the uniform sampling. We always let \(\) denote a uniform prior on \(\).

**Corollary 5** (Generalization bound).: _Assume \(\) is \(M\)-bounded, \(L\)-Lipschitz, convex and \(\)-smooth. For uniform distribution \(\), every \(n^{+}\) and \((0,1)\), with probability at least \(1-\) over draws of a data set, \(S^{n}\), for all posterior sampling distribution \(\) on \([n]^{T}\), SGD with \( 2/\) satisfies_

\[_{}R(A(S;))-R_{S}(A(S; ))\\ D_{}(\|)+(1/) L^{2}(T/n+(1+(T/n)^{})(n)) n,}}.\]

Based on , which studied the trade-off between optimization and stability, the recommended choices of parameters are \(T n\) and \( 1/\) to get a SGD iterate with good generalization behavior. In this setting, the above corollary implies a PAC-Bayes bound \((1/)\).

London  gave PAC-Bayes bounds for SGD under strong convexity and smoothness assumptions.

**Corollary 6** (Corollary 1 in ).: _Suppose \(\) is \(M\)-bounded. Let the objective function be \(\)-strongly convex, \(L\)-Lipschitz and \(\)-smooth. Then, for uniform distribution \(\) and any \((0,1)\), with probability at least \(1-\) over draws of a data set, \(S^{n}\), SGD with \(_{t}=( t+)^{-1}\) and any posterior sampling distribution \(\) on \([n]^{T}\) satisfies_

\[_{}R(A(S;))-R_{S}(A(S; ))D_{}(\|)+ (1/)/)^{2}}{n}+}{ ^{2}T}}.\]

**Remark 2**.: We now compare Corollary 5 and Corollary 6. First, Corollary 6 requires a strong convexity assumption, which is removed in our analysis. Second, our analysis implies PAC-Bayes bounds of the order \((1/)\), while Corollary 6 implies bounds of order \(O(1/())\). The strong convexity parameter \(\) is often very small in both theoretical and empirical analysis. For example, the existing generalization analysis of regularization schemes suggests \(=O(n^{-})\) to get an optimal bound (Section 3 in ), for which Corollary 6 implies a vacuous bound. By contrast, our bound \((1/)\) is optimal up to a log factor.

**Remark 3**.: Our uniform stability (Definition 1) is slightly different from the uniform stability \(_{}:=_{S S^{}}_{z}_{ }[(A(S;),z)-(A(S^{};),z)]\) in  in the sense of taking expectation in different places. The expectation of \(\) is taken outside \(\) in our case and inside \(\) in \(_{}\). However, we often have similar upper bounds for \([_{}]\) and \(_{}\). Consider SGD for smooth, Lipschitz and convex problems as an example. It is shown in  that \(_{} 2L^{2}_{k=1}^{t}_{k}/n\), while we can show \([_{}] L^{2} n_{k=1}^{t}_{k}/n\) (the proof of Lemma 4). These two upper bounds are the same order up to a logarithmic factor. Furthermore, lower bounds were established in  (Theorem 1) where \(_{}_{k=1}^{t}_{k}/n\), which match the existing upper bounds up to a constant factor. This shows that \(_{}\) and \([_{}]\) are of similar order.

#### 4.1.2 Non-smooth case

The following lemma shows that SGDU applied to non-smooth problems enjoys the sub-exponential stability. The proof follows the analysis in Section 4.2 in  and is given in Appendix II.1.2.

**Lemma 7** (Stability bound).: _Let \(S\) and \(S^{}\) be neighboring datasets. Suppose for all \(z\) the loss function is convex and \(L\)-Lipschitz. Let \(\{_{t}\},\{^{}_{t}\}\) be the sequence produced by SGDU on \(S\) and \(S^{}\) respectively with fixed step sizes. Then SGDU with \(t\) iterations and the hyperparameter \(\) is \(_{}\)-uniformly stable with \(_{}=2L^{2}+_{k[n]}_{j=1}^{t} [i_{j}=k]\). For any \((0,1)\), with probability at least \(1-\) we have_

\[_{}_{}[_{}]+4L ^{2}1+(t/n)^{}(1/).\]

_That is, Assumption 1 holds with \(c=4L^{2}1+(t/n)^{}\) w.r.t. \(\)._

Based on the above lemma, we derive the following corollary for the PAC-Bayes bounds of SGD in non-smooth problems.

**Corollary 8** (Generalization bound).: _Assume \(\) is \(M\)-bounded, \(L\)-Lipschitz and convex. For any \((0,1)\), with probability at least \(1-\) over draws of a data set, \(S^{n}\), for all posterior sampling distribution \(\) on \([n]^{T}\), SGD with \(T\) iterations and \(_{t}=\) satisfies_

\[_{}R(A(S;))-R_{S}(A(S; ))\\ D_{}(\|)+L^{2}(+T/n+(1+(T/n)^{})  n) n,}}.\]

**Remark 4**.: If we choose \( T^{-}\) and \(T n^{2}\), then Corollary 8 gives the PAC-Bayes bounds of order \((1/)\). This choice of parameters was suggested in Theorem 7 in . This gives the \(O(1/)\) optimization bounds to get optimal trade-off between stability and optimization for non-smooth problems. The analysis in  cannot imply PAC-Bayes bounds for non-smooth problems.

### Applications to Randomized Coordinate Descent

In this subsection, we consider RCD; this has not been studied in the PAC-Bayesian literature. RCD is an efficient optimization algorithm that randomly chooses a coordinate to update at each iteration . Here we consider RCD with general sampling scheme, i.e. the coordinate to update follows a general distribution. This scheme has been studied before in the optimization context .

**Definition 7** (RCD with general sampling).: Let \(_{1}\) be an initial point. Let \(\) be a probability measure over \([d]^{T}\) and \(S=\{z_{1},,z_{n}\}\) be a training dataset. Let \((i_{1},,i_{T})\) be drawn according to \(\). At the \(t\)-th iteration, RCD with sampling scheme \(\) updates the model by

\[_{t+1}=_{t}-_{t}_{i_{t}}R_{S}(_{t}) _{i_{t}},\] (4.5)

where \(\{_{t}\}\) is a step-size sequence, \(_{i}\) is the \(i\)-th coordinate vector in \(^{d}\), and \(_{i}g\) is the derivative of \(g\) w.r.t. the \(i\)-th coordinate. If \(\) is the uniform distribution, then we call it RCD with uniform sampling (RCDU).

Before giving the generalization bound for RCD, we first introduce coordinate-wise smoothness.

**Definition 8** ().: A differentiable function \(g:\) has coordinate-wise Lipschitz continuous gradients with parameter \(>0\), if for all \(\), \(\), \(i[d]\),

\[g(+_{i}) g()+_{i}g( )+^{2}/2.\]

In Lemma 9, to be proved in Appendix B.2, we develop stability bounds for RCDU with convex and smooth loss functions. In particular, we show the stability follows a sub-exponential distribution.

**Lemma 9** (Stability bound).: _Let \(S\) and \(S^{}\) be neighboring datasets. Suppose for all \(z\) the loss function \(\) is convex, \(\)-smooth, \(L\)-Lipschitz and has coordinate-wise Lipschitz continuous gradients with parameter \( 0\). Let \(\{_{t}\},\{^{}_{t}\}\) be the sequence produced by RCDU on \(S\) and \(S^{}\) respectively with \(_{t} 2/\). Then RCD with \(t\) iterations is \(_{}\)-uniformly stable with_

\[_{}=_{k[n]}_{j=1}^{t}_{j}|_{i_{j}} (_{j};z_{k})-_{i_{j}}(_{j};z^{}_{k})|,\] (4.6)

_where \(\|(;z)\|_{1} L_{1}\). Furthermore, if \(_{t}=\), then for any \((0,1)\) the following inequality holds with probability at least \(1-\) over \(\) (the uniform distribution over \(\{(i_{1},,i_{t}):i_{j}[d]\}\))_

\[_{}L t}{nd}+(1/)}{n} +}.\]

**Remark 5**.: Stability bounds of the order \(O( t/(nd))\) were developed for RCD in  (Theorem 2). Their stability bounds hold in expectation. In contrast, we develop high-probability stability bounds of the order \(O+\).

We plug the above bounds into Theorem 1, and derive the following PAC-Bayes bounds for RCD.

**Corollary 10** (Generalization bound).: _Let the assumptions in Corollary 5 hold. We further assume that the gradient is coordinate-wise Lipschitz continuous. When \(\) is the uniform distribution, for any \((0,1)\), with probability at least \(1-\) over draws of \(S^{n}\), for all posterior sampling distributions \(\) on \([d]^{T}\), RCD with the hyperparameter \(\) and fixed step sizes \( 2/\) satisfies_

\[_{}R(A(S;))-R_{S}(A(S;)) D_{}(\|)+(1/)  T}{nd} n,}}.\]According to the above corollary, we can derive PAC-Bayes bounds of the order \((1/)\) if \(T=O(d)\) and \(=O(1)\). These choices of parameters were suggested in Theorem 7 in  to balance optimization and stability for RCD.

## 5 Related Work

Related work on stabilityThe analysis of the generalization error through algorithmic stability is based on the landmark work of . Generalization bounds via stability are algorithm-specific and have been applied to regularization algorithms, such as SVM regression and classification [7; 11; 16; 52]. Pioneering work on stability analysis of SGD was introduced in , which motivated much subsequent stability analyses of randomized iterative algorithms [10; 24; 25; 31; 38; 45]. The smoothness assumption in  was removed in more recent stability analyses [3; 27] of SGD. Stability bounds showing the benefit of low training errors on generalization were also developed for convex [27; 39; 50], nonconvex  and overparameterized models [12; 47; 59]. In recent works, stronger high-probability bounds via uniform stability have been developed. Some breakthroughs have narrowed down the difference between the risk and the empirical risk, leading to faster convergence rates with high probability [8; 17; 18].

Related work on PAC-Bayes boundsThe PAC-Bayes theory of generalization dates back to works by  and  and further improved by [9; 26] and others. PAC-Bayes bounds are upper bounds on the generalization error of randomized learning algorithms, given in terms of data-dependent quantities that we can compute: the empirical error, and a quantity to measure the divergence between the PAC-Bayesian prior and posterior distributions, such as Kullback-Leibler (KL) divergence or the Renyi divergence . The framework was later extended to allow learning the prior from the data, resulting in tighter bounds [2; 14; 15; 42; 43; 44; 48]. The sensitivity of learning algorithms to small perturbations in the weights can be analyzed through the properties of a distribution of predictors, which may lead to regularity and improve the generalization bounds . By evaluating the algorithmic stability on all possible outputs, stability of learning algorithms and PAC-Bayes bounds can be combined [32; 33; 35; 36; 40; 48; 57] and applied to randomized learning algorithms such as SGD and SGLD [30; 32; 35; 36]. For PAC-Bayes bounds, usually, the randomness is induced by a distribution on the parameters of a model. In , the authors isolated the randomness to view the randomized learning algorithm as deterministic, with hyperparameters following the distribution instead.

## 6 Conclusions

Under an assumption of a sub-exponential stability parameter, we derive sharper stability-based PAC-Bayes bounds for randomized learning algorithms by utilizing a moment bound. We show that the sub-exponential stability assumption holds for SGD and RCD, for which we develop PAC-Bayes bounds as corollaries. Our results remove the need for the requirements of strong convexity, hyperparameter stability, and even smoothness in previous results.

**Limitations**. Future work of interest includes exploring other optimization methods that meet the sub-exponential assumption. It would also be interesting to study the quality of bounds obtainable when placing the PAC-Bayes prior on the parameters of a model (as in the classic approach) versus the hyperparameters of the optimiser of the model (as in this work). Another interesting research direction is to further improve the bound by including additional assumptions. As noted in , for the deterministic case, the bounds can be \(\)-times faster under a Bernstein condition between expectation and variance of loss functions.