# Statistical Insights into HSIC in High Dimensions

Tao Zhang

School of Information Management and Engineering

Shanghai University of Finance and Economics

Shanghai 200433, China

dalizhangt@163.com

&Yaowu Zhang

School of Information Management and Engineering

MoE Key Laboratory of Interdisciplinary Research of Computation and Economics

Shanghai University of Finance and Economics

Shanghai 200433, China

zhang.yaowu@mail.shufe.edu.cn

&Tingyou Zhou

School of Data Sciences

Zhejiang University of Finance and Economics

Hangzhou 310018, China

zhoutingyou@zufe.edu.cn

Corresponding author

###### Abstract

Measuring the nonlinear dependence between random vectors and testing for their statistical independence is a fundamental problem in statistics. One of the most popular dependence measures is the Hilbert-Schmidt independence criterion (HSIC), which has attracted increasing attention in recent years. However, most existing works have focused on either fixed or very high-dimensional covariates. In this work, we bridge the gap between these two scenarios and provide statistical insights into the performance of HSIC when the dimensions grow at different rates. We first show that, under the null hypothesis, the rescaled HSIC converges in distribution to a standard normal distribution. Then we provide a general condition for the HSIC based tests to have nontrivial power in high dimensions. By decomposing this condition, we illustrate how the ability of HSIC to measure nonlinear dependence changes with increasing dimensions. Moreover, we demonstrate that, depending on the sample size, the covariate dimensions and the dependence structures within covariates, the HSIC can capture different types of associations between random vectors. We also conduct extensive numerical studies to validate our theoretical results.

## 1 Introduction

Let \(=(X_{1},,X_{p})^{}^{p}\) and \(=(Y_{1},,Y_{q})^{}^{q}\) be two random vectors. The problems of measuring nonlinear dependence between \(\) and \(\) and testing for their independence are fundamental and have a wide range of applications in statistics and machine learning. For example, dependence measures can be applied in feature screening (Fan et al., 2020), model checking (Clarke et al., 2018), graphical models (Maathuis et al., 2018), and causal inference (Imbens & Rubin, 2015).

Many statistical tools have been developed to measure the dependence between random variables. Classical measures such as Pearson correlation (Pearson, 1920), Spearman's \(\)(Spearman, 1904) and Kendall's \(\)(Kendall, 1938) can only capture linear or monotonic dependence and may fail to detect complex associations. For univariate covariates, several rank-based measures have been proposed to overcome this limitation, such as those by Hoeffding (1948), Blum et al. (1961), Bergsma and Dassios (2014) and Chatterjee (2021). For multivariate covariates, various nonparametric tests have been introduced to quantify arbitrary associations, including the distance correlation (Szekely et al., 2007), the projection correlation (Zhu et al., 2017), the mutual information (Berrett and Samworth, 2019), the kernel canonical correlation (Bach and Jordan, 2002), the constrained covariance (Gretton et al., 2005), and the Hilbert-Schmidt independence criterion (HSIC, Gretton et al., 2007). Among these measures, the distance correlation and the HSIC are perhaps the most widely used and studied in both statistics and machine learning. For instance, Li et al. (2012) applied the distance correlation to perform feature screening. Fan et al. (2020) generalized the distance correlation to a conditional dependence measure under a factor model setting. Albert et al. (2022) developed an adaptive test of independence by aggregating HSIC measures. Pfister et al. (2018) defined a \(d\)-variable HSIC to characterize the mutual dependence among \(d\) random variables. It is worth noting that the distance correlation is equivalent to HSIC with a specific kernel choice (Sejdinovic et al., 2013).

High-dimensional settings pose new challenges and opportunities for dependence measures. Szekely and Rizzo (2013) suggested to estimate the distance correlation with the \(U\)-statistic theory to avoid bias accumulations when the dimension is high. Ramdas et al. (2015) found that the power of kernel and distance based independence tests decreases polynomially with increasing dimension against some fair alternatives. Zhu et al. (2020) proved that, when both \(p\) and \(q\) grow much faster than the sample size \(n\), the sample distance correlation and HSIC can only detect componentwise linear dependences. Gao et al. (2021) established a general condition for the distance correlation based test to have power approaching 1. They also showed that the distance correlation can capture certain pure nonlinear relationship when \(p=q=o(n^{1/2})\) under a specific alternative hypothesis.

In this paper, we aim to provide statistical insights into the HSIC in high dimensions, motivated by the increasing popularity of HSIC and the prevalence of high-dimensional data. We focus on the asymptotic distributions of HSIC under both null and alternative hypotheses when the dimensionality grows with the sample size. Under the null hypothesis, we prove that the rescaled HSIC converges in distribution to a standard normal distribution. We also derive a general condition for the HSIC based tests to have power asymptotically approaching one. These results extend those of Gao et al. (2021) on the distance correlation. Moreover, our analysis is more comprehensive than theirs. By decomposing the general condition, we reveal that HSIC can detect different types of dependences, depending on the dimensionality and sample orders. This sheds light on the performance of HSIC in high dimensions, which has been overlooked in the literature. For illustrative purposes, we let \(\) and \(\) be two random vectors with zero mean and identity covariance matrix. When HSIC is used to test for statistical independence between them, we obtain the following conditions for nontrivial power:

* If \(p\) and \(q\) is fixed as \(n\), and there only exists the conditional mean of \(\)'s \(s\)-th polynomial given \(\), then \(p^{(s-1)}\) must grow slower than \(n\).
* If both \(p\) and \(q\) as \(n\), and there only exists the covariance between \(\)'s \(s_{1}\)-th polynomial and \(\)'s \(s_{2}\)-th polynomial, then \(p^{(s_{1}-1)}q^{(s_{2}-1)}\) must grow slower than \(n\).

These two conditions reveal significant statistical insights and have important implications in practice. For example, when the data dimension \(q\) is small and \(p\) is larger than the sample size \(n\), according to the first condition, to ensure \(p^{(s-1)}\) smaller than \(n\), \(s\) can only be 1. In other words, the HSIC can only measure the conditional mean of \(\) given \(\). When both \(p\) and \(q\) are larger than \(n\), according to the second condition, to ensure \(p^{(s_{1}-1)}q^{(s_{2}-1)}\) smaller than \(n\), both \(s_{1}\) and \(s_{2}\) must be 1. That is, the HSIC can only measure the covariance between \(\) and \(\). In summary, our main contributions are:

1. We generalize the results of Gao et al. (2021) for distance correlation to HSIC, which is a more flexible and widely used measure of dependence.
2. We show that HSIC can capture different types of dependences, depending on the dimensionality and sample orders, which has rarely been realized in the literature before.
3. In contrast to Zhu et al. (2020), who only focused on the case when both \(p\) and \(q\) grow much faster than \(n\), our results characterize a full picture of the performance of HSIC based test in high dimensions.

The rest of the paper is organized as follows. We give some preliminaries about the HSIC in Section 2. Then we present the asymptotic null distribution as well as the power analysis for high-dimensional HSIC in Section 3. In Section 4, we provide statistical insights into the HSIC through connecting the association type with the sample size, the high dimensionality, and the dependence structures within covariates. We conduct comprehensive numerical studies in Sections 5 and conclude this paper with a brief discussion in Section 6. All technical details are relegated to the Supplement.

## 2 Preliminaries

In this section, we give a brief review on HSIC measures proposed by Gretton et al. (2007), which is derived from the notion of cross-covariance operator Baker (1973). We assume that \(X^{p}\) and \(Y^{q}\) are random vectors taking values in Euclidean spaces respectively. Let \(\) and \(\) be the reproducing kernel Hilbert spaces (RKHSs) on \(\) and \(\), with associated kernels \(K(,)\) and \(L(,)\), respectively. Then the cross-covariance operator \(C_{}\) associated to \(\) and \(\) is defined as the operator mapping from \(\) to \(\), such that for all \(f\) and \(g\), \( f,C_{}g_{}=\{f( ),g()\}\). Instead of using the largest singular value of this operator, Gretton et al. (2007) suggested to adopt the squared Hilbert-Schmidt norm, which admits a closed form expression

\[(,) = E\{K(_{1},_{2})L(_{1},_ {2})\}+E\{K(_{1},_{2})\}E\{L(_{1},_{ 2})\}\] \[-2E\{E\{K(_{1},_{2})_{1}\}E\{L (_{1},_{2})_{1}\}\},\]

where \((_{1},_{1})\) and \((_{2},_{2})\) are independent copies of (\(\), \(\)). When the RKHSs, \(\) and \(\), are well chosen, (e.g., characteristic, Sriperumbudur et al., 2010), the HSIC can be served as an independence criterion in the sense that it is nonnegative and equals zero if and only if \(\) and \(\) are independent. To normalize the HSIC to range from zero to one, we follow Zhu et al. (2020) to define the squared Hilbert-Schmidt correlation as

\[^{2}(,)}}{{=}}(,)^{-1/2}(, )^{-1/2}(,).\] (1)

In addition, similar to Zhu et al. (2020) and Albert et al. (2022), we focus on the kernels that can be written in the form of \(K(_{1},_{2})=k(\|_{1}-_{2}\|/_{ })\) and \(L(_{1},_{2})=l(\|_{1}-_{2}\|/_{ })\), where \(k()\) and \(l()\) are some real-valued functions defined in \([0,)\), \(_{}\) and \(_{}\) are the bandwidth parameters. This kind of kernel is very commonly used in the literature and includes many positive-definite kernel such as the Gaussian kernel, the Laplacian kernel, the rational quadratic kernel, and the Kernel generating Sobolev spaces, etc. For example, when \(k(x)=(-x^{2})\), it corresponds to the Gaussian kernel, and when \(k(x)=(-x)\), it corresponds to the Laplacian kernel. One may refer to Genton (2001) for more examples and discussions about isotropic kernels.

## 3 Asymptotic Properties in High Dimensions

At the sample level, with the random sample \(\{(_{i},_{i}),i=1,...,n\}\), we estimate the HSIC with \(U\)-statistics,

\[_{n}(,) }}{{=}} ,i_{2})}K(_{i_{1}},_{i_{2}})L (_{i_{1}},_{i_{2}})}{n(n-1)}-,i_{2},i_{ 3})}K(_{i_{1}},_{i_{2}})L(_{i_{1}},_{ i_{3}})}{n(n-1)(n-2)}\] (2) \[+,i_{2},i_{3},i_{4})}K(_{i_{1} },_{i_{2}})L(_{i_{3}},_{i_{4}})}{n(n-1)(n-2)(n- 3)},\]

where the indexes in the summands, i.e., \((i_{1},i_{2})\), \((i_{1},i_{2},i_{3})\) and \((i_{1},i_{2},i_{3},i_{4})\), are all distinctive from each other. Then the squared Hilbert-Schmidt correlation \(^{2}(,)\) can be estimated as

\[^{2}_{n}(,)}}{{=}}_{n}(,)^{-1/2}_{n}( ,)^{-1/2}_{n}(,).\]

We now discuss how to use the sample squared Hilbert-Schmidt correlation to distinguish between the null hypothesis \(H_{0}:\) is independent of \(\), and the alternative hypothesis \(H_{1}:\) is not independent of \(\). To implement the HSIC based test, it is required to study the asymptotic distributions for \(^{2}_{n}(,)\) under the null hypothesis. When the dimensions are fixed, Gretton et al. (2007) showed that \(n\)\(^{2}_{n}(,)\) converges in distribution to a weighted sum of independent chi-squared random variables as long as \(\) is independent of \(\). We now study its asymptotic null distribution in high dimensions. Before that, we define the two quantities \(H_{}(_{1},_{2})\) and \(H_{}(_{1},_{2})\) as

\[H_{}(_{1},_{2}) }}{{=}} K(_{1},_{2})-E\{K(_{1}, _{2})_{1}\}-E\{K(_{1},_{2}) _{2}\}+E\{K(_{1},_{2})\},\] \[H_{}(_{1},_{2}) }}{{=}} L(_{1},_{2})-E\{L(_{1}, _{2})_{1}\}-E\{L(_{1},_{2}) _{2}\}+E\{L(_{1},_{2})\}.\] (3)

We further define another two quantities \(G_{}(_{1},_{2})\) and \(G_{}(_{1},_{2})\) as

\[G_{}(_{1},_{2}) }}{{=}} E\{H_{}(_{1},_{3})H_{}( _{2},_{3})_{1},_{2}\},\] \[G_{}(_{1},_{2}) }}{{=}} E\{H_{}(_{1},_{3})H_{}( _{2},_{3})_{1},_{2}\}.\]

Then we summarize the asymptotic null distribution for \(^{2}_{n}(,)\) in the following Theorem.

**Theorem 1**.: _Assume the kernels are symmetric with finite fourth moment, i.e., \(K(_{1},_{2})=K(_{2},_{1}),\,L(_{1},_{2})=L(_{2},_{1})\), \(E\{K^{4}(_{1},_{2})\}<\) and \(E\{L^{4}(_{1},_{2})\}<\). Further assume that \(p+q\),_

\[_{}(_{1},_{2})\}E\{H^{4}_{ }(_{1},_{2})\}}{n\{(, )(,)\}^{2}} 0,_{ }(_{1},_{2})\}E\{G^{2}_{}(_{1 },_{2})\}}{\{(,)( ,)\}^{2}} 0,\] (4)

_as \(n\). Then under the null hypothesis, we have \(2^{-1/2}n\;^{2}_{n}(,)}{{}}N(0,1)\)._

Different from that when the dimensions are fixed, Theorem 1 reveals that, under certain conditions, \(n\;^{2}_{n}(,)\) is asymptotically normal in high dimensions. The asymptotic normality makes the limiting null distribution tractable in practice. It greatly expedites the implementation of HSIC based tests because no additional permutations are required to decide critical values. We remark here that the assumptions imposed in Theorem 1 to ensure the asymptotic normality are generally very mild. For the restrictions on the kernels, many commonly used kernels, including Gaussian and Laplacian kernels, are symmetric with finite fourth moment. For the assumption in (4), it is used to restrict the weak dependence within covariates in \(\) and \(\). It holds true when \(\) and \(\) follow the multivariate normal distributions with bounded eigenvalues. It also holds true when \(\) and \(\) are \(m\)-dependent random sequences (Definition 9.1 of DasGupta, 2008). One may refer to Gao et al. (2021) for more discussions about this assumption.

Next, we explore the power performance of the HSIC based test in high dimensions. As discussed in Section 2, we restrict our attentions to the isotropic kernels. Specifically, in the remaining of this paper, we consider \(K(_{1},_{2})\) and \(L(_{1},_{2})\) to be in the form of \(k(\|_{1}-_{2}\|/_{})\) and \(l(\|_{1}-_{2}\|/_{})\), respectively. Because of the kernel form, we assume without loss of generality that \(E=\) and \(E=\). We denote by \(^{*}}}{{=}}/_{ }\), where \(^{d}\) can be either \(\) or \(\). We say that \(f(n) g(n)\) if \(f(n)=O\{g(n)\}\) and \(g(n)=O\{f(n)\}\). Before summarizing the asymptotic power performance, we make the following assumptions:

* There exists some \(_{}>0\) such that \(E\{\|^{*}\|^{2}-E(\|^{*}\|^{2})\}^{2k} E(_{1 }^{}_{2}^{*})^{2k} d^{-k_{}}\) for all \(k^{+}\).
* Let \(k_{0}(x)=k(x^{1/2})\) and \(l_{0}(y)=l(y^{1/2})\). The first and second derivatives of \(k_{0}()\) and \(l_{0}()\) are uniformly bounded away from zero to infinity around \(E\|_{1}^{*}-_{2}^{*}\|^{2}\) and \(E\|_{1}^{*}-_{2}^{*}\|^{2}\), respectively.

We remark here that Assumption (A1) is used to restrict the dependence structures within the coordinates of \(\). Because \(^{*}=/_{}\) and \(E=\), we have \(E^{*}=\) as well. Hence, both \(\|^{*}\|^{2}-E(\|^{*}\|^{2})\) and \(_{1}^{}_{2}^{*}\) are sums of \(d\) random variables with mean zero. Their standardized versions may converge in distribution to standard normal distributions under mild conditions (e.g., mixing conditions) by applying the central limit theorem (CLT). For instance, Volny (1989) established a CLT for non-stationary mixing processes. Alternatively, there exists some \(_{z}>0\) such that \(d^{_{z}/2}\{\|^{*}\|^{2}-E(\|^{*}\|^{2})\}\) and \(d^{_{z}/2}_{1}^{}_{2}^{*}\) both converge in distribution to normal random variables. Then Condition (A1) is satisfied. Assumption (A2) imposes some conditions on the kernels, which covers the Gaussian and Laplacian kernels. Moreover, it also makes several requirements on the bandwidth parameters as well. For example, suppose the Gaussian kernel is used, i.e., \(k_{0}(z)=(-z)\), when \(_{}\) is small enough such that \(E\|_{1}^{*}-_{2}^{*}\|^{2}\), then we have \(k_{0}^{}(E\|_{1}^{*}-_{2}^{*}\|^{2}) 0\), which violates Assumption (A2). Theoretically, the bandwidth parameter \(_{}\) can be chosen from a wide range of values, as long as it satisfies condition (A2). In practice, we use the median of \(\|_{1}-_{2}\|\) as a default value for \(_{}\). When it has the same magnitude with \(E\|_{1}-_{2}\|\), Assumption (A2) can be easily satisfied for many commonly used kernels. Moreover, as demonstrated in the simulated examples in the Supplementary Material, our method exhibits robustness across various selections of \(_{}\).

With these two assumptions, we are ready to provide the asymptotic power performance of the HSIC based test in high dimensions.

**Theorem 2**.: _Assume (A1) and (A2) hold true. Then under the alternative hypothesis, if \(n^{1/2}^{2}(,)\) as \(n\), we have \(n\,^{2}_{n}(,)\) in probability._

Theorem 2 reveals that, as long as the dependence measured by \(^{2}(,)\) is not too small, \(n\,^{2}_{n}(,)\) converges to infinity in probability. This, together with Theorem 1, guarantee that the HSIC based test can have nontrivial power in high dimensions. However, as the dimension increases, the signal measured by \(^{2}(,)\) may decay to zero, which makes the test lose power in high dimensions. To gain more insights about how the power is influenced by the dimensions, it is desired to connect \(^{2}(,)\) with the dimensionality, as well as the association types between \(\) and \(\).

## 4 Statistical Insights in High Dimensions

We have discussed the asymptotic properties of HSIC based tests in high dimensions, and demonstrated that it can detect the alternative hypothesis as long as the signal strength measured by \(^{2}(,)\) does not decay to zero too fast. However, it is still unclear that how \(^{2}(,)\) is influenced by the dimensions. To gain more insights into the performance in high dimensions, in this section, we study what kind of association types the HSIC can detect under different relationships between the sample size and the covariate dimensions. To this end, we expand \(^{2}(,)\) defined in (1) to gain some insights. Because \((,)\) characterizes the dependence between \(\) and \(\), while \((,)\) and \((,)\) are the normalizing factors, we expand \((,)\) and calculate the orders for \((,)\) and \((,)\).

We first calculate the orders for \((,)\) and \((,)\) at the population level as the dimensions diverge to infinity. The results are summarized in the following Proposition.

**Proposition 1**.: _Under Assumptions (A1) and (A2), \((,) d^{-_{}}\) if \(d\)._

According to Proposition 1, the condition \(n^{1/2}^{2}(,)\), which guarantees the HSIC based test would have power approaching 1 in high dimensions, will boil down to \(n^{1/2}p^{_{}/2}q^{_{}/2}( ,)\).

Next, we expand \((,)\) at the population level. Before that, we introduce some additional notations. Similar to Shao & Zhang (2014), we define \(^{2}()\) as

\[^{2}()}}{{=}}E\{(_{1}-E)^{}(_{2}-E)L(_{1},_{2})\},\]

where \((_{1},_{1})\) and \((_{2},_{2})\) are independent copies of \((,)\). We show in Lemma 1 that, \(^{2}()=0\) if and only if \(E()=0\). That is, \(^{2}()\) measures the degree of conditional mean of \(\) given \(\), which quantifies the difference between \(E()\) and \(E\).

**Lemma 1**.: _Assume the kernel \(L(_{1},_{2})=l(\|_{1}-_{2}\|/_{ })\) is a characteristic, bounded continuous, and real-valued positive definite function, then \(^{2}()=0\) if and only if \(E()=0\) almost surely._

We remark here that characteristic condition in Lemma 1 is used to guarantee that the HSIC is nonnegative and equals zero if and only if \(\) and \(\) are independent. One may refer to (Sriperumbudur et al., 2010) for more details about this condition. Furthermore, we let \(k_{0}^{(i)}\) be the \(i\)-th derivative of \(k_{0}()\) evaluated at \(E\|_{1}^{*}-_{2}^{*}\|^{2}\), and \(l_{0}^{(j)}\) is the \(j\)-th derivative of \(l_{0}()\) evaluated at \(E\|_{1}^{*}-_{2}^{*}\|^{2}\). Let \(^{ n}\) be the \(n\)-th kronecker power of \(\), which is defined as \(^{ n}=^{(n-1)}\), \(^{ 1}=\), and \(\) denotes the Kronecker product. In addition, we use \(\|\|_{F}\) to represent the Frobenius norm of a matrix. Then we expand \((,)\) in the following Theorem.

**Theorem 3**.: _Assume (A1) and (A2) hold true. Then under the alternative hypothesis,_1. _when_ \(p\) _and_ \(q\) _remains fixed as_ \(n\)_, if_ \(E(^{ t})=E(^{ t})\) _hold true for all_ \(t<s\) _for some_ \(s^{+}\)_, then_ \((,)=O(p^{-s_{}/2})\)_, and_ \[(,) = k_{0}^{(s)}_{2a+c=s}}{a!a!c!}^{2}( ^{* c}\|^{*}\|^{2a})+o(p^{-s_{ }/2}),\]
2. _when_ \(p\) _and_ \(q\) _as_ \(n\)_, if_ \((^{ t_{1}},^{ t_{2}})\) _only when_ \(t_{1} s_{1}\) _and_ \(t_{2} s_{2}\) _for some_ \(s_{1},s_{2}^{+},\) _then_ \((,)=O(p^{-s_{1}_{}/2}q^{-s_{2} _{}/2})\)_, and_ \[(,)=\] \[+o(p^{-s_{1}_{}/2}q^{-s_{2}_{ }/2}).\]

Theorem 3 enables us to gain some insights into the HSIC in high dimensions. First of all, because when \(2a+c=s\), \(^{ c}\|^{*}\|^{2a}\) is the \(s\)-th polynomial for \(\), and \(^{2}(^{* c}\|^{*}\|^{2a})\) measures the departure from the conditional mean independence of \(\) given \(\). Then the first part of Theorem 3 implies that when \(p\) and \(q\) remains fixed as \(n\), if \(E(^{ t})=E(^{ t})\) hold true for all \(t<s\) for some \(s^{+}\), the HSIC quantifies the departure from \(E(^{ s})=E(^{ s})\). In other words, when only one dimension of the covariates diverges to infinity, the HSIC first measures the conditional mean of \(\) given \(\). If there is no such mean dependence, it turns to measure the conditional mean of \(^{ 2}\) given \(\), etc. Similarly, when \(p\) and \(q\) as \(n\), the second part of Theorem 3 reveals that, the HSIC may first search for the covariance between \(\) given \(\). If such covariance equals zero, it then turns to search for the covariance between \(^{ 2}\) and \(\), or the covariance between \(\) and \(^{ 2}\), etc. Therefore, Theorem 3 characterizes the changing process of the ability to measure nonlinear dependence in high dimensions for HSIC. As a comparison, Zhu et al. (2020) only showed that, when both dimensions diverge much faster than the sample size, the HSIC can only capture the marginal linear dependence. From this point of view, our result is a generalization of theirs.

When the HSIC is used to test for statistical independence, Theorem 2 and Proposition 1 ensure that, when \(n^{1/2}p^{_{}/2}q^{_{}/2}( ,)\), the HSIC based test would have asymptotic power 1. To make this condition hold true, the first part of Theorem 3 implies that when \(p\) and \(q\) remains fixed as \(n\), if there only exists the conditional mean of \(^{ s}\) given \(\), it is required that \(p^{(s-1)_{}}=o(n)\) because \((,)\) is of order \(O(p^{-s_{}/2})\) in this case. In other words, when \(n=O\{p^{(s-1)_{}}\}\), the HSIC based test can have nontrivial power only when there exists the \(i\)-th polynomial mean dependence of \(\) given \(\) for some \(i<s\). Similarly, when both \(p\) and \(q\) diverges as \(n\), the second part of Theorem 3, when there only exists the covariance between \(^{ s_{1}}\) and \(^{ s_{2}}\), the test based on HSIC can have nontrivial power only when \(p^{(s_{1}-1)_{}}q^{(s_{2}-1)_{}}=o(n)\). Because \(_{}\) represents the degree of dependence within covariates, Theorem 3 successfully connects the association type between \(\) and \(\), with the sample size, the high dimensionality, and the dependence structures within covariates. We remark here that Gao et al. (2021) only justified that the test based on distance correlation can have power approaching 1 when \(p=q=o(n^{1/2})\) if there exist a pure nonlinear dependence between \(\) and \(\). Therefore, their result is in spirit a special case of ours.

## 5 Numerical Studies

### Simulations

In this subsection, we conduct some simulation studies to validate our theoretical conclusions on the HSIC based test in high dimensions. In particular, in Example 1, we show that, as long as the dimensions are not very small, the normal approximation can approximate the null distribution quite well, although it requires the dimension to diverge to infinity in theory. In Example 2, we fix the dimension of \(\) and increase the dimension of \(\), and investigate the finite sample power performance of the HSIC based tests under various mean dependence types. In Example 3, we increase the dimensions of \(\) and \(\) simultaneously, and inspect how the empirical power is influenced by the covariate dimensions under different relationships.

Throughout the simulations, we choose two kinds of commonly used kernels to implement the HSIC based tests, i.e., Gaussian and Laplacian. For the Gaussian kernel, we set \(\{-\|_{1}-_{2}\|^{2}/(2_{}^{2})\}\) and \(L(_{1},_{2})=\{-\|_{1}-_{2}\|^{2}/( 2_{}^{2})\}\). While for the Laplacian kernel, we set \(L(_{1},_{2})=(-\|_{1}-_{2}\|/ _{})\) and \(L(_{1},_{2})=(-\|_{1}-_{2}\|/ _{})\). For both choices of kernels, we set the bandwidth parameters to be \(_{}=c_{0}_{}^{m}\) and \(_{}=c_{0}_{}^{m}\) and vary \(c_{0}\) from \(0.5\) to \(2\). Here, \(_{}^{m}\) represents the median of \(\{\|_{i}-_{j}\|\}_{1 i<j n}\), and \(\) is either \(\) or \(\). Due to space constraints, we present results specifically for the case when \(_{}=_{}^{m}\) and \(_{}=_{}^{m}\). The remaining results are summarized in the Supplementary Material. Notably, our findings remain consistent across different values of \(_{}\) and \(_{}\), showing the stability and reliability of our approach.

**Example 1**. In this example, we examine the normal approximation accuracy under the null hypothesis. Towards this goal, we simply generate \(=(X_{1},,X_{p})^{}^{p}\) from a multivariate normal distribution with mean zero and covariance matrix \(_{}=_{p p}\). Then we independently generate \(=(Y_{1},,Y_{q})^{}^{q}\) from another a multivariate normal distribution whose coordinates follow iid standard normal distributions. We fix the sample size to be 100 and consider two scenarios for the covariate dimensions. In the first scenario, we fix \(q=1\) and vary \(p\) from \(\{5,25,100\}\). In the second scenario, we set \(p=q=d\) and vary \(d\) from \(\{2,5,10\}\). For each setting, we repeat the experiments 5000 times and compare the empirical null distributions of the test statistics, \(\{2^{-1/2}n_{n}^{2}(,)\}\), with the standard normal distribution. Specifically, we display the kernel density curves of the test statistics for the two scenarios in Figures 1 and 2, respectively.

According to Figures 1 and 2, we can see that, when the dimensions are small, the normal distribution cannot approximate the null distribution well. For example, when \(p=q=2\), the empirical null distributions for the tests with both Gaussian and Laplacian kernels are quite distinct from the reference curve in Figure 2 (A). However, as the dimensions increase, the accuracy of the normal approximation for the null distribution becomes quite precise, regardless of the choice of the kernels. For example, in both Figures 1 and 2, the empirical null distributions are almost the same as the reference curve as long as \(pq\) are not smaller than 25.

**Example 2**. In this example, we investigate how the empirical power is influenced by the dimension when only one of the covariate dimensions increases. For simplicity, we fix the sample size to be \(n=100\), as that in Example 1. As for the covariate dimensions, we fix \(q=1\) and vary \(p\) from \(\{30,50,100,200,500,1000\}\). We consider three models to inspect the power performances. For Models (I) and (II), we generate \(\) from a multivariate normal distribution with mean zero and covariance matrix \(_{}=(0.5^{|i-j|})_{p p}\). Then we generate an independent error term \(\) that follows standard normal distribution. The univariate response \(Y\) is generated through

Model (I) : \[Y=X_{1}++X_{p}+;\] Model (II) : \[Y=X_{1}^{2}++X_{p}^{2}+.\]

For Model (III), we first generate \(Y N(0,1)\). Conditional on \(Y\), we generate \(\) through

Model (III) : \[\{(X_{2k-1},X_{2k})^{} Y\} N\{,(_{k,Y}^{|i-j| })_{2 2}\}, k=1,,p/2,\]

Figure 1: The kernel densities of the test statistics under the null hypothesis computed from 5000 simulations. We fix \(q=1\) and vary \(p\) from \(\{5,25,100\}\). The horizontal axes represent the observed values of the test statistics, and the vertical axes represent the kernel densities of those values. We choose two different kernels to implement the tests, i.e., Gaussian (dashed line) and Laplacian (dotted line). The solid line is the reference curve, which is the density of the standard normal distribution.

where \(_{k,Y}=(2_{k}-1)(Y)\), \(_{k}\)s are iid Bernoulli(0.5) random variables, and \(()\) is the cumulative distribution function of a standard normal distribution. In addition, \((X_{2k-1},X_{2k})^{}\)s are mutually independent conditional on \(Y\). We remark here that in Model (III), \(X_{k}\) is marginally independent of \(Y\) for all \(k=1,,p\). It can be verified that there exist linear, quadratic and quartic conditional means of \(\) given \(Y\) in Models (I), (II) and (III), respectively.

As we have demonstrated in Example 1, when \(q=1\), the standard normal distribution can approximate the null distribution pretty well as long as \(p\) is no less than \(25\), we use the standard normal distribution to obtain \(p\)-values. We repeat each experiment 500 times and report the empirical powers in Table 1. As a comparison, we also include the results for the distance correlation in Table 1. We can observe that all the empirical powers for Model (I) can still approach one, implying that the linear mean dependence can be easily detected, even when the dimension is much higher than the sample size. For example, when \(p=1000\), the power for Model (I) when the Gaussian kernel is used is still as high as 0.954. However, when there only exists some higher order of mean dependence, the empirical powers drop significantly. In addition, the performances deteriorate as the order of mean dependence increase. For example, when \(p=100\) and we choose the Gaussian kernel to implement the test, the empirical power for Model (III) is only 0.060, which is smaller than 0.484, the empirical power for Model (II).

**Example 3**. In this example, we study how the dimensionality can effect the empirical power when both of the covariate dimensions increase simultaneously. We also fix the sample size to be \(n=100\). We set \(p=q=d\) and vary \(d\) from \(\{6,10,20,50,100,200\}\). Similar to Example 2, we consider three models in this example. For Models (IV) and (V), we generate \(\) the same as that in Models (I) and (II), i.e., \( N\{,(0.5^{[i-j]})_{p p}\}\). The independent error terms \(_{1},,_{d}\) are generated from \(d\) independent standard normal distributions. Then we generate \(=(Y_{1},,Y_{d})^{}\) through

\[: Y_{j}=X_{j}+_{j}, j=1,,d;\]

  Model & Test &  \\   & & 30 & 50 & 100 & 200 & 500 & 1000 \\   & Gaussian & 1.000 & 1.000 & 1.000 & 1.000 & 0.998 & 0.954 \\  & Laplacian & 1.000 & 1.000 & 1.000 & 1.000 & 0.994 & 0.916 \\  & DC & 1.000 & 1.000 & 1.000 & 1.000 & 1.000 & 0.998 \\   & Gaussian & 0.934 & 0.774 & 0.484 & 0.318 & 0.184 & 0.132 \\  & Laplacian & 0.998 & 0.978 & 0.834 & 0.596 & 0.314 & 0.234 \\  & DC & 0.974 & 0.894 & 0.650 & 0.412 & 0.226 & 0.176 \\   & Gaussian & 0.044 & 0.050 & 0.060 & 0.046 & 0.060 & 0.068 \\  & Laplacian & 0.050 & 0.046 & 0.054 & 0.048 & 0.054 & 0.060 \\   & DC & 0.050 & 0.050 & 0.052 & 0.034 & 0.064 & 0.044 \\  

Table 1: The empirical powers of different tests for Models (I)-(III) in Example 2. The significance level is 0.05. We fix \(q=1\) and vary \(p\) from \(\{30,50,100,200,500,1000\}\).

Figure 2: The kernel densities of the test statistics under the null hypothesis computed from 5000 simulations. We set \(p=q=d\) and vary \(d\) from \(\{2,5,10\}\). The horizontal axes represent the observed values of the test statistics, and the vertical axes represent the kernel densities of those values. We choose two different kernels to implement the tests, i.e., Gaussian (dashed line) and Laplacian (dotted line). The solid line is the reference curve, which is the density of the standard normal distribution.

\[: Y_{j}=X_{j}^{2}+_{j}, j=1,,d.\]

For Model (VI), we first generate all coordinates of \(\) independently from standard normal distributions. Then given \(\), we generate \(\) through

\[:\{(X_{2k-1},X_{2k})^{}\} N\{ ,(_{k,}^{[i-j]})_{2 2}\}, k=1,,d/2,\]

where \(_{k,}=(2_{k}-1)(Y_{2k})\) and \(_{k}\)s are iid Bernoulli(0.5) random variables. Meanwhile, we generate \((X_{2k-1},X_{2k})^{}\)s independently conditional on \(\). Similar to Models (I), (II) and (III), there exist covariances between \(\) and linear, quadratic and quartic polynomials of \(\) in Models (IV), (V) and (VI), respectively.

Following that in Example 2, we use the standard normal distribution to obtain \(p\)-values and repeat each experiment 500 times to report the empirical powers. The corresponding results are summarized in Table 2, from which we observe a similar phenomenon. That is, the empirical powers decay as the dimensions increase, and the decay rates increase when there only exist higher orders of covariances between \(\) and \(\). In addition, according to both Tables 1 and 2, the conclusions for the HSIC with Gaussian and Laplacian kernels also apply to the distance correlation. This is in line with our anticipation because the distance correlation is equivalent to the HSIC with some particular kernel.

### Real Data Application

The prices of gasoline and many other fuels may have important impacts on raw materials and related companies. For example, the petroleum is widely used as upstream raw materials by many chemical industries. We are interested in whether there is any dependency between stock prices of the energy sector and the raw material sector in the U.S. stock market. To see this, we extract the monthly mean stock prices of energy companies as well as raw material companies starting from January 2021 to December 2022 from https://finance.yahoo.com/. According to the Global Industry Classification Standard, we get 345 and 294 companies from raw material and energy sectors, respectively. We remove those stocks whose data are not complete in this period, yielding 224 companies from the raw material sector and 214 companies from the energy sector, respectively. At each month \(t\), \(1 t 24\), we denote the monthly mean stock prices of these companies from the two sectors by \(_{t}=(X_{t1},,X_{tp})^{}\) and \(_{t}=(Y_{t1},,Y_{tq})^{}\), where \(p=224\) and \(q=214\). Let \(S_{ti}^{}=(X_{ti}/X_{t-1,i})\) and \(S_{ij}^{}=(Y_{ij}/Y_{t-1,j})\) be the stock returns at month \(t\) for the \(i\)-th company in the raw material sector, and \(j\)-th company in the energy sector, respectively. We test whether the stock returns in these two sectors are independent using \(\{(_{t}^{},_{t}^{})\}_{t=2}^{24}\), where \(_{t}^{}=(S_{t1}^{},,S_{tp}^{})^ {}\) and \(_{t}^{}=(S_{t1}^{},,S_{q}^{})^ {}\). We implement the test using HSIC with Gaussian and Laplacian kernels. The resulting \(p\)-values are \(2.031 10^{-10}\) and \(2.749 10^{-9}\), respectively. Then we can conclude that there exists dependences between the monthly mean stock prices of the energy sector and the raw material sector.

We also compare the RV coefficient with our proposed method in this dataset. The RV coefficient yields a \(p\)-value of \(2.02 10^{-4}\), which indicates the presence of linear dependences in this dataset. We remark that, in this data set, both covariates dimensions \(p\) and \(q\) are much larger than sample size \(n\). According to the second part of Theorem 3 and the discussions at the end of Section 4, the HSIC can only have nontrivial power if \(p^{(s_{1}-1)}q^{(s_{2}-1)_{}}=o(n)\). In the context of our dataset, this

   &  &  \\   & & 6 & 10 & 20 & 50 & 100 & 200 \\   & Gaussian & 1.000 & 1.000 & 1.000 & 1.000 & 1.000 & 1.000 \\  & Laplacian & 1.000 & 1.000 & 1.000 & 1.000 & 1.000 & 1.000 \\  & DC & 1.000 & 1.000 & 1.000 & 1.000 & 1.000 & 1.000 \\   & Gaussian & 1.000 & 1.000 & 0.944 & 0.440 & 0.242 & 0.140 \\  & Laplacian & 1.000 & 1.000 & 1.000 & 0.904 & 0.578 & 0.282 \\  & DC & 1.000 & 0.986 & 0.844 & 0.400 & 0.232 & 0.136 \\   & Gaussian & 0.056 & 0.064 & 0.046 & 0.078 & 0.038 & 0.072 \\  & Laplacian & 0.058 & 0.064 & 0.044 & 0.074 & 0.040 & 0.072 \\   & DC & 0.060 & 0.066 & 0.046 & 0.078 & 0.040 & 0.072 \\  

Table 2: The empirical powers of different tests for Models (IV)-(VI) in Example 3. The significance level is 0.05. We set \(p=q=d\) and vary \(d\) from \(\{6,10,20,50,100,200\}\).

condition is satisfied exclusively when \(s_{1}=s_{2}=1\), signifying a covariance relationship between \(\) and \(\). This together with the fact that the test based on HSIC rejected the null hypothesis, we conclude that there exists a linear dependence relationship between \(\) and \(\). This is consistent with the RV coefficient result. Moreover, we identify that there is a strong linear relationship between stock returns for two pairs of companies: Denison Mines Corp. and Energy Fuels Inc., and Uranium Energy Corp. and Energy Fuels Inc. The \(R^{2}\)s for the corresponding linear models are 0.8779 and 0.8718, respectively. This means that the models fit the data very well and that the stock returns move together in a predictable way.

## 6 Conclusion and Discussion

This paper aims to investigate the performance of HSIC in high dimensions from a theoretical perspective. We first prove that the asymptotic null distribution of a rescaled HSIC is a standard normal in the high dimensional setting. Then we derive a general condition for the HSIC based tests to have power asymptotically approaching one. To gain more insights, we decompose this condition and show that it depends on the sample size, the covariate dimensions, the dependence structures within covariates, and the association types between \(\) and \(\). We also show that the ability of HSIC to detect nonlinear dependence deteriorates as the dimensions increase. Most existing works focused on either fixed dimensions or dimensions that diverge much faster than the sample size. We fill this gap in the literature and provide a comprehensive picture of the performance of HSIC based tests.

Our theory also reveals how the ability of HSIC to capture nonlinear dependence diminishes in high dimensions. To improve the power performance, Zhu et al. (2020) proposed to aggregate marginal sample HSIC as the test statistic instead of using HSIC over the whole features. However, this approach only measures marginal dependences, and it is well known that marginal independence does not imply joint independence. Moreover, because it sums over all pairs of marginal HSIC, it may suffer from a significant power loss when the alternative is sparse. Developing an independence test that has nontrivial power against all kinds of dependences remains an open question. Therefore, it would be interesting to explore new methods that can enhance power performances in high dimensions.