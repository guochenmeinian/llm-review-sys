# Discovery of Novel Reticular Materials for

Carbon Dioxide Capture using GFlowNets

 Flaviu Cipcigan

IBM Research - Europe

flaviu.cipcigan@ibm.com &Jonathan Booth

Science and Technology Facilities Council

jonathan.booth@stfc.ac.uk &Rodrigo Neumann Barros Ferreira

IBM Research

rneumann@br.ibm.com &Carine Ribeiro dos Santos

IBM Research

carineribeiro@ibm.com &Mathias Steiner

IBM Research

mathiast@br.ibm.com

###### Abstract

Artificial intelligence holds promise to improve materials discovery. GFlowNets are an emerging deep learning algorithm with many applications in AI-assisted discovery. Using GFlowNets, we generate porous reticular materials, such as metal organic frameworks and covalent organic frameworks, for applications in carbon dioxide capture. We introduce a new Python package (matgfn) to train and sample GFlowNets. We use matgfn to generate the matgfn-rm dataset of novel and diverse reticular materials with gravimetric surface area above 5000 m\({}^{2}\)/g. We calculate single- and two-component gas adsorption isotherms for the top-100 candidates in matgfn-rm. These candidates are novel compared to the state-of-art ARC-MOF dataset and rank in the 90\({}^{}\) percentile in terms of working capacity compared to the CoRE2019 dataset. We discover 15 hypothetical materials outperforming all materials in CoRE2019.

## 1 Introduction

Artificial intelligence (AI) holds promise to improve the scientific method  and to accelerate scientific discovery. Applied to materials 1, AI unlocks vast search spaces and enables novel applications in pharmaceuticals , batteries or carbon capture .

Reticular materials  such as Metal-Organic Frameworks (MOFs) and Covalent Organic Frameworks (COFs) are extended periodic structures connected via strong bonds . They are synthesized by connecting building blocks known as secondary building units to form three-dimensional periodic structures . By choosing the building blocks, the properties of a reticular material can be tuned to support many applications .

Reticular materials with high gravimetric surface area are particularly useful for applications in carbon capture, since carbon dioxide molecules adsorb at the internal surface area . The larger the gravimetric surface area, the more gas molecules can be adsorbed per gram of material.

In this work, we use GFlowNets to generate reticular materials with high gravimetric surface area for applications in carbon capture. Our key contributions are:

1. The matgfn Phython library for training and sampling using GFlowNets.
2. A workflow using matgfn to generate reticular materials using secondary building units.

3. The matgfn-rm dataset of diverse and novel reticular materials with total internal surface area higher than 5000 m\({}^{2}\) g\({}^{-1}\). The top-100 reticular materials candidates are novel compared to the reference ARC-MOF dataset, rank in the 90th percentile in terms of simulated working capacity compared to the CoRE2019 dataset. We discover 15 hypothetical materials outperforming all materials in CoRE2019.

The code and dataset will be available at http://github.com/flaviucipcigan/matgfn and archived on Zenodo .

## 2 Background and related work

**Generative Flow Networks** GFlowNets [3; 4] are an emerging machine learning algorithm with many applications in AI-assisted materials discovery . GFlowNets learn to generate composite objects \(\) by sampling from an unnormalised distribution \(p() R()\) where \(R()\) is a user-specified positive reward function. A composite object \(\) consists of symbols drawn from a vocabulary \(\) and relationships between those symbols. For example, \(\) can be a sequence \(=[x_{1},x_{2}, x_{n}]\) or a graph. The object \(\) is built by through Markov Decision Process restricted to a directed acyclic graph. Transition probabilities \(p(x_{i+1}\,|\,)\) are approximated by a neural network called a flow model. GFlowNets need fewer evaluations of the reward function to generate samples with high reward, novelty and diversity when compared to alternatives such as Markov Chain Monte Carlo, Proximal Policy Optimisation or Bayesian Optimisation .

**Building hypothetical reticular frameworks** Trillions of hypothetical frameworks such as MOFs or COFs can be generated by placing secondary building units  into nodes and edges of a three dimensional topology . A secondary building unit is an organic molecule or a coordination compound (a metal linked to organic atoms). A topology is a three dimensional arrangement of nodes and edges. Replacing nodes and edges with secondary building units results in a three dimensional point cloud of atoms connected by covalent or metal-organic bonds. We use the pomake secondary building units  and topology codes from the Reticular Chemistry Structure Resource . Previously, deep autoencoders  and evolutionary methods  have been used to generate frameworks using this approach.

**Reference datasets** We use two reference datasets in this work. These datasets are not used for training models, but as comparison once training is done, as GFlowNet generates candidates using just a reward function. The CoRE2019 dataset  consists of 12,023 metal-organic frameworks with carbon dioxide uptake properties calculated by Moosavi _et al._ using Grand Canonical Monte Carlo. ARC-MOF (reported in 2022)  is a collection of 279,610 MOFs from previous MOF datasets. It contains both experimental and hypothetical MOFs.

## 3 Generating reticular frameworks with GFlowNets

**Python package** We built a Python library called matgfn to train and sample GFlowNets. The library is built on top of PyTorch  and Gymnasium  and Priorities ease of use and code readability. We intend for matgfn to be a general Python package for generation of diverse types of materials from small molecules to framework materials. Architecturally, matgfn separates sampling, loss calculation, optimisation, and environment definition as modular Python classes. Each can be modified individually, to implement off-policy training or use improved losses, for example. We note similar architectural choices for torchgfn.

**Environment for reticular framework generation** We configure a GFlowNet environment to build string sequences made out of text tokens. Those text tokens start with either an N, representing a node building block, or an E, representing an edge building

Figure 1: Regression of simulated high pressure CO\({}_{2}\) uptake to gravimetric surface area

block. For example, one of the potential generated sequences is ["N577", "N238", "N194", "E5", "E3", "E74"]. We use building blocks in the pormake database. The string sequences are transformed to a Crystallographic Information File (*.cif) by pormake to create a reticular framework. Not all strings create valid materials. Thus, during generation, building blocks were restricted such that (a) each topology had the correct number of nodes and edges, (b) the building blocks were placed in the correct order and (c) each slot had a compatible building block.

**Reward** We calculate the Gravimetric Surface Area \(GSA\) in m\({}^{2}\)/g with Zeo++  during the training loop of the GFlowNet. We configure Zeo++ with a probe radius of \(1.525\,\) and 2000 samples. The GFlowNet is given the following reward:

\[R()=(GSA()-C)*( )-C}{C})\] (1)

where \((x)\) is the Heaviside step function \((x)=0\) if \(x<0,1\) if \(x 0\) and \(C\) is a cutoff. Zeo++ and pormake sometimes raise errors due to large distances between atoms. The reward is zero when an error occurred to encourage the GFlowNet to avoid materials with unrealistic bond lengths.

**Relationship with CO2 capture** We demonstrate that the gravimetric surface area predicts CO2 uptake by analysing approximately 30,000 MOFs from three databases: CoRE2019 , ARABG  and BW20K . We performed univariate linear regression of CO2 uptake at 16 bar using each of the geometric and chemical descriptors. The best performing descriptor was the gravimetric surface area with coefficient of determination is 0.88, RMSE is 2.41 mol kg\({}^{-1}\) and Spearman's rank correlation coefficient of 0.97. Figure 1 shows the CO2 uptake as a function of gravimetric surface area. We validated the regression using 50 rounds of 10-fold cross validation, with each cross-validation consisting of an 80-20 split between training and test data. The mean coefficient of determination is \(0.88 0.0002\) and mean RMSE is \(2.41 0.022\) mol/kg. The training and test values of coefficient of determination and RMSE are the same to two decimal places and the standard deviation of these metrics during cross validation are very small which shows that the correlation is robust and stable.

## 4 The matgfn-rm dataset

**Training** We trained a GFlowNet using Trajectory Balance loss  and an LSTM flow model. We use a learning rate of \(5 10^{-3}\) for both the flow model and the partition function. We train for a maximum of 100,000 episodes and stop when the mean loss over 10,000 episodes is lower than 1.8. Eleven topologies were chosen: CDZ-E, CLD-E, EFT, FFC, TSG, TFF, ASC, DMG, DNQ, FSO, URJ. For each topology, two GFlowNets were trained, one with edges and one without. The performance is shown in Supplementary Information. Once the GFlowNets have been trained, they were sampled to generate matgfn-rm dataset of over 1 million hypothetical reticular frameworks.

**Diversity analysis** We compare the top-100 and top-100,000 candidates from matgfn-rm to the ARC-MOF dataset. For each CIF file, we compute the average minimum distance (AMD) descriptor  of length 100. This descriptor uniquely identifies crystal structures and is a continuous metric, meaning that the distance (measured using the Chebyshev metric) is zero for similar crystals. For visualisation, we perform dimensionality reduction to two dimensions using t-SNE implemented. We chose the implementation in openTSNE , use the Chebyshev distance metric and calculate nearest neighbours using nearest neighbour descent . Figure 2 shows the result. The matgfn-rm materials are separated from most materials from ARC-MOF. Thus, the generated materials are novel compared to existing datasets. For a clearer view of some of the overlapping regions, check Figure 18.

**Simulated CO2 capture performance** In order to confirm the expectation of efficient CO2 capture from an adsorption proxy (_i.e._, the gravimetric surface area), we run Physics-based Grand Canonical Monte Carlo simulations for the top-100 generated materials in the matgfn-rm dataset [26; 28]. We simulated single-component adsorption isotherms for pure CO2, from which we extract the CO2 working capacity, and dual-component adsorption isotherms for dry flue gas (15% CO2 and 85% N2), from which we extract the CO2 / N2 selectivity. All simulations were performed at 300 K, with pressures ranging from 0.15 to 16 bar. The working capacity was calculated as the difference in uptake of (single-component) CO2 between 16 and 0.15 bar, while the selectivity was calculated as \(S=(Q_{CO_{2}}/Q_{N_{2}})/(f_{CO_{2}}/f_{N_{2}})\), where \(Q_{i}\) is the uptake of species \(i\) at 0.15 bar and \(f_{i}\) is the concentration of species \(i\) in the input flue gas stream. Figure 3 shows the distribution of absolute (working capacity) and relative (selectivity) capture metrics for the top-100 matgfn-rm materials. All top-100 materials are (modestly) more selective towards CO\({}_{2}\) than N\({}_{2}\) and exhibit very high CO\({}_{2}\) working capacities, corresponding to the 90\({}^{ th}\) percentile of the experimentally-realised CoRE2019 dataset . Fifteen of the top-100 matgfn-rm materials have working capacities that are higher than all materials found in the CoRE2019 dataset. In particular, we highlight in Figure 4 the covalent organic framework 005-ffc-10217 that achieved the highest CO\({}_{2}\) working capacity of approximately 44 mol/kg.

**Relaxation and validity check** Due to the hypothetical nature of the generated MOFs, the crystalline structures are not guaranteed to be perfect. We therefore used the mofchecker library  to perform basic consistency checks on the generated CIFs. According to mofchecker, all of the top-100 matgfn-rm are porous (metal-) organic materials. However, due to the hypothetical interatomic distances sometimes being larger (or shorter) than the typical bond lengths, some atoms are flagged as either over- or under-coordinated. In order to obtain a more realistic structure, we performed atomic coordinate and unit cell relaxation using the CHGNet  interatomic potential. Relaxing the structures solves most of the structural problems, with 98% presenting neither atomic overlaps nor over-coordination of C, N and H atoms, respectively. In particular, for the high-performing 005-ffc-10217 structure, relaxation led to a 23% reduction in the unit cell volume, bringing the CO\({}_{2}\) working capacity down to 37.5 mol/kg, which is still larger than those found in the CoRE2019 dataset. The relaxed pore size of 005-ffc-10217 is approximately 87 A. Structural relaxation changes the average minimum

Figure 4: A render of the relaxed structure of 005-ffc-10217, the highest performing structure in the matgfn-rm dataset. We show here the \(2 2 2\) supercell.

Figure 3: Simulated CO\({}_{2}\) working capacity and CO\({}_{2}\) / N\({}_{2}\) selectivity for the top-100 matgfn-rm materials. The (red) dashed line represents the highest working capacity found in the CoRE2019 dataset, which is surpassed by 15 of the top-100 matgfn-rm materials.

Figure 2: Two dimensional t-SNE embedding of the average minimum distance of ARC-MOF (green), and matgfn-rm (yellow to orange) materials. The colours in the matgfn-rm dataset are proportional to the reward, with light yellow signifying low reward and dark orange high reward.

distance descriptors by a small amount and thus the diversity analysis still holds. See Figure 18 for an illustration of the effect of relaxation on the t-SNE embeddings.

## 5 Conclusion

In summary, we built a workflow using GFlowNets to generate diverse and novel reticular frameworks with gravimetric surface area greater than 5000 m\({}^{2}\)/g. As a key result, the top-100 candidates of the resulting matgfn-rm dataset have working capacities in the top 90th percentile of CoRE2019 reference dataset. Moreover, 15 of the top-100 matgfn-rm materials have working capacities that are higher than all materials found in the CoRE2019 dataset. Further tests are underway to confirm the stability and synthesizability of the materials generated in our study. Nevertheless, our results clearly demonstrate the potential of GFlowNets for materials discovery in carbon capture applications.

## 6 Contributions

**Flaviu Cipcigan: Project**: Conceptualisation, Project Administration. **Paper**: Writing - coordination, Writing - original draft, Writing - review & editing. **Software**: Main author of matgfn, contributor to MOF application code, **Results**: Methodology, Experiments, Formal Analysis, Validation, diversity analysis of matgfn-rm

**Jonathan Booth: Project**: Project Administration, trained GFlowNets on MOF topologies **Paper**: Writing - MOF result section, Writing - review & editing. **Software**: created reward function and other necessary code for MOF application of GFlownets **Results**: Methodology, Experiments, Formal Analysis, Validation

**Rodrigo Neumann Barros Ferreira: Paper**: Writing - original draft, Writing - review & editing. **Results**: Validation and simulations of matgfn-rm dataset.

**Carine Ribeiro dos Santos**: Results**: Validation and simulations of matgfn-rm dataset.

**Mathias Steiner**: Project**: Project Administration. **Paper**: Writing - original draft, Writing - review & editing.

## 7 Acknowledgements

We thank Dan Cunningham and Won Kyung Lee for valuable comments on the manuscript. Flaviu Cipcigan and Jonathan Booth were supported by the Hartree National Centre for Digital Innovation, a collaboration between STFC and IBM.