# No-Regret Learning in Dynamic Competition with Reference Effects Under Logit Demand

Mengzi Amy Guo

IEOR Department

UC Berkeley

mengzi_guo@berkeley.edu &Donghao Ying

IEOR Department

UC Berkeley

donghaoy@berkeley.edu &Javad Lavaei

IEOR Department

UC Berkeley

lavaei@berkeley.edu &Zuo-Jun Max Shen

IEOR Department

UC Berkeley

maxshen@berkeley.edu

###### Abstract

This work is dedicated to the algorithm design in a competitive framework, with the primary goal of learning a stable equilibrium. We consider the dynamic price competition between two firms operating within an opaque marketplace, where each firm lacks information about its competitor. The demand follows the multinomial logit (MNL) choice model, which depends on the consumers' observed price and their reference price, and consecutive periods in the repeated games are connected by reference price updates. We use the notion of stationary Nash equilibrium (SNE), defined as the fixed point of the equilibrium pricing policy for the single-period game, to simultaneously capture the long-run market equilibrium and stability. We propose the online projected gradient ascent algorithm (OPGA), where the firms adjust prices using the first-order derivatives of their log-revenues that can be obtained from the market feedback mechanism. Despite the absence of typical properties required for the convergence of online games, such as strong monotonicity and variational stability, we demonstrate that under diminishing step-sizes, the price and reference price paths generated by OPGA converge to the unique SNE, thereby achieving the no-regret learning and a stable market. Moreover, with appropriate step-sizes, we prove that this convergence exhibits a rate of \((1/t)\).

## 1 Introduction

The memory-based reference effect is a well-studied strategic consumer behavior in marketing and economics literature, which refers to the phenomenon that consumers shape their price expectations (known as reference prices) based on the past encounters and then use them to judge the current price (see  for a review). A substantial body of empirical research has shown that the current demand is significantly influenced by the historical prices through reference effects (see, e.g., ). Driven by the ubiquitous evidence, many studies have investigated various pricing strategies in the presence of reference effects . However, the aforementioned works have all focused on the case with a monopolistic seller, leaving the understanding of how the reference effect functions in a competition relatively limited compared to its practical importance. This issue becomes even more pronounced with the surge of e-commerce, as the increased availability of information incentivizes consumers to make comparisons among different retailers.

Moreover, we notice that in competitive markets, the pricing problem with reference effects is further complicated by the lack of transparency, where firms are cautious about revealing confidential information to their rivals. Although the rise of digital markets greatly accelerates data transmission and promotes the information transparency, which is generally considered beneficial because of the improvement in marketplace efficiency , many firms remain hesitant to fully embrace such transparency for fear of losing their informational advantages. This concern is well-founded in the literature, for example the work  demonstrates that dealers with lower transparency levels generate higher profits than their more transparent counterparts, and  highlights that in reverse auctions, transparency typically enables buyers to drive the price down to the firm's marginal cost. Hence, as recommended by , companies should focus on the strategic and selective disclosure of information to enhance their competitive edge, rather than pursuing complete transparency.

Inspired by these real-world practices, in this article, we study the _duopoly competition with reference effects in an opaque market_, where each firm has access to its own information but does not possess any knowledge about its competitor, including their price, reference price, and demand. The consumer demand follows the multinomial logit (MNL) choice model, which naturally reflects the cross-product effects among substitutes. Furthermore, given the intertemporal characteristic of the memory-based reference effect, we consider the game in a dynamic framework, i.e., the firms engage in repeated competitions with consecutive periods linked by reference price updates. In this setting, it is natural to question _whether the firms can achieve some notion of stable equilibrium by employing common online learning algorithms to sequentially set their prices_. A vast majority of the literature on online games with incomplete information targets the problem of finding no-regret algorithms that can direct agents toward a Nash equilibrium, a stable state at which the agents have no incentive to revise their actions (see, e.g., [14; 15; 16]). Yet, the Nash equilibrium alone is inadequate to determine the stable state for our problem of interest, given the evolution of reference prices. For instance, even if an equilibrium price is reached in one period, the reference price update makes it highly probable that the firms will deviate from this equilibrium in subsequent periods. As a result, to jointly capture the market equilibrium and stability, we consider the concept of _stationary Nash equilibrium_ (SNE), defined as the fixed point of the equilibrium pricing policy for the single-period game. Attaining this long-term market stability is especially appealing for firms in a competitive environment, as a stable market fosters favorable conditions for implementing efficient planning strategies and facilitating upstream operations in supply chain management . In contrast, fluctuating demands necessitate more carefully crafted strategies for effective logistics management [18; 19; 20].

The concept of SNE has also been investigated in  and . Specifically,  examines the long-run market behavior in a duopoly competition with linear demand and a common reference price for both products. However, compared to the MNL demand in our work, linear demand models generally fall short in addressing interdependence among multiple products [4; 23; 24]. On the other hand,  adopts the MNL demand with product-specific reference price formulation; yet, their analysis of long-term market dynamics relies on complete information and is inapplicable to an opaque market. In contrast, our work accommodates both the partial information setting and MNL choice model. We summarize our main contributions below:

1. _Formulation._ We introduce a duopoly competition framework with an opaque market setup that takes into account both cross-period and cross-product effects through consumer reference effects and the MNL choice model. We use the notion of _stationary Nash equilibrium_ (SNE) to simultaneously depict the equilibrium price and market stability.
2. _Algorithm and convergence._ We propose a no-regret algorithm, namely the _Online Projected Gradient Ascent_ (OPGA), where each firm adjusts its posted price using the first-order derivative of its log-revenue. When the firms execute OPGA with diminishing step-sizes, we show that their prices and reference prices converge to the unique SNE, leading to the long-run market equilibrium and stability. Furthermore, when the step-sizes decrease appropriately in the order of \((1/t)\), we demonstrate that the prices and reference prices converge at a rate of \((1/t)\).
3. _Analysis._ We propose a novel analysis for the convergence of OPGA by exploiting characteristic properties of the MNL demand model. General convergence results for online games typically require restrictive assumptions such as strong monotonicity [25; 14; 16] or variational stability [26; 15; 27; 28], as well as the convexity of the loss function [29; 30]. However, our problem lacks these favorable properties, rendering the existing techniques inapplicable. Additionally, compared to standard games where the underlying environment is static, the reference price evolution in this work further perplexes the convergence analysis.

4. _Managerial insights._ Our study illuminates a common issue in practice, where the firms are willing to cooperate but are reluctant to divulge their information to others. The OPGA algorithm can help address this issue by guiding the firms to achieve the SNE as if they had perfect information, while still preserving their privacy.

## 2 Related literature

Our work on the dynamic competition with reference effects in an opaque market is related to the several streams of literature.

**Modeling of reference effect.** The concept of reference effects can be traced back to the adaptation-level theory proposed by , which states that consumers evaluate prices against the level they have adapted to. Extensive research has been dedicated to the formulation of reference effects in the marketing literature, where two mainstream models emerge: memory-based reference price and stimulus-based reference price . The memory-based reference model, also known as the internal reference price, leverages historical prices to form the benchmark (see, e.g., [3; 32; 5]). On the contrary, the stimulus-based reference model, or the external reference price, asserts that the price judgment is established at the moment of purchase utilizing current external information such as the prices of substitutable products, rather than drawing on past memories (see, e.g., [33; 2]). According to the comparative analysis by , among different reference models, the memory-based model that relies on a product's own historical prices offers the best fit and strongest predictive power in multi-product settings. Hence, our paper adopts this type of reference model, referred to as the brand-specific past prices formulation in .

**Dynamic pricing in monopolist market with reference effect.** The research on reference effects has recently garnered increasing attention in the field of operations research, particularly in monopolist pricing problems. As memory-based reference effect models give rise to the intertemporal nature, the price optimization problem is usually formulated as a dynamic program. Similar to our work, their objectives typically involve determining the long-run market stability under the optimal or heuristic pricing strategies. The classic studies by  and  show that in either discrete- or continuous-time framework, the optimal pricing policy converges and leads to market stabilization under both loss-neutral and loss-averse reference effects. More recent research on reference effects primarily concentrates on the piecewise linear demand in single-product contexts and delves into more comprehensive characterizations of myopic and optimal pricing policies (see, e.g., [34; 8]). Deviating from the linear demand,  and  employ the logit demand and analyze the long-term market behaviors under the optimal pricing policy, where the former emphasizes on consumer heterogeneity and the later innovates in the multi-product setting.

While the common assumption in the aforementioned studies is that the firm knows the demand function, another line of research tackles the problem under uncertain demand, where they couple monopolistic dynamic pricing with reference effects and online demand learning [35; 36]. Although these works include an online learning component, our paper distinguishes itself from them in two aspects. Firstly, the uncertainty that needs to be learned is situated in different areas. The works by  and  assume that the seller recognizes the structure of the demand function (i.e., linear demand) but requires to estimate the model's responsiveness parameters. By contrast, in our competitive framework, the firms are aware of their own demands but lack knowledge about their rivals that should be learned. Secondly, the objectives of  and  are to design algorithms to boost the total revenues from a monopolist perspective, whereas our algorithm aims to guide firms to reach Nash equilibrium and market stability concurrently.

**Price competition with reference effects.** Our work is pertinent to the studies on price competition with reference effects [37; 38; 21; 39; 22]. In particular,  is concerned with single-period price competitions under various reference price formulations. The paper  expands the scope to a dynamic competition with symmetric reference effects and linear demand, though their theoretical analysis on unique subgame perfect Nash equilibrium is confined to a two-period horizon. The more recent work  further extends the game to the multi-stage setting, where they obtain the Markov perfect equilibrium for consumers who are either loss-averse or loss-neutral. Nonetheless, unlike the discrete-time framework in  and this paper,  employs the continuous-time framework, which significantly differs from its discrete-time counterpart in terms of analytical techniques. The recent article  also studies the long-run market behavior and bears similarity to our work in model formulations. However, a crucial difference exists:  assumes a transparent market setting,whereas we consider the more realistic scenario where the market is opaque and firms cannot access information of their competitors.

More closely related to our work, the work  also looks into the long-run market stability of the duopoly price competition in an opaque marketplace. However, there are two notable differences between our paper and theirs. The key distinction lies in the selection of demand function. We favor the logit demand over the linear demand used in , as the logit demand exhibits superior performance in the presence of reference effects [23; 9]. However, the logit model imposes challenges for convergence result since a crucial part of the analysis in  hinges on the demand linearity [21; Lemma 9.1], which is not satisfied by the logit demand. Second,  assumes a uniform reference price for both products, whereas we consider the product-specific reference price, which has the best empirical performance as illustrated in . These adaptations, even though beneficial to the expressiveness and flexibility of the model, render the convergence analysis in  not generalizable to our setting.

**General convergence results for online games.** Our paper is closely related to the study of online games, where a typical research question is whether online learning algorithms can achieve the Nash equilibrium for multiple agents who aim to minimize their local loss functions. In this section, we review a few recent works in this field. For games with continuous actions,  and  show that the online mirror descent converges to the Nash equilibrium in strongly monotone games. The work  further relaxes the strong monotonicity assumption and examines the last-iterate convergence for games with unconstrained action sets that satisfy the so-called "cocoercive" condition. In addition,  and  establish the convergence of the dual averaging method under a more general condition called global variational stability, which encompasses the cocoercive condition as a subcase. More recently, [41; 27; 28] demonstrate that extra-gradient approaches, such as the optimistic gradient method, can achieve faster convergence to the Nash equilibrium in monotone and variationally stable games. We point out that in the cited literature above, either the assumption itself implies the convexity of the local loss function such as the strong monotonicity or the convergence to the Nash equilibrium additionally requires the loss function to be convex. By contrast, in our problem, the revenue function of each firm is not concave in its price and does not satisfy either of the properties listed above. Additionally, incorporating the reference effect further complicates the analysis, as the standard notion of Nash equilibrium is insufficient to characterize convergence due to the dynamic nature of reference price.

## 3 Problem formulation

### MNL demand model with reference effects

We study a duopoly price competition with reference price effects, where two firms each offer a substitutable product, labeled as \(H\) and \(L\), respectively. Both firms set prices simultaneously in each period throughout an infinite-time horizon. To accommodate the interaction between the two products, we employ a multinomial logit (MNL) model, which inherently captures such cross-product effects. The consumers' utility at period \(t\), which depends on the posted price \(p_{i}^{t}\) and reference price \(r_{i}^{t}\), is defined as:

\[U_{i}(p_{i}^{t},r_{i}^{t})=u_{i}(p_{i}^{t},r_{i}^{t})+ _{i}^{t}=a_{i}-b_{i} p_{i}^{t}+c_{i}(r_{i}^{t}-p_{i}^ {t})+_{i}^{t}, i\{H,L\},\] (1)

where \(u_{i}(p_{i}^{t},r_{i}^{t})\) is the deterministic component, and \((a_{i},b_{i},c_{i})\) are the given parameters. In addition, the notation \(_{i}^{t}\) denotes the random fluctuation following the i.i.d. standard Gumbel distribution. According to the random utility maximization theory , the demand/market share at period \(t\) with the posted price \(^{t}=(p_{H}^{t},p_{L}^{t})\) and reference price \(^{t}=(r_{H}^{t},r_{L}^{t})\) for product \(i\{H,L\}\) is given by

\[d_{i}^{t},^{t}=d_{i}(p_{i}^{t},p_{-i} ^{t}),(r_{i}^{t},r_{-i}^{t})=u_{i}(p_{i}^{t},r_{i}^{t} )}{1+u_{i}(p_{i}^{t},r_{i}^{t})+u_{-i}(p_{ -i}^{t},r_{-i}^{t})},\] (2)

where the subscript \(-i\) denotes the other product besides product \(i\). Consequently, the expected revenue for each firm/product at period \(t\) can be expressed as

\[_{i}(^{t},^{t})=_{i}(p_{i}^{t},p_{-i}^{t}),( r_{i}^{t},r_{-i}^{t})=p_{i}^{t} d_{i}(^{t},^{t}),  i\{H,L\}.\] (3)

The interpretation of parameters \((a_{i},b_{i},c_{i})\) in Eq. (1) is as follows. For product \(i\{H,L\}\), \(a_{i}\) refers to product's intrinsic value, \(b_{i}\) represents consumers' responsiveness to price, also known as price sensitivity, and \(c_{i}\) corresponds to the reference price sensitivity. When the offered price exceeds the internal reference price \((r_{i}^{t}<p_{i}^{t})\), consumers perceive it as a loss or surcharge, whereas the price below this reference price \((r_{i}^{t}>p_{i}^{t})\) is regarded as a gain or discount. These sensitivity parameters are assumed to be positive, i.e., \(b_{i},c_{i}>0\) for \(i\{H,L\}\), which aligns with consumer behaviors towards substitutable products and has been widely adopted in similar pricing problems (see, e.g., [34; 8; 21; 24; 22]). Precisely, this assumption guarantees that an increase in \(p_{i}^{t}\) would result in a lower consumer utility for product \(i\), which in turn reduces its demand \(d_{i}(^{t},^{t})\) and increases the demand of the competing product \(d_{-i}(^{t},^{t})\). Conversely, a rise in the reference price \(r_{i}^{t}\) increases the utility for product \(i\), consequently influencing the consumer demands in the opposite direction.

We stipulate the feasible range for price and reference price to be \(=[p,]\), where \(p,>0\) denote the price lower bound and upper bound, respectively. This boundedness of prices is in accordance with real-world price floors or price ceilings, whose validity is further reinforced by its frequent use in the literature on price optimization with reference effects (see, e.g., [34; 8; 21]).

We formulate the reference price using the brand-specific past prices (_PastBRSP_) model proposed by , which posits that the reference price is product-specific and memory-based. This model is preferred over other reference price models evaluated in , as it exhibits superior performance in terms of fit and prediction. In particular, the reference price for product \(i\) is constructed by applying exponential smoothing to its own historical prices, where the memory parameter \(\) governs the rate at which the reference price evolves. Starting with an initial reference price \(r_{0}\), the reference price update for each product at period \(t\) can be described as

\[r_{i}^{t+1}= r_{i}^{t}+(1-) p_{i}^{t}, i \{H,L\}, t 0.\] (4)

The exponential smoothing technique is among the most prevalent and empirically substantiated reference price update mechanism in the existing literature (see, e.g., [7; 1; 6; 34; 8]). We remark that the theories established in this work are readily generalizable to the scenario of time-varying memory parameters \(\), and we present the static setting only for the sake of brevity.

### Opaque market setup

In this study, we consider the partial information setting where the firms possess no knowledge of their competitors, their own reference prices, as well as the reference price update scheme. Each firm \(i\) is only aware of its own sensitivity parameters \(b_{i},c_{i}\), and its previously posted price. Under this configuration, the firms cannot directly compute their demands from the expression in Eq. (2). However, it is legitimate to assume that each firm can access its own last-period demands through market feedback, i.e., determining the demand as the received revenue divided by the posted price. We point out that, in this non-transparent and non-cooperative market, the presence of feedback mechanisms is crucial for price optimization.

### Market equilibrium and stability

The goal of our paper is to find a simple and intuitive pricing mechanism for firms so that the market equilibrium and stability can be achieved in the long-run while protecting firms' privacy. Before introducing the equilibrium motion considered in this work, we first define the _equilibrium pricing policy_ denoted by \(^{}()=p_{H}^{}(),p_{L}^{} ()\), which is a function that maps reference price to price and achieves the pure strategy Nash equilibrium in the single-period game. Mathematically, the equilibrium pricing policy satisfies that

\[p_{i}^{}()=*{arg\,max}_{p_{i}}\;p_{i } d_{i}(p_{i},p_{-i}^{}()),,  i\{H,L\}.\] (5)

Next, we formally introduce the concept of stationary Nash equilibrium, which is utilized to jointly characterize the market equilibrium and stability.

**Definition 3.1** (Stationary Nash equilibrium): _A point \(^{}\) is considered a stationary Nash equilibrium (SNE) if \(^{}(^{})=^{}\), i.e., the equilibrium price is equal to its reference price._

The notion of SNE has also been studied in [21; 22]. From Eq. (5) and Definition 3.1, we observe that an SNE possesses the following two properties:* **Equilibrium.** The revenue function for each firm \(i\{H,L\}\) satisfies \(_{i}(p_{i},p_{-i}^{}),^{}_ {i}^{},^{}\) for all \(p_{i}\), i.e., when the reference price and firm \(-i\)'s price are equal to the SNE price, the best-response price for firm \(i\) is the SNE price \(p_{i}^{}\).
* **Stability.** If the price and the reference price attain the SNE at some period \(t\), the reference price remains unchanged in the following period, i.e., \(^{t}=^{t}=^{}\) implies that \(^{t+1}=^{}\).

As a result, when the market reaches the SNE, the firms have no incentive to deviate, and the market remains stable in subsequent competitions. The following proposition states the uniqueness of the SNE and characterizes the boundedness of the SNE.

**Proposition 3.1**: _There exists a unique stationary Nash equilibrium, denoted by \(^{}=(p_{H}^{},p_{L}^{})\). In addition, it holds that_

\[+c_{i}}<p_{i}^{}<+c_{i}}+} W(}{b_{i}+c_{i}}(a_{i}-}{b_{i}+c_{i}} )), i\{H,L\},\] (6)

_where \(W()\) is the Lambert \(W\) function (see definition in Eq. (22))._

Without loss of generality, we assume that the feasible price range \(^{2}=[,]^{2}\) is sufficiently large to contain the unique SNE, i.e., \(^{}[,]^{2}\). Proposition 3.1 provides a quantitative characterization for this assumption: it suffices to choose the price lower bound \(\) to be any real number between \(0,_{i\{H,L\}}\{1/(b_{i}+c_{i})\}\), and the price upper bound \(\) can be any value such that

\[_{i\{H,L\}}\{+c_{i}}+ }W(}{b_{i}+c_{i}}(a_{i}-}{b_{i}+c_{i}} ))\}.\] (7)

This assumption is mild as the bound in Eq. (7) is independent of both the price and reference price, and it does not grow exponentially fast with respect to any parameters. Hence, there is no need for \(\) to be excessively large. For example, when \(a_{H}=a_{L}=10\) and \(b_{H}=b_{L}=c_{H}=c_{L}=1\), Eq. (7) becomes \( 7.3785\). We refer the reader to Appendix B for further discussions on the structure and computation of the equilibrium pricing policy and SNE, as well as the proof of Proposition 3.1.

## 4 No-regret learning: Online Projected Gradient Ascent

In this section, we examine the long-term dynamics of the the price and reference price paths to determine if the market stabilizes over time. As studied in , under perfect information, the firms operating with full rationality will follow the equilibrium pricing policy in each period, while those functioning with bounded rationality will adhere to the best-response pricing policy throughout the planning horizon. In both situations, the market would stabilize in the long run. However, with partial information, the firms are incapable of computing either the equilibrium or the best-response policies due to the unavailability of reference prices and their competitor's price. Thus, one viable strategy to boost firms' revenues is to dynamically modify prices in response to market feedback.

In light of the success of gradient-based algorithms in the online learning literature (see, e.g., [43; 44; 45]), we propose the Online Projected Gradient Ascent (OPGA) method, as outlined in Algorithm 1. Specifically, in each period, both firms update their current prices using the first-order derivatives of their log-revenues with the same learning rate (see Eq. (9)). It is noteworthy that the difference between the derivatives of the log-revenue and the standard revenue is a scaling factor equal to the revenue itself, i.e.,

\[(,))}{ p_{i} }=(,)}(,))}{ p_{i}}, i\{H,L\}.\] (8)

Therefore, the price update in Algorithm 1 can be equivalently viewed as an adaptively regularized gradient ascent using the standard revenue function, where the regularizer at period \(t\) is \(1/_{H}(^{t},^{t}),1/_{L}(^{t}, ^{t})\).

We highlight that by leveraging the structure of MNL model, each firm \(i\) can obtain the derivative of its log-revenue \(D_{i}^{t}\) in Eq. (9) through the market feedback mechanism, i.e., last-period demand. The firms do not need to know their own reference price when executing the OPGA algorithm, and the reference price update in Line 6 is automatically performed by the market. In fact, computing the derivative \(D_{i}\) is identical to querying the first-order oracle, which is a common assumption in the optimization literature . Further, this derivative can also be acquired through a minor perturbation of the posted price, even when the firms lack access to historical prices and market feedback, making the algorithm applicable in a variety of scenarios.

There are two potential ways to analyze Algorithm 1 using well-established theories. Below, we briefly introduce these methods and the underlying challenges, while referring readers to Appendix A for a more detailed discussion.

* First, by adding two virtual firms to represent the reference price, the game can be converted into a standard four-player online game, effectively eliminating the evolution of the underlying state (reference price). However, the challenge in analyzing this four-player game arises from the fact that, while real firms have the flexibility to dynamically adjust their step-sizes, the learning rate for virtual firms is fixed to the constant \((1-)\), where \(\) is the memory parameter for reference price updates. This disparity hinders the direct application of the existing results from multi-agent online learning literature, as these results typically require the step-sizes of all agents either diminish at comparable rates or remain as a small enough constant [47; 48; 14; 15].
* The second approach involves translating the OPGA algorithm into a discrete nonlinear system by treating \((^{t+1},^{t+1})\) as a vector-valued function of \((^{t},^{t})\), i.e., \((^{t+1},^{t+1})=(^{t},^{t})\) for some function \(()\). In this context, analyzing the convergence of Algorithm 1 is equivalent to examining the stability of the fixed point of \(()\), which is related to the spectral radius of the Jacobian matrix \((^{},^{})\)[49; 50]. However, the SNE lacks a closed-form expression, making it difficult to calculate the eigenvalues of \((^{},^{})\). In addition, the function \(()\) is non-smooth due to the presence of the projection operator and can become non-stationary when the firms adopt time-varying step-sizes, such as diminishing step-sizes. Moreover, typical results in dynamical systems only guarantee local convergence , i.e., the asymptotic stability of the fixed point, whereas our goal is to establish the global convergence of both the price and reference price.

In the following section, we show that the OPGA algorithm with diminishing step-sizes converges to the unique SNE by exploiting characteristic properties of our model. This convergence result indicates that the OPGA algorithm provably achieves the no-regret learning, i.e., in the long run, the algorithm performs at least as well as the best fixed action in hindsight. However, it is essential to note that the reverse is not necessarily true: being no-regret does not guarantee the convergence at all, let alone the convergence to an equilibrium (see, e.g., [52; 53]). In fact, beyond the finite games, the agents may exhibit entirely unpredictable and chaotic behaviors under a no-regret policy .

## 5 Convergence results

In this section, we investigate the convergence properties of the OPGA algorithm. First, in Theorem 5.1, we establish the global convergence of the price path and reference price to the unique SNE under diminishing step-sizes. Subsequently, in Theorem 5.2, we further show that this convergence exhibits a rate of \((1/t)\), provided that the step-sizes are selected appropriately. The primary proofs for this section can be found in Appendices C and D, while supporting lemmas are located in Appendix F.

**Theorem 5.1** (Global convergence): _Let the step-sizes \(\{^{t}\}_{t 0}\) be a non-increasing sequence such that \(_{t}^{t}=0\) and \(_{t=0}^{}^{t}=\) hold. Then, the price paths and reference price paths generated by Algorithm 1 converge to the unique stationary Nash equilibrium._

Theorem 5.1 demonstrates the global convergence of the OPGA algorithm to the SNE, thus ensuring the market equilibrium and stability in the long-run. Compared to  that establishes the convergence to SNE under the perfect information setting, Theorem 5.1 ensures that such convergence can also be achieved in an opaque market where the firms are reluctant to share the information with their competitors. The only condition we need for the convergence is diminishing step-sizes such that \(_{t}^{t}=0\) and \(_{t=0}^{}^{t}=\). This assumption is widely adopted in the study of online games (see, e.g., ). Since the firms will likely become more familiar with their competitors through repeated competitions, it is reasonable for the firms to gradually become more conservative in adjusting their prices and decrease their learning rates.

As discussed in Sections 2 and 4, the existing methods in the online game and dynamical system literatures are not applicable to our problem due to the absence of standard structural properties and the presence of the underlying dynamic state, i.e., reference price. Consequently, we develop a novel analysis to prove Theorem 5.1, leveraging the characteristic properties of the MNL demand model. We provide a proof sketch below, with the complete proof deferred to Appendix C. Our proof consists of two primary parts:

* In **Part 1** (Appendix C.1), we show that the price path \(\{^{t}\}_{t 0}\) would enter the neighborhood \(N_{}^{1}:=\{^{2}()<\}\) infinitely many times for any \(>0\), where \(()\) is a weighted \(_{1}\) distance function defined as \(():=|p_{H}^{}-p_{H}|/(b_{H}+c_{H})+|p_{L}^{ }-p_{L}|/(b_{L}+c_{L})\). To prove Part 1, we divide \(^{2}\) into four quadrants with \(^{}\) as the origin. Then, employing a contradiction-based argument, we suppose that the price path only visits \(N_{}^{1}\) finitely many times. Yet, we show that this forces the price path to oscillate between adjacent quadrants and ultimately converge to the SNE, which violates the initial assumption.
* In **Part 2** (Appendix C.2), we show that when the price path \(\{^{t}\}_{t 0}\) enters the \(_{2}\)-neighborhood \(N_{}^{2}:=\{^{2}\|-^{}\|_{2}<\}\) for some sufficiently small \(>0\) and with small enough step-sizes, the price path will remain in \(N_{}^{2}\) in subsequent periods. The proof of Part 2 relies on a local property of the MNL demand model around the SNE, with which we demonstrate that the price update provides adequate ascent to ensure the price path stays within the target neighborhood.

Owing to the equivalence between different distance functions in Euclidean spaces , these two parts jointly imply the convergence of the price path to the SNE. Since the reference price is equal to an exponential smoothing of the historical prices, the convergence of the reference price path follows that of the price path.

It is worth noting that [21, Theorem 5.1] also employs a two-part proof and shows the asymptotic convergence of online mirror descent  to the SNE in the linear demand setting. However, their analysis heavily depends on the linear structure of the demand, which ensures that a property similar to the variational stability is globally satisfied [21, Lemma 9.1]. In contrast, such properties no longer hold for the MNL demand model considered in this paper. Therefore, we come up with two distinct distance functions for the two parts of the proof, respectively. Moreover, the proof by  relies on an assumption concerning the relationship between responsiveness parameters, whereas our convergence analysis only requires the minimum assumption that the responsiveness parameters are positive (otherwise, the model becomes counter-intuitive for substitutable products).

**Theorem 5.2** (Convergence rate): _When both firms adopt Algorithm 1, there exists a sequence of step-sizes \(\{^{t}\}_{t 0}\) with \(^{t}=(1/t)\) and constants \(d_{p},d_{r}>0\) such that_

\[\|^{}-^{t}\|_{2}^{2}} {t},\|^{}-^{t}\|_{2}^{2} }{t}, t 1.\] (10)

Theorem 5.2 improves the result of Theorem 5.1 by demonstrating the non-asymptotic convergence rate for the price and reference price. Although non-concavity usually anticipates slower convergence, our rate of \((1/t)\) matches [21, Theorem 5.2] that assumes linear demand and exhibits concavity.

The proof of Theorem 5.2 is primarily based on the local convergence rate when the price vector remains in a specific neighborhood \(N_{_{0}}^{2}\) of the SNE after some period \(T_{_{0}}\). As the choice \(^{t}=(1/t)\)ensures that \(_{t}^{t}=0\) and \(_{=0}^{}^{t}=\), the existence of such a period \(T_{_{0}}\) is guaranteed by Theorem 5.1. Utilizing an inductive argument, we first show that the difference between price and reference price decreases at a faster rate of \((1/t^{2})\), i.e., \(\|^{t}-^{t}\|_{2}^{2}=(1/t^{2} ),\, t 1\) (see Eq. (67)). Then, by exploiting a local property around the SNE (Lemma F.3), we use another induction to establish the convergence rate of the price path after it enters the neighborhood \(N_{_{0}}^{2}\). In the meanwhile, the convergence rate of the reference price path can be determined through a triangular inequality: \(\|^{}-^{t}\|_{2}^{2}=\|^{}-^{t}+^{t}-^{t}\|_{2}^{2}  2\|^{}-^{t}\|_{2}^{2}+2 \|^{t}-^{t}\|_{2}^{2}\). Finally, due to the boundedness of the feasible price range \(^{2}\), we can obtain the global convergence rate for all \(t 1\) by choosing sufficiently large constants \(d_{p}\) and \(d_{r}\).

**Remark 5.3** (Constant step-sizes): _The convergence analysis presented in this work can be readily extended to accommodate constant step-sizes. Particularly, our theoretical framework supports the selection of \(^{t}(_{0})\), where \(_{0}\) refers to the size of the neighborhood utilized in Theorem 5.2. When \(^{t}(_{0})\), an approach akin to **Part 1** can be employed to demonstrate that the price path enters the neighborhood \(N_{}^{1}\) infinitely many times for any \((_{0})\). Subsequently, by exploiting the local property in a manner similar to **Part 2**, we can establish that once the price path enters the neighborhood \(N_{}^{2}\) for some \(=(_{0})\), it will remain within that neighborhood._

We perform two numerical experiments, differentiated solely by their sequences of step-sizes, to highlight the significance of step-sizes in achieving the convergence. In particular, Example 1 (see Figure 0(a)) corroborates Theorem 5.1 by demonstrating that the price and reference price trajectories converge to the unique SNE when we choose diminishing step-sizes that fulfill the criteria specified in Theorem 5.1. By comparison, the over-large constant step-sizes employed in Example 2 (see Figure 0(b)) fails to ensure convergence, leading to cyclic patterns in the long run. Moreover, in Example 3 (see Figure 0(c)), we compare the OPGA algorithm and the repeated application of the equilibrium pricing policy in Eq. (5) by plotting the reference price trajectories produced by both approaches. Figure 0(c) conveys that the two algorithms reach the SNE at a comparable rate, which indicates that the OPGA algorithm allows firms to attain the market equilibrium and stability as though they operate under perfect information, while preventing excessive information disclosure.

## 6 Extensions

In previous sections, we assume that each firm \(i\) possesses accurate information regarding its sensitivity parameters \((b_{i},c_{i})\) as well as its realized market share \(d_{i}^{t}\). This is equivalent to having access to an exact first-order oracle. However, a more practical scenario to consider is one where the firm can only obtain a rough approximation for its market share and needs to estimate the sensitivities from historical data. This would bring extra noise to the computation of the first-order derivative \(D_{i}^{t}\) in Eq. (9). In this section, we first elaborate on the feasibility of estimating the market share and sensitivities from realistic data. Then, we discuss the impact of an inexact first-order oracle on the convergence.

We consider the approximation of market share and the calibration of sensitivities under both _uncensored_ and _censored_ data cases. With uncensored data, both purchase and no-purchase data are

Figure 1: Price and reference price paths for Examples 1, 2, and 3, where the parameters are \((a_{H},b_{H},c_{H})=(8.70,2.00,0.82)\), \((a_{L},b_{L},c_{L})=(4.30,1.20,0.32)\), \((r_{H}^{0},r_{L}^{0})=(0.10,2.95)\), \((p_{H}^{0},p_{L}^{0})=(4.85,4.86)\), and \(=0.90\).

available, a scenario analogous to firms selling substitute goods on third-party online retail platforms like Amazon. The platform can track the non-purchase statistics by monitoring consumers who visited its website but did not purchase any product. Consequently, this facilitates a direct estimation of the total market size and, when complemented with sales quantities, allows for a precise computation of the firm's market share. Additionally, sensitivity parameters can be efficiently calibrated through the classical Maximum Likelihood Estimation (MLE) method. Due to the concavity of the log-likelihood function for the MNL model with respect to its parameters, many numerical algorithms (e.g., Newton-Raphson, BHHH-2 , and the steepest ascent) are guaranteed to improve at each iteration and achieve fast convergence .

In many cases, the traditional transaction data only captures the realized demand, with non-purchases typically unrecorded. This scenario is known as the censored data case. In this case, the sensitives and the total market size of the MNL model can be estimated via the generalized expectation-maximization (GEM) gradient method proposed by , which is an iterative algorithm that is inspired by the expectation-maximization (EM) approach. The capability to approximate the sensitivity parameters, the market share, and thereby the gradient \(D_{i}^{t}\) enhances the credibility and practicability of the OPGA algorithm, suggesting its great potential for broader applications in retailing.

In the presence of approximation errors, firms cannot precisely compute the derivative \(D_{i}^{t}\). Hence, the convergence results in Section 5 are not directly applicable. Indeed, if the errors are disruptive enough, one can anticipate Algorithm 1 to possibly not show any convergent behavior. However, if the errors are uniformly bounded by some small number \(\), the following theorem demonstrates that both the price and reference price paths converge to a \(()\)-neighborhood of the unique SNE.

**Theorem 6.1** (Inexact first-order oracle): _Suppose both firms only have access to an inexact first-order oracle such that \(|D_{i}^{t}-(_{i}(^{t},^{t}))/ p_{ i}|,\; i\{H,L\}\) and \( t 0\). Let the step-sizes \(\{^{t}\}_{t 0}\) be a non-increasing sequence such that \(_{t}^{t}=0\) and \(_{t=0}^{}^{t}=\) hold. Then, the price paths reference price paths generated by Algorithm 1 converge to a neighborhood with radius \(()\) of the unique SNE._

We remark that the inexact first-order oracle studied in our setting is different from the stochastic gradient, which generally assumes a zero-mean noise with finite variance. In that case, it is possible to derive the convergence to a limiting point in expectation or with high probability. In contrast, the noise in \(D_{i}^{t}\) is a kind of approximation error without any distributional properties. Therefore, with the step-sizes defined in Theorem 6.1, we expect the price and reference price paths to converge to the neighborhood of the SNE, but continue to fluctuate around the neighborhood without admitting a limiting point.

The proof of Theorem 6.1 is based upon Theorem 5.1. Specifically, we demonstrate that the inexact gradient still guides the price path toward the SNE if the magnitude of the true gradient dominates the noise. Conversely, if noise levels are comparable with the true gradient, we show that the price path is already close to the SNE. The formal proof of Theorem 6.1 can be found in Appendix E

## 7 Conclusion and future work

This article considers the price competition with reference effects in an opaque market, where we formulate the problem as an online game with an underlying dynamic state, known as reference price. We accomplish the goal of simultaneously capturing the market equilibrium and stability via proposing the no-regret algorithm named OPGA and providing the theoretical guarantee for its global convergence to the SNE. In addition, under appropriate step-sizes, we show that the OPGA algorithm has the convergence rate of \((1/t)\).

In this paper, we focus on the symmetric reference effects, where consumers exhibit equal sensitivity to the gains and losses. As empirical studies suggest that consumers may display asymmetric reactions , one possible extension involves accounting for asymmetric reference effects displayed by loss-averse and gain-seeking consumers. Additionally, while our study considers the duopoly competition between two firms, it would be valuable to explore the more general game involving \(n\) players. Lastly, our research is based on a deterministic setting and pure strategy Nash equilibrium. Another intriguing direction for future work is to investigate mixed-strategy learning  in dynamic competition problems.