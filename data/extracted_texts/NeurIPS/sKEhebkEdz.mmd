# Semi-supervised Knowledge Transfer Across Multi-omic Single-cell Data

Fan Zhang\({}^{1}\), Tianyu Liu\({}^{2}\), Zihao Chen\({}^{3}\), Xiaojiang Peng\({}^{4}\),

**Chong Chen\({}^{5}\), Xian-Sheng Hua\({}^{5}\), Xiao Luo\({}^{6,}\)\({}^{*}\), Hongyu Zhao\({}^{2}\)**

\({}^{1}\)Georgia Institute of Technology, \({}^{2}\)Yale University, \({}^{3}\)Peking University,

\({}^{4}\)Shenzhen Technology University, \({}^{5}\)Terminus Group, \({}^{6}\)University of California, Los Angeles

fanzhang@gatech.edu, tianyu.liu@yale.edu, g.e.challenger@pku.edu.cn pengxiaojiang@sztu.edu.cn, chenchong.cz@gmail.com, huaxiansheng@gmail.com xiaoluo@cs.ucla.edu, hongyu.zhao@yale.edu

Corresponding author.

###### Abstract

Knowledge transfer between multi-omic single-cell data aims to effectively transfer cell types from scRNA-seq data to unannotated scATAC-seq data. Several approaches aim to reduce the heterogeneity of multi-omic data while maintaining the discriminability of cell types with extensive annotated data. However, in reality, the cost of collecting both a large amount of labeled scRNA-seq data and scATAC-seq data is expensive. Therefore, this paper explores a practical yet underexplored problem of knowledge transfer across multi-omic single-cell data under cell type scarcity. To address this problem, we propose a semi-supervised knowledge transfer framework named Dual label scArcity elimiNation with Cross-omic multi-sampIE Mixup (DANCE). To overcome the label scarcity in scRNA-seq data, we generate pseudo-labels based on optimal transport and merge them into the labeled scRNA-seq data. Moreover, we adopt a divide-and-conquer strategy which divides the scATAC-seq data into source-like and target-specific data. For source-like samples, we employ consistency regularization with random perturbations while for target-specific samples, we select a few candidate labels and progressively eliminate incorrect cell types from the label set for additional supervision. Next, we generate virtual scRNA-seq samples with multi-sample Mixup based on the class-wise similarity to reduce cell heterogeneity. Extensive experiments on many benchmark datasets suggest the superiority of our DANCE over a series of state-of-the-art methods. Code is available at https://github.com/zfkarl/DANCE.

## 1 Introduction

In the realm of biology and medicine, many experimental methods [18; 25; 53; 51; 54; 63] using high-throughput sequencing technologies have emerged and characterize diverse properties of single cells. The predominant techniques are single-cell RNA-sequencing (scRNA-seq) [55; 88; 49] and single-cell ATAC-sequencing (scATAC-seq) [15; 75] for understanding complicated organisms and tissues at the single cell level. Specifically, scATAC-seq is an epigenomic profiling method designed to assess chromatin accessibility and provides an additional layer of information that complements scRNA-seq, enhancing the ability to comprehend epigenetic heterogeneity within complex tissues. However, identifying the cell types of scATAC-seq data is challenging because of the high sparsity, large dimensionality, and increasing scale of scATAC-seq data. Considering the lack of cell type annotations for scATAC-seq data, several methods [38; 36; 72] have been proposed to transfer celltypes from fully-labeled scRNA-seq data to scATAC-seq data2. Among these methods, scJoint  introduces a scalable transfer learning framework that successfully incorporates atlas-scale scRNA-seq with scATAC-seq data based on kNN techniques. scBridge  integrates multi-omic data heterogeneously by identifying reliable scATAC-seq cells with smaller omic differences in comparison to scRNA-seq cells. scNCL  employs prior domain knowledge along with contrastive learning to address the challenge of heterogeneous features from different modalities.

Despite significant progress made by the aforementioned approaches, their success relies on a substantial amount of annotated scRNA-seq data. In reality, annotating both scRNA-seq data and scATAC-seq data is expensive and challenging. Therefore, this study explores a practical yet unexplored problem of knowledge transfer across multi-omic single-cell data under label scarcity in both scRNA-seq data and scATAC-seq data. In this study, only a small fraction of scRNA-seq data with cell types annotated, while a significant portion of both scRNA-seq data and scATAC-seq data lack annotations. In contrast to previous works assuming abundant labeled scRNA-seq data, this setting aligns more closely with practical scenarios.

Addressing this realistic problem requires the consideration of two crucial aspects. Firstly, _how to learn representations with distinct cell type discriminability under label scarcity in both scRNA-seq data and scATAC-seq data?_ Learning representations with good discriminability relies on a large amount of annotated data, yet collecting labeled data is extremely costly and difficult. Therefore, it poses a significant challenge in situations where both scRNA-seq data and scATAC-seq data lack a substantial amount of labels. Secondly, _how to reduce cell heterogeneity between different omic data while maintaining cell type discriminability?_ Another challenge is how to reduce the heterogeneous gap between different omic data, which is crucial for cell type transfer. Additionally, while reducing cell heterogeneity, there is a high likelihood of compromising cell type discriminability. Even worse, this becomes significantly more challenging under label scarcity.

To answer these questions, we propose a semi-supervised knowledge transfer framework termed Dual label scArcity elimiNation with Cross-omic Multi-sampLE Mixup (DANCE). Since the class distribution of the whole scRNA-seq data is unattainable, we start by injecting semantic knowledge using labeled source scRNA-seq data, and then generate pseudo-labels based on optimal transport (OT) for unlabeled scRNA-seq data. Afterward, the unlabeled scRNA-seq data, along with pseudo-labels, are incorporated into the labeled set. For unlabeled target scATAC-seq data, due to the heterogeneous gap, we adopt a divide-and-conquer strategy, which separates the whole data into source-like data and target-specific data. For source-like samples, we employ consistency regularization to force the model to make consistent predictions after random perturbations. For target-specific samples, we select ambiguous labels and then filter the incorrect labels, which can guide the optimization in a soft manner. To mitigate the heterogeneous gap, we propose to generate virtual scRNA-seq samples by multi-sample Mixup according to class-wise similarity and then we perform a sample-to-sample alignment strategy. The effectiveness of DANCE is validated by adopting a series of benchmark datasets and conducting comprehensive experiments in comparison to various state-of-the-art approaches.

To summarize, the main contribution of this paper includes: (1) _New Problem._ We study a realistic yet underexplored problem of knowledge transfer across multi-omic single-cell data under label scarcity in both scRNA-seq and scATAC-seq data. This problem holds significant implications for reducing the annotation cost of single-cell data. (2) _Novel Methodology._ We propose a semi-supervised framework named DANCE for this problem. DANCE introduces OT-based dataset expansion and a divide-and-conquer strategy for dual label scarcity elimination. Additionally, DANCE employs an effective alignment strategy of cross-omic multi-sample Mixup to reduce cell heterogeneity. (3) _Comprehensive Experiments._ Through extensive experiments with different settings on various benchmark datasets, we demonstrate the superiority of DANCE against many state-of-the-art methods.

## 2 Related Work

### Multi-omic single-cell Data Integration

The integration of multi-omic single-cell data constitutes a fundamental challenge in elucidating biological processes. Multi-omic single-cell data affords a multitude of perspectives on cellular functions, thereby augmenting our understanding of biology. Some approaches [69; 44; 59; 37;30, 61, 2] opt for denoising, batch correction, and integrating single-cell data across numerous experiments, encompassing transcriptomic data and scATAC-seq data. Nevertheless, the simple application of these methodologies to multi-omic data integration poses computational challenges and frequently yields unsatisfactory results, given the considerable differences in dimensions and sparsity levels among different modalities. Moving a step closer, methodologies such as scAI  and MOFA+  utilize factor analysis and joint clustering to concurrently measure multi-omic data within the same cell. Nevertheless, these methods require pairwise data format, and executing paired measurements presents technical challenges and involves high costs. Therefore, another series of approaches have been proposed to measure multi-omic data from different cells, including manifold alignment , matrix factorization , correlation-based methods , and neural network approaches . Recent approaches often map multi-omic data into low-dimensional spaces through shared auto-encoders , and Graph Neural Networks (GNNs) encoders , which focus on knowledge transfer across multi-omic data. For instance, scBridge  maps multi-omic single-cell data into a shared embedding space and mines reliable samples for dataset expansion, thereby merging the scATAC-seq and scRNA-seq data into the same dataset. GLUE  combines a knowledge-based graph and adversarial alignment to explore regulatory interaction across various omic layers. scCLIP  introduces a contrastive learning approach to integrate multi-omic single-cell data. It aligns the representations of pairwise multi-omic single-cell data without the usage of cell type labels. Despite their significant strides in integrating heterogeneous cells, all these methods overlook a practical challenge in reality, i.e., the difficulty of annotating both scRNA-seq data and scATAC-seq data. Therefore, there is an urgent need for an approach that can effectively alleviate label scarcity in knowledge transfer across multi-omic single-cell data.

### Semi-supervised Learning

To tackle the label scarcity issue in reality, semi-supervised learning has been widely studied with various applications, such as image classification , semantic segmentation , and object detection . Recent studies on semi-supervised learning include consistency regularization approaches  and pseudo-labeling approaches . Consistency regularization usually first introduces random perturbations from various sources, including data input , network parameters , and deep features . By encouraging the model to make consistent predictions under these perturbations, it can still learn good representations even under resource constraints. Pseudo-labeling typically assigns pseudo-labels to unlabeled samples using a

Figure 1: An overview of DANCE. We first utilize labeled scRNA-seq samples to inject semantics and expand the scRNA-seq dataset by OT-based pseudo-labeling. Then we employ consistency regularization and ambiguous set learning for source-like and target-specific scATAC-seq samples. In addition, we perform cross-omic multi-sample Mixup to reduce cell heterogeneity.

neural network. It often comes with some special techniques, such as dynamic thresholding [78; 33] and curriculum learning [29; 22; 10]. Then those pseudo-labels together with their corresponding samples are added to the dataset for future use. Besides the advanced approaches in computer vision, other related areas such as node classification [13; 62] and reinforcement learning  also benefit from semi-supervised learning. However, to the best of our knowledge, there exists no previous work to study the problem of semi-supervised knowledge transfer across multi-omic single-cell data. Therefore, we provide a semi-supervised framework termed DANCE to promote the understanding of semi-supervised learning in the field of bioinformatics.

## 3 Problem Definition

In our problem, we have two datasets \(^{(s)}\) and \(^{(t)}\), which denote the source scRNA-seq dataset and the target scATAC-seq dataset, respectively. In the semi-supervised setting, the scRNA-seq dataset \(^{(s)}\) is separated into two parts, the labeled dataset \(^{(s),l}\) and the unlabeled dataset \(^{(s),u}\), where \(^{(s),l}=\{(_{i}^{(s),l},y_{i}^{(s),l})\}_{i=1}^{N^{u}_{l}}\) consists of \(N^{l}\) scRNA-seq samples \(_{i}^{(s),l}\) and the corresponding labels \(y_{i}^{(s),l}\), and \(^{(s),u}=\{(_{i}^{(s),u})\}_{i=1}^{N^{u}}\) includes \(N^{u}\) unlabeled scRNA-seq samples \(_{i}^{(s),u}\). The target scATAC-seq dataset with the size \(N^{t}\) is denoted as \(^{(t)}=\{(_{i}^{(t)})\}_{i=1}^{N^{t}}\), which includes \(N^{t}\) scATAC-seq samples \(_{i}^{(t)}\). We focus on the closed-set setting, thus both scRNA-seq data and scATAC-seq data are assumed to share the same set of \(C\) cell types. A shared encoder \(F()\) is adopted to map both the scRNA-seq samples and scATAC-seq samples into the embedding space. Following the encoder, we utilize a classifier \(H()\) to convert representations into softmax predictions corresponding to different cell types. The representations and predictions are denoted as \(_{i}=F(_{i})\) and \(_{i}=softmax(H(_{i}))\), respectively. It should be noted that only a small portion of the scRNA-seq data is labeled, and a significant number of both scRNA-seq samples and scATAC-seq samples lack cell type annotations. We aim to transfer the semantic information related to different cell types from \(^{(s)}\) to \(^{(t)}\), which has two expectations: _(1) The cell representations of scRNA-seq data and scATAC-seq data are mapped into a shared common embedding space with the similarity structure preserved. (2) The cell type annotations on scATAC-seq data are accurate after label transfer._

## 4 The Proposed Approach

### Framework Overview

This paper investigates the problem of semi-supervised knowledge transfer across multi-omic single-cell data. We employ a shared encoder and classifier for heterogeneous scRNA-seq data and scATAC-seq data. The labeled scRNA-seq data are utilized to inject the semantic knowledge. To overcome label scarcity in source scRNA-seq data, we generate pseudo labels based on optimal transport and merge them into the labeled set. To address label scarcity in target scATAC-seq data, we perform consistency regularization for source-like samples and learn from ambiguous labels for target-specific samples. To reduce the cell heterogeneity, we generate virtual scRNA-seq samples through cross-omic multi-sample Mixup and align the heterogeneous multi-omic data. The overview of the proposed framework is illustrated in Figure 1, and each component will be elaborated in the next sections.

### Optimal Transport-based Dataset Expansion for Source scRNA-seq Data

The first obstacle is the label scarcity in scRNA-seq data. Recently, pseudo-labeling is a commonly used technique in semi-supervised learning [52; 78] and domain adaptation [83; 31] problems, which usually operate at the sample level [52; 83] by assigning the label with the highest confidence to each sample. However, this sample-level prediction-based pseudo-labeling strategy could be biased to easy classes, leading to biased and suboptimal results. To tackle this, we incorporate optimal transport (OT) [12; 9; 11] into the pseudo-labeling process, which is capable of taking into account prior cell type distributions from a global view to reduce potential noise in pseudo-labeling.

Here we first recall the knowledge of OT. OT is a constrained optimization problem designed to discover the optimal coupling matrix \(\) for mapping one probability distribution to another, with the goal of minimizing the overall cost. To represent the cost of transporting data from \(\) and \(\), we introduce a cost matrix \(^{||||}\), where \(||\) and \(||\) denote the dimension of \(\) and \(\)respectively. By applying the Sinkhorn algorithm  to minimize the Sinkhorn distance, we can obtain the optimal coupling matrix \(\):

\[(,)}{min}_{ij}_{ij}+ (-_{ij}log_{ij}),\] (1)

where \((,)=\{_{+}^{| |||}_{||}=,^{}_{||}=\}\) and \(\) is set to \(10\) empirically.

To employ OT for pseudo-labeling, we begin by training the encoder and classifier on labeled scRNA-seq data, enabling the injection of semantic knowledge into the model. Similar to traditional cell type annotation problems , we leverage a small number of labeled scRNA-seq data and minimize the cross-entropy between the classifier's output and the cell type labels:

\[_{S}=_{_{i}^{(s),l}^{(s),l}}( {p}_{i}^{(s),l},y_{i}^{(s),l}),\] (2)

where \(_{i}^{(s),l}\) represents the predicted distribution of \(_{i}^{(s),l}\).

Then, we aim to transfer the semantic information from labeled scRNA-seq samples to unlabeled ones. In particular, a mini-batch of \(B\) unlabeled samples is fed to our neural network to generate the prediction matrix \(^{B C}\), which could be biased to easy classes and thus inaccurate. To tackle this, we learn an optimal coupling matrix that should obey prior cell type distributions from a global view. Since we do not have prior information, we adopt a uniform distribution as in the polytope \((_{B},_{C})\), where \(_{B}\) and \(_{C}\) indicate two vector of ones with dimensions of \(B\) and \(C\), respectively. In addition, the optimal \(\) should be close to \(\). Therefore, we define the cost matrix \(\) as \(-log\), and Eqn. 1 can be reformulated as:

\[(_{B},_{C}) }{min}_{ij}-log_{ij}_{ij}+(-_{ij}log {Q}_{ij}).\] (3)

The coupling matrix \(\) obtained by optimizing Eqn. 3 can be used to generate pseudo-labels for unlabeled scRNA-seq data. Formally, the pseudo-labels can be defined as:

\[_{i}^{(s),u}=argmax_{j}_{ij}.\] (4)

Then the unlabeled scRNA-seq samples and their corresponding pseudo-labels would be added to the labeled scRNA-seq dataset:

\[^{(s),l}_{i=1}^{N^{u}}\{(_{i}^{(s),u},_ {i}^{(s),u})\}^{(s),l}.\] (5)

Leveraging OT-based pseudo-labeling for dataset expansion can effectively mitigate label scarcity in scRNA-seq data. On the one hand, we employ labeled scRNA-seq data for semantic injection using Eqn. 2, obtaining high-quality pseudo-labels. On the other hand, with the dataset expanded during the current iteration, more information is available for Eqn. 2 in the subsequent iteration. This leads to generating more reliable pseudo-labels in the following iterations. Through continuous iterative training, we can progressively enhance both the scale and quality of the scRNA-seq dataset. Next, we theoretically support the superiority of OT-based dataset expansion. See proof in Appendix A.

**Theorem 4.1**.: _Let \(_{n}=\) be the normalized version of \(\). Then after our optimal transport-based dataset expansion, we have_

1. _For any_ \(>0\) _and large enough_ \(\)_, we have_ \((_{n},)+(,)+C_{ },\) _where_ \(C_{}=_{j=1}^{C}(_{i=1}^{B}p_{ij}- )(_{i=1}^{B}- p_{ij})\) _and_ \((,)=_{i,j}(_{ij},_{ij}).\)__
2. _Let_ \(=(l_{ij})_{B C}\) _denote the soft-version of true cell labels, where_ \(l_{ij}=\{1_{j\},\}\) _and_ \(>0\)_. Suppose_ \(0<C_{} l_{ij}/_{ij} C_{}\) _for all_ \(1 i B\) _and_ \(1 j C\)_. Then,_ \((_{n},)++C_{}(, )+C_{},\) _where_ \(C_{}= C_{}- C_{}\)_._

Remarks._\(C_{}\) characterizes how far \(_{n}\) is from \((_{B},_{C})\). If the mini-batch was uniformly sampled across cell-types, then \(_{i=1}^{B}p_{ij}\) should be close to \(\). Thus, \(C_{}\) will be close to zero. Moreover, for those hard classes, \(p_{ij}\)'s are close to \(\), hence both \(_{i=1}^{B}p_{ij}\) and \(_{i=1}^{B}- p_{ij}\) will not be too large. Hence, on the whole, \(C_{}\) can be relatively small, which demonstrates that our optimization has the potential to achieve the desired distribution.

### Divide and Conquer for Target scATAC-seq Data

Through OT-based pseudo-labeling, we effectively address the label scarcity issue in scRNA-seq data. However, due to the heterogeneous gap, it would not be optimal when employing a similar approach for scATAC-seq data. Here, to tackle label scarcity in scATAC-seq data, we adopt a divide-and-conquer learning strategy, which first divides the scATAC-seq data into source-like data and target-specific data and then utilizes separate approaches for optimization.

In particular, by comparing the confidence of the predictions and a threshold, we divide scATAC-seq data into two parts \(^{SL}\) and \(^{TS}\):

\[^{SL}=\{_{i}^{(t)}|_{c}_{i}^{(t)}[c] >\},^{TS}=^{(t)}/^{SL},\] (6)

where \(_{i}^{(t)}\) is the predicted distribution of \(_{i}^{(t)}\). The threshold \(\) is used to control the size of two groups and set to \(0.9\) according to previous works [52; 36]. These source-like samples are more likely to have accurate pseudo-labels with high confidence using the pre-trained model. In contrast, target-specific data are far away from source data distribution and thus the predictions could be noisy. Therefore, we utilize separate strategies for these two parts.

Learning from Source-like Data.For these source-like samples, we utilize consistency regularization to provide supervision [4; 32; 50; 52; 85]. Here, we add random perturbations (e.g., Gaussian noise) to data, and then force the network to make consistent predictions for both original and perturbed scATAC-seq samples. In particular, we can use \(_{i}=argmax(_{i})\) to obtain the pseudo-label of the original scATAC-seq sample. After that, we can get the prediction \(}_{i}\) of the perturbed scATAC-seq sample. Thus, the supervised loss can be formulated as:

\[_{SL}=-^{SL}|}_{i=1}^{|^{SL}|} _{c=1}^{C}_{i}{}^{cl}log(}_{i}^{c}),\] (7)

where \(|^{SL}|\) represents the number of unlabeled scATAC-seq samples in \(^{SL}\). In this way, we combine pseudo-labeling with consistency learning to learn from source-like scATAC-seq samples.

Learning from Target-specific scATAC-seq Data.However, due to cell heterogeneity between scRNA-seq and scATAC-seq data, many scATAC-seq samples would be far away from the source modality. They are difficult to predict with low confidence scores [71; 85]. To tackle this challenge, we introduce a soft way to learn from their ambiguous label sets instead of pseudo-labels. Here, for each target-specific scATAC-seq sample, we first select the top-\(k\) classes with the highest probabilities to make up the ambiguous label set and then introduce a soft supervised loss for reliable guidance.

To be specific, we first recall the predicted distribution \(_{i}\) for each sample \(_{i}\) in \(^{TS}\). The negative cell types are removed with a significant difference from the cell type with the highest probability. In formulation, the removed labels should satisfy the following conditions:

\[_{c}_{i}[c]-_{i}[j],\] (8)

where the threshold \(\) is initially set to \(1e-3\) and gradually decreases during the training process. The left labels make up the candidate label set:

\[Y_{i}=\{c Topk(_{i})|_{c}_{i}[c]-_{i}[j]<\}.\] (9)

Then, we employ a soft supervision loss to provide reliable guidance for target-specific samples:

\[_{TS} =-^{TS}}_{i=1}^{^{TS}}_{j= 1}^{k}_{ij}1_{j Y_{i}}log(_{i}[j]),\] (10) \[_{ij} =_{i}[j]/_{j Y_{i}}_{i}[j],&j Y _{i},\\  142.26378pt0,&otherwise.,\] (11)

where \(|^{TS}|\) denotes the number of target-specific samples. The weight \(_{ij}\) can allow the model to pay more attention to potential correct cell types with high probabilities.

Next, we provide the theoretical underpinnings to show that the quality of the soft labels from the candidate label set is higher than that of hard labels. The proof can be found in Appendix A.

**Theorem 4.2**.: _Suppose we randomly draw \(n\) samples \((X_{1},,X_{n})\) from two classes \(\{0,1\}\), where the proportion of class 1 is \(p\). Further, suppose we can only observe a flawed version of these class labels \(=(Z_{1},,Z_{n})\) with error rate \(>0\). That is, \((Z_{i} X_{i})=\). Under loss \((p,)=_{i=1}^{n}z_{i} p+(n-_{i=1}^{n}z_{i})(1- p),\) consider two estimates of \(p\):_

1. \(p_{ hard}=}\ \ (p,)\)_._
2. \(p_{ soft}^{t}=}\ \ (p,t+(1-t)(1-))\)_, where_ \(t(0,1)\)_._

_Then, there exists \(t_{0}(0,1)\) such that for all \(t(t_{0},1)\), we have \(\|p_{ soft}^{t}-p\|^{2}\|p_{ hard }-p\|^{2}.\)_

Remarks.In Eqn. 10, if we take \(_{i}=p,_{i}=1-p\), and \(_{ij}=t\) if \(j=Z_{i}\), then the estimation under Eqn. 10 will degenerate to \(p_{ soft}^{t}\).

### Cross-omic Multi-sample Mixup for Cell Heterogeneity Reduction

Despite the proposed techniques in addressing the label scarcity problem, reducing the heterogeneous gap between scRNA-seq data and scATAC-seq data remains an additional challenge. To tackle this challenge, previous works [27; 19; 35; 34; 70] propose many strategies for cross-modal alignment. However, these strategies have two major prerequisites. On the one hand, strategies based on centroid learning [27; 19] require accurate label information from both source and target modalities to aggregate samples of the same class. On the other hand, strategies based on cross-modal contrastive learning [35; 34; 82] require pairwise information. Neither of these prerequisites is applicable to our problem, as pairwise information is difficult to acquire in single-cell data, and the majority of annotation information is missing. Towards this end, we propose a sample-to-sample alignment strategy termed cross-omic multi-sample Mixup [81; 58; 86; 73], which first calculates the class-wise similarity and then mixes the scRNA-seq samples in the hidden space for cross-omic alignment.

In particular, we transform the intrinsic distribution of the source scRNA-seq samples to align with scATAC-seq samples in the hidden space. Since we cannot get accurate pairwise information, we calculate the similarity between scRNA-seq samples and scATAC-seq samples and generate virtual samples instead. Note that the weights of the classifier are considered as prototypes that contain representative information of different cell types. We first form a weight matrix \(=[_{1},_{2},,_{C}]^{T}^{C  D}\), where \(D\) denotes the hidden dimension of the embeddings. Then, the class-wise similarity can be determined using cosine distance:

\[S_{ij}=cos(_{i}^{T},_{j}^{T})=|_{i}^{T} ||_{j}^{T}|^{T},\] (12)

where \(||\) represents the \(L_{2}\) normalization. For a batch of \(B^{(s)}\) scRNA-seq samples and a batch of \(B^{(t)}\) scATAC-seq samples, we can obtain a similarity matrix \(S^{B}^{B^{(s)} B^{(t)}}\) using Eqn. 12. For the sake of simplicity, we let \(B^{(s)}=B^{(t)}=B\), and the similarity matrix within a mini-batch can be formulated as \(S^{B}^{B B}\). Afterwards, we employ the softmax function to convert \(\) into the weight matrix \(\) for Mixup, which corresponds to the probability of sharing the same semantics:

\[=softmax(),\] (13)

where \(_{i}\) collects the weights of \(B\) scATAC-seq samples corresponding to the \(i\)-th scRNA-seq sample. Then, we can fuse the scRNA-seq samples into a virtual sample through Mixup:

\[_{i}^{m,s}=_{j=1}^{B}_{ij}_{j}^{s}.\] (14)

After getting the fused scRNA-seq samples, we can perform a sample-to-sample alignment strategy. The loss function can be formulated as:

\[_{A}=_{i=1}^{B}||_{i}^{m,s}-_{i}^{t}||^{2}.\] (15)

### Summarization

In practice, we first warm up the network through labeled scRNA-seq data, and then conduct the training process in an end-to-end manner. The total loss function can be summarized as:

\[=_{S}+_{SL}+_{TS}+ _{A},\] (16)

where \(\) is a coefficient and set to \(0.1\) empirically.

The step-by-step training algorithm of our DANCE is summarized in Appendix B.

## 5 Experiment

### Experimental Settings

Datasets.To validate the effectiveness of the proposed DANCE, we conduct extensive experiments on several benchmark multi-omic single-cell datasets, with a brief introduction as follows: **Mouse Atlas Data .** The multi-omics data can be accessed from the Tabula Muris mouse data3, along with the quantitative gene activity score matrix. In practice, the dataset is divided into multiple subsets based on the various sources of multi-omics data. **CITE-ASAP PBMC Data .** It is derived from both control and stimulated conditions. CITE-seq encompasses both antibody-derived tag (ADT) matrices and gene expression matrices, while ASAP-seq allows us to access the ADT matrices and the chromatin accessibility matrices simultaneously. In this research, we extract the gene expression matrices of CITE-seq and the chromatin accessibility matrices of ASAP-seq to construct the scRNA-seq and scATAC-seq datasets. The statistics of these datasets can be seen in Appendix D.

Baselines.Various approaches are adopted for performance comparisons, including three domain adaptation methods (DAN , CDAN , and MCC ), one semi-supervised learning method (FixMatch ), and three latest multi-omic single-cell data integration methods (scJoint , scNCL , and scBridge ). A brief introduction of these approaches is provided in Appendix E.

   Label Ratio & Low & Mid & High & Low & Mid & High & Low & Mid & High & Low & Mid & High \\  Data &  &  &  &  \\  DAN  & 20.56 & 20.13 & 20.33 & 44.20 & 46.55 & 53.72 & 27.50 & 29.14 & 30.47 & 54.33 & 55.08 & 49.95 \\ CDAN  & 23.46 & 21.29 & 21.84 & 20.38 & 26.00 & 27.76 & 27.21 & 21.51 & 39.08 & 32.97 & 38.08 \\ MCC  & 24.34 & 32.39 & 40.84 & 20.40 & 48.69 & 44.59 & 24.57 & 31.45 & 30.31 & 31.22 & 36.77 & 40.20 \\ FixMatch  & 24.38 & 33.45 & 41.60 & 20.42 & 44.58 & 41.98 & 24.93 & 31.61 & 33.04 & 31.66 & 36.60 & 41.32 \\ scJoint  & 17.58 & 19.52 & 18.86 & 23.46 & 24.27 & 21.86 & 19.39 & 18.51 & 17.78 & 21.48 & 24.43 & 22.11 \\ scNCL  & 22.62 & 21.21 & 22.92 & 27.16 & 50.78 & 60.07 & 21.98 & 28.11 & 30.19 & 59.65 & 67.47 & 68.89 \\ scBridge  & 25.57 & 38.50 & 41.86 & 21.64 & 32.74 & 35.71 & 19.39 & 16.29 & 42.36 & 17.20 & 20.85 & 38.48 \\ Ours & **50.23** & **51.02** & **51.42** & **75.72** & **78.67** & **80.12** & **50.83** & **52.90** & **54.79** & **60.12** & **72.24** & **78.04** \\  Data &  &  &  &  &  &  \\  DAN  & 22.02 & 27.07 & 28.06 & 48.28 & 55.93 & 57.67 & 21.23 & 20.02 & 20.31 & 41.96 & 54.31 & 52.39 \\ CDAN  & 20.99 & 28.65 & 30.07 & 33.87 & 35.37 & 51.19 & 20.25 & 21.50 & 21.58 & 34.66 & 24.43 & 38.70 \\ MCC  & 20.99 & 23.41 & 24.09 & 34.37 & 52.46 & 55.38 & 21.73 & 21.30 & 21.54 & 32.09 & 50.35 & 49.24 \\ FixMatch  & 21.25 & 24.23 & 24.88 & 33.80 & 52.05 & 54.78 & 22.07 & 21.77 & 22.32 & 31.55 & 49.98 & 49.38 \\ scJoint  & 11.05 & 13.25 & 15.89 & 22.88 & 18.84 & 20.21 & 19.62 & 18.63 & 17.77 & 23.94 & 23.09 & 23.28 \\ scNCL  & 19.89 & 20.07 & 20.05 & 49.68 & 69.50 & 73.39 & 19.93 & 19.91 & 19.71 & 45.28 & 62.55 & 62.69 \\ scBridge  & 26.44 & 36.34 & 42.00 & 36.01 & 39.75 & 36.15 & 28.32 & 29.69 & 32.13 & 13.13 & 26.58 & 30.08 \\ Ours & **47.43** & **52.78** & **54.95** & **52.31** & **70.18** & **77.94** & **46.40** & **48.19** & **49.92** & **51.56** & **77.37** & **78.62** \\   

Table 1: Quantitative comparisons (in \(\%\)) with state-of-the-art approaches with various label ratios. **Bold** numbers indicate best results, and underlined numbers indicate second-best results.

Figure 2: Qualitative comparisons (in \(\%\)) on CITE-ASAP with different label ratios.

### Experimental Results

Performance Comparison.To assess the performance of various knowledge transfer methods, we conduct comprehensive quantitative experiments (Table 1) and qualitative experiments (Figure 2). From the results, several conclusions can be drawn: _Firstly_, consistent results from both quantitative and qualitative experiments reveal that DANCE significantly surpasses existing state-of-the-art approaches. We attribute this to the factor that existing methods often only address the issue of label scarcity in the target scATAC-seq data, overlooking the label scarcity issue in the source scRNA-seq data. Consequently, when cell type annotations in scRNA-seq data are limited, not only does the discriminability of representations suffer, but also the heterogeneous gap cannot be effectively eliminated. DANCE excels in three main aspects. Firstly, it utilizes OT-based pseudo-labeling to augment the scRNA-seq dataset, effectively alleviating label scarcity in scRNA-seq data. Secondly, for scATAC-seq data, we employ a divide-and-conquer strategy with consistency regularization and ambiguous set learning for two subsets of samples, addressing label scarcity in scATAC-seq data. Additionally, our proposed cross-omic multi-sample Mixup mitigates cell heterogeneity in a sample-to-sample manner. By combining these aspects, DANCE significantly outperforms previous approaches by a large margin. _Additionally_, existing methods are data-hungry, heavily relying on cell type annotations. Therefore, when the number of labels decreases, the performance drops rapidly. In contrast, DANCE is data-efficient, capable of achieving excellent performance with fewer labels. Consequently, the performance decline due to label reduction is less pronounced, thanks to our proposed dual label scarcity elimination strategy. Due to the potential class imbalance issue in single-cell data, simply increasing the number of labels may not improve performance for some methods. For example, on the snRNA_SMARTer-snmC dataset, scBridge  achieves a performance of \(36.15\%\) under high label ratio, which is not better than that of \(39.75\%\) under mid label ratio. In contrast, our OT-based pseudo-labeling approach considers distributing pseudo-labels in a one-to-many manner, effectively preventing biased predictions. Therefore, on all datasets, increasing the number of labels leads to corresponding performance improvements for our DANCE.

Ablation Study.As depicted in Table 2, we conduct comprehensive experiments on different model variants to explore the contributions of each proposed module. DANCE w/o OP represents DANCE without the proposed OT-based pseudo-labeling. DANCE w/o SL denotes DANCE without the consistency regularization for source-like samples. DANCE w/o TS indicates DANCE without the ambiguous set learning for target-specific samples. DANCE w/o CM signifies DANCE without the cross-omic multi-sample Mixup. From the results, it can be observed that the performance of DANCE w/o OP significantly decreases. This indicates that OT-based pseudo-labeling effectively alleviates the label scarcity issue in scRNA-seq data by generating pseudo-labels for source scRNA-seq data and augmenting the scRNA-seq dataset. Additionally, the slight decrease in performance of DANCE w/o SL suggests that for heterogeneous scATAC-seq data, applying consistency regularization to source-like

   Dataset &  &  &  &  \\  Label Ratio & Low & Mid & High & Low & Mid & High & Low & Mid & High & Low & Mid & High \\  DANCE w/o OP & 31.87 & 38.55 & 40.86 & 55.60 & 61.89 & 67.69 & 33.74 & 38.31 & 44.56 & 51.66 & 59.57 & 64.18 \\ DANCE w/o SL & 48.10 & 49.09 & 49.94 & 70.04 & 76.61 & 79.00 & 49.98 & 52.56 & 54.75 & 74.08 & 79.33 & 79.89 \\ DANCE w/o TS & 48.62 & 49.01 & 49.95 & 73.85 & 77.22 & 78.91 & 49.74 & 53.07 & 55.26 & 73.99 & 79.88 & 80.85 \\ DANCE w/o CM & 44.80 & 45.63 & 45.69 & 55.91 & 59.92 & 68.79 & 46.75 & 48.01 & 49.97 & 70.81 & 76.34 & 78.02 \\ Full Model & **50.23** & **51.02** & **51.42** & **75.72** & **78.67** & **80.12** & **52.02** & **54.38** & **56.30** & **75.23** & **81.38** & **81.76** \\   

Table 2: Ablation studies (in \(\%\)) of DANCE in different settings. **Bold** numbers indicate best results.

Figure 3: (a) The parameter sensitivity with respect to \(k\) and \(\) on scRNA_SMARTer-ATAC with various label ratios. (b) The t-SNE visualization of two modalities (scRNA_10X_v2: red, ATAC: blue) with high label ratio. (c) The A-distance comparison with different label ratios.

samples can further enhance model performance. Similarly, the minor decrease in performance of DANCE w/o TS suggests that target-specific samples should not be simply discarded as in previous methods. For these samples, collecting potentially correct cell types and removing them can provide weak supervision, thereby hiding performance improvement. Furthermore, the significant decrease in performance of DANCE w/o CM underscores the severity of the cell heterogeneity issue. Our proposed cross-omic multi-sample Mixup effectively eliminates the heterogeneous gap by generating mixed source scRNA-seq samples that simulate the distribution of target scATAC-seq data and aligning the two modalities. Thus, the effectiveness of all proposed modules is sufficiently validated.

Sensitivity Analysis.In Figure 3 (a), we analyze the sensitivity of two crucial hyper-parameters \(k\) and \(\) on scRNA_SMARTer-ATAC. Firstly, we fix the other parameters to investigate the sensitivity of the model to different values of \(k\). Here, \(k\) denotes the size of the partial label set and is used to control the number of potential correct cell types. As \(k\) varies within the range \(\{2,3,4,5,6,7\}\), the model's performance initially increases before gradually stabilizing. Considering all three scenarios, the optimal performance is achieved at \(k=4\) or \(k=5\). Next, with other parameters fixed, we analyze the sensitivity of the coefficient \(\) of \(_{TS}\) in Eqn. 10. Since \(_{TS}\) provides additional weak supervision by removing incorrect cell types, it typically requires a small coefficient. We change the value of \(\) within the range \(\{0.05,0.1,0.15,0.2,0.25,0.3\}\). Similarly, the model's performance firstly increases and then decreases, with better performance observed at \(=0.1\).

t-SNE Visualization.In Figure 3 (b), we make the t-SNE  visualization to assess the heterogeneous gap of representations learned by scNCL  and our DANCE on scRNA_10X_v2-ATAC. Note that the higher overlap degree between the red and blue parts reflects the lower cell heterogeneity between scRNA-seq and scATAC-seq data. It can be observed that there is almost no overlap between the representations of scNCL , indicating that it does not address the issue of cell heterogeneity. In contrast, the representations of our DANCE exhibit a high degree of overlap, indicating that our approach effectively mitigates cell heterogeneity even in the presence of label scarcity.

A-distance Comparison.In Figure 3 (c), we compare the A-distance on scRNA_10X_v2-ATAC with various label ratios. The A-distance is calculated by employing a model and testing its ability to distinguish between the two modalities. Therefore, a low A-distance indicates a small heterogeneous gap. The A-distance is defined as: \(dist_{}=2(1-2)\), where \(\) is the test error. When \(=0\), the upper bound of \(dist_{}\) is \(2\). This indicates that there is a significant heterogeneous gap between the two modalities, and the model can easily differentiate between them. From the results, it can be observed that the A-distance of FixMatch  and scNCL  consistently remains close to \(2\), indicating a significant heterogeneity between scRNA-seq data and scATAC-seq data. In contrast, DANCE successfully reduces cell heterogeneity, resulting in a significant decrease in the A-distance.

## 6 Conclusion

In this paper, we focus on a realistic yet underexplored problem of knowledge transfer across multi-omic single-cell data under label scarcity in both scRNA-seq and scATAC-seq data, and propose a semi-supervised framework termed DANCE for this problem. Specifically, DANCE operates dual label scarcity elimination by OT-based dataset expansion for scRNA-seq data and a divide-and-conquer strategy for scATAC-seq data. DANCE further introduces a sample-to-sample alignment strategy of cross-omic multi-sample Mixup to reduce cell heterogeneity. Extensive experiments on various datasets verify the superiority of DANCE in comparison to many state-of-the-art approaches.

Broader Impacts and Limitations.This study addresses the challenge of knowledge transfer across multi-omic single-cell data, which has significant potential for advancing biological research by reducing annotation costs in both source and target biological data. However, it is important to acknowledge that this work represents an initial exploration of this field and may have certain limitations. For instance, our method may not perform optimally in complex real-world scenarios, including open-set knowledge transfer and knowledge transfer under label noise. Additionally, this study primarily focuses on static scenarios, while there are complex dynamic applications, such as single-cell RNA velocity inference, that require further investigation. In future research, our goal is to address these challenges and expand our approach to encompass more generalized scenarios. To the best of our knowledge, no potential negative impacts resulting from our work have been identified.