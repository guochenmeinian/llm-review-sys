# Dynamic Pricing and Learning

with Bayesian Persuasion

 Shipra Agrawal

Columbia University

sa3305@columbia.edu &Yiding Feng

University of Chicago

yidingfeng@uchicago.edu &Wei Tang

Columbia University

wt2359@columbia.edu

###### Abstract

We consider a novel dynamic pricing and learning setting where in addition to setting prices of products in sequential rounds, the seller also ex-ante commits to 'advertising schemes'. That is, in the beginning of each round the seller can decide what kind of signal they will provide to the buyer about the product's quality upon realization. Using the popular Bayesian persuasion framework to model the effect of these signals on the buyers' valuation and purchase responses, we formulate the problem of finding an optimal design of the advertising scheme along with a pricing scheme that maximizes the seller's expected revenue. Without any apriori knowledge of the buyers' demand function, our goal is to design an online algorithm that can use past purchase responses to adaptively learn the optimal pricing and advertising strategy. We study the regret of the algorithm when compared to the optimal clairvoyant price and advertising scheme.

Our main result is a computationally efficient online algorithm that achieves an \(O(T^{}{{3}}}(m T)^{}{{3}}})\) regret bound when the valuation function is linear in the product quality. Here \(m\) is the cardinality of the discrete product quality domain and \(T\) is the time horizon. This result requires some natural monotonicity and Lipschitz assumptions on the valuation function, but no Lipschitz or smoothness assumption on the buyers' demand function. For constant \(m\), our result matches the regret lower bound for dynamic pricing within logarithmic factors, which is a special case of our problem. We also obtain several improved results for the widely considered special case of additive valuations, including an \((T^{}{{3}}})\) regret bound independent of \(m\) when \(m T^{1/3}\).

## 1 Introduction

Dynamic pricing is a key strategy in revenue management that allows sellers to anticipate and influence demand in order to maximize revenue and/or utility. When the customer valuation and demand response for a product is apriori unknown, price variation can also be used to observe and learn the demand function in order to adaptively optimize price and revenue over time. This learning and optimization problem has been a focus of much recent literature that uses exploration-exploitation and multi-armed bandit techniques with dynamic pricing algorithms (e.g., see ).

In practice, there is another important tool available to sellers in the form of _advertising_, using which the sellers can inform and shape customers' valuations of a product. It has been theoretically  and empirically  shown that advertisements can serve as a credible signal of the quality or characteristics of the advertised product. Sellers can use advertising to provide partial information about a product in order to better position the product in the market and potentially increase customers' chances of purchasing the product. For example, as a common strategy to drive

[MISSING_PAGE_FAIL:2]

the fact that at each round, the buyer is facing a fresh product, whose quality is drawn independently across time. Thus, previous signals do not carry information about the current product. Fresh products with independent qualities are common in many real-world applications such as second-hand markets, mystery boxes sold by AmazonWoat, etc. This similar problem structure has also been studied in the online/sequential Bayesian persuasion literature with repeated interactions of sender and receivers, for example, see .

A summary of the game timeline is as follows: at \(t[T]\), (1) the seller commits to a price \(p_{t}[0,U]\) and an advertising strategy \(_{t}\); (2) a buyer \(t\) with private type \(_{t} F\) arrives; (3) a product with quality \(_{t}\) is realized; the seller sends signal \(_{t}_{t}(|_{t})\) to the buyer; (4) the buyer formulates Bayesian posterior \(_{t}(|_{t})\), and the buyer purchases the product (denoted by \(a_{t}=1\)) to generate revenue \(p_{t}\) if and only if her expected value exceeds the price, i.e., \(_{_{t}(|_{t})}[v(_{t},)] p_{t}\).

Our goal is to design an online learning algorithm that sequentially chooses the price and advertising strategy \(p_{t},_{t}\) in each round \(t\) based on the buyers' responses in the previous rounds, in order to optimize total expected revenue over a time horizon \(T\) without apriori knowledge of the distribution \(F\). Let \((p_{t},_{t})[p_{t} a_{t};p_{t},_{ t}]\) denote the expected revenue at time \(t\) under the price \(p_{t}\) and advertising strategy \(_{t}\). Here the expectation is over realizations of customer type \(_{t} F\), product quality \(_{t}\) and advertising signal \(_{t}_{t}(|_{t})\). Note that since product quality and types are i.i.d. across time, for any given \(p_{t}=p,_{t}=\), the expected per-round revenue \((p,)\) does not depend on time. Thus a static price and advertising strategy maximizes total expected revenue over the time horizon \(T\). Therefore, we can measure the performance of an algorithm in terms of _regret_ that compares the total expected revenue of the algorithm to that of the best static pricing and advertising strategy. We define

\[(T) T_{p,}(p,)-_{t=1}^{T }(p_{t},_{t})\;.\]

**Our contributions.** In this work, we present a computationally efficient online pricing and advertising algorithm that achieves an \(O(T^{}{{3}}}(m T)^{}{{3}}})\) bound on the regret in time \(T\), where \(m=||\) is the cardinality of the (discrete) product quality space. Importantly, we achieve this result without any assumptions like Lipschitz or smoothness on the demand function \(D()=1-F()\). However, our results require certain assumptions on the valuation function. Following the literature, we make the common assumption that the function \(v(,)\) is linear in the product quality \(\). Furthermore, we assume the following monotonicity and Lipschitz properties on the valuation function.

**Assumption 1**.: _Buyer's valuation function \(v(,)\) satisfies:_

1. _Fix any buyer type_ \(\)_, function_ \(v(,)\) _is non-decreasing w.r.t. quality_ \(\)_._
2. _Fix any quality_ \(\)_, function_ \(v(,)\) _is increasing and_ \(1\)_-Lipschitz__,_ w.r.t. type_ \(\)_._

Such assumptions are in fact common in literature and natural in many economic situations where the valuation of a product increases with the product quality and buyer's type (paying ability/need). Existing literature on Bayesian persuasion/dynamic pricing often makes even stronger assumptions about the receiver's utility function. For example, both the additive functions \(v(,)=+\) [cf.  and the multiplicative functions \(v(,)=+\) [cf. ], are linear in \(\) and satisfy Assumption 1 Our main result is then summarized as follows:

**Theorem 1.1**.: _For any type CDF \(F\), given a valuation function \(v(,)\) that is linear in product quality \(\) and satisfies Assumption 1 Algorithm 1 with parameter \(=(}{{3}}})}}{{}}\) has an expected regret of \(O(T^{}{{3}}}(m T)^{}{{3}}})\). Here, \(m\) is the cardinality of the discrete quality space \(\)._

Furthermore, we obtain several improved results for the widely considered special case of additive valuations, i.e., for \(v(,)=+\). See Appendix B for the formal statements and analysis.

1. **(Theorem B.1)** Consider discrete sets \(\) that are 'equally-spaced', e.g., \(=\{0,1\}\) or \(=[m]\). Given such a product quality space \(\) and additive valuation function, we show that the regret of Algorithm 1 is bounded by \(O(T^{}{{3}}}( T)^{}{{3}}})\) when \(m}{{3}}}}}{{}}\), and by \(O()\) for larger \(m\).

2. **(Theorem 3.2)** For any arbitrary (discrete or continuous) product quality space \(\), given additive valuation functions, we have a slightly modified algorithm (see Algorithm 3 in Appendix C.2) with an expected regret of \(O(T^{3/\!4}( T)^{}{{4}}})\) independent of \(m\).

When the valuation function \(v(,)\) is \(L\)-Lipschitz w.r.t. type \(\), our regret bound in Theorem 1 would become \(O(T^{}{{3}}}(Lm T)^{}{{3}}})\), and the regret bound for arbitrary space \(\) would become \(O(T^{}{{4}}}(L T)^{}{{4}}})\).

We might compare our results to the best regret bounds available for the well-studied dynamic pricing and learning problem with unlimited supply , which is a special case of our problem if the product quality is deterministic, i.e., \(m=1\), and the advertising scheme reveals no information and thus has no impact on the buyer's purchase decision. For the dynamic pricing problem a lower bound of \((T^{2/3})\) on regret is known . Therefore the dependence on \(T\) in our results cannot be improved. In fact, our result matches this lower bound in the case of binary or constant size quality space, which are common settings in information design literature .

**High-level descriptions of the proposed algorithm and challenges.** Our problem can be viewed as a very high dimensional combinatorial multi-armed bandit problem, where each arm is a pair of a price and a feasible advertising strategy: the set of feasible advertising strategies being the set of all possible conditional distributions \(\{(|),\}\) over signal space \(\). As a first step towards obtaining a more tractable setting, we present an equivalent reformulation of the problem which uses the observation that advertising affects the buyer's decision only via the posterior distribution over quality. By the linearity of valuation function \(v(,)\) over product quality \(\), seller's choice of advertising strategy in every round can be further simplified to selecting a distribution over posterior means that is subject to a feasibility constraint.

From here, the seller's decision space now becomes two-dimensional (a price and a distribution of posterior means). Viewing seller's expected revenue as an unknown (nonlinear) function over this two-dimensional decision space, one may consider applying algorithms in contextual bandits or Lipschitz bandits to get sublinear regrets, e.g., \((T^{}{{4}}}(m))\) regret for two-dimensional decision space if there exists a Lipschitz property of reward function relative to seller's decision space. However, it is unclear whether one can establish such Lipschitz property given that we do not assume Lipschitzness or smoothness on demand function and we have complex constraints on the feasibility of advertising space. Instead, in our algorithm we use a'model-based approach': we use buyers' purchase responses to explore the demand function over the (discretized) type space and jointly learn the optimal advertising and pricing. To explore the demand function over the one-dimensional (discretized) type space, we propose a novel discretization scheme such that it enables near-optimal price and advertising strategy even without Lipschitzness or smoothness assumption and with the complex feasibility constraint on the advertising space. These treatments lead us to the optimal \((T^{}{{3}}}m^{}{{3}}})\) regret.

**Related work.** Our work is related to several streams of research. Below we briefly review the some of these connections.

In our setting, the seller can utilize her information advantage to design an advertisement to signal the product quality to the buyer. There is a long line of research in the literature, from both empirical and theoretical perspective, dedicated to study how to use advertisement as a signal to steer buyers' evaluations of advertised goods . In our problem, we follow the literature in information design, a.k.a., Bayesian persuasion [also see the recent surveys by , where the seller can commit to an information policy that can strategically disclose product information to the buyer so that to influence buyer's belief about the product quality. Similar formulation for advertising has also appeared in . Our work differs from these works in several ways. First, the seller's offline problem in our setting is a joint pricing and advertising problem. Second, we focus on an online setting where the seller has no apriori knowledge of the demand function and has to use past buyers' purchase responses to adaptively learn optimal pricing and advertising strategy.

Our problem shares similarity to the problem on sale of information in economics and computer science literature . In particular, similar to the problem on sale of information, the seller, in our setting, also commits to design an information structure to reveal information about the realized state to the decision maker (i.e., buyer); and the buyer, in our setting,then makes the payment based on the declared information structure, not for specific realizations of the seller's informative signals . However, different from these works, the seller in our setting is selling a product with some inherent value and not just information. The valuation of the product can be shaped by providing information. This gives new interesting tradeoffs between information and revenue in our problem that are absent in the settings where only information is being sold. Moreover, in most literature of selling information, the buyers' type distribution is usually assumed to be known. We consider a more practical data-driven setting where the underlying buyers' type distribution (demand function) is apriori unknown to the seller and needs to be learnt from observations.

Facing unknown buyer's preference (i.e., buyer's private type), the seller's dynamic advertising problem also relates to the growing line of work in information design on relaxing one fundamental assumption in the canonical Bayesian persuasion model - the sender perfectly knows receiver's preference. The present paper joins the recent increased interests on using online learning approach to study the regret minimization when the sender repeatedly interacts with receivers  without knowing receivers' preferences. Moreover, our work also conceptually relates to research on Bayesian exploration in multi-armed bandit  which also studies an online setting where one player can utilize her information advantage to persuade another player to take the desired action. Our work departs from this line of work in terms of both the setting and the application domain. Particularly, the above works typically consider an online setting on how to learn optimal signaling scheme whereas in our setting the optimal policy is a joint pricing and signaling (advertising) scheme.

When there is no uncertainty in the product quality, the seller's problem in our setting reduces to a standard dynamic pricing and learning problem with unknown non-parametric demand function . However, given any non-trivial product quality space and prior distributions, in our problem, in addition to a price, the seller needs to choose a non-trivial advertising strategy in order to maximize revenue. This makes the seller's decision space high dimensional and (as we discuss in the next section) introduces significant complexities and difficulties so that the typical techniques (like uniform or adaptive discretization) used in pricing and continuous/combinatorial multi-armed bandit literature cannot be directly applied.

## 2 Algorithm Design

In this section, we present our main algorithm for the dynamic pricing and advertising problem. In subsection 2.1 we present an equivalent reformulation for tractable advertising strategies, then in subsection 2.2 we discuss many important challenges even after this simplification, and finally, in subsection 2.3 we present our algorithm.

### An equivalent reformulation for tractable advertising strategies

Recall that in every round, the buyer \(t\) sees the offered price \(p_{t}\) and advertising strategy \(_{t}\) that specifies the distributions over signals \(_{t}(|)^{}\) that the seller will send for each possible value \(\) of the realized product quality. After the product quality \(_{t}\) is realized, the buyer \(t\) sees a signal \(_{t}_{t}(|_{t})\) from the seller's declared advertising strategy. The buyer uses this signal along with the prior \(\) to form a Bayesian posterior \(_{t}(|_{t})^{}\) on the product quality. The Bayesian rational buyer then takes the action \(a_{t}\{0,1\}\), based on expected utility maximization. In particular, we have \(a_{t}=1\) if \(_{_{t}(|_{t})}[v(_{t},)] p_{t}\) and \(a_{t}=0\) otherwise.

From the decision formula above, it is clear that the choice of advertising strategy affects the buyer \(t\)'s decision only through the realized posterior \(_{t}(|_{t})\). Consequently, the seller's choice of advertising strategy in time \(t\) can be reduced to selecting a distribution over posteriors \(_{t}\). Seller's choice can in fact be further simplified in the case where the buyer's valuation function is linear in the product quality \(\) since in that case we have

\[_{_{t}(|_{t})}[v(_{t},)]=v( _{t},_{_{t}(|_{t})}[])=v(_ {t},q_{t})\]

where \(q_{t}\) is the realized posterior mean \(q_{t}_{_{t}(|_{t})}[]\). Here \(q_{t}\) since \(\). Therefore the buyer purchases (\(a_{t}=1\)) if and only if \(v(_{t},q_{t}) p_{t}\). As a result, we can reduce the seller's advertising in round \(t\) to the choice of distribution (pdf) \(_{t}()^{}\) over posterior means.

However, the choice of \(_{t}\) must be restricted to only feasible distributions of posterior means, that is, all possible distributions over posterior means that can be induced by any advertising scheme given the prior \(\). It is well known that the distribution over posterior means \(\) is feasible if and only if it is the mean-preserving contraction of the prior . This condition can be equivalently written in terms of a Bayes-consistency condition  on the conditional means \((|),\). For simplicity of exposition, we consider discrete quality space \(=\{_{1},,_{m}\}\), where \(0=_{1}<_{2}<<_{m}=1\) and \(m=||\) is the cardinality of the quality space. Then, a distribution \(\) over posterior means is feasible if one can construct a set of conditional distributions \((_{i})_{i[m]}\) satisfying the following Bayes-consistency condition, and vice versa :

\[_{i}_{i}(q)_{i}}{_{i[m]} _{i}_{i}(q)}=q, q()\;.\] (BC)

Throughout this paper, we use the collection of distributions \((_{i})_{i[m]}\) satisfying (BC) condition as a convenient way to construct feasible distributions over posterior means: \((q)=_{i}_{i}(q)_{i}\).

With the above observations, we can without loss of generality assume that seller's advertising strategy is to directly choose a distribution \(_{t}\) over the posterior means that satisfies (BC), without considering the design of the underlying signaling scheme \(\{(|),\}\).

We summarize the new equivalent game timeline as follows: at \(t[T]\), (1) the seller commits to a price \(p_{t}[0,U]\) and an advertising strategy \(_{t}=(_{i,t})_{i[m]}\) satisfying (BC); (2) a buyer \(t\) with private type \(_{t} F\) arrives; (3) a product with quality \(_{t}\) is realized; a posterior mean \(q_{t}_{t}\) is realized; (4) the buyer observes the posterior mean \(q_{t}\); the buyer purchases the product (\(a_{t}=1\)) to generate revenue \(p_{t}\) if only if \(v(_{t},q_{t}) p_{t}\). Note that the seller knows the form of the buyer's valuation function \(v\). Moreover, the seller observes the realized product quality \(_{t}\), the realized posterior mean \(q_{t}\), and the buyer's purchase decision \(a_{t}\), but does not know type CDF \(F\) (i.e., the demand function \(D\)) and the realized buyer type \(_{t}\).

**Revenue and regret.** Given the new formulation, we can also rewrite the revenue and regret in terms of the choices of \(_{t},t=1,,T\). We define the following function \((p,q)\), which we refer to as the _critical type_ for a given price \(p\) and posterior mean \(q\).

**Definition 2.1** (Critical type).: _For any \(p[0,U]\) and \(q\), define function \((,)\) as \((p,q)\{:v(,q) p\}\)._

Now under Assumption  due to the monotonicity of the valuation function in buyer's type, we have that given any \(p,q,,}[v(,q) p]=[ (p,q)]\). Therefore, the buyer \(t\) will purchase the product if and only if \(_{t}(p_{t},q_{t})\).

Therefore, given the price, advertising \(p_{t}=p,_{t}=\) and prior distribution \(\), the expected revenue in any round \(t\) is given by 

\[(p,)=_{, F,q}[p [(p,q)]]=p_{i}_{i}_{0}^{1} _{i}(q)D((p,q))dq \]

Let the seller's online policy offer price \(p_{t}\) and advertising \(_{t}\) at time \(t\), where \(p_{t},_{t}\) can depend on the history of observations/events up to time \(t\). Then expected regret defined in Section  can be equivalently written as

\[[T]=T(p^{*},^{*})-_{t=1}^{T}[ (p_{t},_{t})]\;.\]

Here, the expectation is taken with respect to any randomness in the algorithm's choice of \(p_{t},_{t}\); and \(p^{*},^{*}=(_{i}^{*})_{i[m]}\) are defined as the best price and advertising strategy for a given \(F\) (and \((,)\) which is determined by \(F\)). Given the expression for \((p,)\) derived above, these can be characterized by the following optimization program

\[p^{*},^{*}_{p,} (p,)\] ( \[_{}\] ) s.t. \[_{i}_{i}(q)_{i}}{ _{i[m]}_{i}_{i}(q)}=q, q;_{i}^{}, i[m]\;.\]

where the first constraint is due to (BC).

### Algorithm design: challenges and ideas

**Challenge: high-dimensional continuous decision space.** In the last section, we obtained a considerable simplification of the problem by reducing the seller's advertising strategy in every round \(t\) to a _distribution_\(_{t}^{}\) over posterior means satisfying the \(}\) condition. However, the decision space (a.k.a space of arms) still remains high dimensional and therefore a naive application of (uniform or adaptive) discretization-based bandit techniques, e.g. from Lipschitz bandit literature , would not achieve the desired results.

**Algorithm design idea: exploring over one-dimensional type space.** Our algorithm uses a'model-based approach' instead, where we use buyer purchase responses to develop (upper confidence bound) estimates of the demand model \(D()=1-F()\) on the points of a _discretized type space_\(\). We then use these upper confidence bounds to construct a piecewise-constant demand function that is an upper confidence bound (UCB) for the demand function \(D\). Then, in each round we solve for the optimal price and advertising strategy by solving an optimization problem similar to \(}\) but with the UCB demand function.

**Challenge: efficient discretization of type space.** The challenge then is to design a discretization scheme for the type space such that we have a) efficient learning, i.e., the discretized space can be efficiently explored to accurately estimate the demand function on those points, and b) Lipschitz property, i.e., the optimal revenue with the UCB estimate of demand function is close to the true optimal revenue as long as the estimation error on the discretized space is small.

There are two main difficulties in achieving this: (1) Lack of any smoothness/Lipschitz assumption on CDF \(F\). (2) Sensitivity of the Bayes-consistency condition \(}\). To see these difficulties, recall that given a price \(p_{t}\) and realized posterior mean \(q_{t}\), the \(t^{th}\) buyer's purchase decision is given by \(a_{t}=[_{t}(p_{t},q_{t})]\); thus the seller can obtain demand function estimate at point \((p_{t},q_{t})\). Without any smoothness or Lipschitz property of demand function, estimates of demand function cannot be extrapolated accurately to other points. This means that in our revenue optimization problem (estimated version of \(}\)), we need to find a price and advertising strategy that we can only use estimates of demand function on a discretized type space, say \(\). However, if we restrict to a discretized type space \(\), then the support of posterior mean distributions (a.k.a advertising strategy) must be restricted to the points \(q\) such that the corresponding critical types \((p,q)\) are in the set \(\).

Unfortunately, the \(}\) condition makes the set of feasible advertising strategies very sensitive to their support. In particular, if we use uniform-grid based discretization (which is commonly used in previous dynamic pricing literature such as ), it is easy to construct examples of prior distribution and valuation function such that there are no or very few feasible advertising strategies with the corresponding restricted support.

**Example 2.2**.: _Consider additive valuation function, i.e., \(v(,)=+\), and thus \((p,q)=p-q\). Consider quality space \(=\{_{i}\}_{i}\). Given a small \(\), consider a uniform-grid based discretization for the type space \(\), i.e., \(=\{0,,2,,1\}\). If we also use a price \(p\) that is from uniform-grid based discretized price space, i.e., \(p=k\) for some \(k N^{+}\), then to ensure \((p,q)\), the support of advertising strategy (i.e., the distribution of the posterior means) must also be restricted within the set \(\). However, if the prior distribution \(\) has negligible probabilities on qualities \(_{1},_{3}\), and quality \(_{2}\), then we cannot construct any posterior distribution with the mean in the set \(\). Therefore, there does not exist any feasible advertising strategy._

_Note that this difficulty cannot be fixed by simply modifying the discretized type space to \(\), because even then we would need to construct an advertising such that \((p,q)=p-q\) in the grid for all \(p\). That would need that the support of the strategy (i.e., posterior means \(q\)) is restricted to be in \(\{k-_{i}\}_{k^{+},i}\); such posterior means again may not be achieved here._

**Algorithm design idea: novel discretization scheme.** Our algorithm employs a carefully-designed _quality-and-price-dependent discretization_ scheme. The above example shows that we cannot uniformly discretize price and type using \(\)-grids, as we may not have any feasible advertising strategy under such discretization. And furthermore, it also shows that this difficulty cannot be fixed by simply adding the \(m\) points in quality space to the discretized type space \(\). Instead, in our discretization scheme, we first uniformly discretize the price space to an \(\)-grid \(\). Then to construct a discretizedtype space \(\), in addition to the points on an \(\)-grid over \(\), we also include points \(\{(p,)\}\) for every price \(p\) and quality \(\). This gives us a discretized type space \(\) of size \(mU/\). We claim that our construction ensures that there exist near-optimal price and advertising strategy with support in the discretized type space \(\). The proof of this claim requires a careful rounding argument, which forms one of the main technical ingredients for our regret analysis in Section 3.

### Details of the proposed algorithm

Our dynamic pricing and advertising algorithm jointly discretizes the price space and type space using the following _quality-and-price-dependent discretization_ scheme: given parameter \(\), we define the following set:

\[ \{,2,,U\} \] \[ \{0,,,1-,1\}\{( (p,) 1) 0\}_{p,}\,.\]

At time \(t\), we restrict the price and advertising strategies \((p_{t},_{t})\) to the set of \((p,=(_{i})_{i[m]})\) such that \(p\), and given price \(p\), each conditional distribution \(_{i}\) has restricted support \(_{p}\) defined as \(_{p}\{q:(p,q)\}\). Given the price and advertising \(p_{t},_{t}\), let the realized posterior mean at time \(t\) be \(q_{t}_{t}\), and let the corresponding critical type be \(x_{t}(p_{t},q_{t})\). Then, note that the above restrictions on price and advertising strategies guarantee that \(x_{t}\).

Next, to compute the offered price and advertising strategy in round \(t\), we optimize an upper confidence bound on the revenue function that we develop using upper confidence bounds \(D^{}(x),x\) of the demand function computed as follows. For every type \(x\), let \(_{t}(x)\) denote the set of time rounds before time \(t\) that the induced critical type is exactly \(x\), and let \(N_{t}(x)\) be the number of such time rounds. That is, \(_{t}(x)\{<t:(p_{},q_{})=x\}\,,N_{t}(x) |_{t}(x)|,x\).

Recall that buyer's purchase decision follows \(a_{}=[_{}(p_{},q_{})]\). We estimate the demand function at \(x\) as: \(_{t}(x)_{t}(x)}a_{}}{N_{t} (x)}\). We can now define the following UCB index:

\[D^{}_{t}(x)=_{x^{}:x^{} x}_{t}(x^{})+(x^{})}}+ (x^{}))(1+N_{t}(x^{}))}}{N_{t}(x^{})} 1, x  \]

Then, for any pair of discretized price \(p\) and advertising strategy with discretized support for that price \(=(_{i}^{_{p}},i[m])\), we define the following seller's revenue estimates:

\[^{}_{t}(p,) p_{i[m]}_{i} _{0}^{1}_{i}(q)D^{}_{t}((p,q))dq\,.\]

Above is well-defined since by definition \((p,q)\) for each such \((p,q)_{p}\). Finally, we let \(p_{t},_{t}\) be the optimal solution to the following optimization problem:

\[(p_{t},_{t})=_{p,}& ^{}_{t}(p,)\\ & p;\  _{i}_{i}(q)_{i}}{_{i[m]}_{i}_{i}(q)} =q,\ \ q_{p};\ _{i}^{_{p}},\ i[m]\,.\] ( \[^{}_{t}\] )

We summarize our algorithm as Algorithm 1. The main computational bottleneck of Algorithm 1 is to solve the high-dimensional program \(^{}_{t}}\) at each time \(t||+1\). As we illustrate in Proposition 2.1 there exists an efficient method to optimally solve this program. The proof of this result utilizes the monotoncity of the function \(D^{}_{t}\).

**Proposition 2.1** (Adopted from  ).: _Let \(\) be the discretization parameter for the set \(\) defined in 2. There exists a polynomial time (in \(|}}{{}}\)) algorithm that can solve the program \(^{}_{t}}\)._

Proof.: Since function \(D^{}_{t}\) is monotone with discontinuities at the points in the set \(\), when we fix a price \(p\), the function \(D^{}_{t}((p,))\) is also monotone with discontinuities at the points in \(_{p}=\{q:(p,q)=x\}_{x}\). Given a prior \(\), optimizing a monotone function with discontinuities over all feasible advertising strategies induced from the prior \(\) subject to the constraint where the support of advertising strategies must be in the set \(_{p}\) has been studied in . It has been shown that there exists a polynomial (w.r.t. the number of discontinuities) algorithm based on convex programming that can find an optimal advertising strategy (see Proposition 2 in ). Thus, an exhaustively search over the discretized price space \(\) can lead to an optimal solution to the program \(}^{}_{t}\) 

We conclude this section with the following remark on the extension to unbounded type support.

**Remark 2.3**.: _Our algorithm and analysis can be extended to the case with unbounded type support (e.g., \(=[0,)\)). In particular, since the price is bounded by \([0,U]\), and the quality is bounded within \(\), by the monotonicity of the valuation function, we know the critical types \((p,q)\) induced by any possible \(p[0,U]\) and \(q\) is bounded within \([(0,1),(U,0)]\). Thus, an instance with unbounded type support is equivalent to an instance with bounded type support \([(0,1),(U,0)]\)._

## 3 Regret Analysis: Proof Overview of Theorem 1

In this section, we present our main regret bound for Algorithm \(\) as stated in Theorem 1. Specifically, we show that for any type CDF \(F\), given a valuation function \(v(,)\) that is linear in product quality \(\) and satisfies Assumption 1 our algorithm (Algorithm \(\) with parameter \(=((m T/T)^{})\)), has an expected regret of \(O(T^{}(m T)^{})\). Importantly, for this result we do not assume any smoothness or Lipschitz properties of distribution \(F\).

For this result, we consider arbitrary but discrete quality space \(\) of cardinality \(m\). Later in Appendix B we show improved regret bounds for the case of additive valuations and equally-spaced quality space (see Theorem B.1), and also extend to arbitrary large and continuous quality spaces (see Theorem B.2).

**Proof outline.** Recall that in every round \(t\), Algorithm \(\) sets the price \(p_{t}\) and advertising strategy \(_{t}\) as an optimal solution of program \(}^{}_{t}\) that approximates the benchmark \(}_{}\) in two ways. Firstly, it restricts the price and support of advertising strategy to be in a discretized space \(\{_{p},p\}\). Secondly, it approximates the true demand function with an upper bound \(D^{}_{t}\). Our proof consists of two main steps that bound the errors due to each of the above approximations. Due to the space limit, all missing proofs in this section are deferred to Appendix A

* **Step 1: bounding the discretization error using a rounding argument (see Appendix A.1).** To separate the discretization error from the error due to demand function estimation, we consider an intermediate optimization problem \(}\) (in Appendix A.1) obtained on replacing the UCB demand function \(D^{}_{t}\) with the true demand function \(D\) (while keeping the discretized space for \(p,\)). Let \(^{*},^{*}\) be an optimal solution of program \(}\). We show that the revenue \((^{*},^{*})\) is sufficiently close (within \(2\)) to the optimal revenue \(}(p^{*},^{*})\). This bound is obtained using a careful _rounding_ argument: we show that the optimal price \(p^{*}\) and the optimal advertising \(^{*}\) can be rounded to a new price \(p^{}\) and a new advertising \(^{}\) that satisfy (i) feasibility (Lemma A.4): \(p^{},(^{}) (_{p^{}})\); and (ii) revenue guarantee (**Lemma A.5**): \((p^{},^{})(p^{*},^{*})-2\).
* **Step 2: bounding estimation error and establishing optimism (see Appendix A.3).** Next, we show that the UCB estimates of the demand function \(D_{t}^{}(x),x\) converge to the true demand function \(D\) with high probability, along with concentration bounds on the gap between the true and estimated function (**Lemma A.7**). This allows us to show that (i) Revenue optimism (**Lemma A.8**): we show that the algorithm's revenue estimates are (almost) optimistic, i.e., \(_{t}^{}(p_{t},_{t})(^ {*},^{*})(p^{*},^{*})-2\). (ii) Revenue approximation (**Lemma A.9**): we show that the optimistic revenue estimates are close to the true revenue in round \(t\), with the gap between the two being inversely proportional to the number of observations, in particular, \(_{t}^{}(p_{t},_{t})-(p_{t},_{t})  5p_{t}_{q_{t}}((p_ {t},q))}\).

Finally, in Appendix A.7 we put it all together to bound the regret as stated in Theorem 1.1 We first use the above observations to show that regret over each round can be roughly bounded as \(2 T+5p_{t}_{q_{t}}(( p_{t},q))}\). Then, using the constraint \(_{x}N_{T}(x) T\), we show that in the worst case, total regret over time \(T\) is bounded by \(O(T+|T T})\). The theorem is then obtained by substituting \(||=O(}{{}})\) and optimizing \(\).

## 4 Conclusions and Future Direction

In this work, we use a foundational information design framework, Bayesian persuasion, to model the effect of an advertising strategy on customers' beliefs about product quality and consequently their purchase decisions. Our formulation combines the Bayesian persuasion model with dynamic pricing and learning to quantify the tradeoffs between the design of the pricing and advertising strategies and their combined impact on the revenue outcomes. Without any apriori knowledge of the demand function, we show that there exists an efficient online policy that has the regret \(O(T^{2/3}(m T)^{1/3})\) for a finite state space with cardinality \(m\). This result implies that when the number of the states \(m\) is a constant, there is almost no additional learning regret for the seller to additionally learn the optimal advertising compared to the dynamic pricing (without advertising) for non-parametric demand learning problem. There are interesting future directions from this work. First, in our current formulation, buyers' valuation is linear w.r.t the product states. It would be interesting to explore whether our results could be generalized to more general valuation function. Secondly, in our setting, a buyer with i.i.d private type arrives at each time round, and leaves the market no matter what the purchase decision is. However, in practice, buyers may strategize their purchase time for a more favorable price . How to model the advertising effect with strategic buyers and achieve efficient demand learning is another interesting future direction.