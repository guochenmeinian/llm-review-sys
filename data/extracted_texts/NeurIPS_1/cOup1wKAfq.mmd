# Unleashing the Autoconversion Rates Forecasting:

Evidential Regression from Satellite Data

Maria Carolina Novitasari\({}^{1}\)

maria.novitasari.20@ucl.ac.uk

Johannes Quaas\({}^{2,3}\)

johannes.quaas@uni-leipzig.de

Miguel R. D. Rodrigues\({}^{1}\)

m.rodrigues@ucl.ac.uk

\({}^{1}\)Department of Electronic and Electrical Engineering, University College London

\({}^{2}\)Leipzig Institute for Meteorology, Universitat Leipzig

\({}^{3}\)ScaDS.AI - Center for Scalable Data Analytics and AI, Universitat Leipzig

###### Abstract

High-resolution simulations such as the ICosahedral Non-hydrostatic Large-Eddy Model (ICON-LEM) can be used to understand the interactions between aerosols, clouds, and precipitation processes that currently represent the largest source of uncertainty involved in determining the radiative forcing of climate change. Nevertheless, due to the exceptionally high computing cost required, this simulation-based approach can only be employed for a short period of time within a limited area. Despite the fact that machine learning can mitigate this problem, the related model uncertainties may make it less reliable. To address this, we developed a neural network (NN) model powered with evidential learning to assess the data and model uncertainties applied to satellite observation data. Our study focuses on estimating the rate at which small droplets (cloud droplets) collide and coalesce to become larger droplets (raindrops) - autoconversion rates - since this is one of the key processes in the precipitation formation of liquid clouds, hence crucial to better understanding cloud responses to anthropogenic aerosols. The results of estimating the autoconversion rates demonstrate that the model performs reasonably well, with the inclusion of both aleatoric and epistemic uncertainty estimation, which improves the credibility of the model and provides useful insights for future improvement.

## 1 Introduction

Future climate projections demand a deeper understanding of interactions between aerosols and clouds since they constitute the biggest uncertainty in estimating the radiative forcing of climate change . One way to reduce such uncertainties is to understand the interaction between aerosols, clouds, and precipitation processes. One of the high-resolution simulations that can be used to study these interactions is the ICON-LEM . Nevertheless, due to the exceptionally high computing cost required, it can only be employed for a limited period and geographical area.

While machine learning has the potential to address the challenges mentioned, it is important to note that predictions made by these models may be affected by noise and model inference error . The degree of uncertainty in a model depends on the machine learning algorithm and the availability of data. These model uncertainties might be more pronounced for climate forecasts, raising concerns about the model's reliability.

The aforementioned issues are addressed in this study by employing deep evidential regression [Amini et al., 2020, Meinert et al., 2023] and the massive collection of satellite data, providing long-term global spatial coverage up to several decades. We focus in particular on autoconversion rates estimation since this is one of the key processes in the precipitation formation of liquid clouds, hence crucial to better understanding cloud responses to anthropogenic aerosols and, ultimately, climate change.

Our current work represents a continuation and enhancement of our previous research efforts. Our previous work [Novitasari et al., 2021] also considered the prediction of autoconversion rates from satellite data; however, it entailed a more complex approach involving a machine learning model with more features and higher number of trainable weights, resulting in increased computational costs compared to our work. Furthermore, our previous approach utilized a more complex simulator (COSP; Swales et al., 2018) to generate satellite-like data, while our current approach is more cost-effective and straightforward as we simply define the cloud-top information based on cloud optical thickness. Importantly, we have not quantitatively assess the inherent uncertainty in our previous findings. This work offers a computationally effective solution by employing the fewest features necessary and minimizing trainable weights while still obtaining accurate predictions of autoconversion rates. Additionally, deep evidential learning evaluates data and model uncertainties without the need for additional training or inference.

## 2 Proposed Approach

We present a novel approach for direct autoconversion rate extraction from satellite observation, which includes the estimation of data and model uncertainties. The general framework, as illustrated in Figure 1, involves climate science-based steps for generating training and testing datasets, along with a machine learning framework incorporating uncertainty quantification methods, as elaborated in the following section.

DatasetsWe use datasets from ICON-LEM output over Germany on 2 May 2013, where distinct cloud regimes occurred, allowing for the investigation of quite different elements of cloud formation and evolution [Heinze et al., 2017]. We study a time period of 09:55 UTC to 13:20 UTC. Our focus is on ICON-LEM with a 156 m resolution on the native ICON grid, then regridded to a regular 1 km resolution to match the resolution of MODIS. The autoconversion rates in our training and testing data were derived using the two-moment microphysical parameterization of Seifert and Beheng (2006). The autoconversion rates for cloud tops that simulate satellite data were determined by selecting rates where the cloud optical thickness (COT), calculated from top to bottom, exceeds 1. The optical thickness represents the extent to which optical satellite sensors can retrieve cloud microphysical information.

We use dataset of ICON numerical weather prediction (ICON-NWP) Holuhraun which were performed over Holuhraun volcano for a week from 1 to 7 September 2014 to further test the performance of our machine learning models [Kolzenburg et al., 2017, Haghighatanasab et al., 2022]. The dataset has a horizontal resolution of approximately 2.5 km. As for the satellite observation data displayed

Figure 1: General framework.

on the right side of Figure 1, we use cloud product level-2 of Terra and Aqua MODIS (Platnick et al., 2017, 2018).

Uncertainty Quantification MethodsTo capture the uncertainty associated with the predicted autoconversion rates, we employ the evidential regression framework proposed by Amini et al. (2020). However, we incorporate the modified version proposed by Meinert et al. (2023) because the regularizer formulation proposed by Amini et al. (2020) is insufficient for finding the marginal likelihood parameters.

Amini et al. (2020) approach the regression problem by representing it as a normal distribution with an unknown mean and variance, \(N(,^{2})\). They adopt a normal prior distribution for the mean, with \(\) following \(N(,^{2}^{-1})\), and an inverse Gamma prior distribution for the variance, with \(^{2}\) following \(^{-1}(,)\). As a result, they obtain a combined prior distribution known as Normal Inverse-Gamma, characterized by the parameters \(,,,\) and \(\).

Given a set of \((x_{i},y_{i})\) pairs, the overall loss function \(_{i}(w)\) for the NN, as defined by Amini et al.(2020), where \(w\) represents a set of weights, is formulated as: \(_{i}(w)=_{i}^{}(w)+_{i}^{ }(w)\), where \(_{i}^{}\) represents the negative log-likelihood to maximize the model fit, defined as:

\[_{i}^{}(w)=()- +(+)((y_{i}-)^{2} +)+()}) \]

where \(=2(1+)\). \(_{i}^{}\) denotes the regularization term, which is scaled by a regularization coefficient, \(\). Choosing a low value for \(\) could lead to overconfidence, whereas opting for a high value might result in excessive uncertainty. However, instead of utilizing the L1 error, we employ an adjustment to the residuals by incorporating the width of the student-t distribution (\(w_{St}\)), as recommended by Meinert et al. (2023).

Consequently, the regularization term can be expressed as:

\[_{i}^{}(w)=|-}{w_{St}}|^{p} \]

where \(w_{St}\) is computed as \(}\). \(w_{St}\) is also employed for evaluating the aleatoric uncertainty. Conversely, the epistemic uncertainty is defined as \(}\). The total evidence, denoted as \(\), is defined as \(+2\)(Meinert et al., 2023). Additionally, the parameter \(p\) serves as an additional hyperparameter, determining the magnitude of residual impact within regularization.

Machine Learning ModelsIn this study, we trained our machine learning models using ICON-LEM output as input. The input to our machine learning model is the cloud effective radius as this is one of the crucial parameters of the cloud microphysical state that is typically obtained from satellite retrievals (Platnick et al., 2017; Grosvenor et al., 2018). The machine learning model output, serving as groundtruth, is the autoconversion rates derived from ICON-LEM. The preprocessing step is detailed in Appendix A.

We then trained and tested a deep evidential regression (Amini et al., 2020; Meinert et al., 2023) model with an evidential regularizer coefficients, \(\), set to 1e-6, chosen for optimal calibration (details in Appendix C). Additionally, following Meinert et al. (2023), the hyperparameter \(p\) was chosen with the value of 2. The shallow NN is trained to infer the hyperparameters of the evidential distribution by applying evidential priors over the original Gaussian likelihood function.

In the early stages of our testing process, we compared our models' performance against simulation data. We then proceed to calculate the data (aleatoric) and model (epistemic) uncertainties, rigorously evaluating their calibration through the implementation of the spread-skill plot (Wilks, 2011; Haynes et al., 2023) and discard test (Barnes and Barnes, 2021; Haynes et al., 2023) methods. Finally, we employ our shallow NN model to make direct predictions of the autoconversion rates from satellite data, including the estimation of its data and model uncertainties.

We selected a shallow NN model for its superior performance compared to other machine learning models as shown in Appendix B. Despite the fact that DNN model produced the best outcome in our scenario (see Appendix B), we deem the NN model to be superior due to its ability to produce comparable outcomes with significantly fewer trainable weights. Additionally, the use of NNs (including DNN) can be coupled with evidential learning to enable estimation of aleatoric and epistemic uncertainties without additional training.

## 3 Experimental Results

Autoconversion on Simulation Data (ICON)This stage involves testing our shallow NN model in 3 scenarios with different datasets: (1) ICON-LEM Germany (different times), (2) Cloud-top ICON-LEM Germany (satellite-like data), and (3) Cloud-top ICON-NWP Holuhraun (different data, time, location, and resolution), details in Appendix E.1. All findings, displayed in Table 1, exhibit strong performance with SSIM around 90%. This confirms our approach's ability to accurately estimate autoconversion rates using simulation data. Visual representations are available in Appendix E.2. The details of the model architecture and additional experimental results with a different NN (DNN) architecture from our previous work  are also available in Appendix D.

Autoconversion on Satellite Observation (MODIS)This stage involves testing our models on satellite data, MODIS Aqua over Germany (latitude: 47.50\({}^{}\) to 54.50\({}^{}\) N, longitude: 5.87\({}^{}\) to 10.00\({}^{}\) E) on 2 May 2013 at 13:20 local time. Even though satellite predictions cannot be directly compared with simulation results - due to the fact that the ICON-LEM simulation does not put clouds in their exact right places - the autoconversion rates obtained from the simulation output and the predicted autoconversion rates from satellite data demonstrated statistical concordance, as shown in Figure 2. The mean, standard deviation, median, 25th and 75th percentiles of the autoconversion rates of the cloud-top ICON-LEM Germany compared to MODIS are relatively close. Additional results in Appendix E.3. This implies that our approach is capable of estimating autoconversion rates directly from satellite data.

Evaluation of Uncertainty EstimationThe total uncertainty (aleatoric and epistemic) performance of the deep evidential regression on simulation data was evaluated using the spread-skill plot and discard test. Results showed that the deep evidential regression with a coefficient \(\) of 1e-6 was well-calibrated, as depicted in Figure 3. This is demonstrated by spread skill plots that are very close to the ideal line and discard test that decrease monotonically from left to right.

   Data & R\({}^{2}\) & MAPE & RMSPE & SSIM & PSNR \\  (a) ICON-LEM Germany & 90.54\% & 9.14\% & 11.27\% & 90.11\% & 26.30 \\ (b) Cloud-top ICON-LEM Germany & 89.88\% & 10.86\% & 13.89\% & 89.96\% & 25.89 \\ (c) Cloud-top ICON-NWP Holuhraun & 84.39\% & 8.56\% & 10.73\% & 91.50\% & 25.81 \\   

Table 1: Evaluation of autoconversion rates prediction results on simulation data (ICON) using NN Evidential model.

Figure 2: Mean, standard deviation (Std), median, and percentiles (p25, p75) of cloud-top ICON-LEM and MODIS variables over Germany: cloud effective radius (CER) and autoconversion rates (Aut).

Uncertainty Estimation on Satellite-like and Satellite DataFigures 4 displays the visualization of aleatoric and epistemic uncertainties on satellite-like data, over Germany (see Appendix E.4 for satellite data over Germany, as well as satellite-like and satellite data over Holuhraun). The plots reveal a wider range of aleatoric uncertainty compared to epistemic uncertainty. This observation aligns with the fact that a single independent variable can correspond to multiple ranges of dependent variables, as shown in Figure 4.

## 4 Conclusion

In this study, we provide a computationally efficient solution to unravel the key process of precipitation formation for liquid clouds, the autoconversion process, from satellite data by employing the fewest attributes necessary while still obtaining meaningful results. A thorough investigation, with details provided in the appendix, is also included. Furthermore, we employ evidential learning to estimate data and model uncertainties, eliminating the need for additional training or inference, hence reducing the overall costs. It has demonstrated good calibration, enhancing the model's credibility, and providing valuable insights for future improvements. Our findings show that data uncertainty contributes the most to the overall uncertainty, hence modifying the model architecture is unlikely to improve outcomes significantly. Instead, it would be more effective to prioritize enhancing data quality or incorporating an additional crucial feature, such as COT per layer. Unfortunately, satellite data lacks this information, but future efforts will focus on estimating this feature to enhance autoconversion rates estimation and reduce uncertainty.