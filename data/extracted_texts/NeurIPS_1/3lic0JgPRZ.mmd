# Learning to Decouple the Lights for 3D Face Texture Modeling

Tianxin Huang\({}^{1}\) Zhenyu Zhang\({}^{2}\) Ying Tai\({}^{2}\) Gim Hee Lee\({}^{1}\)

\({}^{1}\)School of Computing, National University of Singapore

\({}^{2}\)Nanjing University

huangtx@nus.edu.sg, gimhee.lee@nus.edu.sg

###### Abstract

Existing research has made impressive strides in reconstructing human facial shapes and textures from images with well-illuminated faces and minimal external occlusions. Nevertheless, it remains challenging to recover accurate facial textures from scenarios with complicated illumination affected by external occlusions, e.g. a face that is partially obscured by items such as a hat. Existing works based on the assumption of single and uniform illumination cannot correctly process these data. In this work, we introduce a novel approach to model 3D facial textures under such unnatural illumination. Instead of assuming single illumination, our framework learns to imitate the unnatural illumination as a composition of multiple separate light conditions combined with learned neural representations, named Light Decoupling. According to experiments on both single images and video sequences, we demonstrate the effectiveness of our approach in modeling facial textures under challenging illumination affected by occlusions. Our codes would be open sourced at [https://github.com/Tianxinhuang/DeFace.git](https://github.com/Tianxinhuang/DeFace.git).

## 1 Introduction

Recently, 3D face reconstruction has made significant progress  with the rapid development of digital human and meta-universe technologies. These techniques have become increasingly proficient in recovering details of face shapes and textures from single images or video sequences. Their performances have been particularly commendable on well-illuminated faces.

Despite the advancements, the real world presents more complex scenarios. As shown in the blue and red rectangled regions of input images in Fig. 1, self occlusions from facial parts such as the nose, or external occlusions such as hats or hairs introduce illumination changes and produce shadows in certain regions. Although recent works  replace the linear models  with non-linear GAN-inversion-based textured models to greatly enhance the quality of textures and complete occluded facial areas, they still rely on the assumption that the environment illumination is single and uniform. As the illumination affected by self and external occlusions is unnatural, it may deviate drastically from the single and uniform illumination assumption, which would bring unexpected influence to the textures modelled with existing methods.

As shown in Fig. 1-a, methods  based on the diffuse-only texture and mesh render  bake both shadows caused by self occlusion of the nose and external occlusion of the hat onto the texture, where the re-rendered output also appears unrealistic and lacks authenticity. Recent works proposed by Dib _et al._ combine local reflectance texture model incorporating diffuse, specular, and roughness albedos with ray-tracing render  to implicitly model influence of the self occlusion. As shown in Fig. 1-b, these methods can create more realistic rendered output and avoid the shadows of self occlusion on the recovered texture in the blue rectangle, while the influence from external occlusion in the red rectangle remains unresolved.

To mitigate the above-mentioned issues, we propose a face texture modeling framework for faces under complicated and unnatural illumination affected by external occlusions. Given the limited physical information about external occlusions presented in a single facial image or video sequence, accurately modeling how occlusion impacts illumination becomes nearly unattainable. Regarding this challenge, we propose to use _multiple separate light conditions_ to imitate the local illumination of different facial areas after being affected by external occlusions. As shown in Fig. 1-c, our method can model the influence from external occlusion as one of the light conditions and eliminate its effect on the recovered texture as highlighted in the red rectangle, where the rendered output is also more realistic and closer to the input image especially on the forehead and eyes. Specifically, we use a spatial-temporal neural representation to predict masks for different light conditions, which are used to combine rendered results under multiple light conditions into final output. The number of light masks is adaptively adjusted during optimization. As external occlusions may directly cover parts of the face, we also introduce another neural representation to provide a continuous prediction for the available face region. Furthermore, our approach incorporates realistic constraints by introducing priors from the statistical model and pre-trained face perceptual models to ensure our extracted textures construct lifelike human faces.

Our contribution in this work can be summarized as:

* We present a new face texture modeling framework by learning to decouple the environmental illumination into multiple light conditions with neural representations;
* We propose realistic constraints to help improve the authenticity of texture by introducing human face priors;
* Extensive experiments on images and videos confirm that our method delivers more realistic renderings and improved facial textures compared to existing approaches under challenging illumination affected by occlusions.

## 2 Related Works

### 3D Morphable Model

The 3D Morphable Model (3DMM) [4; 15; 32; 6] is a widely employed linear statistical framework used for modeling the geometry and texture of faces. It is constructed based on aligned face images

Figure 1: Blue and red rectangles mark regions affected by self and external occlusions, respectively. (a) Texture modeling with diffuse-only texture map. (b) Texture modeling based on diffuse, specular, and roughness albedos from local reflectance model , while optimizing with ray-tracing render. (c) Our method learns neural representations to decouple the original illumination into multiple light conditions, where the influence from external occlusions can be modeled as one of the conditions. White and black regions in the masks denote 1 and 0, respectively.

using Principal Component Analysis (PCA). Within the 3DMM framework, the coordinates and colors of facial mesh vertices are computed through a linear combination of numerical parameters. These parameters can be estimated to enable face reconstruction through optimization-based fitting [4; 6] or learning-based approaches [10; 30; 43; 42], with the goal of minimizing the disparities between the rendered and original face images. Traditional 3DMMs, although effective, are limited by their linear PCA basis. Recent advancements [16; 21; 23; 44] have introduced non-linear basis by incorporating pre-trained mesh or texture decoder networks. In these methods, latent codes for these decoders are optimized to align with the original face images. This approach significantly enhances the robustness of the model when faced with issues such as occlusions and missing textures. However, such methods demand access to large, well-preprocessed datasets for effective pre-training.

### Face Texture and Illumination Modeling

Texture and illumination modeling plays a pivotal role in 3D face reconstruction, directly impacting the color rendering in generated images. Accurate modeling for 3D face textures and environmental illumination is vital for subsequent applications such as face relighting [36; 18; 31] or animation [38; 30]. To achieve high-resolution rendering, recent approaches [9; 21; 16; 3] usually opt for UV mapping to model facial texture, as opposed to the earlier methods that focused on vertex colors . The UV map can either be initialized with a PCA basis  or estimated through the use of a pre-trained non-linear texture decoder [22; 2; 16]. There are two commonly used models to estimate human skin reflectance for the texture modeling framework: the Lambertian model  and the Blinn-Phong model . The Lambertian model is more computationally efficient, while the Blinn-Phong model produces more realistic rendering results by accounting for specular attributes in textures.

As capturing environmental illumination directly can be challenging, most existing methods assume it as primarily uniform Spherical Harmonics [33; 34]. This approach, however, tends to "bake" shadows cast by facial characters or external occlusions into the textures. Although method  introduce implicit texture modeling to achieve better face rendering performances, it requires multi-view images under uniform illumination for optimization, which is not appropriate for face images affected by occlusions. 2D shadow removal methods [41; 17; 28] try to eliminate the influence of shadows directly with networks. These methods have higher inference efficiency, while the size of their training set may greatly affect their performances. Notably, Dib _et al._[12; 13; 11] have introduced techniques that implicitly model self-shadows through ray-tracing, demonstrating exceptional performance on faces with severe self occlusions. Despite these advancements, existing methods usually encounter challenges in handling shadows caused by external occlusions such as hats or hair, tending to take the shadows as part of textures.

To address these issues, we propose a novel framework to recover clear textures under challenging illumination affected by external occlusions. Our approach achieves this by decoupling the unnatural affected illumination into multiple light conditions using learned neural representations.

## 3 Our Methodology

### Problem Definition

This work focus on the texture modeling problem of human faces under challenging environment illumination affected by external occlusions. Given an input image or video sequences \(I_{in}\) taken from affected illuminations, our task is to recover clear and accurate texture \(T\) from \(I_{in}\) and ensure that \(T\) can synthesize results \(I_{out}\) close to \(I_{in}\).

### Overall Illustration

As illustrated in Fig. 2, instead of making the assumption that the face is exposed to a single and uniform illumination, we propose to model \(n\) possible separate light conditions \(_{1}_{n}\) in the environment, where the masks for possible regions \(M_{N}\) are predicted with a neural representation \(f()\). Effective masks \(M_{L}\) and rendered faces \(I_{Rs}\) are selected from original \(M_{N}\) and rendered \(I_{Rn}\) during optimization with the Adaptive Condition Estimation (ACE) strategy. The final rendered face under multiple light conditions is \(I_{R}= I_{Rs} M_{L}\), which is merged with the input images to construct the output \(I_{out}=I_{R} M_{o}+I_{in}(1-M_{o})\). The face shape is modeled with statistical coefficients \(\), \(\), and \(p\). Following , they are mainly optimized with landmark loss:

\[L_{lan}=|}\|q_{out}-q_{in}\|_{2}, \]

where \(q_{in}\) is 2D key points detected from \(I_{in}\). \(|q_{in}|\) is the number of points in \(q_{in}\). \(q_{out}\) denotes projected 3D key points on 2D plane. The color-related variables such as textures and lights are mainly optimized with photometric loss:

\[L_{pho}=|}\|I_{out}-I_{in}\|, \]

where \(|I_{in}|\) is defined as the number of pixels of input image \(I_{in}\). More details are presented below.

### Light Decoupling

Light Condition Initialization.Following [12; 13] using \(B=9\) bands Spherical Harmonics (SH) and ray-tracing rendering to model the illumination under self occlusions, we use \(n\) separate SH to model \(n\) possible light conditions. The coefficients are then simply initialized as \(_{i}=2I-1\) for \(_{i}=\{_{1},..,_{n}\}\), where \(I\) is a all-one matrix with the same shape as the SH coefficient. Please note that we use each SH to imitate the local illumination after being affected by the external occlusion, instead of the global natural illumination. This means that we do not need to consider physical influence of occlusion in each SH. Instead, we optimize each SH independently to directly imitate the illumination in different face regions.

Neural Representations for Face Segment.To decouple the illumination into multiple light conditions, we design a pair of spatial-temporal continuous neural representations to segment the face into regions for different light conditions. As illustrated in Fig. 2, spatial positions \(x,y\) and temporal position \(t\) of pixels are normalized and embedded into a coordinates system. \(t\) is decided by the number of frames in the input image/video sequence. For the single image reconstruction, \(t\) is set as a constant 0, where it would be \(i/k\) for the \(i_{th}\) frame of a \(k\) frames video sequences. For the convenience of learning, \((x,y)\) are normalized into \([-1.0,1.0]\) and \(t\) is normalized into \([0.0,1.0]\).

Figure 2: Illustration of our framework. The pipeline is proposed to recover texture \(T\) and 3DMM statistical coefficients \(,,,p,\) from the input image \(I_{in}\). The statistical coefficient \(\) is used to initialized \(T\). Render mask \(M_{R}\) and Faces \(I_{Rn}\) under \(n\) light conditions \(=\{_{1}_{n}\}\) are acquired through ray-tracing rendering. \(f()\) and \(g()\) are neural representations predicting light masks \(M_{N}\) and facial region mask \(M_{o}\). ACE is introduced to select effective masks \(M_{L}\) and rendered faces \(I_{Rs}\). \(I_{Rs}\) are combined into \(I_{R}\) with \(M_{L}\), where \(I_{R}\) is merged with surroundings in \(I_{in}\) with \(M_{o}\) to construct output image \(I_{out}\). \(L_{pho}\) and \(L_{lan}\) are photometric loss and landmark loss, respectively.

A Multi-Layer Perceptron (MLP) \(f()\) is then introduced to predict the probability of assignment to each light condition. Given the render mask \(M_{R}\) in the ray-tracing-assisted rendering, the light masks can be obtained as \(M_{N}=M_{R} f(x,y,t)\). Effective masks \(M_{L}\) are selected from \(M_{N}\) with Adaptive Condition Estimation (ACE) to provide the final segment for different light conditions.

Similarly, we use another MLP \(g()\) to predict the probability that each pixel belongs to the face regions to avoid the influence from direct occlusion such as hat or hair. The Face mask is thus given by: \(M_{o}=M_{R} g(x,y,t)\). A pre-trained semantic segmentation network  is introduced for distillation to \(g()\), while the probability for labels of all face components such as eyes, mouth, or nose are added together to construct a classifier \(h()\) to predict the association of a pixel at \(x,y,t\) to the face. The distillation loss \(L_{seg}\) can be simply defined as:

\[L_{seg}=|}\|g(x,y,t)-h(x,y,t)\|_{2}. \]

Note that \(g()\) is co-optimized together with the \(L_{pho}\) and \(L_{seg}\) to further distinguish some occlusions hard to be fitted with the 3DMM statistical model.

Adaptive Condition Estimation (ACE).As the complexity of illumination is mutative in different surroundings, we design a strategy to estimate the number of light conditions existing in this environment during optimization. Specifically, light masks with larger area than a pre-defined threshold \(\) in \(M_{N}\) are preserved in \(M_{L}\), while smaller ones are dropped with corresponding light conditions and not further optimized in later iterations. Given the number of light masks \(M_{N}\) same as light condition \(n\), then \(M_{N}=\{M_{N}^{i}\}_{i=1}^{n_{L}}\), \(M_{L}=\{M_{L}^{i}\}_{i=1}^{n_{L}}=\{M_{N}^{i}||}_{m M_{ N}^{i}}m>,i<=n\}\). \(n_{L}<=n\) is the number of preserved light conditions. \(n\) denotes the pixel in \(M_{N}^{i}\). We introduce an regularization \(L_{area}\) to to encourage the area concentration on fewer masks:

\[L_{area}=|}_{i=1}^{n}e^{-\|M_{N}^{i}-^{n}M_{N}^{i}}{n}\|_{2}}-1, \]

where \(|I_{in}|\) is the number of pixels in the mask.

To ensure each light condition is mainly contained in one mask of \(M_{L}\), we introduce a binary regularization \(L_{bin}\) to ensure that the predicted probability for each light condition tends to 0 or 1:

\[L_{bin}=|}}_{i=1}^{n_{L}}e^{-\|M_{L}^{i} -^{i}}m}{|I_{in}|}\|_{2}}-1, \]

where \(m M_{L}^{i}\) denotes each pixel value in \(i\)th light mask \(M_{L}\). \(n_{L}\) is the number of masks in \(M_{L}\).

Note that \(L_{area}\) is different from \(L_{bin}\) as it pushes the mask values \(M_{N}^{i}\) far from the mean of all masks, while \(L_{bin}\) pushes mask values away from mean of different positions in the same mask \(M_{L}^{i}\). ACE is executed at a specific iteration \(iter_{0}\) to select \(M_{L}\) from \(M_{N}\). We use \(L_{area}\) to encourage area concentration before \(iter_{0}\), while using \(L_{bin}\) to push the mask to 0 or 1 after \(iter_{0}\).

### Realistic Constraints

To ensure the reconstructed texture is reasonable and lifelike, we propose global prior constraint \(L_{GP}\), local prior constraint \(L_{LP}\), and human prior constraint \(L_{HP}\) by introducing both priors from 3DMM statistical model and the pre-trained perceptual model.

Global Prior Constraint.The global prior constraint is used to ensure the consistency of overall hue between optimized texture \(T\) and initialized texture \(T^{0}\) from the 3DMM statistical model calculated with \(\). As the colors mainly come from diffuse albedo in \(T\), we estimate the overall hue of \(T^{0}\) with a K-means algorithm on its diffuse albedo \(T^{0}_{D}\) and get a \(4 4\) color matrices \(C\). Given the diffuse albedo of Texture \(T\) as \(T_{D}\), this term is given by:

\[L_{GP}=|}_{c C}\|T_{D}-c\|_{2}. \]

Local Prior Constraint.The local prior constraint is used to ensure the local smoothness of optimized texture \(T\) by constraining its local variation to be similar to \(T^{0}\). Let us define the diffuse, specular, and roughness albedos of texture \(T\) as \(T_{D}\), \(T_{S}\), \(T_{R}\), respectively. We set the local variationsof \(T_{D}\), \(T_{S}\), \(T_{R}\) as \(N_{D}\), \(N_{S}\), \(N_{R}\), which are computed with the \(5 5\) neighbors around each pixel, \(N_{D}=T_{D}-(T_{D})\). \(N_{D}^{0}\), \(N_{S}^{0}\), \(N_{R}^{0}\) are local variations calculated from \(T^{0}\). The local prior constraint \(L_{LP}\) is then defined as:

\[L_{LP}=|}(\|N_{D}-N_{D}^{0}\|+\|N_{S}-N_{S}^{0}\|+\|N_{R}-N_{R} ^{0}\|). \]

Human Prior Constraint.Human prior constraint is introduced to enhance the optimization of texture \(T\) in Stage 3 with a face recognition network FaceNet  pre-trained on large dataset such as VGGFace2  or Casia-Webface . The recognition model pre-trained on VGGFace2 and Casia-webface tends to classify the input images to 8,631 and 10,575 identities with different genders, ethnicity, _etc_. In this work, we propose a human prior constraint by maximizing the probability that the rendered face is recognized on one of the identities by FaceNet. Defining the FaceNet as \(f_{r}()\), the human prior constraint can then be written as:

\[L_{HP}=_{s f_{r}(I_{Rs})}\|1-s\|_{2}. \]

\(I_{Rs}\) are rendered under multiple light conditions. \(L_{HP}\) constrains the textures to be more reasonable.

### Training Pipeline

The pipeline of the entire training process of our proposed framework is presented in Alg. 1. As illustrated in Fig. 2, the training of our proposed method consists of 3 stages, which is similar to NextFace . In Stage 1, the expression \(\), shape \(\), and pose \(p\) coefficients are optimized to construct the basic face shape. In Stage 2, all coefficients, and the neural representations \(f()\) and \(g()\) are optimized together to reconstruct the face with statistical model. In Stage 3, the texture \(T\) is directly optimized without coefficient \(\), while \(\) and \(f()\) are optimized with small learning rates. \(_{0}_{7}\) are pre-defined weights. We use Adam optimizer  for optimization.

## 4 Experiments

### Dataset and Implementation Details

We follow NextFace  for the ray-tracing rendering and multi-stage organization of optimization pipeline. Detailed hyper-parameter settings can be found in our supplementary. For our experiments, we utilize two datasets: Voxceleb2  and CelebAMask-HQ [29; 24]. VoxCeleb2  is a diverse dataset encompassing numerous videos collected from interviews, movies and videos, where the same person may have multiple separate videos. CelebAMask-HQ [29; 24] is a large scale face image dataset with fine attributes annotation and high resolution, widely used in face editing and generation.

Evaluation.We construct a collection of evaluation data with challenging illumination affected by external occlusions for comparative analysis. This collection includes 38 pairs of single images, 24 pairs of videos from Voxceleb2  with \(256 256\) resolution, and 62 single images from CelebAMask-HQ  with \(512 512\) resolution. Each pair consists of source images affected by external occlusions and target images without occlusion, both from the same person, where each video is sampled to 8 frames for sequence-based comparisons.

To quantitatively assess the quality of recovered textures, face textures extracted from the occluded source images are leveraged to synthesize the unoccluded target images. Specifically, we optimize source and target images separately following Sec. 3. Then, keeping the face shape, pose, and illumination invariant, we replace the target image's texture with the source's and re-render it to the synthetic result. This allows us to measure texture quality by quantifying the differences between the synthesized target images and the original target images. We also introduce differences between original and reconstructed source images within facial regions acquired by face parsing  as an assistant metric to see if textures restore source images well.

Our quantitative comparison employs three metrics: PSNR, SSIM, and perceptual error LPIPS  of AlexNet . State-of-the-art methods D3DFR , CPEM , NextFace , and RGB Fitting methods proposed in FFHQ-UV  are introduced for comparison. For D3DFR, we adopt its enhanced PyTorch version. As NextFace  does not distinguish the face and external occlusion when optimizing the texture, we introduce **NextFace*** in subsequent comparison by adding face parsing  to select the face region during optimization.

Figure 3: Comparison on Voxceleb2 images. The diffuse albedo is visualized as the texture because it contains most of the color information. Textures from source images are used to synthesize the target images. NextFace* denotes results optimized within regions selected with face parsing . We do not have textures for CPEM  or D3DFR  as they predict vertex colors instead of uv textures.

### Evaluation on Voxceleb2

Evaluation on Single Images.We conduct an evaluation about the performance of our method in collected single images sourced from the Voxceleb2 dataset . As shown in Fig. 3, our approach demonstrates a marked improvement in recovering clearer textures from the original images taken under challenging illumination affected by external occlusions. Our method also surprisingly recovers clear textures under strong colorful lights, which may benefit from the realistic constraints to keep textures reasonable. In contrast, existing methods tend to incorporate these occlusions, shadows, or colorful lights directly into the texture, resulting in less satisfactory outcomes.

Furthermore, our methods achieves superior results on the synthesis of target images and comparable performances on the reconstruction of source images as shown in Table 1. It confirms our method consistently recovers both accurate and clear textures. Although NextFace  performs a little better on PSNR and SSIM of source images, it performs the worst on synthetic target images as it actually severely over-fits source images. As shown in Fig. 3, it bakes shadows and occlusions to the textures, which confirms it is not appropriate for faces affected by external occlusions.

Evaluation on Video Sequences.We conduct an evaluation on video sequences collected from Voxceleb2 dataset  to further substantiate the efficacy of our approach. To adapt our framework

    &  & NextFace & NextFace* & FPHQ-UV & Ours \\  PSNR \(\) & 27.69 & 24.55 & 30.60 & 30.65 & 29.70 & **30.67** \\ Source & SSIM \(\) & 0.87 & 0.87 & 0.92 & 0.92 & 0.92 & **0.92** \\  & LPIPS \(\) & 9.21 & 9.92 & 8.17 & 8.45 & 2.64 & **7.62** \\  & PSNR \(\) & 24.33 & 26.20 & 24.15 & 24.32 & 24.35 & **29.15** \\ Target & SSIM \(\) & 0.87 & 0.90 & 0.87 & 0.87 & 0.93 & **0.91** \\  & LPIPS \(\) & 9.58 & 8.13 & 10.27 & 9.91 & **7.06** & **6.92** \\   

Table 2: Quantitative comparison on video sequences from Voxceleb2. Source and Target denote differences evaluation on reconstructed source sequences and synthetic target sequences.

    &  & NextFace & NextFace* & FPHQ-UV & Ours \\  PSNR \(\) & 27.66 & 24.26 & **33.41** & 32.76 & 28.72 & 32.85 \\ Source & SSIM \(\) & 0.87 & 0.87 & **0.85** & 0.94 & 0.92 & 0.94 \\  & LPIPS \(\) & 10.22 & 11.25 & 2.32 & 7.88 & 8.32 & **6.40** \\  & PSNR \(\) & 24.70 & 27.23 & 23.74 & 24.21 & 25.03 & **29.22** \\ Target & SSIM \(\) & 0.87 & 0.91 & 0.85 & 0.86 & 0.94 & **0.91** \\  & LPIPS \(\) & 9.43 & 7.26 & 10.52 & 10.02 & 2.12 & **6.34** \\   

Table 1: Quantitative comparison on single images from Voxceleb2. Source and Target denote differences evaluation on reconstructed source images and synthetic target images. LPIPS is multiplied with \(10^{2}\). Underline and **bold** mark the suboptimal and optimal results, respectively.

Figure 4: Comparison results on the CelebAMask-HQ dataset. Ours and Ours+ denote our rendered results \(I_{R}\) directly overlapped onto original images, and results combined with environments: \(I_{out}=M_{o} I_{R}+(1-M_{o}) I_{in}\), respectively.

to video sequences, we share texture, illumination and shape coefficients across all frames during optimization. As D3DFR  and FFHQ-UV  do not provide support for sequences, we recurrently apply them to each single image. Quantitative comparison in Table 2 demonstrates that our method constantly performs superior to existing methods on texture modeling from continuous video sequences. Please check our Supplementary for corresponding qualitative results.

### Evaluation on CelebAMask-HQ

We extend our comparisons on CelebAMask-HQ . As this dataset lacks multiple images from the same identity, we focus on evaluating the performance based on the recovered textures and the reconstructed results of source images. The outcomes of our assessment are visually depicted in Fig. 4. We observe that our method continues to perform well in the task of recovering clear textures from challenging input. Additionally, our reconstructed results exhibit a higher degree of realism on the reconstructed results when compared to the outcomes produced by other methods.

### Evaluation on Images with Diverse Shadows 

To validate the performances of our method more sufficiently, we further evaluate our method on the single image dataset proposed by , which includes 100 images affected by manually created external shadows, as well as corresponding ground truths. The quantitative and qualitative comparisons are presented in Table 5 and Fig. 7. We can observe that our method still outperforms other methods under faces with diverse shadows.

   Metrics & NA & GP & GP+LP GP+LP+HP (ours) \\  PSNR \(\) & 27.20 & 28.81 & 28.82 & **29.22** \\ SSIM \(\) & 0.88 & 0.89 & 0.90 & **0.91** \\ LPIPS \(\) & 8.34 & 6.78 & 6.49 & **6.36** \\   

Table 3: Quantitative ablation study for proposed Losses GP, LP, and HP.

   Metrics & CPEM & D3DFR & NextFace & NextFace* & FFHQ-UV & Ours \\  PSNR \(\) & 24.75 & 23.02 & 32.10 & 31.92 & 26.93 & **32.13** \\ SSIM \(\) & 0.83 & 0.83 & 0.94 & 0.94 & 0.89 & **0.94** \\ LPIPS \(\) & 10.99 & 12.76 & **5.26** & 5.34 & 8.71 & 6.29 \\  PSNR \(\) & 23.34 & 25.02 & 21.83 & 21.93 & 24.00 & **28.97** \\ SSIM \(\) & 0.84 & 0.87 & 0.84 & 0.84 & 0.88 & **0.92** \\ LPIPS \(\) & 9.31 & 9.11 & 9.48 & 9.69 & 7.82 & **7.00** \\   

Table 5: Quantitative comparisons on images with diverse shadows.

Figure 6: Ablation study for the neural representations. NA means to remove both \(f()\) and \(g()\), while **+ Light** and **+ Occlusion** denote adding \(f()\) and \(g()\), respectively.

   Metrics & NA & GP & GP+LP GP+LP+HP (ours) \\  PSNR \(\) & 27.20 & 28.81 & 28.82 & **29.22** \\ SSIM \(\) & 0.88 & 0.89 & 0.90 & **0.91** \\ LPIPS \(\) & 8.34 & 6.78 & 6.49 & **6.36** \\   

Table 3: Quantitative ablation study for proposed Losses GP, LP, and HP.

### Ablation Study

Ablation Study on Losses.In this section, we analyze the impact of the proposed losses: \(L_{GP}\), \(L_{LP}\), and \(L_{HP}\) by comparing the rendered results under relative brighter light conditions. As illustrated in Fig. 5, it becomes evident that the inclusion of the \(L_{GP}\) loss plays a significant role in eliminating the abnormal colors on the texture, where \(L_{LP}\) loss effectively remove large artifacts obviously different from human faces. \(L_{HP}\) can further reduce slight unreasonable defects with priors from the pre-trained recognition model . Quantitative comparisons in Table 3 also confirm that each proposed loss contributes to the final performances.

Ablation Study on Neural Representations.To ascertain the significance of the neural representations employed, we perform an analysis where we eliminate both the neural representations: \(f()\) and \(g()\) from the light decoupling pipeline. As depicted in Fig. 6, the neural representation for the decoupling of light conditions \(f()\) notably contributes in the removal of shadows artifacts from the results. Furthermore, the neural representation \(g()\) displays its efficacy in minimizing existing irregularities in the synthetic results, which achieves smoother and cleaner results. We also present corresponding quantitative comparisons in Table 4, which demonstrates that both \(f()\) and \(g()\) have obvious influence on the final performances.

## 5 Conclusion

In this paper, we present a novel framework dedicated to recover clear facial textures from images taken under challenging illumination affected by external occlusion. Our approach makes use of neural representations to decouple the original illumination into multiple separate light conditions across various facial regions. Then the affected complicated illumination can be modelled with the combination of different light conditions. Furthermore, we introduce well-established human face priors through the realistic constraints to enhance the realism of our results. According to experiments on single images and video sequences, our method consistently surpasses existing techniques to recover clearer and more accurate textures from faces under affected unnatural illumination.