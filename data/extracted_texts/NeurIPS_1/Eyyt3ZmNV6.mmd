# ZeroMark: Towards Dataset Ownership Verification without Disclosing Watermarks

Junfeng Guo\({}^{1,}\), Yiming Li\({}^{2,}\), Ruibo Chen\({}^{1}\), Yihan Wu\({}^{1}\), Chenxi Liu\({}^{1}\), Heng Huang\({}^{1}\)

\({}^{1}\)Department of Computer Science, Institute of Health Computing

University of Maryland College Park

\({}^{2}\)College of Computing and Data Science, Nanyang Technology University

{gjf2023,ruibo,yihanwu,chenxi,heng}@umd.edu; liyiming.tech@gmail.com

The first two authors contributed equally to this work.

###### Abstract

High-quality public datasets significantly prompt the prosperity of deep neural networks (DNNs). Currently, dataset ownership verification (DOV), which consists of dataset watermarking and ownership verification, is the only feasible solution to protect their copyright by preventing unauthorized use. In this paper, we revisit existing DOV methods and find that they all mainly focused on the first stage by designing different types of dataset watermarks and directly exploiting watermarked samples as the verification samples for ownership verification. As such, their success relies on an underlying assumption that verification is a _one-time_ and _privacy-preserving_ process, which does not necessarily hold in practice. To alleviate this problem, we propose _ZeroMark_ to conduct ownership verification without disclosing dataset-specified watermarks. Our method is inspired by our empirical and theoretical findings of the intrinsic property of DNNs trained on the watermarked dataset. Specifically, ZeroMark first generates the closest boundary version of given benign samples and calculates their boundary gradients under the label-only black-box setting. After that, it examines whether the given suspicious method has been trained on the protected dataset by performing a hypothesis test, based on the cosine similarity measured on the boundary gradients and the watermark pattern. Extensive experiments on benchmark datasets verify the effectiveness of our ZeroMark and its resistance to potential adaptive attacks. The codes for reproducing our main experiments are publicly available at GitHub.

## 1 Introduction

Deep neural networks (DNNs) have demonstrated their strong ability in widespread applications, such as face recognition . Currently, there are many (high-quality) public datasets, such as CIFAR  and ImageNet , that can be easily downloaded and used. Arguably, their availability is one of the key factors in the prosperity of DNNs, as developers can evaluate and improve their models upon them. In particular, these datasets are usually only freely available for non-commercial use since their collection and annotation are time-consuming and even expensive.

To the best of our knowledge, dataset ownership verification (DOV)  is currently the only feasible solution for protecting the copyright of public datasets. Specifically, DOV consists of two main stages, including dataset watermarking and ownership verification. In the first stage, dataset owners will introduce some imperceptible watermarked samples to generate the released watermarked version of the original dataset, so that all models trained on it will have specific distinctive prediction behaviors on particular samples (\(i.e.\), verification samples) while having normalbehaviors on standard testing samples. In the second stage, given the API of a suspicious third-party deployed model, the dataset owners will detect whether it is trained on the protected dataset by examining its prediction behaviors on verification samples.

In this paper, we revisit existing DOV methods. We find that they all mainly focused on the first stage by designing different types of dataset watermarks, no matter whether their watermark is backdoor-based [6; 7; 8] or not [9; 11]. All of them directly exploited watermarked samples as the verification samples in their second stage. Accordingly, their success relies on an underlying assumption that verification is a _one-time_ and _privacy-preserving_ process. Otherwise, as the watermark pattern is leaked during the (first) verification process, the malicious dataset users can easily remove the watermark from the model trained on the stolen dataset or from the verification samples. However, this assumption does not necessarily hold true in practice since adversaries can always update their unauthorized models. As such, an intriguing and critical question arises: _Could we verify dataset ownership without disclosing dataset-specified watermarks to ensure a secure verification process_?

The answer to the aforementioned problem is positive. In this paper, we first delve into the intrinsic property of DNNs trained on the watermarked dataset. We empirically and theoretically demonstrate that the gradient of watermarked models calculated upon the closest samples located at the decision boundary (dubbed 'boundary gradient') has a similar direction to their corresponding watermark patterns, measured by their cosine similarity. Specifically, the distribution of cosine similarity of the watermarked model on the dataset-specified target class has significantly larger values than that of the remaining (benign) classes. In particular, samples located at the decision boundary (dubbed 'boundary samples') of watermarked DNNs contain limited information about the dataset-specified watermarks, measured by several metrics (\(e.g.\), mutual information). Motivated by these intriguing findings, we propose to conduct dataset ownership verification with closest boundary samples instead of samples containing dataset-specified watermarks (as shown in Figure 1). We call this method as ZeroMark. Specifically, our ZeroMark has three main steps. In the first step, ZeroMark generates the closest boundary version of given benign samples. The second step calculates the boundary gradients of generated closest boundary samples based on the Monte Carlo method. Both steps are conducted under the label-only black-box verification setting, where dataset owners can only query the suspicious model with verification samples via API and get its predicted labels. In the third step, ZeroMark examines whether the given suspicious method has been trained on the protected dataset via a hypothesis test, based on the distribution of cosine similarity measured between the boundary gradients and the corresponding watermark pattern.

In conclusion, our main contributions are four-fold: **(1)** We revisit existing DOV methods and reveal their underlying assumption regarding the verification phase. It does not necessarily hold, hindering the protection of dataset copyright. **(2)** We empirically and theoretically discover an intrinsic property of watermarked DNNs regarding boundary samples (\(i.e.\), those located at the decision boundary). **(3)** We propose a simple yet effective method (\(i.e.\), ZeroMark) to verify dataset ownership without disclosing dataset-specified watermarks. **(4)** We conduct experiments on benchmark datasets, verifying the effectiveness of ZeroMark and its resistance to potential adaptive methods.

## 2 Related Work

### Data Protection

**Classical Data Protection.** Data protection is a classical and significant research area, which aims to prevent unauthorized data usage or protect private data. Existing classical data protection con

Figure 1: The overview of existing dataset ownership verification (DOV) methods and our ZeroMark. In the verification phase, existing DOV approaches directly exploit watermarked samples for verification purposes. In contrast, ZeroMark queries the suspicious model with boundary samples without disclosing dataset-specified watermarks to safeguard the verification process.

sists of three main categories, including **(1)** encryption, **(2)** digital watermarking, and **(3)** privacy protection. Specifically, encryption [12; 13; 14] encrypts the sensitive data so that only authorized users with a secret key can decrypt and use it. Digital watermarking [15; 16; 17] embeds an owner-specified pattern to the protected data as the watermark to claim ownership. Privacy protection focuses on preventing the leakage of sensitive information of the data in both empirical [18; 19; 20] and certified manners [21; 22; 23]. Unfortunately, existing classical approaches can not directly protect the copyright of open-source datasets since they either hinder the dataset accessibility (\(e.g.\), encryption) or require the information of the training process of models trained on them (\(e.g.\), digital watermarking and privacy protection) that will not be disclosed by authorized dataset users.

**Dataset Ownership Verification.** Dataset ownership verification (DOV) aims to verify whether a suspicious model is trained on the protected dataset. To the best of our knowledge, this is currently the only feasible method to protect the copyright of open-source datasets. Specifically, DOV intends to introduce specific prediction behaviors (towards verification samples) in models trained on the protected dataset while preserving their performance on benign testing samples. Dataset owners can verify ownership by examining whether the suspicious model has dataset-specified distinctive behaviors. Previous DOV methods exploit either backdoor attacks [6; 7; 8; 10] or others [9; 11] to watermark the original (unprotected) benign dataset. For example, recently, backdoor-based DOV [6; 8; 7] adopted poisoned-/clean-label backdoor attacks to watermark the protected dataset. Most recently, Guo _et al_.  adopted samples from the hardly-generalized domain as watermark samples without introducing any new security vulnerability. However, all existing dataset ownership verification (DOV) approaches [6; 8; 7; 9; 10; 11] mainly focus on designing watermarks with different properties (\(e.g.\), harmless and stealthy) and directly exploit the watermarked samples for verification. The security study of their verification stage remains blank and is worth further exploration.

### Secure Machine Learning Inference

Currently, there are also a few works to safeguard the inference process of models. In the context of machine learning, secure inference is a two-party cryptographic protocol applied in the inference phase of machine learning models [24; 25; 26]. The server learns nothing about clients' input, while a client learns nothing about the server's machine learning model but can only get the results. Technically, it is implemented by having the server and client involved in a specific protocol and running the encrypted model over the encrypted input through cryptographic techniques such as homomorphic encryption  and secret sharing . However, secure inference requires both the client and server to encrypt input data and adapt the machine learning model's operations accordingly through cryptographic mechanisms [27; 28]. As such, it is infeasible to protect the verification process of DOV methods since suspicious third-party models may not support these protocols.

## 3 The Property of Models Trained on the Watermarked Dataset

### Preliminaries

**The Main Pipeline of Existing DOV Methods.** Let \(=\{(_{i},y_{i})\}_{i=1}^{N}\) denotes the original training dataset. In context of image classification task with \(K\)-classes, \(i.e.\), \(_{i}=^{C W H}\) represents the image with \(y_{i}=\{1,,K\}\) as its label. In the first stage of DOV (\(i.e.\), dataset watermarking), the dataset owner will embed watermarks to the original dataset to generate its watermarked version (\(i.e.\), \(_{w}\)). Particularly, \(_{w}=_{m}_{b}\), where \(_{m}\) represents the watermarked version of samples from a small selected subset \(_{s}\) of \(\) (\(i.e.\), \(_{s}\)) and \(_{b}\) contains remaining benign samples (\(i.e.\), \(_{b}=-_{s}\)). The \(_{m}\) is generated by the dataset-specified image generator \(G_{x}:\) and the label generator \(G_{y}:\), \(i.e.\), \(_{m}=\{(G_{x}(),G_{y}(y))|(,y)_{s}\}\). For example, \(G_{x}=(-)+\) and \(G_{y}=y_{t}\) in BadNets-based DOV [29; 6], where \(\{0,1\}^{C W H}\) is the trigger mask, \(^{C W H}\) is the trigger pattern, \(\) denotes the element-wise product, and \(y_{t}\) is the target label. In particular, \(_{m}|}{|_{w}|}\) is the _watermarking rate_. In the second phase (\(i.e.\), ownership verification), for a suspicious model \(C:\) that may be trained on \(_{w}\), the dataset owners will investigate whether it conducts unauthorized training by querying it with verification samples under the black-box setting. In general, the verification process of existing DOV is to directly uses watermarked sample \(G_{x}()\) as verification samples to examine whether \(C(G_{x}())=G_{y}(y)\). In contrast, our goal is to perform the verification process without disclosing the watermark samples \(G_{x}()\) during the inference phase of the suspicious classifier \(C\).

**Boundary Samples.** Let the logit margin of model \(f:^{K}\) on the label \(y\) is denoted by:

\[_{y}(;)=f_{y}(;)-_{y^{} y}f_{y^{ }}(;). \]

It can be observed that \(\) can be classified as \(y\) by \(f(;)\) if and only if \(_{y}(;) 0\). As such, the set for boundary samples of class \(y\) can be denoted by \((y;)=\{x:_{y}(;)=0\}\).

### Approach the Closest Boundary Sample

To obtain the boundary samples, we can easily use a gradient-free method (\(i.e.\), geometric search) to move each given sample \(\) forward the decision boundary of \(f(;)\) under the label \(y\), as follows:

\[}=+(1-)_{y},\ s.t.\ _{y}( };)=0, \]

where \(\) is a line search parameter and \(_{y}\) is a sample classified by the model \(f(;)\) as \(y\).

However, the obtained boundary sample of \(\) would be varied according to different \(_{y}\). As such, we use the _closest boundary sample_ of \(\) to study the characteristics of watermarked models.

Following the previous work , we define the closest boundary sample of \(\) (\(i.e.\), \(}^{*}\)) as:

\[}^{*}*{arg\,min}_{}}|| }-||_{p}\ s.t.\ _{y}(};)=0, \]

where \(||||_{1 p}\) is the \(_{p}\) norm.

Specifically, we can exploit the fast adaptive boundary attack (FAB)  to calculate the closest boundary sample. In particular, we adapt FAB to implement an iterative algorithm with gradient ascend using \(_{}_{y}(;)\), whose update in \((t+1)\)-th iteration is as follows:

\[}_{t+1}=_{t}_{0}+(1-_{t})\{ }_{t}+_{t}}_{y}(}_{t};)}{||_{}_{y}(}_{t};)|| }\}, \]

where \(_{t}\) is a positive step size, \(_{0}\) is an initial point such that \(_{y}(_{0};) 0\) and \(_{t}\) is chosen to ensure \(}_{t+1}\) lies in the decision boundary as Eq. (2). In practice, \(}\) is randomly selected in the validation set whose label is different from \(y\).

In general, using the closest boundary samples generated via Eq. (4) is mostly because they are closely related to the intrinsic property of watermarked DNNs, as shown in the next subsection.

### The Characteristic of Boundary Gradient of Watermarked DNNs

In this section, we will show that the gradient of closest boundary samples \(_{}_{y}(}^{*};)\) (dubbed 'boundary gradients') of watermarked DNNs is closely related to the watermark patterns. Before we present our technical details, we first define \((,_{}f(_{t}))\) as follows:

\[(,_{}f(_{t})), _{}f(_{t})>}{||||_{2}||_{}f(_{ t})||_{2}}. \]

Following previous works [32; 9], we use a model \(f(;)\) watermarked through the standard BadNets backdoor attack (\(i.e.\), \(G_{x}()=(-)+\))  as a basic example to shed light on the intriguing characteristic of watermarked DNNs.

**Theorem 1** (Property of Boundary Gradient on the Closest Boundary Sample).: _Assume that \(_{y}(}_{t};)\) is twice differentiable with a Lipschitz gradient, if \(|_{m}|\) and by updating \(}_{t}\) in Eq. (4) with step size \(_{t}=||}_{t}-_{0}||_{2} t^{q-1}\), there exists a constant \(c 0\) such that_

\[_{|_{m}|}1-(,_{}_{y_{t}}(}^{*},) )\  c(t^{*})^{q-1}, \]

_where \(q(,1)\), \(y_{t}\) is the target label (\(i.e.\), \(y_{t}=C(G_{x}())\)), \(\) is the watermark pattern (\(i.e.\), \( G_{x}(_{0})-_{0}\)), and \(t^{*}\) is the number of convergence iterations of \(}^{*}\)'s update._In general, since the right side of inequality (6) decreases with the increase of \(t^{*}\), Theorem 1 indicates that the cosine similarity between the watermark pattern \(\) and the gradient calculated on \(}_{t}\) located in the watermark region increases along with its update process. Its proof is in the appendix.

In the following parts, we empirically verify that the distribution of the cosine similarity between watermark patterns and boundary gradients of the closest boundary samples is different (\(i.e.\), has larger values) from that on their benign versions to further justify our Theorem 1.

**Settings.** We hereby exploit BadNets-based dataset watermark [29; 6] with ResNet-18  on the CIFAR-10  dataset as an example for the discussion. Specifically, we watermark a sufficient amount of samples to achieve a high watermark success rate (\(i.e.\), \( 99\%\)). The watermark pattern is a \(4 4\) square filled with random pixels, as shown in Figure 2(a). We randomly select 400 benign samples and use Eq. (4) to generate their closest boundary version for the target label \(y_{t}\) (\(i.e.\), class '0'). To reduce the randomness caused by the selection of watermark patterns, we introduce \(\) as the reference for normalization, as follows:

\[_{i=1}^{N}(_{i},_{}_{y_{t}}(}^{*},)), \]

and we calculate the normalized cosine similarity score as:

\[(,_{}_{y_ {t}}(}^{*},))(, _{}_{y_{t}}(}^{*},))- {}, \]

where \(_{i}\) is \(i\)-th random watermark pattern that is different from the original one (\(i.e.\), \(\)). We generate the gradient \(_{}_{y}(}^{*},)\) of the watermarked model on the target label (dubbed 'Grad (Target)') and benign labels (dubbed 'Grad (Benign)') others than the target one, as shown in Figure 2(b) and Figure 2(c), respectively. We then calculate their normalized cosine similarity scores with 400 samples. Since the values within the boundary gradient are sparse and not evenly distributed, we follow previous work  to select the largest 10 values within the \(\) and \(_{}_{y_{t}}(}^{*},))\) to calculate their corresponding cosine similarity score. More settings details are in the appendix.

**Results.** As shown in Figure 2(d), the normalized cosine similarity scores of the target label have significantly larger values compared with those of benign labels. However, their similarity scores still have some overlap (nearly \(74\%\) of the target label). It suggests that not all gradients calculated on the closest boundary samples can reflect the watermark pattern \(\). It is mostly caused by the deviations introduced by the gradient estimation process under the black-box setting (as in Eq. (11)).

Nevertheless, we can still distinguish between watermarked and benign models based on their similarity distributions by comparing their _maximum_ instead of random values. Specifically, suppose we define a threshold \(>0\) as the maximum cosine similarity value for benign labels, and there exists \([()>] 0.26\) for the watermark model. If we randomly sample \(m\) samples to calculate the (closest) boundary gradients and their corresponding normalized cosine similarity, we have:

\[(\{()_{1},()_{2},, ()_{m}\})=((() ))^{m}. \]

There will be at least one sample having \(()>\) with a probability of \(1-[()<]^{m}\). As such, if we sample sufficient samples (\(e.g.\), 100), we will have a large chance (\( 99\%\)) to find at least one boundary gradient larger than \(\) to successfully identify the watermark models. These phenomena inspire the design of our ZeroMark method, as proposed in the next section.

Figure 2: **(a)** shows the watermark pattern for BadNets  used in our empirical study. **(b)** and **(c)** are examples of boundary gradients calculated under benign and target labels. **(d)** shows the distribution for the cosine similarity calculated over boundary gradients for benign and target labels. More empirical studies on other types of watermarks are included in the appendix.

## 4 Methodology

In this section, we describe the threat model and the technical details of our ZeroMark method.

**Threat Model.** Consistent with previous DOV methods [7; 6; 8], we assume that dataset owners will watermark the original dataset to generate its watermarked version. The dataset owner has full knowledge of watermark patterns and the validation samples used for ownership verification. In the verification stage, given a suspicious model, they will examine whether it was trained on the protected dataset under the label-only black-box setting, where they can only query the model with verification samples via model API and get its predicted labels, without accessing its intermediate results (\(e.g.\), gradients) and model parameters.

**The Main Pipeline of ZeroMark.** In general, our ZeroMark consists of three main steps, as shown in Figure 3. ZeroMark first generates the (closest) boundary samples of the suspicious model. Then, it calculates the boundary gradients of the generated boundary samples. ZeroMark conducts dataset ownership verification via boundary gradient analysis in the third step.

**Step 1. Generate Closest Boundary Samples.** ZeroMark follows Eq. (4) to optimize the closest boundary samples \(}^{*}\) iteratively with gradient decent. In particular, we exploit Monte Carlo method to estimate \(_{}_{y}(}_{t};)\) to address the challenge in our considered label-only black-box scenarios, where the gradients for given inputs are inaccessible. The overall process is as follows:

\[}_{t+1}=_{t}_{0}+(1-_{t})\{ }_{t}+_{t}_{i=1}^{N}_{y}( }_{t}+_{i};)_{i}}{|| _{i=1}^{N}_{y}(}_{t}+_{i};) _{i}||}\}, \]

where \(_{t}\) is the step size, \(_{0}\) is an initial point such that \(_{y}(_{0};) 0\), \(_{t}\) is chosen to ensure \(}_{t+1}\) lies in the decision boundary as Eq. (2), \(\{_{i}\}_{i=1}^{N} N(0,1)\) are \(N\) random noises \(i.i.d\) sampled from the standard Gaussian distribution, and \(\) is a fixed positive parameter (\(i.e.\), 0.01).

**Step 2. Calculate Boundary Gradients.** Once the closest boundary sample \(}^{*}\) is generated, we can also exploit Monte Carlo method to estimate its gradient (dubbed 'boundary gradient'), as follows:

\[_{}_{y}(}^{*};)_{ i=1}^{N}_{y}(}^{*}+_{i};)_{i}. \]

**Step 3. Boundary Gradient Analysis.** After obtaining the boundary gradients, ZeroMark first calculates the cosine similarity based on the available watermark pattern \(\) and obtains boundary gradients. To further mitigate the variance caused by the watermark patterns, we create several random watermark patterns and follow Eq. (8) to normalize the calculated cosine similarity. After that, motivated by the characteristic described in Section 3.3, where the cosine similarity of the boundary gradients on the target label \(y_{t}\) has a significantly larger value compared with that of benign labels, we design a hypothesis-test-guided method to conduct ownership verification based on the range of cosine similarity for verification, as follows.

Figure 3: The main pipeline of our ZeroMark, which consists of three main steps. In the first steps, ZeroMark applies Eq. (4) and Eq. (10) to generate the closest boundary samples. In the second step, ZeroMark estimates the boundary gradients for generated boundary samples. In the third step, ZeroMark first leverages the ground truth watermark pattern and random watermark patterns to calculate the normalized cosine similarity following Eq. (7) and Eq. (8). After that, ZeroMark uses the distribution of similarity scores to conduct \(t\)-test for dataset ownership verification. In particular, in the third stage, patterns (\(i.e.\), random and ground truth watermarks) displayed in the gray background are only available to the defender and inaccessible to the suspicious model.

**Proposition 1**.: _Suppose \((,_{}_{y_{t}}( }^{*},))\) is the posterior normalized cosine similarity between boundary gradients and the available trigger pattern of the suspicious model \(f(,)\). Let variables \(P_{b}\) and \(P_{d}\) denote the largest \(Q\)% over \(\{(,_{}_{y_ {t}}(}^{*}_{i},))\}_{i=1}^{m}\) and \(\{(,_{}_{y  y_{t}}(}^{*}_{i},))\}_{i=1}^{m}\), respectively. Given the null hypothesis \(H_{0}:P_{b}=P_{d}+\) (\(H_{1}:P_{b}>P_{d}+\)) where the hyper-parameter \(\), we claim that the suspicious model is trained on the protected dataset (with \(\)-certainty) if and only if \(H_{0}\) is rejected._

In general, we randomly select \(m\) (\(i.e.\), 500) validation samples evenly distributed across different classes to generate boundary gradients for the watermarked and benign labels. Then, we conduct the pairwise \(t\)-test  and calculate its p-value. The null hypothesis \(H_{0}\) is rejected if the p-value is smaller than the significance level \(\). Besides, we also calculate the _confidence score_\( P=P_{b}-P_{d}\) to represent the verification confidence. _The larger the \( P\), the more confident the verification._

## 5 Experiments

In this section, we conduct experiments on CIFAR-10  and Tiny-ImageNet  datasets with ResNet18 and ResNet-34 , respectively. More results with other settings are in our appendix.

### The Performance of Verification Samples Generated by ZeroMark

**Settings.** We hereby compare our ZeroMark method to two straightforward baseline methods, including **(1)** verification with minimal watermark (dubbed 'Minimal') and **(2)** verification with distorted watermark (dubbed 'Distortion'). These methods intend to protect the information of dataset-specified watermarks by perturbing the original watermarks. We also provide the results of verification with benign samples (dubbed 'Benign') and verification with original dataset-specified watermarked samples (dubbed 'Vanilla') for reference. We evaluate each verification method on four dataset watermark techniques, including two patch-based watermarks [29; 37] and two input-specific ones [38; 9]. Regarding the implementation of existing watermark techniques, we follow their default settings. The example of verification samples across different watermarks and verification methods is shown in Figure 4. Please find more details in the appendix.

**Evaluation Metrics.**We adopt mean square error (MSE), neuron activation similarity (NAS), and mutual information (MI) to measure the degree to which the dataset-specified watermarks are disclosed during the verification stage. Specifically, the MSE is defined as the mean square error between verification and their corresponding watermarked samples in the region of watermark patterns. NAS is calculated as the cosine similarity in the neuron activation map between verification and their corresponding watermarked samples. MI is calculated based on the distribution of verification and their corresponding watermarked samples. More details are in our appendix.

**Results.** As shown in Table 1, our approach produces larger cosine similarity scores of the target label than benign labels. We show the results regarding the watermark-disclosed degree for different approaches in Table 2-3. The results show that our approach can reach the most minor watermark

Figure 4: The example of verification samples across different watermarks (\(i.e.\), BadNets, Blended, WaNet, DW) and verification methods (\(i.e.\), Vanilla, Minimal, Distortion) on Tiny-ImageNet.

disclosed degree in almost all cases. The improvement is significant compared to the vanilla DOV methods. These results verify the effectiveness and security of our ZeroMark.

### The Performance of Dataset Ownership Verification via ZeroMark

**Settings.** We evaluate our ZeroMark for ownership verification under three scenarios, including **(1)** independent watermark (dubbed 'Independent-W'), **(2)** independent model (dubbed 'Independent-M'), and **(3)** unauthorized dataset training (dubbed 'Malicious'). In the first case, we used ZeroMark to verify the suspicious model affected with other watermark patterns; In the second case, we test the benign model with our ZeroMark; In the last case, we use ZeroMark to verify the watermarked model with corresponding ground truth watermark samples. Notice that only the last case should be regarded as having unauthorized dataset use. More setting detail are described in the appendix.

**Evaluation Metrics.** Following the settings in [7; 6], we use \( P[-1,1]\) and p-value \(\) for the evaluation. For the first two independent cases, a small \( P\) and a large \(p\)-value are expected. In contrast, for the third one, the larger \( P\) and the smaller the p-value, the better the verification.

**Results.** As shown in Table 4, our method can achieve accurate dataset ownership verification in all cases. Specifically, our approach can identify the unauthorized dataset usage with high confidence (\(i.e.\), p-value \(\) 0.01 for 'Malicious' case), while not misjudging when there is no unauthorized dataset utilization (\(i.e.\), p-value \(\) 0.1 for 'Independent-W' and 'Independent-M').

### Ablation Study

We hereby study the effects of two key hyper-parameters. More results are in our appendix.

    &  &  \\  Label\(\) & Watermark\(\) & BadNets & Blended & WaNet & DW & Ave. & BadNets & Blended & WaNet & DW & Ave. \\  Benign & 0.028 & 0.030 & 0.022 & 0.028 & 0.027 & 0.026 & 0.021 & 0.029 & 0.027 & 0.026 \\ Target & 0.102 & 0.368 & 0.131 & 0.099 & 0.174 & 0.148 & 0.334 & 0.131 & 0.123 & 0.194 \\   

Table 1: The averaged largest \(Q\%\) cosine similarity of our method on different watermarks.

   Metric\(\) &  &  &  \\  Watermark\(\) &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\ Method & & & & & & & & & & & & & & \\  Benign & 0.396 & 0.189 & 0.076 & 0.298 & 0.497 & 0.561 & 0.589 & 0.629 & 27.6 & 29.8 & 28.2 & 31.4 \\ Vanilla & 0 & 0 & 0 & 0 & 0.817 & 0.808 & 0.763 & 0.804 & 68.1 & 59.0 & 64.7 & 67.4 \\  Minimal & 0.187 & 0.096 & 0.077 & 0.189 & 0.768 & 0.782 & **0.046** & 0.429 & 52.3 & 54.6 & 49.9 & 54.7 \\ Distortion & 0.263 & **0.227** & 0.072 & **0.227** & 0.773 & 0.745 & 0.738 & 0.773 & 61.4 & 55.7 & 39.2 & 48.3 \\  ZerdMark (Ours) & **0.314** & 0.204 & **0.171** & 0.201 & **0.662** & **0.697** & 0.704 & **0.698** & **27.7** & **33.2** & **30.5** & **31.7** \\   

Table 2: The performance on CIFAR-10. In particular, we mark the best results in bold while the value within the underline denotes the second-best results (except the benign samples).

    &  &  &  \\  Watermark\(\) &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  &  \\ Method & & & & & & & & & & & & & \\  Benign & 0.396 & 0.189 & 0.076 & 0.298 & 0.497 & 0.561 & 0.589 & 0.629 & 27.6 & 29.8 & 28.2 & 31.4 \\ Vanilla & 0 & 0 & 0 & 0 & 0.817 & 0.808 & 0.763 & 0.804 & 68.1 & 59.0 & 64.7 & 67.4 \\  Minimal & 0.187 & 0.096 & 0.077 & 0.189 & 0.768 & 0.782 & **0.046** & 0.429 & 52.3 & 54.6 & 49.9 & 54.7 \\ Distortion & 0.263 & **0.227** & 0.072 & **0.227** & 0.773 & 0.745 & 0.738 & 0.773 & 61.4 & 55.7 & 39.2 & 48.3 \\  ZerdMark (Ours) & **0.314** & 0.204 & **0.171** & 0.201 & **0.662** & **0.697** & 0.704 & **0.698** & **27.7** & **33.2** & **30.5** & **31.7** \\   

Table 3: The performance on Tiny-ImageNet. In particular, we mark the best results in bold while the value within the underline denotes the second-best results (except the benign samples).

**Effects of Optimization Iterations \(t\).** We exploit BadNets and DW as the representatives of patch-based and sample-specific watermarks to study the effects of \(t\) on both CIFAR-10 and Tiny-ImageNet datasets. As shown in Figure 5, the cosine similarity scores increase with the increase of \(t\). With \(t\) 30, we can easily distinguish watermarked and benign models.

**Effects of the Largest Number of Verification Samples (\(i.e.\), \(m Q\%\)). As shown in Figure 6, with the number of verification samples used in the \(t\)-test increases, the cosine similarity decreases while the benign models' cosine similarity remains stable on both datasets. However, our method can still have a promising cosine similarity even with many verification samples (\(e.g.\), 150).**

### The Resistance to Potential Adaptive Methods

We hereby select domain watermark to evaluate the robustness of ZeroMark, as the domain watermark itself is sufficiently robust against this defense. Following the previous work , we here evaluate the robustness of our ZeroMark under fine-tuning  and model pruning . As shown in Figure 7, fine-tuning has minor effects on our method. In Figure 8, we can see ZeroMark performs resilient against model pruning as its efficacy decreases along with the domain watermark. The results of our resistance to other methods are in our appendix.

### A Closer Look to the Effectiveness of our ZeroMark

In this section, we intend to further explore the mechanisms behind the effectiveness of our ZeroMark. Specifically, we adopt t-SNE  to visualize the feature distribution of watermark samples, benign samples, and samples generated by ZeroMark of watermarked DNNs. As shown in Figure 9, with varied optimization iterations \(t\) for generating (closest) boundary samples, samples generated by ZeroMark can always stay far away from the watermark samples' distribution, which demonstrates ZeroMark can prevent disclosing the watermark information from the watermark samples.

## 6 Potential Limitations and Future Directions

ZeroMark can conduct dataset ownership verification without disclosing the watermark pattern. However, as the first work towards a secure verification process of dataset ownership verification (DOV) methods, we have to admit that we still have some potential limitations.

Figure 5: Effects of iteration size \(t\).

Figure 6: Effects of verification sample size.

Figure 7: Robustness against fine-tuning.

Figure 9: The t-SNE results with varied optimization iterations \(t\) for the embedding features of benign, watermark, and ZeroMark samples extracted from watermarked DNNs.

Firstly, we must admit that our method requires additional time to conduct ownership verification since it needs to generate some boundary samples and their gradients under the black-box setting. For example, it takes nearly 30 mins for verification on CIFAR-10. While this cost is acceptable in practice to a large extent, we will discuss how to accelerate our ZeroMark in our future work.

Secondly, ZeroMark currently can only perform effectively for watermark techniques with a pre-defined target label (\(e.g.\), BadNets , etc. For other watermark techniques, which have no pre-defined target label (\(i.e.\), UBW ), ZeroMark can not conduct boundary gradient analysis and, therefore, is not a feasible solution. Moreover, through extensive experimental evaluation, ZeroMark is shown to perform more effectively for Blended watermark, compared with other watermark techniques. Such observations inspire us to improve the effectiveness of ZeroMark by designing the potential watermark patterns in a blended manner. Finally, the boundary gradient analysis step in ZeroMark may incur variance among different labels' samples. In practice, we can release such variance by training a surrogate model with the protected dataset and calculating cosine similarity between the corresponding boundary gradients and the target watermark pattern with samples from different labels. Then we use the calculated cosine similarity using samples from different labels under the surrogate model to adjust the cosine similarity calculated under the suspicious model. Specifically, we can adjust the cosine similarity calculated with samples from a specific label \(t\) by subtracting it from the average cosine similarity calculated with samples from the same label \(t\) under the surrogate model. We will further discuss these issues in our future work.

Thirdly, we can only empirically verify that malicious dataset users cannot recover dataset-specified watermarks based on our boundary samples. We will try to prove it theoretically in the future.

Fourthly, we are currently focusing on convolutional neural networks (\(e.g.\), ResNet and VGG) and the continuous image modality. In general, the success of our approach on other model structures depends on two factors: **(1)** whether the studied dataset watermarking method (\(e.g.\), BadNets) can successfully watermark these models and **(2)** whether we can conduct effective 'adversarial attacks' to find boundary samples on these models. Based on existing work related to backdoor attacks/dataset watermarking  and adversarial attacks , these factors are all met. As such, our method can fundamentally generalize to other models (\(e.g.\), transformer) as well. As for the generalizability to other (discrete) data formats like tabular or text, the main challenge lies in how to design effective adversarial attacks to them for finding the closest boundary samples (as in Eq.(10)). In particular, there are already some relevant works  confirming its feasibility. Accordingly, our ZeroMark can be naturally adapted to other discrete data formats (\(e.g.\), text and scientific data ). We will discuss them in our future work.

## 7 Conclusion

In this paper, we revisited existing DOV methods and revealed that their underlying assumption regarding the verification phase does not necessarily hold in practice. Accordingly, directly using dataset-specified watermarks for verification is insecure. Motivated by these findings, we proposed _ZeroMark_ to conduct ownership verification without disclosing them. Our method was inspired by our empirical and theoretical findings of the intrinsic property of DNNs trained on the watermarked dataset. We conducted experiments on benchmark datasets, verifying the effectiveness of our ZeroMark and its resistance to potential adaptive methods. We hope our work can provide a new angle of dataset ownership verification to facilitate more secure and trustworthy dataset sharing.