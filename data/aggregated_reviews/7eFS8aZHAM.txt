ID: 7eFS8aZHAM
Title: Dissecting the Failure of Invariant Learning on Graphs
Conference: NeurIPS
Year: 2024
Number of Reviews: 16
Original Ratings: 7, 5, 5, 6, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1
Original Confidences: 3, 2, 4, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1

Aggregated Review:
### Key Points
This paper presents a novel regularization and alignment mechanism for invariant graph learning aimed at enhancing out-of-distribution (OOD) generalization. The authors analyze the failures of existing methods like IRM and VREx on graph data and introduce two approaches: CIA (environment-label dependent) and CIA-LRA (environment-label independent). Theoretical and empirical evidence demonstrates that these methods significantly improve OOD generalization performance. Furthermore, the authors propose a refinement of supervised contrastive learning to address distributional shifts in machine learning, specifically focusing on concept shift and covariate shift. However, concerns are raised regarding the validity of the claim that the method can solve concept shift, as it is argued that most invariant learning methods, including the authors' approach, primarily address covariate shift rather than concept shift.

### Strengths and Weaknesses
Strengths:
- Theoretical derivation explaining the failures of IRM and VREx on graph data.
- Comprehensive theoretical analysis of CIA and CIA-LRA.
- Detailed theoretical framework for addressing covariate and concept shifts that aligns with established literature.
- Empirical results showing substantial improvements in OOD generalization compared to existing methods.
- The response to reviewer queries demonstrates a willingness to engage with critical feedback and clarify misunderstandings.
- Detailed discussions and proofs provided in the appendix.

Weaknesses:
- Lack of clarity in Fig. 1 regarding variable definitions (e.g., $G$).
- The GNN defined in Eq. 3 is a linear model, limiting the theoretical analysis.
- Counter-intuitive claims regarding invariant node features diverging in the graph context, with insufficient empirical support.
- The claim that the approach can solve concept shift is deemed problematic, as it is suggested that the method does not adequately account for the changing associations between labels and features across environments.
- Some aspects of the design remain heuristic, raising concerns about the robustness of the proposed method.
- Missing definitions/discussions on concept shift and covariate shift.
- Use of a sum operator instead of a mean in line 232 raises concerns about graph size influence.
- Inconsistent naming conventions (e.g., $x_{cau}$ and $x_{inv}$).
- Unclear definitions and discussions in theorem 4.2 regarding $\alpha$ and the associated inequation.
- Proofs and equations (e.g., Eq. 34 and Eq. 35) raise questions about the uniqueness and dependency of solutions.

### Suggestions for Improvement
We recommend that the authors improve the clarity of variable definitions in Fig. 1 and provide a more detailed discussion on the implications of using a linear GNN model. Additionally, we suggest addressing the counter-intuitive claims regarding invariant node features with stronger empirical evidence. We also recommend reconsidering the claim that CIA would solve concept shifts, as this is a significant concern, and providing more empirical evidence or theoretical justification to support the assertion that the method can effectively address concept shift, distinguishing it clearly from covariate shift. A brief definition of concept shift and covariate shift should be included for clarity. The authors should clarify the rationale behind using a sum operator in line 232 and ensure consistent naming conventions throughout the paper. Further discussion on the implications of theorem 4.2 and the uniqueness of solutions in the proofs would enhance the rigor of the analysis. Lastly, including comparisons with more recent baselines and addressing the efficiency of the methods would strengthen the contribution of the paper.