ID: TKbGTj0YCZ
Title: Robust Conformal Prediction under Joint Distribution Shift
Conference: NeurIPS
Year: 2024
Number of Reviews: 13
Original Ratings: 5, 4, 3, 4, 3, -1, -1, -1, -1, -1, -1, -1, -1
Original Confidences: 3, 3, 4, 2, 4, -1, -1, -1, -1, -1, -1, -1, -1

Aggregated Review:
### Key Points
This paper addresses the challenge of conformal prediction under distribution shifts across multiple test domains, aiming to minimize coverage deviations caused by varying distribution shifts. The authors propose a method that disentangles joint distribution shifts using weighted conformal prediction and introduces the Normalized Truncated Wasserstein distance (D-NTW) to quantify remaining shifts. This D-NTW serves as a regularizer in a training algorithm, Multi-domain Robust Conformal Prediction (mRCP), which is empirically shown to reduce coverage differences without sacrificing prediction accuracy. The experiments demonstrate a strong correlation between D-NTW and expected coverage differences, with comparisons to existing multi-test-domain optimization methods. Additionally, the paper presents a method that estimates the likelihood ratio using kernel density estimation (KDE) and applies a conformal prediction framework to address distribution shifts. The authors assert that while theoretical guarantees are often based on known likelihood ratios, practical scenarios necessitate estimation, aiming to provide insights into the coverage gap in conformal prediction under distribution shifts, although much of the theoretical discussion remains intuitive rather than mathematically rigorous.

### Strengths and Weaknesses
Strengths:
- The paper tackles a relevant issue of distribution shift in conformal prediction, particularly in the less explored label shift context.
- The approach to disentangle covariate and label shifts provides valuable insights into model adaptation.
- The D-NTW metric is well-motivated and benchmarked against alternative metrics.
- A diverse range of datasets is utilized, and the paper is generally well-written, with clear visualizations.
- The method shows promise in empirical scenarios, particularly in its application to KDE and conformal prediction.
- The authors acknowledge the need for theoretical analysis of error propagation, indicating a willingness to improve the work.

Weaknesses:
- Practicality concerns arise from the requirement for labeled samples from every test domain to compute conformal test score distributions, which may introduce significant estimation errors.
- The evaluation lacks a direct connection to existing conformal methods under distribution shift and does not adequately assess coverage guarantees on test domains.
- The theoretical understanding of key definitions is limited, and the paper does not sufficiently clarify the motivation behind the need for multi-domain inference.
- Many responses to reviewer questions lack clarity and do not fully address the concerns raised.
- The theoretical foundations are not rigorously articulated, leading to confusion regarding the definitions and implications of terms like "coverage difference" and "discretization error."
- The assumptions regarding mixture distributions and the partitioning of domains are not clearly justified, raising concerns about the method's applicability.
- Writing quality suffers from unclear explanations, grammatical errors, and missing references to relevant literature.

### Suggestions for Improvement
We recommend that the authors improve the clarity and rigor of the writing, ensuring that key concepts and definitions are well-explained and properly motivated. A thorough discussion of the practical limitations of the proposed method, particularly regarding the estimation of test domain distributions, should be included. Additionally, we suggest that the authors provide empirical comparisons with existing conformal methods that address distribution shifts, such as split conformal prediction and adaptive approaches, to highlight the advantages of their proposed method. We also recommend improving the clarity and organization of the theoretical framework, particularly in Section 3.1, to ensure that the definitions of terms like $D_{joint}$, $D_{covariate}$, and $D_{concept}$ are precise and well-defined. Furthermore, a more rigorous mathematical analysis of the coverage gap and error propagation should be provided, along with clarification of the assumptions surrounding mixture distributions and domain partitioning. Finally, addressing the double-dipping issue in empirical estimates would enhance the reliability of the methodology presented.