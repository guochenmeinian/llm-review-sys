ID: eLH2NFOO1B
Title: Equivariant flow matching
Conference: NeurIPS
Year: 2023
Number of Reviews: 16
Original Ratings: 6, 3, 6, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1
Original Confidences: 4, 5, 4, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1

Aggregated Review:
### Key Points
This paper presents equivariant flow matching, an extension of flow matching for training continuous normalizing flows (CNFs) by incorporating symmetries into the optimal transport cost. The authors propose modifying the cost matrix to account for symmetries through a sequential search procedure, utilizing the Hungarian algorithm and rotation matrices. The method is evaluated in the context of Boltzmann generators for molecular systems, specifically Alanine dipeptide and Lennard Jones particles, demonstrating that equivariant flow matching can yield shorter transport paths. However, the performance results are mixed, with some instances where traditional flow matching outperforms the proposed method. Additionally, the authors argue that their approach is significant for AI4Science applications, particularly in handling larger systems and maintaining optimal transport sampling paths without necessitating training samples from the target distribution. They clarify the advantages of using Cartesian coordinates over internal coordinates for molecular systems, addressing challenges such as transferability and the long "robot arm problem." The authors also compare equivariant flow matching with non-equivariant baseline methods, noting that at higher sample sizes, equivariant flow matching does not outperform results at lower sample sizes and is inferior to the non-equivariant baseline in terms of negative log-likelihood (NLL).

### Strengths and Weaknesses
Strengths:
- The paper identifies a significant issue regarding symmetries in optimal transport flow matching and proposes a relevant solution.
- The experimental results indicate that the proposed method can lead to shorter transport paths, aligning with theoretical expectations.
- The authors effectively clarify misconceptions regarding the novelty and applicability of their approach, highlighting its potential impact on larger systems.
- The presentation is generally clear and well-structured, providing a clear explanation of the advantages of flow matching over energy-based training, particularly in terms of training speed and scalability.
- The experiments conducted in low data regimes demonstrate the robustness of their method.

Weaknesses:
- The novelty of the contribution is limited, as many concepts regarding equivariance and flows are already established in the literature.
- The computational cost of the proposed method is high due to the complexity of the Hungarian algorithm, which scales as \(O(N^3)\).
- The empirical results are inconsistent, with equivariant models sometimes performing worse than non-equivariant models, particularly in the Alanine dipeptide case.
- Some reviewers question the novelty of the contributions, suggesting that existing works may have addressed similar problems.
- The performance of the equivariant flow matching on alanine dipeptide at higher sample sizes raises concerns, as it does not show improvement over lower sample sizes and performs worse than non-equivariant baselines.
- The authors' reliance on MCMC for dataset generation is critiqued, as it may introduce inefficiencies in high-dimensional problems.
- The authors' response to the disagreement regarding the need for an exact likelihood model lacks clarity and does not adequately address the reviewer's concerns.

### Suggestions for Improvement
We recommend that the authors improve the clarity of their contributions by distinctly separating the application of flow matching to Boltzmann distributions from the introduction of equivariant flow matching in the abstract and throughout the paper. Additionally, a detailed time-complexity analysis of the proposed method compared to traditional flow matching and other equivariant models would be beneficial. We encourage the authors to explore alternative methods for solving the optimal coupling problem to reduce computational costs, such as learning permutations or using Gumbel Sinkhorn techniques. Furthermore, a more thorough investigation into the performance discrepancies observed in the alanine dipeptide experiments is necessary, as well as a definitive answer to the concerns raised regarding the effectiveness of equivariant flow matching in this context. We suggest including a discussion on the implications of the longer training times associated with the proposed method and how they affect practical applications. Lastly, we recommend that the authors clarify their stance on the necessity of exact likelihood models and engage more directly with the reviewer's points of contention.